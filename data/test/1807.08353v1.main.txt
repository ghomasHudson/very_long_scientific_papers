## Chapter 1 Introduction

Solving the quantum many-body problem is one of the greatest scientific
challenges nowadays. The fact that quantum mechanics is responsible for
“a large part of physics and the whole of chemistry” [ 9 ] makes it an
appealing tool to understand and predict material properties and
chemical processes from pure mathematical calculations. The advances in
solving the many-electron Schrödinger equation harvest the power of
quantum mechanics to deliver faster and cheaper materials discovery,
which is a key driving force in advancing human civilization both
historically and today.

Superposition and entanglement are the two most important properties of
quantum mechanics that results in the exotic phenomena. It is not
coincidental that they are also the source of the extreme complexity in
obtaining the numerical solutions of quantum many-body problems.
Superposition means we are dealing with probabilities over the entire
phase space; and entanglement means that the probabilities are not
independent. Thus, with a growing number of quantum objects, the
solutions we seek require keeping track of the outer product space of
all the probabilities — an exponentially growing space that becomes
intractable for any real world applications. One may argue that it has
long been known – before the discovery of quantum mechanics – that
high-dimension integrals can be evaluated stochastically via Monte
Carlo, but the way superposition in quantum mechanics works, via the
probability amplitudes, (along with the Fermi statistics) causes the
negative sign problem in all forms of quantum Monte Carlo, leading to
exponentially slow convergence [ 10 ] .

Recent progress in quantum computing [ 11 , 12 , 13 , 14 ] , especially
the algorithm development and experimental realizations of quantum
simulation [ 15 , 16 , 17 , 18 , 19 ] , seems to provide an alternative
path to overcome the fundamental exponential barrier. However, despite
the decades-long engineering effort yet to devote, universal, exact
solutions of general interacting fermion problems still requires a
stunning @xmath computational complexity in quantum simulations [ 16 ] ,
despite a large prefactor over classical computers.

Inevitably, approximations based on the observations of physical systems
have to be applied to simplify the problem. Perhaps the most popular
approximation so far is the mean-field theory, which replaces the
electron interaction with its average effects. A mean-field solution is
usually correct about @xmath of the total energy, and, if one does not
look at the fine details, most of the electron density. Usually, only
the electrons near the Fermi surface are affected when electron
interactions are re-introduced. Depending on many factors including the
mean-field energy gap and the strength of the electron interaction
(strictly speaking the “remaining” interaction not described by the mean
field, or termed electron correlation ), the system can either be
slightly affect with the qualitative nature unchanged, or go through
phase transitions and behave entirely different from the mean-field
picture. In the first scenario where the mean-field theory is
qualitatively correct, quantitative accuracy can be achieved by
introducing perturbative corrections. Methods such as the GW
approximation [ 20 , 21 , 22 ] and random phase approximation [ 23 ]
from the condensed matter field, and many-body perturbation theory [ 24
, 25 ] and coupled clusters [ 26 , 27 , 28 ] from quantum chemistry, are
examples of improving on top of mean-field theory. In the other scenario
where mean-field theory gives qualitatively wrong pictures, such as the
wrong phase of matter, going from the mean-field solution to the real
ground state requires crossing a phase transition point, which is
generally impossible for perturbative approaches, and one may have to
start with other limits.

Another valuable concept is the locality . Although quantum mechanics
itself allows entanglement between quantum objects from any distance,
the interactions between electrons decay with distance, and thus for low
energy states the correlation functions eventually vanish at long
distance. ¹ ¹ 1 In some cases the correlation function converges to a
constant different from zero in the infinite distance limit, which
represents a long-range order. One can break the associated symmetry in
the wavefunction, and the redefined correlation function @xmath . The
principle of locality thus allows ignoring certain long-range couplings
in calculations, and have been applied to reduce the computational cost
of many mean-field based methods (such as the linear-scaling density
functional theory [ 29 , 30 , 31 ] , local correlation techniques [ 32 ,
33 , 34 ] and many-body expansion [ 35 , 36 ] ), as well as develop
non-perturbative electronic structure methods that does not rely on the
mean-field theory (such as density matrix renormalization group and
other tensor network methods [ 37 , 38 , 39 , 40 , 41 , 42 , 43 ] ).

When it comes to solving large or open systems, another idea that
naturally arises is embedding . Starting with an approximate description
of the entire system, we can refine the description of a small piece of
the system which we care most, by solving that piece using higher level
methods while coupled to its environment. To go one step further, if we
improve the description on every piece of the entire system, or, in the
lattice settings, use the translational invariance to obtain a better
description for every piece of the system, we can somehow combine the
information to get a better description of the entire system; if the new
description of the whole system has the same form as the original one,
we can embed the fragment into the updated environment again, until
reaching a fixed point. The self-consistent version of embedding turns
out to be very powerful in tackling many electron problems.

We would like to do a deeper analysis of the embedding approach. When
solving the coupled fragment-environment problem, it is necessary to
approximate the environment by removing irrelevant degrees of freedom,
or we still face the intractable entire Hilbert space. The simplest
implementation of the idea is to include one or a few layers of
neighboring atoms in the fragment calculations. This essentially uses
the locality principle, while ignores the fact that only the electrons
near the Fermi surface are the most important, therefore is inefficient
(requires many layers to converge); It does not allow self-consistent
improvement either.

The first and most popular embedding approach for lattice strong
correlation problems (where the electron correlation changes the
qualitative phyiscal picture) is the dynamical mean-field theory (DMFT)
[ 44 , 45 ] . DMFT uses the mean-field Green’s function of the lattice
problem to compute the “hybridization”, the frequency-dependent quantity
required to make the fragment’s standalone, non-interacting Green’s
function look like its local Green’s function in the context of the
lattice. The hybridization is then used to approximate the environment
when solving the impurity model using semi-exact methods such as
truncated configuration interaction [ 46 ] or continuous-time quantum
Monte Carlo (CT-QMC) [ 47 , 48 , 49 ] . ² ² 2 Usually the hybridization
cannot be directly applied in the solvers, and an additional step of
bath discretization is introduced, which uses a set of non-interacting
orbitals to reproduce the spectrum of the hybridization. The setup thus
includes an interacting fragment and a set of non-interacting bath
orbitals, therefore is called the (Anderson) impurity model . The
fragment is usually called the impurity in this context. It usually
requires an infinite number of bath orbitals to exactly reproduce the
hybridization. One has to truncate the number of bath orbitals in
practice, causing the bath discretization error . From the impurity
model solution one extracts the self energy , which is essentially a
Green’s function kernel resulted from electron correlation. The self
energy is then used to update the lattice single-particle Green’s
function to include contributions from electron correlation. The new
lattice Green’s function is then used to compute the hybridization again
and start a new iteration.

DMFT demonstrated the feasibility of embedding with strong quantum
mechanical coupling, and have been successfully applied to lattice
fermion models and real materials with strong correlation, such as the
metal-insulator transition of transition metal oxides and
high-temperature superconductivity [ 45 , 50 , 51 , 52 , 53 ] . The
reason that embedding methods like DMFT can give qualitatively correct
pictures even when starting from the non-interacting solution is that
the feedback from the exact impurity model solution pushes the lattice
solution to have the correct physical picture, eg., to break the correct
symmetry. However, the applications of DMFT are limited due to its high
computational cost and numerical instability, particularly at low
temperature, where CT-QMC encounters severe sign problems. Because of
the potentially infinite number of bath orbitals, and other numerical
issues in fitting the hybridization, DMFT is only able to access small
fragments at low temperature or ground state, whose results are still
far from the thermodynamic limit.

The density matrix embedding theory (DMET) [ 54 , 55 ] is developed to
directly target the ground state where many interesting physical
phenomena emerge. DMET is a wavefunction based embedding scheme which
shares many similar concepts with DMFT, but constructed differently.
Unlike in DMFT, the bath orbitals in DMET have physical correspondence —
linear combinations of environmental orbitals that have the strongest
entanglement with the fragment of interest. Because of the way the bath
orbitals are formed, they naturally have higher weights on sites near
the fragment, and on canonical orbitals closer to the Fermi surface
(Fig. 1.1 ). In other words, the bath is selected by a tradeoff between
the locality and the proximity to the Fermi surface. Another advantage
of the DMET bath is that the number of bath orbitals is no more than the
number of fragment orbitals. Thus, there is no truncation in the bath
space, and one can treat much larger fragments in DMET than in DMFT, and
does not have to worry about the numerical difficulties in fitting the
hybridization function.

In the thesis work, we use DMET to study the cuprate high-temperature
superconductivity (HTSC). HTSC has wide applications in the
high-technology industries and scientific reseach, although these
materials are still hard to make and require low temperatures to stay in
the superconducting phase. The ultimate goal in the scientific studies
of HTSC is to find systematic ways to increase its transition
temperature. Despite the potential economic value, HTSC is also of much
theoretical interest because of its mysterious pairing mechanism, as
well as the rich phases other than superconductivity that emerge in the
material [ 56 , 57 , 58 , 59 , 60 ] .

Although the details are far from settled, we actually understand quite
a lot qualitative understandings of cuprate HTSC. The key of HTSC in
cuprates lies in the CuO @xmath plane, which is shared by all the
materials in this family. The essential physics of the CuO @xmath plane
is well approximated by the one- and three-band Hubbard model, and the
even simpler @xmath - @xmath model [ 61 ] , in the sense that the most
relevant phases in cuprates, such as antiferromagnetism, @xmath -wave
superconductivity, and various inhomogeneous charge, spin and pairing
orders arise in theoretical analysis and/or numerical solutions of these
models [ 62 , 63 , 64 , 65 , 66 , 67 , 68 , 69 , 53 , 70 ] . The
locations of these orders in the phase diagram are roughly known for
both cuprates and these derived models. The most intriguing pseudogap
phase, which may correspond to inhomogeneous orders in the ground state,
has been studied both experimentally and theoretically, and have
produced many theoretical hypotheses [ 71 , 72 , 73 , 74 , 75 , 76 ] .

However, the problem in the studies of cuprate HTSC is that, although we
understand what phases might appear in cuprates (and the Hubbard and
@xmath - @xmath models), and what mechanisms may be behind the phases,
we do not know exactly what actually happens, because many of the
candidate orders are packed in a small energy scale, and can be
stabilized by small changes in the parameters. The low energy scale
associated with the various competing orders makes it difficult to
address the problem with pure theory or simple calculations; numerical
studies without enough energy accuracy, although can produce various
relevant orders in roughly correct regions, do not give a definitive
answer either; while accurate, quasi-exact numerical studies usually can
only be applied to finite clusters that are not large enough to support
long-range orders. All it requires to solve the issue is concrete,
numerically precise simulation to resolve all the competing states and
mechanisms that appear in the material. Thus, DMET seems to have its
unique advantage as it gives accurate estimates of ground state energy
while supporting long-range order even with small fragment sizes
(although to determine the energies and orders more accurately, larger
fragment calculations are necessary to enable extrapolation).

Thus, the goal of my thesis work is to provide well-controlled numerical
studies of HTSC that has enough energy resolution to distinguish the
competing orders. We primarily work with the one-band Hubbard model
because it seems a good balance between conciseness and validity, not to
mention the historical importance of the model itself. Experimental
realization of the Hubbard model ground state is also within reach in
the next decades [ 77 , 78 ] . To reach this goal, we have (i) developed
broken spin and particle-number symmetry DMET, which can bring the
lattice mean-field solution to the correct phase; (ii) developed
efficient impurity solvers that scales polynomial with the fragment
size, that enables performing DMET on large fragments where rich physics
can arise; (iii) determined the finite-size scaling that translates
energies and observables from finite fragment calculations into
quantities in the thermodynamic limit; and (iv) calibrated error
estimators for energies and order parameters that allows us to draw
concrete conclusions. As we will demonstrate, while the one-band Hubbard
model is relevant to cuprates, it misses various important interactions
in the real materials and has limitations regarding resolving the
detailed low-energy physics of cuprates. Thus, we go beyond the one-band
model to study the three-band Hubbard model and downfolded ab initio
cuprate Hamiltonians, which take into account the missing interactions
and can give material specific predictions.

The thesis is organized as follows. In Chapter 2 , we discuss the
theoretical formulation of DMET, including the basic idea, the
broken-symmetry formulation, various impurity solvers and useful
theories and techniques in implementation. Chapter 3 to Chapter 5 will
focus on the one-band Hubbard model. Chapter 3 introduces a joint work
to study the finite-size scaling of two forms of DMET algorithms. In
Chapter 4 , we present a calibrated ground-state phase diagram of the
standard and frustrated 2D Hubbard model with a wide range of coupling
strengths and dopings relevant to cuprates and the @xmath -wave
superconductivity. With DMET, the energy accuracy achieved is one to two
orders of magnitude higher than previous studies. In Chapter 5 , we
introduce a joint work using various numerical methods to study the
@xmath -doping point of the 2D Hubbard model in depth, where we are able
to definitively determine the ground state and various low-energy
states. Chapter 6 presents a review of DMET studies of the three-band
model and downfolded cuprate Hamiltonians. Finally, in Chapter 7 , we
lay out a finite-temperature DMET formulation which can be applied to
study temperature-dependent properties of cuprates and other strongly
correlated materials.

## Chapter 2 Density Matrix Embedding Theory

### 2.1 Introduction

Density matrix embedding theory (DMET) [ 54 , 55 , 79 ] aims at
accurately describing small fragments strongly coupled to an extended
system. To achieve this goal, it focuses on correctly treating the
quantum entanglement between fragments and their environment.

There are many conceptual similarities between DMET and dynamical
mean-field theory (DMFT), a Green’s function based embedding method that
treats strongly correlated fermion systems. Both of them obtain a
mean-field-like solution for the entire system and build a set of bath
states to represent the environmental degrees of freedom coupled to the
fragment. They also both create an impurity model to compute the exact
solution of the fragment, in the presence of the bath. Then that
information is used to improve the mean-field solution of the entire
system. The process is self-consistent in both methods.

Unlike DMFT, DMET uses wavefunctions as its primary variable. This
choice gives DMET various advantages, such as better suited for ground
state calculations, and that the number of bath states is finite,
compared to the potentially infinite number of bath orbitals in DMFT,
which allows DMET to have significantly smaller computational cost the
DMFT. Thus, one can use DMET to treat systems or properties which were
computationally intractable with DMFT.

This chapter will focus on the formulation of DMET for ground state
calculations in lattice systems. We will introduce a finite-temperature
formulation in Chapter 7 . Other spectral, phononic and molecular
extensions of DMET are out of the scope of this thesis work, but can be
found in Refs. [ 80 , 81 , 82 , 83 , 84 , 85 ] . Sec. 2.2 introduces the
formulation of DMET for normal state calculations. Sec. 2.3 extends the
formulation to superconducting states. Sec. 2.4 reviews impurity solvers
developed or used as part of the thesis work. In Sec. 2.5 , we will
discuss issues in implementing DMET and strategies to deal with them.

### 2.2 Theoretical Framework

A large part of any embedding theory is determined by how the
environment is represented in the embedding calculations. In DMET, this
is done by the Schmidt decomposition of the approximate solution of the
entire system. In Sections 2.2.1 and 2.2.2 , we introduce the
construction of the bath and the impurity model in detail. In Sec. 2.2.3
, we introduce the correlation potential and how it is optimized. In
Sec. 2.2.4 , we discuss the necessity and ways to fit chemical potential
in DMET. In Sec. 2.2.5 , we introduce the computation of expectations
values in DMET. Solving the impurity model is an important, but
relatively separate part in DMET algorithms, so we introduce the
impurity solvers separately in Sec. 2.4 .

Throughout this section we will use a spinless notation to convey only
the essential idea of DMET. Switching to the spinful representation is
straightforward.

#### 2.2.1 The Exact Embedding

The Fock space of electrons (the second-quantized representation of
many-electron states) can be naturally partitioned into two subsystems.
We simply divide the orbitals (single-particle states) into two sets
(with the number of orbitals @xmath and @xmath , respectively) and name
them subsystem A and B. The Hilbert space of the entire system is thus
the direct product of the subsystem Hilbert spaces, @xmath . And the
orthonormal basis of @xmath is @xmath , where @xmath and @xmath are the
orthonormal basis of @xmath and @xmath , respectively.

Any state in @xmath can then be written as

  -- -------- -- -------
     @xmath      (2.1)
  -- -------- -- -------

Note that we use the Einstein notation for implicit summation here. The
coefficient @xmath is a @xmath matrix.

We can perform the singular value decomposition (SVD) on this matrix,
which gives @xmath , where @xmath and @xmath are unitary matrices and
@xmath is a diagonal matrix of dimension @xmath . The number of non-zero
elements in @xmath is @xmath . Without losing the generality, we assume
@xmath , and let the diagonal elements of @xmath be @xmath , then

  -- -------- -- -------
     @xmath      (2.2)
  -- -------- -- -------

Let @xmath and @xmath , we have

  -- -------- -- -------
     @xmath      (2.3)
  -- -------- -- -------

@xmath and @xmath are a special pair of biorthogonal basis in A and B,
which (a) give a diagonal expansion of the wavefunction @xmath ; and (b)
the sizes of which equal to the size of the smaller subspace @xmath ,
which is @xmath , even for the bigger subspace @xmath . (One can, of
course, complete the basis of the larger subspace @xmath with the
complement of @xmath .)

This is called the Schmidt decomposition [ 86 ] of state @xmath . The
coefficients @xmath and basis @xmath , @xmath are Schmidt coefficients
and Schmidt basis, respectively. The math of SVD guarantees that the
Schmidt decomposition is unique (up to a phase), i.e., invariant of
@xmath and @xmath chosen to perform the decomposition. It also implies
that any biorthogonal basis pair satisfying Eq. 2.3 is the same Schmidt
decomposition of @xmath , up to a phase.

The Schmidt decomposition naturally defines a set of bath for the
fragment problem: if we let subsystem A be the fragment and the
subsystem B be the rest, i.e., the environment, @xmath is a complete
basis for the fragment, while @xmath spans a small subspace in the
environment with the following properties: (a) it has direct
entanglement with the fragment; (b) its size equals to the size of the
fragment, and thus independent of the size of the environment. We can
thus define @xmath as the bath, in which we solve the coupled fragment
and bath problem by projecting the Hamiltonian to this subspace.

Thus, given the partition of the fragment and the environment, any
wavefunction representation of the entire system defines a set of bath,
with which one can embed the fragment in the environment quantum
mechanically. In particular, in the limit where @xmath is the exact
ground-state wavefunction of the entire system, the embedding is exact.
By exact embedding, we mean any observables in the fragment, obtained
from the impurity model, equals to the same observables obtained by
solving the entire lattice system exactly.

Suppose in Eq. 2.3 , @xmath is the ground state of the entire system,
and the ground-state energy @xmath . The bath Hilbert space is the space
spanned by environmental Schmidt basis @xmath while the fragment space
is @xmath . We define the impurity model Hamiltonian in the space @xmath
by projecting the entire system Hamiltonian @xmath to the subspace

  -- -------- -- -------
     @xmath      (2.4)
  -- -------- -- -------

where the projector

  -- -------- -- -------
     @xmath      (2.5)
  -- -------- -- -------

Since @xmath , the ground state solution of the impurity model is
exactly @xmath , the same as the ground state of the entire system. It
obvious matches all the observables with the exact ground state.

#### 2.2.2 Embedding with Slater Determinants

The exact embedding is an ideal scenario but impossible to realize.
After all, there is no point to do any embedding when we can obtain the
exact solution for the entire system. Another subtle, but a much more
serious issue is that the Schmidt decomposition of any general many-body
wavefunction scales exponentially with the size of the entire lattice.
It is thus desirable to find a class of approximate wavefunctions, which

-   allows computationally tractable Schmidt decomposition; and

-   can be systematically improved to approach the exact wavefunction.

It turns out that there is no perfect candidate that satisfies both
properties. One can, however, loose the second condition to only require
observables in the correlated fragment solution to be systematically
improvable. In this case, Slater determinants can be used to approximate
the lattice wavefunction.

A Slater determinant consists of a set of @xmath occupied orbitals
(canonical orbitals) as linear combinations of @xmath local orbitals
(i.e., atomic orbitals or lattice sites).

  -- -------- -- -------
     @xmath      (2.6)
  -- -------- -- -------

The occupied orbitals @xmath , where @xmath creates an electron on site
(orbital) @xmath and @xmath is the orbital coefficient matrix. For
simplicity, we assume both the cannonical orbitals and the local
orbitals are orthonormal sets. The one-body density matrix is defined as

  -- -------- -- -------
     @xmath      (2.7)
  -- -------- -- -------

In matrix form, @xmath . All higher-order density matrices and
observables of the Slater determinants can be computed through the
one-body density matrix. Also, the one-body density matrix is invariant
under the rotations of occupied orbitals.

The Schmidt basis of Slater determinants can be constructed by the
rotations of the occupied orbitals. Consider a bipartite of the system,
where the first @xmath sites belong to subsystem A, and the other @xmath
sites belong to subsystem B. We also assume @xmath and number of
electrons @xmath . In this setting, A is the fragment of interest, while
B is the environment. There exists a unitary transformation of the
coefficient matrix @xmath , such that

  -- -------- -- -------
     @xmath      (2.8)
  -- -------- -- -------

where @xmath is a unitary matrix, @xmath , @xmath and @xmath are of
dimensions @xmath , @xmath and @xmath , respectively. The upper right
corner of the transformed coefficient matrix is zero, meaning all but
@xmath occupied orbitals are restricted to subsystem B. As we have seen
before, the transformation leaves the one-body density matrix, and thus
the Slater determinant invariant, therefore

  -- -------- -- -------
     @xmath      (2.9)
  -- -------- -- -------

where

  -- -------- -- --------
     @xmath      (2.10)
  -- -------- -- --------

and @xmath , @xmath are the normalization factors.

Note that the columns of @xmath do not have to be orthogonal. But we
will show later that there exists a set of @xmath where the columns are
orthogonal. (The columns of @xmath are always orthogonal with columns of
@xmath .) If this is true, @xmath are orthogonal fermions operators, and
in particular @xmath spans the Fock space of subsystem A. Under this
condition, we used the following notation in Eq. 2.9

  -- -------- -- --------
     @xmath      (2.11)
  -- -------- -- --------

Eq. 2.11 defines a pair of biorthogonal basis for subsystem A and B,
and, according to the uniqueness of Schmidt decomposition, Eq. 2.9 is
actually the Schmidt decomposition of the Slater determinant. The
impurity model is thus equivalent to solving the complete active space
(CAS) problem with active orbitals @xmath and core orbitals @xmath .
Since the rotation within the active space does not affect the solution,
we can simply use the site basis @xmath instead of @xmath . Thus, only
the bath and core orbitals @xmath need to be specified for the impurity
model. (Note the bath orbitals are related to but different from the
bath states @xmath from Sec. 2.2.1 which are many-body states.)

There are a few different but equivalent approaches to obtain the bath
orbitals using the one-body density matrix. Use @xmath to compute the
one-body density matrix, we have

  -- -------- -- --------
     @xmath      (2.12)
  -- -------- -- --------

Let @xmath be the eigendecomposition, then we have @xmath , and @xmath .
The bath orbitals are thus defined by normalizing each column of @xmath
. Note that here the columns of @xmath are orthogonal, because @xmath is
unitary and @xmath is diagonal. Since @xmath , it follows that the
columns of @xmath are also orthogonal. One can perform a simple
transformation, for instance, @xmath and @xmath where @xmath is any
non-singular square matrix, to make columns of @xmath and @xmath
non-orthogonal. This verifies our claim that the representation in Eq.
2.8 is not unique, and there exist solutions where columns of @xmath and
@xmath are orthogonal.

An equivalent way to obtain bath orbitals is to diagonalize the
environmental part of the density matrix @xmath . The eigenstates with
eigenvalues between 0 and 1 are the bath orbitals, while those with
eigenvalue 1 are core orbitals. One can as well perform SVD on @xmath ,
where the matrix @xmath gives the orthonormalized coefficients of bath
orbitals.

In summary, given a Slater determinant, we can formulate the embedding
calculation by obtaining the bath and core orbitals of the environment,
and the impurity model becomes a CASCI problem.

#### 2.2.3 Correlation Potential

In Sec. 2.2.2 , we present in detail how to perform an embedding
calculation given a Slater determinant wavefunction of the lattice. We
now discuss the parameterization and optimization of the determinant.

In DMET, the determinant is parameterized as the ground state of a
non-interacting Hamiltonian

  -- -------- -- --------
     @xmath      (2.13)
  -- -------- -- --------

where the core Hamiltonian @xmath is either the one-body part of the
full Hamiltonian @xmath , or the Fock matrix @xmath , depending on the
nature of the problem. For instance, in lattice problems where the
interactions are usually local, the bare one-body Hamiltonian @xmath is
preferred; while in molecular calculations, it is better to use the Fock
matrix @xmath . The additional one-body term @xmath , usually called the
correlation potential , mimics the effective two-body interaction, is to
be determined.

Compared to using the orbital coefficients @xmath as primary variable,
an auxiliary potential @xmath is favored in various ways: the
constraints on the @xmath (Hermitian) is much simpler than the
constraints on @xmath (unitary), and there is strong physical
interpretations for @xmath as the effective potential due to electron
correlation.

To approximate the behavior of local correlation, we restrict the
correlation potential to be local to each fragment. In lattice systems,
it means @xmath is block-diagonal on the supercells chosen as fragments,
and each diagonal block is identical because of the translational
invariance.

  -- -------- -- --------
     @xmath      (2.14)
  -- -------- -- --------

Given the correlation potential @xmath , one obtains the lattice Slater
determinant @xmath and the correlated wavefunction @xmath . In the
notation, @xmath is the correlated wavefunction of the impurity model
(fragment + bath), while @xmath is the core environmental wavefunction
defined in Sec. 2.2.2 . It becomes apparent that using Slater
determinant to construct the impurity model does not change any
expectation values in the core space. Therefore, one only expects the
observables in the fragment to improve upon the mean-field results.
Because one has no access to the exact values of these observables, to
evaluate the quality of the embedding calculation, and thus @xmath , we
use the similarity between @xmath and @xmath .

There are many metrics to choose from, but with DMET, the most common
choice is the one-body density matrix. The cost function is thus

  -- -------- -- --------
     @xmath      (2.15)
  -- -------- -- --------

where @xmath is the one-body density matrix of the correlated
wavefunction and @xmath is the that of the Slater determinant, both in
the basis of the impurity model. Minimizing the cost thus minimizes the
difference between the mean-filed level and correlated solutions of the
impurity model at one-particle level. There are various implications of
this cost function:

-   Both the fragment and bath parts of the density matrix were used,
    indicating that we try to maintain a balance between the accuracy of
    the fragment itself and its coupling to the environment.

-   Since the mean-field density matrix @xmath is idempotent (even when
    projected to the impurity model), generally the cost function cannot
    be reduced to zero.

Other cost functions, such as the density matrix difference on the
fragment, or even simpler, the difference in occupation numbers of the
fragment orbitals , were proposed [ 87 ] . Empirically, we find the full
density matrix formulation works best for lattice models, probably
because of the balance it achieves between the fragment itself and the
coupling to the environment.

Eq. 2.15 defines an unconstrained optimization problem, which one can
solve with standard minimization procedure. However, the gradient of the
cost function is

  -- -------- -- --------
     @xmath      (2.16)
  -- -------- -- --------

where the response of @xmath with respect to changes in @xmath cannot be
computed analytically and the numerical gradient involves solving the
impurity model multiple times. Therefore, we use a self-consistent
procedure to perform the minimization

1.  Compute @xmath .

2.  @xmath with @xmath fixed; If @xmath , go back to step 1.

Here @xmath is the convergence threshold for the correlation potential
@xmath .

One last issue related to the correlation potential is the choice of
impurity model Hamiltonian. In exact embedding, we simply project the
entire lattice Hamiltonian to the impurity model (Eq. 2.4 ). We can
continue using this approach when embedding with Slater determinants;
because there are electron interactions between bath orbitals, this
approach is often referred as the interacting bath . Alternatively, one
can use the correlation potential to replace the electron interactions
on bath orbitals, and include the interactions only between the fragment
orbitals, called the non-interacting bath

  -- -------- -- --------
     @xmath      (2.17)
  -- -------- -- --------

where @xmath is the two-body part of the original Hamiltonian, and
@xmath is the projection to the fragment. The non-interacting bath has
an origin analogous to those used in the DMFT impurity model, which are
restricted to be non-interacting and varied to match the hybridization
function.

It is often preferable to use the non-interacting bath formulation in
lattice DMET calculations, although the interacting bath seems more
elegant. There are various theoretical arguments for that. One argument
is that embeddings from Slater determinants may not have enough
flexibility to obtain a good enough approximation for the ground state
Schmidt basis, while the non-interacting approach, by directly encoding
@xmath in the impurity Hamiltonian, can access a larger space to
approximate the ground state properties of the fragment efficiently.
Another more physical argument is that, since the bath orbitals in
lattice systems often extend many unit cells, the screening plays a role
and it is well-known that direct downfolding of the electron
interactions works poorly in this context. The use of @xmath to replace
these long-range interactions in the non-interacting bath, to some
extent, renormalizes the electron interaction and could improve the
results. Computationally, the non-interacting bath is also favored as it
avoids the task of sometimes formidable integral transformation which
scales @xmath with the size of the entire lattice.

The detailed equations and algorithms for this section are presented in
Appendix B.3 .

#### 2.2.4 Chemical Potential Optimization

A problem in the embedding calculations is how to control the number of
electrons in the fragment. Following the embedding formulation in Sec.
2.2.2 and 2.2.3 , there is no guarantee what number of electrons in the
fragment we get from impurity model calculations. This does not only
affect the values of the observables, but is itself problematic in a
lattice problem, where the number of electrons per fragment is usually
well defined. It is thus desirable to have the number of electrons
exactly match what we expect for the lattice model.

To do so, we introduce the chemical potential term @xmath . We recognize
that there is a gauge freedom between @xmath and the diagonal terms of
correlation potential @xmath in the mean field, i.e.,

  -- -------- -- --------
     @xmath      (2.18)
  -- -------- -- --------

This gauge freedom is lost in the impurity model calculation with
non-interacting bath, as one can see in Eq. 2.17 that the correlation
potential is only added to the bath orbitals. Therefore, one can vary
@xmath and the diagonal of @xmath together following Eq. 2.18 so that
the mean-field solution (thus the bath orbitals) does not change, while
the relative energy levels of the fragment and the bath orbitals are
shifted. Thus, we can perform chemical potential optimization while
solving the impurity model. The chemical potential obtained in this
procedure is usually a good approximation of the chemical potential in
the physical sense. The details of a self-adaptive chemical potential
fitting algorithm, and how it is built into the DMET iterations are
explained in Appendix B.4 .

#### 2.2.5 Expectation Values

In general, there are two types of expectation values of interest in
DMET. Local observables, such as occupations and local order parameters
can be directly computed using the correlated wavefunction @xmath .
These expectation values should be computed only if they are fully
within the fragment. Reciprocal space observables, such as band
structure and spin structure factors, cannot be formally defined for
DMET correlated wavefunction @xmath because of the lack of translational
invariance. One could, however, obtain rough estimates from the
associated lattice Slater determinants. Other nonlocal observables, such
as long-range correlation functions, can be computed by taking
expectation values of the locally correlated entire system wavefunction
@xmath . However, these observables will have a smooth transition from
the full many-body results to the mean-field values, and are seldom of
practical use.

Another important expectation value is the energy per supercell
(fragment). Note the DMET energy is different from the impurity model
energy @xmath . We consider the bipartite decomposition of the lattice
Hamiltonian

  -- -------- -- --------
     @xmath      (2.19)
  -- -------- -- --------

Obviously, the fragment part @xmath should be included and @xmath should
not. The coupling term @xmath is split between the fragment and
environment, by taking a partial trace of the second-quantized terms,
i.e.

  -- -------- -- --------
     @xmath      (2.20)
  -- -------- -- --------

where @xmath and @xmath are one- and two-body density matrices of the
correlated wavefunction @xmath . This is equivalent to a full trace,
with scaling factors equal to the fraction of the indices in the
fragment. (For example, for term @xmath where indices @xmath are in the
fragment, the scaling factor is @xmath .) This is an intuitive way to
understand the decomposition of the coupling energy.

### 2.3 The Broken Particle-Number Symmetry Formalism

In this section, we extend the generic DMET formulation to broken
particle-number symmetry problem. They correspond to systems with
superconductivity, where the pairing order parameters @xmath are
non-zero (The @xmath and @xmath are spin labels. We consider singlet
pairing only.)

Historically, superconducting wavefunctions with broken particle-number
symmetry were first obtained in the mean-field solution of fermion
systems with effective attractive interactions, induced by
electron-phonon coupling [ 88 , 89 ] . The size of the broken
particle-number symmetry, measured by the magnitudes of pairing terms,
describes the existence and robustness of the superconductivity. In pure
electronic systems, such as the high-temperature superconductors, there
are no attractive terms between electrons, and mean-field solutions
never spontaneously break the particle number symmetry, although the
exact solution in the thermodynamic limit has long-range pairing
correlations. In DMET, however, we can enable pairing in the correlation
potential, which is determined self-consistently, and it turns out the
superconducting solutions can be stabilized spontaneously.

In Sec. 2.3.1 and 2.3.2 , we introduce the mean-field and embedding
aspects of DMET in the presence of pairing. In our derivation, the
spin-unrestricted formulation is used. In Sec. 2.3.3 , we discuss why
this formulation can give correct results of superconductivity.

#### 2.3.1 The BCS Wavefunction and BdG Equation

The spin-unrestricted Bogoliubov transformation is defined as

  -- -------- -- --------
     @xmath      (2.21)
  -- -------- -- --------

where @xmath creates a quasiparticle of spin @xmath , @xmath creates an
electron of spin @xmath in orbital @xmath . For simplicity, we assume
the coefficients are all real numbers. The quasiparticles defined here
have good @xmath quantum numbers, but the particle number symmetry is
broken. This is the so-called singlet pairing that preserves @xmath
symmetry, and is usually the case in both conventional and
high-temperature superconductors.

The transformation can also be written in matrix form

  -- -------- -- --------
     @xmath      (2.22)
  -- -------- -- --------

A complete set of Bogoliubov transformation has @xmath orthonormal
quasiparticles for each spin. In this case, the matrix @xmath is unitary
(one can verify it by checking the anticommutators), therefore

  -- -------- -- --------
     @xmath      (2.23)
  -- -------- -- --------

and the inverse Bogoliubov transformation

  -- -------- -- --------
     @xmath      (2.24)
  -- -------- -- --------

A BCS wavefunction @xmath are defined as the vacuum of a complete set of
Bogiliubov quasiparticles, i.e.,

  -- -------- -- --------
     @xmath      (2.25)
  -- -------- -- --------

Like the Slater determinants, the observables of BCS wavefunctions are
also determined entirely by its one-body density matrices. Besides the
standard one-body density matrices, BCS wavefunctions have non-zero
pairing density matrices @xmath . The density matrices of BCS
wavefunctions can be evaluated using Eq. 2.24 and 2.25 , thus

  -- -- -- --------
           (2.26)
  -- -- -- --------

i.e.,

  -- -------- -- --------
     @xmath      (2.27)
  -- -------- -- --------

@xmath is the generalized one-body density matrix of @xmath , as it
contains the information of all the channels of the one-body density
matrices.

The BCS wavefunctions are the ground state solutions of non-interacting
Hamiltonians with pairing terms

  -- -------- -- --------
     @xmath      (2.28)
  -- -------- -- --------

It is also the mean-field solution of an interacting Hamiltonian, with
the assumption that @xmath . In this case, the two-body terms are
approximated as

  -- -------- -- --------
     @xmath      (2.29)
  -- -------- -- --------

where the first two terms are Coulomb and exchange terms in Hartree-Fock
theory, while the last term comes from pairing. This formulation is thus
called Hartree-Fock-Bogoliubov (HFB) theory. By forming the Fock matrix,
HFB essentially solves for the ground state of an effective Hamiltonian
similar to that in Eq. 2.28 as well. The pairing density matrix becomes
non-zero for certain values of the two-body interactions.

In both cases, the problem reduces to finding the quasiparticles by
solving the Bogoliubov-de Gennes (BdG) equation [ 90 ] , in analogous to
the Hartree-Fock-Roothaan equation in Hartree-Fock theory. Given the
chemical potential @xmath , the BdG equation is [ 91 ]

  -- -------- -- --------
     @xmath      (2.30)
  -- -------- -- --------

where @xmath and @xmath are all positive. The number of @xmath equals to
the number of @xmath for a @xmath system. One can also see from here why
the ground state of Eq. 2.28 is the quasiparticle vacuum, since the
Hamiltonian is transformed to

  -- -------- -- --------
     @xmath      (2.31)
  -- -------- -- --------

where @xmath is the ground state energy.

To apply the BCS formulation to DMET, we allow the correlation potential
to include pairing terms, i.e.

  -- -------- -- --------
     @xmath      (2.32)
  -- -------- -- --------

where @xmath go over all the sites in a fragment. The mean-field
solution @xmath now becomes a BCS wavefunction. To obtain the correct
mean-field solution, one needs to adjust the chemical potential @xmath
so that @xmath gives the pre-defined number of electrons.

#### 2.3.2 Embedding the Quasiparticles

In this section, we take the mean-field BCS wavefunction and discuss the
formation of the bath orbitals. At first look, the BCS wavefunction,
defined as the quasiparticle vacuum, is not a product state and thus not
possible to perform the Schmidt decomposition analogous to Slater
determinants. As shown in Ref. [ 92 ] , the Schmidt decomposition of a
BCS wavefunction is equivalent to finding an embedded quasiparticle
active space. Here, we introduce a new approach that converts the BCS
wavefunction to a product state [ 93 ] , which results in similar
mathematical operations to the case of Slater determinants.

We start by defining a simple vacuum (background) @xmath as a
ferromagnetic state where all the @xmath lattice sites are occupied by
spin-down ( @xmath ) electrons, and let the quasiparticles

  -- -------- -- --------
     @xmath      (2.33)
  -- -------- -- --------

We have @xmath and @xmath since @xmath and @xmath bring down @xmath by
@xmath , but @xmath is already the lowest eigenstate of @xmath .

We can thus write the BCS wavefunction as

  -- -------- -- --------
     @xmath      (2.34)
  -- -------- -- --------

up to a phase, because the state on the right-hand side is the
quasiparticle vacuum of @xmath :

  -- -------- -- --------
     @xmath      (2.35)
  -- -------- -- --------

Since Eq. 2.34 rewrites the BCS state into a product state (the vacuum
@xmath is also a product state), we view it as a Slater determinant with
the occupied orbitals @xmath , and its one-body density matrix can be
obtained using the orbital coefficients of @xmath

  -- -------- -- --------
     @xmath      (2.36)
  -- -------- -- --------

It thus turns out the density matrix of @xmath is acutally the
generalized density matrix (Eq. 2.26 ) of @xmath . The Schmidt
decomposition of @xmath is then

  -- -------- -- --------
     @xmath      (2.37)
  -- -------- -- --------

where the notations are similar to those in Eq. 2.9 . The @xmath and
@xmath states are the ferromagnetic states of the fragment and the
environment, respectively. The bath and core orbitals @xmath can be
obtained by diagonalizing the environmental part of the generalized
density matrix @xmath , similar to normal state DMET.

Note that the fragment and bath orbitals obtained in this procedure are
all of spin @xmath , and the core state has spin @xmath . (the factor
@xmath from electron spin is taken into account.) The impurity model is
thus a spinless fermionic system of @xmath sites in which @xmath are
occupied. Alternatively, we can perform a partial particle-hole
transformation on half of the @xmath modes, and make the core @xmath .
The impurity model then becomes a fermion problem of @xmath (spatial)
orbitals without particle-number symmetry, while @xmath . The latter is
used in the thesis work, because the pairing is usually a small effect
in the problems of interest, thus the partial particle-hole
transformation results in a better physical picture, where all the
quasiparticles become electron-like (i.e. @xmath ), and fits better into
available impurity solvers.

After the partial particle-hole transformation, the impurity model
consists of @xmath fragment orbitals @xmath and @xmath bath orbitals for
each spin

  -- -------- -- --------
     @xmath      (2.38)
  -- -------- -- --------

And the core wavefunction becomes

  -- -------- -- --------
     @xmath      (2.39)
  -- -------- -- --------

We discuss how to project the lattice Hamiltonian to the embedding basis
in Appendix A.1 .

#### 2.3.3 Broken Symmetry DMET

We have discussed how to construct the impurity model with broken
particle-number symmetry. The correlation potential and chemical
potential optimizations are similar to the case of the normal state,
although the math becomes more complicated (detailed in the Appendix).
Here, we discuss the physical side of broken symmetry DMET calculations,
i.e.,

-   When and how does DMET give a broken symmetry solution?

-   What controls the quality of order parameters obtained in DMET?

-   How do the DMET orders connect to the exact solutions in the
    thermodynamic limit?

We use the example of pairing order to address these questions. By
including pairing terms in the correlation potential, we obtain a BCS
mean-field solution. That gives an impurity model Hamiltonian with
non-zero pairing terms in the environmental degrees of freedom. This can
be viewed as a pinning field similar to those used in finite lattice
calculations, although more complicated and structured. The pinning
field thus induces non-zero pairing orders in the fragment, the
magnitude of which depends on the susceptibility of the fragment.

In the correlation potential fitting stage, we try to match the lattice
wavefunctions to the correlated solutions, thus forcing the mean-field
order parameters to increase or decrease adaptively, and changing the
magnitudes of the pinning field and the order parameters in the
correlated calculations. At convergence, the order parameters obtained
in the impurity model calculations thus become a good approximation of
the actual long-range order. The order parameters become exact in the
limit of infinitely large fragments.

If the true ground state of the entire lattice has a long-range order,
the susceptibility is infinite and the symmetry is spontaneously broken.
In this case, DMET will also give a broken symmetry solution, which does
not disappear as the size of the fragment grows. If, however, the order
is short-ranged, the order parameters ultimately decay to zero as the
distance to the fragment boundaries grows. In practice, these order
parameters are often zero even with minimal fragment sizes thanks to
DMET self-consistency.

In the case where long-range order does exist, one can obtain the exact
order parameter by growing the fragment size to infinity. Alternatively,
we can compute the order parameters with several fragment sizes and
extrapolate to the thermodynamic limit. (It usually extrapolates to zero
if the order is short-ranged.) Thus, the accuracy of these order
parameters are determined by the largest sizes we can achieve in DMET
calculations, as well as the function forms used for the extrapolation.

In summary, DMET coupled with finite size extrapolation is possible to
exract order parameters in the thermodynamic limit. In Sec. 2.5.3 and
Chapter 3 , we will introduce the theory and empirical studies of DMET
fragment size extrapolation.

### 2.4 Impurity Solvers

Impurity solvers are used to solve the quantum many-body problem the
impurity models, either exactly or approximately. An advantage of DMET
is that one can choose from a wide range of solvers already developed in
the quantum chemistry or computational condensed matter communities,
depending on the problems at hand. In this section, we introduce the
common impurity solvers, both for normal state calculations and BCS
calculations. We will focus on the principles and the appropriate
contexts of these solvers.

#### 2.4.1 Exact Diagonalization

The most direct way is to diagonalize the many-body Hamiltonian and
obtain the full Fock space representation of the ground-state
wavefunction. We write the wavefunction as an expansion of the
occupation strings (subject to symmetries)

  -- -------- -- --------
     @xmath      (2.40)
  -- -------- -- --------

where @xmath is the occupation of orbital @xmath . In exact
diagonalization (ED), We minimize the total energy and find the optimal
coefficients @xmath . The method is also called full configurational
interaction (FCI) because of the Fock space expansion. The cost of ED
scales exponentially with the system size, as we can see, the number of
parameters in the giant tensor @xmath scales @xmath . In addition, naive
eigendecomposition requires writing down the Hamiltonian matrix in this
basis, and then perform the diagonalization routine, which takes @xmath
space and @xmath time. The computational cost soon becomes formidable
with about merely 8 to 10 orbitals.

We can save some memory and computational cost using the Lanczos or
Davidson algorithms [ 94 , 95 ] to compute only the lowest one or
several eigenstates without explicitly writing down the Hamiltonian
matrix. This is often referred as the direct CI [ 96 , 97 ] . The
Davidson algorithm is described in Appendix B.5 in detail. The most
time-consuming step in direct CI is to compute @xmath , which is
achieved by taking the each individual term in @xmath and acting on each
occupation string in the expansion of @xmath . This, in fact, uses the
sparsity of the Hamiltonian matrix and results in roughly @xmath time
complexity (terms in @xmath @xmath basis in @xmath ).

Due to the exponential complexity, even with Davidson algorithm, ED (or
FCI) is able to treat only up to @xmath orbitals with current
computational power. It is of limited uses as a DMET impurity solver,
but can serve as the benchmark for other approximate impurity solvers.

#### 2.4.2 Density Matrix Renormalization Group

The density matrix renormalization group (DMRG) [ 37 , 38 , 40 ]
approximates the exact wavefunction coefficients Eq. 2.40 as the a
tensor product

  -- -------- -- --------
     @xmath      (2.41)
  -- -------- -- --------

The representation is called the matrix product states (MPS) because
each @xmath is a matrix. The uncontracted indices @xmath are called the
physical indices , while @xmath are called the auxiliary indices .

Eq. 2.41 is exact if we allow the dimensions of auxiliary indices @xmath
to reach @xmath , though in this case, the number of parameters scales
exponentially. In practice, the dimension is restricted to have the
maximum bond dimension @xmath . The expression thus becomes a
variational ansatz, whose accuracy is a monotonically increasing
function of @xmath .

DMRG is an efficient algorithm to optimize the MPS using the sweep
algorithm, i.e., the tenors @xmath are updated one at a time, from left
to right (forward) and then from right to left (backward), until the
energy is converged. In each step during the sweep, one projects the
Hamiltonian to a renormalized subspace around orbital @xmath and solve
for the ground state. The subspace wavefunction is then compressed to
keep the bond dimension @xmath unchanged during the calculation.

Specifically, when optimizing tensor @xmath in the forward sweep, the
Hamiltonian is projected onto the basis

  -- -------- -- --------
     @xmath      (2.42)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (2.43)
  -- -------- -- --------

are the left and right renormalized basis, respectively. Thus, the
renormalized Hamiltonian is @xmath , where the projector

  -- -------- -- --------
     @xmath      (2.44)
  -- -------- -- --------

The process of building the renormalized basis and the subspace
Hamiltonian is called blocking . We then solve the Schrödinger equation
in the renormalized subspace

  -- -------- -- --------
     @xmath      (2.45)
  -- -------- -- --------

The corresponding wavefunction @xmath is an approximation of the ground
state wavefunction, while @xmath gives an upper bound for the ground
state energy.

To obtain @xmath ,we perform the singular value decomposition (SVD) on
the subspace wavefunction

  -- -------- -- --------
     @xmath      (2.46)
  -- -------- -- --------

The left tensor @xmath thus corresponds to @xmath . However, since the
dimensions of @xmath and @xmath are @xmath , and the dimensions of
@xmath and @xmath are @xmath , the dimension of @xmath is up to @xmath .
To keep the bond dimension unchanged, we need to discard all but the
largest @xmath singular values. ¹ ¹ 1 Note that the truncation is
meaningful only when the left and right renormalized basis are
orthonormal. This is possible through the canonicalization of the MPS
tensors. Readers can refer to, e.g., Ref. [ 40 ] for an in-depth
discussion. The kept states, associated with the largest singular
values, have the strongest entanglement with the right part of the
system. The total norm of the discarded singular values, referred as the
discarded weight , and is an important indicator to quantify the
accuracy of DMRG calculations, and can be used to extrapolate to @xmath
limit. The process of renormalizing and truncating the left basis is
called decimation . Note that in each blocking and decimation step,
although two physical sites are explicitly involved, only the tensor on
one of them is updated. After updating @xmath , we continue to build the
new left and right renormalized basis @xmath and @xmath , and optimize
the next tensor @xmath . The backward sweep is similar but the direction
is reversed.

The algorithm we discuss here is often referred as the two-dot algorithm
since there are two orbitals involved in the block and decimation step.
There exists the one-dot algorithm in which the renormalized basis
@xmath is used instead of @xmath . However, there is no truncation in
the one-dot algorithm because the number of non-zero singular values is
only up to @xmath . Thus the wavefunction is not optimized at all during
the one-dot sweeps. In a DMRG calculations, one usually use the two-dot
algorithm to optimize the wavefunction and then perform the one-dot
sweeps to compute observables such as the density matrices.

When optimally implemented, the scaling of DMRG is @xmath per sweep for
general Hamiltonians including dense two-body interaction terms [ 98 ] .
Given @xmath , the computational error depends on the nature of the
system, and is guaranteed to decrease with increasing @xmath . Besides,
when the discarded weight is small enough, the energy and density
matrices have a linear relationship with the discarded weight. One can
thus perform DMRG calculations for several different bond dimensions
@xmath , and extrapolate to the @xmath limit (i.e. the exact ground
state) where the discarded weight is zero.

We notice the MPS ansatz in Eq. 2.41 requires ordering the orbitals. As
a result, the performance of DMRG is system dependent and orbital-order
dependent. In principle, the order can be arbitrary, but DMRG works best
when the entanglement between the bipartitions of the ordered orbitals
is minimized. For instance, gapped one-dimensional physical systems
usually require the same bond dimension @xmath for any length, resulting
in a cheap @xmath scaling for obtaining near-exact ground-state
solutions. In general, given the Hamiltonian and the orbital ordering,
for constant accuracy, @xmath scales exponentially with the entanglement
entropy between the bipartitions of the ordered orbitals. For
ground-state wavefunctions, the entanglement entropy often follows the
area law , i.e., being proportional to the contact area between the two
parts. In the example of 1D systems, the entanglement entropy is thus a
constant, and results in constant @xmath . For general quantum chemistry
Hamiltonians and orbitals, one can manually or use algorithms to find a
reasonable order by looking at the interaction integrals between
orbitals, thus minimizing the computational cost of DMRG.

In DMET calculations, we work with general quantum chemistry
Hamiltonians in the impurity model. We perform the calculations in the
so-call split localized orbitals [ 99 ] (or the quasiparticles in the
electron-like representation, as discussed in Sec. 2.3.2 ) which are
ordered using a genetic algorithm [ 100 ] . The implementation is
adapted from the BLOCK quantum chemistry DMRG package [ 101 , 102 ] ,
with the addition of broken particle-number symmetry and various
performance improvements. Because of the ability to treat up to @xmath
orbitals accurately within reasonable computational effort, DMRG is the
main impurity solver used in the thesis work.

#### 2.4.3 Auxliary Field Quantum Monte Carlo

Auxiliary field quantum Monte Carlo (AFQMC) [ 103 , 104 , 105 , 106 ] is
a stochastic method to obtain the ground state of a fermion Hamiltonian
[ 107 ] . It performs the imaginary time evolution of a trial
wavefunction

  -- -------- -- --------
     @xmath      (2.47)
  -- -------- -- --------

The time evolution is carried out using the second-order Trotter-Suzuki
decomposition,

  -- -------- -- --------
     @xmath      (2.48)
  -- -------- -- --------

where @xmath and @xmath are the one- and two-body parts of the
Hamiltonian.

Given any Slater determinant @xmath and any one-body operator

  -- -------- -- --------
     @xmath      (2.49)
  -- -------- -- --------

the canonical transformation @xmath can be carried out exactly, giving
another Slater determinant @xmath with the coefficient matrices

  -- -------- -- --------
     @xmath      (2.50)
  -- -------- -- --------

The matrix multiplication in Eq. 2.50 gives the @xmath scaling of the
AFQMC algorithm (where @xmath is the number of electrons per spin).
Starting with a Slater determinant trial wavefunction @xmath , the
propagation of the one-body Hamiltonian can be computed using Eq. 2.50 ,
by letting @xmath .

The propagation of the two-body part of the Hamiltonian is rewritten as
an multidimensional integral over one-body propagations using a
Hubbard-Stratonovich (HS) transformation [ 108 ]

  -- -------- -- --------
     @xmath      (2.51)
  -- -------- -- --------

by writing the two-body Hamiltonian as the summation of squares, using
the Hermitian symmetry of the two-body integrals. We diagonalize the
Hermitian matrix @xmath . (For simplicity, we use the spinless
notation.) Thus,

  -- -------- -- --------
     @xmath      (2.52)
  -- -------- -- --------

Since @xmath is Hermitian, we can symmetrize the expression as

  -- -------- -- --------
     @xmath      (2.53)
  -- -------- -- --------

where @xmath and @xmath . We thus have

  -- -------- -- --------
     @xmath      (2.54)
  -- -------- -- --------

And the time evolution of @xmath becomes

  -- -------- -- --------
     @xmath      (2.55)
  -- -------- -- --------

Unfortunately, this integral cannot be evaluated analytically. The
auxiliary field @xmath is sampled at each time slice to obtain a
stochastic representation of the propagation, and thus of the ground
state wavefunction @xmath as a sum of walkers.

In the thesis work, we use AFQMC as the impurity solver only for the
half-filled Hubbard model. In this case, a simplified discrete form of
HS transformation exists

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is a binary auxiliary field, and @xmath . Eq. 2.4.3 is
often termed spin decomposition , in contrast to another possible formed
called charge decomposition . The choice of different transformations
does affect the accuracy and efficiency of AFQMC calculations [ 109 ] .

In the thesis work, observables are calculated from the pure estimators,
where the summations are similarly sampled,

  -- -------- -- --------
     @xmath      (2.56)
  -- -------- -- --------

where, in the Hubbard case, @xmath . The energy may be computed using a
simpler estimator (the mixed estimator) where the propagation of the bra
is omitted.

The fermion sign problem arises because the individual terms in the
denominator of Eq. 2.56 can be both positive and negative (or complex in
the case of general two-body interaction) and lead to a vanishing
average with infinite variance. When there is a sign problem, a
constrained path approximation can be invoked in the calculation which
removes the problem with a gauge condition using a trial wavefunction [
110 , 111 , 112 ] . In certain models, however, such as the half-filled
repulsive Hubbard model on a bipartite lattice, the sign problem does
not arise because the overlap between every walker and the trial
wavefunction is guaranteed non-negative. It turns out that, in these
models, the DMET impurity model Hamiltonian is also sign-problem free as
long as certain constraints are enforced on the correlation potential.
For the half-filled Hubbard model on a bipartite lattice, the condition
is

  -- -------- -- --------
     @xmath      (2.57)
  -- -------- -- --------

where the parity term @xmath takes opposite signs for the two
sublattices. The derivation of this constraint is given in Appendix A.4
.

In cases where the sign problem is absent, AFQMC is an excellent
impurity solver which obtains the exact ground state (within statistical
error bounds) with @xmath computational cost. The algorithm can also be
massively parallelized, leading to fast solutions even for large
fragments. When the sign problem does exist, AFQMC is still a powerful
solver, although the results suffer from the uncontrolled constrained
phase (CP) error.

#### 2.4.4 Complete Active Space Methods

The complete active space (CAS) methods are widely used in quantum
chemistry to study systems with static (strong) correlation. The idea is
to choose a subset of strongly correlated orbitals as the active space,
and perform ED in the active space, while other orbitals are treated at
the mean-field level. The wavefunction ansatz in CAS calculations is

  -- -------- -- --------
     @xmath      (2.58)
  -- -------- -- --------

where @xmath is the number of electrons in the active space, @xmath are
core (occupied) orbitals label, @xmath are active orbitals labels and
@xmath are virtual (unoccupied) orbitals.

One can perform a one-shot CAS calculation to obtain the active space
coefficients @xmath , using orbital coefficients from, e.g.,
Hartree-Fock calculations. This is called the complete active space
configurational interaction (CASCI). To further improve the accuracy,
one can optimize the orbitals as well as the CI coefficients, which is
called complete active space self-consistent field (CASSCF) [ 113 , 114
] .

In DMET calculations where not all the orbitals in the impurity model
are strongly correlated, such as when dealing with ab initio
Hamiltonians, one can choose to use CASCI or CASSCF to reduce the
computational cost. In addition to ED, CASCI/CASSCF can also use DMRG or
AFQMC to solve the active space problem. In the thesis work, an
extension of CASCI and CASSCF to BCS quasiparticle active space are
implemented and applied. We follow the optimization scheme outlined in
Ref. [ 115 ] , and adapted from the CASSCF routine in PySCF ² ² 2
https://github.com/sunqm/pyscf . The details of the formulation are
described in Appendix A.3 .

### 2.5 Practical Issues

In this section, we introduce several topics encountered in practice.
Sec. 2.5.1 explains the various numerical tricks used in DMET to
accelerate the convergence of correlation potential. Sec. 2.5.2
introduces the dynamical cluster formulation of DMET to deal with the
problem of broken translational symmetry, which is undesirable in
various applications. In Sec. 2.5.3 we analyze the fragment size
convergence of cluster DMET and the dynamical cluster formulation.

#### 2.5.1 Correlation Potential Convergence

##### Direct Inversion in the Iterative Subspace

Because we do not update the impurity model solutions when fitting the
correlation potential, the convergence can be rather slow in the late
stage of DMET iterations. One scenario is, while the correlation
potential @xmath is optimized according to Eq. 2.16 , the correlated
density matrix @xmath and the mean-field density matrix @xmath move in
roughly the same direction, but since @xmath is not updated until next
DMET cycle, the step sizes we take are much smaller than the optimal.
Another scenario is that we take too large step sizes in changing @xmath
when @xmath and @xmath move in opposite directions. Of course many
situations are not so well defined, but from these examples one sees how
the convergence problem arises in DMET correlation potential
optimization.

These self-consistent field problems in have been known to quantum
chemists for decades. One classical method to accelerate convergence is
the direct inversion in the iterative subspace (DIIS) algorithm [ 116 ,
117 , 118 ] , which tries to predict the optimum using information from
the last few iterations.

In the context of DMET correlation potential fitting, after obtaining a
set of trial correlation potentials @xmath in previous cycles, we can
define the residual vector associated with @xmath as

  -- -------- -- --------
     @xmath      (2.59)
  -- -------- -- --------

We then approximate the optimal @xmath as a linear combination @xmath ,
i.e., @xmath , where the coefficients minimize the norm of the residual
vector correspond to @xmath , subject to the normalization condition

  -- -------- -- --------
     @xmath      (2.60)
  -- -------- -- --------

where @xmath . The minimization problem in Eq. 2.60 can be solved using
the Lagrangian multiplier

  -- -------- -- --------
     @xmath      (2.61)
  -- -------- -- --------

where @xmath . Thus

  -- -------- --
     @xmath   
  -- -------- --

or in matrix form

  -- -------- -- --------
     @xmath      (2.62)
  -- -------- -- --------

where @xmath is a @xmath vector filled with @xmath . In practice, we
turn on DIIS when @xmath is smaller than a certain threshold, and limit
the maximum dimension of vector @xmath , by kicking out the old trial
vectors. When chemical potential is also optimized, we use the joint
vector @xmath in DIIS.

##### Zero-Trace Condition

In broken particle-number symmetry calculations, another issue can arise
if the number of electrons in the lattice mean-field solution @xmath
that minimizes the cost function is different from the target value.
When we are sufficiently close to converging the correlation potential,
suppose the correlation potential is @xmath and @xmath before and after
the correlation potential fitting, while the chemical potential is
@xmath . Because the correlation potential is close to convergence, its
elements barely change except for those on the diagonal, which control
the number of electrons. Thus we assume @xmath , i.e., the diagonal been
shifted by a constant. Then in the next DMET iteration, we need to
increase (decrease) @xmath to @xmath so that the number of electrons of
@xmath equals to the target value (note that before the fitting in the
last DMET iteration, @xmath has the correct electron number, and that we
have the gauge invariance Eq. 2.18 ). Thus, although @xmath and @xmath
are updated in the last iteration, the mean-field wavefunction stays the
same; after solving the impurity model with chemical potential fitting,
the correlation potential and chemical potential will go back to @xmath
and @xmath ! This cycle will then go on forever, while the DMET solution
is not improving at all. Note that this is not a problem in normal state
DMET calculations, because shifting the diagonal elements of @xmath does
not change the lattice mean-field solution.

In broken particle-number symmetry calculations, one can simply add a
constraint on the mean-field number of electrons in the correlation
potential fitting step. However, this constraint is highly non-linear in
the parameter space, making the optimization much harder. Instead, we
simply require @xmath in the optimization (by projecting out the changes
in this direction at each step of the optimization), or even simpler,
use @xmath (where @xmath is the dimension of the @xmath ) after
converging the unconstrained optimization. The zero-trace condition is
turned on after a few initial iterations, which removes redundant the
degree of freedom between the diagonal of @xmath and @xmath . This
degree of freedom is optimized only during the chemical potential
fitting. This trick solves the problem above at an extremely low cost.

#### 2.5.2 Intracluster Translational Symmetry 333Based on work
published in Phys. Rev. B 95, 045103 (2017). Copyright 2017, American
Physical Society. [119]

Lattice DMET calculations with more than one orbitals in the fragment
(referred as cluster DMET, or CDMET) suffers from broken intracluster
translational symmetry due to the boundary effects (Fig. 2.1 ). The
violence of translational symmetry causes conceptual and practical
problems, such as the somewhat arbitrary measurement of observables in
CDMET calculations. The dynamical cluster approximation (DCA) [ 120 ,
121 , 122 ] , originated from the DMFT community, defines a
transformation of the lattice Hamiltonian such that the restriction to a
finite fragment retains the periodic boundary within the fragment, thus
restoring the intracluster translational symmetry (Fig. 2.1 ).

The DCA transformation involves two steps: a basis rotation which
redefines the lattice one-body Hamiltonian, and a coarse graining of the
two-body interaction [ 120 , 121 , 123 , 124 ] . To introduce the DCA
transformation, we first define the intra- and intercluster components
of the real and reciprocal lattice vectors (Fig. 2.2 ),

  -- -------- -- --------
     @xmath      (2.63)
  -- -------- -- --------

For simplicity we assume “hypercubic” lattices (in arbitrary dimension)
with orthogonal unit lattice vectors with linear dimension @xmath , and
“hypercubic” fragment with linear dimension @xmath . The corresponding
supercell lattice (of fragments) then has orthogonal lattice vectors of
magnitude @xmath , and the total number of supercells along each linear
dimension is @xmath .The intracluster lattice vector, @xmath and
reciprocal lattice vector @xmath where @xmath , and intercluster
components @xmath , @xmath , with @xmath , are uniquely defined for any
@xmath and @xmath .

Our goal is to obtain a Hamiltonian which is jointly periodic in the
intracluster and intercluster lattice vectors, @xmath and @xmath . Such
a jointly periodic basis is provided by the product functions @xmath .
From one-body Hamiltonian @xmath defined in reciprocal space, @xmath ,
and with the mapping in Eq. 2.63 , we identify the diagonal DCA
Hamiltonian matrix elements in the jointly periodic basis as

  -- -------- -- --------
     @xmath      (2.64)
  -- -------- -- --------

The inverse Fourier transformation then gives the DCA matrix elements on
the real-space lattice. The Fourier transforms between the different
single particle Hamiltonians are summarized as:

  -- -------- -- --------
     @xmath      (2.65)
  -- -------- -- --------

The resultant real-space matrix elements, @xmath , thus only depend on
the inter- and intracluster separation between sites. The transformation
from @xmath is simply a basis transformation of @xmath , with the
rotation matrix defined as [ 124 ]

  -- -------- -- --------
     @xmath      (2.66)
  -- -------- -- --------

Viewing the DCA transformation as a basis rotation suggests that the
same transformation should be extended to the interaction terms as well,
generating nonlocal interactions. However, in DCA one uses a
“coarse-grained” interaction in momentum space, which reduces the effect
of nonlocal interactions to within the fragment [ 123 ] . The
coarse-grained interaction is obtained by averaging the Fourier
transformed interaction term over the intercluster reciprocal vectors
for a given intracluster reciprocal vector.

A special case is the Hubbard model, where such coarse-graining leaves
the local @xmath term unchanged in the transformed Hamiltonian. Note
that the coarse-grained Hubbard interaction is nonlocal if transformed
back to the original site basis using the rotation in Eq. 2.66 .

We can thus perform DMET using the DCA transformed Hamiltonian. To
preserve intracluster translational symmetry of the DMET results, the
correaltion potential @xmath is also required to be translational
invariant within a fragment (See Appendix A.5 ). We refer this
formulation as DCA-DMET. We present the numerical tests of DCA-DMET, as
well as CDMET in Chapter 3 .

#### 2.5.3 Cluster Size Extrapolation 444Based on work published in
Phys. Rev. B 95, 045103 (2017). Copyright 2017, American Physical
Society. [119]

As discussed in Sec. 2.3.3 , extrapolation with the fragment size is an
important tool to improve upon finite fragment DMET results. In this
section, we present the theories of the cluster size scaling for energy
and intensive observables. We analyze both CDMET and DCA-DMET in the
Hubbard model on a @xmath -dimensional hypercubic lattice, although most
of the conclusions we derive here apply to other Hamiltonians as well.
For the energy, we use a perturbation argument to obtain the leading
term of the finite-size scaling; for the more complicated case of
intensive observables, we suggest a plausible scaling form.

We consider the following factors to derive the DMET finite-size scaling
for the Hubbard model: (a) the open boundary in CDMET; (b) the gapless
spin excitations of quantum antiferromagnets; (c) the coupling between
the impurity and bath; (d) the modification of the hoppings of the in
DCA-DMET.

We start with the CDMET energy. We first consider the bare fragment in
CDMET (i.e. without the bath) which is just the finite size truncation
of the infinite system. For a gapped system, we expect an open boundary
to lead to a finite-size energy error (per site) proportional to the
surface area to volume ratio [ 125 ] , i.e.

  -- -------- -- --------
     @xmath      (2.67)
  -- -------- -- --------

where @xmath is the energy per site for an @xmath site fragment and
@xmath is the energy per site in the thermodynamic limit (TDL). If, in
the TDL, there are gapless modes, a more careful analysis is required.
The Hubbard model studied here has gapless spin excitations. These yield
a finite size error of @xmath in a fragment with periodic boundary
condition (PBC) [ 126 , 127 , 128 , 129 ] , which is subleading to the
surface finite size error introduced by the open boundary in Eq. 2.67
for @xmath .

We next incorporate the CDMET bath coupling. Each site on the fragment
boundary couples to the bath, yielding a total Hamiltonian coupling of
@xmath per boundary site (see Fig. 2.3 ). The total “perturbation” to
the bare fragment Hamiltonian is then @xmath , which leads to a first
order energy correction per site. Thus, in CDMET, the open boundary and
the error in the bath orbitals together cause the leading contribution
to the finite size error

  -- -------- -- --------
     @xmath      (2.68)
  -- -------- -- --------

in any dimension.

For DCA-DMET, the above argument must be modified in two ways: first,
the fragment uses PBC, and second, the formulation modifies intercluster
and intracluster hoppings. Similarly, we start with the bare periodic
fragment (without any modification of the intracluster hoppings).

In the TDL, for a gapped state with short-range interactions, all
correlation functions decay exponentially (e.g. Wannier functions are
exponentially localized) and we expect an exponential convergence of the
energy with respect to fragment size.

However, in the Hubbard model, as previously mentioned, the gapless spin
excitations give a finite-size energy error (per site) of @xmath . The
leading order finite-size scaling for the bare periodic fragment is thus
expected to be

  -- -------- -- --------
     @xmath      (2.69)
  -- -------- -- --------

The DCA-DMET Hamiltonian modifies the periodic fragment Hamiltonian by
changing both the intracluster and intercluster hopping terms. The
intracluster hopping terms are modified by a term of order @xmath , and
the intercluster hopping terms are modified so as to generate a coupling
between each site in the fragment and the bath with a total interaction
strength of @xmath (see Fig. 2.3 ). Since there are @xmath sites in the
fragment, the total magnitude of the DCA-DMET perturbation (including
the contributions of both intracluster and intercluster terms) is @xmath
.

For one dimension, the perturbation and fragment-bath coupling give a
contribution with the same scaling as the contribution of the gapless
modes, while in two and higher dimensions, they give the leading term in
the finite-size error. Thus combining the three sources of finite-size
error we expect in any dimension the energy per site scaling of DCA-DMET
to be

  -- -------- -------- -- --------
     @xmath   @xmath      (2.70)
  -- -------- -------- -- --------

Note that the scaling of the CDMET and DCA-DMET energies is the same as
is found for CDMFT and DCA.

The finite size scaling of intensive quantities is more tricky to
analyze [ 130 ] . For an observable @xmath we have the relation @xmath ,
where @xmath is the correlation function. It is often argued that the
error in @xmath in a large finite fragment behaves like

  -- -------- -- --------
     @xmath      (2.71)
  -- -------- -- --------

where @xmath is the largest length in the fragment [ 128 ] @xmath . For
CDMET, where the cluster is only coupled to the symmetry-broken bath at
the boundary, we assume the form in Eq. 2.71 holds, with additional
corrections from the fragment size, expanded as a Taylor series

  -- -------- -- --------
     @xmath      (2.72)
  -- -------- -- --------

Eq. 2.72 is a heuristic form and its correctness will be assessed in our
numerical results in Chapter 3 . Taking the local magnetic moment @xmath
as an example, the correlation function @xmath at large @xmath behaves
like @xmath in the 1D Hubbard model, and @xmath in the 2D square-lattice
Hubbard model at half-filling. Consequently, we can assume a scaling
form in 1D of

  -- -------- -- --------
     @xmath      (2.73)
  -- -------- -- --------

and in 2D of

  -- -------- -- --------
     @xmath      (2.74)
  -- -------- -- --------

For DCA-DMET, however, every fragment site, not just those at the
boundary, is coupled to a set of bath orbitals, which provides a
symmetry-breaking pinning field. This means that there is no simple
connection to the scaling of correlation function (with respect to
distance) of the system. Thus, there is no obvious theoretical argument
for any form of scaling for the observables in DCA-DMET, and we can, at
best, assume the Taylor expansion in both one- and two-dimensions,

  -- -------- -- --------
     @xmath      (2.75)
  -- -------- -- --------

## Chapter 3 Cluster Size Convergence of the Density Matrix Embedding
Theory and Its Dynamical Cluster Formulation 111Based on work published
in Phys. Rev. B 95, 045103 (2017). Copyright 2017, American Physical
Society. [119]

We present in this chapter the numerical studies of cluster size
convergence of the energy and observables using two forms of DMET: the
original CDMET and the DCA-DMET, motivated by the dynamical cluster
approximation (see Sec. 2.5.2 ). Both methods are applied to the
half-filled one- and two-dimensional Hubbard models using a sign-problem
free AFQMC impurity solver (see Sec. 2.4.3 ), which allows for the
treatment of large impurity clusters of up to 100 sites. While CDMET is
more accurate at smaller fragment sizes, DCA-DMET exhibits faster
asymptotic convergence towards the TDL. In addition to investigating the
cluster size convergence scaling, these calculations produce accurate
estimates for the energy and local moment of the two-dimensional Hubbard
model for @xmath . The results compare favorably with the best data
available in the literature, and help resolve earlier uncertainties in
the moment for @xmath .

In Sec. 3.1 , we introduce the background and motivation of the study.
In Sec. 3.2 , we briefly describe the methods and parameters used in the
calculations. We present the calculation results in Sec. 3.3 and discuss
the implications of the results in Sec. 3.4 .

### 3.1 Introduction

An critical dimension in numerical studies of lattice models is the
ability to study the physical properties in TDL. To do so, one typically
considers finite sized clusters of increasing sizes under some choice of
boundary conditions, followed by a finite size scaling of the
observables. Embedding methods accelerate the finite size convergence,
by mapping the bulk problem onto an auxiliary impurity model, where a
small fragmen of the physical interacting sites is coupled to special
“bath sites” that mimic the effects of the neglected environment.

As discussed in Sec. 2.3.3 , the cluster size extrapolation is a great
tool to extend the scope of DMET studies. A detailed analysis of the
finite-size scaling of DMET not only is theoretically interesting, but
helps obtaining accurate TDL estimates in all future DMET studies.

In this chapter, we perform such a detailed investigation in the context
of the half-filled 1D and 2D square lattice Hubbard models using the
AFQMC impurity solver, implemented by Zhang, et. al. [ 103 , 104 ] .
Because of the absence of the sign problem, these models serve as an
excellent testing bed for the purpose, as we are able to study DMET
fragments with up to 100 fragment sites. Using this solver further
facilitates direct comparisons to bare (i.e. not embedded) AFQMC
calculations in the literature that used very large clusters (with up to
1058 sites) with periodic (PBC), anti-periodic (APBC), modified (MBC),
and twisted boundary (TBC) conditions [ 3 , 1 ] . The comparison
provides a direct demonstration of the benefits of embedding, versus
simply modifying the boundary conditions.

Similar to previously established scalings for CDMFT and DCA [ 125 , 130
, 131 , 132 , 133 ] , the CDMET and DCA-DMET converge @xmath and @xmath
from the theoretical analysis (Sec. 2.5.3 ). In this chapter, we perform
CDMET and DCA-DMET calculations on 1D and 2D Hubbard model at
half-filling for @xmath and @xmath , respectively, to confirm the
scalings of the TDL energies and to investigate the convergence of the
TDL spin-moments.

For the energies, our results provide high accuracy benchmarks with
small error bars. Converging finite-size effects for spin-moment has
well-known pitfalls, and existing data in the literature do not always
agree [ 5 , 6 , 2 , 3 , 1 ] . Where an agreement is observed, our new
estimates confirm the existing data with comparable or improved error
bars. In the case of @xmath where severe finite size effects are found,
our data resolves between the earlier incompatible estimates in the
literature.

### 3.2 Methods

The Hubbard Hamiltonian is defined as

  -- -------- -- -------
     @xmath      (3.1)
  -- -------- -- -------

where @xmath ( @xmath ) creates (destroys) a particle of spin @xmath at
site @xmath , @xmath denotes nearest neighbors, and @xmath .

We apply the standard spin-unrestricted, normal state CDMET algorithm
detailed in Appendix B.1 to the Hubbard models, with the following
modifications: (i) the correlation potential is restricted to preserve
the particle-hole symmetry so that the AFQMC impurity solver does suffer
from the sign problem (Eq. 2.57 ); and (ii) the chemical potential
fitting is skipped since @xmath at half-filling.

The DCA-DMET calculations are performed similarly with the modified
Hamiltonian described in Sec. 2.5.2 , which restores intracluster
translational symmetry. There is also stronger restrictions on the
correlation potential in DCA-DMET, as it preserves both the
translational and the particle-hole symmetry.

In the calculations of this chapter, we use the AFQMC impurity solver,
whose implementation described in Refs. [ 104 , 105 , 106 ] with small
modifications to treat Hamiltonians with broken @xmath symmetry ² ² 2
The implementation was done by Hao Shi and Shiwei Zhang. . Both the
energy and the one-body density matrix (required for the DMET
self-consistency) are computed by the pure estimator, Eq. 2.56 . We
converge the standard deviation of all elements in the one-body density
matrix to be less than 0.001, to make the AFQMC statistical errors (and
thus DMET statistical convergence errors) orders of magnitude smaller
than the finite cluster size error. This results in considerably higher
statistical accuracy for extensive quantities than typically obtained in
the AFQMC literature.

The finite fragment results are extrapolated to obtain TDL estimates
following the scalings suggested by the theoretical analysis in Sec.
2.5.3 . The quality of these extrapolations is assessed.

### 3.3 Results

We present the CDMET and DCA-DMET calculations on the half-filled 1D and
2D Hubbard models, focusing on the finite-size convergence of the energy
and local observables. As discussed in section 3.2 the DMET correlation
potential preserves @xmath symmetry but is allowed to break @xmath
symmetry. For the Hubbard models studied here, all the converged
self-consistent DMET solutions explicitly break @xmath symmetry.

In 1D, we compare our results against exact results from the Bethe
Ansatz (BA), while in 2D, we compare to literature benchmark data from
AFQMC calculations scaled to the TDL [ 6 , 3 , 1 ] , DMRG calculations
scaled to the TDL [ 2 ] , and iPEPS calculations scaled to zero
truncation error [ 4 ] .

#### 3.3.1 1D Hubbard Model

We study fragment clusters with @xmath sites on a DMET auxiliary lattice
with @xmath (even @xmath ) or @xmath (odd @xmath ) sites. The auxiliary
lattice uses PBC, and as the DCA-DMET impurity Hamiltonian becomes
complex for even @xmath , we only use auxiliary lattices with an odd
@xmath in the DCA-DMET calculations. We study two couplings @xmath
(moderate coupling) and @xmath (strong coupling). When starting from
uniform antiferromagnetic initial guesses for the correlation potential,
it usually takes 4 to 8 DMET iterations to converge the calculations.

Fig. 3.1 shows the energy per site as a function of inverse impurity
size @xmath . Statistical error bars associated with the AFQMC solver
are not shown here as they are too small to be visible; this is true for
all the CDMET and DCA-DMET results presented in this chapter. As shown
in Table 3.1 , the extrapolated energies are in generally good agreement
with the exact Bethe ansatz TDL data, with a deviation of less than
@xmath . To further improve the accuracy, we include the subleading
terms in the energy extrapolation, i.e. @xmath for CDMET and @xmath for
DCA-DMET (dashed lines in Fig. 3.1 ). This improves the extrapolated TDL
results significantly, with the single exception of DCA-DMET at @xmath ,
where the coefficient of the cubic term is not statistically significant
[ @xmath ] and the deviation is already very small. The subleading terms
are more important at @xmath than at @xmath . This is consistent with
the smaller gap at weaker coupling, that introduces stronger finite size
effects.

To further numerically test the scaling form for the DCA-DMET
extrapolation, we include a linear @xmath term in the DCA-DMET scaling
form, i.e. @xmath . While the coefficient of the linear term is
statistically significant at @xmath , the extrapolated TDL energy
acquires a larger uncertainty [-0.5749(6)], while for @xmath , the
coefficient of @xmath term becomes statistically insignificant [ @xmath
]. This supports the leading finite-size scaling of the DCA-DMET energy
per site as being @xmath . The finite size scaling of the energy
observed for CDMET and DCA-DMET is consistent with similar data observed
for CDMFT and DCA [ 130 , 123 ] .

In Fig. 3.1(a) , we plot the AFQMC results with periodic (PBC) and
twist-average (TABC) boundary conditions as well. While the PBC energy
oscillates strongly for all cluster sizes, the convergence of TABC is
much smoother. The finite-size scaling of bare cluster AFQMC (PBC and
TABC) appears to be quadratic in inverse size, which is consistent with
the spin-wave theory predictions in 1D [ 128 ] , and coincides with the
scaling of DCA-DMET. Therefore, with large clusters, the finite-size
errors of bare cluster AFQMC and DCA-DMET are comparable and smaller
than those of CDMET, while CDMET is much more accurate for small
fragments.

We now turn to the spin orders. Although there is no true long-range
antiferromagnetic (AF) order in 1D, the finite correlated fragment
calculations yield non-zero spin moments, which should extrapolate to
zero in the TDL. The local spin moments @xmath are plotted in Fig. 3.2 .
We see that the spin moments in the CDMET fragment are largest at the
boundary with the AF environment, and decay towards the center. We can
understand this because quantum fluctuations are incompletely treated in
the bath orbitals, and thus they are overmagnetized. This effect is
propagated to the boundary of the CDMET fragment. Note that the fragment
sites in a DCA-DMET cluster are all equivalent, and are equally coupled
to the environment, resulting in an equal spin magnitude for all sites,
to within the statistical error of the solver. In Fig. 3.2 we use the
two horizontal lines to represent the spin magnitudes from the DCA-DMET
calculations.

To determine the magnetic order parameter from CDMET, we consider two
possible definitions: (a) the average @xmath for the central pair (or
the plaquette in 2D); (b) the average @xmath over the entire fragment.
These definitions are equivalent for DCA-DMET. In CDMET, they agree in
the limit of small clusters ( @xmath ) and large clusters ( @xmath ),
but differ inbetween.

The AF order parameters for different fragment sizes are plotted in
Figs. 3.3 for different @xmath . For CDMET, we fit the order parameter
to the scaling form in Eq. 2.73 , up to second order. The fits are shown
in Figs. 3.3 (a), (b), and are quite good for both types of
measurements. For the average @xmath of the central pair, an almost
straight line is observed at both couplings, with the quadratic term
close to vanishing ( @xmath for @xmath and @xmath for @xmath ). The
average @xmath over the entire fragment requires a larger @xmath for a
good fit. This is because @xmath is measured at different points which
corresponds to averaging over different effective lengths @xmath in Eq.
2.73 . Averaging over Eq. 2.73 yields the same leading scaling but
introduces larger subleading terms. Overall, the error decreases much
more rapidly by using the center average, consistent with observations
in CDMFT [ 133 ] .

For DCA-DMET, the scaling form Eq. 2.75 truncated at second order works
well. This correctly predicts the vanishing local moments at the TDL (
@xmath at @xmath and @xmath at @xmath ). The @xmath scaling of DCA-DMET
thus converges faster than CDMET, whose leading term is @xmath .

While the smallest fragments in CDMET report a smaller magnetization
than seen in DCA-DMET (and thus can be regarded as “closer” to the TDL)
the cross-over between the DCA-DMET and CDMET moments occurs at smaller
clusters than for the energy.

#### 3.3.2 2D Hubbard Model

We now show results from the half-filled 2D Hubbard model at @xmath . We
use square fragments of size @xmath , where for CDMET @xmath and for
DCA-DMET @xmath . The @xmath plaquette is not used in the finite-size
scaling of DCA-DMET as it is known from DCA studies to exhibit anomalous
behavior [ 130 ] , which we also observe. Also at @xmath , we do not
present results for @xmath , as we are unable to converge the
statistical error to high accuracy in the AFQMC calculations (within our
computational time limits). The total lattices we used have linear
lengths of around @xmath ( @xmath ), adjusted to fit even (CDMET) or odd
(DCA-DMET) @xmath , as in the 1D case. As in 1D, we initialize the
correlation potential as a diagonal matrix with uniform AF terms. The 2D
calculations thus take slightly more self-consistent iterations (about
10) than in 1D to converge.

In Fig. 3.4 , we show the cluster size dependence of the energy per
site; the data is tabulated in Table 3.2 . Because there are no exact
TDL results for the 2D Hubbard model, we show gray ribbons as “consensus
ranges”, obtained from the TDL estimates of several methods including
(i) AFQMC extrapolated to infinite size [ 3 , 1 ] , (ii) DMRG
extrapolated to infinite size [ 2 ] , and (iii) iPEPS extrapolated to
zero truncation error [ 4 ] . To show the effects of embedding versus
bare cluster AFQMC calculations we also plot the AFQMC results of Ref. [
1 ] on finite lattices with up to 400 sites, using TABC for @xmath , as
well as periodic (PBC) and anti-periodic (APBC) boundary conditions for
@xmath .

In 2D, both CDMET and DCA-DMET appear to display much higher accuracy
for small fragments, compared to in 1D. Although DMET is not exact in
the infinite dimensional limit, this is similar to the behavior of DMFT,
which improves with increasing coordination number [ 44 ] . The DMET
energies for each fragment size are, as expected, much closer to the TDL
estimates than the finite system AFQMC energies, even when twist
averaging is employed to reduce finite size effects. For example, the
@xmath CDMET energy is competitive with the @xmath AFQMC cluster energy
with twist averaging. Further, the convergence behavior generally
appears smoother in DMET than with the bare clusters, likely due to
smaller shell filling effects. Combining these benefits, we find that
using DMET gives several orders of magnitude savings in computation time
to achieve a given energy accuracy in the TDL estimate, as compared to
using bare cluster calculations alone. This illustrates the benefits of
using bath orbitals to approximately represent the environment in an
embedding.

We now discuss our TDL estimates. As in the 1D Hubbard model, we use the
scaling forms proposed in Sec. 2.5.3 , i.e. @xmath for CDMET and @xmath
for DCA-DMET. The results are summarized in Table 3.2 and plotted in
Fig. 3.4 . The TDL energy estimates fall within the TDL consensus range,
with an error bar competitive with the best large-scale ground state
calculations. The DMET estimates are also all in agreement (within 2
@xmath ) of our earlier CDMET extrapolations that only used fragments of
up to @xmath sites in Refs. [ 92 , 2 ] . The largest deviation from our
earlier small fragment DMET extrapolations is for @xmath where finite
size effects are strongest; the current estimates of @xmath (CDMET) and
@xmath (DCA-DMET) can be compared with our small fragment estimate of
@xmath , and the recent TDL estimate of Sorella of @xmath , obtained by
extrapolating AFQMC energies from clusters as large as 1058 sites, using
modified (periodic) boundary conditions [ 3 ] . Note that the subleading
terms are more important for accurate extrapolations in 2D than they are
in 1D. This is simply because we do not reach as large linear dimensions
in 2D as in 1D, which means that we are not fully in the asymptotic
regime. For the same reason it is more difficult to see the crossover
between the convergence of DCA-DMET and CDMET. For @xmath , it appears
advantageous to use the DCA-DMET formulation already for fragments of
size @xmath , while at @xmath it appears necessary to go to fragments
larger than the largest linear size used in this study, @xmath .

The AF order in the half-filled 2D Hubbard model is long-ranged in the
ground state. In the left part of Fig. 3.5 , the AF order parameters
from DMET finite fragment calculations are plotted and extrapolated,
with the right panel showing comparisons of TDL estimates with the other
methods. In addition, we summarize the extrapolated TDL estimates for
the AF order parameters in Table. 3.3 . For CDMET, the order parameters
are measured as the average magnitude of the central plaquette. We fit
the magnetization data to the form suggested in Section 2.5.3 , i.e.
@xmath for both CDMET and DCA-DMET. These fits lead to good agreement
between the CDMET and DCA-DMET TDL estimates, supporting the scaling
form used. At @xmath , the CDMET and DCA-DMET TDL moments are in good
agreement with the estimates from two different AFQMC calculations, with
competitive error bars. At @xmath , the CDMET TDL moment is consistent
with the two AFQMC estimates although the DCA-DMET estimate is somewhat
smaller than the two AFQMC estimates. (We do not have errors bars for
the @xmath DCA-DMET moment as we are fitting 3 data points to a 3
parameter fit).

The TDL magnetic moment at @xmath is an example for which current
literature estimates are in disagreement. While earlier AFQMC
calculations in Refs. [ 5 , 6 , 2 ] appear to give an estimate close to
@xmath , the AFQMC estimates from recent work of Sorella [ 3 ] and Qin
et al [ 1 ] ³ ³ 3 The AFQMC result of antiferromagnetic order parameter
at @xmath in Ref. [ 2 ] has an error in the extrapolation to the TDL,
which was corrected in Ref. [ 1 ] . using larger clusters and modified
and twist average boundary conditions predict a moment of @xmath and
@xmath , respectively. This is much closer to our earlier DMET result of
@xmath extrapolated from small clusters of up to @xmath in size.
Revising this with the larger CDMET and DCA-DMET clusters in this work
we can now confirm the larger value of the TDL magnetic moment, @xmath
(CDMET) and @xmath (DCA-DMET) with very small error bars. The
underestimate of the moment seen in earlier QMC work is likely due to
the non-monotonic convergence of the moment with cluster size when using
PBC, as identified in Sorella’s work [ 3 ] . In contrast to PBC
calculations and the TABC calculations shown here (orange) which display
some scatter, the dependence on fragment size is very mild once
embedding is introduced. This once again highlights the ability of the
embedded approach to capture some of the relevant aspects even of
long-wavelength physics, leading to good convergence of local
observables.

### 3.4 Conclusions

We carried out a detailed study of the fragment size convergence of
density matrix embedding theory, using an auxiliary field quantum Monte
Carlo solver (AFQMC) in order to large cluster sizes inaccessible from
other impurity solvers. In addition to the cluster density matrix
embedding formulation (CDMET), we study the “dynamical cluster” variant
(DCA-DMET) that restores translational invariance in the fragment and
accelerates finite size convergence. Using the half-filled one- and
two-dimensional Hubbard models where AFQMC has no sign problem, as
examples, we numerically explored the finite size convergence of the
energy and the magnetization. The energy convergence of CDMET and
DCA-DMET goes like @xmath and @xmath respectively, where @xmath is the
linear dimension of the fragment, similar to that observed in cellular
dynamical mean-field theory and the dynamical cluster approximation. The
convergence of the magnetization follows a scaling relation related to
the magnetic correlation function in CDMET, while the DCA-DMET converges
more quickly than CDMET. In the case of the 2D Hubbard model, our
thermodynamic limit extrapolations from both CDMET and DCA-DMET are
competitive with the most accurate estimates in the literature, and in
the case of @xmath where finite size effects are particularly strong,
help to determine the previously uncertain magnetic moment.

In all the cases we studied in this chapter, the use of density matrix
embedding, as compared to computations using bare clusters with any form
of boundary condition, significantly decreased the computational cost
required to obtain a given error in the TDL estimate, sometimes by
orders of magnitudes. Since the computational scaling of the AFQMC
solver employed here is quite modest with fragment size (cubic) this
improvement would only be larger when using other, more expensive
solvers.

The DCA-DMET formulation appears superior for large fragments due to the
faster asymptotic convergence, however, it is typically less accurate
for small fragments than CDMET. When performed in conjunction, the
consistency of TDL estimates from CDMET and DCA-DMET serves as a strong
check on the reliability of the DMET TDL extrapolations.

## Chapter 4 Ground-State Phase Diagram of the Square Lattice Hubbard
Model 111Based on work published in Phys. Rev. B 93, 035126 (2016).
Copyright 2016, American Physical Society. [92]

In this chapter, we present the ground-state phase diagram of the
Hubbard and frustrated Hubbard models (with non-zero
next-nearest-neighbor hopping) on the square lattice with density matrix
embedding theory using clusters of up to 16 sites. We provide an error
model to estimate the reliability of the computations and complexity of
the physics at different points in the diagram. We find
superconductivity in the ground-state as well as competition between
inhomogeneous charge, spin, and pairing states at low doping. The
estimated errors in the study are below @xmath in the cuprates and on
the scale of contributions in real materials that are neglected in the
Hubbard model.

In Sec. 4.1 , we introduce the background of the study, focusing on the
physics of the 2D Hubbard model. In Sec. 4.2 , we present the detailed
specifications of our DMET calculations and in a separate Section 4.3 we
discuss the techniques to quantify the errors in the TDL estimates. We
present the results and conclusions of our calculations in Sec. 4.4 and
Sec. 4.5 .

### 4.1 Introduction

The Hubbard model [ 134 , 135 , 136 ] is one of the simplest quantum
lattice models of correlated electron materials. Its one-band
realization on the square lattice plays a central role in understanding
the essential physics of high temperature superconductivity [ 137 , 61 ]
. Rigorous, near exact results are available in certain limits [ 138 ] :
at high temperatures from series expansions [ 139 , 140 , 141 , 142 ] ,
in infinite dimensions from converged dynamical mean-field theory [ 143
, 44 , 144 , 145 ] , and at weak coupling from perturbation theory [ 146
] and renormalization group analysis [ 147 , 148 ] . Further, at
half-filling, the model has no fermion sign problem, and unbiased
determinantal quantum Monte Carlo simulations can be converged [ 5 ] .
Away from these limits, however, approximations are necessary. Many
numerical methods have been applied to the model at both finite and zero
temperature, including fixed-node, constrained-path, determinantal, and
variational quantum Monte Carlo (QMC) [ 149 , 150 , 151 , 152 , 111 ,
153 , 154 , 155 , 156 , 157 , 158 ] , density matrix renormalization
group (DMRG) [ 159 , 160 , 67 ] , and dynamical cluster (DCA) [ 120 ,
121 ] , (cluster) dynamical mean-field theories (CDMFT) [ 161 , 162 ] ,
and variational cluster approximations (VCA) [ 163 , 164 ] . (We refer
to DCA/CDMFT/VCA collectively as Green’s function cluster theories).
These pioneering works have revealed rich phenomenology in the phase
diagram including metallic, antiferromagnetic, @xmath -wave (and other
kinds of) superconducting phases, a pseudogap regime, and inhomogeneous
orders such as stripes, and charge, spin, and pair-density waves, as
well as phase separation [ 138 , 158 , 149 , 161 , 150 , 157 , 67 , 156
, 153 , 154 , 165 , 166 , 167 , 168 , 169 , 170 , 171 , 172 , 173 , 174
, 175 , 176 , 70 , 177 , 178 , 179 , 180 , 181 , 182 , 183 ] . However,
as different numerical methods have yielded different pictures of the
ground-state phase diagram, a quantitative picture of the ground-state
phase diagram has yet to emerge.

It is the goal of this numerical study to produce such a quantitative
picture as best as possible across the full Hubbard model phase diagram
below @xmath . We perform the calculations on the Hubbard model with the
density matrix embedding theory (DMET), which is very accurate in this
regime [ 54 , 55 , 184 , 87 , 185 , 186 , 85 , 80 ] , together with
clusters of up to 16 sites and thermodynamic extrapolation. We carefully
calibrate errors in our calculations, giving error bars to quantify the
remaining uncertainty in our phase diagram. These error bars also serve,
by proxy, to illustrate the complexity of the underlying physics for
different Hubbard parameters. The accuracy we achieve is significantly
higher than attained by earlier comparable Green’s function cluster
calculations for the ground state. We also carefully estimate the finite
size effects, which we find to have a crucial impact on the location of
the phase boundaries of the antiferromagnetic and @xmath -wave
superconducting (SC) orders, in contrast to some early ground-state
studies [ 167 ] .

### 4.2 Methods

We study the one-band (frustrated) Hubbard model on the @xmath square
lattice

  -- -------- -- -------
     @xmath      (4.1)
  -- -------- -- -------

where @xmath and @xmath denote nearest and next-nearest neighbors,
respectively, @xmath destroys (creates) a particle on site @xmath with
spin @xmath , and @xmath is the number operator. The standard Hubbard
model corresponds to @xmath (we fix @xmath ). We further study the
frustrated model with @xmath .

We use the broken particle-number symmetry, spin-unrestricted DMET
formulation in this chapter. The basic principles of the method are
outlined in Sec. 2.3 , with detailed equations and algorithms presented
in Appendix B.2 . To obtain the ground-state phase diagram, we carry out
DMET calculations using 2 @xmath 2, 4 @xmath 2, 8 @xmath , and 4 @xmath
4 fragments, cut from a bulk square lattice with @xmath . We considered
@xmath , and @xmath , and various densities between @xmath . The
impurity model ground-state @xmath is determined using a DMRG solver
with a maximum number of renormalized states @xmath (DMET
self-consistency is performed up to @xmath ), and which allows for
@xmath and @xmath spin symmetry breaking (see Sec. 2.4.2 and Appendix
A.2 ). The energy per site @xmath , local spin moment @xmath , double
occupancy @xmath , and local @xmath -wave pairing @xmath were measured
from the fragment part of @xmath .

Local observables either are close to uniform in the entire fragment or
exhibit tendencies to inhomogeneity. In the former case, we average the
local observables in the central plaquette (so the average is consistent
for all fragment sizes) and extrapolated to the thermodynamic limit
(TDL) using a linear relationship with @xmath as verified in Chapter 3 .
For the later case, reliable average and extrapolation are usually not
possible, and we report these case as inhomogeneous order where a single
order parameter cannot be extracted.

### 4.3 Error Estimation

The finite fragment DMET energies and measurements contain 3 sources of
error relative to the exact TDL. These are from (i) errors in the DMET
self-consistency, (ii) finite @xmath in the DMRG solver (This is only
significant for the @xmath and @xmath clusters, corresponding to 32
fragment plus bath sites in the impurity model.),which also induces
error in the correlation potential @xmath , (iii) finite fragment size.
The error from the use of a finite @xmath bulk lattice is so small as to
not affect any of the significant digits presented here.

To estimate the TDL result, we (i) estimate DMET self-consistency
quality by the convergence of expectation values in the last iterations,
(ii) extrapolate DMRG energies and expectation values at finite @xmath
to infinite @xmath , using the linear relation with DMRG density matrix
truncation error [ 187 ] , (iii) estimate the error in @xmath due to
finite @xmath , by extrapolating expectation values from self-consistent
@xmath obtained with different solver accuracy, (iv) extrapolate
fragment size to infinite size, with the @xmath scaling appropriate to a
non-translationally-invariant fragment (Sec. 2.5.3 ). Each of (i) to
(iv) gives an estimate of an uncertainty component (for linear
extrapolations, we use the 1 @xmath standard deviation), which we
combine to obtain a single error bar on the DMET TDL estimates.

We use the energy per site as an example to discuss the error estimation
in detail. The DMET self-consistency error is estimated as @xmath ,
where @xmath and @xmath are the energies per site of the last two DMET
self-consistency iterations. A typical DMET calculation oscillates
between two slightly different solutions with the magnitude of the
oscillations decreasing with the number of iterations. We thus use the
range of oscillation as a representation of the self-consistency error.
The error distributions across the range of calculations in this chapter
are shown in Fig. 4.1 , with the average values on the side. For most
points in the phase diagram, and for all fragment sizes, the
self-consistency error is less than @xmath . For @xmath fragments DMET
calculations are the harder to converge, due to larger error in the
impurity solvercalculations, giving a largest error of up to @xmath ,
and an average self-consistency error approximately twice as large as
that for the other fragment shapes.

For fragments larger than the @xmath 2 fragment (where our DMRG solver
is not exact), there is the error due to using finite @xmath in the DMRG
impurity solver. The error due to finite @xmath has two components:

1.  variational error in the DMRG calculation, which is usually assumed
    proportional to the density matrix truncation error @xmath ,

2.  the DMET correlation potential error @xmath , as @xmath is a
    function of the impurity density matrices, and these have an error
    for finite @xmath .

For the @xmath and @xmath fragments, the second source @xmath appears
negligible. For these clusters, we carry out the DMET self-consistency
with smaller @xmath to obtain the converged correlation potential @xmath
, then do a few DMRG calculations using large @xmath with fixed
correlation potential @xmath to extrapolate to the @xmath exact solver
limit, thus obtaining the first error component due to the DMRG solver.

For @xmath fragments, the @xmath data is processed in this way as well.
However, for other values of @xmath using the @xmath fragments, the DMRG
truncation error can reach @xmath for low to intermediate doping with
computational tractable @xmath , making the contribution from @xmath
significant. To compensate for this, we first carry out the DMET
self-consistency cycles with a series of different @xmath ’s up to 1200
, and linearly extrapolate the energy to the @xmath limit, @xmath . This
thus extrapolates errors from both source 1 and 2, assuming @xmath .
Another further set of DMRG calculations are done with @xmath up to
2000, using the converged correlation potential from the DMET
self-consistency with the largest @xmath . This second set of results
are then extrapolated again against the truncated error to obtain an
energy @xmath , which only accounts for the error from source 1.
Although the linear relation between the source 2 error and the
truncation error need not hold in general, in practice, we find that
@xmath gives a reasonable estimate of @xmath . Therefore, we report the
@xmath fragment energy per site as @xmath , with a final uncertainty of

  -- -------- -- -------
     @xmath      (4.2)
  -- -------- -- -------

where @xmath is a combination of the linear regression uncertainty and
the uncertainties of the original data points (from DMET
self-consistency error), while @xmath does not have any self-consistency
error. Fig. 4.2 illustrates the set of computations and linear
extrapolations performed with each @xmath cluster to obtain the @xmath
cluster energy and error estimate.

After obtaining the energy per site and other observables for each
fragment size, we extrapolate to the TDL using the relation @xmath .
Since both the @xmath and @xmath fragments are of 16 sites, we must
choose which one to use in the extrapolation. We believe that the @xmath
fragments have less finite size error than the @xmath fragments, and
thus we generally use these in the extrapolation. However, at certain
points in the phase diagram (e.g. at strong coupling, or negative @xmath
) there is a strong tendency towards inhomogeneity, and the new order
the new order the @xmath fragments, resulting in a much higher energy
than for the @xmath fragments. In such cases, namely, when (a) the
@xmath and @xmath fragments show different orders, and (b) the @xmath
cluster is lower in energy, we use the @xmath cluster energy for the
extrapolation.

The fragment size extrapolation works considerably well given the
limited number of data points and small sizes of the clusters, although
it contributes the main source of error in the uncertainty of TDL
estimates. In Fig. 4.3 we show examples of the finite size extrapolation
at @xmath . The error bars shown for TDL estimates include both the
error from the linear extrapolation and the propagated uncertainties
from the finite fragment calculations. At half-filling and in the
overdoped region ( @xmath ), the linear relation appears quite good even
with these small clusters. In the underdoped region, however, the energy
per site is more strongly dependent on the cluster shape, often because
the system has a strong tendency to establish an inhomogeneous phase
(see Sec. 4.4 for detail). Nontheless, even in the underdoped region,
the error model appears to give a reliable estimate of the energy per
site at the TDL, albeit with a large uncertainty.

Fig. 4.4 shows the uncertainties of the energy per site TDL estimates
for all the points in our calculations. As one would normally expect,
the accuracy away from half filling is significantly lower than at half
filling, with the largest errors found in the underdoped region of
@xmath , where the solution is sensitive to cluster shapes because of
phase boundaries and/or the onset of competing inhomogeneous orders,
thus introducing the largest errors from fragment size extrapolation. We
also see from the Fig. 4.4 that the maximum uncertainty for @xmath is
smaller than that for @xmath and @xmath ( @xmath versus @xmath and
@xmath , respectively), implying the completing order effect is weaker
for positive @xmath than in the zero or negative @xmath case.

We discussed energies per site in this section as an example. The order
parameters are extrapolated to the TDL and the uncertainties associated
with them are estimated, following the same procedure. Whenever
necessary, we use the @xmath -score (estimated value divided by its
standard deviation) to describe the robustness of the order.

### 4.4 Results

The quantitative analysis of the sources of error gives us confidence to
distinguish the physics from artifacts in the orders we see from DMET
calculations. We now look at the calculation results and try to
interpret them, with the map of uncertainties (Fig. 4.4 ) in mind.

In Sec. 4.4.1 , we present the phase diagram using our TDL estimates of
the all the parameter sets. In the subsequent sections we analyze the
results of different regions of the phase diagram in greater detail.

#### 4.4.1 Overview

We present the DMET phase diagrams in Fig. 4.5 . Interestingly, they
feature many behaviors previously proposed in different studies. In
particular, we observe (i) an antiferromagnetic (AF) phase at
half-filling; (ii) a metallic phase at large dopings and at small @xmath
, enhanced by frustration; (iii) a region of @xmath -wave
superconducting (SC) order at intermediate dopings and sufficiently
large @xmath ; (iv) a region of coexisting AF and SC order; (v) a region
rich with inhomogeneous charge, spin, and superconducting orders that
are very sensitive to the Hubbard parameters; (vi) points in between the
AF and SC phase where the AF and SC orders extrapolate to zero. (The
metallic phase is predicted to be unstable at weak coupling and large
dopings from weak coupling expansions [ 188 , 148 ] , but the relevant
parameter region is outside the scope of this study.) At @xmath ,for
@xmath ,an SC state with strong inhomogeneity appears which creates
large uncertainties in the extrapolated order parameters; thus, the
precise location of the SC phase boundary at @xmath is uncertain.
Overall, the existence of all the phases and their boundaries are
consistent with the general understandings of the 2D Hubbard model.

In Fig. 4.6 , we show the estimated TDL energies across the parameter
space. At half-filling, the energy in the frustrated models @xmath are
slight below those in the standard Hubbard model, due to the kinetic
energy relaxation. The effect is smaller for larger @xmath where the
electrons are more confined. At large doping, e.g., @xmath , the energy
order is dominated by the kinetic effects, i.e. @xmath . The energy
curves show more complicated behavior in the underdoped region,
especially at large @xmath and for @xmath and @xmath , indicating
complicated behaviors in this region, as we will discuss later.

#### 4.4.2 Half-Filling Results

We now look at the results for the half-filled case in detail. In Table
4.1 and Fig. 4.7 we compare the DMET energies per site, double
occupancies, and staggered magnetizations with exact estimates at
half-filling, as obtained from auxiliary field quantum Monte Carlo
(AFQMC) extrapolated to infinite size [ 1 ] , and DMRG on long open
cylinders, extrapolated to infinite width and length [ 2 ] . For
comparison, we also show recent DCA energies computed at the lowest
published temperatures, @xmath t [ 7 ] .

The data shows the high accuracy of the DMET energies at half filling.
The error bars from DMET, AFQMC, and DMRG are all consistent, with an
accuracy better than 0.001 @xmath . Indeed, the DMET error bars are
competitive with the exact “statistical” error bars of AFQMC up to
@xmath . As a point of reference, the DMET uncertainty is one to two
orders of magnitude smaller than finite temperature contributions to
recent low-temperature benchmark DCA calculations (Fig. 4.7 ), and is
similarly two to three orders of magnitude smaller than energy errors in
earlier zero-temperature Green’s function cluster calculations [ 189 ] .

Fig. 4.7 further gives the half-filling staggered magnetizations and
double occupancies computed with DMET as compared with AFQMC. The DMET
double occupancies are obtained with similar error bars to the AFQMC
estimates, suggesting the good agreement of the total energy is not from
an effect of error cancellation. The staggered magnetization exhibits
larger discrepancies at the smallest @xmath , but with later revised
AFQMC estimates @xmath the agreement is excellent [ 1 ] . For @xmath ,
DMET gives similar, or in fact more accurate staggered magnetization
than AFQMC. At our largest available @xmath , we find @xmath , slightly
above the exact Heisenberg value @xmath [ 8 ] (corresponding to @xmath
limit).

The staggered magnetization for the frustrated Hubbard models at half
filling (compared to the @xmath standard Hubbard model and the
Heisenberg limit) are shown in Fig. 4.8 . Because of the particle-hole
parity, the magnetization curve is identical for @xmath . The onset of
antiferromagnetism is at finite @xmath in the frustrated model,
somewhere between @xmath and @xmath . This is consistent with previous
quantum Monte Carlo simulations [ 190 ] .

The large error bar at @xmath reflects the increasing quantum
fluctuations near the phase boundary, leading to multiple possible
solutions in self-consistent embedding methods. The results are thus
sensitive to initial conditions and fragment shape, etc., resulting in a
huge uncertainty in the TDL results.

#### 4.4.3 Doped Hubbard Model in Weak to Moderate Coupling

The impressing accuracy of half-filling results lend confidence to the
DMET TDL estimates of the energy per site and observables and their
associated error bars. The same procedure is used to compute the
quantities and error bars for the doped Hubbard model.

We start with @xmath . For benchmark purpose, we compare the energies
per site from DMET, DMRG and the constrained path (CP) AFQMC, a
sign-free QMC with a bias that disappears at low density and small
@xmath [ 111 , 153 ] in Table. 4.2 . For @xmath , a parameter regime
where CP-AFQMC is very accurate, the DMET and CP-AFQMC energies agree to
@xmath , while the error bars from DMET, CP-AFQMC and DMRG are
comparable in the underdoped region.

Fig. 4.9 shows the averaged (over the central plaquette) AF and @xmath
-wave SC order parameters as a function of filling for @xmath . As
expected, the SC order lives at the proximity of the AF order and is a
small effect compared to the magnetization. We find that for @xmath ,
the peak in SC order is around @xmath and SC extends to @xmath 0.8. The
figures also show that next-nearest-neighbor hopping @xmath stabilizes
AF versus SC, and the reverse is true for @xmath . The suppression
(enhancement) of SC order with positive (negative) @xmath is consistent
with the stronger superconductivity found in hole-doped materials [ 191
, 192 , 193 ] .

The presence of SC in the Hubbard model ground-state has previously been
much discussed. The strongest SC order found in DMET roughly occurs in
the same region as seen in earlier Green’s function cluster calculations
[ 167 , 173 ] . However, this region is not typically found to be
superconducting in ground-state wavefunction calculations using DMRG and
AFQMC on finite lattices, even though such calculations achieve
significantly higher energy accuracies than the Green’s function cluster
studies [ 154 , 67 , 194 , 2 ] . The significance of the DMET result is
that the energy error bar in this region (e.g., @xmath per site for
@xmath ) is comparable to or better than the accurate ground-state
wavefunction calculations, yet SC order is still seen. This strongly
suggests that SC is, in fact, the ground-state order.

Even at moderate @xmath , there is already tendency towards
inhomogeneity. The @xmath fragment calculations result in an
inhomogeneous state at dopings @xmath to @xmath , although the energies
are significantly higher than obtained with the @xmath fragments at the
same fillings. In Fig. 4.10(b) and 4.10(c) , we show two such examples
with spin and pairing modulation. As a comparison, we show the @xmath
result (Fig. 4.10(a) ) with the same doping to verify that this is not
an artifact. Table 4.3 further shows the energies per site in the
underdoped region at @xmath . All the @xmath fragment calculations are
homogeneous, while some of the @xmath calculations give an inhomogeneous
solution, at a higher energy, suggesting that the ground state at @xmath
is homogeneous, or inhomogeneous with a very long wavelength that does
not fit in our cluster shapes.

We then briefly discuss results at weak coupling @xmath . We find the
antiferromagnetism (in the standard Hubbard model) is destroyed already
at small doping @xmath away from half-filling. (For the frustrated
Hubbard model there is no AF order even at half-filling) While the
extrapolated AF order is zero, the uncertainty @xmath is still large (
@xmath at @xmath ), reflecting short-range AF fluctuations still exist.
@xmath decays exponentially as we increase doping. At @xmath we do not
find @xmath -wave superconductivity to within in numerical precision.

#### 4.4.4 Doped Hubbard Model in Stronger Coupling

The stronger coupling region of the 2D Hubbard model has a more direct
connection with the cuprate physics. We are most interested in the
underdoped region between the AF and the SC phases. In this region, a
variety of spin-density [ 195 , 169 , 175 , 154 , 196 , 197 , 169 , 171
, 172 , 175 ] , charge-density [ 198 , 199 , 200 , 154 ] , pair-density
wave [ 72 , 200 , 76 , 201 ] , and stripe orders [ 202 , 203 , 159 , 67
, 204 , 205 , 197 , 70 , 177 ] , have been posited in both the Hubbard
model and the simpler @xmath - @xmath model. These inhomogeneous phases
are proposed to be relevant in the pseudogap physics [ 69 , 71 , 72 , 74
, 73 , 75 , 76 ] . Recent infinite projected entangled pair state
(iPEPS) studies of the @xmath - @xmath model and Hubbard model at large
@xmath suggest that inhomogeneous and homogeneous states are near
degenerate at low doping and can be stabilized with small changes in the
model parameters [ 205 , 4 ] .

Our work indicates similar behavior in the Hubbard model. For large
@xmath and low doping @xmath we find many points with inhomogeneous
orders. Interestingly, the kinds of inhomogeneity we observe are
extremely rich, and some representative examples are shown in Fig. 4.11
. These correspond to (i) a local phase separation between a half-
filled, antiferromagnetic phase and a superconducting ribbon [Fig.
4.11(a) ]; (ii) a classic stripe phase order [Fig. 4.12(c) ] very
similar to that seen in earlier DMRG ladder studies [ 67 ] (there is
also a coexisting weak PDW, exhibiting a sign change across the cell,
consistent with earlier stripe proposals [ 201 ] ); (iii)
inhomogeneities in the pairing order coexisting with the charge and spin
orders in, e.g., Fig. 4.11(c) , similar to a recent theoretical proposal
(see, e.g., Ref. [ 76 ] ). Fig. 4.11(c) shows an example at 1/8 doping
with positive @xmath , where the inhomogeneity is much weaker. Again the
next-nearest-neighbor hopping @xmath plays an important role in
stablishing or destroying the inhomogeneous orders, providing an
explanation for the particle-hole asymmetry in cuprates.

We also see from the results how the inhomogeneity develops with
increasing interaction @xmath . Fig. 4.12 shows the inhomogeneous
patterns in @xmath fragments and their energies per site relative to
those of @xmath fragments at the same doping ( @xmath ) for @xmath from
@xmath to @xmath . The change in coupling strength results in stronger
spin modulation and charge localization, and, at @xmath the pairing
order also start to show inhomogeneity. At the same time, the @xmath
decreases from positive to negative values, indicating the inhomogeneous
order is favored at stronger coupling.

It is important to note that the @xmath fragment geometry does not
always lead to inhomogeneity, nor are all the @xmath fragments are
homogeneous. (For instance, the same parameter as in Fig. 4.12(c) leads
to an incommensurate inhomogeneous order in the @xmath fragment, while
many @xmath calculations see homogeneous @xmath fragments.) Instead, at
points where the tendency towards inhomogeneity is strong, we find a
significant lowering of the energy associated with the inhomogeneous
order, reflected either in a much lower energy of an inhomogeneous
inhomogeneous @xmath fragment relative to the @xmath fragment, or
inhomogeneity in both @xmath and @xmath fragments. Thus while it is not
possible with our fragment sizes to extrapolate details of the
inhomogeneities in the TDL (for example, the particular wavelengths of
the spin, charge, and pairing instabilities, or diagonal versus vertical
stripe patterns), the evidence points strongly to some forms of
inhomogeneity surviving in the TDL at the indicated parts of the phase
diagram.

Overall, in the underdoped regions of @xmath and @xmath and @xmath ,
various inhomogeneous orders are well established in @xmath and even
@xmath fragment calculations, providing strong evidence to the
inhomogeneity in the TDL; While at @xmath , the calculations seem near
the transition between the homogeneous and the inhomogeneous regimes,
and give more ambiguous results, thus it is hard to determine what
happens in the TDL ground state.

### 4.5 Conclusions

We have computed a ground-state phase diagram for the Hubbard model on
the square lattice using cluster DMET. The accuracy achieved by DMET
appears competitive with the exact ground-state benchmarks available at
half-filling, while away from half-filling our error model suggests that
the calculations remain very accurate. We observe AF and metallic phases
and robust @xmath -wave pairing. Further in parts of the phase space,
our calculations strongly suggest that inhomogeneous phases are a
feature of the thermodynamic limit, although the precise inhomogeneous
patterns require larger clusters to resolve and reflect competition
between different orders at very low energy scales.

However, for real materials such as the cuprates ( @xmath 3000K), the
energy resolution achieved here for most of the phase diagram is already
below the superconducting @xmath , suggesting that the near degeneracy
of competing orders will be lifted by terms beyond those in the Hubbard
model, such as long-range charge and hopping terms, multi-orbital
effects, and interlayer coupling. Moving beyond the Hubbard model to
more realistic systems thus now appears of principal relevance.

## Chapter 5 Stripe Order in the Underdoped Region of the
Two-Dimensional Hubbard Model 111Based on work posted in
arXiv:1701.00054. [206]

Competing inhomogeneous orders are a central feature of correlated
electron materials including the high-temperature superconductors. The
two-dimensional Hubbard model serves as the canonical microscopic
physical model. Multiple orders have been proposed in the underdoped
part of the phase diagram, which corresponds to a regime of maximum
numerical difficulty.

In Chapter 4 , we investigated the broad picture of the 2D Hubbard model
phase diagram over a wide range of parameter space; In this chapter, we
turn our focus on the strong-coupling, underdoped region of the phase
diagram. We introduce a collaborative work with experts in various
state-of-the-art numerical methods to perform exhaustive simulations to
provide a definitive resolution of the order in the underdoped ground
state of the strong coupling regime, which was left as an open question
in Chapter 4 . As we have shown before, the possible inhomogeneous
orders are very rich and sensitive to slight changes in the parameters.
Since it is a huge effort to deliver a detailed map for the ground-state
orders, we focus on the @xmath -doped point to demonstrate that it is
possible to complete such a map with the latest development of numerical
method.

At this point, We find a stripe order that has a highly compressible
wavelength on an energy scale of a few Kelvin, with wavelength
fluctuations coupled to pairing order. The favored filled stripe order
is different from that seen in real materials, indicating the
possibilities of other interactions beyond the Hubbard model at play.
Our results demonstrate the power of modern numerical methods to solve
microscopic models even in the most challenging settings.

In Sec. 5.1 , we introduce the existing evidence and characterizations
of the stripe orders. In Sec. 5.2 , we discuss the numerical methods and
data analysis techniques employed in the study. Sec. 5.3 presents the
computational results, focusing on the competing orders in the @xmath
-doped Hubbard model at @xmath , while in Sec. 5.4 , we summarize the
findings and discuss future directions.

### 5.1 Introduction

Competing inhomogeneous orders are a common feature in many strongly
correlated materials [ 207 ] . A famous example is found in the
underdoped region of the phase diagram of the high-temperature cuprate
superconductors (HTSC). Here, multiple probes, including neutron
scattering, scanning tunneling microscopy, resonant X-ray scattering,
and nuclear magnetic resonance spectroscopy all lend support to various
proposed inhomogeneous orders, such as charge, spin, and pair density
waves, with suggested patterns ranging from unidirectional stripes to
checkerboards [ 208 , 209 ] . Recent experiments on cuprates indicate
that the observed inhomogeneous orders are distinct from, and compete
with, pseudogap physics [ 210 , 211 ] .

Much theoretical effort has been directed to explain the origin of the
inhomogeneities [ 212 ] . Numerical calculations on microscopic lattice
models have provided illuminating examples of the possible orders. The
prototypical lattice model to understand HTSC is the 2D Hubbard model on
the square lattice, with the Hamiltonian

  -- -------- -- -------
     @xmath      (5.1)
  -- -------- -- -------

where @xmath and @xmath denote the usual fermion creation, annihilation,
and number operators, and @xmath and @xmath are the kinetic and on-site
repulsion energies.

A large number of numerical techniques have been applied to compute the
low-temperature and ground-state phase diagram of this model. Early
evidence for unidirectional stripe ordering in the Hubbard model came
from Hartree-Fock calculations [ 198 , 213 , 214 , 215 ] , while
non-convex energy versus filling curves in exact diagonalization of
small clusters of the related @xmath - @xmath model were interpreted as
signs of macroscopic phase separation [ 216 , 217 ] . Since then,
inhomogeneous orders have been observed both in the Hubbard and @xmath -
@xmath models with density matrix renormalization group (DMRG) [ 202 ,
67 , 218 ] , variational quantum Monte Carlo [ 219 ] and constrained
path auxiliary field quantum Monte Carlo (AFQMC) [ 220 ] , (iPEPS) [ 221
] , density matrix embedding theory (DMET) (see Chapter 4 and Ref. [ 92
] ), and functional renormalization group [ 222 ] calculations amongst
others, although not necessarily the same kind of inhomogeneity is
observed in each case.

However, there are other sophisticated simulations, for example, with
variational and projector quantum Monte Carlo [ 223 , 224 ] , and
cluster dynamical mean-field theory, which do not see, or are unable to
resolve, the inhomogeneous order [ 225 , 2 ] . The most recent studies
with iPEPS [ 221 ] and DMET [ 92 ] , as well as some earlier variational
calculations [ 219 , 226 , 227 , 228 ] , further show that both
homogeneous and inhomogeneous states can be observed and stabilized
within the same numerical methodology, with a small energy difference
between homogeneous and inhomogeneous states, on the order of @xmath per
site, corresponding to a smaller energy scale than the common cuprate
superconductivity transition temperatures.

The small energy differences between orders means that very small biases
in ground state simulations, such as from an incomplete treatment of
fluctuations, using insufficiently accurate constraints to control the
sign problem, bias towards low entanglement states, or from finite size
effects, can easily stabilize one order over the other. Similarly, the
low temperatures needed to resolve between orders is a challenge for
finite temperature numerical methods [ 64 , 229 ] .

However, in this work we will demonstrate that, with the latest
numerical techniques, obtaining a definitive characterization of the
ground state order in the underdoped region of the 2D Hubbard model is
now an achievable goal. As a representative point in the phase diagram,
we choose the iconic @xmath doping point at strong coupling ( @xmath ).
Experimentally, this doping corresponds to a region of maximal
inhomogeneity in many HTSC’s, and in the strong coupling regime it is
recognized as a point of maximum numerical difficulty and uncertainty in
simulations [ 2 ] .

Using state-of-the-art computations with detailed cross checks and
validation, including newer methodologies such as infinite
projected-entangled pair states (iPEPS) and density matrix embedding
theory (DMET) as well as recent developments in established
methodologies such as constrained-path auxiliary field quantum Monte
Carlo (AFQMC) and density matrix renormalization group (DMRG), and with
exhaustive accounting for finite size effects combined with calculations
directly in the thermodynamic limit, we are able to achieve
unprecedented accuracy in this challenging region of the ground-state
phase diagram. In so doing, we can finally answer the question: what is
the order and physics found in the underdoped ground state of the 2D
Hubbard model?

### 5.2 Methods

#### 5.2.1 Overview

An important new strategy we bring to bear on this part of the Hubbard
model phase diagram is to combine the insights of multiple numerical
tools with complementary strengths and weaknesses. This approach,
pioneered in an earlier work on the Hubbard model [ 2 ] , greatly
increases the confidence of the numerical characterization. To
understand what each method contributes, we briefly summarize the
theoretical background and corresponding sources of error, and then
discuss the detailed settings for each method in this work.

Auxiliary field quantum Monte Carlo . ² ² 2 AFQMC calculations are
performed by Mingpu Qin, Hao Shi and Shiwei Zhang. AFQMC expresses the
ground state of a finite system through imaginary time evolution (Eq.
2.47 ). The projection is Trotterized, and the evolution reduces to a
stochastic single-particle evolution in the presence of auxiliary fields
generated by the Hubbard-Stratonovich decoupling of the Hubbard
repulsion. Away from half-filling, this decoupling has a sign problem.
We use the constrained path (CP) approximation, to eliminate the sign
problem at the cost of a bias dependent on the quality of the trial
state [ 112 , 230 ] . In this work, the Trotter error is well converged
and we report the statistical error bar. To minimize the constrained
path bias, we use several different trial states, including
self-consistent optimization of the trial state [ 231 ] . The
calculations are carried out on finite cylinders with open, periodic,
and twist-averaged boundary conditions, with widths of up to 12 sites,
and lengths of up to 72 sites. This method can reach large sizes and
finite size effects are minimized. The uncontrolled error is from the CP
approximation.

Density matrix renormalization group . ³ ³ 3 The lattice basis DMRG
calculations are performed by Chia-Min Chung and Steven R. White. The
hybrid basis DMRG calculations are performed by Georg Ehlers and
Reinhard M. Noack. DMRG is a variational wavefunction approximation
using matrix product states (MPS), which are low-entanglement states
with a 1D entanglement structure. The quality of the approximation is
determined by the bond dimension ( @xmath ) of the MPS (Sec. 2.4.2 ).
The calculations are carried out on finite cylinders with widths of up
to 7 sites, and lengths of up to 64 sites, with periodic boundary
conditions in the short direction and open boundaries in the long
direction. Two different DMRG algorithms were used: one working in a
pure (real-space) lattice basis, and another in a mixed momentum/lattice
(hybrid) basis, with the momentum representation used along the short
periodic direction [ 232 ] . We remove the bond dimension error and
finite size error in the long direction by well-known extrapolation
procedures, and report the associated error bar [ 233 ] . Consistency
between the lattice and hybrid DMRG algorithms provides a strong
validation of this error bar. The remaining uncontrolled error is the
finite width error in the periodic direction.

Density matrix embedding . DMET is a quantum embedding method which
works directly at the thermodynamic limit, although interactions are
only accurately treated within a fragment (see Sec. 2.3 ) [ 54 ] . To
solve for the ground state of the impurity model, consisting of a
supercell of the original lattice (the fragment) coupled to a set of
self-consistently determined bath orbitals, we use a DMRG solver [ 101 ]
. We treat a series of fragment supercells with up to 18 sites ( @xmath
) to target different low-lying states. With the narrow shapes of the
fragments used in this work, we are able to perform DMRG calculations
with negligible truncation errors; and we do not extrapolate the
observables to the thermodynamic limit (with respect to the fragment
sizes). Thus, the error bar reported in DMET only corresponds to the
estimated error from incomplete self-consistency of the impurity
problem (see Sec. 4.3 ). The remaining uncontrolled error is the finite
fragment size error.

Infinite projected entangled pair states . ⁴ ⁴ 4 iPEPS calculations are
performed by Philippe Corboz. iPEPS is a variational approach using a
low-entanglement tensor network ansatz natural to 2D systems [ 234 , 235
, 236 ] . The calculations are carried out directly in the thermodynamic
limit where different supercell sizes including up to 16 sites
(independent tensors that can break symmetry) are used to target
different low-energy states. As in DMRG, the accuracy of the ansatz is
systematically controlled by the bond dimension @xmath of the tensors.
Estimates of quantities in the exact @xmath limit are obtained using an
empirical extrapolation technique which is a potential source of
uncontrolled error.

Cross-checks: systematic errors, finite size biases . The use of
multiple techniques allows us to ameliorate the uncontrolled errors from
one technique using information from another. For example, by carrying
out simulations on the same finite clusters in the AFQMC and DMRG
calculations, we can estimate the constrained path bias in AFQMC.
Similarly, in the AFQMC calculations we can treat larger width cylinders
than in the DMRG simulations; thus we can estimate the finite width
error in DMRG. In other examples, DMRG may miss low-lying states with
higher entanglement in finite bond dimension calculations. If, however,
these states show up in other methods, we can control the initial
boundary conditions or trial states of the DMRG calculations and target
the missing states. These states may later show lower energy when
extrapolated to infinite @xmath .

In all of the methods, there is a bias towards orders commensurate with
the shape of the simulation cell, be it the finite lattice and boundary
conditions in AFQMC/DMRG, or the fragment cluster in DMET, or the
supercell in iPEPS. Using this bias, together with different boundary
conditions and pinning fields, we can stabilize different meta-stable
orders. For example, by setting up clusters commensurate with multiple
inhomogeneous orders and observing the order that survives, we can
determine the relative energetics of the candidate states. We can fit
the orders along the short axis or the long axis of the cluster to
obtain two independent estimates of the energy. We have carried out
exhaustive studies of about 100 different combinations of clusters,
cells, and boundary conditions, to fully investigate the low-energy
landscape of states.

To characterize the orders, we use the local hole density @xmath ,
magnetic moment @xmath , and pairing order @xmath ( @xmath adjacent to
@xmath ).

#### 5.2.2 Detailed Specifications

In this section, We discuss the process, scope and computational
parameters used in each of the computational methods in detail.

##### Auxiliary field quantum Monte Carlo

Two sets of AFQMC calculations are performed using the constrained-path
AFQMC method with self-consistently optimized, unrestricted Hartree-Fock
trial wavefunctions [ 231 ] .

The first set is on cylinders of dimension @xmath ( @xmath ) with open
boundary conditions (OBC) along the @xmath -direction and periodic
boundary conditions (PBC) along the @xmath -direction. This allows the
AFQMC calculations to be directly compared with DMRG results. We also
run calculations with pinning fields to fix the desired spin structures.
Several types of antiferromagnetic (AF) pinning fields are applied along
the open edges of the cylinders depending on the target state. The types
of pinning fields include: the in- and anti-phases pinning fields along
the two boundaries, and the pinning fields applied to only one edge.

With in- (anti-) phase pinning fields, we target an odd (even) number of
nodes (where the @xmath -phase shift happens) in the system ( @xmath is
always even in the calculations); while pinning fields on only one edge
are able to accommodate states with different wavelengths so we can
learn which wavelength survives in the competition. The strength of the
pinning fields is @xmath for all calculations.

In the second set of calculations, we use PBC or twist averaged boundary
conditions (TABC) along both directions. The twist averaging allows us
to reduce the finite size errors in the total energy, thus giving a more
unbiased estimation of the energy order for various low-lying states.

For @xmath , the wavelength 5, 6, 8, 10 and 12 stripes are explicitly
studied in AFQMC using cylinders, while the energy estimates from PBC
and TABC calculations are obtained for wavelengths 5 to 10. Similar
calculations are also performed at @xmath and @xmath .

##### Density matrix renormalization group in the lattice basis

Lattice-basis DMRG calculations are carried out on cylinders of size
@xmath ( @xmath ) as well. Both fixed particle number (at @xmath doping)
and broken particle-number symmetry calculations are conducted.

To stabilize the states with particular wavelengths, we use as initial
states product states with holes in the desired locations, and apply
temporary fields and (site-dependent) chemical potentials on the whole
cylinder in the first few sweeps. A temporary chemical potential @xmath
is applied on the sites where the holes are supposed to be in the final
striped state, and a temporary magnetic field of strength @xmath is
applied to fit the antiferromagnetic domains between holes. After the
first few sweeps (typically up to bond dimension @xmath ) the temporary
field and chemical potential are turned off, and the state is called
“stable” in the DMRG simulation if it keeps the same wavelength during
subsequent sweeps. In some cases, an AF pinning field of strength @xmath
at the open edges is kept in the full simulation to further stabilize
the state. By extrapolating to the infinite length, the pinning field
does not affect the energy per site at the thermodynamic limit.

We next consider the pairing order. To measure the pairing order, we
simulate the Hubbard cylinder in the grand canonical ensemble, i.e.,
without particle number conservation. The chemical potentials are tuned
so that the expectation value of the particle number is close to the
desired value ( @xmath of the number of sites). We apply pairing pinning
fields at the edges, to induce broken particle-number symmetry, and
observe how the pairing order decays into the bulk.

The lattice-basis DMRG simulations are carried out at @xmath and @xmath
, the width 4, 6 and 7 cylinders to simulate stripes of various
wavelengths.

##### Density matrix renormalization group in the hybrid basis

Again, the hybrid-basis DMRG calculations are carried out on cylinders
of size @xmath , with OBC in the longitudinal @xmath -axis and PBC or
APBC in the transverse @xmath -direction.

The DMRG algorithm in a mixed–real-momentum-space (hybrid)
representation [ 232 ] is used. The hybrid-basis DMRG algorithm uses a
real-space representation in the longitudinal cylinder direction and a
momentum-space representation in the transverse direction. The
additional transverse-momentum quantum number grants us a speedup over
lattice-basis DMRG whose cost grows with the width of the cylinder. For
width-6 Hubbard cylinders, the hybrid-space algorithm is approximately
20 times faster than its real-space counterpart.

To obtain the ground-state energy for fixed @xmath (while @xmath is
infinite), we perform consecutive extrapolations first in the DMRG
truncation error @xmath and then in the inverse cylinder length @xmath .

In order to directly target and stabilize different stripe
configurations on width-6 cylinders with PBC, we use a sine-shaped
pinning field coupled to the local charge density

  -- -------- -- -------
     @xmath      (5.2)
  -- -------- -- -------

with suitable amplitude @xmath , wave vector @xmath , and phase @xmath .
Note that the pinning field only acts on the charge density, while does
not explicitly break the spin or particle-number symmetries. The
contribution to the ground-state energy, @xmath , is subtracted after
the DMRG calculation. We found a field amplitude of @xmath to be
sufficient to stabilize the different stripe patterns and to improve the
convergence of the DMRG algorithm. After the calculations are converged,
the charge order can be measured directly from the one-body density
matrix, while the spin structure factor and pairing correlation
functions are measured to obtain the spin and pairing order.

The calculations are carried out on width 4 to 8 cylinders of various
lengths. However, for width 8, we do not achieve sufficient convergence
in terms of DMRG density matrix truncation, despite using up to @xmath
states.

##### Density matrix embedding theory

We perform the DMET calculations on an auxiliary square lattice of
dimension @xmath , where @xmath for most fragment sizes ( @xmath for
@xmath fragments and @xmath for @xmath fragments). The correlation
potential is allowed to break spin and particle-number symmetries, and
so do the impurity model wavefunctions. The calculations are carried out
as described in Appendix B.2 , and similar to those in Chapter 4 , but a
larger number of fragment sizes, shapes and boundary conditions are
explored. Various shapes of fragments are used to accommodate uniform
@xmath -wave order, vertical and diagonal stripes. The shapes of the
fragments are summarized in Fig. 5.1 . We do not attempt to do
extrapolations of fragment size in this work but compare the energies of
different fragments directly. This is making an implicit assumption that
the finite size errors are about the same for different fragment shapes
employed here, and this lack of TDL extrapolation is the main systematic
error. In our experience, however, it is reasonable to directly compare
energies of fragments of the same orientation and family (e.g. @xmath ),
which is confirmed in this work by comparison with the other techniques.

@xmath cells [Fig. 5.1 (a)] are used to study vertical stripes with odd
wavelengths. As the AF order has a @xmath -phase shift at the domain
wall, the AF order is commensurate with the cell size. For
even-wavelength stripes, the setup is similar, however, to support a
single domain wall, it is necessary for the spin wavelength to be twice
that of the charge wavelength. To allow this, rather than using a large
cluster of size @xmath , we modify the way the correlation potential is
added to the lattice wavefunction, i.e. by swapping the spin channels
between neighboring cells in the longitudinal direction [Fig. 5.1 (c)],
so translation by a unit cell gives a time reversal, @xmath
transformation. Specifically, the local correlation potential in this
case is written as

  -- -------- -- -------
     @xmath      (5.3)
  -- -------- -- -------

where @xmath and @xmath label even and odd cells along the longitudinal
@xmath direction. Both @xmath possibilities are tested in our
calculations, because we cannot determine the phase factor associated
with the transformation

  -- -------- --
     @xmath   
  -- -------- --

where the @xmath denotes translation by a unit cell. As shown in the
results, neither parameterization results in finite pairing order in the
ground-state of even wavelength stripes. This trick not only greatly
reduces the computational cost it would have taken to simulate the
even-wavelength stripes, but also makes the energies of odd and even
wavelengths more comparable.

We also use the traditional cells in Fig. 5.1 (a) for even wavelengths
to simulate possible spin density wave states. One of these states turns
out to have lower energy than the stripe of the same wavelength at
@xmath .

We also use the tilted clusters in Fig. 5.1 (b) to accommodate diagonal
stripes. As the finite-size effects are different in regular and tilted
clusters, we use both @xmath and @xmath clusters to obtain the uniform
@xmath -wave state, to estimate the relative energies of the states on
regular and tilted lattices.

In all the calculations reported in this work, the DMRG solution of the
impurity model is converged in terms of truncation error, and the DMET
uncertainty comes solely from the convergence of the correlation
potential. We report the energy and its uncertainty as the average and
half of the difference of the last two DMET cycles, respectively.

##### Infinite projected entangled-pair state

An infinite projected entangled-pair state (iPEPS) [ 234 , 237 , 238 ]
(also called a tensor product state [ 239 , 235 ] ) is an efficient
variational tensor network ansatz for two-dimensional states in the
thermodynamic limit which obeys an area law of the entanglement entropy
[ 240 ] . The ansatz consists of a supercell of tensors which is
periodically repeated on a lattice, with one tensor per lattice site.
Each tensor has a physical index which carries the local Hilbert space
of a lattice site and four auxiliary indices which connect to the
nearest-neighboring tensors on a square lattice. Each auxiliary index
has a certain dimension @xmath , called the bond dimension, with which
the accuracy of the ansatz (the number of variational parameters) can be
controlled systematically. An iPEPS with @xmath corresponds to a product
state, and by increasing @xmath entanglement can be systematically
added. In this work we use bond dimensions up to @xmath corresponding to
highly-entangled states.

For translationally invariant states a supercell with only a single
tensor is needed. If the translational symmetry is spontaneously broken
a supercell compatible with the symmetry breaking pattern is required.
For example, a Néel ordered state requires a supercell with two
different tensors @xmath and @xmath (one for each sublattice), or a
stripe state with period 5 requires a @xmath supercell with 10
independent tensors. A diagonal stripe state with period @xmath can be
obtained in a @xmath rectangular supercell, or more efficiently by using
a @xmath supercell with @xmath different tensors and translation vectors
@xmath , @xmath .

By running simulations with different supercell sizes one obtains
different competing low-energy states. In order to determine which of
these competing low-energy states corresponds to the true ground state a
systematic analysis of the energy as a function of @xmath is required.
Here we used the extrapolation technique from Ref. [ 4 ] in which the
energy is plotted as a function of the so-called truncation error @xmath
in the simulation, and then the extrapolation to the @xmath limit is
taken to determine the energy of each of the competing states. While in
2D it is theoretically unknown how the energy depends on @xmath ,
several benchmarks [ 4 ] have empirically shown that an accurate
estimate can be used using a polynomial fit.

In this work the optimization of the tensors has been done using an
imaginary time evolution based on the so-called full update [ 241 ] (or
fast-full update [ 242 ] ), which is more accurate than the simple
update approach [ 243 ] . Observables are evaluated by contracting the
two-dimensional tensor network in a controlled, approximate way, using a
variant [ 205 , 221 ] of the corner-transfer matrix (CTM) method [ 244 ,
245 ] . The accuracy of the contraction is controlled by the “boundary”
dimension @xmath , which is chosen large enough such that the resulting
error is small (compared to the effect of the finite @xmath ). To
increase the efficiency we make use of Abelian symmetries [ 246 , 247 ]
. Fermionic statistics are taken into account following the formalism
explained in Refs [ 248 , 241 ] .

#### 5.2.3 Estimating Long-range Coulomb Interaction

We estimate the long-range Coulomb interactions of various low-lying
states to understand how these interactions may change the relative
order of the states in real cuprates. We use charge order from DMET
calculations, and compute

  -- -------- -- -------
     @xmath      (5.4)
  -- -------- -- -------

where @xmath is the size of the fragment, @xmath is the hole density on
site @xmath , and @xmath is the average hole density ( @xmath ).

In atomic units, i.e. if we express the energy in Hartrees, and distance
in Bohr, @xmath . The appropriate dielectric constant to use in a
statically screened Coulomb interaction in the CuO @xmath plane has been
estimated to lie between about @xmath and @xmath [ 249 , 250 ] . We use
a dielectric constant of @xmath , and a lattice constant @xmath Å @xmath
corresponding to the lattice constant of La @xmath CuO @xmath . We
transform the computed Coulomb energy (per site) to units of @xmath ,
using @xmath .

In 2D, the Coulomb summation converges reasonably fast. We choose a
cutoff radius as 300 lattice spacings and converge the Coulomb energy to
the fourth digit in units of @xmath . This is of course just a crude,
order of magnitude estimate, because we neglect the effect of relaxation
in the presence of the Coulomb interaction, and there is significant
uncertainty in the dielectric.

### 5.3 Results

Using the above methods, we carry out calculations for the ground state
of the 2D Hubbard model at @xmath doping at @xmath . The first check of
reliability is the independent convergence of the methods for the energy
per site. While the quality of the ground-state energy may be a poor
proxy for the quality of the corresponding state when the overall
accuracy is low (as there are always many degenerate states far above
the ground state), well-converged energies are a much tighter constraint
on the ground state order, as any degeneracies must be below the energy
convergence threshold.

Fig. 5.2 shows the best energy estimate for the ground state from the
different methods. The two different DMRG formulations (real space and
hybrid basis) agree perfectly, providing a strong independent check of
the calculations, and in subsequent figures we report only the single
consistent result. Note that the error bars for AFQMC, DMRG, and DMET do
not reflect the uncontrolled systematic errors in the methods. However,
as described above, the systematic errors can be estimated by cross
checks between the methods. For example, DMRG and AFQMC calculations on
finite clusters with identical boundary conditions provide an estimate
of the small constrained path bias (see Table 5.1 and Ref. [ 231 ] )
consistent with the difference in the DMRG and AFQMC energies in Fig.
5.2 (around @xmath ); similarly AFQMC extrapolations to the
thermodynamic limit indicate that the DMRG energies (using cylinders up
to width 7) are essentially converged with respect to cylinder width
(Fig. 5.3 ).

The ground-state energy has close agreement between all the methods, and
all energies lie in the range @xmath . If, for a typical HTSC material,
we estimate @xmath , then this corresponds to a range of about @xmath
per site, or @xmath per hole. For a numerical comparison, this is also
more than an order of magnitude lower than the temperatures accessible
in finite temperature, thermodynamic limit, simulations in this part of
the phase diagram, indicating that we are potentially accessing
different physics from what haven been seen before [ 2 , 229 ] . Shown
in the inset are the corresponding best estimates at half filling from
the same methods, where the spread in energies is less than @xmath .
This illustrates the significantly greater numerical challenge
encountered in the underdoped region. Nonetheless, the accuracy and
agreement reached here represents a ten-fold improvement over recent
comparisons of numerical methods at this point in the phase diagram [ 2
] .

Ground state stripe order . For all the methods employed, the lowest
energies shown in Fig. 5.2 correspond to a vertical striped state . This
corresponds to a co-directional charge and spin-density wave, with the
region of maximum hole density coinciding with a domain wall and @xmath
-phase shift in the antiferromagnetism. As mentioned, unidirectional
stripes of various kinds are a long-standing candidate order in the
doped Hubbard and related models. Hartree-Fock calculations give filled
stripes (i.e. one hole per charge unit cell) in both vertical and
diagonal orientations, while one of the first applications of the DMRG
to 2D systems found strong evidence for half-filled stripes in the
@xmath - @xmath model [ 202 ] . Finally, one of the earliest examples of
inhomogeneity in doped HTSC’s were the static half-filled stripes in
LaSrCuO at 1/8 doping [ 251 ] .

The convergence to the same inhomogeneous order in the ground state in
the current study, from multiple methods with very different
approximations, strongly suggests that stripes indeed represent the true
ground state order of the Hubbard model in the underdoped regime, and
further highlights the accuracy we achieve with different techniques.
However, the stripe order we observe has some unusual characteristics.
We return to the details of the stripe order, its associated physics,
and its relationship with experimentally observed stripes further below.
First, however, we examine the possibility of other competing
meta-stable states.

Competing states: uniform @xmath -wave state . Recent work using iPEPS
and DMET on the @xmath - @xmath and Hubbard models suggested close
competition between a uniform @xmath -wave superconducting ground state
and a striped order [ 221 , 92 ] . With an improve energy resolution in
this work, uniform states did not spontaneously appear in any of our
calculations which indicates that they lie higher in energy than the
striped order. We found that we could stabilize a uniform @xmath -wave
state in the DMET calculations by constraining the fragment to a @xmath
or @xmath geometry [Fig. 5.4 (b)] and in the iPEPS calculations by using
a @xmath unit cell [Fig. 5.4 (c)]. DMET calculations on similarly shaped
larger clusters (such as a @xmath cluster) spontaneously broke symmetry
to create a non-commensurate non-uniform state. From these calculations
we estimate that the uniform state lies @xmath above the lowest energy
state [Fig. 5.4 (a)], and is not competitive at the energy resolution we
can now achieve.

Competing states: diagonal stripes . While we find the ground state
order to be a vertical stripe type order, other studies of stripes
indicate that different orientations can form [ 175 ] . On short length
scales, the relevant question is whether diagonal stripes [with a @xmath
wave vector] are competitive with vertical stripes [with a @xmath
wavevector]. With the boundary conditions used in this work, diagonal
stripes would be frustrated in the DMRG and AFQMC calculations, and did
not spontaneously appear. To stabilize diagonal stripes in the DMET and
iPEPS calculations, we used tilted @xmath fragments ( @xmath for DMET,
and a @xmath simulation cell with 16 independent tensors in iPEPS. The
@xmath iPEPS cell gave a diagonal stripe [Fig. 5.4 (d)] that was
significantly higher in energy than the vertical stripe, by @xmath . The
DMET cluster gave rise to a frustrated diagonal order that we also
estimate to be higher in energy by @xmath . While it is likely that the
orientation of the stripe will depend on doping and coupling, vertical
stripes appear to be significantly preferred at this point in the phase
diagram.

Competing states: other short-range orders . While other types of order
have been proposed in the underdoped region, such as spiral magnetic
phases [ 171 , 222 ] and checkerboard order [ 252 ] , we find no
evidence for other kinds of short-range orders at this point in the
phase diagram from any of our methods. The lack of checkerboard order,
which would easily fit within the large clusters in our simulations
(e.g. up to @xmath in the DMRG calculations) appears to rule them out as
low energy states, in agreement with earlier DMRG simulations on the
@xmath - @xmath model [ 253 ] . While we cannot rule out incommensurate
orders, we have found that the variation of energy with unit cell
wavelength (see below) is quite smooth, thus we do not expect a dramatic
energy gain from incommensurability. We note that studies finding
incommensurate magnetic orders have focused on smaller values of @xmath
[ 222 ] .

Ground state stripes: detailed analysis . We now return to a more
detailed discussion of the vertical stripe order observed in the ground
state. Within the family of vertical stripes, we can consider questions
of wavelength (charge and spin periodicity), type and strength of charge
and spin modulation (e.g. bond- versus site-centered), and coexistence
with pairing order.

We first discuss the wavelength @xmath . At @xmath doping, the filling
of the stripe is related to the wavelength by @xmath . As described, we
can access different wavelength meta-stable stripes and their relative
energetics by carefully choosing different total cluster dimensions and
boundary conditions (in the DMRG and AFQMC calculations) or unit
cell/fragment sizes (in the iPEPS and DMET calculations). Fig. 5.5 shows
the energy per site of the stripe versus its wavelength @xmath from the
multiple methods. Earlier DMRG calculations on the Hubbard model had
focused on @xmath (half-filled stripes) which are seen in HTSC’s [ 202 ,
67 ] , but we now observe that these are relatively high in energy. A
striking feature is that for @xmath the energies are nearly degenerate.
This is clearly seen in the DMET data where stripes of all wavelengths
can be stabilized, as well as the plot of the averaged energy of the
methods between @xmath .

The energy difference between the @xmath and @xmath stripe in the
different methods is estimated to be between @xmath (DMRG)– @xmath
(iPEPS) with an average of @xmath . This suggests that the magnetic
domain walls can fluctuate freely, consistent with proposals for
fluctuating stripes [ 210 ] . In particular, the stripes may be
distorted at a small cost over long length scales.

Although the different wavelengths are nearly degenerate, there appears
to be a slight minimum near wavelength @xmath (a filled stripe) in all
the methods. Very recently, similar filled stripes have been reported as
the ground state in part of the frustrated @xmath - @xmath model phase
diagram [ 254 ] . @xmath appears significantly higher in energy in both
DMET and DMRG. In the DMRG calculations, the @xmath state was not even
meta-stable as boundary conditions and initial states were varied, so
the high-energy state shown was forced with a static potential. The
AFQMC results show a much weaker dependence on wavelength for longer
wavelengths, for example the @xmath and @xmath stripe energies per site
appear to be within @xmath . However, when a mixture of the @xmath and
@xmath stripe states is set up on a length 40 cluster that is
commensurate with both, the state that survives is the @xmath stripe,
suggesting a preference for this wavelength. The increase in energy at
wavelengths @xmath coincides with unfavorable double occupancy of the
stripe. This simple interpretation is supported by a mean-field
(unrestricted Hartree-Fock (UHF)) calculation with an effective
interaction @xmath chosen within the self-consistent AFQMC procedure.
The mean-field result shows a clear minimum at a wavelength- @xmath
vertical stripe. (Note that this requires the use of an effective @xmath
; at the bare @xmath , mean-field theory would produce a diagonal stripe
[ 255 ] .) The correspondence between the energies and densities in the
effective mean-field and correlated calculations suggests that the
mean-field theory with a renormalized interaction may be surprisingly
good at describing the energetics of stripes. However, mean-field theory
appears to somewhat underestimate the degeneracy of the stripes as a
function of wavelength, particularly at shorter wavelengths.

The stripe order for the @xmath stripe from the different methods is
depicted in Fig. 5.6 . We show the full period (16) for the spin
modulation. The stripe is bond-centered in the AFQMC, DMRG, and DMET
calculations. In the iPEPS calculation, the stripe is nominally
site-centered. In all the calculations, the width of the hole domain
wall spans several sites, blurring the distinction between bond- and
site-centered stripes, and we conclude that the energy difference
between the two is very small. There is substantial agreement in the
order observed by the different numerical techniques, with only some
differences in the magnetitude of modulation of the hole and
spin-densities.

Note that for even-wavelength stripes, the spin wavelength must be twice
that of the charge modulation in order to accommodate the stripe as well
as the antiferromagnetic order. At odd wavelengths, site-centered
stripes appear in all the calculations, and here charge and spin order
can have the same wavelength. (This odd-even alternation does not affect
the peaks of the structure factor near @xmath , see Appendix 5.A.1 .)

Pairing order, fluctuations, and superconductivity . A key question is
whether pairing order coexists with stripe order. Previous work on the
@xmath - @xmath model with iPEPS found coexisting @xmath -wave order for
partially filled ( @xmath ) stripes. No @xmath -wave order is found in
the Hubbard @xmath stripe with any technique. However, @xmath -wave
order can be found at other wavelengths. For example, for @xmath and
@xmath stripes, iPEPS produces @xmath -wave order along the bonds (see
Fig. 5.7 ) with a maximum @xmath -wave expectation value of @xmath and
@xmath , respectively. DMRG calculations with pinning pairing fields on
the boundary for a @xmath cylinder also find @xmath -wave order, with an
extrapolated maximum @xmath -wave order of @xmath , consistent with the
iPEPS results. In the DMET calculations, though the lowest energy @xmath
stripe has no @xmath -wave order, however, at slightly higher energy (
@xmath ) a @xmath state similar to the iPEPS stripe can be found with
coexisting @xmath -wave order, but with a substantially smaller maximum
order parameter of @xmath . Overall our results support the coexistence
of modulated @xmath -wave order with the striped state, although the
strength of pairing is intertwined with the stripe wavelength and
filling. The pairing modulation we find (Fig. 5.7 ) is in phase between
cells. Other kinds of pairing inhomogeneities, such as pair density
waves, have also been discussed in the literature [ 212 ] .

It has long been argued that fluctuating stripes could promote
superconductivity [ 256 , 257 , 258 ] . Our work provides some support
for this picture, as there is a low energy scale associated with the
deformation of stripe wavelength while we also find coupling between the
wavelength and the pairing channel. We can imagine fluctuations in
wavelength both at low temperatures, as well as in the ground state. In
the latter case, this could lead to a stripe liquid ground state rather
than a stripe crystal. Our calculations are consistent with both
possibilities.

Changing the coupling . We may also ask whether the @xmath , @xmath
doping point is an anomalous point in the Hubbard phase diagram, and,
if, for example, moving away from this point would alleviate the unusual
stripe compressibility (with respect to wavelength at fixed doping) that
we observe. In Fig. 5.8 we show the energies of various striped states
and the uniform state at @xmath and @xmath , @xmath doping, computed
using AFQMC, DMET and DMRG. At both couplings, the stripes around
wavelength 8 are nearly degenerate, with the degeneracy increasing as
the coupling increases. At @xmath , we find the ground state is a filled
stripe state with wavelength @xmath , with a larger energy stabilization
than at @xmath . The trend is consistent with the state observed at
@xmath with a more sinusoidal spin-density wave, more delocalized holes,
and a more pronounced minimum wavelength [ 220 ] . In particular, at
@xmath , at @xmath , the stripe and spin-density wave state
(distinguished by whether or not the state has the @xmath -phase shift)
are essentially degenerate in DMET [ @xmath vs. @xmath ], compared to an
energy difference of @xmath at @xmath . At @xmath , we find a filled
stripe with AFQMC and DMRG (width 6), but DMET and DMRG on a narrower
cylinder (width 4) find @xmath . The similarity of the DMET and DMRG
(width 4) data suggests that the shorter wavelength is associated with a
finite width effect. We notice that @xmath -filled stripes consistent
with @xmath were also seen in earlier DMRG studies on width-6 cylinders
[ 218 ] , but a more detailed analysis shows that the filled stripe
becomes favored when extrapolated to infinite bond dimension. In fact,
similar to Ref. [ 218 ] , at finite @xmath , we always have the @xmath
-filled stripes as the ground state because of their lower entanglement
than the filled stripes. We are only able to stabilize the filled
stripes, which turns out to be the true ground state when having
eliminated the density matrix truncation error, by initializing the DMRG
calculations with favorable initial guess, based on our understanding of
the model and with the help of information from other methods. This
example again illustrates the benefits of combining information from
different numerical methods. Thus, we conclude that the ground state at
@xmath is also the @xmath stripe, although stripes of other wavelengths
become even more competitive than at @xmath . Overall, the similarity in
the physics over a wide range of @xmath indicates that striped orders
with low energy fluctuations of domain walls remain a robust feature in
the moderate to strongly coupled underdoped region.

Connection to stripe order in HTSC’s . In HTSC’s the accepted stripe
wavelength at 1/8 doping (e.g. in LaSrCuO) is @xmath (close to
half-filled) [ 251 ] . However, we find that the @xmath stripe is
unfavored in the 2D Hubbard model for the coupling range ( @xmath )
normally considered most relevant to cuprate physics. This implies that
the detailed charge-ordering of real materials arises from even stronger
coupling or, more likely, quantitative corrections beyond the Hubbard
model. With respect to the latter, one possibility is long-range
hopping, which has been seen to change the preferred stripe wavelength
in the frustrated @xmath - @xmath model [ 254 ] .

Another possibility is the long-range Coulomb repulsion. Long-range
repulsion can play a dual role, in both driving charge inhomogeneity, as
well as smoothing it out. In the Hubbard model, where stripes naturally
form, the latter property can help drive the ground state towards
shorter stripe wavelengths. In Fig. 5.9 we show the estimated effect of
the long-range interactions on the stripe energetics by computing the
Coulomb energy of the charge distributions of stripes with wavelengths
@xmath – @xmath . We use a dielectric constant of 15.5 (in the range
proposed for the cuprate plane [ 249 ] ). As shown in Fig. 5.9 , the
long-range Coulomb interaction favors shorter wavelength stripes and the
homogeneous @xmath -wave state, lifting the near-degeneracy of the
stripes, shifting the ground state to @xmath -filled stripe and making
the uniform @xmath -wave state also more competitive. Including the
long-range Coulomb interaction favors the shorter wavelength stripes
that is @xmath per site for the @xmath versus @xmath stripe. Although
this is only an order of magnitude estimate, it is on the same energy
scale as the stripe energetics in Fig. 5.4 , and thus provides a
plausible competing mechanism for detailed stripe physics in real
materials.

### 5.4 Conclusions

In summary, in this work we have employed state-of-the-art numerical
methods to determine the ground state of the iconic @xmath doping point
of the 2D Hubbard model at moderate to strong coupling. Through careful
convergence of all the methods, and exhaustive cross checks and
validations, we are able to eliminate several of the competing orders
that have been proposed for the underdoped region in favor of a vertical
striped order with wavelength near @xmath . The striped order displays a
remarkably low energy scale associated with its wavelength, which
implies strong fluctuations either at low temperature or in the
ground-state itself. This low energy scale can roughly be described at
the mean-field level with a strongly renormalized @xmath . We find
coexisting pairing order with a strength intertwined with the stripe
wavelength, indicating a coupling of stripe fluctuations to
superconductivity. The stripe degeneracy is robust as the coupling
strength is changed.

It has long been a goal of numerical simulations to provide definitive
solutions of microscopic models. Our work demonstrates that even in one
of the most difficult condensed matter models, such unambiguous
simulations are now possible. In so far as the 2D Hubbard model is a
realistic model of high-temperature superconductivity, the stripe
physics observed here provides a firm basis for understanding the
diversity of inhomogeneous orders seen in the materials, as well as a
numerical foundation for the theory of fluctuations and its connections
to superconductivity. However, our work also enables us to see
limitations of the Hubbard model in understanding real HTSC’s. Unlike
the stripes at this doping point in real materials, we find filled
stripes rather than near half-filled stripes. Given the very small
energy scales involved, terms beyond the Hubbard model, such as
long-range Coulomb interactions, will likely play a role in the detailed
energetics of stripe fillings. The work we have presented provides an
optimistic perspective that achieving a comprehensive numerical
characterization of more detailed models of the HTSC’s will also be
within reach.

## Appendix 5.A Appendix

#### 5.a.1 Additional Information for the Figures and Discussion

Figure 5.2 . The plotted energies (units of @xmath ) correspond to the
following specific calculations.

-   AFQMC: @xmath from extrapolation to @xmath (in both length and width
    directions) clusters with pinning fields.

-   DMRG: @xmath from extrapolation to @xmath clusters with pinning
    fields using the hybrid momentum/real-space representation.

-   DMET: @xmath from @xmath clusters with spin-inversion boundary
    conditions.

-   iPEPS: @xmath from @xmath supercells with extrapolation to zero
    truncation error.

Wavelengths of stripes . A key feature of the stripes is that each
stripe acts as an antiferromagnetic domain wall. As a well-known
consequence, at @xmath doping for half-filled stripes, the wavelength
associated with the AF periodicity ( @xmath ) is twice that of the
charge periodicity ( @xmath ). As an oversimplified but useful
characterization of this periodicity, we describe it by labeling the
spin pattern along a fixed row, assuming the stripe is width @xmath :
@xmath . Here the @xmath ’s indicate the positions of the localized
hole, and the patterns @xmath or @xmath signify the domain wall nature
of the stripe. Consider a charge wavelength which is an odd integer,
e.g. @xmath : @xmath We see that the ratio of AF and charge wavelengths
is one in this case, not two! This odd-even alternation is potentially
confusing, particularly if one has non-integer charge periodicity.

However, experimentally, one looks at structure factors, noting peaks
near @xmath . The locations of the peaks nearest @xmath do not show any
odd/even alternation. To see this note that the shift of the @xmath
-space origin to @xmath , for one particular row, is equivalent to an
alternating sign chain @xmath in the AF pattern, e.g. for charge
wavelength @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and for charge wavelength @xmath

  -- -------- --
     @xmath   
  -- -------- --

In both the even and odd cases, the distance of peaks from @xmath
corresponds to an AF “wavelength” of twice the charge wavelength.

#### 5.a.2 Summary of Stripe Energy Results

## Chapter 6 More Realistic Models of High-T@xmath
Superconductors 111This chapter presents work that has not been
published before.

### 6.1 Introduction

As discussed in Chapter 4 and 5 , numerical studies of the one-band
Hubbard model have achieved substantial progress regarding the ground
state energies and orders, as well as various low-lying competing states
even, even in the most difficult part of the phase diagram. This is
possible only through combing various state-of-the-art approximate
numerical methods to explore many candidate states proposed by theorists
or discovered by previous computational and experimental studies. A
great success as it is, the question arises that how relevant the
results, or the one-band Hubbard model itself, are to the cuprates
physics. As we discussed, the fact that many of the candidate states are
in a small energy range in the 2D Hubbard model reflects an artificial
degeneracy in this model. Any of these states could become the true
ground state if the parameters are slightly varied to favor that state.
Thus, to answer questions in experiments and to understand the factors
that determine the superconductivity transition temperature, one has to
go beyond the one-band Hubbard model and consider more details of the
real materials.

In this chapter, we describe the applications of DMET to two more
sophisticated systems: the three-band Hubbard model and a downfolded ab
initio cuprate Hamiltonian. These models introduce multi-orbital and
dynamical correlation effects, which could be important factors in real
materials. Other interactions, such as long-range Coulomb interactions
and interlayer coupling are not studied here, but could also have
significant impact on the ground state and low-temperature behaviors of
cuprate superconductors.

In Sec. 6.2 , we discuss the background and results of the three-band
Hubbard model. Sec. 6.3 describes the downfolded cuprate Hamiltonian and
the DMET calculations on the system. We present the main conclusions in
Sec. 6.4 .

### 6.2 The Three-Band Hubbard Model

The model . The three-band Hubbard model simulates the physics of the
CuO @xmath plane of cuprates with the valence orbitals: the copper
@xmath orbital and the oxygen bridge @xmath or @xmath orbitals [Fig. 6.1
]. When undoped, there are 5 electrons in each unit cell, formally
filling up the @xmath sites while the @xmath site is half filled.
Physically, however, it forms an antiferromagnetic charge-transfer
insulator, with occupation higher than one on the @xmath sites. Unlike
the one-band Hubbard model, the three-band model has significant
particle-hole asymmetry as the doped holes go primarily on the @xmath
sites while the doped electrons reside on the Cu @xmath sites.

Previous numerical studies of the three-band model ground state using
Lanczos, quantum Monte Carlo, dynamical mean-field theory, variational
cluster approximation and diagrammatic perturbation show even richer
charge, spin and pairing orders than in the one-band model [ 68 , 259 ,
260 , 261 , 262 , 263 , 264 , 265 , 266 ] . Yet, because the model is
numerically more difficult, fewer studies are carried out compared to
the one-band Hubbard model. The numerical studies are far from reaching
the thermodynamic limit (TDL) or having enough energy resolution to
determine the ground state, especially in the dope model. DMET is thus a
unique method that has the potential to carry out definitive numerical
simulations on the three-band model with an affordable computational
cost.

Computational details . The full parameterization of the three-band
model usually includes the hopping between the nearest @xmath and @xmath
orbitals @xmath , and between the nearest and next-nearest @xmath
-orbitals @xmath and @xmath , onsite interactions @xmath and @xmath ,
nonlocal Coulomb interaction @xmath and the energy difference @xmath
[Fig. 6.1 ]. There are different approaches to map cuprates to the
three-band model, thus a wide range of parameters are published and used
in numerical studies, which do not always agree with each other [ 267 ,
268 , 269 , 270 , 271 , 272 , 262 ] . In our DMET calculations, we
choose to use only the minimal set of parameters @xmath , @xmath and
@xmath , from the common parameter sets summarized in Table 6.1 . Note
that we use the electron representation, which is different from
literature conventions, where the parameters are written down for the
holes.

We carried out broken particle-number symmetry DMET calculations (see
Appendix Sec. B.2 ) on the three-band model using fragments of 12 sites,
on an auxiliary lattice of @xmath unit cells. In the three-band model,
the conventional @xmath supercell breaks inversion symmetry and, since
the Cu and O atoms become inequivalent in the impurity model, the
symmetry would also break in the correlated wavefunction, leading to
unfavored artifacts. To reduce this effect as much as possible, we
follow Ref. [ 263 ] and use a modified @xmath cell which restores the
inversion symmetry (Fig. 6.2 ). We varied occupations in the model and
computed the energies, magnetic and pairing order parameters. Since it
is not clear how to decompose the pairing order in the symmetry-broken
three-band fragments, we use the total norm of local pairing order
parameters as a proxy for the pairing order strength, which reflects the
combined pairing strength in all symmetry sectors.

Results – undoped . The results for the undoped three-band model are
summarized in Table 6.2 . We find the charge transfer between the oxygen
@xmath -orbitals and the copper @xmath orbitals, and antiferromagnetic
order with staggered magnetization @xmath , localized on @xmath
orbitals. These results are consistent among all sets of parameters, and
with previous studies [ 68 ] . We also notice the more recent parameters
from Martin (1996) and Hanke (2009) are more consistent with each other
than Hybertsen (1989), indicating increasing consensus on the parameters
of the model.

Results – energy and charge distribution . We plot the energies per hole
and energies per electron for the doped three-band model in Fig. 6.3 .
Since we do not perform fragment size extrapolation, the error bars only
show the DMET convergence errors. We notice on both hole- and
electron-doped sides, there are points with large error bars. These
reflect either DMET has experienced convergence issues, or the energy
becomes sensitive to small changes in the correlation potential, usually
because the correlation potential has redundant or unnecessary degrees
of freedom. Thus, it is necessary to explore better parameterization of
@xmath to avoid this problem.

Nevertheless, Fig. 6.3 is still informative. For hole-doped cuprates,
the energies per hole are almost constant (between @xmath eV and @xmath
eV) when doping is varied in all the parameters, suggesting the phase
separation or inhomogeneous orders are likely to appear for a wide range
of doping. On the electron doped side, the energies per (doped) electron
have different behaviors for the parameters we use: Martin and Hybertsen
are more or less constant around @xmath eV and @xmath eV, respectively,
while Hanke gives decreasing energy per electron, leading to strong
phase separation effect. These unusual and inconsistent behaviors
reflect that these models do not correctly describe the electron-doped
cuprates, simply because they are fitted to the hole-carrier
superconductors, such as La @xmath Sr @xmath CuO @xmath .

In Fig. 6.4 , we summarize the charge distribution when the model is
doped for all three sets of parameters. The numbers are averaged over
local charge distributions. As expected, when the system is hole-doped,
the holes go primarily to the oxygen @xmath sites, while the doped
electrons tend to stay on the copper @xmath sites. This leads to the
particle-hole asymmetry in cuprate superconductors, and is correctly
described by the three-band model using DMET.

Results – spin and pairing orders . In Fig. 6.5 , we show the
antiferromagnetic (AF) and pairing order parameters in the hole-doped
three-band model. We do not display the electron-doped side because from
what we learned before, the parameters we use do not seem to describe
the correct physics on the electron-doped side. The magnetic order
parameters are averaged over the copper @xmath sites with the @xmath
structure factor, as there is virtually no spin on the @xmath orbitals
when the model is doped. Overall, the shapes of the order parameter
curves and sizes are similar to what we obtained from one-band model
calculations.

The AF order decreases with increasing doping, consistent with what we
find in the one-band Hubbard model and cuprates. The order remains
robust at @xmath doping, with the value @xmath – @xmath , which is
probably overestimated. It is a known issue in DMET to overestimate
magnetic order parameters in small fragments, which can be eliminated by
increasing the fragment size and extrapolating to the TDL. Both results
from Martin and Hanke show a superconducting dome (in terms of the
magnitudes of the order parameters, rather than transition temperature),
with maximum pairing at @xmath and @xmath , respectively. This is
plausible behavior one would expect from the experience. The Hybertsen
parameters, however, give virtually no pairing order in the whole
parameter range.

Fig. 6.6 shows the local orders at the optimal doping points using
parameters from Martin and Hanke. The charge and spin orders do not show
much inhomogeneity, while the pairing order is much more complicated
than the simple @xmath -wave symmetry we saw in the one-band model.
Overall, the pairing strength is strongest between neighboring sites
(including nearest @xmath orbitals) and between @xmath orbitals. Besides
the most common @xmath symmetry, we can also recognize extended @xmath
-wave (eg., between nearest @xmath sites), @xmath -wave and @xmath -wave
pairing. However, it is not clear enough how to decompose the real space
pairings into angular momentum sectors (coupled with spatial
inhomogeneity) for the DMET results. It is unlikely that the pairing
irregularity is an artifact, because the spin and charge orders seem
reasonable, and the trends for the total pairing strength are also as
expected.

Conclusions . We conducted an exploratory investigation of the
three-band model using DMET using a 12-site symmetrized fragment. Using
the conventional DMET algorithms designed for the one-band model, we
were not able to control the energy accuracy to similar magnitudes,
mainly due to the difficulties in converging the DMET energies.
Nevertheless, we obtain reasonable charge and spin distributions for the
undoped and hole-doped models with all the parameters we examed, while
the local pairing order parameters show complicated spatial and angular
momentum distribution, which requires further investigations with higher
energy accuracy to confirm or reject. Other future directions include
employing impurity solvers which are more scalable such as CASSCF
solvers, to study larger fragments on inhomogeneity and to extrapolate
to the TDL.

### 6.3 Realistic Cuprates from Hamiltonian Downfolding

The Hamiltonian and computational strategy . The ultimate goal in
material numerical studies is being able to compute properties of
strongly correlated materials from first principles. To do this, one has
to go beyond model systems and form a streamlined approach to process
real materials similar to DFT for normal materials. DMFT+DFT has been a
very successful practice and applied to many important problems so far
(See, eg., Refs. [ 45 , 273 , 274 , 275 ] ). However, despite the huge
computational cost, DMFT also suffers from the so-called double counting
problem [ 276 ] , where the correlation energy is included in both DMFT
and DFT calculations. To fix the double counting problem, one usually
has to introduce system-dependent terms derived from experience or
experimental data.

In addition to exploring a parameter-free treatment of cuprates, we
would also like to find an alternative path to study general strongly
correlated materials from first principles using DMET. We propose the
following algorithm to carry out the calculations:

1.  Compute the band structure using DFT or Hartree-Fock, and use the
    information to construct, in a local basis, the Fock matrix of the
    lattice system, the local one-body density matrix and the local
    two-body integrals.

2.  Project the local one-body density matrix to each atom and form the
    atomic natural orbitals (ANO). Choose relevant ANOs to form the
    basis of the correlated calculations. Remove the Coulomb and
    exchange contributions from the correlated ANOs in the lattice Fock
    matrix.

3.  Perform DMET calculations based on the effective hopping (lattice
    Fock matrix minus contributions from correlated ANOs) and local
    two-body integrals (in the ANO basis).

4.  Once DMET is converged, add the correlation potential @xmath to the
    DFT or Hartree-Fock calculations in step 1, and perform the
    calculations in step 1 to 3 again, until convergence.

In this work, we carried out small proof-of-principle calculations on La
@xmath CuO @xmath and Ca @xmath CuO @xmath Cl @xmath , whose structures
are shown in Fig. 6.7 . For step 1, we performed the spin-restricted DFT
calculations with the periodic Gaussian double-zeta basis fitted as
linear combinations of plane wave functions, detailed in Ref. [ 277 ] .
Lately, new periodic DFT / Hartree-Fock codes are available and would
presumably be more efficient and robust to use [ 278 ] . For step 2, we
project the one-body density matrix to atomic basis by taking the
corresponding blocks of the density matrix, and diagonalize them to
obtain the ANOs. Alternatively, we could take the corresponding rows and
run SVD to obtain a slightly different set of ANOs. The ANOs we obtained
show clear characteristics of orbital shape and occupation. In Fig. 6.8
we plot the projected density of states to the full CuO @xmath plane and
to the ANO space. By including @xmath orbitals per unit cell, it is
already sufficient to reproduce the PDOS near the Fermi level (up to
@xmath eV above), and serves as a realistic correlation model for the
real material. Thus, if we choose the @xmath supercell as the fragment,
the total number of orbitals is around 100 per fragment, or 200 per
impurity model, most of which are weakly correlated. Thus, it is
possible to use CASSCF impurity solvers coupled with DMRG to treat the
impurity models.

To illustrate the principle, however, we further freeze most of the ANOs
but 5 per unit cell: Cu @xmath and O @xmath orbitals. Although the
impurity model is now small enough to be solved with DMRG alone, we
instead use the DMRG/CASSCF solver with 12 active orbitals. The
calculations are carried out without broken particle-number symmetry and
we did not perform the macro self-consitency between the DFT and DMET
calculations (step 4).

Results . In the undoped material, the average occupations on Cu atoms
(the three orbitals) are 1.832 and 2.012 for La @xmath CuO @xmath and Ca
@xmath CuO @xmath Cl @xmath , respectively. This seems unreasonable but
may merely reflect the renormalization between @xmath -orbitals and
virtual orbitals on Cu. Besides, since we include two virtual orbitals
on each Cu atom but no virtual orbitals on O atoms, there may be an
imbalance between the two species that drives the artificial charge
transfer. If we only look at the Cu @xmath orbital, the occupations are
1.382 and 1.410.

Fig. 6.9 shows the hole/electron densities on copper and the AF order,
versus doping. When @xmath , i.e., undoped, the AF order is slightly
higher in La @xmath CuO @xmath ( @xmath ) than in Ca @xmath CuO @xmath
Cl @xmath ( @xmath ). These numbers are smaller than experimental
values, but the order is consistent: the Néel temperature for La @xmath
CuO @xmath is around 300K, compared to @xmath 250K for Ca @xmath CuO
@xmath Cl @xmath [ 279 , 280 ] . The quantitative disagreement may be
due to the spin-restricted Fock matrix from DFT calculations, which
suppresses the magnetic order. This could be fixed by introducing the
self-consistency between DFT and DMET. When the cuprates are doped, the
holes go primarily to oxygen @xmath orbitals while electrons mostly go
to copper @xmath orbitals, consistent with our results on the three-band
model. Thus, the AF order is destroyed faster on the electron-doped side
compared to hole-doped side. This is opposite to what happens in the
generic cuprate phase diagram, and not what one would expect. However,
by inspecting the results more carefully, we find signs of broken
spatial symmetry and development of inhomogeneous orders in the
underdoped region of the hole-doped cuprates, which is much weaker for
electron-doped cuprates. Thus, once we go to larger fragments, the
inhomogeneous orders may be stabilized and destroy the AF order in the
hole-doped cuprates; while the AF order survives for electron doping.
This conjecture is consistent with what we saw in the 1D Hubbard model
calculations, as well as the results here, and seems a plausible
explanation for the particle-hole asymmetry in the generic cuprate phase
diagram. Confirming this conjecture may require larger fragments similar
to those used in the one-band Hubbard model studies.

Conclusions . We demonstrate a DFT/HF-DMET approach to study strongly
correlated materials from first principles without any artificial
parameters. The approximations involved in these calculations are by no
means converged or controlled. However, we achieve qualitatively correct
results in all respects we have access to. With an improved treatment in
all the steps involved, it is promising to finally perform accurate
calculations of cuprates from first principles.

### 6.4 Conclusions

We present two exploratory applications of DMET to study the cuprate
physics beyond the one-band Hubbard model. General qualitative features,
such as the interplay of antiferromagnetic and pairing orders,
instabilities to inhomogeneous phases, remain in these systems, while to
reach the quantitative details requires more effort to improve the DMET
algorithm. With further developments in the method, impurity solvers and
computational resources, ab initio , predictive calculations of high-T
@xmath superconductivity in cuprates is an achievable goal.

## Chapter 7 Finite Temperature Density Matrix Embedding Theory: A
Superoperator Approach 111This chapter presents work that has not been
published before.

### 7.1 Introduction

While ground state wavefunctions contain rich information about the
materials, it is still desirable to access finite-temperature
properties, partly because most experimental measurements happen in
finite temperature and it is easy to obtain the temperature dependence
of physical observables.

Thus, extending DMET to finite temperature would significantly expand
the scope of the method, which becomes potentially useful for studying
chemical dynamics, spectral properties and directly observe
superconducting phase transition in cuprates.

A simple “hack” to enable finite temperature calculations is to use the
thermal one-body density matrix to replace the ground-state density
matrix in DMET, and finite-temperature impurity solvers to replace
ground state solvers. A problem of this approach is that the one-body
density matrix is no longer idempotent, and the number of bath orbitals
is not bounded anymore; although we can always truncate the bath
orbitals, it becomes increasingly hard to do so at high temperature. The
more serious issue is that, this approach does not have a solid
theoretical framework to guarantee its correctness. Nevertheless, this
approach is of low cost and minimal implementation effort and thus is
worth exploring for low-temperature applications.

In this chapter, however, we discuss another approach based on the
singular value decomposition (SVD) of the density operator, analogous to
the SVD of the wavefunction in the ground-state formulation. The central
problem here, is how to define a Hilbert space for the mean-field
density operators, which enables SVD in the single-particle basis,
similar to the Schmidt decomposition of mean-field wavefunctions. It
turns out that a mathematical tool called superoperators can be applied
to solve this problem. In Sec. 7.2 , we introduce the theoretical
framework in detail. Then we present the conclusions in Sec. 7.3 .

### 7.2 Theory

#### 7.2.1 The Superoperator Space

The superoperator formalism provides a way to encode thermal density
operators as vectors in a fermion Fock space, thus one can perform
operations such as creation, annihilating, inner product, etc. similar
to wavefunctions.

To derive the formulation, we use the spinless notation for simplicity.
We start by writing the normal fermion creation (annihilation) operators
as Majorana fermions (we reserve @xmath as the complex number unit)

  -- -------- -- -------
     @xmath      (7.1)
  -- -------- -- -------

The Majorana fermions are the antiparticles of themselves, thus @xmath
(this can also be derived rigorously using Eq. 7.1 ). For any operator
@xmath as finite or infinite polynomial expansions of @xmath , the
Majorana transformation leads to a linear combination of Majorana
fermion strings

  -- -------- --
     @xmath   
  -- -------- --

where @xmath or @xmath . Thus, each of the @xmath string in the Majorana
fermion string space can be written as a string of @xmath , and

  -- -------- -- -------
     @xmath      (7.2)
  -- -------- -- -------

We can define creation and annihilation operators in the superoperator
space

  -- -------- -- -------
     @xmath      (7.3)
  -- -------- -- -------

where @xmath . We can easily compute the anticommutation relations

  -- -------- -- -------
     @xmath      (7.4)
  -- -------- -- -------

We notice the anticommutation relations are the same as fermions. Thus,
the operators @xmath are (super) fermion operators, and the
superoperator space @xmath has the same algebra as the fermion Fock
space.

Now we look at a few common notations and operations in the
superoperator space. The vacuum state of the space is the identity
operator, denoted as @xmath .

A common operation between operators is the operator product. Given
@xmath and @xmath , the product is written as the concatenation of the
Majorana fermion strings. Notice in Eq. 7.3 , @xmath , the product can
be expressed in the superoperator space as

  -- -------- -- -------
     @xmath      (7.5)
  -- -------- -- -------

Another important operation is the trace. We notice that

  -- -------- -- -------
     @xmath      (7.6)
  -- -------- -- -------

Thus the trace of the product of two operators is the overlap of the
their supervectors, and the trace for one operator is @xmath .

#### 7.2.2 Mean-Field Density Operator

Consider the quadratic Hamiltonian

  -- -------- -- -------
     @xmath      (7.7)
  -- -------- -- -------

where @xmath annihilates (creates) an electron at site @xmath , and
@xmath is the basis that diagonalizes the mean-field Hamiltonian. In
addition to the one-body part of the full Hamiltonian or the Fock
matrix, we absorb the correlation potential and the shift resulted from
chemical potential into @xmath . Thus, the mean-field many-body density
operator at @xmath is

  -- -------- -- -------
     @xmath      (7.8)
  -- -------- -- -------

where the partition function

  -- -------- -- -------
     @xmath      (7.9)
  -- -------- -- -------

The density operator is actually separable @xmath , where

  -- -------- -- --------
     @xmath      (7.10)
  -- -------- -- --------

which is equivalent to considering each canonical orbitals as an
independent subsystems.

At @xmath , the expression reduces to

  -- -------- -- --------
     @xmath      (7.11)
  -- -------- -- --------

whose eigenvector is the ground state Slater determinant.

The mean-field Hamiltonian in the canonical basis (Eq. 7.7 ) can be
further written as

  -- -------- -- --------
     @xmath      (7.12)
  -- -------- -- --------

where @xmath are now the Majorana fermions corresponding to canonical
orbitals @xmath , and @xmath . And the density operator is

  -- -------- -- --------
     @xmath      (7.13)
  -- -------- -- --------

where, according to Eq. 7.5

  -- -------- -- --------
     @xmath      (7.14)
  -- -------- -- --------

is the mean-field Hamiltonian operator in the superoperator space.
Forget about the normalization factor for the moment, the density
operator becomes

  -- -------- -- --------
     @xmath      (7.15)
  -- -------- -- --------

The same result can be obtained by replacing the fermion operators in
Eq. 7.8 with Majorana fermions and directly write down the superoperator
space representation. The normalization factor for Eq. 7.15 is thus
@xmath .

#### 7.2.3 Finite Temperature DMET Embedding

The resulted superoperator representation of the mean-field density
operator is a BCS state. To show this, we perform the Bogoliubov
transformation

  -- -------- -- --------
     @xmath      (7.16)
  -- -------- -- --------

with the inverse transformation

  -- -------- -- --------
     @xmath      (7.17)
  -- -------- -- --------

The transformation is analogous to the spin-singlet Bogoliubov
transformations for normal fermions, if we view particle indices @xmath
as spin-up and indices @xmath as spin-down. Using the condition @xmath ,
we obtain

  -- -------- -- --------
     @xmath      (7.18)
  -- -------- -- --------

Thus, the problem becomes the Schmidt decomposition of a BCS
wavefunction. In fact, we can also compute the generalized one-body
density matrix of superoperator state @xmath , in terms of operators
@xmath , where the only non-zero elements are

  -- -------- -- --------
     @xmath      (7.19)
  -- -------- -- --------

Note that the sparsity in the Bogoliubov transformation and the
generalized density matrix is simple because we work in the canonical
basis of the mean-field Hamiltonian. Transforming to the local basis
will yield dense representations of both.

The superoperator approach doubles the number of orbitals in the DMET
fragment as well as the size of the impurity model, compared to their
ground state counterparts.

#### 7.2.4 Impurity Solver

After constructing the impurity model, the mean-field density operator
can be expressed as

  -- -------- -- --------
     @xmath      (7.20)
  -- -------- -- --------

In the impurity solver, we essentially replace the mean-field @xmath
with correlated @xmath . However, obtaining @xmath is not as simple as
it seems. We have to be aware that @xmath , where @xmath , the
mean-field Hamiltonian projected to the impurity model, because the
imaginary time evolution also involves the coupling term @xmath . Thus,
to obtain @xmath , we replace only the pure impurity model part of the
Hamiltonian with the interacting version, which gives ² ² 2 Strictly
speaking, the calculation of @xmath should also start with @xmath and
use operator @xmath to evolve the impurity model. However, under the
constraint of fixed @xmath , the impurity model solution can be
approximated with Eq 7.21 .

  -- -------- -- --------
     @xmath      (7.21)
  -- -------- -- --------

where @xmath , and @xmath is the superoperator representation of the
interacting Hamiltonian with two-body terms (non-interacting or
interacting bath). The imaginary time evolution in Eq. 7.21 is slightly
different from what we usually encounter, as the operator acts on a pure
state (precisely a BCS wavefunction) in the superoperator space. Thus,
the calculation can be carried out using quantum Monte Carlo simulations
such as AFQMC with walkers in the BCS wavefunction space [ 281 ] , or
with time-dependent matrix product state algorithms [ 282 , 283 , 284 ]
.

### 7.3 Conclusions

In this chapter, we present a superoperator space algorithm for
finite-temperature density matrix embedding. The theory relies on
transforming the mean-field density operator to a BCS state in the
superoperator space, which can form the DMET bath states using the
single-particle based decomposition we introduced in Sec. 2.3 . As a
result of switching to the superoperator space, the size of the
fragment, and thus the bath, is doubled compared to the ground-state
formulation. It is consistent with the doubled degrees of freedom in the
density operator language of mixed states. The algorithm works best for
higher temperatures. At low temperature, where @xmath becomes large,
however, the algorithm may suffer from accumulated errors from the
approximations in Eq. 7.21 , as well as errors from the
finite-temperature impurity solvers.

## Appendix A Mathematical Derivations and Formula

### a.1 Impurity Model Hamiltonian for Broken Particle-Number Symmetry
DMET

The impurity model for broken particle-number symmetry DMET is defined
with the reference vacuum @xmath and a set of allowed excitations
(fragment and bath quasiparticles) defined in Eq. 2.38 .

To obtain the impurity Hamiltonian, we project the non-interacting bath
Hamiltonian to the impurity model Hilbert space in the grand canonical
ensemble

  -- -------- -- -------
     @xmath      (A.1)
  -- -------- -- -------

where the chemical potential is absorbed into the one-body term. Eq. A.1
is transformed using the inverse transformation, using only the fragment
and bath orbitals

  -- -- -- -------
           (A.2)
  -- -- -- -------

where we ignore the bath index in Eq. 2.38 and use @xmath instead of
@xmath . In the impurity model basis, we have

  -- -------- -- -------
     @xmath      (A.3)
  -- -------- -- -------

Note that @xmath has two additional terms which break particle-number
symmetry. They connect to the @xmath number sectors.

#### a.1.1 One-Body Terms

We can work out the one-body terms using the matrix representation in
Eq. A.2 .

  -- -------- -- -------
     @xmath      (A.4)
  -- -------- -- -------

and similarly the pairing channel

  -- -- -- -------
           (A.5)
  -- -- -- -------

Therefore, the contributions from the one-body Hamiltonian to the
impurity model are

  -- -------- -- -------
     @xmath      (A.6)
  -- -------- -- -------

#### a.1.2 Two-Body Terms

The contributions from two-body terms are much more complicated. It is
evaluated by expanding

  -- -------- -- -------
     @xmath      (A.7)
  -- -------- -- -------

which contains 64 terms requiring normal ordering. We evaluated this
expression using an automatic fermion algebra and code generator (Sec.
B.6 ).

Note that besides the two-body terms @xmath , Eq. A.7 results in
one-body contributions @xmath and a constant @xmath as well. For the
convenience of calculation, we enforce the following symmetries

  -- -------- -- -------
     @xmath      (A.8)
  -- -------- -- -------

while for @xmath , the 8-fold symmetry still applies for like spins, and
for opposite spins, only the 2-fold symmetry @xmath applies. (Of course,
we still have @xmath ). In the spin-restricted case, additional
symmetries @xmath , @xmath and @xmath exist, but @xmath !

One additional note is that, when we want to evaluate any physical
quantities in the impurity model (or the fragment), we write down the
expression in the lattice basis and project to the impurity model in the
same ways as projecting the Hamiltonian. For instance, the chemical
potential term @xmath , will no longer be a diagonal one-body matrix in
the impurity model representation. Instead, it will contain normal and
pairing one-body terms as well as a constant contribution.

### a.2 DMRG Impurity Solver with Broken Particle-Number Symmetry

Efficient DMRG implementations use quantum numbers to introduce block
sparsity [ 101 ] . To see how this works, one can simply associate them
with the left and right basis in Eq. 2.43 and prevent mixing them when
performing SVD on the site wavefunction (or equivalently diagonalizing
the density matrix).

Normal DMRG calculations usually keep quantum numbers @xmath (particle
number) and @xmath (spin component on the @xmath -axis). Some
implementations also keep @xmath (total spin) [ 102 ] . When solving the
impurity model Hamiltonian Eq. A.3 , we still keep the quantum numbers
@xmath and @xmath , since the Hamiltonian is still sparse in terms of
@xmath ; Instead of being block diagonal in the basis with definitive
particles, it now becomes a block band matrix, connecting to @xmath
sectors with @xmath only. The computational cost is thus still lower
than completely discarding the information of particle number.

In realistic DMRG implementations, the Schrödinger equation (Eq. 2.45 )
is solved using the Davidson algorithm (where one computes @xmath ) [ 95
] , where the Hamiltonian matrix is represented as the sum over a number
of direct product terms

  -- -------- -- -------
     @xmath      (A.9)
  -- -------- -- -------

where

  -- -------- -- --------
     @xmath      (A.10)
  -- -------- -- --------

For normal state DMET, Table A.1 show the decomposition of the
Hamiltonian [ 101 ] . Assuming the number of sites on the left is
smaller than that on the right, the Hamiltonian decomposition @xmath is

  -- -------- -- --------
     @xmath      (A.11)
  -- -------- -- --------

where the pre-contracted complimentary operators @xmath are defined in
Table. A.1 . The contractions are performed in the left (right) basis if
the normal operator is in the right (left) basis. @xmath and @xmath are
identity operators on the left and right basis, respectively. Similar
decomposition can be carried out for the impurity model Hamiltonian in
Eq. A.3 , with the much more complicated complimentary operators defined
in Table A.2 . Note that although the number of operators is still the
same, the complimentary operators now have more than one possible
quantum numbers.

Note that in Table A.1 and A.2 , we did not make the numerical factors
correct, since they are coupled with the details of the implementation
and thus not very useful when taken out of the context.

### a.3 CASSCF Formulation with Broken Particle-Number Symmetry

Conceptually, active space calculations based on a BCS wavefunction
means using the BCS wavefunction as a reference state, and allow some of
the quasiparticle excitations while freezing others. The allowed
excitations form the active space, while the core quasiparticles can be
thought of as the occupied quasiparticle modes on top of the
all-spin-down product state we mentioned before.

#### a.3.1 Active Space Hamiltonian

We would like to obtain an effective Hamiltonian with the core
contracted. We can write the original Hamiltonian as

  -- -------- -- --------
     @xmath      (A.12)
  -- -------- -- --------

The pure core contribution is a constant energy, while @xmath gives
effective one-body terms similar to the Fock matrix. The pure active
part is transformed as described in Sec. A.1 .

To see how @xmath is transformed, we illustrate the transformation of
the normal two-body integral

  -- -------- -- --------
     @xmath      (A.13)
  -- -------- -- --------

where @xmath , @xmath , @xmath . These operators are closely related to
the Coulomb, exchange and pairing contributions in Fock matrix.
Therefore, the effective one-body terms from the normal two-body
integrals are

  -- -------- -- --------
     @xmath      (A.14)
  -- -------- -- --------

The derivation for all the two-body terms are more complicated and more
terms are involved. We thus use an automatic fermion algebra and code
generator to derive and implement these terms (Sec. B.6 ).

#### a.3.2 Orbital Rotation

We derive the equations for orbital gradient and Hessian for BCS-CASSCF.
They are then inserted to the CASSCF routine of PySCF ¹ ¹ 1
https://github.com/sunqm/pyscf [ 115 ] to perform orbital rotations.

Orbital rotation in the Bogoliubov transformation group is defined as

  -- -------- -- --------
     @xmath      (A.15)
  -- -------- -- --------

where @xmath is a unitary matrix. The orbital rotation is a unitary
canonical transformation [ 285 ] , and there exists a unitary operator
@xmath , where

  -- -------- -- --------
     @xmath      (A.16)
  -- -------- -- --------

and @xmath is Hermitian, such that

  -- -------- -- --------
     @xmath      (A.17)
  -- -------- -- --------

The relationship between @xmath and @xmath is

  -- -------- -- --------
     @xmath      (A.18)
  -- -------- -- --------

We would like to solve for contraints on @xmath . We define a unitary
matrix

  -- -------- -- --------
     @xmath      (A.19)
  -- -------- -- --------

which block-diagonalizes @xmath , such that

  -- -------- -- --------
     @xmath      (A.20)
  -- -------- -- --------

where @xmath is also unitary. We thus have

  -- -------- -- --------
     @xmath      (A.21)
  -- -------- -- --------

Therefore, let @xmath , and @xmath , then

  -- -------- -- --------
     @xmath      (A.22)
  -- -------- -- --------

If we are dealing with Bogoliubov transformations with real numbers, all
the entries of @xmath can be set to imaginary numbers, as well as @xmath
, therefore @xmath . We can parameterize @xmath as

  -- -------- -- --------
     @xmath      (A.23)
  -- -------- -- --------

where @xmath , @xmath . We therefore have

  -- -------- -- --------
     @xmath      (A.24)
  -- -------- -- --------

Since @xmath . Given this transformation, for any Fock state

  -- -------- -- --------
     @xmath      (A.25)
  -- -------- -- --------

The Bogoliubov orbital rotation gives

  -- -------- -- --------
     @xmath      (A.26)
  -- -------- -- --------

and the energy expression, under the rotation of orbitals defined in Eq.
A.15 , is

  -- -------- -- --------
     @xmath      (A.27)
  -- -------- -- --------

Therefore, the energy gradient is

  -- -------- -- --------
     @xmath      (A.28)
  -- -------- -- --------

And the Hessian is

  -- -------- -- --------
     @xmath      (A.29)
  -- -------- -- --------

If we restrict everything in the real domain, @xmath can be ignored. The
gradient and Hessian expressions are analogous to those in normal state
CASSCF, with the only additional contribution from Bogoliubov rotations.
Eq. A.28 and Eq. A.29 are thus evaluated using the automatic fermion
algebra and code generator, described in Sec. B.6 .

### a.4 Constraints for Sign-Problem-Free Correlation Potentials in DMET
in the Half-Filled Hubbard Model

We first motivate our derivation by recalling how AFQMC becomes
sign-problem free in the half-filled Hubbard model on a bipartite
lattice. Given the repulsive Hubbard model with chemical potential
@xmath

  -- -------- -- --------
     @xmath      (A.30)
  -- -------- -- --------

we perform the partial particle-hole transformation on only the spin-up
electrons

  -- -------- -- --------
     @xmath      (A.31)
  -- -------- -- --------

where the parity term @xmath is @xmath for sublattice @xmath , and
@xmath for the other sublattice, @xmath . The transformation results in
the attractive Hubbard model

  -- -------- -- --------
     @xmath      (A.32)
  -- -------- -- --------

which is well-known to be sign-problem free at any occupation. This is
seen by performing the Hubbard-Stratonovich transformation, where the
Trotter propagator becomes [ 286 ]

  -- -------- -- --------
     @xmath      (A.33)
  -- -------- -- --------

with @xmath . Notice that Eq. A.33 is spin-symmetric, thus as long as
the trial wavefunction @xmath is spin-symmetric, the walkers @xmath are
also spin-symmetric. The overlap

  -- -------- -- --------
     @xmath      (A.34)
  -- -------- -- --------

then eliminates the sign problem. From this argument, we also see why
the repulsive Hubbard model is sign problem free only at half-filling,
since we require the same number of spin-up holes and spin-down
particles in the wavefunction.

In DMET calculations, it is easy to show that if the partial
particle-hole symmetry is preserved in the lattice Hamiltonian, the
resulting impurity problem remains sign-problem free. Consider the
partial particle-hole transformation, Eq. ( A.31 ), acting on the
non-interacting lattice Hamiltonian in Eq. 2.13 , with chemical
potential @xmath

  -- -------- -- --------
     @xmath      (A.35)
  -- -------- -- --------

To impose spin symmetry, we have

  -- -------- -- --------
     @xmath      (A.36)
  -- -------- -- --------

which leads to Eq. 2.57 . When this condition is satisfied, the ground
state of the transformed lattice Hamiltonian @xmath is a spin-symmetric
Slater determinant and thus the bath orbitals obey @xmath . The impurity
model Hamiltonian is thus sign-problem free, as the one-body part is
clearly spin-symmetric and the fragment interaction @xmath transforms to
an attractive Hubbard interaction.

Note that our argument applies to both CDMET and DCA-DMET, since the DCA
transformation preserves the partial particle-hole symmetry, which is
the only structure assumed of @xmath in the above derivation.

### a.5 Translational Symmetries in the DCA-DMET Correlation Potential
with AF Order

We here consider the translational symmetry in the correlation potential
in the presence of antiferromagnetic order. Instead of the normal
translational operators, the lattice Hamiltonian is invariant under the
spin-coupled translational operators

  -- -------- -- --------
     @xmath      (A.37)
  -- -------- -- --------

where the parity of @xmath represents whether a translation brings a
site to the same or different sublattice. The Hubbard Hamiltonian is
invariant under @xmath operations, because it has both translational and
time-reversal symmetry. Transforming the correlation potential with the
spin-coupled translational operators yields

  -- -------- -- --------
     @xmath      (A.38)
  -- -------- -- --------

leading to the constraint

  -- -------- -- --------
     @xmath      (A.39)
  -- -------- -- --------

This constraint, as one can easily verify, is also compatible with the
partial particle-hole symmetry required for sign-free AFQMC simulations
in the Hubbard model.

## Appendix B Algorithms

### b.1 Normal State DMET Algorithm

The algorithm for normal state DMET calculations is described below.

1.  Initial guess for the correlation potential @xmath .

2.  Solve the mean-field wavefunction @xmath , determine the initial
    value of chemical potential @xmath .

3.  Calculate bath orbitals and construct impurity model Hamiltonian
    @xmath .

4.  Solve the impurity model while adjusting the chemical potential
    (Sec. B.4 ).

5.  Compute the one-body matrix @xmath and fragment energy @xmath .

6.  Optimize correlation potential @xmath .

7.  If @xmath and @xmath , complete the calculation; otherwise continue.

8.  If @xmath , the starting cycle for DIIS, use DIIS to obtain the new
    correlation potential @xmath , otherwise @xmath .

9.  Diagonalize the mean-field Hamiltonian, if the @xmath is out of the
    range of the HOMO and LUMO energies, adjust @xmath . Go to Step 3.

### b.2 Broken Partical-Number Symmetry DMET Algorithm

The algorithm for broken particle-number symmetry DMET calculations is
described below.

1.  Initial guess for the correlation potential @xmath .

2.  Solve for the BCS wavefunction @xmath , while determining initial
    value of chemical potential @xmath by imposing the correct number of
    electrons to @xmath .

3.  Calculate bath orbitals and construct impurity model Hamiltonian
    @xmath .

4.  Solve the impurity model while adjusting the chemical potential
    (Sec. B.4 ).

5.  Compute the generalized one-body matrix @xmath and fragment energy
    @xmath .

6.  Optimize correlation potential @xmath .

7.  If @xmath and @xmath , complete the calculation; otherwise continue.

8.  If @xmath , the starting cycle for zero-tracing, shift the diagonal
    of @xmath to have @xmath .

9.  If @xmath , the starting cycle for DIIS, use DIIS to obtain the new
    correlation potential and chemical potential @xmath , @xmath ;
    otherwise @xmath .

10. Go to Step 2.

### b.3 Correlation Potential Optimization

In the correlation potential optimization step, we need to minimize the
(modified) cost function

  -- -------- -- -------
     @xmath      (B.1)
  -- -------- -- -------

where @xmath and @xmath are correlated and mean-field wavefunctions,
respectively. The density matrix @xmath is projected to the impurity
model. Because of broken particle-number symmetry, generalized density
matrix @xmath is used instead of @xmath .

To evaluate the cost function, each time when we update @xmath , we need
to diagonalize the lattice mean-field Hamiltonian compute the density
matrix and project to the impurity model. This can be costly especially
when we compute the gradient. An approximate approach with good
performance is to first project the mean-field Hamiltonian to the
impurity model and when @xmath is updated, use the same linear
transformation to project @xmath to the impurity model, and diagonalize
the mean-field Hamiltonian in the impurity model space. This saves the
cost of diagonalizing the giant lattice Hamiltonian (even if k-space
symmetry is used), as well as constructing and transforming the giant
density matrix (instead, the correlation potential is much smaller). The
approximate algorithm is called the fragment fitting, in contrast to the
lattice fitting.

We derive the gradient for the broken particle-number symmetry DMET in
fragment fitting, while for normal state it is similar. There are two
components in the gradient to be evaluated

1.  @xmath , where @xmath is projected mean-field Hamiltonian.

2.  @xmath , the derivative of the projected Hamiltonian with respect to
    @xmath .

For the first component, we have

  -- -------- -- -------
     @xmath      (B.2)
  -- -------- -- -------

where @xmath includes the matrix elements in both the normal and the
pairing channel of the BdG equation.

Now we use @xmath , where @xmath is the solution to the BdG equation
(coefficient matrix). Thus,

  -- -------- -- -------
     @xmath      (B.3)
  -- -------- -- -------

By occ , we mean the eigenvectors with eigenvalues negative eigenvalues.
We use the perturbation theory to evaluate @xmath . First assume no
degeneracy, the first-order perturbation for wavefunction is

  -- -------- --
     @xmath   
  -- -------- --

Translate into matrix language, it becomes

  -- -------- -- -------
     @xmath      (B.4)
  -- -------- -- -------

Now insert to Eq. B.3 , we have

  -- -------- --
     @xmath   
  -- -------- --

where we have perform symmetrization as @xmath to eliminate occ-occ
contributions. Thus we require non-zero HOMO-LUMO gap. We can define

  -- -------- -- -------
     @xmath      (B.5)
  -- -------- -- -------

We now look at the second component. Since (up to a constant)

  -- -- -- -------
           (B.6)
  -- -- -- -------

when @xmath is arranged correctly, the projection to the impurity model
becomes

  -- -------- -- -------
     @xmath      (B.7)
  -- -------- -- -------

Note that @xmath is not a square matrix. We thus define

  -- -------- -- -------
     @xmath      (B.8)
  -- -------- -- -------

Therefore, the gradient of the cost function is

  -- -------- -- -------
     @xmath      (B.9)
  -- -------- -- -------

In practice, tensor @xmath is only computed once, while @xmath is
updated in each optimization step. The procedure to fit the correlation
potential is

1.  Use the independent elements of @xmath as primary variables. Compute
    tensor @xmath .

2.  Compute impurity model BdG matrix @xmath and eigenvectors @xmath ,
    eigenvalues @xmath , as well as generalized density matrix @xmath .

3.  Compute tensor @xmath .

4.  Compute gradient @xmath .

5.  Use conjugate gradient to get optimization direction.

6.  Linear search.

7.  Update @xmath and compute @xmath . If @xmath , the threshold of
    convergence, exit; otherwise return to step 2.

### b.4 Adaptive Chemical Potential Optimization

Because impurity model calculations are the most expensive part of DMET,
we try to minimize the number of such calculations. An effective way to
do so is to minimize the number of cycles in chemical potential
optimization. In each DMET macro-iteration, we allow at most three
impurity model calculations, with the following algorithm

1.  Solve the impurity model with initial @xmath and obtain the number
    of electron @xmath . If @xmath ( @xmath is the target number of
    electrons), complete the optimization; otherwise let @xmath . We
    will describe the algorithm to determine @xmath later.

2.  Solve the impurity model with @xmath and obtain the number of
    electron @xmath . If @xmath ( @xmath is the target number of
    electrons), complete the optimization; otherwise let @xmath . We
    will describe the algorithm to determine @xmath later.

3.  Solve the impurity model with @xmath and obtain the number of
    electron @xmath . Return the results.

In this algorithm, @xmath is determined as a weighted average using
predictions from all previous chemical potential optimization runs,
while @xmath , if necessary, is determined by the linear extrapolation
using results from @xmath and @xmath .

To compute @xmath at DMET iteration @xmath , for a given previous
iteration @xmath , the weight and prediction value is determined as
follows.

-   If the algorithm stops at step 1, @xmath .

-   If the algorithm stops at step 2, we use the two results to compute
    a slope, and use the slope with the current @xmath and @xmath to
    obtain @xmath . The weight is computed as

      -- -------- -- --------
         @xmath      (B.10)
      -- -------- -- --------

    where @xmath is the number of electrons in the @xmath ’th trial of
    iteration @xmath . The weight factor depends on both the similarity
    in the number of electrons and the length of th history.

-   If the algorithm stops at step 3, we we use the three results to fit
    a parabola, and determine the position of the target number of
    electrons and the current number of electrons on the parabola. The
    difference then becomes the change of @xmath , i.e. @xmath . If this
    does not work, we switch to linear regression and use the slope to
    find @xmath . The weight @xmath is similar to Eq. B.10 but we go
    over all 6 ordered pairs of @xmath to find the minimum, and another
    parameter @xmath is used to replace @xmath .

We run this procedure for every previous DMET iterations, and finally
determine @xmath . The parameters @xmath and @xmath are determined
experimentally. For the 2D Hubbard model, a reasonable set of parameters
is @xmath . Using this scheme, it usually takes less than 4 DMET
iterations to make the number of electrons sufficiently close to the
target value; then it stays close to the target number in further
iterations.

### b.5 Davidson Algorithm

The Davidson algorithm [ 95 ] is an efficient way to find the
lowest/highest eigenvectors of a Hermitian matrix. It essentially spans
a subspace in which the matrix is diagonalized, similar to the power
method. It has better numerical stability and faster convergence because
a preconditioner is used to scale the vectors and the vectors are
orthogonalized. Given the Hermitian matrix @xmath , the algorithm is as
follows

1.  Select a guess vector @xmath .

2.  Compute the subspace representation for @xmath on @xmath , @xmath .

3.  Diagonalize @xmath and obtain the lowest subspace eigenvalues and
    eigenvector @xmath . Take the lowest one if we are interested in the
    ground state only. The current best approximation for the lowest
    eigenvector is thus @xmath .

4.  Compute the residual vector @xmath . If @xmath the convergence
    threshold, complete the calculation. Otherwise, compute the rescaled
    correction vector @xmath .

5.  Orthogonalize the correction vector @xmath against @xmath and
    normalize it. Add to the set of basis as @xmath .

6.  Discard the earliest vectors when the subspace becomes too large.

### b.6 BitGen: An Automatic Fermion Algebra and Code Generator

The main features of the fermion algebra tool include

-   Fermion normal ordering;

-   Operator rotation and transformation;

-   Evaluating common expectation values, such as density matrices;

-   Combing like terms;

-   Conscious about special tensor symmetries;

-   Transforming derived formula to Python code, using numpy tensor
    operations;

-   Recognizing intermediate results to prevent recomputing.

The tool is a standalone module in the libDMET package ¹ ¹ 1
https://bitbucket.org/zhengbx/libdmet .
