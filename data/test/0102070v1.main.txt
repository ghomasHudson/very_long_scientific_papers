##### List of Figures

-    1 The double slit experiment a) with particles and b) with waves.
-    2 A down-converter.
-    3 The four global modes of the beam-splitter.
-    4 A schematic representation of type II parametric down-conversion.
    A high-intensity laser pumps a non-linear crystal. With some
    probability a photon in the pump beam will be split into two photons
    with orthogonal polarisation @xmath and @xmath along the surface of
    the two respective cones. Depending on the optical axis of the
    crystal, the two cones are slightly tilted from each other.
    Selecting the spatial modes at the intersection of the two cones
    yields the outgoing state @xmath .
-    5 If an optical circuit with feed-forward detection (a) produces a
    specific state, the same output can be obtained by an optical
    circuit where detection of the auxiliary modes takes place at the
    end (b). The efficiency of the latter, however, will generally be
    smaller.
-    6 The unitary interferometer @xmath with conditional
    photo-detection and single-mode squeezers which should transform
    @xmath into @xmath .
-    7 Circuit for event-ready entanglement conditioned on six detected
    photons. Here, @xmath is given by Eq. ( 184 ), @xmath is the
    Hadamard transform and @xmath is a beam-splitter. The encircled
    numbers denote the number of detected photons needed to create the
    corresponding states.
-    8 A schematic representation of state preparation conditioned on a
    measurement. One branch of the entanglement @xmath is detected,
    yielding an eigenvalue @xmath . The other branch is now in a state
    @xmath .
-    9 An @xmath -port with unit-efficiency, non-resolving detectors.
    The @xmath incoming modes are unitarily transformed into @xmath
    output modes. The @xmath -ports considered here consist of mirrors
    and beam-splitters and do not mix creation operators with
    annihilation operators.
-    10 A @xmath -port with @xmath modes which are detected with ideal
    detectors and @xmath undetected modes. These modes are associated
    with the detector losses.
-    11 The single-photon confidence @xmath [Eq. ( 225 )] as a function
    of the detector efficiency @xmath . The solid line corresponds to a
    single-detector cascade (no cascading: @xmath ), the dashed lines
    correspond to @xmath , @xmath and @xmath in ascending order. We
    consider a maximally entangled input state @xmath to serve as a
    benchmark.
-    12 Schematic representation of the teleportation experiment
    conducted in Innsbruck. A uv -pulse is sent into a non-linear
    crystal, thus creating an entangled photon-pair. The uv -pulse is
    reflected by a mirror and returned into the crystal again. This
    reflected pulse creates the second photon-pair. Photons @xmath and
    @xmath are sent into a beam-splitter and are detected. This is the
    Bell measurement. Photon @xmath is detected to prepare the input
    state and photon @xmath is the teleported output state Bob receives.
    In order to rule out the possibility that there are no photons in
    mode @xmath , Bob detects this mode as well.
-    13 Schematic ‘unfolded’ representation of the teleportation
    experiment with two independent down-converters (Source 1 and Source
    2) and a polarisation rotation @xmath in mode @xmath . The
    state-preparation detector is actually a detector cascade and Bob
    does not detect the mode he receives.
-    14 A model of an inefficient detector. The beam-splitter with
    transmission amplitude @xmath will reflect part of the incoming mode
    @xmath to mode @xmath , which is thrown away. The transmitted part
    @xmath will be sent into a ideal detector. Mode @xmath is vacuum.
-    15 A schematic representation of the entanglement swapping setup.
    Two parametric down-converters ( pdc ) create states which exhibit
    polarisation entanglement. One branch of each source is sent into a
    beam splitter ( bs ), after which the polarisation beam splitters (
    pbs ) select particular polarisation settings. A coincidence in
    detectors @xmath and @xmath ideally identify the @xmath Bell state.
    However, since there is a possibility that one down-converter
    produces two photon-pairs while the other produces nothing, the
    detectors @xmath and @xmath no longer constitute a Bell-detection,
    and the freely propagating physical state is no longer a pure Bell
    state.
-    16 A series of parametric down-converters 1 to @xmath , of which
    the outgoing modes are connected by beam-splitters to form a string.
    The photo-detections are essentially polarisation sensitive
    photo-detectors (an incomplete Bell measurement would require the
    loss of the polarisation information). This can be interpreted as
    repeated entanglement swapping. However, is it also a repeated
    purification protocol?
-    17 Schematic representation of the experimental setup which was
    used to demonstrate the existence of three-photon GHZ-states in a
    post-selected manner. A BBO crystal is pumped to create two photon
    pairs. The subsequent interferometer is arranged such that
    conditioned on a detection event in detector @xmath , the detectors
    @xmath , @xmath and @xmath signal the detection of a GHZ-state.
    Furthermore, the interferometer includes polarisation beam-splitters
    (PBS @xmath and PBS @xmath ), a beam-splitter (BS) and a @xmath
    phase plate which transforms @xmath into @xmath .
-    18  a) Schematic representation of two light beams @xmath and
    @xmath incident on a surface, yielding an interference pattern. b)
    The interference pattern for @xmath .
-    19 Two light beams @xmath and @xmath cross each other at the
    surface of a photosensitive substrate. The angle between them is
    @xmath and they have a relative phase difference @xmath . We
    consider the limit case of @xmath .
-    20 A simple superposition of two states containing 20 photons with
    distributions @xmath and @xmath ( @xmath ). The deposition rate at
    @xmath and @xmath is zero, which means that there is no general
    uniform background exposure using the superposition method.
-    21 The deposition rate on the substrate resulting from a
    superposition of states with @xmath and different @xmath (black
    curve) and resulting from a superposition of states with different
    @xmath and @xmath (grey curve). The coefficients of the
    superposition yielding the black curve are optimised using a genetic
    algorithm [ 137 ] , while the grey curve is a truncated Fourier
    series. Notice the ‘penalty’ (displaced from zero) deposition rate
    of the Fourier series between @xmath and @xmath .
-    22 Four light beams @xmath , @xmath , @xmath and @xmath cross each
    other at the surface of a photosensitive substrate. The angles
    between @xmath and @xmath and @xmath and @xmath are again taken in
    the grazing limit of @xmath . The relative phase difference between
    @xmath and @xmath is @xmath and the relative phase difference
    between @xmath and @xmath is @xmath .
-    23 A simulation of a two-dimensional intensity pattern on an area
    @xmath , where @xmath denotes the wavelength of the used light.
    Here, I modelled a square area with sharp edges. The pattern was
    generated by a Fourier series of up to ten photons (see also figure
    21 for the one-dimensional case).
-    24 The probability simplex corresponding to three possible outcomes
    ‘red’, ‘green’ and ‘blue’. The two dots correspond to normalised
    probability distributions. Their uncertainty regions after @xmath
    trials is depicted by the circle around the dots. The distance
    between the two distributions is the shortest path in the simplex,
    measured in units of the typical statistical fluctuation.
-    25 Flowchart for genetic algorithms. At time @xmath the fitness of
    the members of a population @xmath is evaluated according to some
    criterion. The best fitting member (BF) of @xmath is recorded.
    Subsequently, a new population (the next generation) @xmath is
    formed from @xmath . In addition, crossover and mutations diversify
    the next generation. This generation is again tested for the best
    fitting member, which is recorded as the fittest if it defeats the
    previous fittest.

### Summary

Entanglement is perhaps the single-most important resource of quantum
information theory. The first part of this thesis deals with the
creation of optical event-ready entanglement with a specific class of
optical circuits. These circuits include passive components such as
beam-splitters and phase-shifters, and active components such as optical
parametric down-converters and optical squeezers. Furthermore, the
entangled-state preparation may be conditioned on one or more detector
outcomes. In this context, I discuss the statistics of down-converters
and give a quantitative comparison between realistic detectors and
detector cascades, using the confidence of the detection. The outgoing
states of the optical circuits can be expressed in terms of
multi-dimensional Hermite polynomials. Event-ready entanglement cannot
be created when the outgoing state is conditioned on two detected
photons. For six detected photons using ideal photo-detectors a scheme
is known to exist.

Part two of this thesis includes two applications of optical
entanglement. First, I discuss quantum teleportation and entanglement
swapping using down-conversion. It is shown that higher-order
photon-pair production degrades the fidelity of the teleported (or
swapped) states. The interpretation of these states proved
controversial, and I have attempted to settle this controversy. As a
second application, quantum lithography uses optical (‘which-way’)
entanglement of multiple photons to beat the classical diffraction
limit. Given a suitable photo-resist, this technique results in
sub-wavelength optical resolution and can be used to write features much
smaller than is possible with classical lithography. I present classes
of states which can be used to create patterns in one and two dimensions
with sub-wavelength resolution.

### Acknowledgements

I could not have written this thesis without the help of many people. I
would like to express my gratitude towards Samuel L. Braunstein for his
excellent supervision, and my colleagues Peter van Loock and Arun Pati
for the many discussions we’ve had over the years. Special thanks to
prof. Rajiah Simon, who helped me understand the maths of operators and
maps, Jonathan Dowling for inviting us to work on quantum lithography
and for offering me a job, and Apy Vourdas for the fruitful discussions
on multi-dimensional Hermite polynomials. I also thank all the others
whom I have had the pleasure to meet and who have generally made me
wiser.

During the past three years I have often found consolation and playful
adversity from my friends in the Netherlands, especially from Jasper for
his long-distance moral and immoral support, and Alex, Gijs and Maarten.
The RISK-club rules! Many thanks also to Angèle (mooi, die middeleeuwse
kastelen van voor de Renaissance), Jeroen (Slaatje kameraadje), Joep
(d’r zit ’n haar in m’n glas) and Klaas-Jan (“mobile construction yard
deployed”).

I have had an unforgettable time in Bangor, the responsibility of which
can be traced almost entirely to my friends here. Many thanks to Barbara
(my own drama-queen), Mireia (fly, my pretty), Consuelo (è chica!), Ana
(when will we dance again?), Claudia (Mel G. meets tequila), Carlotta
(close that cupboard), Martin ( you are the best man), Marc (I’ll see
you in Cambridge), Ross (our man in Havana) and Johnny (watch out for
that bottle!): pray I don’t publish my memoirs…

Finally, I thank my parents and my brother Joost (architectuur = kunst).

Pieter Kok, @xmath

December 2000. @xmath

x

### Chapter \thechapter Introduction

The closing decade of the twentieth century has witnessed the
coming-of-age of a new field, called quantum information theory . This
field includes the development of quantum computation and quantum
communication. At this point a fully scalable quantum computer has not
been built, but there are numerous experimental and theoretical
proposals to achieve this [ 36 ] . At the same time, the quest for
quantum algorithms continues. So far, we have Shor’s algorithm to factor
large numbers into primes [ 156 ] , the Deutsch-Jozsa algorithm [ 47 ,
48 ] and Grovers search algorithm [ 74 ] . The possibility of quantum
error correction was discovered [ 159 ] , which is very important to any
practical application of quantum computation.

Considerable progress has also been made in quantum communication. It is
a generic term for communication protocols based on quantum mechanical
principles and includes cryptography [ 12 , 57 ] , teleportation [ 14 ]
, entanglement swapping [ 183 ] , dense coding [ 13 ] , quantum clock
synchronisation [ 92 ] , entanglement purification [ 15 ] and quantum
networks [ 75 , 58 ] . Another recent application of quantum mechanics
is quantum lithography [ 22 ] . The common divisor of nearly all
elements of quantum information is quantum entanglement [ 34 ] . In this
thesis I study the creation of entanglement in quantum optics, and some
of its applications.

This introduction will provide the motivation and physical background
for the thesis. I discuss entanglement, teleportation and lithography.
It will be largely non-mathematical and aimed at an audience of
non-specialists. The subsequent chapters will then develop these issues
in a rigorous mathematical way.

#### 1 Quantum entanglement

In order to explain what quantum entanglement is about, I will first
discuss the double slit experiment as presented by Richard Feynman [ 61
] . Suppose we have a gun firing bullets at a screen with two holes
which are close to each other. Most of the bullets will hit the screen
and fall on the floor, but some of them will pass through the holes and
hit a wall of clay. In effect, this wall records the position of impact
of the bullets which passed through the holes.

When we inspect the wall, we will see that the bullets are spread around
the centre of the clay wall in a straight line behind the gun and the
holes in the screen. Each bullet must have passed through either hole to
make it to the wall. When we record the process with a high-speed camera
we can see the bullets going through the holes. In fact, we can mount
paint sprayers next to the holes, colouring the bullets which pass
through the left hole red, and the bullets which pass through the right
hole blue. The clay wall will be peppered with red and blue bullets,
with the red bullets shifted slightly to the left and the blue bullets
slightly to the right (see figure 1 a).

Let us now repeat this experiment with waves instead of bullets. Suppose
we have a shallow tray of water with a screen containing two narrow
openings close to each other at the waterline. On one side of the screen
a pin is moving up and down in the water, creating a wave which spreads
out in all directions. When the wave reaches the screen, the two slits
start to act as if they were vertically moving pins themselves ! The
slits thus create two waves which spread out in all directions behind
the screen.

These two waves will soon start to interfere: when a wave-crest meets
another crest, the result will be a crest twice as high; when a trough
meets another trough, the result will be a trough twice as deep. And
finally, when a crest meets a trough they cancel each other. When we
record the vertical displacement of the water at the far end of the tray
of water, we will find an interference pattern ¹ ¹ 1 More precisely, the
interference pattern is given by the square of the displacement: the
intensity . of peaks and troughs (see figure 1 b).

The difference with bullets is obvious: the bullets arrive in a spread
area with its bullet density falling off uniformly with the distance
from the centre, whereas waves will show an intensity pattern which
rises and falls in alternation with increasing distance from the centre.
The simple (classical) picture is: waves give interference and particles
(bullets) don’t.

Now let’s take a look at light. Suppose we have again a screen with two
slits, and a laser which is aimed at the slits. The light which passes
through the slits is recorded on a photographic plate. After
development, we will see an interference pattern on the photographic
plate: light seems to be a wave.

When we weaken the intensity of the laser enough, we will see (using
very sensitive equipment) that the light is no longer a continuous
stream, but that instead, it is a succession of small ‘bursts’. We call
these bursts photons , and they are described by quantum theory. It thus
seems that light consists of particles which interact to give an
interference pattern just like waves.

We now attenuate the laser so that we fire individual photons at the
double slit. This way, the photons cannot interact to give an
interference pattern since at any time there is only one photon
travelling between the laser and the photographic plate. The photons
which make it past the double slit will give a dot on the photographic
plate, analogous to the bullets in the clay wall. If the photons are
truly classical particles, they should pass through either slit, just
like the bullets, and they should not make an interference pattern.

However, when we develop the photographic plate after a long exposure
time we do find an interference pattern! We have set up this experiment
in such a way that the photons, which seem to behave like particles
(indivisible, giving dots on a screen), are passing the slits one at a
time so they don’t interact with each other. The only way to get an
interference pattern is thus when the photon somehow interferes with
itself . Has the photon gone through both slits simultaneously? Let’s
test this.

Again, we fire individual photons at a double slit and record the
pattern on a photographic plate. But this time we place a detector
behind both slits. These detectors tell us through which slit the photon
passes. While running this experiment, the detectors are clicking when a
photon passes through its corresponding slit, giving us information
about the paths of the successive photons. They really go through one
slit at a time.

But when we now develop the photographic plate, the interference pattern
has gone! Instead, we have a concentration of dots, its density
decreasing with increasing distance from the centre. This is the bullet
pattern. Apparently, when we know through which slit the photons pass,
we do not get an interference pattern. When we do not look, it is
meaningless to ask through which slit the photons pass. In describing
the path of the photons without detection, we need to include both
possibilities: the path is a superposition of going through the left and
the right slit.

Feynman elevated this to a general principle: when an event can occur in
several different ways, we need to describe the event in terms of a
superposition of these ways [ 61 ] . The superposition principle is
responsible for many of the counterintuitive aspects of quantum
mechanics. This simple thought-experiment thus takes us straight into
the heart of the theory.

Let’s now consider entanglement. Photons have an extra internal property
called polarisation . A photon which reflects off this paper towards
your eye (which can be represented graphically as @xmath ) vibrates in
the plane of the paper perpendicular to the direction of travelling (
@xmath or @xmath , or a combination of these two. Technically, we also
have circular polarisation). The polarisation of the photon is
determined by the angle of this vibration direction.

When we want to measure the polarisation of a photon, we place a
polarising beam-splitter, or polariser in the path of the photon. This
is essentially a piece of glass which reflects horizontally polarised
photons and transmits vertically polarised photons. When we place
photo-detectors in the paths of reflected and transmitted photons, a
detector click will tell us the polarisation of that photon. When a
horizontally (vertically) polarised photon encounters the polariser, it
will always be reflected (transmitted). But what if the photon has a
diagonal polarisation?

When a diagonally polarised photon encounters the polariser it will be
either reflected or transmitted. We can only make a probabilistic
prediction as to which path the photon will take. When we rotate the
polariser so that its horizontal orientation is turned parallel to the
(diagonal) polarisation of the photon, the photon will be reflected with
certainty . We now consider two polarised photons.

Suppose we have two photons originating from a common source and heading
off in opposite directions. One photon is received by Alice, and the
other by Bob. Furthermore, Alice and Bob are far away from each other,
possibly in different galaxies.

First, we consider the case where both photons are horizontally
polarised ( @xmath ). When Alice and Bob measure the polarisation of the
photon in the horizontal and vertical direction using polarisers, both
will find with certainty that the photons have horizontal polarisation.
When Alice rotates her polariser by 45 degrees, the probability that
either detector signals the detection of a photon is one half. This
situation is similar to the measurement of a single photon since the
photons received by Alice and Bob behave completely independent from
each other.

Now suppose that the two photons are prepared in the following way:
either Alice’s photon is horizontally polarised and Bob’s photon is
vertically polarised, or Alice’s photon is vertically polarised and
Bob’s photon is horizontally polarised. Furthermore, the photons are
prepared in a superposition of these two possibilities. When Alice and
Bob measure the polarisation of these photons they will find that their
photons always have opposite polarisations: when Alice detects a
horizontally polarised photon, Bob will find a vertically polarised
photon and vice versa. This means that given a measurement outcome, Bob
knows what Alice’s measurement outcome will be, even though she might be
light years away. The measurement results are said to be correlated.

So far, nothing strange has happened. We know these correlations from
classical physics. Suppose Alice and Bob meet in Amsterdam. They blindly
draw a marble from a vase containing only one black and one white
marble. Alice travels to New York and Bob travels to Tokyo. When Alice
looks at her marble and finds that it is white, she immediately knows
that Bob’s marble is black. These outcomes are also correlated.

There is, however, a difference in the case of polarised photons.
Suppose Alice and Bob both rotate their polariser over 45 degrees.
According to the classical picture, both photons have a 50:50 chance to
end up in either detector. That means that with 50% probability the
photons have equal polarisation. But this is not what they find: Alice
and Bob always find that they have opposite polarisations! Clearly, this
is not just a classical correlation. The two photons are said to be
entangled .

The question is now: how can we make entangled photons? One way of doing
it is to use a so-called down-converter. In a down-converter, a
high-powered laser is sent into a special crystal. A photon of the laser
interacts with the crystal and breaks up into two photons with half the
energy. The photons will travel away from the central axis (defined by
the path of the laser light) under a fixed angle. The photons thus
travel on the surface of a cone originating from the crystal (see figure
2 ).

Furthermore, we can set up the down-converter in such a way that the
photons have opposite polarisations. This is where the crystal performs
its special trick: the refraction index of the crystal is different for
horizontally and vertically polarised photons. This means that the cone
corresponding to the possible paths of horizontally polarised photons is
tilted upwards from the central axis. Similarly, the cone for vertically
polarised photons is tilted slightly downwards.

Due to momentum conservation, the two photons are always travel on
different cones along lines opposite of each other with respect to the
central axis. The cones intersect each other at two opposite lines, and
as a consequence, we find a photon in one of those lines if and only if
there is a photon in the other line. Furthermore, we cannot tell to
which cone the photons on the intersecting lines belong. Either the left
photon belongs to the upper cone and the right photon to the lower, or
the other way around. By virtue of Feynman’s principle we have to take
the superposition of these two possibilities.

The down-converter only produces two entangled photons
probabilistically; not every laser pulse results in two down-converted
photons. Furthermore, since we select only the intersection of the two
cones, we lose all the instances where photons were not produced along
the intersecting lines. This means that most of the time we fire the
laser into the crystal we do not produce entanglement. In this thesis I
study whether and how we can minimise the number of cases where no
photons are produced.

#### 2 Teleportation

Another subject of this thesis is quantum teleportation, in particular
the teleportation of a photon. In this procedure, the (unknown)
polarisation of one photon is transferred to another photon far away. It
is not true that the photon itself is magically transported from Alice
to Bob, only the polarisation direction (or, more generally, the state
of the photon) is transferred.

The same is true for other types of matter: we can teleport atoms, but
that does not mean we can make an atom appear somewhere in the distance.
I will now present the general protocol, using polarised photons.

Suppose Alice received a photon with a polarisation direction which is
unknown to her. We assume that she has some way of storing it without
disturbance. In other words, she has a device called a ‘quantum memory’.
Now she wants to transfer the polarisation direction of the photon to
Bob. When she has only measurements and a telephone at her disposal to
tell Bob the results, she has a problem. Since she doesn’t know what the
polarisation direction is, she cannot choose her polariser to be
parallel to this direction. Therefore, when she measures the
polarisation of the photon in a chosen direction and tells Bob the
result, his reconstruction of the polarisation direction will generally
be off by a certain angle. Faithful teleportation cannot be performed
this way.

However, the story changes when Alice and Bob share entanglement
(produced, for example, by the down-converter of the previous section).
Alice and Bob both hold one part of an entangled photon pair. Remember
that these photons are correlated: whatever the polarisation direction
measured by Alice, Bob will always find the opposite polarisation. Alice
proceeds by making a joint measurement of her part of the entanglement
and the the incoming photon with unknown polarisation. Such a
measurement does not give any information about the individual photons,
but determines the relation of the photons relative to each other. It is
a carefully chosen measurement which will correlate the incoming photon
with unknown polarisation to Alice’s part of the entangled photon-pair.
In the case of polarisation we consider here, the outcome of Alice’s
measurement has four possible outcomes. These outcomes correspond to
four different ways the two photons can be correlated (technically, we
have four orthogonal ways).

Let’s pause for a second to contemplate the current state of affairs.
Alice has just correlated the unknown incoming photon with her half of
the entangled photon-pair. She cannot choose or predict how she
correlates them, every one of the four possibilities is equally likely.
But her half of the entangled photon-pair is already correlated with the
other half. It then follows that the unknown incoming photon is now
correlated with Bob’s half of the entangled pair.

The only thing Bob does not know is the exact nature of the correlation.
Every one of the four possible correlations will give a different
polarisation direction in Bob’s photon. That is why Alice has to tell
him. She picks up the phone and gives one of four possibilities (i.e.,
she sends two classical bits) corresponding to her measurement outcome.
The beautiful thing about teleportation is now that Bob has to perform a
polarisation rotation corresponding to the measurement outcome, which is
independent of the unknown polarisation direction of the incoming
photon! His photon now has the same polarisation direction as the
incoming photon and teleportation is complete.

We have to note three things. First of all, neither Alice, nor Bob gains
any information about the direction of the polarisation of the incoming
photon. Secondly, no photon magically appears at Bob’s site; he already
held a photon during the whole procedure. In this respect, quantum
teleportation is quite unlike the Star Trek version. And finally,
teleportation cannot be used for superluminal signalling. If Alice does
not tell Bob her measurement outcome (which is a classical message and
thus restricted by the speed of light), teleportation will fail since
Bob does not know what polarisation rotation he has to perform.

The entanglement shared by Alice and Bob is typically produced with a
down-converter. In this thesis I study the effects of the
down-conversion characteristics on the quality of teleportation.

#### 3 Lithography

The second application of optical quantum entanglement I study in this
thesis is quantum lithography. This technique may be used to write
components on micro-chips which are smaller than possible with classical
optical lithography. It works as follows.

Consider again the double slit experiment with photons, given in section
1 . When photons are fired at the slits one at a time without looking
through which slit they pass, we obtain an interference pattern on the
photographic plate. In this case the photon can travel along two
possible paths: either through the left slit or through the right.

Suppose we now fire two photons per shot at the slits. If we assume that
all photons pass the slits we now have three possible paths: both
photons may pass through the left slit; one may pass through the left
and the other though the right; or both may pass through the right slit.
In this case the interference pattern will be twice as bright, because
we use twice as much light.

But now we can ask what happens if we suppress one of these three
possible paths. What will the interference pattern look like when the
photons do not separate , that is, what happens when the photons either
both pass through the left slit, or both through the right slit? The
answer is that the interference pattern, which is an array of bright and
dark lines, will become twice as narrow: the distance between two bright
lines is halved. The reason why this happens is because the photons
‘stick together’, thus effectively acting as a single particle with
twice the momentum. The De Broglie wavelength (which determines the line
spacing of the interference pattern) is inversely proportional to the
momentum of the particle. The higher the momentum, the shorter this
wavelength and the narrower the interference pattern. Since photons also
have momentum, this means that the more photons we can make acting as a
single particle, the smaller the interference pattern. Note that in
general, we need a special surface which is sensitive to two photons (a
‘two-photon resist’) to record these patterns.

Classically, light cannot resolve features which are much smaller than
its wavelength. As a consequence, classical optical lithography, in
which light is used to etch a surface, cannot write features much
smaller that its wavelength. This is Rayleigh’s diffraction limit. It is
derived from the interference between two waves. We have seen that we
can narrow this interference pattern using the quantum properties of
light, which means that the Rayleigh limit is a classical limit. Quantum
lithography can therefore be used to create sub-wavelength patterns, to
be used in, for example, the micro-chip industry.

So far, quantum lithography is still a theoretical method. Only the
two-photon case described above has been experimentally tested. It is
not easy to see how more exotic patterns may be produced, and what the
requirements for the surface are. Nevertheless, it gives us a new
insight in the nature of light. In this thesis I study how we can create
arbitrary sub-wavelength patterns in one and two dimensions.

#### 4 Thesis outline

This thesis is organised in two parts. The first part, called ‘Quantum
State Preparation’ is divided in four chapters. Chapter \thechapter
gives the general quantum mechanical background. It includes the
postulates of quantum mechanics, the quantisation of the
electro-magnetic field and some topics from quantum information theory
such as the Von Neumann entropy and the fidelity.

In chapter \thechapter , I study a limited set of optical circuits for
creating near maximal polarisation entanglement without the usual large
vacuum contribution. The optical circuits I consider involve passive
interferometers, feed-forward detection, down-converters and squeezers.
For input vacuum fields the creation of maximal entanglement using such
circuits is impossible when conditioned on two detected auxiliary
photons. Furthermore, I derive the statistical properties of
down-converters and show that coincidences between photon-pairs from
parametric down-conversion automatically probe the non-Poissonian
structure of these sources.

So far, the photo-detectors I considered are ideal. In chapter
\thechapter I study the use of detection devices in entanglement-based
state preparation. In particular I consider realistic optical detection
devices such as single-photon sensitivity detectors, single-photon
resolution detectors and detector cascades (with a limited efficiency).
I develop an extensive theory for the use of these devices. In
entanglement-based state preparation we perform measurements on
subsystems, and we therefore need precise bounds on the
distinguishability of these measurements. To this end, I introduce the
confidence of preparation, which may also be used to quantify the
performance of detection devices in entanglement-based preparation. I
give a general expression for detector cascades of arbitrary size for
the detection up to two photons. I show that, contrary to the general
belief, cascading does not give a practical advantage over detectors
with single-photon resolution in entanglement-based state preparation.

Finally, in chapter \thechapter , I study a special class of optical
circuits and show that the outgoing state leaving the optical circuit
can be expressed in terms of so-called multi-dimensional Hermite
polynomials and give their recursion and orthogonality relations. I show
how quantum teleportation of photon polarisation can be modelled using
this description.

The second part is called ‘Some Applications’ and covers two chapters.
In chapter \thechapter , I study the experimental realisation of quantum
teleportation as performed by Bouwmeester et al . [ 23 ] and the
adjustments to it suggested by Braunstein and Kimble [ 32 ] . These
suggestions include the employment of a detector cascade and a relative
slow-down of one of the two down-converters. Furthermore, I discuss
entanglement swapping and the creation of GHZ states within this
context.

Chapter \thechapter gives the theory of quantum lithography. I
generalise the lithography procedure in order to create patterns in one
and two dimensions. This renders quantum lithography a potentially
useful tool in nano-technology.

## Quantum State Preparation

### Chapter \thechapter Quantum Theory

This chapter presents the mathematical background theory for the
understanding of this thesis. It does not contain new results. First, I
present quantum mechanics in the Hilbert space formalism. The second
section discusses the quantisation of the electro-magnetic field and
quantum optics, and in the last section I treat some aspects of quantum
information theory, such as entropy, fidelity and non-locality.

#### 5 Quantum mechanics in a nutshell

What is quantum mechanics all about? Initially, the theory was developed
to describe the physical world of atoms, that is, to explain the
observed spectral lines in spectrometers. In 1913, Niels Bohr, then at
the Cavendish laboratory in Cambridge, developed what is now called the
‘old quantum theory’, in which he presented a model explaining the
spectral lines of hydrogen [ 18 , 82 ] . As the theory was developed
further (culminating in the work of Schrödinger and subsequently
Heisenberg) it became clear that quantum mechanics is a mathematical
theory which describes measurement outcomes , rather than the underlying
physical processes [ 131 ] .

Von Neumann proved the equivalence of Schrödingers wave mechanics and
Heisenberg’s matrix mechanics in Mathematical foundations of quantum
mechanics [ 122 ] and introduced the Hilbert space formalism still in
use today. Dirac [ 51 ] developed his own version of the theory (of
which, incidentally, Von Neumann did not approve ² ² 2 The preface of
his book makes very enjoyable reading. ), and his bracket notation has
become the standard. In accordance with the convention, I will follow
Von Neumann’s framework and use Dirac’s bracket notation.

This section is organised as follows: first I will give the postulates
for quantum mechanics. Then I discuss mixed states and composite
systems. Finally, this section ends with measurement theory according to
Von Neumann and its generalisation to projection operator valued
measures (POVM’s).

##### 5.1 The postulates of quantum mechanics

Using some properties of complex vector spaces (see appendix \thechapter
), we can formulate the postulates of quantum mechanics [ 28 , 45 , 85 ]
. More properties of operators on Hilbert spaces can be found in
appendix \thechapter .

  Postulate 1  

    For every physical system there is a corresponding Hilbert space .
    The accessible (pure) states of the system are completely determined
    by rays with unit length in .

A ray in Hilbert space is a set of unit vectors which differ only by an
arbitrary (complex) phase. A physical state corresponds to a ray. Thus,
a state @xmath is physically equivalent to @xmath with @xmath . A
complete set of orthonormal states (rays) form a basis of . I will use
the terms ‘ray’, ‘vector’ and ‘state’ interchangeably, while remembering
that an overall phase does not change the physical state. Later, in
section 5.3 , this class of states is extended to mixed states.

Since the Hilbert space is a (complex) vector space, if any two
normalised rays @xmath and @xmath in are accessible states to the
system, then their superposition @xmath is also an accessible state to
the system. Normalisation then requires @xmath . A superposition of this
type is sometimes called a coherent superposition. Note that in this
case the phase of a ray does have a physical meaning. Consider two
orthonormal states @xmath and @xmath (i.e., @xmath and @xmath ), and
consider the two superpositions

  -- -------- -------- -------- -- -----
     @xmath   @xmath   @xmath      (1)
     @xmath   @xmath   @xmath      (2)
  -- -------- -------- -------- -- -----

then it is easy to verify that @xmath , i.e., they are orthogonal (in
fact, they are orthonormal). The two superpositions differ only in a
relative phase, but they yield two physically distinct (orthonormal)
states.

  Postulate 2  

    For every physical observable of the system there is a unique
    corresponding self-adjoint (Hermitian) operator @xmath in .

An operator @xmath is called self-adjoint if and only if @xmath . An
operator is Hermitian if and only if its eigenvalues are real. I will
now prove that (for finite-dimensional Hilbert spaces) any operator is
self-adjoint if and only if it is Hermitian.

To show that self-adjointness implies Hermiticity, observe that
according to the eigenvalue equation @xmath in Eq. ( 419 ) we have

  -- -------- -- -----
     @xmath      (3)
  -- -------- -- -----

Substituting @xmath immediately yields @xmath , i.e., a real eigenvalue.
The second implication is proved by running the argument backwards. In
this thesis I will use the terms Hermitian and self-adjoint
interchangeably. Also, I will use the convention that Greek letters (
@xmath …) denote complex numbers and Roman letters ( @xmath …) denote
real numbers. The fact that self-adjoint operators have real eigenvalues
lead to the next postulate.

  Postulate 3  

    The only possible measurement outcomes obtainable from the
    measurement of an observable are the eigenvalues of its
    corresponding self-adjoint operator @xmath . If the state of the
    system is @xmath , then the probability @xmath of finding the @xmath
    -fold degenerate eigenvalue @xmath of the observable @xmath is equal
    to the probability of finding the system in the corresponding
    eigenspace:

      -- -------- -- -----
         @xmath      (4)
      -- -------- -- -----

    where @xmath are the eigenvectors corresponding to the @xmath -fold
    degenerate eigenvalue @xmath .

The outcome of a measurement in the laboratory can only yield a real
number, and since the measurement outcomes are the eigenvalues of
operators, these operators must be Hermitian. Postulate 2 ensures that
there is a one-to-one correspondence between self-adjoint operators and
physical observables, and postulate 3 determines the possible
measurement outcomes for these observables. Eq. ( 4 ) is the so-called
Born rule [ 85 ] .

  Postulate 4  

    The evolution of a system is governed by a unitary transformation
    @xmath :

      -- -------- -- -----
         @xmath      (5)
      -- -------- -- -----

    where @xmath and @xmath are (vectors of) real parameters.

Any operator @xmath on a Hilbert space for which @xmath is called a
unitary operator on . In general, every unitary operator can be written
as

  -- -------- -- -----
     @xmath      (6)
  -- -------- -- -----

with @xmath a self-adjoint operator on . To prove this statement, note
that @xmath . Thus @xmath , and @xmath . Unitary operators in matrix
representation always have determinant 1, and they can be viewed as
rotations in a complex vector space.

A special choice for @xmath in Eq. ( 5 ) is the infinitesimal time
evolution where @xmath and @xmath :

  -- -------- -- -----
     @xmath      (7)
  -- -------- -- -----

and @xmath the Hamiltonian of the system. It is the observable
associated with the total energy of the system. Substituting this
evolution into Eq. ( 5 ) and neglecting higher-order powers of @xmath ,
we obtain in the Taylor expansion

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (8)
     @xmath   @xmath   @xmath      (9)
     @xmath   @xmath   @xmath      (10)
  -- -------- -------- -------- -- ------

This is the famous Schrödinger equation.

In this thesis I will not use the Schrödinger equation. Instead, I will
use the fact that the self-adjoint operator @xmath in Eq. ( 6 ) acts as
a generator of the group of unitary evolutions parametrised by @xmath .
This approach will have great benefits in chapter \thechapter . The
theory of (Lie) groups and their generators is treated in appendix
\thechapter .

Unitary transformations not only govern the evolution of quantum states,
they also constitute basis transformations. If @xmath and @xmath are a
linear operator and a unitary transformation on respectively, then there
exist another linear operator @xmath on such that

  -- -------- -- ------
     @xmath      (11)
  -- -------- -- ------

In particular, if @xmath is self-adjoint there always exist a unitary
transformation such that @xmath is diagonal.

  Postulate 5  

    When a measurement of an observable @xmath yields the
    (non-degenerate) eigenvalue @xmath , the state of the system
    immediately after the measurement will be the eigenstate @xmath
    corresponding to @xmath .

This is the so-called projection postulate. It is often referred to as
state collapse, since a measurement can induce a discontinuous jump from
a superposition to an eigenstate of the measured observable. This
postulate has caused severe problems for interpretations of quantum
mechanics which assign some form of ‘reality’ to the state. Such
interpretations suffer from what has become generically known as the
‘measurement problem’ [ 141 , 85 ] . In this thesis I will ignore this
problem, since it does not seem to have any effect on the experimental
success of quantum mechanics ³ ³ 3 The reader should note that, although
I will not discuss the measurement problem, this does not imply that
there is no measurement problem. This is still very much open to debate
[ 66 ] . . The general theory of measurements is discussed in section
5.4 .

So far, I have presented quantum mechanics in the so-called Schrödinger
picture . In this picture the time dependence is captured in the state :
@xmath . Alternatively, we can choose the states to be time independent,
and have all the time dependence in the operators . This is called the
Heisenberg picture :

  -- -------- -- ------
     @xmath      (12)
  -- -------- -- ------

where @xmath denotes the operator in the Heisenberg picture and @xmath
the operator in the Schrödinger picture. When part of the time
dependence is in the states and part is in the operators, we speak of
the interaction picture .

Another alternative formulation of quantum mechanics is Feynman’s path
integral formalism . This is particularly useful in the formulation of
quantum field theories, but I will not discuss it here.

##### 5.2 The linear harmonic oscillator

One application of quantum mechanics which deserves attention in the
context of this thesis is the description of the linear harmonic
oscillator. I will treat this in a telegraphic manner, since this is a
well known example. For a full derivation see, for example, Merzbacher [
119 ] .

We start by defining a quadratic potential @xmath for a classical
particle with mass @xmath , position @xmath and momentum @xmath :

  -- -------- -- ------
     @xmath      (13)
  -- -------- -- ------

where @xmath is, loosely speaking, the classical frequency of the
oscillator. The classical Hamiltonian is then given by the sum of the
kinetic and potential energy:

  -- -------- -- ------
     @xmath      (14)
  -- -------- -- ------

In quantum mechanics the observables @xmath and @xmath have to be
replaced by self-adjoint operators. This procedure is called
‘quantisation’ ⁴ ⁴ 4 Or first quantisation. Indeed, there is something
called ‘second’ quantisation, in which the fields are written in the
operators formalism. We will encounter this in section 2, where I
introduce quantum optics and the quantisation of the electro-magnetic
field. . The quantum mechanical Hamiltonian thus becomes

  -- -------- -- ------
     @xmath      (15)
  -- -------- -- ------

where @xmath and @xmath with @xmath . When the quantum mechanical state
of the harmonic oscillator is denoted by @xmath , with @xmath the
position eigenvector corresponding to the position @xmath , then we
obtain the differential (Schrödinger) equation (see postulate 4):

  -- -------- -- ------
     @xmath      (16)
  -- -------- -- ------

This equation is satisfied by the following class of wave-functions:

  -- -------- -- ------
     @xmath      (17)
  -- -------- -- ------

corresponding to energies

  -- -------- -- ------
     @xmath      (18)
  -- -------- -- ------

The @xmath are the so-called Hermite polynomials (see appendix
\thechapter ).

The Hamiltonian of the harmonic oscillator can also be expressed in
terms of so-called raising and lowering operators @xmath and @xmath
respectively:

  -- -------- -- ------
     @xmath      (19)
  -- -------- -- ------

(remember that @xmath and @xmath since position and momentum are
physical observables). It is easily found that @xmath . The eigenstate
corresponding to the energy @xmath of the linear harmonic oscillator is
now symbolically denoted by @xmath , and we have

  -- -------- -- ------
     @xmath      (20)
  -- -------- -- ------

The operator @xmath in the last equation is also called the number
operator @xmath . The Hamiltonian of the linear harmonic oscillator in
terms of the raising and lowering operators is then given by

  -- -------- -- ------
     @xmath      (21)
  -- -------- -- ------

The raising and lowering operators will return in section 6 as creation
and annihilation operators.

##### 5.3 Composite and mixed states

After this brief, but necessary digression I now return to the
definition of states of composite systems. Postulate 1 tells us that
with every physical system corresponds a Hilbert space. Two systems, 1
and 2, therefore have two Hilbert spaces @xmath and @xmath . However,
the composite system @xmath is also a physical system. The question is
thus which Hilbert space corresponds to system @xmath .

Let @xmath be an orthonormal basis for @xmath and let @xmath be an
orthonormal basis for @xmath . When the two systems are independent of
each other, every basis vector in @xmath can be paired with every basis
vector in @xmath and still give a mathematically legitimate description
of the composite system. Therefore, one possible orthonormal basis for
the Hilbert space of the composite system is given by the set of ordered
pairs @xmath . This is a basis of the tensor product , or direct product
of the two Hilbert spaces of the subsystems:

  -- -- -- ------
           (22)
  -- -- -- ------

An orthonormal basis is given by @xmath .

From postulate 1 and the fact that a Hilbert space is a complex vector
space we immediately see that any tensor product of two superpositions
is again a superposition of tensor product states (see appendix
\thechapter ):

  -- -------- -- ------
     @xmath      (23)
  -- -------- -- ------

i.e., the tensor product is linear. Note that the right-hand side can in
general not be written as a state @xmath . This exemplifies the fact
that two systems need not be independent of each other. This property,
called entanglement is crucial to quantum information theory. It will be
discussed in detail later on in chapter \thechapter .

The total state of two systems can always be written in a special form,
called the Schmidt decomposition . The most general composite state is
given by Eq. ( 23 ), which involves a double sum over the indices @xmath
and @xmath . In the Schmidt decomposition the state is written as a
single sum [ 122 ] :

  -- -------- -- ------
     @xmath      (24)
  -- -------- -- ------

where @xmath can be chosen real and @xmath and @xmath are two
orthonormal bases for the two subsystems. The bases of the subsystems in
eqs. ( 23 ) and ( 24 ) are transformed into each other by a unitary
transformation:

  -- -------- -- ------
     @xmath      (25)
  -- -------- -- ------

The Schmidt decomposition is unique (up to phase factors) if and only if
the @xmath are non-degenerate. If the dimensions of the Hilbert spaces
of the two subsystems are @xmath and @xmath respectively, the sum in
Eq. ( 24 ) the index @xmath runs up to the dimension of the smallest
Hilbert space [ 122 , 131 ] . A Schmidt decomposition of the state of
three or more subsystems exists only in special circumstances [ 132 ] .

When a state is in a superposition @xmath with @xmath , the operator
@xmath is a so-called projection operator (see appendix \thechapter ):

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (26)
              @xmath   @xmath      (27)
              @xmath   @xmath      (28)
  -- -------- -------- -------- -- ------

We can now extend our notion of states for a system. In particular,
suppose that we have a classical probability distribution over a set of
states. We write this as

  -- -------- -- ------
     @xmath      (29)
  -- -------- -- ------

where @xmath is the probability to find the system in state @xmath .
This is sometimes called an incoherent superposition. Since the @xmath
are probabilities, we have @xmath . The operator @xmath is called the
density operator of the system. It is also referred to as a mixed state.
It has the following properties:

1.  @xmath ;

2.  @xmath for all @xmath ;

3.  @xmath .

In a complex Hilbert space, properties 1 and 2 are equivalent.

##### 5.4 Measurements

I will now consider the effect of a measurement on the state of a
system. According to the projection postulate, immediately after the
measurement of an observable @xmath , the state of the system is in the
eigenstate @xmath corresponding to the eigenvalue @xmath found in the
measurement outcome. With the knowledge of projection operators given in
appendix \thechapter we can now model this as follows.

Suppose that the system under consideration is in a mixed state @xmath .
Let the eigenvalues of @xmath be given by @xmath . Then the probability
@xmath that we obtain outcome @xmath in a measurement of @xmath is given
by

  -- -------- -- ------
     @xmath      (30)
  -- -------- -- ------

The right-hand side can be shown to equal the centre term by using the
cyclic property of the trace. This type of measurement is called a Von
Neumann measurement or ideal measurement [ 85 , 119 , 122 ] . The
underlying assumption in this model is that the measurement outcome
faithfully identifies the state of the system immediately after the
measuring process.

In practice, this is of course not always the case. Instead, due to the
imperfections of the measurement apparatus there might be a whole family
of projectors @xmath which, with some probability @xmath , give rise to
the measurement outcome @xmath . Rather than a projection operator
@xmath in Eq. ( 30 ) we include a projection operator valued measure ,
or POVM:

  -- -------- -- ------
     @xmath      (31)
  -- -------- -- ------

with @xmath . When @xmath is an orthonormal basis, this implies @xmath .
In chapters \thechapter and \thechapter , I will use these POVM’s to
model non-ideal measurements in the context of quantum optics. A more
formal presentation of POVM’s is given in appendix \thechapter .

#### 6 Quantum optics

In this section I present quantum optics; the quantum theory of light.
First, the electro-magnetic field is quantised and given a particle
interpretation, yielding the concept of photons. Then I describe various
optical components in terms of unitary evolutions and their generators.

##### 6.1 Quantisation of the electro-magnetic field

Quantum mechanics, as presented in the previous section, can describe a
particle in an electro-magnetic field given by a vector potential @xmath
by making the following substitution:

  -- -------- -- ------
     @xmath      (32)
  -- -------- -- ------

where @xmath is the charge of the particle and @xmath is the vector
potential operator obtained by replacing the coordinates @xmath by their
corresponding operator @xmath .

Alternatively, the quantisation of the electro-magnetic field can be
derived from the Maxwell equations for the electric and magnetic field
@xmath and @xmath respectively ⁵ ⁵ 5 I avoid the notation @xmath ,
because its components may be confused with the Hamiltonian @xmath later
on. :

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (34)
                                   
     @xmath   @xmath   @xmath      (35)
  -- -------- -------- -------- -- ------

with @xmath the velocity of light in free space. For the fully quantum
mechanical description of the electro-magnetic field in free space, I
will follow the derivation of Scully and Zubairy [ 148 ] . Other books
on quantum optics include Loudon [ 112 ] and Walls and Milburn [ 171 ] .

Suppose we want to quantise the electro-magnetic field in a cavity with
length @xmath and volume @xmath . Classically, we can describe the
electric field in terms of the transverse modes in the @xmath
-direction:

  -- -------- -- ------
     @xmath      (36)
  -- -------- -- ------

where @xmath is the propagation direction, @xmath the mode amplitude,
@xmath the wave number and @xmath a proportionality constant:

  -- -------- -- ------
     @xmath      (37)
  -- -------- -- ------

The @xmath are the eigenfrequencies of the cavity. The constant @xmath
is a dummy mass, included to make the subsequent argument more
suggestive [ 148 ] .

From the Maxwell equations (Eq. ( 34 )), we can derive the magnetic
field (which is only non-zero in the @xmath -direction):

  -- -------- -- ------
     @xmath      (38)
  -- -------- -- ------

where @xmath denotes the time derivative of the mode amplitude @xmath .
The classical Hamiltonian then reads

  -- -------- -- ------
     @xmath      (39)
  -- -------- -- ------

After substitution of Eqs. ( 36 ) and ( 38 ) in the classical
Hamiltonian and integrating over the cavity volume we obtain

  -- -------- -- ------
     @xmath      (40)
  -- -------- -- ------

When we write @xmath , this has exactly the same form as the classical
Hamiltonian of the harmonic oscillator. Therefore, when we want to
quantise the electro-magnetic field we proceed in a similar fashion as
in section 1. c . We replace the variables @xmath and @xmath by their
respective operators @xmath and @xmath .

There are, however, several subtleties. The variables @xmath are
amplitudes of the field modes, and not coordinates, as is the case in
the linear harmonic oscillator. The variables @xmath are their
corresponding conjugate variables, which facilitate the
position-momentum interpretation since @xmath . But this is really field
quantisation , or second quantisation. Secondly, the masses @xmath do
not have any physical meaning. They are removed by changing our
description from @xmath and @xmath to creation and annihilation
operators @xmath and @xmath , as I shall now show.

##### 6.2 Creation and annihilation operators

Starting with the classical Hamiltonian of the free field in Eq. ( 40 )
and replacing the variables @xmath and @xmath with the quantum
mechanical operators @xmath and @xmath , we obtain the quantum
mechanical Hamiltonian

  -- -------- -- ------
     @xmath      (41)
  -- -------- -- ------

where

  -- -------- -- ------
     @xmath      (42)
  -- -------- -- ------

We can now make the canonical transformation to the operators @xmath and
@xmath :

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (43)
     @xmath   @xmath   @xmath      (44)
  -- -------- -------- -------- -- ------

The Hamiltonian in terms of the creation and annihilation operators thus
becomes

  -- -- -- ------
           (45)
  -- -- -- ------

With every operator @xmath corresponds a mode @xmath . This is a
Hamiltonian for a massless quantum field. At this point I should briefly
clarify my notation. Since the creation and annihilation operators are
closely related to the modes they act upon, I make the distinction
between modes and operators by writing the operators with a hat.
Although observables like the Hamiltonian and unitary transformations
are also operators, they do not yield such a potential ambiguity, and I
will not write them with hats.

Using the canonical commutation relations given by Eq. ( 42 ) we
immediately see that

  -- -------- -- ------
     @xmath      (46)
  -- -------- -- ------

The electric and magnetic fields after second quantisation thus read

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (47)
     @xmath   @xmath   @xmath      (48)
  -- -------- -------- -------- -- ------

with the field strength

  -- -------- -- ------
     @xmath      (49)
  -- -------- -- ------

Just as in the case of the linear harmonic oscillator, we can write the
energy eigenstates of one mode of the electro-magnetic field as @xmath :

  -- -------- -- ------
     @xmath      (50)
  -- -------- -- ------

By applying the annihilation operator on the last two sides of this
equation and using the commutation relations we easily find [ 148 ] :

  -- -------- -- ------
     @xmath      (51)
  -- -------- -- ------

with @xmath . The eigenstates are orthonormal: @xmath .

Rather than interpreting the eigenstates @xmath as the energy levels for
a fixed system, in quantum optics the state @xmath denotes a state of
@xmath quanta . The quanta corresponding to the electro-magnetic field
are the light-quanta or photons . The operators @xmath and @xmath thus
create and destroy photons. Generally, in quantum field theory a field
or a wave function is quantised, and the excited modes is given a
particle interpretation [ 37 , 144 ] .

At this point I would like to stress that a single photon does not have
a wave function [ 123 ] . It is the excitation of the electro-magnetic
field (see also Ref. [ 148 ] ). In the rest of this thesis I let @xmath
denote the state of the field, giving the number of photons @xmath in
mode @xmath .

In quantum mechanics, with every physical system corresponds a Hilbert
space. An orthonormal basis for a single-mode system @xmath is given by
@xmath , which spans an infinite dimensional Hilbert space. When we have
several modes @xmath in our system, the total Hilbert space of the
system is a tensor product of the Hilbert spaces of the separate modes
with orthonormal basis @xmath . This total Hilbert space can be uniquely
decomposed into subspaces with fixed photon number. A Hilbert space with
this property is called a Fock space :

  -- -------- -- ------
     @xmath      (52)
  -- -------- -- ------

where @xmath denotes the subspace spanned by the vectors @xmath with
@xmath for an @xmath -mode system. The states @xmath are also called
Fock states . The subspace @xmath is a one-dimensional subspace, better
known as the vacuum .

As a last remark, a tensor product state having a total of @xmath
photons may involve one or more modes in vacuum. For example @xmath ,
where @xmath denotes the vacuum. The state @xmath is part of the basis
spanning the subspace @xmath . The second mode is also said to be in the
vacuum state. This ambiguity is further explored in section 7.4 .

##### 6.3 Coherent and squeezed states

The creation and annihilation operators are very important in quantum
optics. We can therefore ask what the eigenstates of, e.g., the
annihilation operator are. Consider the eigenvalue equation for the
annihilation operator:

  -- -------- -- ------
     @xmath      (53)
  -- -------- -- ------

The eigenstate can be expanded in terms of number states [ 148 ] :

  -- -------- -- ------
     @xmath      (54)
  -- -------- -- ------

which can be written as

  -- -------- -- ------
     @xmath      (55)
  -- -------- -- ------

The corresponding displacement operator can then be written as

  -- -------- -- ------
     @xmath      (56)
  -- -------- -- ------

since the second term in the exponential does not change its behaviour
when applied to the vacuum. The operator @xmath is unitary, with @xmath
. When acting on a creation or annihilation operator, we have

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (57)
     @xmath   @xmath   @xmath      (58)
  -- -------- -------- -------- -- ------

The states @xmath are called coherent states . On a single mode, there
are no two coherent states which are orthogonal:

  -- -------- -- ------
     @xmath      (59)
  -- -------- -- ------

This is only zero when @xmath .

The creation and annihilation operators do not commute, and as a
consequence, (exponential) functions of these operators generally cannot
be rewritten according to the rules of normal arithmetic. In particular,
when @xmath we have @xmath . From a computational point of view, it is
often convenient to deal with the annihilation operators first, and then
the creation operators. Especially when the state acted upon is the
vacuum, the annihilation operators will yield zero, thus simplifying the
task. A function of these operators which is written as

  -- -------- -- ------
     @xmath      (60)
  -- -------- -- ------

is said to be in normal ordered form . For every term in the sum, the
annihilation operators are placed on the right and the creation
operators on the left. When the positions of these operators are
reversed (i.e., creation operators on the right), we speak of
anti-normal ordering .

Let me consider a simple example. The second order term in the
displacement operator (with @xmath real for simplicity) is proportional
to @xmath . In normal ordered form, this is equal to @xmath . Note the
@xmath in this expression. For higher order terms, the ‘non-arithmetic’
addition becomes more complicated, until finally, we arrive at [ 148 ] :

  -- -------- -- ------
     @xmath      (61)
  -- -------- -- ------

Later in this section I will return to the normal ordering in more
general terms.

Just as the displacement operator creates coherent states, we can
construct a squeezing operator which creates so-called squeezed states [
170 , 113 , 148 ] :

  -- -------- -- ------
     @xmath      (62)
  -- -------- -- ------

This operator is also unitary: @xmath . It transforms the creation and
annihilation operators according to ( @xmath )

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (63)
     @xmath   @xmath   @xmath      (64)
  -- -------- -------- -------- -- ------

The squeezing operator can also be written in normal ordered form [ 60 ]
:

  -- -------- -------- -- -------- ------
     @xmath   @xmath               (66)
                          @xmath   
  -- -------- -------- -- -------- ------

Rather than deriving this formula, I will now concentrate on the
so-called Baker-Campbell-Hausdorff formula.

We have seen that for non-commuting operators @xmath and @xmath we have
@xmath . The natural question to ask is then: what is @xmath ? The
relationship between the two is given by a Baker-Campbell-Hausdorff
formula. There are several ways in which we can write this formula, and
here I will give two (without proof; the interested reader is referred
to, e.g., Gilmore [ 69 ] ):

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (67)
     @xmath   @xmath   @xmath      (68)
  -- -------- -------- -------- -- ------

When @xmath and @xmath , the first BCH formula immediately gives the
normal ordered form for the displacement operator: @xmath , which is a
constant. Therefore, repeated commutators are zero and the BCH formula
terminates.

The sum over repeated commutators does not terminate in general, in
particular when @xmath and @xmath form a Lie algebra (possibly with a
set of other operators @xmath , @xmath ,…). When @xmath and @xmath
generate an @xmath or an @xmath algebra (with @xmath the third generator
of the respective algebras) the BCH formula consists of an infinite
number of terms, which converge to exponential functions of the
generators @xmath , @xmath and @xmath [ 164 ] . But even this
convergence is not guaranteed. In some cases it is just not possible to
write a function of operators in a concise normal ordered form. In
appendix \thechapter I further discuss the squeezing operator in
connection with the @xmath algebra. Because of the particular
non-compactness for the group @xmath , we recognise a one-to-one
correspondence between squeezing and @xmath .

More properties of the squeezing and displacement operators can be found
in Ref. [ 148 ] . I will now turn my attention to so-called multi-mode
squeezing.

Eq. ( 62 ) is defined for a single mode @xmath . However, we can apply
this single-mode squeezing operator to several distinct modes

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (70)
                                   
              @xmath   @xmath      (71)
  -- -------- -------- -------- -- ------

After an @xmath -mode basis transformation @xmath we obtain

  -- -------- -- ------
     @xmath      (72)
  -- -------- -- ------

The last operator @xmath can in general be written as

  -- -------- -- ------
     @xmath      (73)
  -- -------- -- ------

with @xmath and @xmath complex symmetric matrices. This is multi-mode
squeezing. It has been studied among others by Caves [ 40 ] , Barnett
and Knight [ 10 ] , and Caves and Schumaker [ 41 , 147 ] . The
normal-ordering of these operators has been studied by Yuen [ 180 ] ,
Fisher et al . [ 60 ] and Truax [ 164 ] .

Multi-mode squeezing is of fundamental importance to this thesis. In the
next chapter I study whether operators of the form of Eq. ( 73 ) can
yield so-called event-ready entanglement . In chapter \thechapter I
determine the general state of Eq. ( 73 ) when, in addition, conditional
measurements are included. Also parametric down-conversion, a technique
which will appear frequently in this thesis, can be described by this
evolution. It is now also clear why I present unitary evolutions in
terms of generators rather than the Schrödinger equation. Eq. ( 73 ) is
not necessarily an interaction Hamiltonian, but we can still consider
the evolution it yields.

##### 6.4 Optical components

The multi-mode displacement and squeezing operators are not just
mathematical inventions, they correspond to physical devices. A coherent
displacement of the vacuum yields a state which can be generated by a
laser. Squeezed states can be generated by, for instance, optical
parametric oscillators [ 171 ] or parametric down-conversion [ 109 ] .

Another type of optical components is given by unitary evolutions, the
generator of which leaves the photon number invariant. The most
important one is the beam-splitter . Physically, the beam-splitter
consists of a semi-reflective mirror: when light falls on this mirror
part will be reflected and part will be transmitted.

Let the two incoming modes be denoted by @xmath and @xmath respectively.
The outgoing modes are denoted by @xmath and @xmath . There are four
global modes, depicted in figure 3 .

When a photon is incident on a beam-splitter, it has a certain
probability of being reflected and a certain probability that it is
transmitted. When we parametrise the probability amplitudes of these
possibilities as @xmath and @xmath , then in operator form the
beam-splitter yields an evolution

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (74)
     @xmath   @xmath   @xmath      (75)
  -- -------- -------- -------- -- ------

and similar relations for the annihilation operators. The reflection and
transmission coefficients @xmath and @xmath of the beam-splitter are
@xmath and @xmath . The relative phase shift in the second relation
ensures that the transformation is unitary. This means that the
beam-splitter is an asymmetric device.

Alternatively, we can write the beam-splitter evolution in terms of a
unitary operator generated by an Hermitian operator. Eq. ( 74 ) can be
interpreted as the beam-splitter version of Eqs. ( 57 ) and ( 63 ). The
question is therefore what the corresponding unitary transformation is
(analogous to @xmath and @xmath ). Using the second line in Eq. ( 67 )
we can easily verify that

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (77)
                                   
     @xmath   @xmath   @xmath      (78)
  -- -------- -------- -------- -- ------

In general, the generator @xmath of the beam-splitter evolution @xmath
is given by

  -- -------- -- ------
     @xmath      (79)
  -- -------- -- ------

Since the photon-number is conserved in the beam-splitter, the operator
@xmath commutes with the number operator: @xmath . Furthermore, @xmath
is a generator of an @xmath algebra.

The same mathematical description applies to the evolution due to a
polarisation rotation . Instead of having two different spatial modes
@xmath and @xmath , the two incoming modes have different polarisations.
We write @xmath and @xmath , for some rectilinear set of coordinates
@xmath and @xmath . The parameter @xmath is now the angle of rotation:

  -- -------- -------- -------- -- ------
     @xmath   @xmath   @xmath      (80)
     @xmath   @xmath   @xmath      (81)
  -- -------- -------- -------- -- ------

This evolution has the same generator as the beam-splitter, except that
the angle @xmath is real for the polarisation rotation, whereas for the
beam-splitter we admit complex @xmath ’s in Eq. ( 79 ).

Another important optical component is the single-mode phase shift :

  -- -------- -- ------
     @xmath      (82)
  -- -------- -- ------

It is easily verified that

  -- -------- -- ------
     @xmath      (83)
  -- -------- -- ------

The corresponding generator is given by @xmath . It also commutes with
the number operator.

In general, when some unitary evolution leaves the photon number
invariant, that evolution corresponds to some passive optical circuit.
Alternatively, when a unitary evolution does not conserves the photon
number, we speak of active optical devices or photon sources .

#### 7 Quantum information

Quantum information theory delivers the foundations for quantum
computation, and in order to perform a quantum computation we need to be
able to, among other things, prepare certain quantum states. In this
thesis, I will not consider any quantum computation algorithms, but I do
consider state preparation. In later chapters, I will need some concepts
from quantum information theory, such as the fidelity , to assess
various aspects of a state preparation process. Furthermore, since this
thesis revolves around states, I have to develop an understanding of
what subtleties are involved when talking about quantum states.

##### 7.1 The computational basis and alphabets

Suppose we have a single system with a corresponding Hilbert space of
dimension @xmath . Rather than giving an orthonormal basis of a system
as wave functions in configuration space (like, for instance the
eigenstates of the harmonic oscillator in Eq. ( 17 )), we can ignore the
particular spatial behaviour of these states and enumerate them from 0
to @xmath . The corresponding basis @xmath , with @xmath , is then
called the computational basis. When we have a two-level system ( @xmath
), the computational basis states are @xmath and @xmath , and we speak
of a qubit .

The advantage of the computational basis is that it is independent of
the physical representation. Any quantum mechanical two-level system is
a qubit, for example an electron in a magnetic field, a polarised photon
or a SQUID with clockwise or counter-clockwise current.

When we have two or more systems, the computational basis can be
extended accordingly. If we have @xmath systems, we can choose a
computational basis @xmath , where @xmath , with @xmath the
dimensionality of the @xmath system. For instance, the computational
basis for two qubits is given by @xmath . In most of the rest of this
thesis, I will concentrate on qubits.

As a final point in this section, I present the concept of an alphabet
of states. It is a finite set of possibly non-orthogonal states. It may
be over-complete or it may not span the total Hilbert space.
Furthermore, an alphabet of states can generate a POVM, corresponding to
a generalised measurement. I am now ready to discuss some
information-theoretic aspects of quantum states.

##### 7.2 Shannon entropy and quantum information

Prior to the measurement of a system (in, for example, the computational
basis), we have a probability distribution @xmath with @xmath over all
possible outcomes. We do not know the measurement outcome beforehand.
Can we quantify our ignorance of this measurement outcome?

Obviously, when one probability @xmath is 1 and the others are all 0,
there is no ignorance about the measurement outcome: we will find the
system in the state @xmath , corresponding to the probability @xmath .
On the other hand, when all @xmath ’s are equal, our ignorance about the
measurement outcome is maximal. We are looking for a function of the set
of probabilities @xmath which is zero when one of the @xmath ’s is zero,
and maximal when all @xmath ’s are equal. Such a function is given by

  -- -------- -- ------
     @xmath      (84)
  -- -------- -- ------

This is called the Shannon entropy of a probability distribution [ 151 ,
131 ] . It is immediately verified that @xmath if all @xmath ’s are 0,
except @xmath , and by differentiation @xmath we find that the only
extremum (a maximum) occurs when all @xmath ’s are equal.

The Shannon entropy is a classical entropy. Quantum mechanically, we can
also define an entropy which gives a measure for our ignorance of a
state. Suppose the state can be written as a mixture @xmath :

  -- -------- -- ------
     @xmath      (85)
  -- -------- -- ------

with @xmath some suitable basis. The Shannon entropy can be calculated
according to Eq. ( 84 ) using the probability distribution @xmath .
Quantum mechanically, our ignorance of the state is given by the Von
Neumann entropy :

  -- -------- -- ------
     @xmath      (86)
  -- -------- -- ------

When @xmath is pure, it is easy to verify that @xmath by using the fact
that basis transformations inside the trace leave @xmath invariant.
Therefore @xmath , the Von Neumann entropy is a lower bound on our
ignorance of the state.

As an example, consider a source which produces pure right-handedly
polarised photons. In the linear polarisation basis this state is given
by

  -- -------- -- ------
     @xmath      (87)
  -- -------- -- ------

A measurement in the basis @xmath would yield a probability distribution
over the measurement outcomes @xmath , so the Shannon entropy is
maximal. However, since we could have measured in the circular basis,
the probability distribution would have been @xmath , with a
corresponding @xmath . In both cases the Von Neumann entropy is 0,
corresponding to the lower bound of the Shannon entropy.

Massar and Popescu [ 118 ] proved that the minimal ignorance about a
state after a measurement is given by the Von Neumann entropy. For more
details on the Shannon entropy in quantum theory I refer the reader to
Peres [ 131 ] .

##### 7.3 Fidelity and the partition ensemble fallacy

In the previous section, we used the knowledge of the probability
distribution to quantify our ignorance of the measurement outcomes prior
to the measurement. However, in general this probability distribution is
not known. When we measure the polarisation of a photon we will find
definite outcomes, not probabilities. In this section, I ask the
question how much information can be gained in a single-shot measurement
when the state of the system is not known beforehand. One measure of the
information we can extract from a state is given by the fidelity [ 83 ,
86 , 63 , 64 , 118 ] .

Suppose we want to measure an unknown state and use the knowledge gained
by the measurement outcome to reconstruct that state. We then need a
measure quantifying the accuracy of the reconstruction. Such a measure
is given by the fidelity . Suppose further that the initial unknown
state is given by @xmath . We now measure this state along @xmath ⁶ ⁶ 6
In general, @xmath is part of a POVM, yielding a generalised
measurement. , which is our estimate . We can define the measure of
success of our estimate by [ 118 ]

  -- -------- -- ------
     @xmath      (88)
  -- -------- -- ------

This is not the only possible measure, but for our present purposes it
is the simplest. When we have a probability distribution over a set of
initial states (i.e., we have a mixed state @xmath ), and a POVM @xmath
, we can average @xmath over the two alphabets of states:

  -- -------- -- ------
     @xmath      (89)
  -- -------- -- ------

where @xmath is the probability of estimating the state @xmath when the
prepared state is @xmath . @xmath is called the average fidelity of
state reconstruction.

Consider a source which creates either randomly polarised photons, or
linearly polarised photons @xmath and @xmath with equal probabilities in
a given coordinate frame. When we measure the polarisation in @xmath ,
the outcomes will always be a horizontally or vertically polarised
photon for both randomly and linearly polarised photons. We now
reconstruct the photon state according to this measurement outcome
(creating a photon in the direction corresponding to the measurement
outcome). If the photons are linearly polarised, the fidelity of the
reconstruction is equal to 1, whereas in the case of randomly polarised
photons the fidelity is 2/3 [ 117 ] . In the last case we recognise the
state very well ( @xmath ), and in the former, we recognise the state
quite badly. Therefore, the same measurement with the same outcomes
(with the same relative frequencies) yield a different fidelity. As a
consequence, this fidelity is a measure of the information we extract
from the state [ 118 ] .

Let’s now ask a slightly different question: what is the probability
that a state @xmath is mistaken for another ‘estimated’ state @xmath ?
This probability is given by the overlap between the two states:

  -- -------- -- ------
     @xmath      (90)
  -- -------- -- ------

This equation gives the definition of fidelity in a different context.
It corresponds to the lower bound for the probability of mistaking
@xmath for @xmath in any possible (single) measurement [ 63 ] . When
@xmath is an exact replica of @xmath then @xmath , and when @xmath is an
imprecise copy of @xmath then @xmath . Finally, when @xmath is
completely orthogonal to @xmath the fidelity is zero.

In the above discussion I constructed a mixed state @xmath for randomly
polarised photons. Consider a polarisation state

  -- -------- -- ------
     @xmath      (91)
  -- -------- -- ------

The mixed state of randomly polarised photons is obtained by integrating
over all @xmath which yield a different state @xmath :

  -- -------- -- ------
     @xmath      (92)
  -- -------- -- ------

But this mixture is equal to that which we would have obtained by
randomly choosing only horizontally and vertically polarised photons. In
other words, a mixed state does not contain information about the
preparation process! In general, we can construct infinitely many
physically different sources which generate the same mixed outgoing
state. Or equivalently, there exist infinitely many decompositions, or
partitions , of any given mixed state.

Another example. Consider the state @xmath of the form of

  -- -------- -- ------
     @xmath      (93)
  -- -------- -- ------

It is the sum of two pure states. Again, this is not a unique partition.
Whereas in a chemical mixture of, say, nitrogen and oxygen there is a
unique partition (into N @xmath and O @xmath ), a quantum mixture can be
decomposed in many ways. For instance, @xmath can equally be written in
terms of

  -- -------- -- ------
     @xmath      (94)
  -- -------- -- ------

as

  -- -------- -- ------
     @xmath      (95)
  -- -------- -- ------

This is just one of an infinite number of possible decompositions.
Quantum mechanics dictates that all partitions are equivalent to each
other [ 131 ] . They are indistinguishable. To elevate one partition
over another is to commit the ‘Partition Ensemble Fallacy.’

Why is this so important? Suppose we have a mixture of the vacuum @xmath
and a single-photon state @xmath , yielding @xmath . It is very tempting
to interpret such a mixture as: ‘with probability @xmath there is a
photon, and with probability @xmath there is no photon’. However,
quantum theory does not say anything about what is without referring to
measurement outcomes. If we were to measure an observable whose
eigenstates are not number states (like, for instance, coherent states),
the outcome would not involve any reference to photon numbers.
Therefore, in the context of quantum mechanics, the above statement is
meaningless. These considerations will become important in chapter
\thechapter .

##### 7.4 Non-locality issues

Quantum theory is a local theory, in the sense that space-like and
time-like separated operators @xmath and @xmath always commute: @xmath [
76 ] . However, when one seeks a classical deterministic underlying
explanation for the correlations observed in quantum mechanics, one has
to allow non-local influences. This was first noted by Bell [ 11 ] , who
formulated his now famous inequalities [ 85 , 141 ] .

Let me set up a simple version of Bell’s argument. Alice and Bob, who
are sufficiently far away from each other, both receive a photon with
some unknown polarisation. Alice randomly chooses a polarisation
measurement out of two possible directions @xmath and @xmath .
Similarly, Bob randomly chooses a polarisation measurement out of @xmath
and @xmath . Let’s denote the two possible measurement outcomes of a
polarisation measurement by @xmath . Then the eigenvalues @xmath ,
@xmath , @xmath and @xmath are all either @xmath or @xmath . We repeat
this procedure a large number of times.

We now define the expression [ 141 ]

  -- -------- -- ------
     @xmath      (96)
  -- -------- -- ------

where the subscript @xmath indicates the @xmath trial. The value of
@xmath is an integer between @xmath and @xmath . The absolute value of
the average of @xmath over all the @xmath trials is given by

  -- -------- -- ------
     @xmath      (97)
  -- -------- -- ------

When we define the correlation coefficients

  -- -------- -- ------
     @xmath      (98)
  -- -------- -- ------

the above inequality becomes

  -- -------- -- ------
     @xmath      (99)
  -- -------- -- ------

This is one form of the Bell inequality. We can calculate these
correlation coefficients for the case where the two photons are part of
the singlet state @xmath , which yields @xmath . For suitably chosen
angles @xmath , the Bell inequality is violated by quantum mechanics.

What does this mean? All I assumed in the above derivation of the
inequality was statistical independence of the measurement outcomes
obtained by Alice and Bob. The violation therefore implies that the
measurements performed by Alice and Bob, though possibly in different
galaxies, and thus well and truly separated, can not be considered
statistically independent! This has led to wild speculations about
superluminal signalling, but all quantum mechanics predicts are
correlations which cannot be given a local realistic interpretation. If
we want a classical picture, we therefore have to give up either realism
or locality. The choice is yours.

Suppose we have a bi-partite state which violates a Bell inequality.
Then that state is said to be entangled . The contrary is not
necessarily true: a state which is entangled does not have to violate
any Bell inequalities [ 136 ] (see also appendix \thechapter ). Several
different Bell inequalities have been experimentally verified by many
groups, the first of which was led by Aspect [ 7 , 8 ] . Nowadays,
experimental tests of the violation of a Bell inequality is used mostly
to indicate whether a state is entangled. Alternatively, tests of
non-locality without Bell inequalities have been proposed by DiGiuseppe
and Boschi [ 50 , 19 ] .

In the context of quantum optics, there are nonlocal effects in Fock
space which are of some interest in this thesis. Hardy and Peres showed
that a single photon can exhibit non-local properties, following the
work by Tan, Walls and Collett [ 160 , 161 , 145 ] . Here, I will follow
Peres’ argument [ 78 , 79 , 165 , 72 , 133 ] .

Consider a pure one-particle state

  -- -------- -- -------
     @xmath      (100)
  -- -------- -- -------

where @xmath is the vacuum and @xmath a single-photon state. The
subscripts @xmath and @xmath denote the different modes, possibly
spatially separated over a large distance. Note that this state has the
same mathematical structure as a singlet state. Alice and Bob can
demonstrate a violation of a Bell inequality ⁷ ⁷ 7 More precisely, a
Clauser-Horne inequality. using the strategy described above: Alice and
Bob both randomly choose an observable from a set of two non-commuting
observables. The first observable for both parties is obviously the one
spanned by @xmath , i.e., whether there is a photon in mode @xmath or
@xmath respectively. Let @xmath denote the projector @xmath and @xmath
the projector @xmath .

Another observable for Alice might include the projector @xmath along
the eigenvector @xmath and Bob can choose to measure along the projector
@xmath along the eigenvector @xmath . Given Eq. ( 100 ) quantum theory
yields [ 133 , 73 ] :

  -- -------- -- -------
     @xmath      (101)
                 (102)
     @xmath      (103)
                 (104)
     @xmath      (105)
                 (106)
     @xmath      (107)
  -- -------- -- -------

which violates the inequality

  -- -------- -- -------
     @xmath      (108)
  -- -------- -- -------

This proves non-locality. However, the fact that @xmath and @xmath do
not conserve photon number means that active detection devices, i.e.,
detectors which can create photons, have to be used. This has provoked
many comments [ 145 , 166 , 72 , 73 ] , but treating them all would lead
me too far from the main subject of this thesis. Let us therefore move
on to the creation of maximal entanglement in quantum optics, the
subject of the next chapter.

### Chapter \thechapter Creation of Maximal Entanglement

@xmath That’s the wacky thing about these entangled

@xmath photon pairs—They’re sort of the Bill Clinton and

@xmath Monica Lewinsky of the quantum world: they’re

@xmath heavily entangled until somebody ‘looks’ at them.

—Jonathan P. Dowling

Entanglement is one of the key ingredients in quantum communication and
information. For instance, quantum protocols such as dense coding [ 13 ]
, quantum error correction [ 159 , 155 ] and quantum teleportation [ 14
] rely on the non-classical correlations provided by entanglement.
Currently, substantial efforts are being made to use optical
implementations for quantum communication.

The advantages of this are obvious: light travels at high speed and it
weakly interacts with the environment. However, exactly this weak
interaction poses serious drawbacks. The fact that photons do not
interact with each other makes it hard to manipulate them. For example,
it has recently been shown that it is impossible to perform so-called
complete Bell measurements on two-mode polarisation states in linear
quantum optics [ 114 , 167 ] (although theoretical schemes involving
Kerr media [ 149 ] and atomic coherence [ 128 ] have been reported).
Furthermore, maximally polarisation-entangled two-photon states have not
been unconditionally produced. In this chapter I investigate the
possibility of creating such states with linear optics and a specific
class of non-linear elements.

Before that, however, I will have to introduce the terminology I will
use in this chapter (and throughout this thesis). In the next section I
will discuss various issues connected to entanglement, such as
separability, maximal entanglement, multi-partite entanglement and
purification. In section 9 I will study parametric down-conversion,
currently the most common entanglement source in quantum optics.
Finally, I give limitations for the creation of maximal entanglement
with a special class of optical circuits. This chapter is based on Kok
and Braunstein [ 99 , 100 ] .

#### 8 Separability and entanglement

In this section I discuss the concept of entanglement. First, I define
separable and entangled states, and then I introduce event-ready
entanglement. Three-particle entanglement is briefly considered, and
finally, I discuss the entanglement measure for pure states and
entanglement purification .

##### 8.1 What is maximal entanglement?

Two quantum systems in a pure state, labelled by @xmath and @xmath
respectively, are called entangled when the state @xmath describing the
total system cannot be factorised into two separate states @xmath and
@xmath :

  -- -------- -- -------
     @xmath      (109)
  -- -------- -- -------

All possible states @xmath accessible to the combined state of the two
quantum systems form a set @xmath . These states are generally
entangled. Only in extreme cases is @xmath separable , i.e., it can be
written as a product of states describing the separate systems. The set
of separable states form a subset of @xmath with measure zero.

We arrive at another extremum when the states @xmath are maximally
entangled. The set of maximally entangled states also forms a subset of
@xmath with measure zero. I will now give a definition of maximal
entanglement for two finite-dimensional systems.

  Definition:  

    Two @xmath -level systems are called maximally entangled when their
    total state @xmath in the Schmidt decomposition can be written as

      -- -------- -- -------
         @xmath      (110)
      -- -------- -- -------

    with @xmath and @xmath two orthonormal bases and @xmath a set of
    arbitrary phases.

Suppose we have two (not necessarily identical) two-level systems, 1 and
2, whose states can be written in the orthonormal basis @xmath (where
@xmath ). This is defined as the computational basis for these two
systems. Physically, those systems could be for example polarised
photons or electrons in a magnetic field. Every possible state of the
two systems together can be written on the basis of four orthonormal
states @xmath , @xmath , @xmath and @xmath . These basis states generate
a four-dimensional Hilbert space. Another possible basis for this space
is given by the so-called Bell states:

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (111)
     @xmath   @xmath   @xmath      (112)
  -- -------- -------- -------- -- -------

These states are also orthonormal. They are examples of maximally
entangled states. The Bell states are not the only maximally entangled
states (as an alternative, we can include a relative phase @xmath in one
of the branches; see also the definition on this page), but they are a
convenient and common choice. All maximally entangled states can be
transformed into each other by a local unitary transformation (see
Appendix \thechapter ).

If we want to conduct an experiment which makes use of maximal
entanglement, in particular @xmath , we would most straightforwardly
like to have a source which produces these states at the push of a
button. In practice, this might be a bit much to ask. A second option
might be to have a source which only produces @xmath randomly, but
flashes a red light when it happens. Such a source would create
so-called event-ready entanglement ⁸ ⁸ 8 The term first seems to appear
in the context of detector efficiencies [ 183 ] in 1993, and
subsequently with the meaning used here by Pavičić [ 130 ] in 1996. : it
produces @xmath only part of the time, but when it does, it tells you.

More formally, the outgoing state @xmath conditioned on the red light
flashing is said to exhibit event-ready entanglement if it can be
written as

  -- -------- -- -------
     @xmath      (113)
  -- -------- -- -------

where @xmath . In what follows I shall omit the subscript ‘ @xmath red
light flashes’ since it is clear that we can only speak of event-ready
entanglement conditioned on the red light flashing.

Non-maximal entanglement has been created in the context of quantum
optics by means of parametric down-conversion [ 153 ] . Rather than a
(near) maximally entangled state, as in Eq. ( 113 ), this process
produces states with a large vacuum contribution. Only a minor part
consists of an entangled photon state. Every time parametric
down-conversion is employed, there is only a small probability ⁹ ⁹ 9
This probability is kept small so that the occurrence of higher order
double photon-pairs is negligible. of creating an entangled photon-pair
(notice my use of PEF; see chapter II). We will call this randomly
produced entanglement.

##### 8.2 Tri-partite entanglement

So far, I have only considered the entanglement of two systems. But
quantum mechanics does not give a limit to the number of systems which
can be entangled. For instance, we can define a maximally entangled
state for three systems 1, 2 and 3:

  -- -------- -- -------
     @xmath      (114)
  -- -------- -- -------

Such multi-partite entangled states are called
Greenberger-Horne-Zeilinger- or GHZ-states [ 71 ] . They also represent
a particular state of three maximally entangled systems. Post-selected
three-particle GHZ entanglement was observed experimentally by
Bouwmeester et al . in 1999 [ 26 ] . In chapter \thechapter I will
extensively discuss the post-selected nature of this and related
experiments.

The state @xmath can also be interpreted as a Schmidt decomposition for
three systems (i.e., it can be written as a single sum over orthonormal
basis states). Contrary to the bi-partite case, it is not true that a
Schmidt decomposition exists for any three-partite state. The Schmidt
decomposition for two systems follows from the existence of the unitary
transformations @xmath and @xmath which diagonalise a matrix @xmath
according to @xmath , giving [ 1 ]

  -- -------- -- -------
     @xmath      (115)
  -- -------- -- -------

with @xmath , @xmath and @xmath orthonormal bases and @xmath the
eigenvalues of the diagonal matrix @xmath . For the general three-system
case this is no longer true:

  -- -------- -- -------
     @xmath      (116)
  -- -------- -- -------

by virtue of the Schmidt decomposition (again with @xmath and @xmath
orthonormal bases). This is converted to a single sum if and only if [
132 ]

  -- -------- -- -------
     @xmath      (117)
  -- -------- -- -------

or @xmath with @xmath .

For multi-partite entanglement, we can no longer completely define
maximal entanglement in terms of the Schmidt decomposition. For example,
it can easily be verified that the state

  -- -------- -- -------
     @xmath      (118)
  -- -------- -- -------

although representing three maximally entangled systems, cannot be
written in terms of the Schmidt decomposition in Eq. ( 114 ) (the number
of linear independent terms exceeds the number of orthonormal basis
states of the separate systems). More specifically, Dür et al . prove
that ensembles of three-partite entangled states of qubits can be
transformed either to the state @xmath or to the state @xmath by
stochastic ¹⁰ ¹⁰ 10 ‘Stochastic’ meaning that the transformation is
successful with non-zero probability. local operations and classical
communication (SLOCC) alone [ 55 ] . That is, under SLOCC, @xmath and
@xmath generate two distinct invariant subspaces of the total Hilbert
space @xmath spanned by the three qubits. In conclusion, the definition
of maximally entangled states in terms of the Schmidt decomposition
given on page 110 only works for bi-partite systems. However, in the
rest of this chapter (and indeed, this thesis) I will concentrate on
entanglement between two systems, and this definition is sufficient.

##### 8.3 Purification

In this section, I will define a measure of entanglement @xmath for
(pure) states which are non-maximally entangled [ 15 , 16 ] ¹¹ ¹¹ 11
There are subtleties in defining measures of entanglement for mixed
states; see Ref. [ 27 ] and references therein. . The natural measure of
entanglement is defined by the Von Neumann entropy of the reduced
density matrix of the subsystems. Suppose we have two systems 1 and 2
held by Alice and Bob respectively in a (non-maximally) entangled state
@xmath . The reduced density matrices of the two subsystems are

  -- -------- -- -------
     @xmath      (119)
  -- -------- -- -------

In chapter \thechapter we defined the Von Neumann entropy of a density
matrix @xmath as

  -- -------- -- -------
     @xmath      (120)
  -- -------- -- -------

The measure of entanglement @xmath is now defined as

  -- -------- -- -------
     @xmath      (121)
  -- -------- -- -------

This measure has a number of pleasant properties: it is zero for
separable states and maximal for maximally entangled states.
Furthermore, @xmath remains the same whether we trace out system 1 or
system 2.

Can we in some way increase the entanglement in non-maximally entangled
(pure) states? The answer to this question is the domain of entanglement
purification . I will now briefly discuss the general idea behind
purification.

Suppose we distribute a set of singlet states among Alice and Bob for
quantum communication purposes. After the distribution, however, the
actual states held by Alice and Bob will in general no longer be
maximally entangled. This is because noise and decoherence in the
distribution process degrade the entanglement. In order to obtain
singlet states again we have to purify the ensemble of states shared
between Alice and Bob with only local operations [ 15 ] . Because
operations of this kind cannot increase the amount of entanglement, the
total entanglement shared by Alice and Bob remains the same or
decreases. However, we still have the possibility of converting several
copies of poorly entangled states into a few highly entangled states. In
general, when we have @xmath non-maximally entangled initial states
@xmath with entanglement content @xmath , we wish to obtain @xmath
entangled states @xmath with @xmath using a restricted class of
operations. The local operations can be divided into three groups [ 27 ]
:

1.   Local transformations and measurements . These can be modelled in
    general by local POVM’s, i.e., POVM’s acting on only one subsystem,

2.   classical communication . This creates the opportunity to
    classically correlate the actions of the two (distant) parties
    holding the entanglement,

3.   post-selection . Depending on the outcome of local measurements and
    classical communication, we can select a subset from our ensemble of
    states.

A procedure which manages to increase the entanglement in a subset of
the @xmath initial states using only operations from these three classes
is called an entanglement purification protocol.

As an example, I consider the original purification protocol ¹² ¹² 12 In
chapter \thechapter we will encounter another purification protocol. [
15 ] . We distribute (at least) two singlets, written in the
computational basis @xmath with @xmath , between Alice and Bob:

  -- -------- -- -------
     @xmath      (122)
  -- -------- -- -------

Similarly, the other Bell states are given by @xmath and @xmath . A
simple model of the noise due to the distribution implies that upon
arrival the singlets have become Werner states ¹³ ¹³ 13 Decoherence
tends to evolve pure states towards (maximally) mixed states. [ 174 ]
@xmath :

  -- -------- -- -------
     @xmath      (123)
  -- -------- -- -------

Note that there is a singlet contribution in the maximally mixed part
@xmath as well. Two states with equal density matrices cannot be
distinguished in any physical way, which means that the method of
preparation of @xmath is irrelevant. In other words, we do not care how
decoherence took place in the distribution process, the occurrence of
@xmath defines a class of noise types which give rise to Eq. ( 123 ).
The noise gain is parametrised by @xmath .

In order to purify @xmath we need at least two such systems in a total
state @xmath . As a first step, Bob operates with the Pauli matrix
@xmath on his part of the density matrix, yielding a transformation

  -- -------- -- -------
     @xmath      (124)
  -- -------- -- -------

This transformation is equivalent to the symbol swapping @xmath in the
Bell states given in Eq. ( 111 ).

Next, Bob applies the ‘controlled NOT’ to his two subsystems, after
which both Alice and Bob measure the target in the computational basis.
They compare their measurement outcome by means of classical
communication, and if the two outcomes are the same (00 or 11), Bob
again applies the @xmath operator to his remaining state. If the
measurement outcomes are not the same, the purification failed. This is
the post-selection stage. Note the probabilistic character of the
purification protocol. After a successful purification run, Alice and
Bob share a mixed state @xmath .

Before purification the fidelity of the distributed system was

  -- -------- -- -------
     @xmath      (125)
  -- -------- -- -------

After a successful purification round the new fidelity @xmath is [ 15 ]

  -- -------- -- -------
     @xmath      (126)
  -- -------- -- -------

For purification to be meaningful we need @xmath , or @xmath . In other
words, if the decoherence is too strong, this type of purification
cannot increase the entanglement in a subset of the distributed
ensemble.

Numerous other purification protocols have been proposed (see Ref. [ 27
] and references therein). In general, it provides a procedure to obtain
(near) maximal entanglement. Also called distillation, entanglement
purification reduces an ensemble of poorly entangled states to a few
highly entangled states.

By contrast, in this thesis I study the creation of event-ready
entanglement, in particular with quantum optics. The difference with
purification is that it is dynamic : an event-ready entangler does not
need to store entanglement (something which is very difficult for
photons), it tries a (large) number of times and ‘flashes a red light’
upon success. In the next section I will study a more modest device,
called a parametric down-converter. It produces entanglement randomly.

#### 9 Entanglement sources in quantum optics

In this section I will look at a particular class of devices capable of
creating entanglement in quantum optics. These devices are commonly
known as down-converters , since they convert a high-energy photon into
two lower-energy photons. Physically, in parametric down-conversion a
crystal is pumped by a high-intensity laser, which we will treat
classically (the parametric approximation). The crystal is special in
the sense that it has different refractive indices for horizontally and
vertically polarised light. In the case of degenerate (type II)
parametric down-conversion a photon from the pump is split into two
photons with half the energy of the pump photon. Furthermore, the
process can be set up such that the two photons have orthogonal
polarisations. The outgoing modes of the crystal constitute two
intersecting cones with orthogonal polarisations @xmath and @xmath as
depicted in Fig. 4 .

Due to the conservation of momentum, the two produced photons are always
in opposite modes with respect to the central axis (determined by the
direction of the pump). In the two spatial modes where the different
polarisation cones intersect we can no longer infer the polarisation of
the photons, and as a consequence the two photons become entangled in
their polarisation. Parametric down-conversion as a device to create
entangled photons was introduced by Shih and Alley in 1988 [ 153 ] and
is being continuously improved [ 154 , 109 , 111 , 94 , 125 ] .

However, parametric down-converters do not produce pure Bell-states [
183 , 32 , 99 ] . Because of the spontaneous nature of the
down-conversion process, only a in a small number of cases (i.e., a
fraction of the trials) will a photon from the pump be split into two
photons. We thus have randomly produced entanglement. Furthermore, there
is an even smaller probability of creating more photon pairs,
originating from several pump photons. The probability of this happening
decreases with the number of created pairs. I will derive the value of
these probabilities in due course.

The outgoing state of the parametric down-converter I am interested in
here is

  -- -------- -- -------
     @xmath      (127)
  -- -------- -- -------

where @xmath is a parameter indicating the strength of the
down-conversion. Note that @xmath denotes the vacuum here, rather than a
computational basis state. In the next section I will give a
mathematical description of down-converters and subsequently I will
determine the statistical properties of these devices.

##### 9.1 The physics of down-converters

In this section I will describe the physical properties of parametric
down-conversion. Consider a down-converter with outgoing field modes
@xmath and @xmath . The indices denote the particular polarisation along
the @xmath - and @xmath -axis of a given coordinate system. We are
working in the interaction picture of the Hamiltonian which governs the
dynamics of creating two entangled field modes @xmath and @xmath using
weak parametric down-conversion. In the rotating wave approximation this
Hamiltonian reads ( @xmath ):

  -- -------- -- -------
     @xmath      (128)
  -- -------- -- -------

In this equation H.c. means Hermitian conjugate, and @xmath is the
product of the pump amplitude and the coupling constant between the
electro-magnetic field and the crystal. The operators @xmath , @xmath
and @xmath , @xmath are creation and annihilation operators for
polarisations @xmath respectively. They satisfy the following
commutation relations:

  -- -------- -- -------- -- -------
     @xmath      @xmath      (129)
     @xmath      @xmath      (130)
  -- -------- -- -------- -- -------

where @xmath . The time evolution due to this Hamiltonian is given by

  -- -------- -- -------
     @xmath      (131)
  -- -------- -- -------

where @xmath is the time it takes for the pulse to travel through the
crystal. By applying this unitary transformation to the vacuum @xmath
the state @xmath is obtained:

  -- -------- -- -------
     @xmath      (132)
  -- -------- -- -------

We are interested in the properties of @xmath . Define the @xmath and
the @xmath operator to be

  -- -------- -- -------
     @xmath      (133)
  -- -------- -- -------

This will render Eqs. ( 128 ) and ( 131 ) into:

  -- -------- -- -------
     @xmath      (134)
  -- -------- -- -------

Applying @xmath to the vacuum will yield a singlet state (up to a
normalisation factor) in modes @xmath and @xmath :

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (135)
              @xmath   @xmath      (136)
  -- -------- -------- -------- -- -------

we henceforth use the latter notation where @xmath is shorthand for
@xmath , a tensor product of photon number states. Applying this
operator @xmath times gives a state @xmath (where we have included a
normalisation factor @xmath , so that @xmath ):

  -- -------- -- -------
     @xmath      (137)
  -- -------- -- -------

where the normalisation constant @xmath is given by

  -- -------- -- -------
     @xmath      (138)
  -- -------- -- -------

We interpret @xmath as the state of @xmath entangled photon-pairs on two
spatial modes @xmath and @xmath .

We want the unitary operator @xmath in Eq. ( 134 ) to be in a normal
ordered form, because then the annihilation operators will ‘act’ on the
vacuum first, in which case Eq. ( 132 ) simplifies. In order to obtain
the normal ordered form of @xmath we examine the properties of @xmath
and @xmath . Given the commutation relations ( 129 ), it is
straightforward to show that:

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (139)
     @xmath   @xmath   @xmath      (140)
  -- -------- -------- -------- -- -------

An algebra which satisfies these commutation relations (together with
the properties @xmath and @xmath ) is an @xmath algebra ¹⁴ ¹⁴ 14 The
interaction Hamiltonian from Eq. ( 128 ) thus generates unitary
evolutions which are closely related to the group elements of @xmath . .
The normal ordering for this algebra is known [ 164 ] (with @xmath )
(see also appendix \thechapter for more details):

  -- -------- -- -------
     @xmath      (141)
  -- -------- -- -------

The scaled time @xmath is defined as @xmath . Without loss of generality
we can take @xmath to be real. Since the ‘lowering’ operator @xmath is
placed on the right, it will yield zero when applied to the vacuum and
the exponential reduces to the identity. Similarly, the exponential
containing @xmath will yield a @xmath -number, contributing only an
overall phase.

Parametric down-conversion is an example of so-called multi-mode
squeezed vacuum . The photon-statistics of two-mode squeezed states have
been studied in Refs. [ 42 , 6 , 146 ] . Here, I study the particular
case of the down-conversion process used to create randomly produced
maximal entanglement.

Are the pairs formed in parametric down-conversion independent of each
other? If they are, the number of pairs should give a Poisson
distribution. I will now calculate whether this is the case.

Suppose @xmath is the probability of creating @xmath photon-pairs with
parametric down-conversion and let

  -- -------- -- -------
     @xmath      (142)
  -- -------- -- -------

then the probability of finding @xmath entangled photon-pairs is:

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (144)
                                   
              @xmath   @xmath      (145)
              @xmath   @xmath      (146)
              @xmath   @xmath      (147)
  -- -------- -------- -------- -- -------

It should be noted that this is a normalised probability distribution in
the limit of @xmath .

Given Eqs. ( 142 ) @xmath deviates from the Poisson distribution, and
the pairs are therefore not independent. For weak sources, however, one
might expect that @xmath approaches the Poisson distribution
sufficiently closely. This hypothesis can be tested by studying the
distinguishability of the two distributions.

##### 9.2 Statistical properties of down-converters

Here, I study the distinguishability between the pair distribution
calculated in the previous section and the Poisson distribution. The
Poisson distribution for independently created objects is given by

  -- -------- -- -------
     @xmath      (148)
  -- -------- -- -------

Furthermore, rewrite the pair distribution in Eq. ( 144 ) as

  -- -------- -- -------
     @xmath      (149)
  -- -------- -- -------

using @xmath and @xmath for small scaled times. Here @xmath is the
probability of creating one entangled photon-pair. Are these probability
distributions distinguishable? Naively one would say that for
sufficiently weak down-conversion (i.e., when @xmath ) these
distributions largely coincide, so that instead of the complicated
pair-distribution ( 149 ) we can use the Poisson distribution, which is
much easier from a mathematical point of view. The distributions are
distinguishable when the ‘difference’ between them is larger than the
size of an average statistical fluctuation of the difference. This
fluctuation depends on the number of samplings.

Consider two nearby discrete probability distributions @xmath and @xmath
. A natural difference between these distributions is given by the
so-called (infinitesimal) statistical distance @xmath [ 177 , 29 , 84 ]
(see also appendix \thechapter ):

  -- -------- -- -------
     @xmath      (150)
  -- -------- -- -------

When the typical statistical fluctuation after @xmath samplings is
@xmath , the two probability distributions are distinguishable if:

  -- -------- -- -------
     @xmath      (151)
  -- -------- -- -------

The statistical distance between ( 148 ) and ( 149 ), and therefore the
distinguishability criterion is:

  -- -------- -- -------
     @xmath      (152)
  -- -------- -- -------

On the other hand, the average number of trials in the teleportation
experiment required to get one photon-pair from both down-converters is:

  -- -------- -- -------
     @xmath      (153)
  -- -------- -- -------

The minimum number of trials in the experiment thus almost immediately
renders the two probability distributions distinguishable, and we
therefore cannot approximate the actual probability distribution with
the Poisson distribution.

Since the Poisson distribution in Eq. ( 148 ) is derived by requiring
statistical independence of @xmath pairs and the pair distribution is
distinguishable from the Poisson distribution, the photon-pairs cannot
be considered to be independently produced, even in the weak limit .

This concludes my study of parametric down-conversion here. I will now
return to the problem of maximal entanglement creation in quantum
optics.

#### 10 The creation of maximal entanglement

Now that I have investigated the properties of one of the most common
entanglement sources, i.e., down-conversion, I am ready to consider the
creation of maximal, or event-ready, entanglement. The optical circuits
discussed here consist of so-called passive and active components. The
passive components leave the photon-number invariant, i.e., they
correspond to unitary operators which commute with the number operator.
Examples of such components are beam-splitters, phase-shifters and
polarisation rotators.

Active components correspond to unitary evolutions which do not commute
with the photon-number operator, like the parametric down-converter.
Other examples of active components are single-mode squeezers and pumped
@xmath media [ 5 ] . They can generally be characterised by an
interaction Hamiltonian which is a polynomial function of creation and
annihilation operators. Later in this chapter I will restrict the
discussion to interaction Hamiltonians which are quadratic in these
operators.

In this section, I will first show that the creation of maximal
entanglement with only passive components from a pure separable state is
impossible. Then, a general condition for an optical setup is derived,
which should be satisfied in order to yield event-ready entanglement. I
subsequently examine this condition for a specific class of optical
circuits.

##### 10.1 Passive optical components

So far, I have hardly paid attention to passive optical components. In
this section I will show that they cannot transform a completely
separable state of two photons into a maximally entangled state.

Suppose we have a linear interferometer which consists only of passive
components. Such an interferometer is described by a unitary matrix
@xmath [ 140 ] , which transforms the creation operators of the
electro-magnetic field according to

  -- -------- -- -------
     @xmath      (154)
  -- -------- -- -------

where the @xmath are the components of @xmath and @xmath enumerate both
the modes and polarisations. There is no mixing between the creation and
annihilation operators, because photons do not interact with each other.
I will now show that we cannot create maximal (event-ready) entanglement
with such linear interferometers when the input state is a separable
state.

Without loss of generality I consider the separable state @xmath . In
order to create maximal entanglement, the creation operators should be
transformed according to

  -- -------- -- -------
     @xmath      (155)
  -- -------- -- -------

Relabel the modes @xmath , @xmath , @xmath and @xmath as @xmath to
@xmath respectively. Without loss of generality (and leaving the
normalisation aside for the moment) we can then write

  -- -------- -- -------
     @xmath      (156)
  -- -------- -- -------

Substituting Eq. ( 154 ) into Eq. ( 156 ) generates ten equations for
eight variables @xmath :

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (158)
                                   
     @xmath   @xmath   @xmath      (159)
     @xmath   @xmath   @xmath      (161)
                                   
     @xmath   @xmath   @xmath      (162)
     @xmath   @xmath   @xmath      (163)
  -- -------- -------- -------- -- -------

It can be easily verified that there are no solutions for the @xmath
which satisfy these ten equations simultaneously: since @xmath , choose
@xmath and @xmath . From the fourth line above follows that @xmath .
Hence @xmath . The second line (second equation) then determines @xmath
, which (third line, second equation) implies that @xmath . We already
set @xmath , so we obtain @xmath . We now derive a contradiction between
@xmath , @xmath and the last line of the set of equations above. This
means that there is no passive interferometer which transforms pure
separable states into maximal (event-ready) entangled states.

##### 10.2 General optical circuits

In order to make @xmath , I will assume that we have several resources
at our disposal. The class of elements will consist of beam-splitters,
phase-shifters, photo-detectors and non-linear components such as
down-converters, squeezers, etc. These elements are then arranged to
give a specific optical circuit (see Fig. 5 ). Part of this setup might
be so-called feed-forward detection. In this scheme the outcome of the
detection of a number of modes dynamically chooses the internal
configuration of the subsequent optical circuit based on the interim
detection results (see also Ref. [ 114 ] ). Conditioned on these
detections we want to obtain a freely propagating @xmath Bell state in
the remaining undetected modes.

I now introduce two simplifications for such an optical circuit. First,
I will show that we can discard feed-forward detection. Secondly, we
only have to consider the detection of modes with at most one photon.

  Theorem 1:  

    In order to show that it is possible to produce a specific outgoing
    state, any optical circuit with feed-forward detection can be
    replaced by a fixed optical circuit where detection only takes place
    at the end.

  Proof:  

    Suppose a feed-forward optical circuit (like the one depicted in
    Fig. 5  a) giving @xmath exists. That means that the circuit creates
    @xmath conditioned on one of potentially many patterns of detector
    responses. It is sufficient to consider a single successful pattern.
    We can then take every interferometer to be fixed and postpone all
    detections of the auxiliary modes to the very end (Fig. 5 b). Note
    that this procedure selects generally only one setup in which
    entanglement is produced, whereas a feed-forward optical circuit
    potentially allows more setups. It therefore might reduce the
    efficiency of the process. However, since we are only interested in
    the possibility of creating @xmath , the efficiency is irrelevant.
    @xmath

  Theorem 2:  

    Suppose an optical circuit produces a specific outgoing state
    conditioned on @xmath detected photons in mode 1, @xmath detected
    photons in mode 2, etc. (with @xmath ). The same output can be
    obtained by a circuit where in every detected mode at most one
    photon is found.

  Proof:  

    If there are more photons in a mode, we can replace the
    corresponding detector by a so-called detector cascade [ 103 ] .
    This device splits the mode into many modes which are all detected
    (see also chapter \thechapter ). For a sufficiently large cascade
    there is always a non-vanishing probability to have at most one
    photon in each outgoing mode. In that case, the same state is
    created while at most one photon enters each detector. Note that
    this again yields a lower efficiency. @xmath

Applying these results to the creation of @xmath , it is sufficient to
consider a single fixed interferometer acting on an incoming state,
followed at the end by detection of the so-called auxiliary modes.
@xmath is signalled by at least one fixed detection pattern with at most
one photon in each detector.

How do I proceed in trying to make the @xmath Bell state? Let the time
independent interaction Hamiltonian @xmath incorporate both the
interferometer @xmath and the creation of @xmath (see Fig. 5 b). The
outgoing state prior to the detection can be formally written as

  -- -------- -- -------
     @xmath      (164)
  -- -------- -- -------

with @xmath the vacuum. This defines an effective Hamiltonian @xmath
which is generally not unique.

##### 10.3 The Bargmann representation

At this point it is useful to change the description. Since the creation
and annihilation operators satisfy the same commutation relations as
c-numbers and their derivatives, we can make the substitution @xmath and
@xmath , where @xmath . Furthermore, we define @xmath . Quantum states
are then represented by functions of c-numbers and their derivatives.
This is called the Bargmann representation [ 9 ] .

Furthermore, suppose we can normal order the operator @xmath in Eq. (
164 ). This would yield a function of only the creation operators,
acting on the vacuum. In the Bargmann representation we then obtain a
function of complex numbers without their derivatives. In particular, an
optical circuit consisting of @xmath distinct modes (for notational
convenience I treat distinct polarisations like, for instance, @xmath
and @xmath as separate modes), can be written as a function @xmath after
the unitary evolution @xmath and normal ordering. The normal ordering of
the evolution operator in conjunction with the vacuum input state is
crucial, since it allows a significant simplification of the problem.

I now treat the (ideal) detection of the auxiliary modes in the Bargmann
representation. Suppose the outgoing state after the detection of @xmath
photons emerges in modes @xmath , @xmath , @xmath and @xmath . After a
suitable reordering of the detected modes the state which is responsible
for the detector coincidence indicating success can be written as @xmath
(possibly on a countably infinite number of modes). We then obtain the
post-selected state @xmath

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (165)
              @xmath   @xmath      (166)
  -- -------- -------- -------- -- -------

In the Bargmann representation the right-hand side of Eq. ( 165 ) is

  -- -------- -- -------
     @xmath      (167)
  -- -------- -- -------

where I have written @xmath .

Writing out the entanglement explicitly in the four modes (treating the
polarisation implicitly), I arrived at the following condition for the
creation of two photons in the antisymmetric Bell state:

  -- -------- -- -------
     @xmath      (168)
  -- -------- -- -------

The term @xmath will allow for a small pollution ( @xmath ) in the
outgoing state. I will show that for certain special classes of
interaction Hamiltonians this condition is very hard (if not impossible)
to satisfy. This renders the experimental realisation of two maximally
polarisation entangled photons at least highly impractical.

##### 10.4 Physical limitations on event-ready entanglement

I am now ready to shape @xmath in more detail. Consider optical circuits
including mode-mixing, squeezers and down-converters. The corresponding
interaction Hamiltonians @xmath are quadratic in the creation operators.
There are no linear terms, so there are no coherent displacements. More
formally

  -- -------- -- -------
     @xmath      (169)
  -- -------- -- -------

With @xmath and @xmath complex matrices (see also Appendix \thechapter
for more details about the dependence of @xmath on @xmath ). According
to Braunstein [ 35 ] , such an active interferometer is equivalent to a
passive interferometer @xmath , followed by a set of single-mode
squeezers and another passive interferometer @xmath . The photon source
described by Eq. ( 169 ) can be viewed as an active bilinear component
of an interferometer. For vacuum input and after normal ordering [ 164 ]
, the optical setup then gives rise to

  -- -------- -- -------
     @xmath      (170)
  -- -------- -- -------

with @xmath . Such an optical setup would correspond to a collection of
single-mode squeezers acting on the vacuum, followed by a passive
optical interferometer @xmath . Here, @xmath is a complex symmetric
matrix determined by the interaction Hamiltonian @xmath and the
interferometer @xmath . We take @xmath to be proportional to a common
coupling constant @xmath . The outgoing auxiliary modes @xmath to @xmath
are detected (see Fig. 6 ). I will now investigate whether the
production of @xmath conditioned on a given number of detected photons
is possible.

In the case of a bilinear interaction Hamiltonian (see Eq. ( 169 )),
photons are always created in pairs. In addition, we seek to create two
maximally entangled photons. An odd number of detected photons can never
give @xmath and the number of detected photons should therefore be even.
The lowest even number is zero. In this case no photons are detected and
@xmath in Eq. ( 170 ) is proportional to @xmath , which corresponds to
the vacuum state.

The next case involves two detected photons. To have entanglement in
modes @xmath to @xmath after detecting two photons requires

  -- -------- -- -------
     @xmath      (171)
  -- -------- -- -------

The left-hand side of Eq. ( 171 ) is equal to

  -- -------- -- -------
     @xmath      (172)
  -- -------- -- -------

To satisfy Eq. ( 171 ), the vacuum contribution @xmath would have to be
negligible. I now investigate whether the second term can give us
entanglement. The right hand side of Eq. ( 171 ) can be rewritten
according to @xmath , where @xmath are the elements of a symmetric
matrix @xmath :

  -- -------- -- -------
     @xmath      (173)
  -- -------- -- -------

from which it is immediate that seen that @xmath .

Let @xmath . Since only the symmetric part of @xmath contributes,
consider @xmath . The condition for two detected photons now yields

  -- -------- -- -------
     @xmath      (174)
  -- -------- -- -------

If this equality is to hold, we need @xmath . However, it can be shown
that @xmath . @xmath can therefore never have the same form as @xmath
for small @xmath , so it is not possible to create maximal polarisation
entanglement conditioned upon two detected photons.

Finally, consider the outgoing state conditioned on four detected
photons. Define @xmath . The left-hand side of Eq.  ( 168 ) for four
detected photons then gives

  -- -- -- -------
           (175)
  -- -- -- -------

I have not been able either to prove or disprove that @xmath can be made
this way. The number of terms which contribute to the bilinear part in
@xmath rapidly increases for more detected photons.

Suppose we could create maximal entanglement conditioned upon four
detected photons, how efficient would this process be? For four detected
photons yielding @xmath we need at least three photon-pairs. These are
created with a probability of the order of @xmath . Currently, @xmath ,
the probability per mode, has a value of @xmath [ 173 ] . For
experiments operating at a repetition rate of 100 MHz using ideal
detectors, the procedure conditioned on four detected photons will
amount to approximately one maximally entangled pair every few hours.
For realistic detectors this is much less.

So far, there have been no experiments which exceeded the detection of
more than two auxiliary photons (not including the actual detection of
the maximally entangled state). This, and the estimation of the above
efficiency appears to place strong practical limitations on the creation
of maximal entanglement.

##### 10.5 Six detected photons

Recently, Knill, Laflamme and Milburn have discovered a method which
allows us to create event-ready entanglement conditioned on six detected
photons [ 98 ] . This method involves the construction of the C-SIGN
operator

  -- -- -- -------
           (176)
  -- -- -- -------

on the basis @xmath . In quantum optics, these two qubits are defined on
four distinct modes @xmath , @xmath , @xmath and @xmath .

The C-NOT @xmath is then defined using the Hadamard transform @xmath on
modes @xmath and @xmath as

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (178)
                                   
              @xmath               (180)
                                   
              @xmath               (181)
  -- -------- -------- -------- -- -------

Applying the C-NOT and the Hadamard transformation on a separable state
yields a maximally entangled state.

How do we construct the C-SIGN operator? Following Knill et al . this
amounts to the construction of the operator

  -- -------- -- -------
     @xmath      (182)
  -- -------- -- -------

First, we apply a beam-splitter @xmath :

  -- -- -- -------
           (183)
  -- -- -- -------

with @xmath to modes @xmath and @xmath , which transforms @xmath into
@xmath . Subsequently, we apply the operator @xmath to modes @xmath and
@xmath , and finally, we apply a beam-splitter @xmath again to these
modes.

The operator A is defined as a unitary transformation @xmath on three
modes, one main mode and two auxiliary modes which are detected:

  -- -- -- -------
           (184)
  -- -- -- -------

This transformation can be explicitly constructed using the techniques
developed by Reck et al . [ 140 ] . The input state on the two auxiliary
modes @xmath and @xmath is @xmath , and the operator is conditioned on a
state @xmath in the outgoing auxiliary modes. This post-selection means
that @xmath is a probabilistic operator with a probability of success of
1/4.

Event-ready entanglement can now be created using the setup shown in
figure 7 . The incoming state is given by @xmath , which can be made
conditioned on two detected photons. The input states on the auxiliary
modes can be created conditioned on one detected photon and the outgoing
auxiliary modes also involve one detected photon. Therefore the total
number of detected photons is six.

#### 11 Summary

I have demonstrated strong limitations on the possibility of creating
maximal entanglement with quantum optics. To this end, I introduced two
simplifications to the hypothetical optical circuit: I replaced
feed-forward detection by a fixed set of detectors at the end, and
secondly, every detector needs to detect at most one photon. Conditioned
on two detected photons, multi-mode squeezed vacuum fails to create
maximal entanglement.

What happens when we have a combination of squeezing and coherent
displacements? In that case the approach taken here fails due to the
more complex normal ordering of the interaction Hamiltonian. Also, I
have only considered ideal detections, but how do realistic detectors
affect the outgoing state? This is the subject of the next chapter.

### Chapter \thechapter Auxiliary Resources: Detection Devices

Wouldn’t it be nice to have a machine which creates the quantum states
of your choice at the push of a button? Unfortunately, these machines do
not yet exist ¹⁵ ¹⁵ 15 Quantum computers will be able to make such
states for qubits. . There are currently machines which create certain
specific states, like for instance lasers (creating coherent states) and
down-converters (creating squeezed states), but notwithstanding their
importance for scientific and technological applications, these devices
create only a limited class of quantum states.

When we want to create more exotic quantum states, we need to extend our
resources: in addition to the devices mentioned above we may use passive
transformations (like, for instance, beam-splitters and phase-shifters
in quantum optics) and measurements . With this new set of tools we can
build more sophisticated state preparation devices, or ‘circuits’. As I
have shown in the previous chapter, depending on the particular physical
implementation of these circuits we can create more exotic quantum
states. State preparation has been studied among others by Vogel et al .
[ 168 ] , Harel et al . [ 81 ] , Dakna et al . [ 46 ] and Rubin [ 143 ]
.

Having extended our resources to state preparation circuitry, the next
issue is the quality of the state preparation. Suppose we want to create
a particular state. In practice, we can never obtain this state
perfectly, due to uncontrollable effects like decoherence and
measurement errors. Nevertheless, we want our maximise the quality of
the state preparation process.

Formulating this more precisely, we want to prepare a single (pure)
state @xmath by means of some process, and we want the resulting state
@xmath to be as ‘close’ to @xmath as possible. In chapter \thechapter we
have seen that a measure of resemblance between states is given by the
fidelity @xmath :

  -- -------- -- -------
     @xmath      (185)
  -- -------- -- -------

The quality of a state preparation process can therefore be measured by
the fidelity. When @xmath , the process gives exactly @xmath and when
@xmath , the prepared state is orthogonal to @xmath . In practice, the
fidelity will not reach these extreme measures, but will lie between 0
and 1.

In short, we have a state preparation circuit which creates states with
some fidelity. Generally, the preparation process is conditioned on
measurements [ 97 ] . For example, if we want to prepare a single-photon
state @xmath in quantum optics we can use the following process: a
parametric down-converter creates a state @xmath on two spatial modes
@xmath and @xmath (see chapter \thechapter ):

  -- -------- -- -------
     @xmath      (186)
  -- -------- -- -------

where @xmath denotes the vacuum state and we assume @xmath . The higher
order terms (included in @xmath ) consist of states with more than two
photons. We now place a photo-detector in mode @xmath , which ‘clicks’
when it sees one or more photons (typically, standard detectors can see
single photons, but fail to distinguish between one and two photons).
Conditioned on such a click, mode @xmath will be in a state

  -- -------- -- -------
     @xmath      (187)
  -- -------- -- -------

The fidelity of this process is high: @xmath , and this is therefore
typically a very good single-photon state preparation process (although
the situation changes drastically when multiple down-converters are
considered [ 32 , 99 ] ). Due to the large vacuum contribution, however,
the probability of the detector giving a ‘click’ will be small (of order
@xmath ). When the detector does not click, that particular trial is
dismissed, hence the conditional character of the detection.

In this example the outcome of the detection is used to either accept or
reject a particular run of the state preparation device. However, in
general the outcome of the detector can be used to determine a more
complicated operation on the remainder of the state preparation process.
This is detection plus feed-forward , since the outcome is used further
on in the process. An example of this is quantum teleportation, where
the outcome of the Bell measurement determines the unitary
transformation needed to retrieve the original input state.

When the measurements in the state preparation process are prone to
errors, the state we want to create may not be the state we actually
create. This means that errors in the detection devices can lead to
reduced fidelities. In this chapter I study the effect of detection
errors on state preparation. To this end I introduce the concept of the
confidence of preparation. Using this measure I evaluate different types
of detection devices. This chapter is based on Kok and Braunstein [ 103
] .

#### 12 Confidence

Consider a preparation device which prepares a state conditioned on a
single measurement. For simplicity, I employ two subsystems. One
subsystem will be measured, leaving a quantum state in the other. It is
clear that prior to the measurement the two systems have to be
entangled. Otherwise conditioning on the measurement does not have any
effect on the state of the second system.

We can write the total state @xmath prior to the measurement in the
Schmidt decomposition:

  -- -------- -- -------
     @xmath      (188)
  -- -------- -- -------

with @xmath and @xmath orthonormal sets of states for system 1 and 2
respectively. These states correspond to eigenstates of observables
@xmath and @xmath with sets of eigenvalues @xmath and @xmath
respectively. We now measure the observable @xmath in system 1, yielding
an outcome @xmath (see Fig. 8 ).

We can model this measurement using so-called projection operator valued
measures, or POVM’s for short. For ideal measurements, we can describe
the measurement of mode 1 as a projection @xmath operating on the state
@xmath . When we trace out the first system the (normalised) state of
the second system will be

  -- -------- -- -------
     @xmath      (189)
  -- -------- -- -------

For non-ideal measurements we do not use a projection operator, but
rather a projection operator valued measure . In general, a POVM @xmath
can be written as

  -- -------- -- -------
     @xmath      (190)
  -- -------- -- -------

where the @xmath ’s form a set ¹⁶ ¹⁶ 16 This set is possibly
over-complete, hence the difference in notation from @xmath . of
projection operators @xmath . We also require a completeness relation

  -- -------- -- -------
     @xmath      (191)
  -- -------- -- -------

a more general definition of POVM’s is given by (see appendix
\thechapter ):

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (192)
              @xmath   @xmath      (193)
  -- -------- -------- -------- -- -------

The operator @xmath is generally not unique. These POVM’s are used to
model non-ideal measurements.

As mentioned before, a measurement outcome @xmath in mode 1 gives rise
to an outgoing state @xmath in mode 2. We cannot describe a non-ideal
measurement with the projection @xmath . Instead, we have a POVM @xmath
(corresponding to the outcome @xmath ), which reduces to @xmath in the
case of an ideal measurement. Let @xmath , the entangled state prior to
the measurement. The outgoing state in mode @xmath will then be

  -- -------- -- -------
     @xmath      (194)
  -- -------- -- -------

where the total trace over both systems in the denominator gives the
proper normalisation.

If we had an ideal detector (corresponding to @xmath ), the outgoing
state would be @xmath . However, with the general POVM @xmath , this
will not be the case. The resulting state will be different. In order to
quantify the reliability of a state preparation process I introduce the
confidence of a process.

  Definition:  

    The confidence in the preparation of a particular state is given by
    the fidelity of the preparation process.

That means that using Eqs. ( 188 ) and ( 194 ) the confidence @xmath is
given by

  -- -------- -- -------
     @xmath      (195)
  -- -------- -- -------

where the @xmath are the diagonal elements of the density matrix. The
confidence @xmath can be interpreted as the probability of obtaining
outcome @xmath from the ‘branch’ containing @xmath in Eq. ( 188 )
divided by the unconditional probability of obtaining outcome @xmath .
We will also call this the ‘confidence of state preparation’.

This interpretation suggests that there does not need to be a second
system to give the idea of confidence meaning. Suppose, for instance,
that we have an ‘electron factory’ which produces electrons with random
spin. A Stern-Gerlach apparatus in the path of such an electron will
make a spin measurement along a certain direction r . Suppose we find
that the electron has spin ‘up’ along r . Before this measurement the
electron was in a state of random spin ( @xmath ), and after the
measurement the electron is in the ‘spin up’ state ( @xmath ). The state
of the electron has collapsed into the ‘spin up’ state. I will now
investigate how we can define the confidence of the detection of a
single system.

Formally, we can model state collapse by means of the super-operator
@xmath , where @xmath is again the outcome of the measurement of
observable @xmath (‘spin up’ in the above example). In general, a
super-operator yields a (non-normalised) mapping @xmath . In the POVM
representation used above (see Eq. ( 192 )) we can write this as

  -- -------- -- -------
     @xmath      (196)
  -- -------- -- -------

When the eigenstate corresponding to @xmath is given by @xmath , we can
define the confidence of this measurement as

  -- -------- -- -------
     @xmath      (197)
  -- -------- -- -------

with @xmath the proper normalisation. However, this expression depends
strongly on the details of the family of operators @xmath . This is a
more complicated generalisation than the POVM’s @xmath . The confidence
of state preparation, on the other hand, is a function of the POVM
@xmath . Furthermore, @xmath will in general not be equal to the
confidence of state preparation derived in Eq.  ( 195 ).

In conclusion, there are two distinct versions of the confidence: the
confidence of measurement and the confidence of state preparation .
Later in this chapter I will use the concept of the confidence to make a
quantitative comparison between different detection devices. This
suggests that we need to calculate the confidence of measurement with
all its difficulties. One way to circumvent this problem is to calculate
the the confidence of state preparation using a fixed state. Instead of
concentrating on the state preparation process we now choose a standard
input state and calculate the confidence for different types of
measurement devices. One such choice might be the maximally entangled
state

  -- -------- -- -------
     @xmath      (198)
  -- -------- -- -------

When @xmath , this is perhaps not the ideal choice and another state may
be preferred. For any choice, the confidence offers a quantitative
measure of performance for different types of measurement devices.

#### 13 Optical detection devices

Having set the stage for state preparation conditioned on measurement
outcomes, I will now restrict the remainder of this chapter to optical
implementations. Let’s consider the measurement of optical Fock states
using photo-detectors. In order to classify different types of detectors
I use the following terminology: a detector is said to have a
single-photon sensitivity when it is sensitive enough to detect a
single-photon wave-packet. When a detector can distinguish between
@xmath - and @xmath -photon wave-packets, it is said to have a
single-photon resolution .

Real detectors have a variety of characteristics. Most common detectors
do not have single-photon resolution, although they can distinguish
between a few and many photons. When small photon numbers are detected,
however, these are single-photon sensitivity detectors to a good
approximation. There are also single-photon resolution detectors [ 93 ,
162 ] . Currently, these detectors require demanding operating
conditions.

When we need single-photon resolution but do not have the resources to
employ single-photon resolution detectors, we can use a so-called
detector cascade [ 158 ] . In a detector cascade an incoming mode
(populated by a number of photons) is split into @xmath output modes
with equal amplitude which are all detected with single-photon
sensitivity detectors. The idea is to choose the number of output modes
large enough, so that the probability that two photons enter the same
detector becomes small. In general, an optical setup which transforms
@xmath incoming modes into @xmath outgoing modes is called an @xmath
-port (see Fig. 9 ) [ 140 ] . A detector cascade is a symmetric @xmath
-port with detectors at the outgoing modes and vacuum states in all
input modes except the first mode. In the next section I will study the
statistics of symmetric @xmath -ports, but first I need to elaborate on
the types of errors which occur in detectors.

There are two sources of errors for a detector: it might fail to detect
a photon, or it might give a signal although there wasn’t actually a
photon present. The former may be characterised as a ‘detector loss’ and
the latter as a ‘dark count’. Here, the emphasis will be on detector
losses. Later I will give a model for incorporating dark counts in a
realistic detector model. In some experiments (like the Innsbruck
teleportation experiment [ 23 ] ) the detectors operate within short
gated time intervals. This greatly reduces the effect of dark counts.

Detector losses are not so easily dismissed. Every photon entering a
detector has a certain probability of triggering it. This probability is
called the efficiency of the detector. For the purposes of brevity, when
a detector is perfectly efficient, we will call it a unit-efficiency
detector. When it has some lower efficiency, we speak of a
finite-efficiency detector. Here, I study detector cascading with
unit-efficiency detectors, as well as cascading with finite-efficiency
detectors [ 181 ] . I am interested in the case where cascading
distinguishes between photon-number states @xmath and @xmath with @xmath
.

#### 14 N-ports

In this section I treat the properties of detector cascades, or
symmetric @xmath -ports with single-photon sensitivity detectors in the
outgoing modes. Symmetric @xmath -ports yield a (unitary) transformation
@xmath of the spatial field modes @xmath , with @xmath :

  -- -------- -- -------
     @xmath      (199)
  -- -------- -- -------

where the incoming modes of the @xmath -port are denoted by @xmath and
the outgoing modes by @xmath . Here, @xmath and @xmath are the
respective creation and annihilation operators of mode @xmath .
Similarly for mode @xmath . The unitary matrix @xmath can be chosen to
be

  -- -------- -- -------
     @xmath      (200)
  -- -------- -- -------

without loss of generality up to an overall phase-factor. Paul et al . 
have studied such devices in the context of tomography and homodyne
detection [ 157 , 4 , 129 ] .

Here, I study @xmath -ports in the context of optical state preparation,
where only one copy of a state is given, instead of an ensemble. I will
use the concept of the confidence , introduced in section 12 .

##### 14.1 Statistics of N-ports

Suppose we have a detector cascade, consisting of a symmetric @xmath
-port with single-photon sensitivity detectors in the outgoing modes.
According to Eqs. ( 199 ) and ( 200 ) incoming photons will be
redistributed over the outgoing modes. In this section I study the
photon statistics of this device. In particular, I study the case where
@xmath photons enter a single input mode of the @xmath -port, with
vacuum in all other input modes. This device (i.e., the detector
cascade) will act as a sub-ideal single-photon resolution detector since
there is a probability that some of the photons end up in the same
outgoing mode, thus triggering the same detector.

To quantify the single-photon resolution of the cascade we use the
confidence given by Eq. ( 195 ). Suppose we have two spatially separated
entangled modes of the electro-magnetic field @xmath and @xmath with
number states @xmath in @xmath and some other orthogonal states @xmath
in @xmath :

  -- -------- -- -------
     @xmath      (201)
  -- -------- -- -------

where the second mode is used only to give the confidence an operational
meaning. The POVM governing the detection can be written as @xmath ,
since we assume that the photons are not lost in the @xmath -port. In
this expression @xmath is the probability that @xmath incoming photons
cause a @xmath -fold detector coincidence in the @xmath -port cascade.
The confidence can then be written as

  -- -------- -- -------
     @xmath      (202)
  -- -------- -- -------

In order to find the confidence, I therefore first have to calculate the
probability distribution @xmath . This will allow us to compare
single-photon resolution detectors with various arrangements ( @xmath
-ports) of single-photon sensitivity detectors.

Suppose @xmath photons enter the first input mode and all other input
modes are in the vacuum state. The density matrix of the pure input
state @xmath will be transformed according to @xmath with @xmath the
unitary transformation associated with the symmetric @xmath -port. Let
@xmath be the @xmath -tuple of the photon number in every outgoing mode:
@xmath . The probability of finding @xmath photons in mode 1 and @xmath
photons in mode 2, et cetera, is given by @xmath . Using the @xmath
-port transformation this probability yields

  -- -------- -- -------
     @xmath      (203)
  -- -------- -- -------

where @xmath , since only the first input mode inhabits photons and the
rest are vacuum. From Refs. [ 53 ] and [ 54 ] we find that this can be
rewritten as

  -- -------- -- -------
     @xmath      (204)
  -- -------- -- -------

Here, @xmath is a so-called multi-dimensional Hermite polynomial (MDHP)
[ 52 ] (this is a non-trivial result; see appendix \thechapter for a
comprehensive treatment of multi-dimensional Hermite polynomials) and
the matrix @xmath is defined as

  -- -------- -- -------
     @xmath      (205)
  -- -------- -- -------

For our present purposes it is convenient to characterise the @xmath
-port by its transformation of the field modes given by Eqs. ( 199 ) and
( 200 ). I therefore concentrate on @xmath rather than @xmath .

Since there is a one-to-one correspondence between the @xmath -port (
@xmath ) and the matrix @xmath , knowledge of @xmath is sufficient to
calculate the confidence of a given event using the @xmath -port. The
MDHP for @xmath input modes with @xmath photons in the first mode and
zero in the others (giving an @xmath -tuple @xmath ) and @xmath output
modes @xmath is given by

  -- -------- -- -------
     @xmath      (206)
  -- -------- -- -------

where @xmath , @xmath and

  -- -------- --
     @xmath   
  -- -------- --

The number of photons in the input mode is equal to the total number of
photons in the output modes. The dimension of @xmath obeys @xmath . For
example, for a two-photon input state we have

  -- -------- -- -------
     @xmath      (207)
  -- -------- -- -------

There are many different ways in which @xmath incoming photons can
trigger a @xmath -fold detector coincidence. These different ways
correspond to different photon distributions in the outgoing (detected)
modes, and are labelled by @xmath . The probability that all @xmath
photons enter a different detector is found by determining the @xmath s
where every @xmath in @xmath is at most one. The sum over all these
@xmath ’s is equal to the probability @xmath of a @xmath -fold
coincidence in an @xmath -port conditioned on @xmath incoming photons:

  -- -------- -- -------
     @xmath      (208)
  -- -------- -- -------

Finally, in order to find the probability of a @xmath -fold detector
coincidence conditioned on @xmath photons in the input state (with
@xmath ) we need to sum all probabilities in Eq. ( 204 ) with @xmath
non-zero entries in the @xmath -tuple @xmath :

  -- -------- -- -------
     @xmath      (209)
  -- -------- -- -------

where @xmath is the set of all @xmath with exactly @xmath non-zero
entries.

##### 14.2 Realistic N-ports

I now consider a symmetric @xmath -port cascade with finite-efficiency
single-photon sensitivity detectors. Every one of the @xmath detectors
has a certain loss, which means that some photons do not trigger the
detector they enter. We can model this situation by putting a
beam-splitter with intensity transmission coefficient @xmath in front of
the ideal detectors [ 181 ] . The reflected photons are sent into the
environment and can be associated with the loss. The transmitted photons
are detected (see Fig. 10 ).

Before I continue with the description of realistic detector cascades,
let me return to the question of the dark counts. In the model for
detectors with finite efficiency I assumed a beam-splitter with
intensity transmission coefficient @xmath and vacuum in the second input
mode. We can now model dark counts by replacing this vacuum state with a
thermal input state @xmath [ 148 ] :

  -- -- -- -------
           (210)
  -- -- -- -------

with @xmath the frequency, @xmath the appropriate frequency distribution
( @xmath ), @xmath Boltzmann’s constant and @xmath the effective
temperature ‘seen’ by the detector. However, for the remainder of this
chapter I will assume that there are no dark counts ( @xmath ).

Let us now consider cascades with finite-efficiency detectors. The
implementation of the beam-splitters responsible for the detector losses
transform our @xmath -port into a @xmath -port and the unitary
transformation @xmath of the field modes in this @xmath -port now
becomes a @xmath unitary matrix @xmath (where @xmath is the two
dimensional unit matrix). Applying a transformation @xmath to implement
the beam-splitters with transmission coefficient @xmath will give a new
unitary transformation governing the behaviour of the @xmath -port.
Although nothing holds us from considering detectors with different
efficiencies, for simplicity I will assume that all detectors have the
same efficiency @xmath . In terms of the original unitary matrix @xmath
from Eq. ( 200 ) the new unitary matrix @xmath becomes

  -- -------- --
     @xmath   
  -- -------- --

This changes the matrix @xmath of the MDHP accordingly:

  -- -------- -- -------
     @xmath      (211)
  -- -------- -- -------

and @xmath is now a @xmath matrix dependent on @xmath . The probability
of finding a @xmath -fold detector coincidence in an @xmath -port
cascade with finite-efficient detectors then becomes

  -- -------- -- -------
     @xmath      (212)
  -- -------- -- -------

where @xmath is the set of all @xmath with exactly @xmath non-zero
entries in the detected modes (note that I still call it an @xmath -port
although technically it is a @xmath -port). The confidence of having a
total of @xmath photons in a @xmath -fold detector coincidence is again
given by Eq. ( 202 ). The variables of the MDHP will be a @xmath -tuple
@xmath . The output photon number @xmath -tuple can now be written as
@xmath , where the superscripts @xmath and @xmath again denote the
detected and undetected modes respectively. Furthermore we have @xmath
and @xmath .

Using Eq. ( 208 ) and observing that every detected photon carries a
factor @xmath it is quite straightforward to obtain the probability that
@xmath photons give a @xmath -fold coincidence in an efficient @xmath
-port cascade:

  -- -------- -- -------
     @xmath      (213)
  -- -------- -- -------

##### 14.3 The single-photon resolution of N-ports

Having determined the probability distribution @xmath , I can now
calculate the confidence of detector cascading. First of all, in order
to obtain a high confidence in the outcome of a detector cascade, the
possible number of photons should be much smaller than the number of
modes in the cascade: @xmath . In practice there is a limit to the
number of detectors we can build a cascade with, so I only look at the
lowest order: distinguishing between one and two photons.

I will calculate the confidence of having outgoing state @xmath
conditioned a single detector giving a ‘click’ in the detector cascade
when the input state is given by

  -- -------- -- -------
     @xmath      (214)
  -- -------- -- -------

This state corresponds, for example, to the output of a down-converter
when we ignore higher-order terms. The confidence is then

  -- -------- -- -------
     @xmath      (215)
  -- -------- -- -------

Eqs. ( 212 ) and ( 207 ) allow us to calculate the probabilities of a
zero-, one- and two-fold detector coincidence conditioned on one or two
incoming photons:

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (216)
     @xmath   @xmath   @xmath      (218)
                                   
     @xmath   @xmath   @xmath      (219)
     @xmath   @xmath   @xmath      (221)
                                   
     @xmath   @xmath   @xmath      (222)
     @xmath   @xmath   @xmath      (223)
     @xmath   @xmath   @xmath      (224)
  -- -------- -------- -------- -- -------

For example, using these probabilities, together with Eq. ( 214 ), gives
us an expression for the confidence that a single detector hit was
triggered by one photon ( @xmath ):

  -- -------- -- -------
     @xmath      (225)
  -- -------- -- -------

where, for simplicity, we omitted the functional dependence of @xmath on
the incoming state, the size of the cascade and the order of the
detector coincidence.

A close look at Eq. ( 223 ) shows us that @xmath includes a term which
is independent of the number of modes in the @xmath -port cascade. This
term takes on a maximum value of @xmath for @xmath . However, the
confidence is a monotonously increasing function of @xmath . As
expected, for small @xmath ’s the confidence @xmath approaches 1.
Detector cascading thus turns a collection of single-photon sensitivity
detectors into a device with some single-photon resolution. In the next
section I will give a quantitative estimation of this resolution.

#### 15 Comparing detection devices

Let’s return again to the schematic state preparation process depicted
in figure 8 . There we had two modes, one of which was detected, giving
the prepared outgoing state in the other. I argued that different
detection devices yield different output states, and the comparison of
these states with the ideal case (where we used an ideal detector) led
to the introduction of the confidence of a state preparation process.
Here, I will use the confidence to make a comparison of different
detection devices , rather than output states. This can be done by
choosing a fixed entangled input state. The confidence then quantifies
the performance of these detection devices.

Consider the state preparation process in the setting of quantum optics.
We have two spatial modes of the electro-magnetic field, one of which is
detected. In this thesis I am mostly interested in states containing a
few photons, and the detection devices I consider therefore include
single-photon sensitivity detectors, single-photon resolution detectors
and detector cascades. As an example, I set the task of distinguishing
between one and two photons. Since single-photon sensitivity detectors
are not capable of doing this, I will compare the performance of
detector cascading with that of a single-photon resolution detector. Let
the state prior to the detection be given by

  -- -------- -- -------
     @xmath      (226)
  -- -------- -- -------

This state is maximally entangled and will serve as our ‘benchmark’
state. It corresponds to the choice @xmath in the previous section.
Suppose the outgoing state conditioned on a ‘one-photon’ indication in
the detection device is @xmath . The confidence is then again given by
@xmath .

First, consider the single-photon resolution detector described in Refs.
[ 93 , 162 ] . This detector can distinguish between one and two photons
very well, but it does suffer from detector losses (the efficiency was
determined at 88%). That means that a two-photon state can be identified
as a single-photon state when one photon is lost. The confidence of this
detector is therefore not perfect.

In order to model the finite efficiency of the single-photon resolution
detector we employ the beam-splitter model from section 14.2 . We write
the input state as

  -- -------- -- -------
     @xmath      (227)
  -- -------- -- -------

When we make the substitution @xmath we obtain a state @xmath . The
outgoing density matrix conditioned on a single photon in mode @xmath is
then

  -- -------- -- -------
     @xmath      (228)
  -- -------- -- -------

With @xmath the confidence of the single-photon resolution detector is
easily calculated to be @xmath .

Now we consider a detector cascade with single-photon sensitivity
detectors. In Fig. 11 the confidence of a single-photon detection with
@xmath -port cascades is depicted. When the cascade consists of four
detectors ( @xmath ) it can be easily calculated from Eq. ( 225 ) that
the detectors need an efficiency of 0.84 to achieve a 0.65 confidence.
In the case of infinite cascading ( @xmath ) the single-photon
confidence of 0.65 is met only if the efficiency is roughly 0.73. This
puts a severe practical limit on the efficiency of the single-photon
sensitivity detectors in the cascade.

Detector cascading would be practically useful if a reasonably small
number of finite-efficiency detectors yields a high confidence. In
particular when cascading is viewed as an economical alternative to a
detector with single-photon resolution the number of detectors in the
cascade should be small. Additionally, cascading should yield a
confidence similar to single-photon resolution detectors. Unfortunately,
as a practical application, detector cascading only appears to yield a
modest boost in resolution, unless the detectors with single-photon
sensitivity have a very high efficiency. Real single-photon resolution
detectors are therefore superior to detector cascading with currently
available detectors, notwithstanding the demanding operating conditions.

#### 16 Summary

In this chapter I have studied the use of detection devices in
entanglement based state preparation. In particular I considered optical
devices such as single-photon sensitivity detectors, single-photon
resolution detectors and detector cascades.

Detector cascading has generally been regarded as a good way to enhance
single-photon resolution and consequently the fidelity of a state
preparation process [ 158 ] . However, an extensive theory for the use
of these detection devices has not been available so far. The statistics
of @xmath -ports have been considered in the context of tomography [ 129
] , which relies on the availability of a large number of copies of a
quantum state. In state preparation, however, we perform measurements on
single systems, and we therefore need precise bounds on the
distinguishability of these measurements.

To this end, I introduced the confidence of preparation, which can also
be used to quantify the performance of a detection device. Thus, I
compared a single-photon resolution detector with a cascade of
single-photon sensitivity detectors and found that cascading does not
give a practical advantage over detectors with single-photon resolution.

### Chapter \thechapter Mathematical Description of Optical Circuits

In the previous chapters, I have discussed state preparation in quantum
optics with realistic detectors. I now ask what the general outgoing
state of an optical circuit is.

Suppose we have an optical circuit, that is, a collection of connected
optical components. It is usually important to know what the outgoing
state of this circuit is. In this chapter, I give a description of the
outgoing state for a special class of optical circuits. First, in
section 17 , I define this class of optical circuits and show that they
can be described by so-called multi-dimensional Hermite polynomials. In
section 18 , I give an example of this description. Section 19 discusses
the Hermite polynomials, and finally, in section 20 , I briefly consider
the effect of imperfect detectors on the outgoing state. This chapter is
based on Kok and Braunstein [ 106 ] .

#### 17 The Optical Circuit

What do we mean by an optical circuit? We can think of a black box with
incoming and outgoing modes of the electro-magnetic field. The black box
transforms a state of the incoming modes into a (different) state of the
outgoing modes. The black box is what we call an optical circuit . We
can now take a more detailed look inside the black box. We will consider
three types of components.

First, the modes might be mixed by beam-splitters, or they may pick up a
relative phase shift or polarisation rotation. These operations all
belong to a class of optical components which preserve the photon
number. We call them passive optical components.

Secondly, we may find optical components such as lasers, down-converters
or (optical) parametric amplifiers in the black box. These components
can be viewed as photon sources, since they do not leave the photon
number invariant. We will call these components active optical
components.

And finally, the box will generally include measurement devices, the
outcomes of which may modify optical components on the remaining modes
depending on the detection outcomes. This is called feed-forward
detection. We can immediately simplify optical circuits using
feed-forward detection, by considering the family of fixed circuits
corresponding to the set of measurement outcomes (see also Ref. [ 100 ]
). In addition, we can postpone the measurement to the end, where all
the optical components have ‘acted’ on the modes.

These three component types have their own characteristic mathematical
description. A passive component yields a unitary evolution @xmath ,
which can be written as

  -- -------- -- -------
     @xmath      (229)
  -- -------- -- -------

where H.c. denotes the Hermitian conjugate. This unitary evolution
commutes with the total number operator @xmath .

Active components also correspond to unitary transformations, which can
be written as @xmath . Here @xmath is the interaction Hamiltonian
associated with the @xmath active component in a sequence. This
Hamiltonian does not necessarily commute with the total number operator.
To make a typographical distinction between passive and active
components, we denote the @xmath passive component by @xmath , and the
@xmath active component by its evolution in terms of the interaction
Hamiltonian. The mathematical description of the (ideal) measurement
will correspond to taking the inner product of the outgoing state prior
to the measurement with the eigenstate corresponding to the measurement.

##### 17.1 The state prior to detection

Now that we have the components of an optical circuit of @xmath modes,
we have to combine them into an actual circuit. Mathematically, this
corresponds to applying the unitary evolutions of the successive
components to the input state. Let @xmath be the input state and @xmath
the output state prior to the measurement. We then have (with @xmath
some integer)

  -- -------- -- -------
     @xmath      (230)
  -- -------- -- -------

where it should be noted that @xmath might be the identity operator
@xmath or a product of unitary transformations corresponding to passive
components:

  -- -------- -- -------
     @xmath      (231)
  -- -------- -- -------

When the (multi-mode) eigenstate corresponding to the measurement
outcome for a limited set of modes labelled @xmath with @xmath is given
by @xmath with @xmath the number of detected modes out of a total of
@xmath modes, and @xmath the number of photons found in mode @xmath ,
the state leaving the optical circuit in the undetected modes is given
by

  -- -------- -- -------
     @xmath      (232)
  -- -------- -- -------

In this chapter, I study the outgoing states @xmath for a special class
of optical circuits. First, I assume that the input state is the vacuum
on all modes. Thus, I effectively study optical circuits as state
preparation devices. Secondly, our class of optical circuits include all
possible passive components, but only active components with quadratic
interaction Hamiltonians:

  -- -------- -- -------
     @xmath      (233)
  -- -------- -- -------

where @xmath is some complex symmetric matrix. This matrix determines
the behaviour of the @xmath active component, which can be any
combination of down-converters and squeezers. Finally, we consider ideal
photo-detection, where the eigenstate corresponding to the measurement
outcome can be written as @xmath .

The class of optical circuits I consider here is not the most general
class, but it still includes important experiments like quantum
teleportation [ 23 ] , entanglement swapping [ 126 ] and the
demonstration of GHZ correlations [ 26 ] . In section 18 , I show how
teleportation can be modelled using the methods presented here.

The state @xmath prior to the photo-detection can be written in terms of
the components of the optical circuit as

  -- -------- -- -------
     @xmath      (234)
  -- -------- -- -------

The creation and annihilation operators @xmath and @xmath for mode
@xmath satisfy the standard canonical commutation relations

  -- -------- -- -------
     @xmath      (235)
  -- -------- -- -------

with @xmath .

For any unitary evolution @xmath , we have the relation

  -- -------- -- -------
     @xmath      (236)
  -- -------- -- -------

Furthermore, if @xmath is due to a collection of only passive
components, such an evolution leaves the vacuum invariant: @xmath .
Using these two properties it can be shown that Eq. ( 234 ) can be
written as

  -- -------- -- -------
     @xmath      (237)
  -- -------- -- -------

where @xmath is some complex symmetric matrix and @xmath . I will now
simplify this expression by normal-ordering this evolution.

Define @xmath . As shown by Braunstein [ 35 ] , we can rewrite Eq. ( 237
) using two passive unitary transformations @xmath and @xmath as:

  -- -------- -- -------
     @xmath      (238)
  -- -------- -- -------

where @xmath is a diagonal matrix with real non-negative eigenvalues
@xmath . This means that, starting from vacuum, the class of optical
circuits I consider here is equivalent to a set of single-mode
squeezers, followed by a passive unitary transformation @xmath and
photo-detection. Since @xmath is diagonal, we can write Eq. ( 238 ) as

  -- -------- -- -------
     @xmath      (239)
  -- -------- -- -------

We can now determine the normal ordering of every factor @xmath
separately. Note that the operators @xmath , @xmath and @xmath generate
an su(1,1) algebra. According to Refs. [ 180 , 60 , 164 ] , this may be
normal-ordered as

  -- -------- -- -------
     @xmath      (240)
  -- -------- -- -------

where @xmath . In general, when @xmath and @xmath are generators of an
@xmath algebra (i.e., when @xmath is unitary) we find [ 164 ]

  -- -------- -- -------
     @xmath      (241)
  -- -------- -- -------

with @xmath a complex coupling constant and @xmath its orientation in
the complex plane. When we now apply this operator to the vacuum, the
annihilation operators will vanish, leaving only the exponential
function of the creation operators. We thus have

  -- -------- -- -------
     @xmath      (242)
  -- -------- -- -------

with @xmath , again by virtue of the invariance property of the vacuum.
This is the state of the interferometer prior to photo-detection. It
corresponds to multi-mode squeezed vacuum .

##### 17.2 Photo-detection and Bargmann representation

The photo-detection itself can be modelled by successive application of
annihilation operators. Every annihilation operator @xmath removes a
photon in mode @xmath from the state @xmath . Suppose the optical
circuit employs @xmath distinct modes. We will now detect @xmath modes,
finding @xmath photons (with @xmath ). These modes can be relabelled 1
to @xmath . The vector @xmath denotes the particular detector
‘signature’: @xmath means that @xmath photons are detected in mode 1,
@xmath in mode 2, and so on. The freely propagating outgoing state
@xmath can then be described as

  -- -------- -- -------
     @xmath      (243)
  -- -------- -- -------

Here, @xmath .

At this point it is convenient to introduce the @xmath -mode Bargmann
representation we encountered in chapter \thechapter [ 9 ] . The
creation and annihilation operators obey the commutation relations given
in Eq. ( 235 ). We can replace these operators with c-numbers and their
derivatives according to

  -- -------- -- -------
     @xmath      (244)
  -- -------- -- -------

The commutation relations then read

  -- -------- -- -------
     @xmath      (245)
  -- -------- -- -------

Note that the actual values of @xmath are irrelevant (the creation and
annihilation operators do not have numerical values either); what
matters here is the functional relationship between @xmath and @xmath .

The state created by the optical circuit in this representation (prior
to the detections, analogous to Eq. ( 242 )) in the Bargmann
representation is

  -- -------- -- -------
     @xmath      (246)
  -- -------- -- -------

Returning to Eq. ( 243 ), we can write the freely propagating state
after detection of the auxiliary modes in the Bargmann representation as

  -- -------- -- -------
     @xmath      (247)
  -- -------- -- -------

up to some normalisation factor, where @xmath . By setting @xmath we
ensure that no more than @xmath photons are present in mode @xmath . It
plays the role of the vacuum bra in Eq. ( 243 ).

##### 17.3 The outgoing state in terms of Hermite polynomials

Now that we have an expression for the freely propagating state emerging
from our optical setup after detection, we seek to simplify it. We can
multiply @xmath by the identity operator @xmath , written as

  -- -------- -- -------
     @xmath      (248)
  -- -------- -- -------

where @xmath is the total number of detected photons. We then find the
following expression for the unnormalised freely propagating state
created by our optical circuit:

  -- -------- -- -------
     @xmath      (249)
  -- -------- -- -------

Now I introduce the so-called multi-dimensional Hermite polynomial, or
MDHP for short:

  -- -------- -- -------
     @xmath      (250)
  -- -------- -- -------

The use of multi-dimensional Hermite polynomials and Hermite polynomials
of two variables have previously been used to describe @xmath
-dimensional first-order systems [ 52 , 96 ] and photon statistics [ 169
, 53 , 103 ] (see also chapter \thechapter ). Here, I have shown that
the lowest order of the outgoing state of optical circuits with
quadratic components (as described by Eq. ( 237 )) and conditional
photo-detection can be expressed directly in terms of an MDHP.

In physical systems, the coupling constants (the @xmath ’s) are usually
very small (i.e., @xmath or possibly @xmath ). This means that for all
practical purposes only the first order term in Eq. ( 249 ) is important
(i.e., for small @xmath ’s we can approximate the exponential by 1).
Consequently, studying the multi-dimensional Hermite polynomials yields
knowledge about the typical states we can produce using Gaussian sources
without coherent displacements. In section 19 I take a closer look at
these polynomials, but first I consider the description of quantum
teleportation in this representation.

#### 18 Example: Quantum Teleportation

As an example of how to determine the outgoing state of an optical
circuit, consider the teleportation experiment by Bouwmeester et al . [
23 ] . The optical circuit corresponding to this experiment consists of
eight incoming modes, all in the vacuum state. Physically, there are
four spatial modes @xmath , @xmath , @xmath and @xmath , all with two
polarisation components @xmath and @xmath . Two down-converters create
entangled polarisation states; they belong to the class of active
Gaussian components without coherent displacements. Mode @xmath
undergoes a polarisation rotation over an angle @xmath and modes @xmath
and @xmath are mixed in a 50:50 beam-splitter. Finally, modes @xmath and
@xmath emerging from the beam-splitter are detected with polarisation
insensitive detectors and mode @xmath is detected using a polarisation
sensitive detector. The state which is to be teleported is therefore
given by

  -- -------- -- -------
     @xmath      (251)
  -- -------- -- -------

The state prior to the detection and normal ordering (corresponding to
Eq. ( 230 )) is given by ( @xmath is a coupling constant)

  -- -------- -- -------
     @xmath      (252)
  -- -------- -- -------

with

  -- -------- -- -------
     @xmath      (253)
  -- -------- -- -------

and @xmath , @xmath . This can be written as

  -- -------- -- -------
     @xmath      (254)
  -- -------- -- -------

with @xmath and @xmath the (symmetric) matrix

  -- -------- -- -------
     @xmath      (255)
  -- -------- -- -------

We now have to find the normal ordering of Eq. ( 254 ). Since @xmath is
unitary, the polynomial @xmath is a generator of an @xmath algebra.
According to Truax [ 164 ] , the normal ordering of the exponential thus
yields a state

  -- -------- -- -------
     @xmath      (256)
  -- -------- -- -------

with @xmath . The lowest order contribution after three detected photons
is due to the term @xmath . However, first I write Eq. ( 256 ) in the
Bargmann representation:

  -- -------- -- -------
     @xmath      (257)
  -- -------- -- -------

where @xmath and @xmath . The polarisation independent photo-detection
(the Bell measurement) is then modelled by the differentiation @xmath .
Given a detector hit in mode @xmath , the polarisation sensitive
detection of mode @xmath is modelled by @xmath :

  -- -------- -- -------
     @xmath      (258)
  -- -------- -- -------

The outgoing state in the Bargmann representation is thus given by

  -- -------- -- -------
     @xmath      (259)
  -- -------- -- -------

which is the state teleported from mode @xmath to mode @xmath in the
Bargmann representation. This procedure essentially amounts to
evaluating the multi-dimensional Hermite polynomial @xmath . Note that
the polarisation independent Bell-detection of modes @xmath and @xmath
yield a superposition of the MDHP’s.

#### 19 The Hermite Polynomials

The one-dimensional Hermite polynomials are of course well known from
the description of the linear harmonic oscillator in quantum mechanics.
These polynomials may be obtained from a generating function @xmath (see
appendix \thechapter ). Furthermore, there exist two recursion relations
and an orthogonality relation between them. The theory of
multi-dimensional Hermite polynomials with real variables has been
developed by Appell and Kempé de Fériet [ 3 ] and in the Bateman project
[ 59 ] . Mizrahi derived an expression for real MDHP’s from an @xmath
-dimensional generalisation of the Rodriguez formula [ 121 ] . I will
now give the generating function for the complex MDHP’s given by Eq. (
250 ) and consecutively derive the recursion relations and the
orthogonality relation (see also Ref. [ 96 ] ).

##### 19.1 Generating functions and recursion relations

Define the generating function @xmath to be

  -- -------- -- -------
     @xmath      (260)
  -- -------- -- -------

@xmath gives rise to the MDHP in Eq. ( 250 ), which determines this
particular choice. Note that the inner product @xmath does not involve
any complex conjugation. If complex conjugation was involved, we would
have obtained different polynomials (which we could also have called
multi-dimensional Hermite polynomials, but they would not bear the same
relationship to optical circuits).

In the rest of the chapter I use the following notation: by @xmath I
mean that the @xmath entry of the vector @xmath is lowered by one, thus
becoming @xmath . By differentiation of both sides of the generating
function in Eq. ( 260 ) we can thus show that the first recursion
relation becomes

  -- -------- -- -------
     @xmath      (261)
  -- -------- -- -------

The second recursion relation is given by

  -- -------- -- -------
     @xmath      (262)
  -- -------- -- -------

which can be proved by mathematical induction using

  -- -------- -- -------
     @xmath      (263)
  -- -------- -- -------

Here, I have set @xmath .

##### 19.2 Orthogonality relation

The orthogonality relation is somewhat more involved. Ultimately, we
want to use this relation to determine the normalisation constant of the
states given by Eq. ( 249 ). To find this normalisation we have to
evaluate the integral

  -- -------- --
     @xmath   
  -- -------- --

The state @xmath includes @xmath , which translates into a
delta-function @xmath in the integrand. The relevant integral thus
becomes

  -- -------- --
     @xmath   
  -- -------- --

From the orthonormality of different quantum states we know that this
integral must be proportional to @xmath .

Since in the Bargmann representation we are only concerned with the
functional relationship between @xmath and @xmath and not the actual
values, we can choose @xmath to be real. To stress this, we write @xmath
. The orthogonality relation is thus derived from

  -- -------- -- -------
     @xmath      (264)
  -- -------- -- -------

where @xmath is the real version of @xmath . Following Klauderer [ 96 ]
we find that

  -- -- -- -------
           (265)
  -- -- -- -------

where @xmath is the differential operator @xmath acting solely on the
exponential function. We now integrate the right-hand side by parts,
yielding

  -- -- -- -------
           (266)
  -- -- -- -------

with @xmath . The left-hand term is equal to zero when @xmath is
positive definite, i.e., when @xmath for all non-zero @xmath . Repeating
this procedure @xmath times yields

  -- -- -- -------
           (267)
  -- -- -- -------

When there is at least one @xmath , differentiating the MDHP @xmath
times to @xmath will yield zero. Thus we have

  -- -------- -- -------
     @xmath      (268)
  -- -------- -- -------

when @xmath is positive definite and @xmath for any @xmath . The case
where @xmath equals @xmath is given by

  -- -------- -- -------
     @xmath      (269)
  -- -------- -- -------

where @xmath denotes the product of @xmath with @xmath . Here, @xmath is
equal to

  -- -------- -- -------
     @xmath      (270)
  -- -------- -- -------

For the proof of this identity I refer to Ref. [ 96 ] .

#### 20 Imperfect Detectors

So far, I only considered the use of ideal photo-detection. That is, I
assumed that the detectors tell us exactly and with unit efficiency how
many photons were present in the detected mode. However, in reality such
detectors do not exist. In particular we have to incorporate losses
(non-perfect efficiency) and dark counts (see chapter \thechapter ).
Furthermore, we have to take into account the fact that most detectors
do not have a single-photon resolution (i.e., they cannot distinguish a
single photon from two photons) [ 103 ] .

This model is not suitable when we want to include dark counts. These
unwanted light sources provide thermal light, which is not of the form
of Eq. ( 237 ) but given by Eq. ( 210 ). In single-shot experiments,
however, dark counts can be neglected when the detectors operate only
within a narrow time interval.

We can model the efficiency of a detector by placing a beam-splitter
with transmission amplitude @xmath in front of a perfect detector [ 103
] . The part of the signal which is reflected by the beam-splitter (and
which will therefore never reach the detector) is the loss due to the
imperfect detector. Since beam-splitters are part of the set of optical
devices we allow, we can make this generalisation without any problem.
We now trace out all the reflected modes (they are truly ‘lost’), and
end up with a mixture in the remaining undetected modes.

Next, we can model the lack of single-photon resolution by using the
relative probabilities @xmath and @xmath of the actual number @xmath or
@xmath of detected photons conditioned on the indication of @xmath
photons in the detector (as described in Ref. [ 103 ] and chapter
\thechapter ). We can determine the pure states according to @xmath and
@xmath detected photons, and add them with relative weights @xmath and
@xmath . This method is trivially generalised for more than two possible
detected photon numbers.

Finally, we should note that my description of this class of optical
circuits (in terms of multi-dimensional Hermite polynomials) is
essentially a one-way function. Given a certain setup, it is relatively
straightforward to determine the outgoing state of the circuit. The
other way around, however, is very difficult. As exemplified by our
efforts in Ref. [ 100 ] and chapter \thechapter , it is almost
impossible to obtain the matrix @xmath associated with an optical
circuit which produces a particular predetermined state from a Gaussian
source.

#### 21 Summary

In this chapter, I have derived the general form of squeezed multi-mode
vacuum states conditioned on photo-detection of some of the modes. To
lowest order, the outgoing states in the Bargmann representation are
proportional to multi-dimensional Hermite polynomials. As an example, I
showed how teleportation can be described this way.

## Some Applications

### Chapter \thechapter Teleportation and Entanglement Swapping

In this chapter I study the experimental realisations of quantum
teleportation by Bouwmeester et al . [ 23 ] , entanglement swapping by
Pan et al . [ 126 ] and the observation of three-photon GHZ-entanglement
by Bouwmeester et al . [ 26 ] . I will show that these experiments
heavily relied on post-selection .

In section 22 I briefly discuss the issues concerned with
post-selection. Then, in section 23 the quantum teleportation experiment
performed in Innsbruck will be studied. This section is based on Ref. [
99 ] . Section 24 is based on Refs. [ 101 , 102 ] , and discusses
entanglement swapping and entanglement purification. Finally, I briefly
consider the experimental observation of three-photon GHZ-entanglement
in section 25 . This chapter is based on Kok and Braunstein [ 99 , 101 ,
102 ] .

#### 22 Post-selection in quantum optics

In this section, I will discuss the concept of post-selection . Suppose
we measure an observable @xmath with respect to an ensemble of systems
in a state @xmath . In general we have a set of different measurement
outcomes @xmath , where the @xmath ’s denote the eigenvalues of @xmath .
We speak of post-selection when a subset of the set of outcomes @xmath
is discarded. The remaining post-selected set of outcomes may be used
for subsequent data-analysis.

For example, if we had a tri-partite optical system in the state

  -- -------- -- -------
     @xmath      (271)
  -- -------- -- -------

we could place three photo-detectors ¹⁷ ¹⁷ 17 Here we use three
measurements of the same observable, i.e., photon number. There is,
however, no reason why we can’t measure three different observables in
the respective modes. in the three outgoing modes. For ideal detectors,
there are four possible measurement outcomes: one photon in any two of
the three detectors, or one photon in all three detectors. When we
repeat this ‘experiment’ a large number of times, we might discard all
the measurements which do not yield a three-fold detector coincidence.
This would correspond to post-selecting our data set on a three-fold
coincidence. (Admittedly, this is not a very interesting experiment.
However, later we will see that using post-selection we can even
partially perform a Bell measurement.)

Note that there is a fundamental difference between a conditional
measurement and post-selection. In chapter \thechapter I discussed
entanglement-based state preparation, in which one subsystem was
measured, the outcome of which was used to accept or reject the state of
the remaining system. The crucial property of such a conditional
measurement is that at the end of the procedure, there is a physically
propagating state remaining. Post-selection offers a completely
different type of control to the experimenter. Since all the subsystems
are measured there is no physically propagating state left over, but a
subset of the data can be selected for further analysis.

The question is now whether in our ‘experiment’ above we have
demonstrated the existence of the state @xmath . The answer has to be
‘no’: immediately before the measurement the state had the form of Eq. (
271 ), whereas afterwards, there was no state left at all.

Post-selection can be very powerful, though. In section 25 we will see
that non-local correlations can be inferred from post-selected data
which was obtained in an experiment designed to create a three-photon
GHZ-state. In addition, it does not necessarily mean that a
post-selected state cannot be used further in, say, a quantum computer.
As long as the post-selection can be made in the end, the relevant
branch (or branches) in the superposition undergo(es) the quantum
computation. With this in mind, we can now consider the experimental
demonstration of quantum teleportation and entanglement swapping.

#### 23 Quantum teleportation

We speak of quantum teleportation when a (possibly unknown) quantum
state @xmath held by Alice is sent to Bob without actually traversing
the intermediate space. The protocol uses an entangled state of two
systems which is shared between Alice and Bob. In the next section I
will present the teleportation protocol for discrete variables. In the
subsequent sections I confine the discussion to the teleportation
experiment performed by Bouwmeester et al ., and study the difficulties
which arise using its particular experimental setup.

##### 23.1 The discrete teleportation protocol

Quantum teleportation was first introduced by Bennett et al. in 1993 [
14 ] . In this protocol, a quantum state held by Alice is sent to Bob by
means of what the authors called ‘dual classical and
Einstein-Podolsky-Rosen channels’. How does this work?

Suppose we have a set of three two-level systems, or qubits, the states
of which can be written in the computational basis @xmath , where @xmath
denotes the system. Let Alice and Bob share a maximally entangled state
(the Einstein-Podolsky-Rosen channel [ 56 ] ), for instance one of the
Bell states @xmath in systems 2 and 3:

  -- -------- -- -------
     @xmath      (272)
  -- -------- -- -------

System 1 is in an unknown state @xmath , which can be written as

  -- -------- -- -------
     @xmath      (273)
  -- -------- -- -------

The other three Bell states are given by

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (274)
     @xmath   @xmath   @xmath      (275)
     @xmath   @xmath   @xmath      (276)
  -- -------- -------- -------- -- -------

We can write the total state of the three systems as

  -- -- -- -------
           (277)
  -- -- -- -------

The computational basis states of two qubits can also be written in the
Bell basis:

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (278)
     @xmath   @xmath   @xmath      (279)
     @xmath   @xmath   @xmath      (280)
     @xmath   @xmath   @xmath      (281)
  -- -------- -------- -------- -- -------

When we make this substitution for qubits 1 and 2, Eq. ( 277 ) becomes

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (283)
                                @xmath   
  -- -------- -------- -------- -------- -------

Alice is in possession of qubits 1 and 2, while Bob holds qubit 3. When
Alice now performs a Bell measurement, Bob’s qubit is transformed into
the unknown state up to one of four unitary transformations . Alice’s
measurement outcome determines which one of these transformations should
be inverted on Bob’s qubit to return it to the original state @xmath .
This completes the teleportation protocol.

Quantum teleportation is not restricted to qubits. For example, suppose
we have an @xmath -level system ¹⁸ ¹⁸ 18 Sometimes called a ‘qu @xmath
it’ or ‘qudit’. in the state

  -- -------- -- -------
     @xmath      (284)
  -- -------- -- -------

and a maximally entangled state shared between Alice and Bob:

  -- -------- -- -------
     @xmath      (285)
  -- -------- -- -------

We measure system 1 and 2, held by Alice, in the basis @xmath , with

  -- -------- -- -------
     @xmath      (286)
  -- -------- -- -------

In this notation we have @xmath . Conditioned on the measurement outcome
@xmath corresponding to @xmath , Bob’s system 3 is transformed into
@xmath after a transformation [ 14 ] :

  -- -------- -- -------
     @xmath      (287)
  -- -------- -- -------

Thus the state of system 1 is transferred to system 3. System 1 can
itself be mixed or part of an entangled state. Note that, since Bob
needs the measurement outcome, Alice has to send a classical message of
@xmath classical bits. Sending this classical message is, like all
classical communication, bounded by the speed of light. Therefore,
quantum teleportation does not yield an information transfer faster than
light.

After the invention of discrete quantum teleportation, Vaidman and
Braunstein and Kimble introduced teleportation for states of dynamical
variables with continuous spectra [ 165 , 33 ] . In 1997, teleportation
was experimentally realised by Bouwmeester et al . in Innsbruck [ 23 ]
and Boschi et al . in Rome [ 20 ] , followed by Furusawa et al . in
Pasadena [ 67 ] in 1998. This last experiment involved the teleportation
of continuous variables. Quantum teleportation was also reported using
nuclear magnetic resonance by Nielsen et al . in 1998 [ 124 ] . In 2000,
Kim et al . performed quantum teleportation of polarised single-photon
states using complete Bell detection [ 95 ] .

In this chapter, however, I will focus mainly on the teleportation
experiment of Bouwmeester et al .

##### 23.2 The ‘Innsbruck Experiment’

In this section, I study the experimental realisation of quantum
teleportation of a single polarised photon as performed in Innsbruck,
henceforth called the ‘Innsbruck experiment’ (Bouwmeester et al . [ 23 ]
). In the Innsbruck experiment, parametric down-conversion is used to
create two entangled photon-pairs. One pair constitutes the entangled
state shared between Alice and Bob, while the other is used by Victor to
create an ‘unknown’ single-photon polarisation state @xmath : Victor
detects mode @xmath , shown in figure 12 to prepare the single-photon
input state in mode @xmath . This mode is sent to Alice. A coincidence
in the detection of the two outgoing modes of the beam-splitter (Alice’s
--- incomplete --- Bell measurement) tells us that Alice’s two photons
are in a @xmath Bell state [ 172 , 30 , 31 ] . The remaining photon
(held by Bob) is now in the same unknown state as the photon prepared by
Victor because in this case the unitary transformation Bob has to apply
coincides with the identity, i.e., doing nothing. Bob verifies this by
detecting his state along the same polarisation axis which was used by
Victor. A four-fold coincidence in the detectors of Victor’s state
preparation, Alice’s Bell measurement and Bob’s outgoing state indicate
that quantum teleportation of a single-photon state is complete.

There is however a complication which gave rise to a different
interpretation of the experiment [ 32 , 24 , 25 , 99 ] . Analysis shows
that the state before detection by Bob (but conditioned on the other
three detector ‘hits’) is a mixture of the vacuum and the original state
[ 23 , 32 ] (to lowest order). This vacuum contribution occurs when the
down-converter responsible for creating the input state @xmath yields
two photon-pairs, while the other gives nothing. The detectors used in
the experiment cannot distinguish between one or several photons coming
in, so Victor’s detection of mode @xmath in figure 12 will not reveal
the presence of more than one photon. A three-fold coincidence in the
detectors of Victor and Alice alone is still possible, but Bob has not
received a photon and quantum teleportation has not been achieved. Bob
therefore needs to detect his state in order to identify successful
quantum teleportation. Were Victor to use a detector which can
distinguish between one or several photons this problem would disappear.
However, currently such detectors require an operating environment of
roughly 6K [ 108 , 110 , 93 , 162 ] .

I evaluate the suggestions to ‘improve’ the experiment in order to yield
non-post-selected operation, as made by Braunstein and Kimble [ 32 ] (I
will discuss the reply by Bouwmeester et al . [ 24 , 25 ] in section
23.7 ). These suggestions include the employment of a detector cascade
(as proposed in chapter \thechapter ) in the state preparation mode, and
enhancement of the down-converter responsible for the entanglement
channel (see chapter \thechapter ) relative to the one responsible for
the initial state preparation. Subsequently, I hope to clarify some of
the differences in the interpretation of the Innsbruck experiment [ 99 ]
.

As pointed out by Braunstein and Kimble [ 32 ] , to lowest order the
teleported state in the Innsbruck experiment is a mixture of the vacuum
and a single-photon state. However, we cannot interpret this state as a
low-efficiency teleported state, where sometimes a photon emerges from
the apparatus and sometimes not. This reasoning is based on the
so-called ‘Partition Ensemble Fallacy’, or PEF ¹⁹ ¹⁹ 19 This term was
coined by Samuel L. Braunstein and first appeared in Kok and Braunstein
[ 99 ] . for short. It will be studied more extensively in section 23.7
. PEF relies on a particular partition of the outgoing density matrix,
and this is not consistent with quantum mechanics [ 131 ] .
Circumventing pef leads to the notion of post-selected teleportation, in
which the teleported state is detected. The post-selected teleportation
indeed has a high fidelity and a low efficiency. Although generally PEF
is harmless (it might even be considered a useful tool in understanding
aspects of quantum theory), to my knowledge, this is the first instance
where it leads to a quantitatively different evaluation of an
experiment.

It will turn out that the suggested improvements require near perfect
efficiency photo-detectors or a considerable increase in the time needed
to run the experiment. The remaining practical alternative in order to
obtain non-post-selected quantum teleportation (i.e., teleportation
without the need for detecting the teleported photon) is to employ a
single-photon resolution detector in the state-preparation mode (a
technology currently requiring approximately 6K operating conditions) [
93 , 162 ] (see also chapter \thechapter ).

##### 23.3 The generalised experiment

In the rest of this section I consider a generalised scheme for the
Innsbruck experiment which enables us to establish the requirements to
obtain non-post-selected quantum teleportation (based on a three-fold
coincidence of Victor and Alice’s detectors). The generalisation
consists of a detector cascade (Chapter \thechapter and Ref. [ 158 ] for
Victor’s state preparation detection and parametric down-converters with
different specifications, rather than two identical down-converters.
Furthermore, an arbitrary polarisation rotation in the state-preparation
mode allows us to consider any superposition of @xmath - and @xmath
-polarisation. I calculate the output state and give an expression for
the teleportation fidelity in terms of the detector efficiencies and
down-conversion rates. To this end, I consider a simplified ‘unfolded’
schematic representation of the experiment, shown in figure 13 .

##### 23.4 Detectors

As explained in chapter \thechapter , there are two sources of errors
for a detector: losses and dark counts. Dark counts are negligible in
the teleportation experiment because the uv -pump is fired during very
short time intervals and the probability of finding a dark count in such
a small interval is negligible. Consequently, the model for real,
finite-efficiency detectors I presented in chapter \thechapter only
takes into account detector losses. Furthermore, the detectors cannot
distinguish between one or several photons. In my terminology:
finite-efficiency single-photon sensitivity detectors (see page 13 ).

To simulate a realistic detector I make use of projection operator
valued measures, or POVM’s for short [ 107 ] (see also appendix
\thechapter ). Consider a beam-splitter in the mode which is to be
detected so that part of the signal is reflected (see figure 14 ). The
second incoming mode of the beam-splitter is the vacuum (I neglect
higher photon number states because they hardly contribute at room
temperature). The transmitted signal @xmath is sent into an ideal
detector. We identify mode @xmath with the detector loss.

Suppose in mode @xmath there are @xmath @xmath -polarised and @xmath
@xmath -polarised photons. Furthermore, let these photons all be
reflected by the beam-splitter. The projector for finding these photons
in the @xmath -mode is given by:

  -- -------- -- -------
     @xmath      (288)
  -- -------- -- -------

The beam-splitter equations are taken to be ( @xmath ):

  -- -------- -- -------
     @xmath      (289)
  -- -------- -- -------

Substituting these equations in ( 288 ), summing over all @xmath and
@xmath and using the binomial expansion yields

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (291)
                                @xmath   
  -- -------- -------- -------- -------- -------

Since the @xmath -mode is the vacuum, the only contributing term is
@xmath . So the POVM @xmath of finding no detector counts in mode @xmath
is

  -- -------- -- -------
     @xmath      (292)
  -- -------- -- -------

The required POVM for finding a detector count is

  -- -------- -- -------
     @xmath      (293)
  -- -------- -- -------

where @xmath is the identity operator, @xmath is the detector efficiency
and @xmath the detector loss. When we let @xmath act on the total state
and trace out mode @xmath , we have modelled the inefficient detection
of this mode. In the case of continuous detection we need a more
elaborate model (see for example Ref. [ 175 ] ).

In order for Victor to distinguish between one or more photons in the
state preparation mode @xmath , I consider a detector cascade (Victor
doesn’t have a detector which can distinguish between one or several
photons coming in). When there is a detector coincidence in the cascade,
more than one photon was present in mode @xmath , and the event should
be dismissed. In the case of ideal detectors, this will improve the
fidelity of the teleportation up to an arbitrary level (we assume there
are no beam-splitter losses). Since we employ the cascade in the @xmath
-mode (which was used by Victor to project mode @xmath onto a
superposition in the polarisation basis) we need to perform a
polarisation sensitive detection.

In order to model this I separate the incoming state @xmath of mode
@xmath into two spatially separated modes @xmath and @xmath by means of
a polarisation beam-splitter. The modes @xmath and @xmath will now be
detected. The POVM’s corresponding to inefficient detectors are derived
along the same lines as in the previous section and read:

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (294)
     @xmath   @xmath   @xmath      (295)
  -- -------- -------- -------- -- -------

with @xmath . we choose to detect the @xmath -polarised mode. This means
that we only have to make sure that there are no photons in the @xmath
-mode. The output state will include a product of the two POVM’s: one
for finding a photon in mode @xmath , and one for finding no photons in
mode @xmath : @xmath .

To make a cascade with two detectors in @xmath and one in @xmath employ
another 50:50 beam-splitter in mode @xmath and repeat the above
procedure of detecting the outgoing modes @xmath and @xmath ( 294 ).
Since we can detect a photon in either one of the modes, we have to
include the sum of the corresponding POVM’s, yielding a transformation
@xmath . This is easily expandable to larger cascades by using more
beam-splitters and summing over all possible detector hits.

##### 23.5 Output state

In this section I incorporate the finite-efficiency detectors and the
detector cascade in the calculation of the undetected teleported output
state. This calculation includes the creation of two photon-pairs
(lowest order) and three photon pairs (higher order corrections due to
four or more photon-pairs in the experiment are highly negligible). A
formula for the vacuum contribution to the teleportation fidelity is
given for double-pair production (lowest order).

Let the two down-converters in the generalised experimental setup yield
evolutions @xmath and @xmath on modes @xmath , @xmath and @xmath ,
@xmath respectively (see figures 12 and 13 ) according to Eq. ( 132 ).
The beam-splitter which transforms modes @xmath and @xmath into @xmath
and @xmath (see figure 13 ) is incorporated by a suitable unitary
transformation @xmath , as is the polarisation rotation @xmath over an
angle @xmath in mode @xmath . The @xmath -cascade will be modelled by
@xmath beam-splitters in the @xmath -polarisation branch of the cascade,
and can therefore be expressed in terms of a unitary transformation
@xmath on the Hilbert space corresponding to modes @xmath to @xmath
(i.e., replace mode @xmath with modes @xmath to @xmath ):

  -- -------- -- -------
     @xmath      (296)
  -- -------- -- -------

Detecting modes @xmath , @xmath and @xmath with real (inefficient)
detectors means taking the partial trace over the detected modes,
including the POVM’s derived in section 23.4 :

  -- -------- -- -------
     @xmath      (297)
  -- -------- -- -------

with @xmath the superposition of POVM ’s for a polarisation sensitive
detector cascade having @xmath detectors with finite efficiency. In the
case @xmath this expression reduces to the 2-cascade POVM -superposition
derived in the previous section. Eq. ( 297 ) is an analytic expression
of the undetected outgoing state in the generalisation of the Innsbruck
experiment.

The evolutions @xmath and @xmath are exponentials of creation operators.
In the computer simulation (using Mathematica , see appendix \thechapter
) I truncated these exponentials at first and second order. The terms
that remain correspond to double and triple pair production in the
experimental setup. To preserve the order of the creation operators we
put them as arguments in a function @xmath . I defined the following
algebraic rules for @xmath (see appendix \thechapter ):

      f[x__, y__ + w__, z__]    :=   f[x, y, z] + f[x, w, z]
      f[x__, n_ a__, y__]       := n f[x, a, y]
      f[x__, n_ adagger__, y__] := n f[x, adagger, y]

where x,y,z and w are arbitrary expressions including creation and
annihilation operators ( adagger and a ) and n some expression not
depending on creation or annihilation operators. The last entry of
@xmath is always a photon number state (including the initial vacuum
state).

Since we now have functions of creation and annihilation operators, it
is quite straightforward to define (lists of) substitution rules for a
beam-splitter (see also Eq. ( 289 )), polarisation rotation, POVM’s and
the trace operation. I then use these substitution rules to ‘build’ a
model of the generalised experimental setup.

##### 23.6 Results

The probability of creating one entangled photon-pair using the weak
parametric down-conversion source 1 or 2 is @xmath or @xmath
respectively (see figure 13 ). I calculated the output state both for an
@xmath -cascade up to order @xmath (i.e. @xmath or @xmath ) and for a
1-cascade up to the order @xmath ( @xmath , @xmath or @xmath ). The
results are given below. For brevity, we take:

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (298)
     @xmath   @xmath   @xmath      (299)
  -- -------- -------- -------- -- -------

as the ideally prepared state and the state orthogonal to it. Suppose
@xmath and @xmath are the efficiencies of the detectors in mode @xmath
and @xmath respectively, and @xmath the efficiency of the detectors in
the cascade (for simplicity I assume that the detectors in the cascade
have the same efficiency). Define @xmath . The detectors in modes @xmath
and @xmath are polarisation insensitive, whereas the cascade consists of
polarisation sensitive detectors. Bearing this in mind, we have up to
order @xmath for an @xmath -cascade in mode @xmath and finding no
detector click in the @xmath -mode:

  -- -------- -- -------
     @xmath      (300)
  -- -------- -- -------

where the vacuum contribution formula was calculated and found to be
correct for @xmath (and @xmath ).

In order to have non-post-selected quantum teleportation, the fidelity
@xmath must be larger than 3/4 [ 117 , 118 , 65 ] . Since I only
estimated the two lowest order contributions (to @xmath and @xmath ),
the fidelity is also correct up to @xmath and @xmath , and I write
@xmath and @xmath respectively. Using Eqs. ( 316 ) and ( 300 ) we have:

  -- -------- -- -------
     @xmath      (301)
  -- -------- -- -------

  -- -------- -- -------
     @xmath      (302)
  -- -------- -- -------

This means that in the limit of infinite detector cascading ( @xmath )
and @xmath the efficiency of the detectors must be better than @xmath or
93.3% to achieve non-post-selected quantum teleportation. When we have
detectors with efficiencies of @xmath , we need at least four detectors
in the cascade to get unequivocal quantum teleportation. The necessity
of a lower bound on the efficiency of the detectors used in the cascade
might seem surprising, but this can be explained as follows. Suppose the
detector efficiencies become smaller than a certain value @xmath . Then
upon a two-photon state entering the detector, finding only one click
becomes more likely than finding a coincidence, and ‘wrong’ events end
up contributing to the output state. Eq. ( 302 ) places a severe
limitation on the practical use of detector cascades in this situation.

In the experiment in Innsbruck, no detector cascade was employed and
also the @xmath -mode was left undetected. The state entering Bob’s
detector therefore was (up to order @xmath ):

  -- -------- -- -------
     @xmath      (303)
  -- -------- -- -------

Remember that @xmath since the experiment involves one source which is
pumped twice. The detector efficiency @xmath in the Innsbruck experiment
was 10% [ 173 ] , and the fidelity without detecting the outgoing mode
therefore would have been @xmath (conditioned only on successful Bell
detection and state preparation). This clearly exemplifies the need for
Bob’s detection. Braunstein and Kimble [ 32 ] predicted a theoretical
maximum of 50% for the teleportation fidelity, which was conditioned
upon (perfect) detection of both the @xmath - and the @xmath -mode.

Rather than improving the detector efficiencies and using a detector
cascade, Eq. ( 301 ) can be satisfied by adjusting the probabilities
@xmath and @xmath of creating entangled photon-pairs [ 32 ] . From Eq. (
301 ) we have

  -- -------- -- -------
     @xmath      (304)
  -- -------- -- -------

Experimentally, @xmath can be diminished by employing a beam-splitter
with a suitable reflection coefficient rather than a mirror to reverse
the pump beam (see figure 12 ). Bearing in mind that @xmath is
proportional to the pump amplitude, the equation @xmath [see the
discussion following Eq. ( 149 ) with @xmath ] gives a relation between
the pump amplitude and the probability of creating a photon-pair. In
particular when @xmath :

  -- -------- -- -------
     @xmath      (305)
  -- -------- -- -------

Decreasing the production rate of one photon-pair source will increase
the time needed to run the experiment. In particular, we have from Eq. 
( 303 ) that

  -- -------- -- -------
     @xmath      (306)
  -- -------- -- -------

With @xmath , we obtain @xmath . Using Eq. ( 153 ) I estimated that
diminishing the probability @xmath by a factor 8.7 will increase the
running time by that same factor (i.e., running the experiment about
nine days, rather than twenty four hours).

The third-order contribution to the outgoing density matrix without
cascading and without detecting the @xmath -mode is

  -- -- -- -------
           (307)
  -- -- -- -------

with (we assume from now on that the phase factor @xmath in @xmath is
real)

  -- -------- -- -------
     @xmath      (308)
  -- -------- -- -------

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (311)
                                @xmath   
                                @xmath   
  -- -------- -------- -------- -------- -------

I have explicitly extracted the state which is to be teleported ( @xmath
) from the density matrix contribution @xmath (this is not necessarily
the decomposition with the largest @xmath contribution). As expected,
this term is less important in the third order than it is in the second
²⁰ ²⁰ 20 The density matrix consists of several distinct parts: a vacuum
contribution, a contribution due to one photon in mode @xmath , two
photons, and so on. Suppose there are @xmath photon-pairs created in the
whole system, and @xmath photon-pairs out of @xmath are produced by the
second source (modes @xmath and @xmath ). The outgoing mode must then
contain @xmath photons. Reversing this argument, when we find @xmath
photons in the outgoing mode the probability of creating this particular
contribution must be proportional to @xmath . Expanding the @xmath -th
order output state into parts of definite photon number we can write

@xmath

where @xmath is the (unnormalised) @xmath -th order contribution
containing all terms with @xmath photons. An immediate corollary of this
argument is that all the cross-terms between different photon number
states in the density matrix must vanish. The cross-terms are present in
Eq. ( 296 ), and I must therefore show that the partial trace in Eq. (
297 ) makes them vanish. Suppose there are @xmath photons in the total
system. A cross-term in the density matrix will have the form

@xmath

with @xmath . We also know that @xmath , so that at least one of the
other modes must have the cross-term property as well. Suppose @xmath is
not equal to @xmath . Since we have Tr @xmath , the cross-terms must
vanish. .

The teleportation fidelity including the third-order contribution ( 307
) can be derived along the same lines as ( 301 ). Assuming that all
detectors have the same efficiency @xmath and @xmath , the teleportation
fidelity up to third order is

  -- -------- -- -------
     @xmath      (312)
  -- -------- -- -------

With @xmath and a detector efficiency of @xmath , this fidelity differs
from ( 301 ) with only a few parts in ten thousand:

  -- -------- -- -------
     @xmath      (313)
  -- -------- -- -------

On the other hand, let me compare two gedanken experiments in which the
cascades have different detector efficiencies (but all the detectors in
one cascade still have the same efficiency). The ratio between the
teleportation fidelity with detector efficiencies @xmath and @xmath
(with @xmath and @xmath the lower and higher detector efficiencies
respectively) up to lowest order is

  -- -------- -- -------
     @xmath      (314)
  -- -------- -- -------

where @xmath is the difference between these efficiencies. This shows
that detector efficiencies have a considerably larger influence on the
teleportation fidelity than the higher-order pair production, as
expected.

To summarise my results, I have found that detector cascading is only
useful for this realisation of quantum teleportation when the detectors
in the cascade have near unit efficiency, in accordance with the results
of chapter \thechapter . In particular, there is a lower bound to the
efficiency below which an increase in the number of detectors in the
cascade actually decreases the ability to distinguish between one or
several photons entering the cascade. Finally, enhancement of the
photon-pair source responsible for the entanglement channel relative to
the one responsible for the state preparation increases the time needed
to run the experiment by roughly an order of magnitude.

##### 23.7 Fidelity versus efficiency

In the context of the Innsbruck experiment, the fidelity is used to
distinguish between quantum teleportation and teleportation which could
have been achieved ‘classically’. Here, classical teleportation is the
disembodied transport of some quantum state from Alice to Bob by means
of a classical communication channel alone. There is no shared
entanglement between Alice and Bob. Since classical communication can be
duplicated, such a scheme can lead to many copies of the transported
output state (so-called clones ). Classical teleportation with perfect
fidelity (i.e., @xmath ) would then lead to the possibility of perfect
cloning, thus violating the no-cloning theorem [ 178 , 49 ] . This means
that the maximum fidelity for classical teleportation has an upper bound
which is less than one.

Quantum teleportation, on the other hand, can achieve perfect fidelity
(and circumvents the no-cloning theorem by disrupting the original). To
demonstrate quantum teleportation therefore means that the teleported
state should have a higher fidelity than possible for a state obtained
by any scheme involving classical communication alone ²¹ ²¹ 21 The
fidelity captures this one particular feature of quantum teleportation
very well and is already extensively studied. .

For classical teleportation of randomly sampled polarisations, the
maximum attainable fidelity is @xmath [ 63 , 65 ] . When only linear
polarisations are to be teleported, the maximum attainable fidelity is
@xmath [ 117 , 118 ] . These are the values which the fidelity of true
quantum teleportation should exceed.

In the case of the Innsbruck experiment, @xmath denotes the ‘unknown’
linear polarisation state of the photon issued by Victor. I can write
the undetected outgoing state (to lowest order and conditioned on a
successful Bell state measurement) as

  -- -------- -- -------
     @xmath      (315)
  -- -------- -- -------

where @xmath is the vacuum state. The overlap between @xmath and @xmath
is given by Eq. ( 90 ). In the Innsbruck experiment the fidelity @xmath
is then given by

  -- -------- -- -------
     @xmath      (316)
  -- -------- -- -------

This should be larger than 3/4 in order to demonstrate quantum
teleportation. The vacuum contribution in Eq. ( 315 ) arises from the
fact that Victor cannot distinguish between one or several photons
entering his detector, i.e., Victor’s inability to properly prepare a
single-photon state.

As pointed out by Braunstein and Kimble [ 32 ] , the fidelity of the
Innsbruck experiment remains well below the lower bound of 3/4 due to
the vacuum contribution. Replying to this, Bouwmeester et al . [ 24 , 25
] argued that ‘when a photon appears, it has all the properties required
by the teleportation protocol’. The vacuum contribution in Eq. ( 315 )
should therefore only affect the efficiency of the experiment, with a
consequently high fidelity. However, this is a potentially ambiguous
statement. If by ‘appear’ we mean ‘appearing in a photo-detector’, I
agree that a high fidelity (and low efficiency) can be inferred.
However, this yields a so-called post-selected fidelity, where the
detection destroys the teleported state. The fidelity prior to (or
without) Bob’s detection is called the non -post-selected fidelity. The
question is now whether we can say that a photon appears when no
detection is made, thus yielding a high non -post-selected fidelity.

This turns out not to be the case. Making an ontological distinction
between a photon and no photon in a mixed state (without a detection) is
based on what we call the ‘Partition Ensemble Fallacy,’ introduced in
chapter \thechapter . In the absence of Bob’s detection, the density
matrix of the teleported state (i.e., the non -post-selected state) may
be decomposed into an infinite number of partitions. These partitions do
not necessarily include the vacuum state at all. It would therefore be
incorrect to say that teleportation did or did not occur except through
some operational means (e.g., a detection performed by Bob).

Bob’s detection thus leads to a high post-selected fidelity. However,
the vacuum term in Eq. ( 315 ) contributes to the non -post-selected
fidelity, decreasing it well below the lower bound of 3/4. Due to this
vacuum contribution, the Innsbruck experiment did not demonstrate non
-post-selected quantum teleportation. Nonetheless, teleportation was
demonstrated using post-selected data obtained by detecting the
teleported state. By selecting events where a photon was observed in the
teleported state, a post-selected fidelity higher than @xmath could be
inferred (estimated at roughly 80% [ 25 ] ) ²² ²² 22 We recall that this
entire discussion is restricted to the subset of events where successful
Bell-state and state-preparation have occurred. .

#### 24 Entanglement swapping and purification

##### 24.1 Teleportation of entanglement: swapping

In the previous section, I discussed quantum teleportation [ 14 ] , in
which a quantum state is sent from Alice to Bob using (maximal)
entanglement. If this quantum state is itself part of an entangled
state, i.e., if Alice’s system is entangled with Charlie’s system, this
entanglement is ‘transferred’ from Alice to Bob. In other words, Bob’s
system becomes entangled with Charlie’s system, even though these two
systems might never have physically interacted. This is called
entanglement swapping [ 183 ] .

For example, suppose we have a system of two independent polarisation
entangled photon-pairs in modes @xmath and @xmath respectively. If we
restrict ourselves to the Bell states, we have

  -- -------- -- -------
     @xmath      (317)
  -- -------- -- -------

However, on a different basis this state can be written as:

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (319)
                                @xmath   
  -- -------- -------- -------- -------- -------

This can be easily checked by writing out the Bell states. The
non-cancelling terms can be rewritten as Eq. ( 317 ).

If we make a Bell measurement on modes @xmath and @xmath , we can see
from Eq. ( 319 ) that the undetected remaining modes @xmath and @xmath
become entangled. For instance, when we find modes @xmath and @xmath in
a @xmath Bell state, the remaining modes @xmath and @xmath must be in
the @xmath state as well. In appendix \thechapter I show that a suitably
chosen unitary transformation of Bob’s branch can return the state to
@xmath , just as in the teleportation of a single state.

Entanglement swapping was performed in Innsbruck by Pan et al . in 1998
[ 126 ] . In this experiment two parametric down-converters were
employed to create polarisation entanglement ²³ ²³ 23 In the experiment,
the two down-converters were implemented by a single BBO crystal pumped
twice in opposite directions. The experiment thus closely resembled the
quantum teleportation experiment six months earlier [ 23 ] (see also
chapter \thechapter ). . The schematics of the experimental setup are
depicted in Fig. 15 . One branch of each down-converter is sent into a
50:50 beam-splitter. The outgoing modes of the beam-splitter are
detected. A detector coincidence indicates that the state @xmath was
present, and thus acts as an (incomplete) Bell measurement. I have
included two polarisation beam-splitters in the outgoing modes of the
beam-splitter. These were not present in the actual experiment, but they
play an important rôle in the subsequent discussion [ 184 ] .

Since entanglement swapping is formally the teleportation of one branch
of an entangled state, it should not come as a surprise that the
entanglement swapping experiment performed by Pan et al . suffers from
the same complication as the quantum teleportation experiment performed
by Bouwmeester et al . [ 23 ] : apart from both down-converters creating
a single pair, there is also the possibility that one of the
down-converters creates two pairs, while nothing happens in the other.

Now I use the extra information about the detected photons due to the
polarisation beam-splitters in figure 15 . Conditioned on the
polarisation @xmath , with @xmath , of the detected photons we obtain
the outgoing states

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (320)
     @xmath   @xmath   @xmath      (321)
     @xmath   @xmath   @xmath      (322)
     @xmath   @xmath   @xmath      (323)
  -- -------- -------- -------- -- -------

The outgoing state of the entanglement swapping experiment (without the
polarisation beam-splitter) is a random mixture of these four states.

Let me define the following states:

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (324)
     @xmath   @xmath   @xmath      (325)
     @xmath   @xmath   @xmath      (326)
     @xmath   @xmath   @xmath      (327)
  -- -------- -------- -------- -- -------

After some involved, but essentially straightforward algebra it can be
shown that the outgoing state of the entanglement swapping experiment
performed by Pan et al . can also be written as the mixed state @xmath :

  -- -------- -- -------
     @xmath      (328)
  -- -------- -- -------

to lowest order. Conditioned on detected photons in the outgoing modes a
high entanglement swapping fidelity can be inferred ( @xmath ). However,
the fidelity for non-post-selected entanglement swapping is @xmath .
This argument is completely analogous to the argument presented in
section 23 23.7 .

##### 24.2 Entanglement swapping as purification

The non-post-selected fidelity @xmath of having a maximally entangled
state @xmath as the output of the entanglement swapping experiment is
much higher than the that of the down-converter output state, where
@xmath . This suggests that entanglement swapping can be viewed as a
purification protocol (see also chapter \thechapter ). Indeed, this has
been suggested by Bose et al . [ 21 ] . This protocol was subsequently
extended by Shi et al . [ 152 ] .

The Bose protocol works as follows: let @xmath and @xmath denote photons
with polarisations in the @xmath - and @xmath -direction of a Cartesian
coordinate system. We consider (an ensemble of) non-maximally entangled
states for two systems 1 and 2

  -- -------- -- -------
     @xmath      (329)
  -- -------- -- -------

and similarly for systems 3 and 4:

  -- -------- -- -------
     @xmath      (330)
  -- -------- -- -------

The purification protocol now employs entanglement swapping from systems
1, 2 and 3, 4 to the two systems 1 and 4. These two systems were
previously unentangled. Making a Bell measurement of system 2 and 3
entangles the remaining systems 1 and 4.

There are four different outcomes of the Bell measurement, which give
rise to four different entangled states in systems 1 and 4. These are [
21 ]

  -- -------- -- -------- -- -------
     @xmath      @xmath      (331)
     @xmath      @xmath      (332)
     @xmath      @xmath      (333)
     @xmath      @xmath      (334)
  -- -------- -- -------- -- -------

The normalisation factor @xmath is given by @xmath . It is easily seen
that the measurement outcomes @xmath and @xmath actually degrade the
entanglement compared to the entanglement of the systems 1 and 2 or 3
and 4. In the case of measurement outcomes @xmath and @xmath , however,
the resulting (pure) states are maximally entangled. With probability
@xmath we will obtain a maximally entangled state, and with probability
@xmath we degrade the entanglement.

When we compare this protocol with the swapping experiment by Pan et al
., we note that there is a crucial difference: The outgoing state of the
experiment is not confined to the Hilbert space spanned by the basis
@xmath , contrary to the protocol by Bose et al . In addition, we have
to include states like the vacuum ( @xmath ) and two-photon states (
@xmath , @xmath and @xmath ).

However, if the swapping protocol used by Pan et al . can increase the
entanglement content upon repetition of the procedure in this larger
Hilbert space (or, more precisely, this truncated Fock space), we can
still call it a purification protocol. I will now investigate this.

First, I have to determine precisely what I mean by a repetition of the
swapping procedure. It means that the outgoing states of two distinct
entanglement swapping setups are again used as an entanglement source
for a swapping experiment. Repeating this @xmath times, we can depict
this as a string of down-converters connected by beam-splitters (see
figure 16 ). Such a string can consist of an even or an odd number of
down-converters. When @xmath is odd, we have a string of ‘entanglement
swappers’ the outgoing states of which are again used in entanglement
swapping.

Instead of Bell detections, we consider polarisation sensitive
photo-detection. This allows us to condition the outgoing state on
@xmath - and @xmath -polarised photons in the detectors. In the case
@xmath this led to the outgoing state

  -- -------- -- -------
     @xmath      (335)
  -- -------- -- -------

In the case of @xmath down-converters, we can keep track of the single-
and double-pair production in the following table:

  pdc            1   2   3       @xmath
  -------------- --- --- --- --- ----------------
  @xmath pairs   1   1   1   …   1
                 0   2   0   …   0/2 (odd/even)
                 2   0   2   …   2/0 (odd/even)

In the top row the parametric down-converters are enumerated (in
accordance with figure 16 ). The entries in the lower rows identify the
number of photon-pairs created by the associated down-converter. These
rows identify the only three possibilities in which the detectors (from
left to right) signal the detection of polarised photons in the
direction @xmath , @xmath , @xmath , @xmath

There are several things to be noted. First of all, depending on the
parity of @xmath , the bottom three rows correspond to different orders
of pair-creation. The lowest order corresponds to no created pairs
(vacuum), the next order is one created pair, and so on. Since
parametric down-conversion has such a small probability of creating an
entangled photon-pair, the lowest order is always by far the leading
order.

Secondly, we can easily verify that the possibility of every
down-converter creating exactly one photon-pair never occurs alone. We
can always construct a different photon-pair configuration of the same
order which triggers the detectors in the same way, thus preventing the
creation of maximal entanglement (this is, of course, not the proof I
was looking for in section 10 of chapter \thechapter ). At the same
time, it is easily verified that (for ideal detections) the possibility
that one down-converter creates three pairs is dismissed, since it would
mean that some detectors see at least two photons. Furthermore, this
procedure can be immediately repeated for other polarisation choices in
the detectors.

Finally, we should note that the entanglement content alternates between
almost nothing ( @xmath ) and about one quarter ( @xmath ). This
behaviour occurs because for an odd number of down-converters, the
detectors in the setup can be triggered by @xmath down-converters
creating a double-pair. The total number of pairs is then @xmath , which
is the lowest order.

When we have an even number of down-converters we have three
possibilities given in the table above. When every down-converter
creates one photon-pair, the outgoing state will be (up to lowest order)
the anti-symmetric Bell state. In this case, all down-converter modes
are connected by means of the beam-splitter operations and entanglement
swapping is successful. On the other hand when the down-converters
create two and zero photon pairs in alternation, the left-hand outgoing
mode is independent from the right-hand outgoing mode. There is only a
classical correlation between them: if on the left there are two
photons, then we have the vacuum state on the right and vice versa.

The outgoing state is

  -- -------- -- -------
     @xmath      (336)
  -- -------- -- -------

conditioned on a detector sequence @xmath , @xmath , @xmath , @xmath
…This is independent of the number of down-converters, as long as it is
even. As a consequence, we cannot interpret entanglement swapping as
performed by Pan et al . as a purification protocol.

##### 24.3 Entanglement content of output states

I will now return to the states given by Eq. ( 320 ). These states can
also be obtained by running the states @xmath , @xmath , @xmath and
@xmath through a 50:50 beam-splitter. This raises the question what the
entanglement content of the states of Eq. ( 320 ) is. After all, the
states @xmath (with @xmath ) are separable .

The non-locality of single photons has been studied by Hardy [ 79 , 80 ]
and Peres [ 133 ] (see also chapter \thechapter ). Let @xmath and @xmath
denote different spatial modes, @xmath is the vacuum and @xmath is a
single-photon state. The essential idea is that the state

  -- -------- -- -------
     @xmath      (337)
  -- -------- -- -------

can be used to construct the violation of the
Clauser-Horne-Shimony-Holt, or CHSH inequality [ 44 , 131 ] (this is a
variant of a Bell inequality [ 11 ] ). Consequently, a single-photon
state can exhibit non-local properties. This point was debated by
Vaidman [ 166 ] and Greenberger, Horne and Zeilinger [ 72 , 73 ] .

Here, I will discuss the entanglement content of the two-photon states
which are obtained by mixing two single-photon states at a 50:50
beam-splitter. To this end I use the so-called Peres-Horodecki partial
transpose criterion for density matrices [ 87 , 134 ] (see appendix
\thechapter ). Using the partial transpose criterion I will examine the
entanglement content of the state @xmath and the density matrix @xmath ,
which is a mixture of the states given in Eq. ( 320 ).

We can write the density matrix of the state @xmath as

  -- -------- -- -------
     @xmath      (338)
  -- -------- -- -------

We obtain the partial transpose by exchanging the second entries of the
bras and kets, yielding

  -- -------- -- -------
     @xmath      (339)
  -- -------- -- -------

In matrix representation on the basis @xmath this becomes ²⁴ ²⁴ 24 This
is a matrix on a truncated Fock space corresponding to the given basis.

  -- -------- -- -------
     @xmath      (340)
  -- -------- -- -------

The eigenvalues of this matrix are @xmath (with multiplicity 3) and
@xmath . As proved in appendix \thechapter , the negative eigenvalues
imply that the state @xmath is entangled.

In the experiment performed by Pan et al ., no polarisation
beam-splitters were used, and the outgoing state before post-selection
was a mixture of the states given in Eq. ( 324 ). The density matrix can
be written as

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (345)
                                @xmath   
                                @xmath   
                                @xmath   
                                @xmath   
  -- -------- -------- -------- -------- -------

The partial transpose then becomes

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (350)
                                @xmath   
                                @xmath   
                                @xmath   
                                @xmath   
  -- -------- -------- -------- -------- -------

In matrix representation on the basis

  -- -------- -- -------
     @xmath      
     @xmath      (351)
  -- -------- -- -------

the partial transpose @xmath becomes ²⁵ ²⁵ 25 Again on a truncated Fock
space.

  -- -------- -- -------
     @xmath      (352)
  -- -------- -- -------

The eigenvalues of this matrix are given by @xmath (multiplicity 2),
@xmath (multiplicity 9), @xmath (multiplicity 1), @xmath (multiplicity
1) and @xmath (multiplicity 1). Since @xmath has negative eigenvalues,
@xmath is an entangled state [ 134 , 87 ] . This means that entanglement
swapping as it was originally proposed really does work, although
maximally entangled (Bell) states can only be seen in a post-selected
manner.

This teaches us something interesting about entanglement. It is
generally believed that when two systems are entangled, they have
somehow interacted in the past. However, in the beam-splitter the two
photons do not interact with each other, and yet the outgoing state
(given a separable input state) is entangled. This shows that
entanglement does not necessarily originates from an interaction.

#### 25 Three-particle entanglement

Three-particle maximally entangled states have also been produced in a
post-selected manner [ 26 ] . In figure 17 a schematic representation of
this experiment is shown [ 182 ] . As in the teleportation and
entanglement swapping experiments, a non-linear crystal is pumped with a
short-pulsed high-intensity laser. However, this time the setup is
chosen such that the down-converter directly creates two photon-pairs in
modes @xmath and @xmath . The lowest order of the created state which
can trigger the four detectors ( @xmath , @xmath , @xmath and @xmath )
is given by

  -- -------- -- -------
     @xmath      (353)
  -- -------- -- -------

with @xmath .

It is clear that only the branch @xmath can trigger all detectors due to
the polarisation beam-splitter PBS @xmath (up to lowest order). This
polarisation beam-splitter transmits @xmath -polarised photons (which
trigger @xmath ) and the retardation plate transforms the reflected
photon @xmath into @xmath . The part of the outgoing state (i.e., before
detection) due to the input @xmath and conditioned on a photon in
detector @xmath is thus

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (355)
                                @xmath   
  -- -------- -------- -------- -------- -------

From this state it is easily seen that three-photon entanglement can
only be observed in a post-selected manner by discarding the branches
which include the vacuum @xmath . A three-fold coincidence in the
detectors @xmath , @xmath and @xmath can thus only come from the
branches @xmath and @xmath .

As I argued in section 22 , this experiment does not demonstrate the
existence of the GHZ-state @xmath . However, using post-selection of the
data-set on a four-fold detector coincidence, non-local correlations
could be inferred. This was demonstrated by Pan et al . in 2000 [ 127 ]
. In the first experiment [ 26 ] two tests were made: first it was shown
that only the branches @xmath and @xmath contributed to a four-fold
coincidence. Secondly it had to be shown that the two branches were in a
coherent superposition, since the post-selected events could be due to a
statistical mixture of the two branches. This was done by rotating the
polarisation over @xmath before detection. The observed visibility in
these experiments was 75% [ 26 ] .

#### 26 Summary

In this chapter I studied the optical implementations of quantum
teleportation, entanglement swapping and the creation of three-photon
Greenberger-Horne-Zeilinger entanglement. All these experiments
succeeded in a post-selected manner and demonstrated their respective
non-local features.

The undetected outgoing state of the teleportation experiment is a
mixture of the teleported state and the vacuum. As we have shown, this
vacuum contribution degrades the non-post-selected fidelity, rather than
the efficiency of the experiment. The outgoing state of the entanglement
swapping experiment is more complicated, since it is not simply a
mixture of the vacuum and the swapped state. Here, the photo-detection
post-selects particular branches from a superposition.

The same happens in the creation of the three-photon GHZ-state.
Furthermore, since no physically propagating state left the apparatus
after detection, we cannot say that the state @xmath was created.
However, non-local correlations using post-selected data can be
observed.

### Chapter \thechapter Quantum Lithography

Optical lithography is a widely used printing method. In this process
light is used to etch a substrate. The (un)exposed areas on the
substrate then define the pattern. In particular, the micro-chip
industry uses lithography to produce smaller and smaller processors.
However, classical optical lithography can only achieve a resolution
comparable to the wavelength of the used light [ 38 , 115 , 116 ] . It
therefore limits the scale of the patterns. To create smaller patterns
we need to venture beyond this classical boundary [ 179 ] . Here, I
investigate how we can beat this boundary. This chapter is based on a
collaboration with Agedi N. Boto, Daniel S. Abrams, Colin P. Williams
and Jonathan P. Dowling at the Jet Propulsion Laboratory, Pasadena [ 22
, 104 , 105 ] . Recently, similar work was done by Björk, Sánchez Soto
and Söderholm [ 17 ] .

In Ref. [ 22 ] we introduced a procedure called quantum lithography
which offers an increase in resolution without an upper bound. This
enables us to use quantum lithography to write closely spaced lines in
one dimension. However, for practical purposes (like, e.g., optical
surface etching) we need the ability to create more complicated patterns
in both one and two dimensions. Here, we study how quantum lithography
allows us to create these patterns.

This chapter is organised as follows: first I derive the classical
resolution limit in section 27 . Section 28 reiterates the method
introduced in Ref. [ 22 ] . Then, in section 29 , I consider a
generalised version of this procedure and show how we can tailor
arbitrary one-dimensional patterns. Section 30 shows how a further
generalisation of this procedure leads to arbitrary patterns in two
dimensions. Finally, section 31 addresses the issues concerning the
physical implementation of quantum lithography.

#### 27 Classical resolution limit

Classically, we can only resolve details of finite size. In this section
we give a derivation of this classical resolution limit using the
so-called Rayleigh criterion [ 139 ] . Suppose two plane waves
characterised by @xmath and @xmath hit a surface under an angle @xmath
from the normal vector. The wave vectors are given by

  -- -------- -- -------
     @xmath      (356)
  -- -------- -- -------

where we used @xmath . The wave number @xmath is related to the
wavelength of the light according to @xmath .

In order to find the interference pattern in the intensity, we sum the
two plane waves at position @xmath at the amplitude level:

  -- -------- -- -------
     @xmath      (357)
  -- -------- -- -------

When we calculate the inner product @xmath from Eq. ( 356 ) we obtain
the expression

  -- -------- -- -------
     @xmath      (358)
  -- -------- -- -------

for the intensity along the substrate in direction @xmath .

The Rayleigh criterion states that the minimal resolvable feature size
@xmath corresponds to the distance between an intensity maximum and an
adjacent minimum (see figure 18 ). From Eq. ( 358 ) we obtain

  -- -------- -- -------
     @xmath      (359)
  -- -------- -- -------

This means that the maximum resolution is given by

  -- -------- -- -------
     @xmath      (360)
  -- -------- -- -------

where @xmath is the wavelength of the light. The maximum resolution is
therefore proportional to the wavelength and inversely proportional to
the sine of the angle between the incoming plane waves and the normal.
The resolution is thus maximal ( @xmath is minimal) when @xmath , or
@xmath . This is the grazing limit. The classical diffraction limit is
therefore @xmath .

#### 28 Introduction to Quantum Lithography

In this section we briefly reiterate our method of Ref. [ 22 ] . Suppose
we have two intersecting light beams @xmath and @xmath . We place some
suitable substrate at the position where the two beams meet, such that
the interference pattern is recorded. For simplicity, we consider the
grazing limit in which the angle @xmath off axis for the two beams is
@xmath (see figure 19 ). Classically, the interference pattern on the
substrate has a resolution of the order of @xmath , where @xmath is the
wavelength of the light. However, by using entangled photon-number
states (i.e., inherently non-classical states) we can increase the
resolution well into the sub-wavelength regime [ 90 , 138 , 163 , 62 ] .

How does quantum lithography work? Let the two counter-propagating light
beams @xmath and @xmath be in the combined entangled number state

  -- -------- -- -------
     @xmath      (361)
  -- -------- -- -------

where @xmath , with @xmath . We define the mode operator @xmath and its
adjoint @xmath . The deposition rate @xmath on a substrate sensitive to
@xmath photons with wavelength @xmath (a so-called @xmath -photon
resist) is then given by

  -- -------- -- -------
     @xmath      (362)
  -- -------- -- -------

i.e., we look at the higher moments of the electric field operator [ 70
, 91 , 135 ] . The deposition rate @xmath is measured in units of
intensity. Leaving the substrate exposed for a time @xmath to the light
source will result in an exposure pattern @xmath . After a
straightforward calculation we see that

  -- -------- -- -------
     @xmath      (363)
  -- -------- -- -------

We interpret this as follows. A path-differential phase-shift @xmath in
light beam @xmath results in a displacement @xmath of the interference
pattern on the substrate. Using two classical waves, a phase-shift of
@xmath will return the pattern to its original position. However,
according to Eq. ( 363 ), one cycle is completed after a shift of @xmath
. This means that a shift of @xmath will displace the pattern @xmath
times. In other words, we have @xmath times more maxima in the
interference pattern. These need to be closely spaced, yielding an
effective Rayleigh resolution of @xmath , a factor of @xmath below the
classical interferometric result of @xmath [ 38 ] .

Physically, we can interpret this result as follows: instead of having a
state of @xmath single photons, Eq. ( 361 ) describes an @xmath -photon
state. Since the momentum of this state is @xmath times as large as the
momentum for a single photon, the corresponding De Broglie wavelength is
@xmath times smaller. The interference of this @xmath -photon state with
itself on a substrate thus gives a periodic pattern with a
characteristic resolution dimension of @xmath .

#### 29 General Patterns in 1D

So far, we have described a method to print a simple pattern of evenly
spaced lines of sub-wavelength resolution. However, for any practical
application we need the ability to produce more complicated patterns. To
this end, we introduce the state

  -- -------- -- -------
     @xmath      (364)
  -- -------- -- -------

This is a generalised version of Eq. ( 361 ). In particular, Eq. ( 364 )
reduces to Eq. ( 361 ) when @xmath and @xmath . Note that we included a
relative phase @xmath , which will turn out to be crucial in the
creation of arbitrary one-dimensional patterns.

We can calculate the deposition rate again according to the procedure in
section 28 . As we shall see later, in general, we can have
superpositions of the states given by Eq. ( 364 ). We therefore have to
take into account the possibility of different values of @xmath ,
yielding a quantity

  -- -------- -- -------
     @xmath      (365)
  -- -------- -- -------

Note that this deposition rate depends not only on the parameter @xmath
, but also on the relative phases @xmath and @xmath . The deposition
rate then becomes

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (367)
                                @xmath   
  -- -------- -------- -------- -------- -------

Obviously, @xmath when @xmath . For @xmath , the deposition rate takes
on the form

  -- -------- -- -------
     @xmath      (368)
  -- -------- -- -------

which, in the case of @xmath and @xmath , coincides with Eq.  ( 363 ).
When @xmath is suitably chosen, we see that we also have access to
deposition rates @xmath and @xmath . Apart from this extra phase
freedom, Eq. ( 368 ) does not look like an improvement over Eq. ( 363 ),
since @xmath , which means that the resolution decreases. However, we
will show later how these states can be used to produce non-trivial
patterns.

First, we look at a few special cases of @xmath and @xmath . When we
write @xmath we have

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (369)
     @xmath   @xmath   @xmath      (370)
     @xmath   @xmath   @xmath      (371)
     @xmath   @xmath   @xmath      (372)
  -- -------- -------- -------- -- -------

These relations give the dependence of the matrix elements @xmath on
@xmath and @xmath in a more intuitive way than Eq. ( 367 ) does.
Finally, when @xmath we obtain

  -- -- -- -------
           (373)
  -- -- -- -------

So far we have only considered generalised deposition rates given by
Eq.  ( 364 ), with special values of their parameters. We will now turn
our attention to the problem of creating more arbitrary patterns.

Note that there are two main, though fundamentally different, ways we
can superpose the states given by Eq. ( 364 ). We can superpose states
with different photon numbers @xmath and a fixed distribution @xmath
over the two modes:

  -- -------- -- -------
     @xmath      (374)
  -- -------- -- -------

Alternatively, we can superpose states with a fixed photon number @xmath
, but with different distributions @xmath :

  -- -------- -- -------
     @xmath      (375)
  -- -------- -- -------

where @xmath denotes the largest integer @xmath with @xmath .

These two different superpositions can be used to tailor patterns which
are more complicated than just closely spaced lines. We will now study
these two different methods.

##### 29.1 The Pseudo-Fourier Method

The first method, corresponding to the superposition given by Eq.  ( 374
), we will call the pseudo-Fourier method (this choice of name will
become clear shortly). When we calculate the deposition rate @xmath
according to the state @xmath we immediately see that branches with
different photon numbers @xmath and @xmath do not exhibit interference:

  -- -------- -- -------
     @xmath      (376)
  -- -------- -- -------

Using Eq. ( 368 ) the exposure pattern @xmath becomes

  -- -------- -- -------
     @xmath      (377)
  -- -------- -- -------

where @xmath is the exposure time and the @xmath are positive. Since
@xmath and @xmath is fixed, we have @xmath . I will now prove that this
is a Fourier series up to a constant.

A general Fourier expansion of @xmath can be written as

  -- -------- -- -------
     @xmath      (378)
  -- -------- -- -------

Writing Eq. ( 377 ) as

  -- -------- -- -------
     @xmath      (379)
  -- -------- -- -------

where @xmath is a constant. If we ignore this constant (its contribution
to the deposition rate will give a general uniform background exposure
of the substrate, since it is independent of @xmath ) we see that we
need

  -- -------- -- -------
     @xmath      (380)
  -- -------- -- -------

with @xmath positive, @xmath and @xmath , @xmath real. Expanding the
left-hand side and equating terms in @xmath and @xmath we find

  -- -------- -- -------
     @xmath      (381)
  -- -------- -- -------

This is essentially a co-ordinate change from Cartesian to polar
co-ordinates. Thus, Eq. ( 377 ) is equivalent to a Fourier series up to
an additive constant. Since in the limit of @xmath a Fourier series can
converge to any well-behaved pattern @xmath , this procedure allows us
to approximate arbitrary patterns in one dimension (up to a constant).
It is now clear why we call this procedure the pseudo-Fourier method.

However, there is a drawback with this procedure. The deposition rate
@xmath is a positive definite quantity, which means that once the
substrate is exposed at a particular Fourier component, there is no way
this can be undone. Technically, Eq. ( 377 ) can be written as

  -- -------- -- -------
     @xmath      (382)
  -- -------- -- -------

where @xmath is the uniform background ‘penalty exposure rate’ @xmath we
mentioned earlier. The second term on the right-hand side is a true
Fourier series. Thus in the pseudo-Fourier method there is always a
minimum exposure of the substrate. Ultimately, this penalty can be
traced to the absence of interference between the terms with different
photon number in Eq.  ( 374 ). Next, we will investigate whether our
second method of tailoring patterns can remove this penalty exposure.

##### 29.2 The Superposition Method

We will now study our second method of tailoring patterns, which we call
the ‘superposition method’ (lacking a better name). Here we keep the
total number of photons @xmath constant, and change how the photons are
distributed between the two beams in each branch [see Eq. ( 375 )]. A
distinct advantage of this method is that it does exhibit interference
between the different branches in the superposition, which eliminates
the uniform background penalty exposure.

Take for instance a superposition of two distinct terms

  -- -------- -- -------
     @xmath      (383)
  -- -------- -- -------

with @xmath and @xmath given by Eq.  ( 367 ). After some algebraic
manipulation the deposition rate can be written as

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (387)
                                @xmath   
                                @xmath   
                                @xmath   
  -- -------- -------- -------- -------- -------

where the deposition rate @xmath is now a function of @xmath and @xmath
, where we have chosen the real numbers @xmath and @xmath to satisfy
@xmath . For the special values @xmath , @xmath , @xmath and @xmath we
obtain the pattern shown in figure 20 . Clearly, there is no uniform
background penalty exposure here.

For more than two branches in the superposition this becomes a
complicated function, which is not nearly as well understood as a
Fourier series. The general expression for the deposition rate can be
written as

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (389)
                                @xmath   
  -- -------- -------- -------- -------- -------

where we have chosen @xmath and @xmath real to satisfy @xmath . Note
that @xmath .

If we want to tailor a pattern @xmath , it might be the case that this
type of superposition will also converge to the required pattern. We
will now compare the superposition method with the pseudo-Fourier
method.

##### 29.3 Comparing the two methods

So far, we discussed two methods of creating non-trivial patterns in one
dimension. The pseudo-Fourier method is simple but yields a uniform
background penalty exposure. The superposition method is far more
complicated, but seems to get around the background exposure. Before we
make a comparison between the two methods we will discuss the creation
of ‘arbitrary’ patterns.

It is well known that any sufficiently well-behaved periodic function
can be written as an infinite Fourier series (we ignore such subtleties
which arise when two functions differ only at a finite number of points,
etc.). However, when we create patterns with the pseudo-Fourier
lithography method we do not have access to every component of the
Fourier expansion, since this would involve an infinite number of
photons ( @xmath ). This means that we can only employ truncated Fourier
series, and these can merely approximate arbitrary patterns.

The Fourier expansion has the nice property that when a series is
truncated at @xmath , the remaining terms still give the best Fourier
expansion of the function up to @xmath . In other words, the
coefficients of a truncated Fourier series are equal to the first @xmath
coefficients of a full Fourier series. If the full Fourier series is
denoted by @xmath and the truncated series by @xmath , we can define the
normed-distance quantity @xmath :

  -- -------- -- -------
     @xmath      (390)
  -- -------- -- -------

which can be interpreted as a distance between @xmath and @xmath . If
quantum lithography yields a pattern @xmath , we can introduce the
following definition: quantum lithography can approximate arbitrary
patterns if

  -- -------- -- -------
     @xmath      (391)
  -- -------- -- -------

with @xmath some proportionality constant. This definition gives the
concept of approximating patterns a solid basis.

We compare the pseudo-Fourier and the superposition method for one
special case. We choose the test function

  -- -------- -- -------
     @xmath      (392)
  -- -------- -- -------

With up to ten photons, we ask how well the pseudo-Fourier and the
superposition method approximate this pattern.

In the case of the pseudo-Fourier method the solution is immediate. The
Fourier expansion of the ‘trench’ function given by Eq. ( 392 ) is well
known:

  -- -------- -- -------
     @xmath      (393)
  -- -------- -- -------

Using up to @xmath photons we include terms up to @xmath , since @xmath
. The Fourier method thus yields a pattern @xmath (the two patterns
@xmath and @xmath are generally not the same) which can be written as

  -- -------- -- -------
     @xmath      (394)
  -- -------- -- -------

where @xmath is a constant depending on the proportionality constant of
@xmath , the rate of production of @xmath and the coupling between the
light field and the substrate. The term @xmath is defined to accommodate
for the minus signs in Eq. ( 393 ): it is zero when @xmath is even and
one when @xmath is odd. Note the uniform background penalty exposure
rate @xmath . The result of this method is shown in figure 20 .

Alternatively, the superposition method employs a state

  -- -------- -- -------
     @xmath      (395)
  -- -------- -- -------

The procedure of finding the best fit with the test function is more
complicated. We have to minimise the absolute difference between the
deposition rate @xmath times the exposure time @xmath and the test
function @xmath . We have chosen @xmath . Mathematically, we have to
evaluate the @xmath and @xmath which minimise @xmath :

  -- -------- --
     @xmath   
  -- -------- --

with

  -- -------- -- -------
     @xmath      (396)
  -- -------- -- -------

We have to fit both @xmath and @xmath . Using a genetic optimalisation
algorithm [ 137 ] (with @xmath , a normalised height of the test
function; see appendix \thechapter ) we found that the deposition rate
is actually very close to zero in the interval @xmath , unlike the
pseudo-Fourier method, where we have to pay a uniform background
penalty. This result implies that in this case a superposition of
different photon distributions @xmath , given a fixed total number of
photons @xmath , works better than a superposition of different photon
number states (see figure 20 ). In particular, the fixed photon number
method allows for the substrate to remain virtually unexposed in certain
areas .

We stress that this is merely a comparison for a specific example,
namely that of the trench target function @xmath . We conjecture that
the superposition method can approximate other arbitrary patterns
equally well, but we have not yet found a proof. Besides the ability to
fit an arbitrary pattern, another criterion of comparison between the
pseudo-Fourier method and the superposition method, is the time needed
to create the @xmath -photon entangled states.

Until now, we have only considered sub-wavelength resolution in one
direction, namely parallel to the direction of the beams. However, for
practical applications we would like sub-wavelength resolution in both
directions on the substrate. This is the subject of the next section.

#### 30 General Patterns in 2D

In this section we study how to create two-dimensional patterns on a
suitable substrate using the quantum lithography techniques developed in
the previous sections. As we have seen, the phase shift @xmath , in the
setup given by figure 18 , acts as a parametrisation for the deposition
rate in one dimension. Let’s call this the @xmath -direction.

We can now do the same for the @xmath -direction, employing two
counter-propagating beams ( @xmath and @xmath ) in the @xmath -direction
(see figure 21 ). The same conditions apply: we consider the limit where
the spatial angle @xmath off axis approaches @xmath , thus grazing along
the substrate’s surface.

Consider the region where the four beams @xmath , @xmath , @xmath and
@xmath overlap. For real lithography we have to take into account the
mode shapes, but when we confine ourselves to an area with side lengths
@xmath (where @xmath is the wavelength of the used light) this problem
does not arise.

The class of states on modes @xmath to @xmath that we consider here are
of the form

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (398)
                                @xmath   
  -- -------- -------- -------- -------- -------

where @xmath and @xmath are two relative phases. This is by no means the
only class of states, but we will restrict our discussion to this one
for now. Observe that this is a superposition on the amplitude level,
which allows destructive interference in the deposition rate in order to
create dark spots on the substrate. Alternatively, we could have used
the one-dimensional method [with states given by Eq. ( 364 )] in the
@xmath - and @xmath -direction, but this cannot give interference
effects between the modes @xmath and @xmath .

The phase-shifts @xmath and @xmath in the light beams @xmath and @xmath
(see figure 21 ) result in respective displacements @xmath and @xmath of
the interference pattern on the substrate. A phase-shift of @xmath in a
given direction will displace the pattern, say, @xmath times. This means
that the maxima are closer together, yielding an effective resolution
equal to @xmath . This happens in both the @xmath - and the @xmath
-direction.

We proceed again as in section 28 by evaluating the @xmath order moment
@xmath of the electric field operator [see Eq. ( 362 )]. On a substrate
sensitive to @xmath photons this gives the deposition rate @xmath [with
@xmath given by Eq. ( 398 )]:

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (406)
                                @xmath   
                                @xmath   
                                @xmath   
                                @xmath   
                                @xmath   
                                @xmath   
                                @xmath   
  -- -------- -------- -------- -------- -------

For the special choice of @xmath and @xmath we have

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (409)
                                @xmath   
                                @xmath   
  -- -------- -------- -------- -------- -------

We can again generalise this method and use superpositions of the states
given in Eq. ( 398 ). Note that there are now three numbers @xmath ,
@xmath and @xmath which can be varied. Furthermore, as we have seen in
the one-dimensional case, superpositions of different @xmath do not give
interference terms in the deposition rate.

Suppose we want to approximate a pattern @xmath , with @xmath . This
pattern can always be written in a Fourier expansion:

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (411)
                                @xmath   
  -- -------- -------- -------- -------- -------

with @xmath , @xmath , @xmath and @xmath real. In the previous section
we showed that quantum lithography could approximate the Fourier series
of a one-dimensional pattern up to a constant displacement. This relied
on absence of interference between the terms with different photon
numbers. The question is now whether we can do the same for patterns in
two dimensions. Or alternatively, can general superpositions of the
state @xmath approximate the pattern @xmath ?

From Eq. ( 406 ) it is not obvious that we can obtain the four
trigonometric terms given by the Fourier expansion of Eq. ( 411 ):

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (412)
     @xmath   @xmath   @xmath      (413)
     @xmath   @xmath   @xmath      (414)
     @xmath   @xmath   @xmath      (415)
  -- -------- -------- -------- -- -------

We can therefore not claim that two-dimensional quantum lithography can
approximate arbitrary patterns in the sense of one-dimensional
lithography. Only simple patterns like the one given in figure 22 can be
inferred from Eq. ( 406 ). In order to find the best fit to an arbitrary
pattern one has to use a minimisation procedure.

For example, we calculate the total deposition rate due to the quantum
state @xmath , where

  -- -------- -- -------
     @xmath      (416)
  -- -------- -- -------

Here, @xmath are complex coefficients. We now proceed by choosing a
particular intensity pattern @xmath and optimising the coefficients
@xmath for a chosen number of photons. The deposition rate due to the
state @xmath is now

  -- -------- -- -------
     @xmath      (417)
  -- -------- -- -------

with @xmath . We again have to evaluate the @xmath and @xmath which
minimise

  -- -------- -- -------
     @xmath      (418)
  -- -------- -- -------

The values of @xmath and @xmath can again be found using a genetic
algorithm.

#### 31 Physical implementation

With current experimental capabilities, the physical implementation of
quantum lithography is very challenging. In particular, there are two
major issues to be dealt with before quantum lithography can become a
mature technology. First of all, we not only need the ability to create
the entangled photon states given by Eqs. ( 364 ) and ( 398 ), but we
should also be able to create coherent superpositions of these states.
One possibility might be to use optical components like parametric
down-converters. Contrary to the results of Ref. [ 100 ] , we are not
concerned with the usually large vacuum contribution of these processes,
since the vacuum will not contribute to the spatial profile of the
deposition [see Eqs.  ( 361 ) and ( 362 )].

Secondly, we need substrates which are sensitive to the higher moments
of the electric field operator. When we want to use the pseudo-Fourier
method, up to @xmath photons for quantum lithography in one dimension,
the substrate needs to be reasonably sensitive to all the higher moments
up to @xmath , the maximum photon number. Alternatively, we can use the
superposition method for @xmath photons when the substrate is sensitive
to predominantly one higher moment corresponding to @xmath photons.
Generally, the method of lithography determines the requirements of the
substrate.

There are also some considerations about the approximation of patterns.
For example, we might not need arbitrary patterns. It might be the case
that it is sufficient to have a set of patterns which can then be used
to generate any desired circuit. This is analogous to having a universal
set of logical gates, permitting any conceivable logical expression. In
that case we only need to determine this elementary (universal) set of
patterns.

Furthermore, we have to study whether the uniform background penalty
exposure really presents a practical problem. One might argue that a
sufficient difference between the maximum deposition rate and the
uniform background penalty exposure is enough to accommodate
lithography. This depends on the details of the substrate’s reaction to
the electro-magnetic field.

Before quantum lithography can be physically implemented and used in the
production of nano circuits, these issues have to be addressed
satisfactorily.

#### 32 Summary

In this chapter I have generalised the theory of quantum lithography as
first outlined in Ref. [ 22 ] . In particular, I have shown how we can
create arbitrary patterns in one dimension, albeit with a uniform
background penalty exposure. We can also create some patterns in two
dimensions, but we have no proof that this method can be extended to
give arbitrary patterns.

For lithography in one dimension we distinguish two methods: the
pseudo-Fourier method’ and the superposition method. The pseudo-Fourier
method is conceptually easier since it depends on Fourier analysis, but
it also involves a finite amount of unwanted exposure of the substrate.
More specifically, the deposition rate equals the pattern in its Fourier
basis plus a term yielding unwanted background exposure. The
superposition method gets around this problem and seems to give better
results, but lacks the intuitive clarity of the Fourier method.
Furthermore, we do not have a proof that this method can approximate
arbitrary patterns.

Quantum lithography in two dimensions is more involved. Starting with a
superposition of states, given by Eq. ( 398 ), we found that we can
indeed create two-dimensional patterns with sub-wavelength resolution,
but we do not have a proof that we can create arbitrary patterns.
Nevertheless, we might be able to create a certain set of elementary
basis patterns.

There are several issues to be addressed in the future. First, we need
to study the specific restrictions on the substrate and how we can
physically realize them. Secondly, we need to create the various
entangled states involved in the quantum lithography protocol.

Finally, G.S. Agarwal and R. Boyd have called to our attention that
quantum lithography works also if the weak parametric down-converter
source, described in Ref. [ 22 ] is replaced by a high-flux optical
parametric amplifier [ 2 ] . The visibility saturates at 20% in the
limit of large gain, but this is quite sufficient for some lithography
purposes, as well as for 3D optical holography used for data storage.

## Appendices

### Chapter \thechapter Complex vector spaces

In this appendix I review some properties of complex vector spaces,
since quantum mechanics is defined in terms of a complex vector space.

### Appendix A Vector spaces

A vector space @xmath consists of a set of vectors @xmath on which two
operations are defined:

  Addition:  

    for every @xmath the vector @xmath is an element of @xmath .

  Scalar multiplication:  

    for every @xmath and @xmath there is a unique element @xmath in
    @xmath .

Furthermore, for every (complex) vector space the following conditions
hold:

1.  For all @xmath , @xmath (commutativity of addition);

2.  for all @xmath , @xmath (associativity of addition);

3.  there exists an element 0 in @xmath such that @xmath for every
    @xmath ;

4.  for each element @xmath in @xmath there exists an element @xmath in
    @xmath such that @xmath ;

5.  for each element @xmath in @xmath , @xmath ;

6.  for each pair @xmath and @xmath in @xmath and each @xmath we have
    @xmath ;

7.  for each @xmath and each pair @xmath we have @xmath ;

8.  for each pair @xmath and @xmath in @xmath and each @xmath we have
    @xmath .

On a vector space we can also define an inner product (sometimes called
the scalar product, not to be confused with scalar multiplication). When
two vectors in @xmath are denoted by @xmath and @xmath , their inner
product is a (complex) number written as @xmath . For all @xmath and
@xmath the inner product obeys the following rules

1.  @xmath ;

2.  @xmath ;

3.  @xmath , where @xmath denotes complex conjugation;

4.  @xmath if @xmath .

A complex vector space with an inner product is called a Hilbert space .
Note that we only defined algebraic rules for the inner product, the
actual form of @xmath depends on the representation.

In Dirac’s bracket notation, the elements of the Hilbert space are
written as so-called kets : @xmath . The adjoints of these kets are
called bras : @xmath . The inner product is given by @xmath . It
necessarily obeys all the conditions given above. Two vectors @xmath and
@xmath in Hilbert space are orthogonal if and only if their inner
product vanishes: @xmath .

In a Hilbert space of dimension @xmath we can construct a set of @xmath
orthogonal vectors, called an orthogonal basis of . When the vectors in
the basis have unit length, i.e., if for every basis vector @xmath we
have @xmath , then the basis is orthonormal .

Next, we define linear operators on . Consider a transformation @xmath .
@xmath is called a linear operator on if for every @xmath and @xmath

1.  @xmath ;

2.  @xmath .

A linear operator transforms one vector in Hilbert space to another:
@xmath . In matrix notation @xmath corresponds to a matrix, while kets
correspond to column vectors and bras to row vectors.

Linear operators do not necessarily commute . That is, when we have two
linear operators @xmath and @xmath on , their commutation relation
@xmath is not necessarily zero. Non-zero commutation relations play an
important rôle in quantum mechanics. For example, non-commuting
operators lie at the heart of quantum cryptography.

Suppose a linear operator @xmath obeys the following relation:

  -- -------- -- -------
     @xmath      (419)
  -- -------- -- -------

where @xmath is a vector in and @xmath a complex number. This is called
an eigenvalue equation for @xmath , where @xmath is the eigenvalue and
@xmath the corresponding eigenvector . When the dimension of is @xmath ,
every linear operator on has @xmath eigenvalue equations. An eigenvalue
@xmath might be @xmath -fold degenerate, in which case @xmath generates
a @xmath -dimensional eigenspace : there are @xmath orthogonal vectors
@xmath which obey Eq. ( 419 ), thus forming a basis for a @xmath
-dimensional subspace of .

There also exists a property called the trace of an operator @xmath . We
write

  -- -------- -- -------
     @xmath      (420)
  -- -------- -- -------

where @xmath can be any complete orthonormal basis. The trace has the
following properties:

1.  if @xmath then @xmath is real;

2.  @xmath ;

3.  @xmath ;

4.  @xmath , the cyclic property.

These properties are easily proved using the knowledge that the trace as
defined in Eq. ( 420 ) is independent of the basis @xmath .

### Appendix B Tensor product spaces

A tensor product of two operators @xmath and @xmath is defined as
follows:

  -- -------- -- -------
     @xmath      (421)
  -- -------- -- -------

which is equivalent to @xmath . In other words, every operator sticks to
its own Hilbert space. It should be noted, however, that not every
operator on @xmath is of the form @xmath . The fact that this is not the
case is also of fundamental importance to quantum information theory, as
we shall see in the remainder of this thesis (see also appendix
\thechapter ).

Other properties of the tensor product of operators are [ 85 ]

1.  @xmath ,

2.  @xmath ,

3.  @xmath ,

4.  @xmath ,

5.  @xmath ,

6.  @xmath ,

7.  @xmath .

For notational brevity the tensor product symbol @xmath is often
omitted, yielding, e.g., @xmath . When this abbreviated notation is
used, one should always remember which state or operator is defined on
which Hilbert space.

### Appendix C Projection operators

So far, we have only considered tensor products of Hilbert spaces.
However, there is also an operation ‘ @xmath ’, called the direct sum of
two vector spaces. The direct sum of two vector spaces @xmath is again a
vector space, and @xmath and @xmath are called its subspaces . We can
write a vector in @xmath as @xmath , where @xmath and @xmath are vectors
in the respective subspaces @xmath and @xmath . The subspaces are linear
if

  -- -------- -- -------
     @xmath      (422)
  -- -------- -- -------

Here, I will only consider linear subspaces.

Suppose we have a Hilbert space which can be written as the direct sum
of two subspaces. These are again Hilbert spaces:

  -- -------- -- -------
     @xmath      (423)
  -- -------- -- -------

A state @xmath in can then be written as

  -- -------- -- -------
     @xmath      (424)
  -- -------- -- -------

where @xmath and @xmath are restricted to their respective subspaces and
@xmath . We can define an operator @xmath which yields

  -- -------- -- -------
     @xmath      (425)
  -- -------- -- -------

In other words, @xmath projects the state @xmath onto the linear
subspace @xmath . @xmath is said to be a projection operator or
projector [ 85 ] . An operator is a projection operator if and only if

  -- -------- -- -------
     @xmath      (426)
  -- -------- -- -------

Projection operators have the following properties:

1.  two projection operators @xmath and @xmath are called orthogonal
    projections if and only if @xmath , they project onto linearly
    independent subspaces;

2.  the sum of two (orthogonal) projectors is again a projector;

3.  the sum over all orthogonal projectors in is the identity operator
    @xmath ;

4.  the orthocomplement of a projector @xmath in is given by @xmath ;

5.  the eigenvalues of a projector are 1 and 0.

When viewed as measurement outcomes (see postulate 3), the eigenvalues
of a projection operator indicate whether the state is in the subspace
spanned by @xmath or not.

It is easily checked that for any state @xmath in a projector on the
subspace spanned by @xmath can be written as

  -- -------- -- -------
     @xmath      (427)
  -- -------- -- -------

When @xmath is a complete orthonormal basis of , the identity operator
can then be written as

  -- -------- -- -------
     @xmath      (428)
  -- -------- -- -------

This is called the completeness relation . An operator @xmath with
eigenvalues @xmath whose eigenvectors are given by the basis @xmath can
then be written as

  -- -------- -- -------
     @xmath      (429)
  -- -------- -- -------

This is sometimes called the spectral decomposition of @xmath . In
general, when the eigenvectors of an operator @xmath are not given by
this basis, @xmath can be written as

  -- -------- -- -------
     @xmath      (430)
  -- -------- -- -------

When @xmath is Hermitian ( @xmath ), we have @xmath .

### Chapter \thechapter States, Operators and Maps

In this appendix I summarise some background knowledge about states,
operators and maps in the context of quantum mechanics. This knowledge
is important for the understanding of the Peres-Horodecki partial
transpose criterion for the separability of bi-partite density matrices,
and it also lays the foundations for the definition of positive operator
valued measures. For this appendix I am indebted to professor Rajiah
Simon, who guided me through Hilbert space.

### Appendix D Single systems

Suppose we have a physical system which is described by a set of
accessible states @xmath . The superposition principle and the linearity
of quantum mechanics imply that this set spans a Hilbert space of
dimension @xmath . This is a complex vector space with an orthonormal
basis

  -- -------- --
     @xmath   
  -- -------- --

We can define a set of linear operators @xmath on , the elements of
which transform one state to another:

  -- -------- -- -------
     @xmath      (431)
  -- -------- -- -------

where @xmath is again a state in . Hermiticity of @xmath ( @xmath )
implies that all the eigenvalues of @xmath are real. When for all @xmath
we have @xmath , @xmath is non-negative . A non-negative operator with
trace 1 ( @xmath ) is called a density operator , usually denoted by
@xmath . Note that all non-negative operators are also Hermitian, and
have non-negative eigenvalues. A choice of a basis in puts Hermitian
non-negative operators into a one-to-one correspondence with Hermitian
non-negative matrices.

The set of all linear operators @xmath in turn define a Hilbert space
@xmath of dimension @xmath , one orthonormal basis of which can be
written as

  -- -------- -- -------
     @xmath      (432)
  -- -------- -- -------

We can now define an even higher set of objects called maps , denoted by
@xmath , the elements of which linearly transform the set of linear
operators into itself:

  -- -------- -- -------
     @xmath      (433)
  -- -------- -- -------

These linear maps are sometimes called super -operators. They are
operators on the Hilbert space @xmath , but we give them a different
name to avoid confusion. A simple example of a map corresponds to a
unitary transformation @xmath . The corresponding map @xmath may be
written as @xmath . The set of all maps thus constitutes a Hilbert space
@xmath of dimension @xmath . The concept of non-negative operators lead
us to define positive maps.

  Definition:  

    a map @xmath is called positive if for every non-negative operator
    @xmath the operator @xmath is again a non-negative operator.

When @xmath for every @xmath , the map @xmath is a trace-preserving map.
Trace-preserving positive maps are important in quantum mechanics, since
they transform the set of density operators to itself. This property may
lead one to expect that these maps correspond to physical processes or
symmetries. It is an interesting aspect of quantum mechanics that not
all positive maps can be associated with physical processes. This subtle
fact becomes important when we consider composite systems.

### Appendix E Composite systems

Suppose we have two systems 1 and 2 with respective accessible states
@xmath and @xmath . These states span two Hilbert spaces @xmath and
@xmath with dimensions @xmath and @xmath respectively. The accessible
states of the composite system can be written on the basis of the tensor
product of the states @xmath , generating a Hilbert space @xmath of
dimension @xmath . Similarly, the set of linear operators @xmath on
@xmath generates a Hilbert space of dimension @xmath , and the set of
maps generates a Hilbert space of dimension @xmath .

Consider a map @xmath , defined for subsystem 1. When this map is
positive (and trace-preserving) it transforms density operators of the
subsystem to density operators. When system 1 is part of a composite
system @xmath , we want to know when a positive map of system 1 (leaving
system 2 unchanged) would transform a density operator defined on the
composite system again into a density operator. In other words, we ask
when the extended map @xmath , with @xmath the identity map of system 2,
is again positive.

  Definition:  

    a map @xmath is called completely positive if all its extensions are
    positive.

There exist maps which are positive, but not completely positive. One
such map is the transpose. Take, for example, the singlet state of a
two-level bi-partite system (written in the computational basis):

  -- -------- -- -------
     @xmath      (434)
  -- -------- -- -------

The density operator of this state can be written as

  -- -------- -- -------
     @xmath      (435)
  -- -------- -- -------

The transpose of a general density operator for a single system in this
notation is given by

  -- -- -- -------
           (436)
  -- -- -- -------

that is, we exchange the entries of the bras and kets. This is a
positive map. The extended transpose (or partial transpose) on a
compound system @xmath , however, is not positive. To see this, apply
the extended transpose to the density operator given in Eq. ( 435 ), we
obtain

  -- -------- -- -------
     @xmath      (437)
  -- -------- -- -------

If the eigenvalues of @xmath are non-negative, @xmath is again a density
operator. In order to find the eigenvalues of this operator we write
@xmath in matrix representation on the computational basis:

  -- -------- -- -------
     @xmath      (438)
  -- -------- -- -------

It is easily found that this matrix has eigenvalues 1 (with multiplicity
3) and @xmath . Therefore, @xmath is not a density operator, and @xmath
, although positive, is not a completely positive map.

I will now present an important class of completely positive maps.
Consider the general map

  -- -------- -- -------
     @xmath      (439)
  -- -------- -- -------

with @xmath and @xmath linear operators on the system Hilbert space. An
important special case of such a map is given by

  -- -------- -- -------
     @xmath      (440)
  -- -------- -- -------

where the @xmath ’s are again linear operators. In particular, we can
define a family of such maps, as given by Eq. ( 196 ). When @xmath for
all @xmath , the map in Eq. ( 440 ) is again a positive map. To prove
this statement, note that

  -- -------- -- -------
     @xmath      (441)
  -- -------- -- -------

for all @xmath and @xmath if @xmath is non-negative. We then have

  -- -------- -- -------
     @xmath      (442)
  -- -------- -- -------

The right-hand side of this equation is positive for all @xmath ’s,
@xmath ’s and non-negative operators @xmath . Hence @xmath is a
non-negative operator and @xmath is positive.

Furthermore, when @xmath such an @xmath is completely positive. To prove
this statement, let @xmath be a map on system 1 (henceforth denoted by
@xmath ) and consider a second system 2. Recall that @xmath is
completely positive if all its extensions @xmath are positive. I will
now show that this is the case.

Define the extension @xmath . System 2 can have arbitrary dimension, and
may itself be composite. We thus have to show that @xmath is positive.
Let @xmath be a non-negative operator on the composite system @xmath :

  -- -------- -- -------
     @xmath      (443)
  -- -------- -- -------

with @xmath , and define the operator @xmath on system 1 as

  -- -------- -- -------
     @xmath      (444)
  -- -------- -- -------

The map @xmath is then given by the transformation

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (445)
              @xmath   @xmath      (446)
              @xmath   @xmath      (447)
              @xmath   @xmath      (448)
  -- -------- -------- -------- -- -------

where I defined @xmath . Since this is a convex sum over non-negative
operators, the resulting operator is again non-negative and @xmath is
completely positive. This completes the proof.

The fact that positive but not completely positive maps on a subsystem
do not necessarily transform density operators on the composite system
to density operators can be exploited to detect (or witness) quantum
entanglement. This is the subject of the next section.

### Appendix F Partial transpose criterion

In quantum information theory, it is important to know whether a
composite system, characterised by a density operator @xmath is
separable or not. One way to test this is to use the Peres-Horodecki
partial transpose criterion [ 134 , 87 ] .

A density operator @xmath of two systems @xmath is separable if and only
if it can be written as

  -- -------- -- -------
     @xmath      (449)
  -- -------- -- -------

with @xmath and @xmath . The density operator @xmath is defined on
system @xmath . Consider again the transpose of an operator @xmath :

  -- -------- -- -------
     @xmath      (450)
  -- -------- -- -------

As we have seen, this is a trace-preserving positive, but not completely
positive map. We extended this map to the partial transpose @xmath . The
partial transpose is not positive on the composite system.

Under the partial transpose, the separable density operator from Eq. (
449 ) will transform according to

  -- -------- -- -------
     @xmath      (451)
  -- -------- -- -------

However, @xmath is positive and @xmath is again a density operator.
Therefore @xmath is another (separable) density operator. Now look at
the eigenvalues of @xmath . Clearly, if @xmath is separable, then @xmath
has positive eigenvalues. Therefore, if @xmath has one or more negative
eigenvalues, the original density operator @xmath must have been
entangled. This is the Peres-Horodecki partial transpose criterion.
Clearly, it is only a necessary condition for separability.

It has been proved [ 87 ] that for the Hilbert spaces @xmath and @xmath
the partial transpose criterion is both necessary and sufficient. In
other words, @xmath is separable if and only if the eigenvalues of its
partial transpose @xmath are positive. For higher dimensional Hilbert
spaces this is no longer true. In that case there can exist density
operators which are not separable, but for which the eigenvalues of
@xmath are non-negative. Such states are said to exhibit bound
entanglement [ 88 , 89 ] . It is generally believed that this form of
entanglement cannot be purified.

### Appendix G projection operator valued measures

Let us now return to the case of a single system and the states,
operators and maps defined on it. Consider a projection operator @xmath
defined by

  -- -------- -- -------
     @xmath      (452)
  -- -------- -- -------

In terms of the states @xmath this operator can be written as

  -- -------- -- -------
     @xmath      (453)
  -- -------- -- -------

Suppose we have a set of projection operators @xmath , with the states
@xmath not necessarily orthogonal. We can define a generalised
projection operator @xmath as a weighted measure over this set:

  -- -------- -- -------
     @xmath      (454)
  -- -------- -- -------

with @xmath and

  -- -------- -- -------
     @xmath      (455)
  -- -------- -- -------

The operator @xmath is called a projection operator valued measure or
POVM for short [ 107 ] .

This can be generalised further by observing that

  -- -------- -- -------
     @xmath      (456)
  -- -------- -- -------

with @xmath and @xmath . When we define the operator @xmath :

  -- -------- -- -------
     @xmath      (457)
  -- -------- -- -------

we can write the POVM as

  -- -------- -- -------
     @xmath      (458)
  -- -------- -- -------

### Chapter \thechapter Elementary Group Theory

In this appendix I give some background theory of Lie groups. I am
indebted to the book by De Wit and Smith [ 176 ] , which gives a good
and concise exposition of the subject. Further Lie group theory in
particle physics is presented in Halzen and Martin [ 77 ] . For group
theory in quantum mechanics, see also Chaichian and Hagedorn [ 43 ] .
For a formal treatment of Lie groups, see Gilmore [ 69 ] .

A set @xmath is called a group when @xmath satisfies the following
requirements:

-   There exists a multiplication rule @xmath such that for every two
    elements @xmath and @xmath of the group, their product @xmath is
    again an element of the group;

-   the multiplication rule is associative, i.e., @xmath for all @xmath
    ;

-   there exists an element @xmath , called the unit element, for which
    the product @xmath , with @xmath any element of @xmath ;

-   for every @xmath there exists an element @xmath , called the inverse
    element of @xmath , such that @xmath .

When @xmath , the group is called Abelian . In other words, the elements
of @xmath commute . A subset @xmath of @xmath is called a subgroup of
@xmath if the group requirements above hold for @xmath . This is written
as @xmath .

### Appendix H Lie groups

If a group @xmath has a finite number of elements, this number is called
the order of @xmath . For finite groups, see e.g., Serre [ 150 ] . When
the group has an infinite number of elements, the group can be either
continuous or discontinuous. In the context of this thesis I am mostly
interested in continuous groups. If the elements of a continuous group
@xmath depend analytically on a (finite) set of parameters ( @xmath ),
we speak of a Lie group ²⁶ ²⁶ 26 After the Norwegian mathematician
Marius Sophus Lie (1842–1899). . The dimension of the Lie group is given
by the number of independent parameters: if @xmath , we have @xmath .
The @xmath -dimensional space generated by the parameters is called
parameter space .

Let @xmath be a one-dimensional Lie group with elements @xmath . We can
always choose the parametrisation such that [ 176 ]

  -- -------- -- -------
     @xmath      (459)
  -- -------- -- -------

with

  -- -------- -- -------
     @xmath      (460)
  -- -------- -- -------

If we interpret the group elements as operators (acting on other group
elements), the unit element is the identity operator: @xmath . In the
neighbourhood of the identity, a group element can thus be written as an
expansion

  -- -------- -- -------
     @xmath      (461)
  -- -------- -- -------

where @xmath is some operator.

Since @xmath is a continuous group, we can write the transformation from
the identity [written as @xmath ] to @xmath in terms of @xmath small
steps @xmath :

  -- -------- -- -------
     @xmath      (462)
  -- -------- -- -------

If I now take the limit of @xmath the higher-order terms vanish and we
obtain

  -- -------- -- -------
     @xmath      (463)
  -- -------- -- -------

The operator @xmath is said to be the generator of the group @xmath
because it generates the elements of @xmath . This can be generalised
immediately to @xmath -dimensional Lie groups, yielding

  -- -------- -- -------
     @xmath      (464)
  -- -------- -- -------

where the @xmath ’s are the independent parameters of the group and the
@xmath ’s the generators. There are as many different generators as
there are parameters.

In terms of the generators, the group multiplication can be written as

  -- -------- -- -------
     @xmath      (465)
  -- -------- -- -------

The right-hand side can be expressed as the argument of a single
exponent by means of the Baker-Campbell-Hausdorff formula:

  -- -------- -- -------
     @xmath      (466)
  -- -------- -- -------

where @xmath denotes the commutator between @xmath and @xmath , and the
dots indicate a series of terms with higher-order commutators of the
@xmath ’s (like, for example @xmath ). This series does not necessarily
terminate.

I started with the condition that @xmath is a group, which implies that
the right-hand side of Eq. ( 466 ) is again an element of @xmath and
thus can be written as @xmath . In turn, this means that the generators
are closed under commutation:

  -- -------- -- -------
     @xmath      (467)
  -- -------- -- -------

with the (complex) numbers @xmath the so-called structure constants . To
see that this equation must hold, suppose that the argument of the
right-hand side of Eq. ( 466 ) does not imply Eq. ( 467 ). There is then
a commutator @xmath which cannot be written as a sum over the
generators: @xmath . Repeated commutators should then cancel @xmath ,
because the right-hand side of Eq. ( 466 ) is a group element. This can
only happen when repeated commutators yield @xmath . By definition,
@xmath is then a member of the set of generators. This contradicts our
assumption.

The structure constants @xmath define a so-called Lie algebra . They
obey the Jacobi identity for structure constants:

  -- -------- -- -------
     @xmath      (468)
  -- -------- -- -------

This is easily proved using the Jacobi identity for any three operators
@xmath , @xmath and @xmath :

  -- -------- -- -------
     @xmath      (469)
  -- -------- -- -------

### Appendix I Representations

When we have a set of matrices @xmath with @xmath , and the commutation
relations between these matrices are given by

  -- -------- -- -------
     @xmath      (470)
  -- -------- -- -------

then this set of matrices is said to form a representation of the Lie
algebra defined in Eq. ( 467 ). When these matrices are multiplied by
@xmath and exponentiated, they define a representation of the group
@xmath , denoted by @xmath :

  -- -------- -- -------
     @xmath      (471)
  -- -------- -- -------

The matrices @xmath form a basis of the representation. For @xmath
matrices the representation is said to be @xmath -dimensional. If there
exists a non-trivial subspace of @xmath spanned by the basis @xmath
(i.e., a subspace other than @xmath and @xmath itself) which is
invariant under the group transformations, the representation is called
reducible . If no such invariant subspace exists, the representation is
irreducible . The theory of representations is important for many
applications in physics.

### Appendix J Examples of Lie groups

One of the most important Lie groups in quantum mechanics must be the
group of @xmath unitary matrices. This group is called @xmath . The
corresponding Lie algebra @xmath is given by three generators ( @xmath
):

  -- -------- -- -------
     @xmath      (472)
  -- -------- -- -------

where @xmath are the entries of the Levi-Civita tensor of rank three
(entries with even permutations of the indices are 1, odd permutations
give @xmath , and repeated indices give 0). The generators are given by
@xmath , with

  -- -- -- -------
           (473)
  -- -- -- -------

the so-called Pauli matrices. Representations of this group are used in
the description of angular momentum, spin and iso-spin, as well as in
quantum optics (see appendix \thechapter for a relation between Lie
algebras and optical devices). If the parameters are given by @xmath ,
@xmath and @xmath , a general @xmath group element in the fundamental
(two-dimensional) representation can be written as ( @xmath )

  -- -------- -- -------
     @xmath      (474)
  -- -------- -- -------

Since the group elements depend periodically on @xmath , we have @xmath
, which means that the parameter space of @xmath is compact ; it can be
restricted to a sphere with radius @xmath .

The group @xmath is closely related to the group @xmath , the group of
orthogonal @xmath matrices, better known as the rotation group in three
dimensions.

We know that a rotation [in @xmath ] over @xmath is equal to the
identity. However, when @xmath in Eq. ( 474 ), we see that the @xmath
group element is equal to @xmath . This behaviour is the reason why
@xmath , rather than @xmath , is used to describe particles with spin.
After all, spin @xmath particles need a rotation over @xmath in order to
return to their original state. The group @xmath is called the covering
group of @xmath .

Another Lie group which is important in the context of this thesis is
the group @xmath . Its Lie algebra is given by

  -- -------- -- -------
     @xmath      (475)
  -- -------- -- -------

and the elements of the fundamental (two-dimensional) representation are
generated by the matrices @xmath , with

  -- -- -- -------
           (476)
  -- -- -- -------

The group elements can be written in the fundamental representation as

  -- -- -- -------
           (477)
  -- -- -- -------

with @xmath and @xmath . There is no periodicity in @xmath , and the
parameter space is therefore not compact. In quantum optics, this group
is associated with squeezing .

### Chapter \thechapter Bilinear and Quadratic Forms

In many problems in quantum optics we are faced with a unitary evolution
@xmath due to a Hermitian operator @xmath (with @xmath ), generally an
interaction Hamiltonian. For computational simplicity we often wish that
this evolution is in normal ordered form. This form (or, consequently,
the corresponding Baker-Campbell-Hausdorff formula) is usually very
complicated, if it exists at all. In this appendix I present two
important classes of operators for which the normal ordered form of the
unitary evolution can be derived.

I first define the so-called bilinear and quadratic forms for the
creation and annihilation operators. We will present the normal ordering
for evolutions generated by the Hermitian operators which can be written
in terms of these bilinear and quadratic forms.

Suppose we have two vectors @xmath and @xmath . The scalar product
between these vectors is denoted by @xmath . Furthermore, let @xmath be
an @xmath matrix. With @xmath we associate the quadratic form [ 59 ]

  -- -------- -- -------
     @xmath      (478)
  -- -------- -- -------

and the bilinear form

  -- -------- -- -------
     @xmath      (479)
  -- -------- -- -------

We have made no assumptions about the nature of the vector components,
and it is possible to define bilinear and quadratic forms in terms of
creation and annihilation operators @xmath and @xmath . These operators
obey the well-known commutation relations

  -- -------- -- -------
     @xmath      (480)
  -- -------- -- -------

The quadratic form now reads @xmath or @xmath , with @xmath and @xmath .
The bilinear form can be chosen many ways (according to Eq. ( 479 )),
but for our present purposes I write it as @xmath .

In quantum optics, the bilinear and quadratic form of creation and
annihilation operators occurs very often. Take, for instance, the
interaction Hamiltonian for the beam-splitter in modes @xmath and @xmath
:

  -- -------- -- -------
     @xmath      (481)
  -- -------- -- -------

where @xmath is a coupling constant. This Hamiltonian is a bilinear form
which may be written as

  -- -------- -- -------
     @xmath      (482)
  -- -------- -- -------

Another example is the interaction Hamiltonian due to parametric
down-conversion in two modes @xmath and @xmath . This is a sum of two
quadratic forms (one for the creation and one for the annihilation
operators):

  -- -------- -- -------
     @xmath      (483)
  -- -------- -- -------

where @xmath is a coupling constant. In symmetric form, the quadratic
form of the creation operators reads

  -- -------- -- -------
     @xmath      (484)
  -- -------- -- -------

Usually, these interaction Hamiltonians are exponentiated to generate
the unitary evolution of a system, and studying the behaviour of the
bilinear and quadratic forms might simplify our computational task. In
particular, we would like to find the normal ordered form of @xmath ,
where @xmath is given by Eq. ( 481 ) or Eq. ( 483 ).

In the next two sections I will establish relations between the bilinear
and quadratic forms and the Lie algebras of @xmath and @xmath
respectively. The two resulting theorems place restrictions on the
matrix @xmath in the bilinear and quadratic forms.

### Appendix K Bilinear Forms and Su(2)

In quantum optics, linear unitary operations like beam-splitters, half-
and quarter-wave plates, phase-shifters, polarisation rotations, etc. 
all preserve the number of photons. When we write these operations as
@xmath , with @xmath some Hermitian operator (an interaction
Hamiltonian), it is clear that every term in @xmath should be a product
of an equal number of creation and annihilation operators (i.e., for
every photon which is created, another will be destroyed). The lowest
order interaction Hamiltonian which satisfies this requirement has a
bilinear form (see, e.g., Eq. ( 481 )). Furthermore, the resulting
unitary operations form representations of the group @xmath , and I
therefore study the relation between bilinear forms and @xmath .

Define @xmath to be

  -- -------- -- -------
     @xmath      (485)
  -- -------- -- -------

a bilinear form. Let @xmath be the adjoint of @xmath :

  -- -------- -- -------
     @xmath      (486)
  -- -------- -- -------

I can now define a third operator @xmath in such a way that the three
operators generate an @xmath algebra ²⁷ ²⁷ 27 Traditionally, the group
is denoted by capital letters, e.g., @xmath , whereas the corresponding
algebra is written with lowercase letters, e.g., @xmath . :

  -- -------- -- -------
     @xmath      (487)
  -- -------- -- -------

Using Eqs. ( 485 ) and ( 486 ), and normal ordering the commutator in
Eq. ( 487 ) yields

  -- -------- -- -------
     @xmath      (488)
  -- -------- -- -------

With @xmath this can be written as

  -- -------- -- -------
     @xmath      (489)
  -- -------- -- -------

The last commutation relation which, together with Eq. ( 487 ) and
@xmath , @xmath constitutes the @xmath algebra is

  -- -------- -- -------
     @xmath      (490)
  -- -------- -- -------

This equation places a constraint on the allowed matrices @xmath (all
the other commutation relations so far have not placed any restrictions
on the form of @xmath ). Using Eqs. ( 485 ), ( 486 ) and ( 488 ) yields

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (491)
     @xmath   @xmath   @xmath      (492)
  -- -------- -------- -------- -- -------

This can be summarised in the following theorem:

  Theorem 1  

    Consider a bilinear operator of the form @xmath . @xmath and @xmath
    define a third operator @xmath . These operators are generators of
    an @xmath algebra if and only if @xmath , with @xmath .

Suppose that the interaction Hamiltonian can be written as

  -- -------- -- -------
     @xmath      (493)
  -- -------- -- -------

with @xmath again a coupling constant. Note that this is now a sum of
two bilinear forms, unlike in Eq. ( 482 ). Since @xmath and @xmath
generate an @xmath algebra, we know what the normal ordering for the
unitary evolution @xmath associated with this interaction Hamiltonian is
( @xmath and @xmath is the unit vector in the direction of @xmath ) [
164 ] :

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (494)
              @xmath               (495)
  -- -------- -------- -------- -- -------

This is the Baker-Campbell-Hausdorff formula for @xmath [ 69 ] .

### Appendix L Quadratic Forms and Su(1,1)

In quantum optics, squeezers and down-converters are described by
interaction Hamiltonians which are quadratic in the creation and
annihilation operators. These Hamiltonians generate unitary
transformations which do not conserve the photon number. In particular,
these transformations can be viewed as photon sources.

Write the unitary evolution of these sources as @xmath , with @xmath a
Hermitian operator (the interaction Hamiltonian). Here, every term in
@xmath is proportional to a product of either two creation or two
annihilation operators, i.e., @xmath is proportional to a sum of
quadratic forms. Subsequently we know that squeezing and parametric
down-conversion are representations of the group @xmath , and I
therefore study the relation between this group and quadratic forms.

Let @xmath be a quadratic form:

  -- -------- -- -------
     @xmath      (496)
  -- -------- -- -------

Since the annihilation operators commute, it is clear that @xmath can
always be chosen symmetric. The adjoint of @xmath is given by

  -- -------- -- -------
     @xmath      (497)
  -- -------- -- -------

When we want to construct an @xmath algebra with these operators we need
to show that there exists an operator @xmath which satisfies the
commutation relations

  -- -------- -- -------
     @xmath      (498)
  -- -------- -- -------

The first relation in Eq. ( 498 ) defines @xmath :

  -- -------- -- -------
     @xmath      (499)
  -- -------- -- -------

The second relation in Eq. ( 498 ) places a constraint on @xmath :

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (500)
     @xmath   @xmath   @xmath      (501)
  -- -------- -------- -------- -- -------

The matrix @xmath is unitary if it is invertible.

I can now formulate these results in terms of a theorem:

  Theorem 2  

    Consider a quadratic operator of the form @xmath . @xmath and @xmath
    define a third operator @xmath . These operators are generators of
    an @xmath algebra if and only if @xmath . Such a @xmath is unitary
    if and only if it is invertible.

Suppose that the interaction Hamiltonian can be written as

  -- -------- -- -------
     @xmath      (502)
  -- -------- -- -------

with @xmath the coupling constant. Since @xmath and @xmath generate an
@xmath algebra, we know what the normal ordering for the unitary
evolution @xmath associated with this interaction Hamiltonian is (
@xmath ) [ 164 ] :

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (503)
              @xmath               (504)
  -- -------- -------- -------- -- -------

This is the Baker-Campbell-Hausdorff formula for @xmath .

### Chapter \thechapter Transformation properties of maximal
entanglement

In this appendix I will show ²⁸ ²⁸ 28 This is not new material, it is
included here for reasons of completeness. that any maximally entangled
state can be transformed into any other maximally entangled state by
means of a unitary transformation on only one of the subsystems. I will
treat this in a formal way by considering an arbitrary maximally
entangled state of two @xmath -level systems in the Schmidt
decomposition:

  -- -------- -- -------
     @xmath      (505)
  -- -------- -- -------

that is, a state with equal amplitudes on all possible branches. There
always exist two orthonormal bases @xmath and @xmath such that Eq. ( 505
) can be written this way, by virtue of the definition for maximal
entanglement. Clearly, we can obtain any maximally entangled state by
applying the (bi-local) unitary transformation @xmath . That is, each
maximally entangled state can be transformed into any other by a pair of
local unitary transformations on each of the subsystems. We will now
show that any two maximally entangled states @xmath and @xmath are
connected by a local unitary transformation on one subsystem alone:

  -- -------- -- -------
     @xmath      (506)
  -- -------- -- -------

First, I will prove that any transformation @xmath on a particular
maximally entangled state @xmath can be written as @xmath , where @xmath
. To this end I will give the proofs for two theorems. Take the special
maximally entangled state

  -- -------- -- -------
     @xmath      (507)
  -- -------- -- -------

  Theorem 1:  

    For any state @xmath given by Eq. ( 507 ) and any unitary operator
    @xmath we have

      -- -------- -- -------
         @xmath      (508)
      -- -------- -- -------

  Proof:  

    Using the completeness relation

      -- -------- -- -------
         @xmath      (509)
      -- -------- -- -------

    on both subsystems we have

      -- -------- -- -------
         @xmath      (510)
      -- -------- -- -------

    By writing out @xmath explicitly according to Eq. ( 507 ) we obtain

      -- -------- -------- -------- -- -------
         @xmath   @xmath   @xmath      (511)
                  @xmath   @xmath      (512)
                  @xmath   @xmath      (513)
      -- -------- -------- -------- -- -------

    which is just @xmath . @xmath

  Theorem 2:  

    Every unitary transformation @xmath acting on the state @xmath given
    by Eq. ( 507 ) is equivalent to a transformation @xmath acting on
    @xmath , where @xmath .

  Proof:  

    The equality

      -- -------- -- -------
         @xmath      (514)
      -- -------- -- -------

    together with theorem 1 immediately gives us

      -- -------- -------- -------- -- -------
         @xmath   @xmath   @xmath      (515)
         @xmath   @xmath   @xmath      (516)
      -- -------- -------- -------- -- -------

    From Eq. ( 515 ) we obtain

      -- -------- -------- -------- -- -------
         @xmath   @xmath   @xmath      (517)
                  @xmath               (518)
                  @xmath   @xmath      (519)
      -- -------- -------- -------- -- -------

    Similarly,

      -- -------- -- -------
         @xmath      (520)
      -- -------- -- -------

    We therefore obtain that @xmath is equal to @xmath with @xmath , and
    similarly that it is equal to @xmath with @xmath . @xmath

Since every maximally entangled state can be obtained by applying @xmath
to @xmath , two maximally entangled states @xmath and @xmath can be
transformed into any other by choosing

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (521)
     @xmath   @xmath   @xmath      (522)
  -- -------- -------- -------- -- -------

which gives

  -- -------- -- -------
     @xmath      (523)
  -- -------- -- -------

Thus each maximally entangled two-system state can be obtained from any
other by means of a local unitary transformation on one subsystem alone.

### Chapter \thechapter Statistical Distance

In this appendix I review the concept of the statistical distance. It is
first and foremost a concept form classical probability theory, which
has been extended to quantum theory by Wootters [ 177 ] , Hilgevoord and
Uffink [ 84 ] and Braunstein and Caves [ 29 ] .

Suppose we have a vase containing red, blue and green marbles in some
proportion. We can draw a marble from the vase and register its colour.
When the proportion of red, blue and green marbles is known, we can
predict that we will draw a red marble with some probability @xmath . In
this situation the probability quantifies our uncertainty of prediction
.

Alternatively, we might be in a different situation where the proportion
of red, blue and green marbles is not known. When we draw a marble, it
gives us extra knowledge which can be used to estimate the proportion of
marbles. We do not know for certain what the proportion is until we have
drawn all the marbles from the vase, but every new draw will yield extra
information about the proportion. The number of drawn red, blue and
green marbles estimates the probability distribution of drawing red,
blue and green marbles, and the uncertainty after a number of draws is
the uncertainty of inference . There are therefore two kinds of
uncertainty: one associated with the prediction of the outcome of a
stochastic process and one associated with the inference of a
probability distribution based on a set of outcomes [ 84 ] .

The statistical distance quantifies the distinguishability of two
probability distributions, and is therefore closely related to the
uncertainty of inference. Since it is a distance, it obeys the four
well-known requirements [ 39 ] :

1.  A distance @xmath between two points @xmath and @xmath is positive;

2.  @xmath if and only if @xmath ;

3.  the distance is symmetric: @xmath ;

4.  the distance obeys the triangle inequality: @xmath .

The points @xmath , @xmath and @xmath are elements of some (continuous)
space. In the case of the statistical distance, these points are
probability distributions, which are elements of the so-called
probability simplex (see figure 24 ).

The distance function in a space (in this case the simplex) is defined
by the so-called metric . The metric @xmath is a real symmetric matrix
which obeys @xmath , where @xmath is the Kronecker delta. Furthermore,
it transforms covariant vectors @xmath to contravariant vectors @xmath ,
distinguished by lower and upper indices respectively ²⁹ ²⁹ 29 To avoid
confusion, I will not use Einstein’s summation convention. :

  -- -------- -- -------
     @xmath      (524)
  -- -------- -- -------

The contraction @xmath yields a scalar (which is invariant under all
transformations).

In general, an (incremental) distance @xmath on the simplex separating
points @xmath and @xmath can be written as a quadratic form

  -- -------- -- -------
     @xmath      (525)
  -- -------- -- -------

This is a scalar which is invariant under all coordinate
transformations. The @xmath are the components of the incremental
tangent vector @xmath along the shortest path between the two
probability distributions in the probability simplex. We now aim to find
the metric @xmath of the simplex.

To this end, we define the dual @xmath to @xmath , i.e., every component
@xmath is paired with the component @xmath :

  -- -------- -- -------
     @xmath      (526)
  -- -------- -- -------

where @xmath can be interpreted as the mean value of @xmath . In order
to find the metric, we look at the two-point correlation function of
@xmath :

  -- -------- -- -------
     @xmath      (527)
  -- -------- -- -------

The last equality is obtained by using Eq. ( 526 ). From this we
immediately obtain the contravariant form of the metric:

  -- -------- -- -------
     @xmath      (528)
  -- -------- -- -------

with @xmath the Kronecker delta. Since @xmath , the covariant metric is
@xmath and the statistical distance becomes

  -- -------- -- -------
     @xmath      (529)
  -- -------- -- -------

This is the incremental statistical distance used in chapter \thechapter
. When we make the substitution @xmath , we find the Euclidean distance
@xmath .

Note that @xmath tends to infinity when one of the probabilities @xmath
equals zero. This is expected since a probability distribution @xmath
with @xmath is perfectly distinguishable from a distribution @xmath with
@xmath : one outcome corresponding to @xmath will immediately tell us
that we have the probability distribution @xmath .

In order to find the statistical distance between two well separated
probability distributions, we have to integrate Eq. ( 529 ). Following
Wootters [ 177 ] , we find

  -- -------- -- -------
     @xmath      (530)
  -- -------- -- -------

In other words, the statistical distance is the angle between two
vectors with coordinates @xmath and @xmath . Wootters [ 177 ] proved
that this distance measure is the only Riemannian distance measure in a
Hilbert space, which is invariant under all transformations. It should
be noted that we only assumed classical probability theory in our
derivation, which makes the appearance of probability amplitudes even
more surprising.

An alternative way to arrive at the statistical distance is by using the
Gaussian distribution for the observed frequencies @xmath in a large
number ( @xmath ) of trials [ 142 , 29 ] :

  -- -------- -- -------
     @xmath      (531)
  -- -------- -- -------

Two probability distributions @xmath and @xmath can then be
distinguished if and only if the Gaussian function @xmath is small. In
other words, if @xmath we need

  -- -------- -- -------
     @xmath      (532)
  -- -------- -- -------

or

  -- -------- -- -------
     @xmath      (533)
  -- -------- -- -------

which is consistent with Eq. ( 151 ).

### Chapter \thechapter Multi-Dimensional Hermite Polynomials

In this appendix I will give the background of multi-dimensional Hermite
polynomials. Early introductions to the subject were presented by
P. Appell and J. Kampé de Fériet [ 3 ] , and in the Bateman Manuscript
Project [ 59 ] . M.M. Mizrahi [ 121 ] and M. Klauderer [ 96 ] further
developed the mathematical theory, and in the context of quantum optics
multi-dimensional Hermite polynomials have been applied by V.V. Dodonov,
V.I. Man’ko, O.V. Man’ko, V.V. Semjonov, A.  Vourdas and R.M. Weiner [
52 , 53 , 54 , 169 ] .

### Appendix M Ordinary Hermite Polynomials

First, let me revisit the case of the ordinary Hermite polynomials,
which are known to physicists as (part of) the eigenfunctions of the
linear harmonic oscillator in quantum mechanics (see, for example
Merzbacher [ 119 ] ).

The definition of the Hermite polynomials can be obtained by the
construction of a so-called generating function @xmath :

  -- -------- -- -------
     @xmath      (534)
  -- -------- -- -------

The last equality will give rise to our definition of the Hermite
polynomials @xmath . In order to arrive at this definition we use
Taylors expansion:

  -- -------- -- -------
     @xmath      (535)
  -- -------- -- -------

where @xmath denotes the derivative taken with respect to @xmath . The
second equality collects the derivatives in the exponential function
@xmath . Using this relation we write the generating function as

  -- -------- -- -------
     @xmath      (536)
  -- -------- -- -------

By expanding the exponential @xmath and comparing with Eq. ( 534 ) we
obtain the definition of the Hermite polynomials @xmath :

  -- -------- -- -------
     @xmath      (537)
  -- -------- -- -------

Every @xmath is a polynomial with @xmath real roots and traditionally
normalised in such a way that the leading term @xmath has pre-factor
@xmath .

There are several relations connecting Hermite polynomials. For
instance, the Hermite polynomials obey the orthogonality relation:

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (538)
     @xmath   @xmath   @xmath      (539)
  -- -------- -------- -------- -- -------

This relation ensures that the eigenfunctions of the harmonic oscillator
are orthonormal.

Furthermore, there are two types of recursion relations connecting
Hermite polynomials of different order. From the generating function in
Eq.  ( 534 ) it is relatively straightforward to derive the recursion
relations

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (540)
     @xmath   @xmath   @xmath      (541)
  -- -------- -------- -------- -- -------

Combining these two relations yields a second-order homogeneous
differential equation called the Hermite equation :

  -- -------- -- -------
     @xmath      (542)
  -- -------- -- -------

### Appendix N Real Multi-Dimensional Hermite Polynomials

The ordinary Hermite polynomials are functions of one variable @xmath .
The obvious way to generalise this is taking @xmath to be a vector
@xmath in an @xmath -dimensional vector space. The generating function
of the multi-dimensional Hermite polynomial (henceforth called MDHP )
then has to change accordingly: @xmath .

However, rather than replacing @xmath by @xmath and @xmath by @xmath
(where we denote the inner product of two vectors @xmath and @xmath by
@xmath ), we take the generating function to be [ 59 ]

  -- -------- -- -------
     @xmath      (543)
  -- -------- -- -------

where @xmath is a positive definite @xmath matrix, called the defining
matrix . We can always choose @xmath symmetric. The reason we choose
this generating function is that we now also include cross-terms @xmath
and @xmath . Without these cross-terms the generalisation would be
trivial. When we define @xmath as an @xmath -tuple @xmath with @xmath a
non-negative integer, @xmath generates the multi-dimensional Hermite
polynomials:

  -- -------- -- -------
     @xmath      (544)
  -- -------- -- -------

In this equation, @xmath means the sum over all possible @xmath -tuples
@xmath .

The generating function leads to the following definition of the real
multi-dimensional Hermite polynomial:

  -- -------- -- -------
     @xmath      (545)
  -- -------- -- -------

This definition is derived analogous to the one-dimensional case, which
was presented above.

### Appendix O Reduction theorem

In order to simplify the derivation of the orthogonality and recursion
relations for the real MDHP ’s, I derived a Reduction Theorem :

  Reduction Theorem:  

    For any real @xmath -dimensional generating function @xmath with
    positive definite defining matrix @xmath there exists a linear
    transformation @xmath which transforms @xmath into a product of
    @xmath generating functions of one-dimensional Hermite polynomials:

      -- -------- -- -------
         @xmath      (546)
      -- -------- -- -------

    where @xmath is the number of zero eigenvalues of @xmath .

  Proof:  

    This theorem is proved by explicit construction of @xmath . The
    transformation has two parts: an orthogonal transformation and a
    rescaling. The @xmath matrix @xmath is real and symmetric. It can
    therefore be diagonalised by an orthogonal matrix @xmath [ 68 ] :

      -- -------- -- -------
         @xmath      (547)
      -- -------- -- -------

    and

      -- -------- -- -------
         @xmath      (548)
      -- -------- -- -------

    This last term can be written as @xmath . The generating function of
    a real MDHP then transforms as

      -- -------- -- -------
         @xmath      (549)
      -- -------- -- -------

    We can now rescale the transformed coordinates @xmath and @xmath :

      -- -------- -- -------
         @xmath      (550)
      -- -------- -- -------

    This rescaled transformation of the generating function of a real
    MDHP then gives

      -- -------- -- -------
         @xmath      (551)
      -- -------- -- -------

    where @xmath is the number of zero eigenvalues of @xmath . This is
    the transformation @xmath whose existence we had to prove. @xmath

Since the new variables in Eq. ( 546 ) are linearly independent, the
reduced generating function trivially generates the ordinary Hermite
polynomials. We can now derive the orthogonality relation of the real
MDHP ’s.

### Appendix P Orthogonality relation

The Reduction Theorem yields the diagonalised form:

  -- -------- -- -------
     @xmath      (552)
     @xmath      (553)
  -- -------- -- -------

Since the Jacobian @xmath of an orthogonal transformation @xmath is
equal to 1, I omit it here. We can now transform Eq. ( 552 ) back to the
non-diagonalised case. This yields

  -- -------- -- -------
     @xmath      (554)
  -- -------- -- -------

The orthogonality relations for the real MDHP ’s are then:

  -- -------- -- -------
     @xmath      (555)
     @xmath      (556)
  -- -------- -- -------

### Appendix Q Recursion relations

There are two classes of recursion relations for the real
multi-dimensional Hermite polynomials. First, we present the
differential recursion relations, which form a generalisation of Eq. (
540 ). Subsequently, we present the type of recursion relations which
form a generalisation of Eq.  ( 541 ).

In the generalised form of the Hermite polynomials, we wish to evaluate
the derivative @xmath . We proceed again from the generating function
@xmath :

  -- -------- -- -------
     @xmath      (557)
  -- -------- -- -------

Furthermore, from Eq. ( 544 ) we obtain

  -- -------- -- -------
     @xmath      (558)
  -- -------- -- -------

Expanding the right-hand side of Eq. ( 557 ) into Hermite polynomials
and equating it with the right-hand side in Eq. ( 558 ) yields

  -- -------- -- -------
     @xmath      (559)
  -- -------- -- -------

where @xmath denotes the vector @xmath with @xmath replaced by @xmath .
Comparing the terms with equal powers in @xmath yields the generalised
differential recursion relation

  -- -------- -- -------
     @xmath      (560)
  -- -------- -- -------

This relation is easily generalised for multiple derivatives on @xmath .

The second recursion relation is given by

  -- -------- -- -------
     @xmath      (561)
  -- -------- -- -------

This relation can be proved by taking the derivative to @xmath and using
the recursion relation ( 560 ).

### Chapter \thechapter Mathematica Code for Teleportation Modelling

In this appendix, I present the Mathematica code I used to derive the
results of chapter \thechapter .

    Krondelta [j_, k_] := If[ j == k, Return [ 1 ], Return [ 0 ] ]

    f [ ] := 1
    f [0] := 0
    f [y___, 1, x___ ] := f[y,x]

    f[x___, y_ + z_, w___] := f[x, y, w] + f[x, z, w]

    (*
       Let’s define annihilation ops for polarisation k = "x" or "y"
       on mode j = 1, 2, 3, 4, or "a", "u", "v", "d" as a[k,j]
       and the creation ops as ad[k,j]
    *)

    f[ x___, n_  a[k_ ,j_ ], w___ ] := n f [ x,  a[k, j ], w ]
    f[ x___, n_ ad[k_ ,j_ ], w___ ] := n f [ x, ad[k, j ], w ]

    (*
       The normal ordering rule preserves commutator algebra.
    *)

    normOrder := f[ x___, a[k_, j_ ], ad[kk_, jj_ ], w___ ] :>
                 f[ x, ad[kk, jj ], a[k, j ], w ] +
                 Krondelta [ k, kk ] Krondelta [ j, jj ] f[x, w]

    f[ x___, n_. f[y___], w___] := n f[ x, y, w ]

    (*
       To what order do we expand the exponential.
    *)

    expandExp1 := myExp1[ x__ ] :> g[ x ] + g[ x, x ]/2

    expandExp2 := myExp2[ x__ ] :> g[ 1 ] + g[ x ]

    cutEnd := { g [ x_ ] :> ExpandAll[ x ],
    Ψ    g [ y___, x_] :> f[ g [ y ], ExpandAll [ x ] ] }

    (* Calculate the creation and annihilation results *)

    numReduce := { f[ x___, ad[k_, ll_], aa__ ket[k_, ll_, n_ ] ] :>
                            Sqrt[n+1] f[ x, aa ket[ k, ll, n+1 ] ],
                   f[ x___, a[k_, ll_ ], aa__ ket[k_, ll_, n_ ] ] :>
                            Sqrt[n] f[ x, aa ket[ k, ll, n-1 ] ] ,

    (* and the adjoint  *)

                   f[ bra[k_, ll_, n_ ] aa__, ad[k_, ll_], x___ ] :>
                            Sqrt[n] f[ aa bra[ k, ll, n-1 ], x ],
                   f[ bra[k_, ll_, n_ ] aa__, a[k_, ll_ ], x___ ] :>
                            Sqrt[n+1] f[ aa bra[ k, ll, n+1 ], x ]
    Ψ     }

    (* The concise Form *)

    consiseForm :=  f[ket["x", h3_, o_] ket["y", h3_, p_]] *
                    f[bra["x", bh3_, bo_] bra["y", bh3_, bp_]] :>
           Infix[{" | ",o,", ",p," > < ",bo,", ",bp," |"}, "" ]

    (*
       The beam-splitter has five entries: the first two are the input modes,
       the third and the fourth are the respective output modes and the fifth
       entry gives the beam-splitters coefficient.
    *)

    beamSplitter[ am_, bm_, cm_, dm_, eta_ ] :=
      { ad[ "x", am ] :> Sqrt[eta] ad[ "x", cm ] + Sqrt[1 - eta] ad[ "x", dm ],
         a[ "x", am ] :> Sqrt[eta]  a[ "x", cm ] + Sqrt[1 - eta]  a[ "x", dm ],
        ad[ "x", bm ] :> Sqrt[1 - eta] ad[ "x", cm ] - Sqrt[eta] ad[ "x", dm ],
         a[ "x", bm ] :> Sqrt[1 - eta]  a[ "x", cm ] - Sqrt[eta]  a[ "x", dm ],
        ad[ "y", am ] :> Sqrt[eta] ad[ "y", cm ] + Sqrt[1 - eta] ad[ "y", dm ],
         a[ "y", am ] :> Sqrt[eta]  a[ "y", cm ] + Sqrt[1 - eta]  a[ "y", dm ],
        ad[ "y", bm ] :> Sqrt[1 - eta] ad[ "y", cm ] - Sqrt[eta] ad[ "y", dm ],
         a[ "y", bm ] :> Sqrt[1 - eta]  a[ "y", cm ] - Sqrt[eta]  a[ "y", dm ],
         ket[ "x", am, n_ ] :> ket[ "x", cm, n ],
         ket[ "y", am, n_ ] :> ket[ "y", cm, n ],
         ket[ "x", bm, n_ ] :> ket[ "x", dm, n ],
         ket[ "y", bm, n_ ] :> ket[ "y", dm, n ]
      }

    (*
       The polarisation filter performs a rotation over an angle theta (the
       second entry) on mode am (the first entry). The two directions of
       polarisation are called "x" and "y".
    *)

    polarizeFilter[ am_, theta_, aam_ ] := {
        ad["x", am] :>   Cos[theta] ad["x", aam ] + Sin[theta] ad["y", aam ],
         a["x", am] :>   Cos[theta]  a["x", aam ] + Sin[theta]  a["y", aam ],
        ad["y", am] :> - Sin[theta] ad["x", aam ] + Cos[theta] ad["y", aam ],
         a["y", am] :> - Sin[theta]  a["x", aam ] + Cos[theta]  a["y", aam ],
        ket[ "x", am, n_ ] :> ket[ "x", aam, n ],
        ket[ "y", am, m_ ] :> ket[ "y", aam, m ]
      }

    (* The takeAdjoint rule changes kets into bras.  *)

    takeAdjoint := ket[ k_, l_, n_ ] :> bra[ k, l, n ]

    (*
       Polarisation insensitive detector. It assumes detectors cannot distinguish
       between a pulse containing one or more photons. The POVM acts on mode l and
       loss is Sqrt[1-efficiency^2]. The perfect detector therefore corresponds to
       loss=0. Loss is the AMPLITUDE loss.
    *)

    povMeasure[ b_, loss_ ] := f[ z__ ket[ "x", b, n_] ket[ "y", b, m_ ]] :>
      Sqrt[1-loss^( 2(n + m) )] f[z ket[ "x", b, n ] ket[ "y", b, m ]]


    povAngle[ mode_, loss_ ] := {
       f[ z__ ket["x", mode, n_ ]] :> loss^n f[ z ket["x", mode, n]],
       f[ z__ ket["y", mode, m_ ]] :> loss^m f[ z ket["y", mode, m]]
    ΨΨΨ    }

    povHit[pol_, mode_, loss_ ] :=
      f[ z__ ket[pol, mode, m_ ]] :> Sqrt[1-loss^(2m)] f[ z ket[pol, mode, m]]

    povMiss[pol_, mode_, loss_ ] :=
      f[ z__ ket[pol, mode, m_ ]] :> loss^m f[ z ket[pol, mode, m]]

    (* partialTrace[ mode_ ] takes the partial trace of mode "mode".  *)

    partialTrace[ mode_ ] := {
    Ψf[l__ bra[ "y", mode, n_ ] u__ ] f[w__ ket[ "y", mode, m_ ] v__ ] :>
     ΨΨf[l u] f[w v] Krondelta[ n, m ],
    Ψf[l__ bra[ "x", mode, n_ ] u__ ] f[w__ ket[ "x", mode, m_ ] v__ ] :>
    ΨΨf[l u] f[w v] Krondelta[ n, m ]
    ΨΨΨ }

    xTrace[ mode_ ] := {
    Ψf[l__ bra[ "x", mode, n_ ] u__ ] f[w__ ket[ "x", mode, m_ ] v__ ] :>
    ΨΨf[l u] f[w v] Krondelta[ n, m ]
    ΨΨΨ }

    yTrace[ mode_ ] := {
    Ψf[l__ bra[ "y", mode, n_ ] u__ ] f[w__ ket[ "y", mode, m_ ] v__ ] :>
    ΨΨf[l u] f[w v] Krondelta[ n, m ]
    ΨΨΨ }

    (*
       In the procedure "myCalc", ketval is assigned the function corresponding
       to the unitary transformation of creating EPR-pairs. After expansion to a
       certain order the beam-splitter on modes "b" and "c" is applied, the
       polarisation rotation on mode "a" is performed and the creation operators
       are calculated. Then the Hermitian conjugate is computed. With this we
       can define the density operator (densval). But first we apply the POVM on
       "u" and "v". After expanding the density operator we take the partial
       traces of "a", "u" and "v", which gives us the output mode "d".
    *)

    (*
       In the line "ketval = f[ myExp [ ...", tau corresponds to the normal
       ordered function tau/|tau| tanh(|tau|), and NOT the tau due to the
       Hamiltonian.
    *)

    myCalc := Block[ {ketval, braval, densval, myval},
      ketval = f [ myExp1 [ tau f [ ad[ "x", "a"], ad [ "y", "b"] ] -
                      tau f [ ad[ "y", "a"], ad [ "x", "b"] ] ],
    Ψ       myExp2 [ tau f [ ad[ "x", "c"], ad [ "y", "d"] ] -
                      tau f [ ad[ "y", "c"], ad [ "x", "d"] ] ],
                      ket[ "x", "a", 0 ] ket [ "x", "b", 0] *
                      ket[ "y", "a", 0 ] ket [ "y", "b", 0] *
                      ket[ "x", "c", 0 ] ket [ "x", "d", 0] *
                      ket[ "y", "c", 0 ] ket [ "y", "d", 0] ];

      ketval = ketval /. beamSplitter[ "b", "c", "u", "v", 1/2 ];
      ketval = ketval /. polarizeFilter["a", theta, "a1" ];
      Print[ "<< beamSplitters and polarizeFilter >>" ];

      ketval = ketval /. expandExp1;
      ketval = ExpandAll[ ketval /. cutEnd ];
      ketval = ketval //. numReduce;
      ketval = ExpandAll[ ketval /. cutEnd ];
      ketval = ketval //. numReduce;
      Print[ "<< expandExp1 >>" ];

      ketval = ketval /. expandExp2;
      ketval = ExpandAll[ ketval /. cutEnd ];
      ketval = ketval //. numReduce;
      Print[ "<< expandExp2 >>" ];

      Save[ "ketval.m", ketval ];

      ketval = ketval /. povMeasure[ "u", loss1 ];
      ketval = ketval /. povMeasure[ "v", loss2 ];

      ketval = ketval /. povHit [ "x", "a1", loss3];
      ketval = ketval /. povMiss [ "y", "a1", loss3];

      Print[ "<< POVM’s >>" ];

      ketval = ExpandAll[ ketval ];

      Print[ "<< expansion >>" ];

      braval = ketval /. takeAdjoint;

      ketlen = Length [ ketval ];
      bralen = Length [ braval ];
      Print[ "<< ketlen = ", ketlen, " >>" ];

      densval = Sum [
           Print [ N[ 100. jj / ketlen, 3] , " %" ];
           Sum [
            myval = ketval [[jj]] braval [[kk]];
    Ψmyval = myval /. {tau^6 -> 0};
            myval = myval //. partialTrace[ "u" ];
            myval = myval //. partialTrace[ "v" ];
    Ψmyval = myval //. partialTrace[ "a1"],
              { kk, 1, bralen }
               ],
              { jj, 1, ketlen }
                    ];

      Save[ "densval4cas1.m", densval ];

      densval = Collect [ densval, tau ];
      densval = densval /. consiseForm;
      densval = Simplify[ densval, TimeConstraint -> Infinity ]
    ]

### Chapter \thechapter Genetic Algorithms

In this appendix I review genetic algorithms. In the first section I
present the basics behind these algorithms [ 120 ] , and in the second
section I describe the so-called differential evolution -approach by
Price and Storn [ 137 ] . It was this method I used in chapter
\thechapter . The fortran code of this application is given in the last
section.

### Appendix R Genetic algorithms

Genetic algorithms can be used to find the best solution to a given
problem. As the name already suggests, it is based on ‘natural
selection’ over several generations of a ‘population’ of solutions to
the problem. It works as follows.

Suppose we have a problem with a set of possible solutions. This set
generally spans a high dimensional solution space. For instance, when
the solutions to a particular problem are given by @xmath (with @xmath
its variable and @xmath , @xmath and @xmath constants), the solution
space is a three-dimensional space spanned by the vectors @xmath . In
addition, we have a selection criterion which gives us a measure of the
‘fitness’ of a solution. For example, we might define the fitness of a
solution as a distance measure between a function @xmath and a solution
@xmath . The smaller this distance, the fitter the solution. One such
fitness measure for the example above may be given by

  -- -------- -- -------
     @xmath      (562)
  -- -------- -- -------

In the genetic representation, the numbers @xmath , @xmath and @xmath
are the genes of a particular solution.

In any genetic algorithm, we first select a population of @xmath
solutions

  -- -------- -- -------
     @xmath      (563)
  -- -------- -- -------

where @xmath is the population (taken at the initial time @xmath ) and
@xmath a candidate solution to the problem. The solutions are evaluated
using the fitness measure, yielding a measure set @xmath , where @xmath
is a number associated with the fitness of solution @xmath .

Depending on the details of our problem, we are looking for the smallest
or the largest number @xmath . Suppose better fitness means a smaller
@xmath , then we choose the solution @xmath corresponding to the
smallest @xmath in our measure set. Let @xmath be the best solution for
this population. It will be stored in the memory. This memory slot is
reserved for the best solution, and it will be updated if some solution
@xmath from a later generation outperforms @xmath .

The next step is the crucial step of genetic algorithms. The old
generation, the population @xmath , will now determine the next
generation @xmath of solutions. Low fitness solutions from @xmath ,
however, will be discarded: evolution has destined them to die. Thus
only the fittest individuals from a population will generate a new
population: they are making babies.

Just as in the offspring of real populations, the children inherit the
traits of their parents. But they differ too. In biology, organisms
often produce genetically different offspring by using crossover , in
which genes of the parents are mixed. In a population of solutions to a
mathematical problem, we can also introduce crossover. For example, when
two solutions @xmath and @xmath are determined by the vectors

  -- -------- --
     @xmath   
  -- -------- --

crossover can produce a child-solution @xmath , where ‘genes’ @xmath ,
@xmath and @xmath are taken from parent 1 and ‘genes’ @xmath and @xmath
from parent 2.

A second mechanism for inducing changes in subsequent generations is
mutation . In real life, background radioactivity or free radicals
induce changes in the DNA structure which will affect future
generations. Most of the time these changes are a setback and will be
eliminated in the next generation, but once in a while it increases an
individual’s fitness.

Using crossover and mutation, a new population is formed. This is the
next generation. The population size is usually held constant, but this
is not necessary. The new population is again evaluated, yielding a
measure set @xmath . The fittest solution of this generation is chosen,
and will replace the previous one if it is better.

Next, the process of offspring generation using crossover and mutation
is repeated to generate a population @xmath , the members of which are
again tested for their fitness, and so on. This process terminates after
a given number of generations (see also figure 25 ).

Since less fit members of the parent population do not make children,
the genetic algorithm does not conduct a random search in the solution
space. Also, since the best overall solution is recorded, it is not
necessarily a member of the final population. For example, looking for
artistic and scientific traits in the human population, The genetic
algorithm would probably select Leonardo da Vinci, even though he died
in 1519.

In short, an optimisation algorithm is a genetic algorithm if it meets
the following criteria:

1.  The problem must allow a genetic representation for potential
    solutions. For example, a vector has a genetic representation, in
    which the entries correspond to genes. As we have seen, crossover
    exchanges these genes.

2.  An initial population has to be created and a mechanism for
    producing the next generation must be given.

3.  A fitness measure has to be defined in order to guide the evolution.
    It plays the role of the environment in the sense that it induces
    ‘natural selection’.

4.  The algorithm needs a crossover and mutation mechanisms to allow the
    generations to evolve.

5.  Finally, the algorithm needs parameters like population size, number
    of generations, mutation probabilities, etc.

In the next section, I will take a closer look at differential
evolution.

### Appendix S Differential evolution

The main difference between genetic algorithms and differential
evolution lies in the parent-child relationship. In genetic algorithms
described in the previous section, two ³⁰ ³⁰ 30 Or more: why let biology
restrict this mathematical protocol? parents pass their genes on to a
child by means of uniform crossover. This means that all parents have
equal probability to pass on their genes to their children (note the
distinction with the unequal probability for members of a population of
having offspring at all).

In differential evolution, however, a fitter parent has a higher
probability of passing on its genes to the child. The child is thus more
closely related to its fitter parent, and is likely to have a good
fitness rating. This accommodates a more directed evolution, in which
successful branches are biased [ 137 ] .

### Appendix T Fortran code for lithography

I used a genetic algorithm to optimise one-dimensional quantum
lithography used in the creation of a trench function. I have omitted
the fitness function because it is quite lengthy. It can easily be
generated using Mathematica .

            program genetic
    c       uses a GENETIC search algorithm
            implicit real*8 (a-h, o-z)
            integer time
            real RAN
            external time, RAN

    c       number of parameters to fit
            parameter (n = 21)
    c       maximum number of generations
            parameter ( gen_max = 1000 )
    c       population size
            parameter ( NP = n*10 )
    c       scaling mutation parameter
            parameter ( Fscale = 0.5 )
    c       recombination parameter
            parameter ( CR = 0.1 )
            real*8 x1(n, NP), x2(n, NP), trial(n), cost(NP), psmallest(n)
    c
    c       set the random seed
            iseed = time()
    c       iseed = 950015448
    c
    c       initialization
            do 800 i = 1, NP
              do 700 j = 1, n-1
                trial(j) = 2.0d0*RAN(iseed) - 1.0d0
                x1(j,i) = trial(j)
    700       continue
    c       initialise the exposure time parameter
              trial(21) = 1.0d-2*RAN(iseed)
              x1(21,i) = trial(21)
              cost(i) = f( n, trial )
    c         write(*,*) i, trial, cost(i)
    800     continue
    c       initialise ‘smallest’
            jsmallest = 1
            smallest = cost(1)*10

    c       halt after ‘gen_max’ generations
            do 2000 jgen = 1, gen_max
    c       loop through the population
              do 1800 i = 1, NP
    c       mutate and recombine.
    c       randomly generate three *different* vectors from each other and ‘i’
    1001        ia = 1.0 + NP*RAN(iseed)
                if ( ia.eq.i ) goto 1001
    1002        ib = 1.0 + NP*RAN(iseed)
                if ( (ib.eq.i) .or. (ib.eq.ia) ) goto 1002
    1003        ic = 1.0 + NP*RAN(iseed)
                if ( (ic.eq.i) .or. (ic.eq.ia) .or. (ic.eq.ib) ) goto 1003
    c       randomly pick the first parameter
                j = 1.0 + RAN(iseed)*n
    c       load n parameters into trial; perform n - 1 binomial trials
                do 1300 k = 1, n
                  if ( (RAN(iseed).le.CR) .or. (k.eq.n) ) then
    c       source for ‘trial(j)’ is a random vector plus weighted differential..
                    trial(j) = x1(j,ic)+Fscale*( x1(j,ia) - x1(j,ib) )
                  else
    c       ... or the trial parameter comes from ‘x1(j,i)’ itself.
                    trial(j) = x1(j,i)
                  end if
    c       get the next ‘j’ modulo n
                  j = j + 1
                  if ( j.gt.n ) j = 1
    c       last parameter ‘k=n’ comes from noisy random vector.
    1300        continue
    c       evaluate/select.
    c       score this trial
                score = f ( n, trial )
                if ( score.le.cost(i) ) then
                  do 1400 j = 1, n
    c       move trial to secondary vector (for next generation) ..
                    x2(j,i) = trial(j)
    1400          continue
                  cost(i) = score
                else
                  do 1450 j = 1, n
    c       ... or place the old population member there
                    x2(j,i) = x1(j,i)
    1450          continue
                end if
    1800      continue

    c       end of population, swap arrays; move x2 onto x1 for next round
              do 1500 i = 1, NP
                do 1490 j = 1, n
                  x1(j,i) = x2(j,i)
    1490        continue
    1500      continue

    c       keep a record of progress so far
              do 1900 j = 1, NP
                if ( cost(j).lt. smallest ) then
                  smallest = cost(j)
                  jsmallest = j
                  do 1600 kkk = 1, n
                    psmallest(kkk) = x1(kkk,jsmallest)
    1600Ψ      continue
                end if
    c           write(*,*) jgen, j, cost(j)
    1900      continue
    c       display the progress each generation
              write(*,*) " gen", jgen, "     score=", float(smallest)

    2000    continue
            xnorm = 0.0d0
            do 2050 i = 1, n
              xnorm = xnorm + psmallest(i)**2
    2050    continue
            xnorm = dsqrt(xnorm)
            do 2100 i = 1, n
              psmallest(i) = psmallest(i) / xnorm
    2100    continue
            write(*,*) " parameters:"

            stop
            end

            real*8  function f( n, trial )
            implicit real*8 (a-h, o-z)
            integer n
            real*8 trial(n)
            xnorm = 0.0d0
            do 100 i = 1, n-1
              xnorm = xnorm + trial(i)**2
    100     continue
            xnorm = dsqrt ( xnorm )
    c       renormalise the trials
            do 200 i = 1, n-1
              trial(i) = trial(i) / xnorm
    200     continue

    c       f = fitness function to be minimised