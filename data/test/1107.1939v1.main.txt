#### The cocycle on the torus

Let @xmath be a local field and let @xmath be either a quadratic
extension of @xmath or a sum of two copies of @xmath . As before, we
write @xmath for the non-trivial Galois automorphism when @xmath is a
field. When @xmath , this notation will mean

  -- -------- --
     @xmath   
  -- -------- --

We shall also use the following notation in either case:

  -- -------- --
     @xmath   
  -- -------- --

We shall always assume that @xmath . The symbol @xmath will be the
quadratic Hilbert symbol on @xmath . When @xmath is a field, we shall
write @xmath for the quadratic Hilbert symbol on @xmath . In the case
that @xmath , this symbol will be defined as follows:

  -- -------- --
     @xmath   
  -- -------- --

Before describing the cocycle @xmath in general, we first study its
restriction to the following maximal torus

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

###### Theorem.

For @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

Along the way, we also find the following formula for the commutator of
the cocycle on @xmath :

  -- -------- --
     @xmath   
  -- -------- --

##### The cocycle on the whole group

Let @xmath be the following unipotent subgroup of @xmath :

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

The section @xmath is chosen in such a way that for @xmath and @xmath we
always have

  -- -------- --
     @xmath   
  -- -------- --

As a consequence, our cocycle @xmath satisfies the following:

  -- -------- --
     @xmath   
  -- -------- --

Combining this property with the Bruhat decomposition, we are able to
calculate @xmath on the bigger group @xmath , at least when @xmath is a
field. For the moment we assume that @xmath is a field extension rather
than a sum of two copies of @xmath . We shall discuss how the results
must be modified in the split case later.

In order to describe the cocycle, we first introduce some notation. For
@xmath we define

  -- -------- --
     @xmath   
  -- -------- --

We also define a function @xmath by

  -- -------- --
     @xmath   
  -- -------- --

Given an element

  -- -------- --
     @xmath   
  -- -------- --

we define @xmath by

  -- -------- --
     @xmath   
  -- -------- --

We prove the following in Chapter 6 :

###### Theorem.

Let @xmath , where @xmath , @xmath , @xmath , with @xmath and

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , then we have

  -- -- --
        
  -- -- --

If on the other hand @xmath , then we let

  -- -------- --
     @xmath   
  -- -------- --

And we have

  -- -- --
        
  -- -- --

In fact we obtain a more general theorem describing a cocycle
corresponding to an @xmath -fold cover of @xmath , where @xmath contains
a primitive @xmath -th root of unity; however this cocycle is a little
more complicated and is not required for our main aim, which is to
produce a half-integral weight multiplier system.

Fortunately, our formula for the local Kubota symbols will be rather
simpler than the formula for @xmath . Nevertheless, we require the
formula for @xmath in order to calculate the Kubota symbol.

##### The split case

In the case @xmath the theorem above does not completely describe the
cocycle @xmath . This is because there are numbers in @xmath which are
neither zero nor invertible, and so there are a number of extra cases to
consider. One can see why this happens from a different point of view:
the group @xmath has rank @xmath over @xmath , and so there are two
cells in the Bruhat decomposition of @xmath . However if @xmath is
split, then @xmath is isomorphic to @xmath , which has 6 cells in its
Bruhat decomposition (one for each element of the Weyl group, which in
this case is @xmath ). There are therefore four Bruhat cells in @xmath
which contain no elements of @xmath . In fact only the biggest and the
smallest Bruhat cells of @xmath contain elements of @xmath . Our formula
for @xmath is valid whenever @xmath , @xmath , @xmath are in one of
these two cells. We may ignore these extra cells since we are interested
in the restriction of @xmath to @xmath .

##### The level of the multiplier system

Let @xmath be a non-archimedean local field, and assume again that
@xmath is either a quadratic extension of local fields, or that @xmath
is a sum of two copies of @xmath . Before we can calculate the local
Kubota symbols and the multiplier system, we must first determine the
compact open subgroups @xmath on which each local extension splits.
These compact open subgroups determine the arithmetic subgroup on which
the multiplier system will be defined. Our result is the following:

###### Theorem.

-    If @xmath is unramified or split and @xmath has odd residue
    characteristic then the cocycle @xmath splits on @xmath .

-    Suppose @xmath is a ramified field extension and @xmath has odd
    residue characteristic. Let @xmath be a prime in @xmath . Then the
    cocycle @xmath splits on the subgroup

      -- -------- --
         @xmath   
      -- -------- --

-    If @xmath has even residue characteristic and @xmath then the
    cocycle splits on the subgroup

      -- -------- --
         @xmath   
      -- -------- --

Note that if @xmath is a quadratic extension of number fields in which
every even prime splits, then the theorem determines the compact open
subgroups @xmath at all primes @xmath .

##### The local Kubota symbol

Let @xmath be the maximal ideal of @xmath . Recall that the local Kubota
symbol @xmath is a map @xmath , satisfying the following:

  -- -------- --
     @xmath   
  -- -------- --

This condition does not always determine the local Kubota symbol, since
we may always multiply by a character of @xmath . We therefore let
@xmath be the intersection of the kernels of the homomorphisms @xmath .
The restriction of the Kubota symbol to @xmath is unique, and we shall
only calculate this restriction. Fortunately we have not lost much,
since for all odd primes we have @xmath . Suppose @xmath is even. If we
assume (as is the case for split primes) that the cocycle splits at
level @xmath , then we will have

  -- -------- --
     @xmath   
  -- -------- --

We will also assume that when @xmath is ramified, @xmath is a prime
element of @xmath .

Recall that @xmath denotes a unipotent subgroup of @xmath described
above. Our first observation is the following:

###### Proposition.

For any @xmath we have @xmath . More generally, for any @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

The relation @xmath implies that @xmath is determined by the bottom row
of the matrix @xmath . The other relation shows that @xmath is unchanged
by certain column operations. To describe our next result we need a
little more notation. Let

  -- -------- --
     @xmath   
  -- -------- --

be elements of @xmath . This entails @xmath , @xmath and @xmath . For a
number @xmath we shall write

  -- -------- --
     @xmath   
  -- -------- --

###### Proposition.

Let @xmath with @xmath , @xmath . Then we have

  -- -------- --
     @xmath   
  -- -------- --

(If @xmath then @xmath must also be zero, and @xmath .)

We next consider elements of the maximal torus @xmath . Our results for
such elements are as follows:

###### Proposition.

If @xmath is odd and unramified (either inert or split), then for @xmath
, we have

  -- -------- --
     @xmath   
  -- -------- --

If @xmath is even or ramified in @xmath , then for @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

We next obtain an expression for the Kubota symbol, expressed in terms
of the special cases already described. The following theorem is proven
in Section 8.3 :

###### Theorem.

Let

  -- -------- --
     @xmath   
  -- -------- --

Then

  -- -------- --
     @xmath   
  -- -------- --

Again, note that if @xmath is split, then we have not covered all
possibilities since it is possible for neither @xmath nor @xmath to be a
unit in this case (and only in this case). However, note that if @xmath
is not a unit then there is always an element @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is a unit, and we will always have

  -- -------- --
     @xmath   
  -- -------- --

We may apply the theorem to calculate @xmath .

##### The section over the real points, and the half-integral weight
multiplier system

As was described above, we shall choose for each element @xmath a
continuous square root @xmath of the function @xmath , satisfying the
condition

  -- -------- --
     @xmath   
  -- -------- --

In fact there is only one such choice, since any two choices would
differ by a homomorphism @xmath and @xmath is generated by commutators.
In Chapter 10 we determine the signs of these square roots. Our result
is:

###### Theorem.

Let @xmath , @xmath , @xmath and let @xmath . The assignment @xmath
defined above is given by:

-   @xmath , where @xmath ;

-   @xmath ;

-   @xmath .

In particular, this means that we always have @xmath . As a consequence,
we have the following:

###### Theorem.

Suppose @xmath is a quadratic extension in which the prime @xmath
splits. Define, for @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Then @xmath is a multiplier system of weight @xmath .

#### Verification of the results

The thesis contains rather a lot of calculations, and it would be useful
to know that the results are genuinely correct, rather than perhaps
being out by a sign here and there. To give some evidence of this, we
can look at the restriction of the global Kubota symbol to some
subgroups to check that it has the expected properties.

##### Restriction to the torus

We examine first the restriction of the Kubota symbol to @xmath , where
@xmath is the level @xmath principal congruence subgroup described
above. This intersection consists of elements @xmath where @xmath is a
unit in @xmath and is congruent to @xmath modulo @xmath .

Recall that for elements @xmath with @xmath coprime to @xmath , the
quadratic Legendre symbol is defined by

  -- -------- --
     @xmath   
  -- -------- --

Our results imply the following:

###### Proposition.

Let @xmath be a unit in @xmath congruent to @xmath modulo @xmath . Then
we have

  -- -------- --
     @xmath   
  -- -------- --

In the case that @xmath is totally complex, this implies that the map
@xmath is a group homomorphism. This is indeed the case, and can be
verified directly using the quadratic reciprocity law in @xmath .

##### Restriction to @xmath

The group @xmath embeds into @xmath as follows:

  -- -------- --
     @xmath   
  -- -------- --

We may therefore examine the restriction of the Kubota symbol to @xmath
. Our results imply the following:

  -- -------- --
     @xmath   
  -- -------- --

When @xmath is totally complex, our results imply that this map is a
homomorphism. Again, this turns out to be true, as was shown by Kubota
(see [ 10 ] ).

## Part I Preliminaries

### Chapter 1 The group @xmath

In this chapter, we will outline the definition of the group @xmath that
we will use along with some of its subgroups, the adèle group, the
Bruhat decomposition of @xmath and the Iwahori factorisation.

#### 1.1. The structure of @xmath

Let @xmath be an arbitrary field of characteristic zero, and @xmath is a
quadratic extension where @xmath , @xmath , @xmath . Then the Galois
group @xmath has two elements, and the non-trivial element may be
described by

  -- -------- --
     @xmath   
  -- -------- --

To describe @xmath , suppose @xmath is a @xmath -algebra. Then

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

and @xmath denotes the transpose of a matrix @xmath . This is the
“usual” definition of @xmath , but there are other definitions which are
isomorphic to the above. In fact, we will work with another definition,
where @xmath is replaced by

  -- -------- --
     @xmath   
  -- -------- --

as it is a more convenient presentation of @xmath . (It is possible to
show that if

  -- -------- --
     @xmath   
  -- -------- --

then @xmath .)

Let @xmath . We consider

  ------- -- -------- --
  (1.1)      @xmath   
  ------- -- -------- --

Let @xmath be a maximal @xmath -split torus of @xmath , with @xmath a
maximal torus of @xmath containing @xmath . By Section 2.5 of [ 6 ] , we
may choose these as follows:

  -- -------- --
     @xmath   
  -- -------- --

as a maximal @xmath -split torus of @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

as a maximal torus of @xmath . As @xmath , we will denote an element in
@xmath by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , and @xmath is defined below.

The root system of @xmath with respect to @xmath , @xmath , consists of
4 roots with one simple root which we will call @xmath . Thus, @xmath
and @xmath may be described by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath . This implies that if we let @xmath be the Lie algebra of
@xmath , and for @xmath , let

  -- -------- --
     @xmath   
  -- -------- --

be the corresponding root space, then

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Thus, the root space decomposition of @xmath is

  -- -------- --
     @xmath   
  -- -------- --

#### 1.2. The Bruhat decomposition of @xmath

Recall that @xmath . We shall use the following system of positive
roots: @xmath . Let @xmath , denoted as @xmath in [ 6 ] , be the
unipotent algebraic subgroup of @xmath whose Lie algebra is @xmath (and
similarly @xmath , denoted by @xmath in [ 6 ] , is the unipotent
algebraic subgroup of @xmath whose Lie algebra is @xmath ). Hence, since
@xmath , @xmath and @xmath may be explicitly described, i.e.

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

where @xmath and @xmath are the norm and trace of @xmath over @xmath .
We will let

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , @xmath and @xmath .

By Proposition 2.7 of [ 6 ] , if we define

  ------- -- -------- --
  (1.2)      @xmath   
  ------- -- -------- --

then

  -- -------- --
     @xmath   
  -- -------- --

Thus by the above definitions for @xmath and @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

(This would imply for any @xmath such that for @xmath , @xmath , @xmath
, @xmath .)

If @xmath is the normaliser of @xmath in @xmath , and @xmath is the
centraliser of @xmath in @xmath , we define @xmath as the Weyl group in
@xmath . Thus, we may choose (as we need this to define the section for
the 2-cocycle in Section 2.3 )

  -- -------- --
     @xmath   
  -- -------- --

as a complete set of representatives for the Weyl group in @xmath (this
is the same Weyl group chosen by Deodhar in Section 2.21 in [ 6 ] ).
Thus, by V.21.29 of [ 2 ] , the Bruhat decomposition may be described as

  -- -------- --
     @xmath   
  -- -------- --

This implies that a matrix in @xmath is either upper triangular or has a
non-zero @xmath -entry. It can be easily shown that for @xmath , @xmath
, @xmath , @xmath , @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

the Bruhat decomposition of any matrix of @xmath with a non-zero @xmath
-entry (i.e. @xmath ) may be described as

  ------- -- -------- --
  (1.3)      @xmath   
  ------- -- -------- --

Otherwise, an upper triangular matrix (i.e. an element of the Borel
subgroup of @xmath ) will have the Bruhat decomposition

  ------- -- -------- --
  (1.4)      @xmath   
  ------- -- -------- --

where @xmath , @xmath , @xmath with @xmath .

#### 1.3. The Iwahori factorisation

In this section, we shall assume that @xmath is a non-archimedean local
field. We shall write @xmath for the valuation ring in @xmath . We shall
use the notation

  ------- -- -------- --
  (1.5)      @xmath   
  ------- -- -------- --

where @xmath is as defined in Section 1.1 . Let @xmath be an ideal of
@xmath , and let

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

We may define

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Let us also define

  -- -------- --
     @xmath   
              
     @xmath   
  -- -------- --

###### Proposition 1.1.

We have the Iwahori factorisations

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

###### Proof.

Let

  -- -------- --
     @xmath   
  -- -------- --

(resp. @xmath ), where @xmath . Consider the Hermitian form @xmath
defined by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , @xmath . Since

  -- -------- --
     @xmath   
  -- -------- --

this implies that

  -- -------- --
     @xmath   
  -- -------- --

Thus, @xmath (resp. @xmath ), and hence

  -- -------- --
     @xmath   
  -- -------- --

But

  -- -------- --
     @xmath   
  -- -------- --

which implies that @xmath , i.e.

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath and @xmath (resp. @xmath ), we have

  -- -------- --
     @xmath   
  -- -------- --

But

  -- -------- --
     @xmath   
  -- -------- --

i.e. @xmath . This implies that @xmath , so that

  -- -------- --
     @xmath   
  -- -------- --

As

  -- -------- --
     @xmath   
  -- -------- --

this implies that @xmath . Thus,

  -- -------- --
     @xmath   
  -- -------- --

Note that @xmath (resp. @xmath ), so we have in the end

  -- -- --
        
  -- -- --

If @xmath , then we have, by ( 1.4 ),

  -- -------- --
     @xmath   
  -- -------- --

where @xmath (resp. @xmath ) and @xmath (resp. @xmath ).

This completes the proof of the Iwahori factorisation. ∎

#### 1.4. The adèle group of @xmath

##### 1.4.1. Some notation for the local field

Using the notation of Section V.1 of [ 13 ] , we first let @xmath be the
discrete valuation normalised by @xmath , for any local field @xmath .
This implies that the valuation ring may be described by

  -- -------- --
     @xmath   
  -- -------- --

with maximal ideal

  -- -------- --
     @xmath   
  -- -------- --

By defining @xmath , we have the normalised @xmath -adic absolute value
(multiplicative valuation)

  -- -------- --
     @xmath   
  -- -------- --

where @xmath . This implies that

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

We define a prime element of @xmath , @xmath , such that @xmath . This
implies that @xmath .

We also have the following lemma from Section 11 of [ 4 ] :

###### Lemma 1.2.

Let @xmath be complete with respect to the normalised valuation @xmath
and let @xmath be an extension of @xmath of degree @xmath . Then the
normalised valuation @xmath of @xmath which is equivalent to the unique
extension of @xmath to @xmath is given by the formula

  -- -------- --
     @xmath   
  -- -------- --

where @xmath and @xmath is the norm of an element of @xmath over @xmath
.

Lemma 1.2 will be useful as we can work out the normalised valuation of
@xmath by only knowing what the normalised valuation of @xmath is.

##### 1.4.2. The adèle ring

Now let @xmath be any global field. Recall (see Section VI.1 of [ 13 ] )
that an adèle is a family

  -- -------- --
     @xmath   
  -- -------- --

of elements @xmath , where @xmath runs through all the primes of @xmath
, @xmath is the completion of @xmath with respect to @xmath , and @xmath
is integral in @xmath for almost all @xmath . (Note that @xmath is thus
the maximal ideal of @xmath , as defined in the previous subsection.)
The adèles form a ring

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the restricted product of the @xmath with respect to the
subrings @xmath . Addition and multiplication are defined componentwise.
Let @xmath denote the finite component of @xmath , i.e. let

  -- -------- --
     @xmath   
  -- -------- --

and we similarly define the infinite component of @xmath as

  -- -------- --
     @xmath   
  -- -------- --

As stated in Section 10 of [ 4 ] , there is a natural mapping

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

i.e. an injective map of @xmath into @xmath since @xmath for almost all
@xmath and the map of @xmath into any @xmath is an injection. The image
of @xmath under this map is the ring of principal adèles, and we can
identify @xmath with this ring. Hence @xmath is a subring of @xmath .

##### 1.4.3. A description of the adèle group @xmath

Now let @xmath be a quadratic extension of our global field @xmath . We
are interested in

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is as defined in Section 1.1 . We want to calculate the
global Kubota symbol on an arithmetic subgroup of @xmath . In order to
do so, we will need to calculate the local Kubota symbol on a compact
open subgroup of

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is finite. Thus, we want to calculate the Kubota symbol on
a subgroup of

  -- -------- --
     @xmath   
  -- -------- --

We should first describe @xmath in order to understand @xmath . Let
@xmath , where @xmath such that @xmath is not a square in @xmath and
@xmath . Then the theorem in Section 10 of [ 4 ] states that there are
at most 2 extensions of the valuation @xmath to @xmath , and if @xmath
is a prime above @xmath in @xmath (written as @xmath ), we have

  -- -------- --
     @xmath   
  -- -------- --

where @xmath denotes the completion of @xmath with respect to @xmath .
This implies that for a finite prime @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Thus for every finite prime @xmath , we have to consider if the
extension @xmath is non-split (hence unramified or ramified) or split.
Also, note that the first lemma in Section 14 of [ 4 ] states that

  -- -------- --
     @xmath   
  -- -------- --

in both an algebraic and a topological sense, and @xmath , where @xmath
, is mapped identically on to @xmath . This implies that

  -- -- --
        
  -- -- --

and hence for a finite prime @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Note that we will be putting @xmath and @xmath as defined in Section 1.1
in Part III , hence we get the same definition for @xmath and @xmath
using ( 1.1 ) and ( 1.5 ). We will also assume that when @xmath is
ramified, @xmath is a prime element of @xmath .

### Chapter 2 With reference to Deodhar’s paper

As stated in the Introduction, [ 6 ] is heavily relied upon when
calculating the 2-cocycle of the universal central extension of @xmath .
We need to establish a few more facts from [ 6 ] in order to show that
our result will be valid.

#### 2.1. Some properties of @xmath

As before, we let @xmath be an arbitrary field of characteristic zero
and @xmath a quadratic extension of @xmath . Proposition 2.11 of [ 6 ]
states the following:

###### Proposition 2.1.

There exists a well-defined function @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

as follows:

1.   If @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

2.   If @xmath , @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

(Note that @xmath has also been defined as a field, but there should be
no overlap in notation as the definition of @xmath as used in this
section will not occur elsewhere.)

As a consequence, @xmath . Also, for any @xmath with @xmath and @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Proposition 2.1 implies that for @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

where

  ------- -- -------- --
  (2.1)      @xmath   
  ------- -- -------- --

Thus by ( 1.2 ) and the above, all elements of @xmath are generated by
elements of @xmath and @xmath . This in turn implies that by the Bruhat
decomposition for @xmath (see ( 1.3 ) and ( 1.4 )), every element of
@xmath is generated by @xmath and @xmath . This verifies the theorem
obtained from Sections 1.2 and 2.3 of [ 6 ] :

###### Theorem 2.2.

If a group @xmath is quasi-split, then @xmath is generated by the
unipotent elements in @xmath which belong to the radical of a parabolic
subgroup @xmath defined over @xmath .

We also have the following definition:

###### Definition 2.3.

A perfect group @xmath is a group which is its own commutator subgroup,
i.e. if we express the commutator of @xmath , @xmath as

  -- -------- --
     @xmath   
  -- -------- --

then

  -- -------- --
     @xmath   
  -- -------- --

Recall that we have set @xmath . As stated in Section 1.1 of [ 6 ] , a
necessary and sufficient condition for an abstract group to have a
universal central extension is that the group is perfect. As @xmath and
@xmath consist of commutators, and @xmath is generated by @xmath and
@xmath , this implies that @xmath is perfect. Thus there is a universal
central extension of @xmath , which may be expressed by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath denotes the kernel of @xmath . (Note that @xmath is also
known as the Schur multiplier or the fundamental group of @xmath , and
it is central in @xmath .)

By Lemma 1.10 of [ 6 ] , there is a unique lift of @xmath to @xmath .
This implies that we can write for @xmath the corresponding element in
@xmath by @xmath , and if we define

  -- -------- --
     @xmath   
  -- -------- --

then @xmath is an isomorphism. Similarly @xmath is also an isomorphism,
and we may define the corresponding element of @xmath in @xmath as
@xmath . Thus we may define, similar to ( 1.2 ), the element

  -- -------- --
     @xmath   
  -- -------- --

Furthermore, Proposition 2.9 of [ 6 ] lists a few relations relevant to
our discussion. We list the most important relations for reference here.

###### Proposition 2.4.

Let

  ------- -- -------- --
  (2.2)      @xmath   
  ------- -- -------- --

and define @xmath , @xmath by

  -- -------- --
     @xmath   
  -- -------- --

The following hold in @xmath , and hence in @xmath too:

1.  @xmath

2.  @xmath ,

3.  @xmath

4.  @xmath

5.  @xmath .

6.  @xmath .

7.  @xmath

      -- -------- --
         @xmath   
      -- -------- --

8.  @xmath

      -- -------- --
         @xmath   
      -- -------- --

Note that we will use the above definition of @xmath when we are finding
an equation for the 2-cocycle of the universal central extension of
@xmath . We can also define @xmath as

  ------- -- -------- --
  (2.3)      @xmath   
  ------- -- -------- --

This definition will be useful later in Part III .

#### 2.2. The universal topological central extension

In this section we assume that @xmath is a non-archimedean local field.
We shall regard @xmath as a locally compact topological group, in which
the topology is given by the norm on @xmath . We shall write @xmath for
measurable cohomology as defined by Calvin Moore in [ 12 ] , and we
shall write @xmath for continuous cohomology.

In Deodhar’s paper, @xmath is first regarded as an abstract group when
constructing the universal central extension. It is subsequently
regarded as a topological group, with the topology given by the norm on
@xmath . It was shown in that paper that the universal topological
covering group for @xmath exists and that the topological fundamental
group is a quotient of @xmath , where @xmath is the group of roots of
unity of @xmath .

We first recall what a topological central extension is. This is a
central extension of topological groups

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the universal topological covering group of @xmath , and
in which @xmath is discrete and there is a neighbourhood @xmath of the
identity in @xmath , such that the projection @xmath is topologically
isomorphic to @xmath .

We now turn to a paper by Prasad and Raghunathan which was published in
two parts, [ 15 ] and [ 16 ] . In 10.3 of [ 16 ] , we have the following
proposition:

###### Proposition 2.5.

Let @xmath be a locally compact, second countable topological group.
Assume that @xmath , and @xmath is a finite group. Then @xmath admits a
universal topological covering and its topological fundamental group is
isomorphic to the dual of @xmath .

We first note that @xmath is a locally compact second countable group,
and we have already noted that @xmath . In order to use the above
proposition, we must show @xmath is a finite group, and that the dual of
this group is equal to the fundamental group @xmath .

Theorem 1 of [ 19 ] states the following:

###### Theorem 2.6.

Let @xmath be a topological group, and @xmath be a @xmath -module. If
@xmath is a locally compact, @xmath -compact, zero-dimensional, then
@xmath .

In other words, the cohomology groups based on continuous cochains and
the cohomology groups based on measurable cochains coincide for our
group @xmath . This implies that @xmath . In 5.10 and 5.11 of [ 15 ] ,
it was established that if @xmath is an absolutely simple, simply
connected group defined and quasi-split over @xmath (where @xmath is a
non-archimedean local field) and @xmath is the @xmath -subgroup of
@xmath , @xmath -isomorphic to @xmath and determined by a long root,
then the following theorem holds:

###### Theorem 2.7.

The restriction @xmath is an isomorphism. Hence, @xmath is isomorphic to
@xmath , the Pontrjagin dual.

Theorem 2.7 shows that @xmath , i.e. @xmath is finite. Thus using
Theorem 2.6 , by Proposition 2.5 @xmath is a finite group and thus
@xmath admits a universal covering and its topological fundamental group
is isomorphic to the dual of @xmath , i.e. the topological fundamental
group is isomorphic to @xmath .

We should also mention the cases when @xmath and @xmath . In these
cases, @xmath is a connected Lie group, and its universal cover @xmath ,
in the topological sense, has the structure of a Lie group and is the
universal topological central extension. If we denote the topological
fundamental group of @xmath as @xmath , then when @xmath we have @xmath
and when @xmath we have @xmath .

#### 2.3. A section for @xmath

Again let @xmath be a local field and let @xmath be the universal
topological central extension of @xmath . We can now define the section
@xmath as in Section 2.21 of [ 6 ] . This section will give rise to a
2-cocycle @xmath defined by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , @xmath .

By the Bruhat decomposition (see Section 1.2 ), any element of @xmath
can be uniquely written in the form @xmath , where @xmath , @xmath
(recall that @xmath is the set of representatives of the Weyl group of
@xmath ) and @xmath , @xmath . We will choose, as in [ 6 ] , @xmath as
the representative of the non-trivial element of @xmath . So we may
define @xmath , and since @xmath is an isomorphism, we may choose @xmath
(see Section 2.1 ).

As for @xmath , suppose that @xmath . Then we define

  ------- -- -------- --
  (2.4)      @xmath   
  ------- -- -------- --

where @xmath is defined as in ( 2.1 ).

Thus, for @xmath , we may define @xmath , and hence @xmath is a section
for @xmath .

Our next aim will be to express the 2-cocycle @xmath in terms of @xmath
symbols. Deodhar performed this calculation on the split torus, but we
shall need to extend his formula to the whole group.

For @xmath , @xmath , let us define

  ------- -- -------- --
  (2.5)      @xmath   
  ------- -- -------- --

i.e. @xmath . It is established in Section 2.30 of [ 6 ] that

  ------- -------- -------- -------- -------- --
  (2.6)            @xmath   @xmath   @xmath   
          @xmath   @xmath                     
  (2.7)            @xmath   @xmath   @xmath   
  (2.8)            @xmath   @xmath   @xmath   
  (2.9)            @xmath   @xmath   @xmath   
  ------- -------- -------- -------- -------- --

Indeed these relations all hold in the universal central extension, and
so they are also true in the universal topological central extension.
Note that the section @xmath is continuous on the split torus @xmath ,
and thus the restriction of @xmath to @xmath is continuous. It is also
established that @xmath (as opposed to @xmath ) is given in terms of
generators and relations as

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath for any @xmath , @xmath (by the proof of Lemma 2.12 of [ 6
] ), this implies that @xmath can be written in terms of these @xmath
’s.

Thus, we would establish what @xmath is on @xmath . Unfortunately in [ 6
] , Deodhar only proves that the @xmath ’s ( @xmath , @xmath ) satisfy
the relations above, and not what @xmath is explicitly for all values of
@xmath , @xmath . But we can adapt the methods used in [ 6 ] to achieve
this goal, and by using the section @xmath , we will be able to express
what @xmath is on the whole of @xmath in terms of @xmath ’s, where
@xmath , @xmath .

#### 2.4. @xmath as a local field

Let @xmath be a non-archimedean local field. We first note that by
Theorem 3.1 of [ 12 ] , that @xmath , for @xmath , @xmath , is bilinear,
i.e. for @xmath , @xmath , @xmath ,

  -------- -------- -------- -------- --
  (2.10)            @xmath   @xmath   
           @xmath   @xmath            
  -------- -------- -------- -------- --

since @xmath is continuous (as @xmath is a local field; see previous
section). A corollary of the abovementioned theorem is that the @xmath
-th power Hilbert symbol @xmath (where @xmath is the number of roots of
unity of @xmath ) and its powers are the only functions which are
continuous and satisfy the equations ( 2.6 ) – ( 2.9 ) (a definition of
the Hilbert symbol may be found in Chapter 3 ). We have the following
proposition:

###### Proposition 2.8.

For any local field @xmath , if @xmath denotes the number of roots of
unity in @xmath and @xmath denotes the group of @xmath -th roots of
unity of @xmath , then @xmath , and the isomorphism may be described by

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

where @xmath , @xmath and @xmath is the @xmath -th power Hilbert symbol.

###### Proof.

We have shown that there is an isomorphism of the form @xmath for some
@xmath . However, the result of Prasad and Raghunathan shows that the
order of the topological fundamental group is @xmath . Hence we may take
@xmath . ∎

Thus from Chapter 4 onwards, when both @xmath , @xmath , we will use the
Hilbert symbol @xmath instead of @xmath . This implies that when we
apply @xmath to ( 2.10 ) and ( 2.7 ) – ( 2.9 ), we get

  -------- -------- -------- -------- -------- --
  (2.11)            @xmath   @xmath            
           @xmath   @xmath   @xmath            
  (2.12)            @xmath   @xmath   @xmath   
  (2.13)            @xmath   @xmath   @xmath   
  (2.14)            @xmath   @xmath   @xmath   
  -------- -------- -------- -------- -------- --

### Chapter 3 Some properties of quadratic extensions

In this chapter, we gather some information to be used in later
chapters, mostly to do with quadratic field extensions.

#### 3.1. The Hilbert symbol

We define the @xmath -th power Hilbert symbol, where the group @xmath of
@xmath -th roots of unity is contained in a local field @xmath , with
@xmath a natural number relatively prime to the characteristic of @xmath
. This definition may be found in Section V.3 of [ 13 ] . Letting @xmath
be the maximal abelian extension of exponent @xmath , it has been
established that @xmath and @xmath The bilinear map

  -- -------- --
     @xmath   
  -- -------- --

therefore defines a nondegenerate bilinear pairing

  -- -------- --
     @xmath   
  -- -------- --

which we call the @xmath -th power Hilbert symbol. Now using the
notation introduced in Subsection 1.4.1 , let @xmath be the
characteristic of the residue field @xmath , and @xmath . We have the
following proposition:

###### Proposition 3.1.

If @xmath and @xmath are relatively prime and @xmath , @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

A proof of the above proposition may be found in V.3.4 of [ 13 ] . When
@xmath and @xmath are relatively prime, we call this the case of the
tame Hilbert symbol , as defined above. Note that a consequence of the
tame Hilbert symbol is that whenever @xmath , @xmath , @xmath .

We should also note that the Hilbert symbol obeys the product formula ,
which is proved in Theorem VI.8.1 of [ 13 ] . We state this theorem for
later reference.

###### Theorem 3.2.

Let @xmath be a global field, @xmath a prime of @xmath with @xmath the
localisation of @xmath at @xmath . Also, let @xmath contain the group
@xmath of @xmath -th roots of unity. Then for @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

where @xmath runs through all the primes of @xmath .

In our case, we are more interested in quadratic Hilbert symbols (i.e.
when @xmath ). It has been established that the quadratic Hilbert symbol
has a more concrete meaning:

  -- -------- --
     @xmath   
  -- -------- --

(See Chapter III of [ 17 ] .)

Now using our usual definition of @xmath and @xmath , we list the
properties of quadratic Hilbert symbols here for convenient reference
later, a proof of which may be found in Section V.3 of [ 13 ] . For
@xmath , @xmath , @xmath , @xmath ,

  ------- -------- -------- -- --
  (3.1)            @xmath      
  (3.2)                        
  (3.3)            @xmath      
  (3.4)            @xmath      
          @xmath               
  (3.5)            @xmath      
  (3.6)            @xmath      
  ------- -------- -------- -- --

(Note that the above is true for any field.) In addition, for all @xmath
, @xmath ,

  ------- -- -------- --
  (3.7)      @xmath   
  ------- -- -------- --

(A statement and proof of this may be found in Chapter 2, Section 1,
Theorem 2.14 on Page 101 of [ 14 ] . In fact,

  ------- -- -- --
  (3.8)         
  (3.9)         
  ------- -- -- --

by the same statement and proof.)

#### 3.2. Non-split and split quadratic extensions

Recall that in Subsection 1.4.3 , we established that we will be
calculating the local Kubota symbol on a compact open subgroup of

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is as described in Section 1.1 , @xmath is a global field,
@xmath is a finite prime of @xmath , @xmath is the completion of @xmath
with respect to @xmath , @xmath , @xmath , @xmath such that @xmath is
not a square in @xmath , and @xmath .

In our calculation of the Kubota symbol, we will often use the
properties of the extension @xmath . We gather the statements of these
properties in the next two subsections.

##### 3.2.1. The non-split case

Consider any local field @xmath . Let @xmath be a finite extension of
@xmath . Then using the notation of Subsection 1.4.1 , there is only one
prime @xmath above @xmath , i.e. @xmath and

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is called the ramification index of the extension @xmath .
If we define the residue class degree of the extension @xmath as

  -- -------- --
     @xmath   
  -- -------- --

then it has been established in Proposition 3 of Section 5 of [ 7 ] that

  -- -------- --
     @xmath   
  -- -------- --

An extension of local fields @xmath is ramified if @xmath (and
unramified or inert if @xmath ), and is totally ramified if @xmath .

From Section 6 of [ 7 ] , an Eisenstein polynomial in @xmath is defined
as a separable polynomial

  -- -------- --
     @xmath   
  -- -------- --

with

  -- -------- --
     @xmath   
  -- -------- --

We have the following theorem (Theorem 1 in Section 6 of [ 7 ] ):

###### Theorem 3.3.

1.   An Eisenstein polynomial @xmath is irreducible. If @xmath is a root
    of @xmath , then @xmath is totally ramified and @xmath .

2.   If @xmath is totally ramified over @xmath and @xmath , then the
    minimal polynomial of @xmath over @xmath is Eisenstein and

      -- -------- --
         @xmath   
      -- -------- --

The above theorem implies that since we have a prime element @xmath such
that @xmath , then if @xmath is totally ramified,

  -- -------- --
     @xmath   
  -- -------- --

We can find an analogue for the unramified case of the above theorem.
Let the image of an element @xmath in the residue class field @xmath be
denoted by @xmath and similarly let the image of an element @xmath in
the polynomial ring @xmath be denoted by @xmath . Proposition 1 of
Section 7 of [ 7 ] states the following:

###### Proposition 3.4.

1.   Suppose @xmath to be unramified over @xmath . Then there exists an
    element @xmath with @xmath . If @xmath is such an element and @xmath
    is its minimal polynomial over @xmath , then @xmath , @xmath and
    @xmath is irreducible in @xmath and separable.

2.   Suppose @xmath is a monic polynomial in @xmath , such that @xmath
    is irreducible in @xmath and separable. If @xmath is a root of
    @xmath then @xmath is unramified over @xmath and @xmath .

We will be using the above to establish whether @xmath is ramified or
unramified if @xmath is not split. We will also need to use Hensel’s
Lemma. Appendix C of [ 4 ] states this lemma, which we will write as a
theorem.

###### Theorem 3.5 (Hensel’s Lemma).

Let @xmath be a field complete with respect to the non-archimedean
valuation @xmath and let

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be such that

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the (formal) derivative of @xmath . Then there is a
solution of

  -- -------- --
     @xmath   
  -- -------- --

@xmath is known as the approximate root of the polynomial @xmath . The
above lemma will be useful when we want to apply Hensel’s Lemma with
respect to our field @xmath , as we will know the normalised valuation
of @xmath but may not know directly the normalised valuation on @xmath .

##### 3.2.2. The split case

In the split case, we have @xmath , and @xmath . We can think of @xmath
as being isomorphic to @xmath by the bijective map

  -------- -------- -------- -------- --
           @xmath   @xmath            
  (3.10)            @xmath   @xmath   
  -------- -------- -------- -------- --

for any @xmath , @xmath . Hence, we identify @xmath with @xmath . Note
that where no confusion can occur, we will denote an element @xmath as
@xmath and an element @xmath as @xmath .

Also, the norm and trace of @xmath are defined respectively as

  -- -------- --
     @xmath   
  -- -------- --

Thus, for any element @xmath , we can always choose an element in @xmath
such that @xmath . An obvious choice would be @xmath .

## Part II The 2-cocycle of the universal central extension of @xmath

### Chapter 4 The 2-cocycle on @xmath

Suppose that @xmath is a local field containing an @xmath -th root of
unity and let @xmath . Recall that we have a homomorphism @xmath given
by @xmath for @xmath . This map gives rise to a central extension

  -- -------- --
     @xmath   
  -- -------- --

We have seen that if @xmath is non-archimedean and @xmath is the number
of roots of unity in @xmath , then this extension is the universal
topological central extension of @xmath . We have described a section
@xmath . This section gives rise to a 2-cocycle @xmath on @xmath with
values in @xmath .

Recall that we are actually interested in the 2-cocycle corresponding to
the double cover of @xmath , which represents a cohomology class @xmath
. By the existence of a universal central extension we have (by
Theorem 1.1 of [ 12 ] ) for any trivial @xmath -module @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

This implies that

  -- -------- --
     @xmath   
  -- -------- --

Thus, @xmath . We will use this fact in Chapter 6 to describe the
cocycle @xmath .

We will first calculate the cocycle @xmath on @xmath . This calculation
is divided into 2 chapters. This chapter introduces the notation we will
use, cites a few results, and we will calculate the 2-cocycle on a
maximal torus @xmath of @xmath . Recall that we write @xmath instead of
@xmath when both @xmath , @xmath . Also, recall the definitions of
@xmath and @xmath as stated in Proposition 2.1 . We will get the
following theorem:

###### Theorem.

For @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

where, if @xmath , @xmath , with @xmath , @xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

It should be noted that the right-hand side is given in terms of @xmath
-th power Hilbert symbols on @xmath .

The next chapter will use the results of this chapter to prove what the
2-cocycle is on the whole of @xmath . We will then get an expression for
the 2-cocycle @xmath corresponding to the double cover of @xmath using
the relation above.

#### 4.1. Initial results

We first note that for all @xmath , @xmath , by ( 2.11 ),

  ------- -- -------- --
  (4.1)      @xmath   
  ------- -- -------- --

for @xmath .

For @xmath , since @xmath , by ( 2.5 ),

  ------- -- -------- --
  (4.2)      @xmath   
  ------- -- -------- --

Also, by Proposition 2.4 , for @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

i.e. by ( 2.4 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
                       
  -- -------- -------- --

Thus by ( 2.5 ), ( 2.12 ) and ( 4.1 ),

  ------- -- -------- --
  (4.3)      @xmath   
  ------- -- -------- --

Also, since @xmath is central in @xmath for all @xmath , @xmath , the
above implies that

  ------- -- -- --
  (4.4)         
  ------- -- -- --

###### Remark 4.1.

By ( 4.1 ), @xmath for all @xmath . This implies, by ( 4.3 ) and ( 4.4
), that @xmath commutes with @xmath for all @xmath .

Hence by the above, we can now work out the “easy” cases, which are
summarised in the following proposition based on Lemma 2.23 of [ 6 ] :

###### Proposition 4.2.

For @xmath , @xmath ,

1.  @xmath ,

2.  @xmath .

###### Proof.

We first prove (i). We have by ( 2.5 ) that

  -- -------- --
     @xmath   
  -- -------- --

and by ( 2.4 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
                       
  -- -------- -------- --

Hence by ( 2.5 ) again,

  -- -------- --
     @xmath   
  -- -------- --

But since @xmath and @xmath , we have by Proposition 2.1 that

  ------- -- -------- --
  (4.5)      @xmath   
  (4.6)      @xmath   
  ------- -- -------- --

Thus,

  -- -------- -------- --
     @xmath            
              @xmath   
  -- -------- -------- --

by ( 2.13 ). Similarly for (ii), by ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

Thus,

  -- -- --
        
  -- -- --

by ( 2.4 ). By Proposition 2.4 ,

  -- -------- --
     @xmath   
  -- -------- --

With the above and ( 4.6 ), the equation becomes

  -- -------- --
     @xmath   
  -- -------- --

Also by Proposition 2.4 ,

  -- -- -------- --
        @xmath   
        @xmath   
  -- -- -------- --

This implies by ( 2.4 ) that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
                       
  -- -------- -------- --

since @xmath . Hence,

  -- -------- --
     @xmath   
  -- -------- --

by ( 2.5 ). ∎

Thus we are left with finding an explicit expression for @xmath where
@xmath , @xmath , in terms of @xmath ’s, with @xmath , @xmath . But
before proving the main theorem, we must first establish a few lemmas.

#### 4.2. Some useful lemmas

Lemma 2.15 of [ 6 ] states (with some change in notation) that

###### Lemma 4.3.

For @xmath , @xmath (see ( 2.2 )),

1.  @xmath , with

      -- -------- --
         @xmath   
      -- -------- --

2.  @xmath , with @xmath , @xmath the same as in (i) and

      -- -------- --
         @xmath   
      -- -------- --

Thus, using the above, we will prove the following:

###### Lemma 4.4.

For a general @xmath , @xmath ,

  -- -- --
        
  -- -- --

Otherwise for @xmath , @xmath , @xmath , @xmath , @xmath , @xmath , if

  -- -------- --
     @xmath   
  -- -------- --

then

  -- -- --
        
  -- -- --

If @xmath , then we let

  -- -- --
        
  -- -- --

so that

  -- -------- --
     @xmath   
  -- -------- --

and calculate @xmath instead, using the above results.

###### Proof.

Recall from Proposition 2.4 that for any @xmath (where @xmath is as in (
2.2 )),

  ------- -- -------- --
  (4.7)      @xmath   
  ------- -- -------- --

If @xmath , then let @xmath , where @xmath . Then @xmath , and by ( 4.7
),

  -- -- -------- --
                 
        @xmath   
  -- -- -------- --

Hence by ( 2.4 ),

  -- -------- --
              
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

So assume that @xmath , so that @xmath . Let @xmath . Then we know by (
4.7 ) and applying Proposition 2.4 twice for @xmath , @xmath , that

  ------- -- -------- -------- --
  (4.8)      @xmath   @xmath   
             @xmath            
             @xmath            
  ------- -- -------- -------- --

By Proposition 2.4 , for @xmath ,

  ------- -- -------- --
  (4.9)      @xmath   
  ------- -- -------- --

This implies that if we let @xmath , @xmath , then ( 4.8 ) becomes

  -- -------- --
     @xmath   
  -- -------- --

By using ( 4.9 ) twice, we get

  -- -- --
        
  -- -- --

Hence,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

by ( 4.7 ) and ( 2.4 ); i.e.

  -- -------- --
     @xmath   
  -- -------- --

(Note that the above also applies to @xmath : for if @xmath , @xmath ,
by using ( 2.5 ) several times,

  -- -------- --
     @xmath   
     @xmath   
              
     @xmath   
  -- -------- --

Now it is a matter of using ( 2.11 ), ( 2.13 ) and ( 4.1 ) to get

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Thus the two abovementioned cases coincide for @xmath , @xmath .)

Let @xmath , i.e. @xmath with @xmath , @xmath . Also, let @xmath , with
@xmath , @xmath .

It is sufficient to find an explicit formula for

  -- -------- --
     @xmath   
  -- -------- --

for some @xmath , since we know from previous calculation that

  -------- -- -------- --
  (4.10)      @xmath   
  -------- -- -------- --

By the proof of Lemma 2.16 of [ 6 ] , assume that we can choose @xmath
such that

  -- -------- --
     @xmath   
  -- -------- --

Then,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Hence, since @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath , @xmath and @xmath . Then @xmath , @xmath , hence @xmath and
@xmath are well-defined. Using Lemma 4.3 , we know that

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

so

  -- -- --
        
  -- -- --

by Lemma 4.3 . By Proposition 2.4 ,

  -- -------- --
     @xmath   
  -- -------- --

thus by ( 4.7 ),

  -- -------- --
              
     @xmath   
     @xmath   
              
  -- -------- --

Also,

  -- -------- --
              
     @xmath   
     @xmath   
  -- -------- --

by ( 2.4 ). This implies, using ( 4.10 ), that

  -- -- --
        
        
  -- -- --

Also, by ( 4.2 ),

  -- -------- --
     @xmath   
  -- -------- --

Hence,

  -- -- --
        
  -- -- --

Since by Remark 4.1 ,

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath , this implies that

  -- -- --
        
  -- -- --

Use ( 2.5 ) several times to get

  -- -------- --
              
     @xmath   
              
  -- -------- --

By using ( 2.12 ), ( 2.13 ), ( 4.1 ) and ( 2.11 ) in the above,

  -- -- --
        
  -- -- --

Since @xmath ,

  -- -------- --
              
              
     @xmath   
  -- -------- --

By ( 2.13 ), @xmath for all @xmath , hence by also using ( 2.11 ),

  -- -- --
        
        
  -- -- --

Lastly, by ( 2.12 ) and ( 2.11 ),

  -- -- --
        
  -- -- --

Thus, the above method applies for @xmath , @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

so that

  -------- -- -------- --
  (4.11)      @xmath   
  -------- -- -------- --

If @xmath , for the majority of these cases, we can interchange @xmath
and @xmath to get the result, i.e. let

  -- -- --
        
  -- -- --

and apply the above to

  -- -------- --
     @xmath   
  -- -------- --

The only exception is when @xmath , i.e. when @xmath , @xmath . Hence,
@xmath and @xmath , where @xmath . Let @xmath , and let @xmath , @xmath
be such that

  -- -------- --
     @xmath   
  -- -------- --

i.e.

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , @xmath , @xmath , we will be able to work out @xmath and
@xmath using ( 4.11 ); then

  -- -- --
        
  -- -- --

Let us calculate @xmath first: since

  -- -------- --
     @xmath   
  -- -------- --

then in this case, using ( 4.11 ),

  -- -------- --
     @xmath   
  -- -------- --

and therefore,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Thus,

  -------- -- -- --
  (4.12)         
  -------- -- -- --

by ( 2.13 ). As for @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

which implies that by ( 4.11 ), @xmath so that

  -- -------- --
     @xmath   
  -- -------- --

i.e.

  -------- -- -- --
  (4.13)         
  -------- -- -- --

Therefore, by ( 4.12 ) and ( 4.13 ),

  -- -- --
        
        
        
  -- -- --

and by ( 2.11 ) and ( 4.1 ),

  -- -- --
        
  -- -- --

Again by ( 2.11 ) as well as ( 2.5 ),

  -- -- --
        
  -- -- --

Hence we have

  -- -------- --
     @xmath   
  -- -------- --

by ( 2.11 ) again. Thus the lemma is proved. ∎

###### Lemma 4.5.

If @xmath , @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

for some (non-unique) @xmath .

Hence, if @xmath and @xmath , @xmath such that @xmath , @xmath , @xmath
, @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Since @xmath , it is necessary and sufficient that

  -- -------- --
     @xmath   
  -- -------- --

Thus, the existence of @xmath is Hilbert’s Theorem 90. A reference for
this theorem is II.1.2 Proposition 1 of [ 18 ] .

We may assume that @xmath , otherwise there is nothing to prove. So
either @xmath or @xmath , where @xmath , @xmath , therefore it is
possible to choose

  -- -------- --
     @xmath   
  -- -------- --

Note that these are not the only choices for @xmath . The sequel is not
dependent on the choice of @xmath , thus we may choose any @xmath which
satisfies @xmath .

Firstly, if @xmath (so @xmath ), then by Lemma 4.4 ,

  -- -------- --
     @xmath   
     @xmath   
              
  -- -------- --

And since by Remark 4.1 , @xmath commutes with @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

This implies that by ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

By Lemma 2.12 of [ 6 ] , for arbitrary @xmath , @xmath , @xmath ,

  -- -- --
        
  -- -- --

By choosing @xmath , @xmath , @xmath and @xmath , by Lemma 2.18 of [ 6 ]
, the above is equal to @xmath .

By Proposition 2.4 ,

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Hence,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Thus by ( 4.7 ),

  -------- -- -------- --
  (4.14)      @xmath   
  -------- -- -------- --

As in Lemma 4.4 , there are a few cases to consider. We may assume that
@xmath , otherwise there is nothing to prove; therefore @xmath . Also,
@xmath , since @xmath . We have already looked at the case where @xmath
. Thus, there is only one last case.

Let @xmath and @xmath , where @xmath , @xmath , @xmath , @xmath . We
first consider

  -- -------- --
     @xmath   
  -- -------- --

By Lemma 4.4 ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

note that this is only valid if @xmath (we will deal with the other case
later in the proof). Hence

  -------- -- -------- --
  (4.15)      @xmath   
  -------- -- -------- --

by ( 2.13 ). Similarly, for

  -- -------- --
     @xmath   
  -- -------- --

Lemma 4.4 gives

  -------- -- -------- --
  (4.16)      @xmath   
  -------- -- -------- --

Using ( 4.14 ), ( 4.15 ) and ( 4.16 ),

  -- -------- --
     @xmath   
  -- -------- --

We simplify the above using ( 2.11 ) and ( 2.5 ) to get

  -- -------- --
     @xmath   
  -- -------- --

Thus by ( 2.11 ) and ( 2.13 ),

  -- -- --
        
  -- -- --

By using ( 2.11 ) and the fact that @xmath for all @xmath by ( 4.1 ), we
finally get

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , we may instead use the above for

  -- -------- --
     @xmath   
  -- -------- --

This would imply that since

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , replacing @xmath by @xmath would give

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Therefore,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

by ( 2.12 ). ∎

#### 4.3. A slightly more general result

Now that we have established a few lemmas, we can work on @xmath for the
cases where both @xmath , @xmath .

###### Lemma 4.6.

For all @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We know by Proposition 2.1 that @xmath . Thus,

  -- -------- --
     @xmath   
  -- -------- --

This implies that @xmath and @xmath . Hence, by ( 2.5 ) and ( 2.4 ),

  -- -------- -------- --
     @xmath   @xmath   
                       
  -- -------- -------- --

By Proposition 2.4 ,

  -- -- --
        
  -- -- --

which implies that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

So by Lemma 4.5 ,

  -- -------- --
     @xmath   
  -- -------- --

Also, for @xmath , @xmath by ( 4.1 ), hence

  -- -------- --
     @xmath   
  -- -------- --

which implies, using ( 2.11 ), that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

###### Lemma 4.7.

For all @xmath , @xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We have, by ( 2.5 ) and ( 2.4 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

where the function @xmath is as defined in ( 2.1 ). Since by Proposition
2.4 ,

  -- -------- --
     @xmath   
  -- -------- --

the equation for @xmath becomes

  -------- -- -------- --
  (4.17)      @xmath   
  -------- -- -------- --

Now, for any @xmath , @xmath , by ( 2.4 ),

  -- -------- --
     @xmath   
              
              
  -- -------- --

We find by using ( 4.2 ) that

  -- -------- --
     @xmath   
  -- -------- --

Since by Remark 4.1 , @xmath commutes with @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and so by ( 2.5 ),

  -- -- --
        
  -- -- --

Hence it is a matter of simplifying using ( 2.11 ), ( 2.12 ) and ( 2.13
) to get

  -- -------- --
     @xmath   
  -- -------- --

Therefore,

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Replacing the above in ( 4.17 ) gives

  -- -------- --
     @xmath   
  -- -------- --

and since by Proposition 2.4 ,

  -- -- --
        
  -- -- --

using this in the equation above gives

  -- -------- --
     @xmath   
  -- -------- --

By ( 4.5 ) and ( 4.6 ),

  -- -------- --
     @xmath   
  -- -------- --

and using ( 2.4 ) on the right-hand side gives

  -- -------- --
     @xmath   
  -- -------- --

By ( 4.5 ), ( 4.6 ), Proposition 2.1 and ( 2.4 ),

  -- -------- --
     @xmath   
              
     @xmath   
  -- -------- --

So if @xmath ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

by ( 2.5 ). If @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and since by Proposition 2.1 , @xmath , this shows by using ( 2.5 ) that

  -- -------- --
     @xmath   
  -- -------- --

Thus,

  -- -- --
        
  -- -- --

by ( 2.12 ), ( 2.13 ) and ( 2.11 ). Therefore we have proven our result.
∎

###### Proposition 4.8.

For @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

This is easily proved using Lemmas 4.6 and 4.7 .

By Lemma 4.6 ,

  -- -------- --
     @xmath   
  -- -------- --

and by Lemma 4.7 ,

  -- -- --
        
  -- -- --

Hence,

  -- -------- --
     @xmath   
  -- -------- --

By the proof of Lemma 4.6 , @xmath . The right-hand side becomes

  -- -- --
        
  -- -- --

and so

  -- -------- --
     @xmath   
  -- -------- --

by ( 4.1 ), since @xmath . ∎

###### Remark 4.9.

Proposition 4.8 shows that for @xmath , @xmath such that @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Therefore we may assume that @xmath , @xmath , @xmath for the last
section.

#### 4.4. The most general case

Before we can calculate @xmath for @xmath , @xmath , @xmath , we must
first calculate the commutator of the 2-cocycle @xmath on @xmath .

Let us define what a commutator is. Let @xmath be a 2-cocycle on an
abelian group @xmath with values in @xmath . Then the commutator of
@xmath is defined by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , @xmath . The commutator of @xmath is both
bimultiplicative, i.e. for @xmath , @xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and skew-symmetric, i.e.

  -- -------- --
     @xmath   
  -- -------- --

These are the standard properties of the commutator of @xmath . The
commutator of @xmath depends only on the cohomology class of @xmath ,
and if @xmath is a locally compact topological group and @xmath is
measurable then the commutator of @xmath is continuous.

###### Lemma 4.10.

Let @xmath , @xmath , and the commutator of the 2-cocycle @xmath on
@xmath be

  -- -- --
        
  -- -- --

Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We first assume that @xmath , i.e. @xmath is a split extension. In this
case, @xmath . Let @xmath and @xmath , where @xmath , @xmath . The
isomorphism on @xmath may be described by

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

It has been established in Section 0.1 of [ 8 ] that the commutator of
the 2-cocycle @xmath on the diagonal elements of @xmath may be described
as

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath differs from @xmath by at most a 1-coboundary, this implies
that we may use the above equation to calculate @xmath in the case where
@xmath is a split extension. Thus

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.11 ) and ( 4.1 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Let us define (as in the Introduction)

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , this implies that

  -- -------- --
     @xmath   
  -- -------- --

We want to show that the above equation holds for all quadratic
extensions @xmath . In order to do so, we first assume that @xmath is
the prime element of @xmath and that @xmath is coprime to @xmath . By
the properties of the commutator of the 2-cocycle, the commutator of the
2-cocycle @xmath on the torus is a map

  -- -------- --
     @xmath   
  -- -------- --

When @xmath does not divide @xmath , this means that

  -- -------- --
     @xmath   
  -- -------- --

and therefore

  -- -------- --
     @xmath   
  -- -------- --

which is generated by the element @xmath , where @xmath is a generator
for @xmath . In particular, @xmath is a unit. Thus, @xmath is determined
by @xmath , and we only need to check first that

  -- -------- --
     @xmath   
  -- -------- --

and second that the right hand side of this equation is bimultiplicative
and skew-symmetric. We will demonstrate the bimultiplicativity and
skew-symmetry at the end of this proof.

For @xmath , @xmath , we have by ( 2.5 ) that

  -- -------- --
     @xmath   
  -- -------- --

By Proposition 2.4 ,

  -- -------- --
              
     @xmath   
     @xmath   
  -- -------- --

where @xmath is defined as in ( 2.1 ), and hence

  -- -- --
        
  -- -- --

Therefore, if @xmath , @xmath , then @xmath , hence by the above,

  -- -- --
        
  -- -- --

By Proposition 2.1 , @xmath and @xmath . Hence by ( 2.4 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

This implies by ( 2.5 ) that

  -- -------- --
     @xmath   
  -- -------- --

hence by ( 4.1 ) and ( 2.12 ),

  -- -------- --
     @xmath   
  -- -------- --

In the case where @xmath is an unramified extension, we may take @xmath
. So assuming that @xmath is an unramified extension and that @xmath is
coprime to @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

Hence by the above and ( 3.9 ),

  -- -------- --
     @xmath   
  -- -------- --

and hence for all unramified extensions @xmath with @xmath coprime to
@xmath ,

  -- -------- --
     @xmath   
  -- -------- --

We now use the product formula to show that the above is true for all
quadratic extensions @xmath . We will need to use the adèle group (see
Subsection 1.4.3 ). We define some notation. Let @xmath be a global
quadratic extension. Let @xmath be a prime of @xmath , @xmath the
localisation of @xmath at @xmath , and just as in Subsection 1.4.3 , let
@xmath , i.e.

  -- -------- --
     @xmath   
  -- -------- --

Now let @xmath such that @xmath when @xmath and @xmath . Then for almost
all primes @xmath of @xmath , we know that for @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

We also know that since @xmath splits on @xmath , if @xmath , @xmath ,
then

  -- -------- --
     @xmath   
  -- -------- --

In addition, by the product formula (Theorem 3.2 ), for @xmath , @xmath
,

  -- -------- --
     @xmath   
  -- -------- --

Now choose a prime @xmath that is not unramified and coprime to @xmath ,
and also not split. Let @xmath , @xmath , and choose @xmath , @xmath
close to @xmath and @xmath respectively such that

  -- -------- --
     @xmath   
  -- -------- --

and such that @xmath , @xmath are close to 1 in @xmath for all other
primes @xmath which are not unramified and coprime to n and also not
split, i.e.

  -- -------- --
     @xmath   
  -- -------- --

Then by the product formula,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

The above implies that for all local quadratic extensions @xmath ,
@xmath , @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

but as stated earlier, we should show that the map @xmath is indeed a
map @xmath . Thus, we need to show that the map is bimultiplicative and
skew-symmetric.

It is trivial to show that the map is bimultiplicative. To show
skew-symmetry, we first note that by ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

and by ( 4.1 ),

  -- -------- --
     @xmath   
  -- -------- --

Now assume that @xmath . Then @xmath , and by ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

Hence in this case, @xmath .

As for the case where @xmath , let @xmath , where @xmath and @xmath .
Then @xmath , and hence by ( 2.11 ),

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.12 ), ( 2.13 ) and ( 2.14 ),

  -- -------- --
     @xmath   
  -- -------- --

and by ( 2.11 ),

  -- -------- --
     @xmath   
  -- -------- --

Hence by ( 3.8 ),

  -- -------- --
     @xmath   
  -- -------- --

Therefore @xmath in this case as well, i.e. the map @xmath is
skew-symmetric and hence the formula for the commutator on the torus is
indeed @xmath . ∎

We are now ready to find the explicit formula for @xmath , with @xmath ,
@xmath , @xmath .

###### Proposition 4.11.

For @xmath , @xmath such that @xmath ,

  -- -- --
        
  -- -- --

where, if @xmath , @xmath , with @xmath , @xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

This proof will follow closely the methods used in Section 2.29 of [ 6 ]
. For some @xmath , @xmath , @xmath , @xmath , @xmath , @xmath , define

  -- -------- --
     @xmath   
  -- -------- --

and let

  -- -------- --
     @xmath   
  -- -------- --

We will consider the case when @xmath , @xmath , @xmath . For any @xmath
, @xmath , let @xmath be defined as the element @xmath such that @xmath
, i.e. @xmath . (Clearly the operation is associative.)

As a first step, we let

  -- -------- --
     @xmath   
  -- -------- --

Then,

  -- -------- --
     @xmath   
  -- -------- --

By Proposition 2.4 ,

  -- -------- --
     @xmath   
  -- -------- --

This implies that

  -- -------- --
     @xmath   
  -- -------- --

By Proposition 2.4 again,

  -- -------- --
     @xmath   
  -- -------- --

Hence inserting the above into our equation,

  -- -------- --
     @xmath   
  -- -------- --

By Proposition 2.4 , for arbitrary @xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

therefore by the above, ( 2.4 ) and ( 4.7 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

where @xmath is as defined in ( 2.1 ). Also by the same method,

  -- -------- --
     @xmath   
              
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Using these in the equation for @xmath ,

  -------- -- -------- --
  (4.18)      @xmath   
  -------- -- -------- --

Also, since the above applies also in the group @xmath with the
corresponding group elements, and

  -- -------- --
     @xmath   
  -- -------- --

this implies that

  -- -------- --
     @xmath   
  -- -------- --

i.e.

  -------- -- -------- --
  (4.19)      @xmath   
  -------- -- -------- --

Let @xmath , with @xmath , @xmath . Define

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , then @xmath . As we will see later, this implies that there
are two cases to consider.

Let @xmath , @xmath . Choose @xmath , @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

which is always possible. Also, choose @xmath and @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Then by ( 4.19 ),

  -- -------- -------- --
     @xmath   @xmath   
     @xmath            
  -- -------- -------- --

Let

  -- -------- --
     @xmath   
  -- -------- --

so that

  -- -------- --
     @xmath   
  -- -------- --

and let

  -- -------- --
     @xmath   
  -- -------- --

so that

  -- -------- --
     @xmath   
  -- -------- --

This implies that by ( 4.19 ),

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

Since for all @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

we will work out @xmath , @xmath , @xmath and @xmath and use the
2-cocycle condition to get our result.

We first assume that @xmath , so that @xmath . Firstly, by ( 4.18 ),

  -- -------- --
     @xmath   
  -- -------- --

Consider (using ( 4.7 ))

  -- -------- --
     @xmath   
  -- -------- --

By Lemma 4.4 ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

and hence by ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

(Note that the calculation of

  -- -------- --
     @xmath   
  -- -------- --

is unsuitable as it gives @xmath in Lemma 4.4 .) Hence,

  -------- -- -------- --
  (4.20)      @xmath   
  -------- -- -------- --

and this clearly applies to any @xmath with @xmath . By our previous
calculations in this proof, we have

  -------- -- -------- --
  (4.21)      @xmath   
  -------- -- -------- --

Applying ( 4.20 ) to the above,

  -- -------- --
     @xmath   
  -- -------- --

and since @xmath is central in @xmath , the first two terms must cancel
the last two terms, giving

  -- -------- --
     @xmath   
  -- -------- --

By ( 4.7 ),

  -- -------- --
     @xmath   
  -- -------- --

which implies by ( 2.4 ) that

  -- -------- --
     @xmath   
  -- -------- --

We have by ( 2.5 ) that

  -- -------- --
     @xmath   
  -- -------- --

i.e.

  -- -------- --
     @xmath   
  -- -------- --

Replacing the above in the equation for @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Using the notation in Lemma 4.10 ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

thus by ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

By Lemma 4.10 ,

  -- -------- --
     @xmath   
  -- -------- --

Using the properties of Hilbert symbols, by ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

and by ( 3.9 ) and ( 2.13 ),

  -- -- --
        
  -- -- --

Therefore by ( 4.1 ),

  -- -------- --
     @xmath   
  -- -------- --

Also by ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

Hence, we have

  -- -------- --
     @xmath   
  -- -------- --

By Proposition 4.2 ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Thus,

  -- -------- --
     @xmath   
  -- -------- --

Using ( 4.18 ) also gives

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

and since @xmath is a central element of @xmath ,

  -------- -- -------- --
  (4.22)      @xmath   
  -------- -- -------- --

Consider

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

By Lemma 4.5 , it is obvious that

  -- -------- --
     @xmath   
  -- -------- --

so this implies that

  -- -------- --
     @xmath   
  -- -------- --

Hence, by Lemma 4.5 ,

  -- -------- --
     @xmath   
              
     @xmath   
  -- -------- --

if @xmath (we will deal with the case @xmath later). Since @xmath and
@xmath ,

  -- -- --
        
  -- -- --

This implies that

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

by ( 4.1 ).

If @xmath , then by Lemma 4.5 ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Since @xmath and @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

thus

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

by ( 4.1 ). Let @xmath denote the function

  -- -------- --
     @xmath   
  -- -------- --

By ( 4.7 ) and Lemma 4.4 ,

  -- -------- --
     @xmath   
              
     @xmath   
     @xmath   
  -- -------- --

if @xmath . (Note that

  -- -------- --
     @xmath   
  -- -------- --

gives @xmath in Lemma 4.4 .) This implies that by ( 2.13 ),

  -- -- --
        
  -- -- --

i.e.

  -------- -- -------- --
  (4.23)      @xmath   
  -------- -- -------- --

(by ( 4.1 )).

If @xmath , then @xmath . This implies that by ( 4.7 ) and Lemma 4.4 ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

so that

  -- -------- --
     @xmath   
  -- -------- --

Thus, let @xmath be the function

  -- -------- --
     @xmath   
  -- -------- --

This implies that

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

By the above, there are three cases to consider: @xmath , @xmath ;
@xmath , @xmath ; and @xmath , @xmath .

We can consider the first two cases together, as they differ only by
@xmath which is a central element in @xmath . Thus,

  -- -------- --
     @xmath   
  -- -------- --

Since by ( 4.7 ), @xmath , this implies by ( 2.4 ) that

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

which implies that

  -- -------- --
     @xmath   
  -- -------- --

By Lemma 4.10 ,

  -- -------- --
     @xmath   
  -- -------- --

Hence by ( 2.5 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

By Proposition 4.2 and ( 4.1 ),

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Also, Lemma 4.10 shows that

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , by ( 2.11 ) and ( 3.9 ), we have

  -- -------- --
     @xmath   
  -- -------- --

Therefore by ( 2.12 ) and ( 2.11 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

As for the last case ( @xmath , @xmath ), recall that in this case
@xmath . This implies that

  -- -------- --
     @xmath   
  -- -------- --

Since by ( 4.7 ), @xmath , this implies by ( 2.4 ) that

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

Hence, the equation we have becomes

  -- -------- --
     @xmath   
  -- -------- --

Using Lemma 4.10 , we get

  -- -------- --
     @xmath   
  -- -------- --

Thus by ( 2.5 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

By Proposition 4.2 ,

  -------- -- -------- -------- --
  (4.24)      @xmath   @xmath   
              @xmath            
  -------- -- -------- -------- --

and by ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

Therefore by our previous calculations,

  -- -------- --
     @xmath   
  -- -------- --

and by ( 2.12 ) and ( 2.11 ),

  -- -------- --
     @xmath   
  -- -------- --

In fact,

  -- -------- --
     @xmath   
  -- -------- --

i.e. we can use the same equation

  -------- -- -------- --
  (4.25)      @xmath   
  -------- -- -------- --

for all three cases.

Also, by similar methods to the above, we can show that

  -- -------- --
     @xmath   
  -- -------- --

We know that

  -- -------- --
     @xmath   
  -- -------- --

There are two cases to consider: @xmath ; and @xmath .

When @xmath , we can use ( 4.20 ) to get

  -- -------- --
     @xmath   
  -- -------- --

thus

  -- -------- --
     @xmath   
  -- -------- --

Since by ( 4.7 ), @xmath , by ( 2.4 ) the equation becomes

  -- -------- --
     @xmath   
  -- -------- --

Using ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

We thus get

  -- -------- --
     @xmath   
  -- -------- --

By Lemma 4.10 ,

  -- -- --
        
  -- -- --

and hence by ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

By Proposition 4.2 ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Also, by Lemma 4.10 ,

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath and @xmath , we have

  -- -- --
        
  -- -- --

By ( 2.11 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

By ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

Using ( 2.14 ), we have

  -- -------- --
     @xmath   
  -- -------- --

By ( 3.8 ) and ( 3.9 ),

  -- -------- --
     @xmath   
  -- -------- --

Using ( 2.11 ) again,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

By ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.12 ) and ( 4.1 ),

  -- -------- --
     @xmath   
  -- -------- --

Hence by ( 2.11 ) again,

  -- -- --
        
  -- -- --

Therefore,

  -- -------- --
     @xmath   
  -- -------- --

As for the case @xmath , we have @xmath . This implies that

  -- -------- --
     @xmath   
  -- -------- --

By ( 4.7 ) and Lemma 4.4 ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

i.e.

  -------- -- -------- --
  (4.26)      @xmath   
  -------- -- -------- --

Thus,

  -- -------- --
     @xmath   
  -- -------- --

Since by ( 4.7 ), @xmath , utilising ( 2.4 ) makes the above equation
become

  -- -- --
        
  -- -- --

By ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

hence

  -- -------- --
     @xmath   
  -- -------- --

We can use Lemma 4.10 to get

  -- -------- --
     @xmath   
  -- -------- --

Hence by ( 2.5 ) and ( 4.24 ),

  -- -- --
        
  -- -- --

But since @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

This implies that we can use our previous result for @xmath so that

  -- -------- --
     @xmath   
  -- -------- --

In the end,

  -- -------- --
     @xmath   
  -- -------- --

which simplifies by ( 2.13 ) and ( 2.11 ) to

  -- -------- --
     @xmath   
  -- -------- --

Thus, we may use the above equation for both cases.

Similarly for @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.4 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Thus using ( 4.2 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Hence by the 2-cocycle condition, i.e.

  -- -------- --
     @xmath   
  -- -------- --

we have

  -- -------- --
     @xmath   
  -- -------- --

Also, @xmath and @xmath , hence we can rearrange the above as follows:

  -- -- --
        
  -- -- --

Thus by ( 4.1 ) and ( 2.12 ),

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.11 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

By ( 2.13 ),

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

This implies that

  -- -------- --
     @xmath   
  -- -------- --

thus by ( 2.13 ) and ( 2.11 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

We will now use Lemma 4.7 to get our desired result. Firstly,

  -- -- --
        
        
  -- -- --

since @xmath . Simplifying the above using the properties of Hilbert
symbols, we get

  -- -------- --
     @xmath   
  -- -------- --

Inserting the equation we have for @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

and by ( 2.12 ),

  -- -- --
        
  -- -- --

Thus by ( 2.11 ),

  -- -------- --
     @xmath   
  -- -------- --

and using ( 2.13 ) again,

  -- -- --
        
  -- -- --

Let @xmath and replace @xmath with @xmath . This implies that by ( 4.5 )
and ( 4.6 ),

  -- -------- --
     @xmath   
  -- -------- --

Therefore, choose @xmath , @xmath such that @xmath , which is always
possible due to Proposition 2.1 . This implies by the same proposition
that

  -- -------- --
     @xmath   
  -- -------- --

Hence,

  -- -- --
        
  -- -- --

We know that by Lemma 4.7 , since @xmath ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

It can be shown that @xmath , thus with what we have so far the equation
becomes

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.11 ),

  -- -- --
        
  -- -- --

and by ( 2.12 ),

  -- -------- --
     @xmath   
  -- -------- --

Thus by ( 2.11 ),

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

hence by also using ( 2.12 ), we finally get

  -- -- --
        
  -- -- --

i.e.

  -------- -- -------- --
  (4.27)      @xmath   
  -------- -- -------- --

So if @xmath , where @xmath , @xmath , then @xmath , and by ( 4.1 ),

  -- -------- --
     @xmath   
  -- -------- --

We are left with the case when @xmath . This case is slightly different
from the above because @xmath , which alters @xmath and @xmath .

Firstly, by ( 4.21 ), we know that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

By ( 4.26 ),

  -- -------- --
     @xmath   
  -- -------- --

Since by ( 4.7 ), @xmath , by ( 2.4 ),

  -- -- --
        
  -- -- --

Hence by ( 2.5 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

By ( 4.24 ),

  -- -------- --
     @xmath   
  -- -------- --

Thus by ( 2.13 ) and ( 2.11 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

which coincides with the case when @xmath .

As for @xmath , by ( 4.22 ), we know that since @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , we can still use ( 4.23 ) in the above to obtain

  -- -- --
        
  -- -- --

and in a similar fashion to what we have done previously in the first
case when @xmath , we can show that

  -- -------- --
     @xmath   
  -- -------- --

If we compare the above with ( 4.25 ), we can see that they only differ
by a factor @xmath which only exists if @xmath . Consequently, since it
can be checked that both @xmath and @xmath remain unchanged, by same
method we used above for @xmath , this shows that for @xmath ,

  -- -- --
        
  -- -- --

where for @xmath , @xmath , @xmath , @xmath , @xmath , @xmath , i.e. the
above only differs from ( 4.27 ) by @xmath . ∎

Our results from Proposition 4.2 , Remark 4.9 and Proposition 4.11 can
be summarised by the following theorem:

###### Theorem 4.12.

For @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

where, if @xmath , @xmath , with @xmath , @xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

### Chapter 5 The 2-cocycle on the rest of @xmath

Recall that we have set @xmath . We have defined a section @xmath in
Section 2.3 . Hence, we can use this section and Theorem 4.12 to find
the universal 2-cocycle on @xmath . Note that by ( 2.5 ) and Theorem
4.12 , we already know explicitly what @xmath is on @xmath in terms of
@xmath ’s for @xmath , @xmath ; so from this subsection onwards we will
only use @xmath as a function on @xmath , and otherwise use @xmath as
described by ( 2.5 ).

#### 5.1. The easy cases

To start with, let @xmath , @xmath , where @xmath is defined as in ( 2.2
). It is obvious that for @xmath , @xmath ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Therefore, since for @xmath ,

  -- -- --
        
  -- -- --

the above implies that

  -- -------- --
              
     @xmath   
  -- -------- --

Also, if @xmath , by ( 2.4 ),

  -- -------- --
     @xmath   
  -- -------- --

Thus by ( 4.7 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Thus by ( 2.4 ) again,

  -- -------- --
     @xmath   
  -- -------- --

and this implies by ( 4.2 ) that

  ------- -- -------- --
  (5.1)      @xmath   
  ------- -- -------- --

As a result, for @xmath ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

(Note that for any @xmath , @xmath , @xmath .) By ( 2.4 ), we have

  -- -------- --
     @xmath   
  -- -------- --

Thus by ( 2.5 ),

  -- -------- --
     @xmath   
              
     @xmath   
  -- -------- --

If @xmath , by ( 2.4 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Thus by ( 4.7 ),

  -- -------- --
     @xmath   
  -- -------- --

and by using Proposition 2.4 twice,

  ------- -- -------- -------- --
  (5.2)      @xmath   @xmath   
             @xmath            
  ------- -- -------- -------- --

Thus for @xmath ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Thus by ( 2.4 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

hence by ( 2.5 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Similarly, since @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Thus using ( 5.1 ), ( 5.2 ) and ( 2.4 ),

  -- -- --
        
  -- -- --

Therefore by ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

Also, note that by the definition of our section,

  -- -------- --
     @xmath   
  -- -------- --

#### 5.2. The difficult case

We are now left with the most difficult case, i.e. the next proposition.

###### Proposition 5.1.

For @xmath , @xmath , with @xmath , where @xmath , @xmath for @xmath ,
@xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Our proof will use similar methods used in Proposition 4.11 . By ( 4.18
) and ( 4.19 ),

  -- -- --
        
  -- -- --

hence simplifying the above gives

  ------- -- -------- --
  (5.3)      @xmath   
  ------- -- -------- --

There are two cases to consider: when @xmath ; and when @xmath .

When @xmath , this implies that @xmath . Thus, ( 5.3 ) becomes

  -- -------- --
     @xmath   
  -- -------- --

and by ( 2.4 ),

  -- -------- --
     @xmath   
              
     @xmath   
  -- -------- --

By ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

therefore the equation becomes

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.5 ) again,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

(Note that @xmath for any @xmath by ( 4.1 ).)

Now let @xmath . We want to consider

  -- -------- --
     @xmath   
  -- -------- --

The above implies that ( 5.3 ) becomes

  -- -------- --
     @xmath   
  -- -------- --

and since by ( 4.7 ), @xmath , by ( 2.4 ),

  ------- -- -- --
  (5.4)         
  ------- -- -- --

We first note that

  -- -------- --
     @xmath   
  -- -------- --

by ( 4.7 ). Let

  -- -------- --
     @xmath   
  -- -------- --

then

  -- -------- --
     @xmath   
  -- -------- --

By Lemma 4.4 , there are four cases to consider: @xmath ; @xmath ,
@xmath ; @xmath , @xmath , @xmath , @xmath , @xmath , @xmath , @xmath ;
and @xmath , @xmath , @xmath , @xmath , @xmath , @xmath , @xmath .

Let @xmath , i.e. @xmath . By Lemma 4.4 ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Using the above in ( 5.4 ),

  -- -- --
        
  -- -- --

By ( 2.5 ),

  -- -------- --
     @xmath   
  -- -------- --

thus

  -- -------- --
     @xmath   
  -- -------- --

By ( 4.1 ),

  -- -------- --
     @xmath   
  -- -------- --

Also, since @xmath , @xmath , hence by ( 2.5 ),

  -- -------- --
     @xmath   
              
     @xmath   
     @xmath   
  -- -------- --

By ( 2.11 ),

  -- -------- --
     @xmath   
  -- -------- --

By Theorem 4.12 , ( 2.13 ) and ( 2.12 ),

  ------- -- -- --
  (5.5)         
  ------- -- -- --

Also, by ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

Therefore by ( 2.11 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Since @xmath , @xmath , hence by ( 2.13 ),

  -- -------- -------- --
     @xmath            
              @xmath   
              @xmath   
  -- -------- -------- --

Thus,

  -- -------- --
     @xmath   
  -- -------- --

by ( 2.12 ). This implies that

  -- -------- --
     @xmath   
  -- -------- --

If instead @xmath , @xmath , i.e. @xmath , @xmath , this implies that
both @xmath , @xmath . Also, by Lemma 4.4 and ( 2.12 ),

  -- -------- -------- --
     @xmath   @xmath   
                       
              @xmath   
              @xmath   
  -- -------- -------- --

Using the above in ( 5.4 ),

  -- -------- --
     @xmath   
  -- -------- --

and by ( 2.5 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
              
  -- -------- --

By Theorem 4.12 and ( 2.13 ), we know that

  -- -------- -------- --
     @xmath            
              @xmath   
              @xmath   
  -- -------- -------- --

Hence by ( 2.11 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

But by ( 2.12 ),

  -- -------- --
     @xmath   
  -- -------- --

and by ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

Thus,

  -- -------- --
     @xmath   
  -- -------- --

Otherwise, let @xmath , @xmath , where @xmath , @xmath , @xmath , @xmath
, with @xmath since @xmath . This implies that

  -- -------- --
     @xmath   
  -- -------- --

Then by Lemma 4.4 , the equation

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

is valid if we have @xmath . Thus, assume @xmath . By ( 2.11 ),

  -- -------- --
     @xmath   
  -- -------- --

and by ( 2.12 ),

  -- -------- --
     @xmath   
  -- -------- --

By ( 4.1 ),

  -- -- --
        
  -- -- --

and by ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

Therefore by ( 2.11 ),

  -- -------- --
     @xmath   
  -- -------- --

Replacing the above in ( 5.4 ),

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.5 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

By ( 5.5 ),

  -- -- --
        
  -- -- --

But by ( 2.11 ),

  -- -- --
        
  -- -- --

and by ( 2.12 ),

  -- -------- --
     @xmath   
  -- -------- --

This implies that

  -- -- --
        
  -- -- --

By ( 2.11 ),

  -- -------- --
     @xmath   
  -- -------- --

thus by ( 4.1 ),

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , then @xmath . Consequently, @xmath , otherwise @xmath ,
which is a case we have already dealt with. Consider

  -- -------- --
     @xmath   
  -- -------- --

By ( 4.7 ),

  -- -------- --
     @xmath   
  -- -------- --

and thus by Lemma 4.4 ,

  -- -------- -------- --
     @xmath            
              @xmath   
  -- -------- -------- --

which is valid since @xmath . By using ( 2.13 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

This implies that by ( 4.1 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Hence in ( 5.4 ),

  -- -------- --
     @xmath   
  -- -------- --

By ( 2.5 ),

  -- -- --
        
  -- -- --

Therefore,

  -- -------- --
     @xmath   
  -- -------- --

Thus by ( 2.5 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

But by Theorem 4.12 ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

and by ( 2.13 ),

  -- -------- --
     @xmath   
  -- -------- --

therefore by ( 4.1 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

This implies that by ( 2.12 ),

  -- -- --
        
  -- -- --

thus by ( 2.11 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Our result is proved. ∎

### Chapter 6 The 2-cocycle of the double cover

Recall that at the beginning of Chapter 4 , we stated that

  -- -------- --
     @xmath   
  -- -------- --

where @xmath corresponds to the non-trivial double cover and @xmath is
the number of roots of unity of @xmath . Also, by Proposition 2.8 , we
know that without loss of generality, we can replace @xmath by @xmath
for all @xmath , @xmath .

We know that

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath , @xmath since @xmath is always even for a local field
@xmath of characteristic zero. Hence, by Proposition 2.8 , we have a
homomorphism

  ------- -------- -------- -------- --
  (6.1)            @xmath   @xmath   
          @xmath   @xmath            
  ------- -------- -------- -------- --

This implies that if we let @xmath be the map @xmath for all @xmath ,
@xmath , then we can state that @xmath .

Using the above as well as Theorem 4.12 and Chapter 5 , we have the
following proposition:

###### Proposition 6.1.

For @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

where, if @xmath , @xmath , with @xmath , @xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Also, for @xmath , @xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

and

1.  @xmath

2.  @xmath

3.  @xmath ,

4.  @xmath
    where for @xmath , @xmath , @xmath , @xmath , @xmath , @xmath ,

      -- -- --
            
      -- -- --

###### Proof.

Note that we will use the properties of the Hilbert symbol ( 3.1 ) – (
3.7 ) as stated in Section 3.1 . We first apply @xmath to Theorem 4.12 .
The first four cases cannot be further simplified after applying @xmath
; but when we look at the last case, i.e. when @xmath , @xmath , @xmath
, we see that by ( 3.6 ),

  -- -------- --
     @xmath   
  -- -------- --

Also,

  -- -------- --
     @xmath   
  -- -------- --

By ( 3.4 ),

  -- -------- --
     @xmath   
  -- -------- --

and since @xmath , by ( 3.6 ),

  -- -------- --
     @xmath   
  -- -------- --

Hence by ( 3.4 ),

  -- -------- --
     @xmath   
  -- -------- --

thus using ( 3.2 ) and ( 3.1 ),

  -- -------- --
     @xmath   
  -- -------- --

Consequently, for @xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
     @xmath   
              
              
  -- -------- --

Clearly for @xmath , @xmath ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

At the beginning of Chapter 5 , we showed that

  -- -- --
        
  -- -- --

By applying @xmath to the above, we see that

  -- -------- --
     @xmath   
  -- -------- --

But for any @xmath , @xmath ,

  -- -- --
        
  -- -- --

Also, as @xmath , @xmath . Hence by ( 3.1 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Thus, for @xmath ,

  -- -- --
        
  -- -- --

Also, using previous results in this proof, for @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

This implies that we can state that for any @xmath , @xmath ,

  -- -- --
        
  -- -- --

By the same token, it possible to show that for any @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and we already know by definition that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Thus, all we need to do now is to show explicitly what

  -- -------- --
     @xmath   
  -- -------- --

is, for @xmath , where we let @xmath , @xmath , @xmath , @xmath , @xmath
, @xmath . By Proposition 5.1 , we know that

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

where @xmath is as described by the said proposition. We will need to
look at @xmath , specifically in the cases in which the Hilbert symbols
can be further simplified, i.e. when @xmath , @xmath ; and when @xmath ,
@xmath , @xmath .

When @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Using ( 3.4 ),

  -- -------- --
     @xmath   
  -- -------- --

hence,

  -- -------- --
     @xmath   
  -- -------- --

by ( 3.6 ). Also, when @xmath , @xmath , @xmath ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

By ( 3.4 ),

  -- -------- --
     @xmath   
  -- -------- --

thus

  -- -------- --
     @xmath   
  -- -------- --

by ( 3.6 ). Thus our result is proved, letting @xmath . ∎

###### Remark 6.2.

We should note that the formulae for @xmath may be written in terms of
norms and traces. This is because for @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

hence by Proposition 6.1 , for @xmath , @xmath ,

  -- -------- --
     @xmath   
              
  -- -------- --

By ( 3.4 ) and ( 3.1 ),

  -- -------- --
     @xmath   
              
  -- -------- --

When @xmath , @xmath , we have by ( 3.7 ) that

  -- -------- --
     @xmath   
  -- -------- --

Also, when @xmath , @xmath , @xmath , by ( 3.7 ) and ( 3.2 ),

  -- -------- --
     @xmath   
  -- -------- --

Thus with the above, ( 3.6 ) and ( 3.4 ),

  -- -- --
        
  -- -- --

which is the formula given in the Introduction.

Proposition 6.1 may seem complicated and unwieldy, but in fact, it can
be further simplified. Let @xmath , where @xmath , @xmath , @xmath ,
with @xmath and

  -- -------- --
     @xmath   
  -- -------- --

Also, let

  -- -------- --
     @xmath   
  -- -------- --

and for @xmath , @xmath , let

  -- -------- --
     @xmath   
  -- -------- --

Then @xmath can be expressed in terms of Hilbert symbols involving
@xmath and @xmath as shown in the following theorem. It should be noted
that @xmath is analogous to Kubota’s @xmath ( @xmath ) as defined in [ 9
] , which was used in the formula for his 2-cocycle on @xmath .

###### Theorem 6.3.

If @xmath , then

  -- -- --
        
  -- -- --

If @xmath , let

  -- -------- --
     @xmath   
  -- -------- --

Then we have

  -- -- --
        
  -- -- --

###### Proof.

We first note that we want to use the matrix entries of @xmath in the
formula for our 2-cocycle much in the same way as Kubota did (see [ 9 ]
) in his theorem for the 2-cocycle on the group @xmath . The matrix
entry used depended on the Bruhat decomposition and which Bruhat cell
the matrix belonged to; the choice made was considered using the bottom
row of the matrix only.

In our case, we can do the same thing as there are only two Bruhat cells
to consider (see Section 1.2 ), just like the @xmath case. Looking at (
1.3 ) and ( 1.4 ), it is clear that the Bruhat cell a matrix in @xmath
belongs to depends on whether the @xmath -entry is non-zero, and a
choice can be made as follows. With

  -- -------- --
     @xmath   
  -- -------- --

i = @xmath , @xmath , @xmath , and @xmath , let

  -- -------- --
     @xmath   
  -- -------- --

Note that for any @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

We will have to prove this theorem in a few steps. We first find a
simplified formula for the 2-cocycle on the torus @xmath , written in
terms of @xmath ’s. We then look for similar formulae for each of the
cases (1) – (3) of Proposition 6.1 . We will also look at case (4) of
Proposition 6.1 , finding a simplification of @xmath . It will then be
apparent how the formulae coincide.

We will often use the properties of Hilbert symbols ( 3.1 ) – ( 3.6 ) to
simplify expressions in terms of Hilbert symbols. We will use these
properties mostly without mention throughout the rest of this proof.

Throughout this proof, let @xmath , @xmath , @xmath , @xmath , where
@xmath , @xmath , @xmath , @xmath and @xmath . By Proposition 6.1 , we
have

  -- -------- --
     @xmath   
  -- -------- --

where @xmath . This implies that

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

For any @xmath , @xmath , let

  -- -------- --
     @xmath   
  -- -------- --

Then we have

  -- -------- --
     @xmath   
  -- -------- --

Using ( 4.6 ) and the properties of Hilbert symbols ( 3.1 ) – ( 3.6 ),
we can simplify @xmath . Only the case where @xmath , @xmath , @xmath
deserves some elaboration. Noting that

  -- -------- --
     @xmath   
  -- -------- --

we have

  -- -------- --
     @xmath   
  -- -------- --

Also, note that @xmath . The above can then be simplified using the
properties of Hilbert symbols. We will get

  -- -- --
        
  -- -- --

By comparing @xmath with Proposition 6.1 , we find that

  -- -------- --
     @xmath   
  -- -------- --

In fact, if we let

  -- -------- --
     @xmath   
  -- -------- --

then

  -- -------- --
     @xmath   
  -- -------- --

Note that

  -- -------- --
     @xmath   
  -- -------- --

so we truly get a formula in terms of @xmath on the torus. Also, by
Proposition 6.1 , @xmath . We note that

  -- -------- --
     @xmath   
  -- -------- --

i.e. for @xmath , @xmath ,

  ------- -- -------- --
  (6.2)      @xmath   
  ------- -- -------- --

Note that ( 6.2 ) can also be applied to any @xmath , @xmath such that
@xmath . This is due to the Bruhat decomposition and Proposition 6.1 .

We now consider case (2) of Proposition 6.1 , where

  -- -------- --
     @xmath   
  -- -------- --

Using Proposition 6.1 and the properties of Hilbert symbols ( 3.1 ) – (
3.6 ), we get

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

We have

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Just like the 2-cocycle on the torus, we will find a formula for @xmath
, @xmath , @xmath , in terms of @xmath ’s. By ( 4.6 ), we have

  -- -------- --
     @xmath   
  -- -------- --

which implies that

  -- -------- --
     @xmath   
  -- -------- --

The above can be simplified using the properties of Hilbert symbols, so
that we get

  -- -------- --
     @xmath   
  -- -------- --

Let

  -- -- --
        
  -- -- --

It is possible to check that when @xmath , @xmath , @xmath , and that

  -- -- --
        
  -- -- --

Thus we can get a similar formula

  -- -------- --
     @xmath   
  -- -------- --

i.e. for @xmath , @xmath ,

  ------- -- -------- --
  (6.3)      @xmath   
  ------- -- -------- --

In fact, ( 6.2 ) can be subsumed into ( 6.3 ), since for @xmath , @xmath
, we have @xmath hence using ( 6.3 ) to calculate @xmath will give the
same answer as ( 6.2 ). Also, it can be checked that ( 6.3 ) can be
applied to any @xmath , @xmath such that @xmath or @xmath , using the
Bruhat decomposition and Proposition 6.1 .

We also have, by Proposition 6.1 ,

  -- -- --
        
  -- -- --

i.e.

  -- -------- --
     @xmath   
              
  -- -------- --

Note that

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

By ( 4.6 ),

  -- -------- --
     @xmath   
  -- -------- --

hence we get

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Let

  -- -- --
        
  -- -- --

It can be checked that @xmath when @xmath , @xmath , and that

  -- -------- --
     @xmath   
  -- -------- --

In other words, if we let

  -- -------- --
     @xmath   
  -- -------- --

then

  -- -------- --
     @xmath   
  -- -------- --

i.e. for @xmath , @xmath ,

  ------- -- -------- --
  (6.4)      @xmath   
  ------- -- -------- --

Again it can be checked that for any @xmath , @xmath such that @xmath ,
( 6.4 ) can be applied.

We now look at case (4) of Proposition 6.1 , i.e. where

  -- -------- --
     @xmath   
  -- -------- --

We have

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

In all the previous cases, it is apparent that for any @xmath , @xmath ,
we have @xmath . We want to find out if a simplified formula exists and
be similar to ( 6.2 ), ( 6.3 ) and ( 6.4 ) if

  -- -- --
        
  -- -- --

So assume @xmath . This implies that @xmath and @xmath . By Proposition
6.1 and after simplifying, we have

  -- -------- --
     @xmath   
              
  -- -------- --

For any @xmath , @xmath , @xmath , let

  -- -- --
        
  -- -- --

Then we have @xmath for @xmath , @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

So if

  -- -------- --
     @xmath   
  -- -------- --

then

  -- -- --
        
  -- -- --

In other words, if @xmath , @xmath , @xmath , then

  ------- -- -------- --
  (6.5)      @xmath   
  ------- -- -------- --

and we observe that ( 6.5 ) may be applied to any two elements @xmath ,
@xmath such that @xmath . (Note that using the properties of Hilbert
symbols, we can show that if @xmath or @xmath , then @xmath , and if
@xmath , then @xmath .)

As we can see, ( 6.3 ), ( 6.4 ) and ( 6.5 ) each differ from each other
by a factor, i.e. if @xmath , @xmath such that @xmath , then we want a
function

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

so that

  -- -------- --
     @xmath   
  -- -------- --

But we have, using the properties of Hilbert symbols,

  -- -------- --
     @xmath   
  -- -------- --

for any @xmath , @xmath , @xmath such that @xmath . These remarks bring
us to define for any @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

so that we have

  ------- -- -- --
  (6.6)         
  ------- -- -- --

( 6.6 ) obviously is only defined when @xmath , which implies that we
need to find a different formula for the case when @xmath .

We still have yet to look at

  -- -------- --
     @xmath   
  -- -------- --

where @xmath . What we first need to do is to find a formula for @xmath
, where @xmath is as defined in Proposition 6.1 . As @xmath depends on
whether @xmath , @xmath and @xmath lie in the subfield @xmath , we
should find a formula which only involves these three values.

Recall that for @xmath (see ( 2.2 )), @xmath , @xmath , @xmath , @xmath
, @xmath , @xmath , @xmath , @xmath and @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , this implies that

  -- -------- --
     @xmath   
  -- -------- --

Also, we have

  -- -------- --
     @xmath   
  -- -------- --

Thus,

  -- -------- --
     @xmath   
  -- -------- --

and simplifying the above, we get

  -- -- --
        
  -- -- --

In fact, if we let @xmath with @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

then we can check that

  -- -------- --
     @xmath   
  -- -------- --

for any @xmath , @xmath .

So this implies that by Proposition 6.1 and ( 6.6 ),

  ------- -------- -------- --
  (6.7)            @xmath   
          @xmath            
          @xmath            
  ------- -------- -------- --

We want to show, for every @xmath , @xmath such that @xmath , that
@xmath can be calculated using ( 6.7 ). We will also find an expression
for @xmath only in terms of the bottom row entries of @xmath , @xmath
and @xmath .

Assume that @xmath . It is obvious that @xmath for each @xmath , @xmath
, @xmath is never zero. Let

  -- -------- --
     @xmath   
  -- -------- --

Then by the Bruhat decomposition ( 1.3 ),

  -- -------- --
     @xmath   
  -- -------- --

By Proposition 6.1 ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Let

  -- -------- --
     @xmath   
  -- -------- --

Then we have

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Since @xmath , this implies that @xmath , i.e. @xmath . Hence we use (
6.7 ) so that

  -- -- --
        
  -- -- --

We could just let @xmath , but there is another way to calculate @xmath
from just the bottom rows of the @xmath ’s. We have

  -- -------- --
     @xmath   
  -- -------- --

and rearranging the above,

  -- -------- --
     @xmath   
  -- -------- --

Thus our result is proved. ∎

###### Remark 6.4.

Recall that in Lemma 4.10 , we established that the commutator of the
2-cocycle @xmath on the torus @xmath was, for @xmath , @xmath ,

  -- -- --
        
  -- -- --

Since @xmath , we can calculate the commutator of the 2-cocycle @xmath
on @xmath . Since @xmath for all @xmath , @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

But using ( 3.1 ) and ( 3.6 ), we get

  -- -------- --
     @xmath   
  -- -------- --

## Part III The local Kubota symbol

### Chapter 7 The compact open subgroup on which the quadratic 2-cocycle
splits

We have a 2-cocycle @xmath on @xmath , where @xmath is a local field. In
the case that @xmath is non-archimedean, there is a compact open
subgroup @xmath on which @xmath splits, i.e.

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is a 1-cochain. Note that @xmath is not quite unique, since
it may be multiplied by a homomorphism @xmath . The function @xmath is
called a local Kubota symbol. In this chapter we shall determine the
compact open subgroup @xmath on which @xmath splits.

For the rest of this chapter, let @xmath be a local field, and @xmath be
the quadratic extension of @xmath . Also, we will let @xmath denote the
maximal ideal of @xmath . @xmath may be odd or even, depending on @xmath
. When @xmath is ramified, we will assume that @xmath is a prime element
of @xmath .

In addition to unramified and ramified extensions, we will also need to
consider split extensions, i.e. @xmath , when establishing the compact
open subgroup on which @xmath splits for a given extension @xmath . This
is so that we can consider the adèle group in Chapter 8 . We will obtain
the following theorem:

###### Theorem 7.1.

Define a compact open subgroup @xmath of @xmath as follows:

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is defined as in ( 7.1 ) and @xmath is defined as in ( 7.2
). Then @xmath splits on @xmath .

The rest of this chapter is a proof of the above theorem.

#### 7.1. The odd primes

@xmath is either unramified, ramified or split. We will look at each
type extension in turn.

##### 7.1.1. The unramified extension

In [ 5 ] , Deligne constructed for any reductive group @xmath over
@xmath a canonical central extension

  -- -------- --
     @xmath   
  -- -------- --

In the above, @xmath , and in the case that @xmath contains an @xmath
-th root of unity, @xmath is canonically isomorphic to @xmath (see 5.4
of [ 5 ] ).

Suppose now that @xmath is defined over the valuation ring @xmath in
@xmath . Deligne shows that when @xmath is semi-simple and simply
connected over @xmath and @xmath is not a multiple of @xmath , the
functoriality for the map @xmath reduces to a splitting

  -- -- --
        
  -- -- --

In the case that @xmath is unramified, we shall show that @xmath is
semi-simple and simply connected over @xmath , and that Deligne’s
extension is the same as Deodhar’s when @xmath is the number of roots of
unity in @xmath . Hence Deligne’s splitting shows that we may take
@xmath in Theorem 7.1 .

###### Lemma 7.2.

@xmath is semi-simple and simply connected over @xmath .

###### Proof.

We recall that this means that @xmath is semi-simple and simply
connected both over @xmath and over the residue field @xmath . The
conditions of being semi-simple and simply connected over a field are
unchanged when one passes to a field extension. It is therefore
sufficient to show that @xmath is semi-simple and simply connected over
the algebraic closures @xmath and @xmath .

Over @xmath , we have an isomorphism of algebraic groups:

  -- -------- --
     @xmath   
  -- -------- --

The same isomorphism holds over @xmath . To see this, note that for any
@xmath -algebra @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is defined as in Section 1.1 . When @xmath is an algebra
over the quadratic extension @xmath , the tensor product @xmath splits
into a sum of two copies of @xmath , which are swapped by conjugation in
@xmath . Choosing one of these copies gives an isomorphism @xmath .

Now since @xmath is semi-simple and simply connected, it follows that
@xmath is also semi-simple and simply connected. ∎

Note that when @xmath is ramified in @xmath , the group @xmath over
@xmath is not reductive, since the radical is

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the prime ideal of @xmath .

###### Lemma 7.3.

If @xmath is the number of roots of unity in @xmath , then Deligne’s
extension @xmath is the universal topological central extension.

###### Proof.

There is a @xmath -subgroup of @xmath isomorphic to @xmath , and so we
have a restriction map in continuous cohomology:

  -- -------- --
     @xmath   
  -- -------- --

Given a map from @xmath to @xmath , we obtain elements of @xmath and
@xmath constructed by Deodhar and Kubota (as well as Matsumoto, see [ 11
] ) respectively. It is clear by inspection that the restriction of
Deodhar’s element to @xmath is Kubota’s element. In particular, this
restriction map is injective.

We also have elements of @xmath and @xmath constructed by Deligne.
Deligne shows in the commutative diagram 3.9.2 of [ 5 ] that the
restriction of his element of @xmath is the other element. Deligne also
proves in Proposition 3.7 of the same paper that for a semi-simple,
simply connected split group (such as @xmath ), his element is the same
as Matsumoto’s. This implies that Deligne’s element of @xmath is the
same as Deodhar’s. It follows that @xmath in the above diagram is a
universal central extension. ∎

##### 7.1.2. The ramified extensions

Let @xmath be an odd ramified prime, and hence @xmath . This implies
that there exists a maximal ideal @xmath such that @xmath . In fact,
since @xmath , we have @xmath by Theorem 3.3 as @xmath is a prime
element of @xmath . We shall write @xmath for the field @xmath , which
is the same as @xmath .

By Theorem 3.3 , we have @xmath . This implies that we can take @xmath
as an integral basis.

So we have @xmath . For @xmath , let

  ------- -- -------- --
  (7.1)      @xmath   
  ------- -- -------- --

We know that our 2-cocycle @xmath splits on @xmath for sufficiently
large @xmath , and we will show that we may take @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

and the quotients are:

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

for @xmath and where @xmath is the Lie algebra of @xmath (see Section
1.1 ). This implies that @xmath is odd since @xmath is a vector space
over @xmath .

Proposition 9 of Chapter I of [ 18 ] states the following:

###### Proposition 7.4.

Let @xmath be a profinite group and @xmath be a closed subgroup of
@xmath , with @xmath an abelian group on which @xmath acts continuously.
Then if @xmath , the kernel of @xmath is killed by @xmath .

If we put @xmath , @xmath and @xmath in the above proposition, then let
@xmath be in the kernel of the restriction homomorphism

  -- -------- --
     @xmath   
  -- -------- --

Writing the group operations in @xmath additively, we have

  -- -------- --
     @xmath   
  -- -------- --

But since @xmath , and @xmath is odd, this implies that @xmath . But if
our 2-cocycle @xmath splits on @xmath for some @xmath , our result shows
that it must split on @xmath , hence our 2-cocycle @xmath splits on
@xmath .

##### 7.1.3. The split extensions

In the split case, we have @xmath . This implies that @xmath . The
@xmath -fold cover of @xmath was studied by Kazhdan and Patterson (see [
8 ] ). They proved (Proposition 0.1.2) that if @xmath is not a multiple
of @xmath then the extension splits on the compact open subgroup @xmath
. Since in our case @xmath , this holds for all odd split primes.
Alternatively, one could get the same result from Deligne’s paper as
above.

#### 7.2. The even split primes

Now assume that @xmath divides 2 and assume that @xmath splits in @xmath
. As in the other split cases we have @xmath , and we may use results of
other authors on @xmath . For this purpose, choose another number field
@xmath , which is totally complex, and which has a local completion
isomorphic to @xmath . The Kubota symbol on @xmath has been studied in [
1 ] in connection with the congruence subgroup problem. The level at
which the Kubota symbol is defined tells us the compact open subgroup on
which the cocycle splits. This level is established in Theorem 4.1 of [
1 ] , which may be paraphrased as follows:

###### Proposition 7.5.

Let @xmath be the number of roots of unity in @xmath and let @xmath be a
subgroup of @xmath . Then the Kubota symbol @xmath is defined at level
@xmath as long as for each prime @xmath dividing @xmath we have

  -- -- --
        
  -- -- --

In particular, in the case @xmath we may take @xmath . This shows that
our cocycle splits at level @xmath , i.e. our cocycle splits on

  ------- -- -------- --
  (7.2)      @xmath   
  ------- -- -------- --

If we have a Kubota symbol @xmath , then @xmath . But we should note
that this Kubota symbol is not unique on @xmath ; it is only unique on

  -- -------- --
     @xmath   
  -- -------- --

This is because @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

hence

  -- -------- --
     @xmath   
  -- -------- --

and any @xmath would make @xmath another choice for the Kubota symbol on
@xmath . We will only calculate our local Kubota symbol on @xmath in the
non-split case.

### Chapter 8 Calculation of the Kubota symbol

We will outline the method of calculating this local Kubota symbol in
this chapter. Let @xmath be a global quadratic extension. For
consistency of notation, we will be using the same notation as in Part
II , i.e. we have @xmath a local field with @xmath a quadratic extension
of @xmath . Then @xmath and @xmath (with notation as in Section 1.4 ).
Also, note that in the split case we will use ( 3.10 ) to identify an
element of @xmath with an element of @xmath .

We have @xmath as the maximal ideal of @xmath . Let the local Kubota
symbol be denoted by @xmath and using the notation from the previous
chapter, let the subgroup of @xmath on which the quadratic 2-cocycle
splits be called @xmath . This implies that @xmath is a map

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , and for any @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

This implies that

  ------- -- -------- --
  (8.1)      @xmath   
  ------- -- -------- --

Thus, for any @xmath , since @xmath , we have

  ------- -- -------- --
  (8.2)      @xmath   
  ------- -- -------- --

As noted in Theorem 7.1 , @xmath depends on @xmath . Also, in the case
where @xmath is of even residue characteristic, we will assume that the
2-cocycle @xmath splits on the compact open subgroup @xmath for every
extension @xmath . We have already noted that in Section 7.2 that the
Kubota symbol on @xmath is not unique, but it is unique on @xmath . What
we do observe later is that the unipotent elements of @xmath are squares
of unipotent elements of @xmath , and it will be shown that the elements
of @xmath are squares of elements of @xmath . This implies that we
should use ( 8.2 ) on the elements of @xmath in order to find the unique
Kubota symbol on @xmath .

In addition, we have already stated in the Introduction that in the case
where @xmath , Theorem 6.3 does not completely describe @xmath . Even
so, since we are only interested in elements of @xmath contained in the
group @xmath , our formula for @xmath is sufficient to calculate the
local Kubota symbol in the split case.

Hence, let us define @xmath to be the subgroup of @xmath which we will
be choosing to calculate the unique Kubota symbol on, i.e.

  -- -------- --
     @xmath   
  -- -------- --

#### 8.1. The unipotent matrices of the compact open subgroup

We now calculate the Kubota symbol on the elements of @xmath and @xmath
.

###### Proposition 8.1.

Let @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

More generally, for any @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Since @xmath (see ( 2.3 )) where

  -- -------- --
     @xmath   
  -- -------- --

for ease of use, let @xmath and @xmath . We first note that

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , i.e. @xmath exists.

By ( 8.2 ),

  -- -------- --
     @xmath   
  -- -------- --

But by Theorem 6.3 , we have

  -- -------- --
     @xmath   
  -- -------- --

Now let @xmath . By ( 8.1 ),

  -- -------- --
     @xmath   
  -- -------- --

Hence using the above and Theorem 6.3 , we have

  -- -------- --
     @xmath   
  -- -------- --

We can similarly get @xmath . ∎

###### Proposition 8.2.

Let @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -- --
        
  -- -- --

###### Proof.

Again, since @xmath (see ( 2.3 )), for ease of use, let @xmath and
@xmath . We have

  -- -- --
        
  -- -- --

where @xmath , i.e. @xmath exists.

We have three cases to consider: @xmath , @xmath ; @xmath , @xmath ; and
@xmath , @xmath .

We first note that @xmath and @xmath . If @xmath and @xmath , then by (
8.2 ), we have

  -- -------- --
     @xmath   
  -- -------- --

By Theorem 6.3 , since

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

and using the properties of Hilbert symbols (Section 3.1 ), by ( 3.4 )
and ( 3.6 ),

  -- -------- --
     @xmath   
  -- -------- --

Hence by ( 3.3 ),

  ------- -- -------- --
  (8.3)      @xmath   
  ------- -- -------- --

If @xmath , @xmath , then by ( 8.2 ),

  -- -------- --
     @xmath   
  -- -------- --

Thus by Theorem 6.3 , we have

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Hence,

  -- -- --
        
  -- -- --

and therefore

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

By the properties of Hilbert symbols, we have by ( 3.4 ),

  -- -------- --
     @xmath   
  -- -------- --

By ( 3.6 ),

  -- -- --
        
  -- -- --

and by ( 3.1 ),

  -- -- --
        
  -- -- --

This implies that by ( 3.4 ),

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

If @xmath , @xmath , @xmath , @xmath , we have by ( 3.4 ), ( 3.6 ) and (
4.6 ) that

  -- -- --
        
  -- -- --

But since @xmath when @xmath , the above implies that

  ------- -- -------- --
  (8.4)      @xmath   
  ------- -- -------- --

for any @xmath , @xmath , @xmath and @xmath . We should also note that
if instead we have @xmath for some @xmath , and @xmath for some @xmath ,
with @xmath , @xmath remaining the same, we have by ( 8.4 ) and ( 4.6 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

But since by ( 3.7 ) and ( 3.6 ),

  -- -------- --
     @xmath   
  -- -------- --

this implies, for @xmath , that by ( 3.4 ),

  -- -- --
        
  -- -- --

Thus we have

  ------- -- -------- --
  (8.5)      @xmath   
  ------- -- -------- --

for any @xmath , @xmath , @xmath , @xmath .

Using ( 8.4 ) in our equation for @xmath , we have

  ------- -- -------- -------- --
  (8.6)      @xmath   @xmath   
             @xmath            
  ------- -- -------- -------- --

We now consider the case @xmath , @xmath . Since

  -- -- --
        
  -- -- --

and @xmath , @xmath , we have, by ( 8.1 ),

  -- -------- --
     @xmath   
  -- -------- --

Consider @xmath . By Theorem 6.3 ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

This implies that we have

  -- -------- --
     @xmath   
  -- -------- --

so that

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Similar to the calculation of @xmath , we can simplify the above using
the properties of Hilbert symbols. After simplifying, we get

  -- -------- --
     @xmath   
  -- -------- --

Inserting this result into our equation for @xmath along with ( 8.3 )
and ( 8.6 ), we have

  -- -------- --
     @xmath   
  -- -------- --

Thus simplifying the above using ( 3.6 ), we have

  ------- -- -------- --
  (8.7)      @xmath   
  ------- -- -------- --

Recall that we had put @xmath , @xmath . If @xmath , i.e. @xmath , by (
8.7 ) we have

  -- -- --
        
  -- -- --

But by ( 8.5 ) and the properties of Hilbert symbols, the above becomes

  -- -- --
        
  -- -- --

Let @xmath (see ( 2.3 )) such that @xmath . Also, let @xmath and

  -- -------- --
     @xmath   
  -- -------- --

This implies that

  -- -------- --
     @xmath   
  -- -------- --

and in fact, it can also be checked that

  -- -------- --
     @xmath   
  -- -------- --

We will now look at the function @xmath more closely. Let @xmath , where
@xmath , and @xmath . We have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

By using ( 3.1 ) and ( 3.7 ), this implies that

  -- -- --
        
  -- -- --

Let @xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

This implies that

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Thus by ( 3.4 ), ( 3.1 ) and ( 3.6 ), we have

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Hence, we have

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -- --
        
  -- -- --

Note that @xmath and hence @xmath is independent of @xmath ; therefore,
since

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

for @xmath , @xmath , we may combine the above result so that for @xmath
,

  -- -------- --
     @xmath   
  -- -------- --

We also note that when @xmath , the above formula for @xmath is still
applicable. Thus our result is proved. ∎

###### Remark 8.3.

Note that we also have

  -- -- --
        
  -- -- --

since @xmath is a central element of @xmath . We can use Theorem 6.3 and
the properties of Hilbert symbols to show that

  -- -------- --
     @xmath   
  -- -------- --

This implies that we will ultimately get the same result if we had
chosen to calculate @xmath by using ( 8.1 ), so that

  -- -- --
        
  -- -- --

#### 8.2. The elements of the torus

In this section, we want to find the local Kubota symbol on the elements
of @xmath , which we will denote by @xmath .

We have two cases to consider, depending on whether there are matrices
in @xmath whose @xmath -entry is a unit.

We know that when @xmath is odd and ramified in @xmath , or if @xmath is
even in @xmath , then the @xmath -entry is never a unit in @xmath . This
implies that the Bruhat decomposition (see Section 1.2 ) of an element
of @xmath when the @xmath -entry is non-zero in these cases will be a
product of elements which are not in @xmath (see ( 1.3 )).

When @xmath is odd and either unramified or split in @xmath , this does
not pose a problem, and we can use the Bruhat decomposition in these
cases. We also note that in @xmath , we have from Section 2.1 that for
any @xmath ,

  ------- -- -------- --
  (8.8)      @xmath   
  ------- -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

As @xmath is odd and either unramified or split in @xmath , this implies
that @xmath , @xmath , hence there exists @xmath such that @xmath where
@xmath , since @xmath . Therefore @xmath and @xmath .

###### Proposition 8.4.

If @xmath is odd and either unramified or split in @xmath , then we have
@xmath , where @xmath , with

  -- -------- --
     @xmath   
  -- -------- --

Also, if @xmath such that @xmath , then @xmath and

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

For any @xmath , we have, by ( 1.2 ) that

  -- -------- --
     @xmath   
  -- -------- --

This implies that if @xmath , @xmath and @xmath , then we have @xmath
and by Proposition 8.1 ,

  -- -- --
        
  -- -- --

Since @xmath , @xmath for @xmath , by Proposition 8.2 ,

  -- -------- --
     @xmath   
  -- -------- --

Also, for @xmath with @xmath , we have the elements @xmath , @xmath ,
@xmath , hence

  -- -------- --
     @xmath   
  -- -------- --

So by Proposition 8.2 , we have

  -- -------- -------- --
     @xmath            
              @xmath   
  -- -------- -------- --

By ( 3.4 ), ( 3.7 ) and ( 3.6 ),

  -- -------- --
     @xmath   
  -- -------- --

and thus by ( 3.2 ),

  -- -------- --
     @xmath   
  -- -------- --

###### Proposition 8.5.

If @xmath is odd and either unramified or split in @xmath , then for
@xmath such that @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We first assume that for @xmath , @xmath , we have @xmath .

If @xmath , then this implies that @xmath , hence we have, by ( 8.8 )
and ( 8.1 ), that

  -- -------- --
     @xmath   
  -- -------- --

By Theorem 6.3 , we have

  -- -------- --
     @xmath   
  -- -------- --

hence by ( 3.2 ), we have

  -- -------- --
     @xmath   
  -- -------- --

Thus, by the above and Proposition 8.4 , we have

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , then @xmath . By ( 8.8 ) and ( 8.1 ),

  -- -- --
        
  -- -- --

By Theorem 6.3 , we have

  -- -------- --
              
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Simplifying the above using the properties of Hilbert symbols ( 3.4 ), (
3.2 ) and ( 3.6 ), we get

  -- -------- --
     @xmath   
  -- -------- --

Thus by the above and Proposition 8.4 ,

  -- -------- --
     @xmath   
  -- -------- --

If @xmath such that @xmath , @xmath and @xmath , then @xmath when @xmath
. So assume that @xmath . By ( 8.8 ) and ( 8.1 ),

  -- -- --
        
  -- -- --

Then by Theorem 6.3 ,

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Simplifying the above using the properties of Hilbert symbols ( 3.6 )
and ( 3.4 ), we get

  -- -------- --
     @xmath   
  -- -------- --

Hence, by the above and Proposition 8.4 ,

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , then @xmath since @xmath . But we already know that

  -- -------- --
     @xmath   
  -- -------- --

Since

  -- -------- --
     @xmath   
  -- -------- --

by ( 8.1 ),

  -- -------- --
     @xmath   
  -- -------- --

By Theorem 6.3 ,

  -- -- -------- --
        @xmath   
        @xmath   
        @xmath   
  -- -- -------- --

By the properties of Hilbert symbols ( 3.1 ) and ( 3.2 ), we have

  -- -------- --
     @xmath   
  -- -------- --

But the characteristic of the residue field @xmath is not @xmath . Thus
we may use Proposition 3.1 , as @xmath , @xmath , so that we have

  -- -------- --
     @xmath   
  -- -------- --

Applying the above to our equation, we get

  -- -------- --
     @xmath   
  -- -------- --

This completes our proof. ∎

###### Remark 8.6.

We should note that if @xmath is odd and either unramified or split in
@xmath , then from Propositions 8.4 and 8.5 , we have that @xmath is
generated by elements of @xmath and @xmath .

We now look at the cases where either @xmath is odd and ramified in
@xmath , or @xmath is even in @xmath .

###### Proposition 8.7.

If @xmath is odd and ramified in @xmath , or @xmath is even in @xmath ,
then if @xmath , there exists @xmath such that @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We first consider the case where @xmath is odd and ramified in @xmath .
In this case, @xmath . Thus elements of @xmath may be described by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath . We want to show that for every @xmath , @xmath is a
square of an element in @xmath . We will use Hensel’s Lemma (Theorem 3.5
). We have

  -- -------- --
     @xmath   
  -- -------- --

and hence the formal derivative @xmath is

  -- -------- --
     @xmath   
  -- -------- --

Let the prime above @xmath in @xmath be denoted by @xmath . Then by
Lemma 1.2 ,

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

This implies by Hensel’s Lemma that since @xmath , there exists a
solution for @xmath , i.e. there exists @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

We have by the binomial theorem that for any @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

thus by Hensel’s Lemma, this expansion converges. Hence, there is a
canonical choice for @xmath , @xmath for every @xmath , @xmath such that
@xmath , and hence

  -- -------- --
     @xmath   
  -- -------- --

where @xmath .

As for the case where @xmath is even, @xmath , @xmath and the elements
of @xmath are of the form

  -- -------- --
     @xmath   
  -- -------- --

where @xmath . Similar to the case where @xmath is odd and ramified in
@xmath , we will use Hensel’s Lemma to show that every element in @xmath
is a square of an element in @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

with formal derivative

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be a prime ideal in @xmath such that @xmath . By Lemma 1.2 ,

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

thus we have @xmath . (Note that for the split case we will use the
isomorphism ( 3.10 ).) This implies by Hensel’s Lemma that there exists
a solution for @xmath , i.e. there exists @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

By the binomial theorem, for any @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

so by Hensel’s Lemma, the expansion converges. So there is a canonical
choice for @xmath , @xmath , for every @xmath , @xmath , such that
@xmath and

  -- -------- --
     @xmath   
  -- -------- --

So this verifies that @xmath .

Now that we have established that every element of @xmath is a square of
an element in @xmath , let us now calculate the local Kubota symbol.
Whether @xmath is odd and ramified in @xmath , or even, let @xmath and
@xmath such that @xmath . Then by ( 8.2 ),

  -- -------- --
     @xmath   
  -- -------- --

There are only two cases for @xmath to consider: either @xmath , or
@xmath , @xmath , @xmath . In the first case, we have

  -- -------- --
     @xmath   
  -- -------- --

by Theorem 6.3 . Simplifying the above using the Hilbert symbol property
( 3.2 ),

  -- -------- --
     @xmath   
  -- -------- --

This implies, in the case where @xmath is odd and ramified in @xmath ,
that @xmath , where @xmath . By Hensel’s Lemma, @xmath has a solution
with approximate root @xmath . Thus @xmath is a square in @xmath , hence
by the property of Hilbert symbols ( 3.6 ),

  -- -------- --
     @xmath   
  -- -------- --

In the case where @xmath is even, if @xmath , then @xmath for @xmath .
Thus we have

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , then @xmath is a square in @xmath (we showed this is true by
Hensel’s Lemma earlier in the proof ) and hence by ( 3.6 ),

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , we can show that @xmath as well. In Section 3.1 , we
established that

  -- -------- --
     @xmath   
  -- -------- --

By ( 3.3 ),

  -- -------- --
     @xmath   
  -- -------- --

Since we have a solution @xmath for @xmath , this implies that @xmath
for all @xmath . Therefore for all elements of the form @xmath , @xmath
, @xmath even,

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , then @xmath with @xmath , @xmath and by Theorem 6.3 ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Simplifying the above using the properties of Hilbert symbols ( 3.1 ) –
( 3.4 ),

  -- -------- --
     @xmath   
  -- -------- --

When @xmath is odd and ramified in @xmath , @xmath , for @xmath , @xmath
with @xmath . Thus @xmath . By Proposition 3.1 , since @xmath , @xmath ,
@xmath , @xmath , we have @xmath , @xmath . Therefore we have @xmath .

When @xmath is even, we first consider the case where @xmath . Then
@xmath , for @xmath , @xmath with @xmath . This implies that @xmath . We
have already shown that @xmath in the case where @xmath . As for @xmath
, we see that @xmath , i.e. @xmath is a square in @xmath . Hence by (
3.6 ), @xmath . Therefore @xmath .

If instead @xmath when @xmath is even (i.e. @xmath is unramified in
@xmath ), then we have

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , @xmath with @xmath , with @xmath , and @xmath . This
implies that when @xmath , i.e. @xmath , we are in the same case as when
@xmath , since @xmath , which implies that @xmath by our previous
result, and @xmath , so @xmath . Hence when @xmath , @xmath .

We can use the properties of Hilbert symbols ( 3.3 ) and ( 3.4 ) to show
that

  -- -------- --
     @xmath   
  -- -------- --

The above formulation makes it easier to calculate the Kubota symbol in
the case where @xmath . We have @xmath , hence @xmath . Also, @xmath and
@xmath . So let @xmath and @xmath , where @xmath , @xmath . Then by (
3.3 ),

  -- -------- --
     @xmath   
  -- -------- --

But

  -- -------- --
     @xmath   
  -- -------- --

i.e. @xmath is a square in @xmath , and hence by ( 3.6 ), @xmath . Thus
we have shown that

  -- -------- --
     @xmath   
  -- -------- --

in all cases. ∎

#### 8.3. Other elements of the compact open subgroup

We are now ready to show how to find the local Kubota symbol on any
element of @xmath .

By ( 1.3 ), it is clear that the Bruhat decomposition of a matrix of
@xmath with a non-zero @xmath -entry depends only on the first column
and last row of the matrix. The following proposition establishes an
important property of this type of matrix when @xmath is odd and
unramified in @xmath :

###### Proposition 8.8.

Let @xmath is odd and unramified (but not split) in @xmath . Also, let
@xmath , @xmath , @xmath , @xmath , @xmath , such that

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

Then

  -- -------- --
     @xmath   
  -- -------- --

and either @xmath or @xmath , or possibly both.

###### Proof.

The first part is easily established by ( 1.3 ). As for the second part,
consider the Hermitian form @xmath defined by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , @xmath . This implies that for all @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

If

  -- -------- --
     @xmath   
  -- -------- --

then

  -- -------- --
     @xmath   
  -- -------- --

Since

  -- -------- --
     @xmath   
  -- -------- --

if @xmath , then @xmath . Similarly, since

  -- -------- --
     @xmath   
  -- -------- --

if @xmath , then @xmath , i.e. @xmath .

For any @xmath , @xmath . As

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

if @xmath and @xmath , then @xmath , which is a contradiction. Hence
either @xmath or @xmath is a unit in @xmath , or possibly both. ∎

In the split case, i.e. when @xmath is split in @xmath , we have to
consider the fact that sometimes, none of the entries in the bottom row
of an element in @xmath is a unit. This does not occur in the other
cases. The proposition below shows the existence of a transformation to
a matrix of this form so that the resulting matrix has a unit in the
@xmath -entry.

###### Proposition 8.9.

Let @xmath be a split prime in @xmath . If

  -- -------- --
     @xmath   
  -- -------- --

with neither @xmath nor @xmath a unit in @xmath , then there is always
an element @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

with @xmath .

###### Proof.

Let @xmath , where @xmath , @xmath . We first note that @xmath , @xmath
and @xmath are coprime to each other, by the same principle as in the
proof of Proposition 8.8 .

If @xmath , then without loss of generality, we may assume that @xmath ,
which in turn implies that @xmath . Using the Hermitian form from the
proof of Proposition 8.8 , since

  -- -------- --
     @xmath   
  -- -------- --

and @xmath , we have that @xmath , i.e. @xmath .

Now let @xmath , @xmath , with @xmath , @xmath . Assume that @xmath .
Then @xmath , and this implies that @xmath . But @xmath , hence @xmath ,
i.e. @xmath . Therefore, since @xmath , we have @xmath , and hence
@xmath (since @xmath ). But this means that @xmath since @xmath is a
unit mod @xmath and mod @xmath , which contradicts our assumption that
@xmath is not a unit in @xmath . Hence if @xmath and @xmath , then
@xmath .

Since @xmath is a unit mod @xmath and @xmath is a unit mod @xmath , we
can always choose a @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

with @xmath a unit mod @xmath , i.e. @xmath . So now we have @xmath ,
hence @xmath . So @xmath , i.e. @xmath . This implies that @xmath , i.e.
@xmath is a unit mod @xmath . So we can choose @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

with @xmath a unit mod @xmath , i.e. @xmath .

Therefore we can always choose some @xmath and

  -- -------- --
     @xmath   
  -- -------- --

with @xmath . ∎

With the above two propositions, we can now show how to obtain the local
Kubota symbol on any element of @xmath .

###### Theorem 8.10.

Let

  -- -------- --
     @xmath   
  -- -------- --

Then

  -- -------- --
     @xmath   
  -- -------- --

If @xmath is split, then when both @xmath and @xmath are not units in
@xmath , we can always choose some @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

with @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

and we may apply the above to @xmath to calculate our result.

###### Proof.

Consider the case where @xmath . By ( 1.4 ),

  -- -------- --
     @xmath   
  -- -------- --

hence by Proposition 8.1 ,

  -- -------- --
     @xmath   
  -- -------- --

As noted at the start of Section 8.2 , we will only have @xmath when
@xmath is odd and either unramified or split in @xmath . In this case,
@xmath , @xmath , @xmath . Therefore, since by ( 1.3 ),

  -- -------- --
     @xmath   
  -- -------- --

by Proposition 8.1 ,

  -- -------- --
     @xmath   
  -- -------- --

Hence by ( 8.1 ),

  -- -------- --
     @xmath   
  -- -------- --

So by Proposition 8.4 and Theorem 6.3 ,

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , @xmath , then @xmath in most cases by Proposition 8.8 (we
deal with the case @xmath , @xmath later in the proof). Also, using the
Hermitian form established in the proof of Proposition 8.8 , we have
that

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

We now have a few cases to consider. We will use the notation in Section
1.3 . If @xmath is odd and unramified in @xmath , then since @xmath ,
this implies that @xmath and @xmath . Thus, we have @xmath and

  -- -------- --
     @xmath   
  -- -------- --

If @xmath is odd and ramified in @xmath , we already have that @xmath in
Proposition 1.1 , and

  -- -------- --
     @xmath   
  -- -------- --

which implies that there exists an Iwahori factorisation of @xmath ,
with

  -- -------- --
     @xmath   
  -- -------- --

If instead @xmath is even, we have @xmath in Proposition 1.1 and

  -- -------- --
     @xmath   
  -- -------- --

So we have an Iwahori factorisation for all elements of @xmath with
@xmath , @xmath . Hence, we have

  -- -------- --
     @xmath   
  -- -------- --

with @xmath , @xmath , @xmath . This implies that by Proposition 8.1 ,

  -- -------- --
     @xmath   
  -- -------- --

and by ( 8.1 ) and Proposition 6.1 ,

  -- -------- --
     @xmath   
  -- -------- --

We have one last case to consider. We have already noted that there will
be elements in the split case where all the bottom row entries are
non-units. By Proposition 8.9 , we can apply a transformation by
multiplying the matrix on the right by a unipotent upper triangular
matrix @xmath , so that

  -- -------- --
     @xmath   
  -- -------- --

with @xmath . But by Proposition 8.1 ,

  -- -------- --
     @xmath   
  -- -------- --

Hence we can use the calculation on @xmath to get @xmath .

This concludes our proof. ∎

## Part IV The half-integral weight multiplier system

### Chapter 9 The global Kubota symbol

As previously stated in the Introduction, in order to construct the
half-integral weight multiplier system, we need to calculate the global
Kubota symbol @xmath . In Section 3 of [ 10 ] , the global Kubota symbol
on a chosen arithmetic subgroup of @xmath for some field @xmath was
given in terms of quadratic Legendre symbols. We want to write down a
similar formula in terms of quadratic Legendre symbols for our
arithmetic subgroup.

Let @xmath be an arbitrary number field, and let @xmath run through all
the primes of @xmath . Let @xmath be a quadratic extension of @xmath ,
so that the matrix entries of an element in @xmath lie in @xmath . On
the arithmetic subgroup @xmath , we have

  ------- -- -------- --
  (9.1)      @xmath   
  ------- -- -------- --

for @xmath .

We can prove that the above product converges – it is just a matter of
using the product formula (Theorem 3.2 ). Let @xmath , where @xmath when
@xmath and @xmath , as described in Chapter 6 . We know that for @xmath
, @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

where the product is over all primes @xmath of @xmath , with only
finitely many non-trivial terms. We can extend the definition of @xmath
in some arbitrary way to the whole of @xmath . Define @xmath to be the
set of elements @xmath such that the product over all finite @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

converges. We make the following claim:

###### Claim 9.1.

@xmath .

###### Proof.

For any @xmath , @xmath , we have @xmath , @xmath for almost all @xmath
. Hence for almost all @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

Hence if @xmath , @xmath , then @xmath .

Similarly, we already have @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

for almost all @xmath . This implies that if @xmath , then @xmath .

Lastly, by ( 8.2 ),

  -- -------- --
     @xmath   
  -- -------- --

for almost all primes @xmath . This shows that @xmath for all @xmath ,
therefore H is a subgroup of @xmath containing all the squares of @xmath
. However, @xmath is generated by unipotent elements, and these are all
squares, so we have @xmath . ∎

Unfortunately, with our formulae for the local Kubota symbol @xmath (see
Theorem 8.10 ), it is difficult to find a “nice” formula for the global
Kubota symbol for all elements of @xmath . What we can do is find a
formula on the Borel subgroup of @xmath (i.e. the group of upper
triangular matrices of @xmath ). Recall that for elements @xmath with
@xmath coprime to @xmath , the quadratic Legendre symbol is defined by

  -- -------- --
     @xmath   
  -- -------- --

We have the following proposition:

###### Proposition 9.2.

Let

  -- -------- --
     @xmath   
  -- -------- --

Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Using ( 9.1 ), we have by Theorem 8.10 that

  -- -------- --
     @xmath   
  -- -------- --

But by Propositions 8.5 and 8.7 , if @xmath , then @xmath for all @xmath
. In this case, we have

  -- -------- --
     @xmath   
  -- -------- --

In the other case, @xmath , i.e. @xmath , where @xmath , @xmath and
@xmath . Then if @xmath is odd, and either unramified or split,
Proposition 8.5 states that if @xmath ,

  -- -- --
        
  -- -- --

Otherwise, @xmath by Propositions 8.5 and 8.7 . Hence by ( 9.1 ), we
have

  -- -------- --
     @xmath   
  -- -------- --

where the product is over all @xmath which are unramified or split.
Hence by the product formula (Theorem 3.2 ) and ( 3.1 ), we get

  -- -------- --
     @xmath   
  -- -------- --

There are now a few cases to consider for each @xmath :

-   If @xmath is even, since @xmath , this implies that @xmath is a
    square in @xmath by Hensel’s Lemma (Theorem 3.5 ), hence @xmath is
    trivial by ( 3.6 ).

-   Suppose @xmath is finite and odd. Then the Hilbert symbol is the
    tame symbol (Proposition 3.1 ). In this case if @xmath , then we
    also have @xmath .

Thus we are left with the finite primes @xmath which divide @xmath and
the infinite primes. Our equation becomes

  -- -------- --
     @xmath   
  -- -------- --

We can now use the quadratic Legendre symbol formula on the above, hence

  -- -------- --
     @xmath   
  -- -------- --

Thus our result is proved. ∎

### Chapter 10 A section for the 2-cocycle on @xmath

Let @xmath , @xmath for some positive real number @xmath . Thus, @xmath
. We shall determine a section for the 2-cocycle on @xmath as described
in the Introduction. Recall that we have a Hermitian form @xmath on
@xmath defined by

  -- -------- --
     @xmath   
  -- -------- --

and we let

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Here @xmath means the image of a vector @xmath in projective space. We
want our modular form to be defined on

  -- -------- --
     @xmath   
  -- -------- --

We will use the abbreviation @xmath for an element of @xmath . Let

  -- -------- --
     @xmath   
  -- -------- --

and let

  -- -------- --
     @xmath   
  -- -------- --

This implies that

  -------- -- -------- --
  (10.1)      @xmath   
  -------- -- -------- --

Note that

  -- -------- --
     @xmath   
  -- -------- --

Hence, we have

  -- -------- --
     @xmath   
  -- -------- --

and in particular @xmath . So we can define an action of @xmath on
@xmath by

  -- -------- --
     @xmath   
  -- -------- --

(Note that @xmath is a scalar.)

We will write @xmath for the connected double cover of @xmath . Note
that the fundamental group @xmath is isomorphic to @xmath , so there is
a unique connected @xmath -fold cover for any @xmath .

One way of constructing the group @xmath is as follows: the elements of
@xmath are pairs

  -- -------- --
     @xmath   
  -- -------- --

where @xmath and @xmath denotes a continuous function on @xmath
satisfying

  -- -------- --
     @xmath   
  -- -------- --

For two elements @xmath , @xmath , we define their product by

  -- -------- --
     @xmath   
  -- -------- --

(Later, we will show that @xmath truly is the unique connected double
cover of @xmath .) Recall that we also have another group which we have
been referring to as @xmath , and which is defined by the 2-cocycle
@xmath . We will now relate these two constructions of @xmath .

Suppose for each @xmath we have chosen a function @xmath with @xmath
(where @xmath , @xmath are as in the notation above). Then the map

  -- -------- --
     @xmath   
  -- -------- --

defines a section of @xmath to @xmath . Corresponding to this section,
we have a 2-cocycle on @xmath written as

  -- -- --
        
  -- -- --

for @xmath , @xmath , i.e.

  -- -------- --
     @xmath   
  -- -------- --

Let

  -- -------- --
     @xmath   
  -- -------- --

where we assume that the 2-cocycle @xmath has the same formula as that
in Theorem 6.3 with @xmath . Since @xmath , @xmath and they both
represent the unique non-trivial double cover, this implies that @xmath
is a 2-coboundary. Our choice of @xmath will be made carefully so that
@xmath , i.e. @xmath .

###### Remark 10.1.

There is only one choice of section with this property: any two would
differ by a continuous homomorphism from @xmath ; however @xmath is
connected.

We will first determine @xmath for @xmath . For any @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

Choose

  -- -------- --
     @xmath   
  -- -------- --

where @xmath . (Note that @xmath is a constant function.) We may check
for any @xmath , @xmath that

  -- -------- --
     @xmath   
  -- -------- --

using Theorem 6.3 . Since @xmath is connected, this is the correct
choice of @xmath on @xmath .

###### Claim 10.2.

@xmath is the unique connected double cover of @xmath .

###### Proof.

Suppose that @xmath is the trivial double cover. Then we have

  -- -------- --
     @xmath   
  -- -------- --

for some 1-cochain @xmath . By our choice for @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

Also,

  -- -------- --
     @xmath   
  -- -------- --

This implies that @xmath . On the other hand,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

which implies that @xmath . This is a contradiction, thus @xmath is the
unique connected double cover of @xmath . ∎

Without loss in generality, let @xmath , be the set of Weyl group
representatives of @xmath . For ease of notation, let

  -- -------- --
     @xmath   
  -- -------- --

Every element in @xmath can be chosen to have the form @xmath or @xmath
for @xmath . Let @xmath be the restriction of @xmath to elements of the
form @xmath where @xmath , @xmath . Note that there are two sections
@xmath whose 2-cocycle is @xmath . This is because there is a
non-trivial homomorphism

  -- -------- --
     @xmath   
  -- -------- --

For the element @xmath , we have @xmath , and @xmath . This implies that
@xmath is in the lower half-plane. We choose @xmath such that @xmath .
We will later show that our choice for @xmath is correct.

For @xmath , @xmath can be determined from @xmath as follows. We have

  -- -------- --
     @xmath   
  -- -------- --

Since we want @xmath , and @xmath for any @xmath by Theorem 6.3 , we
find that

  -- -------- --
     @xmath   
  -- -------- --

(It may also be checked that @xmath .)

Now recall the Bruhat decomposition (see Section 1.2 )

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath is trivial on @xmath and @xmath is connected,

  -- -------- --
     @xmath   
  -- -------- --

for any @xmath (i.e. @xmath is a constant function). Similarly, since
@xmath for any @xmath , and we have

  -- -------- --
     @xmath   
  -- -------- --

with @xmath , this implies that

  -- -------- --
     @xmath   
  -- -------- --

Also, we have

  -- -------- --
     @xmath   
  -- -------- --

and since @xmath and @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Hence, once we establish the choice for @xmath , we can determine @xmath
for any @xmath .

###### Claim 10.3.

Our choice for @xmath is the correct choice.

###### Proof.

Let

  -- -------- --
     @xmath   
  -- -------- --

So we have @xmath . By ( 1.3 ) (using @xmath ),

  -- -------- --
     @xmath   
  -- -------- --

We want to show that with our choice for @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Since by Theorem 6.3 , @xmath , the above equation can be simplified to

  -- -------- --
     @xmath   
  -- -------- --

Hence, if our choice for @xmath is wrong, this would imply that the
left-hand side would not equal the right-hand side.

We evaluate both sides at the point

  -- -------- --
     @xmath   
  -- -------- --

For the left-hand side, we have

  -- -- --
        
  -- -- --

with our choice for @xmath . As for the right-hand side,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Since both sides concur, our choice for @xmath is correct. ∎

We have thus proved the following, as first mentioned in the
Introduction:

###### Theorem 10.4.

Let @xmath . For each @xmath as defined in ( 10.1 ), choose a function
@xmath such that @xmath as follows:

-   @xmath , where @xmath ;

-   @xmath ;

-   @xmath ;

where @xmath , @xmath , @xmath and @xmath . Then we have a half-integral
weight multiplier system

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , the congruence subgroup on which the global Kubota symbol
@xmath is defined on.