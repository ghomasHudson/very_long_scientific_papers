##### Contents

-    1 Introduction
    -    1.1 Background
    -    1.2 Overview
    -    1.3 Main results
-    2 Higher-rank graphs
    -    2.1 Basic category theory
    -    2.2 Definitions and notation
    -    2.3 Graph morphisms
-    3 Twisted relative Cuntz-Krieger algebras
    -    3.1 Toeplitz-Cuntz-Krieger @xmath -families
    -    3.2 The twisted Toeplitz algebra
    -    3.3 Relative Cuntz-Krieger @xmath -families
    -    3.4 Gap projections and boundary paths
-    4 Analysis of the core
    -    4.1 Group actions and faithful conditional expectations
    -    4.2 The gauge action
    -    4.3 Orthogonalising range projections
    -    4.4 Matrix units for the core
    -    4.5 Isomorphisms of the core
    -    4.6 The gauge-invariant uniqueness theorem
-    5 Gauge-invariant ideals
    -    5.1 From ideals to hereditary sets
    -    5.2 Quotients of twisted relative Cuntz-Krieger algebras
    -    5.3 Gauge-invariant ideals of the twisted relative
        Cuntz-Krieger algebras

## Chapter 1 Introduction

### 1.1 Background

A directed graph @xmath consists of a set @xmath of vertices, a set
@xmath of edges and maps @xmath . We visualise the vertices as dots or
points and the edges @xmath as arrows pointing from @xmath , called its
source, to @xmath , called its range. A @xmath -algebra is a closed
subspace of the bounded linear operators on a Hilbert space that is
closed under multiplication and adjoints. We construct a @xmath -algebra
in the set of bounded linear operators on a Hilbert space @xmath from
@xmath as follows. To vertices @xmath we associate projections @xmath of
@xmath onto mutually orthogonal subspaces @xmath . To every edge @xmath
we associate a partial isometry @xmath that takes @xmath isometrically
into @xmath and vanishes on @xmath . We require that whenever @xmath is
nonempty and finite, the subspaces @xmath with @xmath are mutually
orthogonal and span @xmath . Such a collection @xmath is called a
Cuntz-Krieger @xmath -family. By taking the closure of all linear
combinations of all finite products of @xmath and @xmath and their
adjoints, we generate a @xmath -subalgebra of the bounded linear
operators on @xmath .

Every Cuntz-Krieger @xmath -family generates a @xmath -algebra.
Different Cuntz-Krieger @xmath -families can generate nonisomorphic
@xmath -algebras, but there is a unique universal @xmath -algebra @xmath
generated by a universal Cuntz-Krieger @xmath -family @xmath . Loosely
speaking, by “universal” we mean that @xmath is biggest @xmath -algebra
generated by a Cuntz-Krieger @xmath -family: @xmath contains all the
complexities of any other @xmath -algebra generated by a Cuntz-Krieger
@xmath -family. One can use the universal property to show that there is
a group action @xmath of the unit circle @xmath on @xmath such that
@xmath and @xmath for each @xmath , @xmath and @xmath . This action is
called the gauge action.

Kumjian, Pask, Raeburn and Renault introduce Cuntz-Krieger algebras of
directed graphs, also known as graph algebras, in [ 9 ] following on
from the seminal work of Cuntz and Krieger in [ 3 ] and Enomoto and
Watatani in [ 5 ] . The sustained interest in graph algebras is
motivated by the elegant relationships that exist between the
connectivity and loop structure of the graph and the structure of the
resulting graph algebra. For example, the ideals of @xmath that are
invariant for the gauge action @xmath can be described in terms of
subsets of @xmath : Bates, Hong, Raeburn and Szymański in [ 1 ] describe
sets @xmath of vertices, which they call saturated hereditary sets. They
show that for each such @xmath , the elements @xmath generate a
gauge-invariant ideal @xmath of @xmath . Using a version of an Huef and
Raeburn’s gauge-invariant uniqueness theorem ( [ 6 ] , Theorem 2.3),
they show that @xmath is canonically isomorphic to the Cuntz-Krieger
algebra of what they call the quotient graph @xmath . They then show
that the gauge-invariant ideals of the Cuntz-Krieger algebra are indexed
by pairs @xmath , where @xmath is a saturated hereditary set and @xmath
is a collection of so-called breaking vertices.

Robertson and Steger [ 17 ] introduce a class of higher-rank
Cuntz-Krieger algebras arising from actions of @xmath on buildings. In [
7 ] , Kumjian and Pask introduce higher-rank graphs and their
Cuntz-Krieger algebra as a common generalisation of both Robertson and
Steger’s higher-rank Cuntz-Krieger algebras and graph algebras. Kumjian
and Pask focus on Cuntz-Krieger algebras arising from row-finite
higher-rank graphs with no sources: these are the higher-rank analogue
of graphs in which a nonzero, finite number of edges enters every
vertex. Raeburn, Sims and Yeend [ 16 ] extend the analysis of Kumjian
and Pask by associating Cuntz-Krieger algebras to finitely aligned
higher-rank graphs, a more general class than row-finite higher-rank
graphs with no sources.

In [ 18 ] , Sims defines a class of relative Cuntz-Krieger algebras ( [
18 ] , Definition 3.2) associated to a finitely aligned higher-rank
graph, which includes the usual Cuntz-Krieger algebras as a special
case. As in [ 1 ] , Sims identifies pairs of saturated hereditary sets
and satiated ( [ 18 ] , Definition 4.1) sets, and associates to each
such pair a gauge-invariant ideal. Due the complex combinatorial nature
of higher-rank graphs, it is no longer clear how to realise the quotient
of the Cuntz-Krieger algebra as the Cuntz-Krieger algebra of a quotient
graph. Instead, Sims shows that the quotient of the Cuntz-Krieger
algebra by a gauge-invariant ideal associated to a saturated hereditary
and satiated pair is canonically isomorphic to a relative Cuntz-Krieger
algebra of a subgraph ( [ 19 ] , Corollary 5.2). Using this observation,
Sims generalises the results of [ 1 ] for graph algebras to
Cuntz-Krieger algebras of finitely aligned higher-rank graphs; that is,
he classifies all the gauge-invariant ideals in the Cuntz-Krieger
algebra of a higher-rank graph ( [ 18 ] , Theorem 5.5).

In [ 8 ] and [ 10 ] , Kumjian, Pask and Sims introduce a cohomology
theory for higher-rank graphs. They show how to twist the defining
relations for a higher-rank graph @xmath -algebra by a circle valued
2-cocycle ( [ 10 ] , Definition 5.2). They use this to define the
twisted Cuntz-Krieger algebra @xmath ( [ 10 ] , Proposition 5.3)
associated to a higher-rank graph and a @xmath -valued 2-cocycle @xmath
. The class of twisted Cuntz-Krieger algebras contains many interesting
examples, including all of the noncommutative tori ( [ 8 ] , Example
7.9) and the quantum spheres of [ 2 ] . Both [ 8 ] and [ 10 ] , consider
row-finite locally convex ( [ 15 ] , Definition 3.9) higher-rank graphs,
rather than arbitrary finitely aligned higher-rank graphs. Kumjian, Pask
and Sims produce a gauge-invariant uniqueness theorem ( [ 10 ] ,
Corollary 7.7) using groupoid methods, and provide a criterion for
simplicity ( [ 10 ] , Corollary 8.2), but they do not address the
broader question of ideal structure.

In this thesis we avoid groupoid methods in preference for a more
elementary and direct analysis, similar to that of [ 16 ] . This direct
approach leads to sharper and more general results with cleaner
arguments. Theorem 5.5 in [ 19 ] gives a complete description of
gauge-invariant structure of the Cuntz-Krieger algebra associated to a
finitely aligned higher-rank graph. The aim of this thesis is to extend
this result to all twisted relative Cuntz-Krieger algebras: this is a
new result even for the untwisted case. This aim is achieved with
Theorem 5.3.2 .

### 1.2 Overview

This section gives a detailed account of the material contained in this
thesis. We highlight definitions and results contained in each chapter,
discuss their importance and connect them with the previous work of
others.

In Chapter 2 we recall the definition of a @xmath -graph (higher-rank
graph) and develop the standard notation to deal with them. Each path
@xmath in a @xmath -graph @xmath has a source @xmath and a range @xmath
in @xmath , the set of vertices. Unlike directed graphs, a @xmath -graph
@xmath not only consists of edges and vertices but all possible paths in
the graph. There is a natural partial multiplication on @xmath given by
concatenation; given paths @xmath in @xmath such that @xmath , @xmath is
another path in @xmath . Each path @xmath has degree, or shape, @xmath ,
where @xmath is the @xmath in @xmath -graph; degree is a
higher-dimensional analogue of length. Each @xmath -graph satisfies the
factorisation property: if @xmath has degree @xmath , then there exist
unique paths @xmath and @xmath in @xmath such that @xmath , @xmath and
@xmath . If @xmath is a directed graph, then the set @xmath of all paths
in @xmath is a @xmath -graph where the degree function @xmath measures
the length of a path. Note that the factorisation property for @xmath
-graphs is automatic. So @xmath -graphs generalise the notion of a
directed graph.

Given a finitely aligned @xmath -graph @xmath , each finite collection
@xmath of paths with a common range determines a “gap projection” @xmath
in the twisted Toeplitz algebra (see Section 3.4 ) of @xmath . Each
twisted relative Cuntz-Krieger algebra of @xmath is a quotient of the
twisted Toeplitz algebra by an ideal generated by such gap projections;
so in each twisted relative Cuntz-Krieger algebra some, but typically
not all, of the gap projections are zero. In Chapter 3 we construct a
spatial representation of the twisted Toeplitz algebra, and use it to
characterise exactly which gap projections are nonzero in any given
relative Cuntz-Krieger algebra.

In Section 3.1 , for a finitely aligned @xmath -graph @xmath , we define
a @xmath -valued 2-cocycle and the associated twisted Toeplitz algebra.
A 2-cocycle is a map

  -- -------- --
     @xmath   
  -- -------- --

that satisfies:

1.  @xmath whenever @xmath and @xmath ; and

2.  @xmath for all @xmath .

The first relation is called the 2-cocycle identity. We write @xmath for
the set of all @xmath -valued 2-cocycles. The inspiration for this
definition comes from the work of Kumjian, Pask and Sims in [ 8 ] and [
10 ] in developing a cohomology theory for @xmath -graphs and their
definition of a Cuntz-Krieger @xmath -family ( [ 10 ] , Definition 5.2),
where @xmath is a 2-cocycle in the cohomology theory. Kumjian, Pask and
Sims show there is a universal @xmath -algebra @xmath , called the
twisted Cuntz-Krieger algebra, generated by a Cuntz-Krieger @xmath
-family @xmath . This @xmath -algebra is said to be ‘twisted’ due to the
2-cocycle appearing in the relation

  -- -------- -- -------
     @xmath      (1.1)
  -- -------- -- -------

whenever @xmath . The 2-cocycle identity guarantees that the
multiplication in ( 1.1 ) is associative.

We wish to extend the analysis of Kumjian, Pask and Sims to finitely
aligned @xmath -graphs. A Toeplitz-Cuntz-Krieger @xmath -family is a
collection @xmath of partial isometries in a @xmath -algebra satisfying:

1.  @xmath is a set of mutually orthogonal projections;

2.  @xmath whenever @xmath ;

3.  @xmath for all @xmath ; and

4.  @xmath .

In Definition 2.5 of [ 16 ] , Raeburn, Sims and Yeend define a
Cuntz-Krieger @xmath -family for a finitely aligned @xmath -graph @xmath
. Here we note how our definition of a Toeplitz-Cuntz-Krieger @xmath
-family differs from a Cuntz-Krieger @xmath -family of [ 16 ] and how
the 2-cocycle is incorporated. Relation (TCK1) already appears in
Definition 2.5 of [ 16 ] . Relation (ii) in Definition 2.5 of [ 16 ] is

  -- -------- --
     @xmath   
  -- -------- --

whenever @xmath . Relation (TCK2) incorporates the 2-cocycle into the
above relation, as in ( 1.1 ). Relation (iii) in Definition 2.5 of [ 16
] is

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath . It turns out that the equivalent relation in the
2-cocycle setting is

  -- -------- -- -------
     @xmath      (1.2)
  -- -------- -- -------

for all @xmath . Since it is unclear why this is the correct relation,
we remove it from the definition of a Toeplitz-Cuntz-Krieger @xmath
-family. We replace it by the familiar relations (TCK3), seen in Lemma
2.7 of [ 16 ] , and (TCK4), seen in Remark 2.6 of [ 16 ] . Lemma 3.1.5
shows that replacing (TCK3) and (TCK4) by ( 1.2 ) would give us an
equivalent definition of a Toeplitz-Cuntz-Krieger @xmath -family.
Relation (iv) in Definition 2.5 of [ 16 ] ,

  -- -------- -- -------
     @xmath      (1.3)
  -- -------- -- -------

does not appear in the definition of Toeplitz-Cuntz-Krieger @xmath
-family, as in Definition 3.1.1 of [ 20 ] . The reason for this is
explained below in the overview of Section 3.3 .

In Section 3.2 we show that there is a unique universal @xmath -algebra
generated by a Toeplitz-Cuntz-Krieger @xmath -family @xmath (Theorem
3.2.3 ), we call this @xmath -algebra the twisted Toeplitz algebra of
@xmath and denoted it @xmath . Universal means that if @xmath is any
other Toeplitz-Cuntz-Krieger @xmath -family in a @xmath -algebra @xmath
, then there is a homomorphism @xmath such that @xmath for each @xmath .
In Proposition 3.1.7 we show there is a Toeplitz-Cuntz-Krieger @xmath
-family @xmath in @xmath . The universal property of @xmath determines a
homomorphism @xmath satisfying @xmath for each @xmath . This
representation @xmath of the twisted Toeplitz algebra on @xmath will be
an invaluable tool throughout the thesis.

In Section 3.3 , for a vertex @xmath and finite @xmath , we define the
gap projection

  -- -------- --
     @xmath   
  -- -------- --

(Definition 3.3.2 ). Relation (TCK4) implies that the range projections
@xmath pairwise commute, so that the gap projection @xmath is
well-defined (Lemma 3.1.3 (2)). Definition 3.3.1 defines the collection
@xmath of finite exhaustive sets of @xmath , as in Definition 2.4 of [
16 ] . Each element @xmath is finite and every path has a common range
vertex @xmath , so that @xmath . Similar to Definition 3.2 of [ 18 ] ,
given @xmath we define a relative Cuntz-Krieger @xmath -family to be a
Toeplitz-Cuntz-Krieger @xmath -family @xmath that satisfies

1.  @xmath for all @xmath

Relation (CK) can be thought of as weaker version of ( 1.3 ). We call a
relative Cuntz-Krieger @xmath -family a Cuntz-Krieger @xmath -family.
The map

  -- -------- --
     @xmath   
  -- -------- --

given by @xmath for @xmath is a @xmath -valued 2-cocycle. The relative
Cuntz-Krieger @xmath -families are precisely the Cuntz-Krieger @xmath
-families of ( [ 16 ] , Definition 2.5). When @xmath is row-finite and
locally convex, these are precisely the Cuntz-Krieger @xmath -families
of [ 7 ] . This assertion is nontrivial: we refer the reader to Appendix
A of [ 16 ] for a detailed explanation of Cuntz-Krieger relations
associated to different classes higher-rank graphs and their
equivalence.

Given @xmath , Theorem 3.3.7 shows that there is a unique universal
@xmath -algebra @xmath generated by a relative Cuntz-Krieger @xmath
-family @xmath . By definition, @xmath and @xmath for each @xmath ,
where @xmath is the smallest closed ideal containing the collection of
gap projections

  -- -------- --
     @xmath   
  -- -------- --

The reason for using relative Cuntz-Krieger @xmath -families will become
apparent when we classify the gauge-invariant structure of @xmath .

In Section 3.4 we establish two results concerning @xmath . Firstly, we
show that the projections associated to vertices are all nonzero; that
is, @xmath for each @xmath . Secondly, we identity the collection @xmath
of finite exhaustive sets containing @xmath and such that for @xmath ,

  -- -------- -- -------
     @xmath      (1.4)
  -- -------- -- -------

The collection @xmath is called the satiation of @xmath , and is, by
definition, the smallest satiated set containing @xmath (see Definition
4.1 and Definition 5.1 of [ 18 ] ). Theorem 3.4.16 establishes ( 1.4 ).
This result is needed throughout the thesis, including in the proof of
the gauge-invariant uniqueness theorem (Theorem 4.6.1 ). In [ 18 ] ,
Sims outlines a method for constructing the satiation @xmath of @xmath .
In doing so, proves the “only if” direction of ( 1.4 ) in ( [ 18 ] ,
Corollary 5.6). In this thesis we adopt the same method (Proposition
3.4.8 ). The “if” direction of ( 1.4 ) is much more involved. In
Definition 4.3 of [ 18 ] , Sims defines the collection @xmath of @xmath
-compatible boundary paths; such paths are analogues of infinite paths
in a @xmath -graph with a range but no source, which satisfy a property
relating to @xmath . In [ 18 ] , Sims proves the “if” direction of ( 1.4
) in Corollary 4.9 of [ 18 ] using a concrete representation @xmath ( [
18 ] , Definition 4.5) of @xmath on @xmath . It seems that this
representation cannot be extended to general twisted relative
Cuntz-Krieger algebras. Each of the @xmath in [ 18 ] are determined by

  -- -------- -- -------
     @xmath      (1.5)
  -- -------- -- -------

where @xmath denotes an @xmath -compatible boundary path and @xmath
denotes the canonical basis for @xmath . The reader should compare ( 1.5
) with the representation of @xmath on @xmath given in Definition 3.1.7
. In order for the family @xmath to satisfy (TCK2) and be a
representation of @xmath , we would need to make sense of a 2-cocycle
evaluated at an @xmath -compatible boundary path. There seems to be no
canonical way to do this. Instead, to prove ( 1.4 ) we need a different
analysis.

As we do not have a concrete representation of @xmath , we analyse the
structure of the ideals @xmath in order to understand the quotients
@xmath . By analysing these ideals, we distinguish between those gap
projections associated to @xmath and those associated to @xmath . Using
this, we show the “if” direction of ( 1.4 ) in Theorem 3.4.16 .

Chapter 4 contains an analysis of the fixed point algebra of the
gauge-action, called the core of @xmath and denoted @xmath . The
gauge-action is a strongly continuous group action @xmath determined by

  -- -------- -- -------
     @xmath      (1.6)
  -- -------- -- -------

where @xmath . To see there is an action, given @xmath note that

  -- -------- --
     @xmath   
  -- -------- --

is a relative Cuntz-Krieger @xmath -family. Thus the universal property
implies that there is a homomorphism @xmath satisfying ( 1.6 ). One
checks that @xmath is an inverse for @xmath , so that each @xmath is an
automorphism.

The main result of Chapter 4 is the gauge-invariant uniqueness theorem
(Theorem 4.6.1 ). If @xmath be a relative Cuntz-Krieger @xmath -family,
this theorem characterises when the homomorphism @xmath given by the
universal property is injective.

Section 4.1 outlines standard results in the literature concerning
strongly continuous group actions and faithful conditional expectations.
Section 4.2 constructs the gauge action determined by equation ( 1.6 ).
We prove several standard results concerning the gauge action. For
example, in Lemma 4.2.2 we show the gauge-action is strongly continuous
and in Lemma 4.2.3 we prove that

  -- -------- --
     @xmath   
  -- -------- --

Due to this characterisation of the core, it has become standard in the
context of graph algebras to study the subalgebra

  -- -------- -- -------
     @xmath      (1.7)
  -- -------- -- -------

of @xmath . Given another relative Cuntz-Krieger @xmath -family @xmath ,
we want to establish conditions under which

  -- -------- -- -------
     @xmath      (1.8)
  -- -------- -- -------

The idea is to show that ( 1.7 ) is an increasing union of
finite-dimensional subalgebras of the form @xmath where @xmath is
finite. We do this in Sections 4.3 and 4.4 . Almost all the content of
these sections is taken from the work of Raeburn and Sims in [ 14 ] and
Raeburn, Sims and Yeend in [ 16 ] . Most of the proofs are changed only
by the presence of the 2-cocycle. In Section 4.5 , we give conditions
under which ( 1.8 ) holds; even when @xmath is a relative Cuntz-Krieger
@xmath -family, for a 2-cocycle @xmath , possibly with @xmath .

Section 4.6 gives a statement of the gauge-invariant uniqueness theorem.
This theorem says that if @xmath is injective and @xmath carries a group
action @xmath that behaves similar to the gauge-action, then @xmath is
injective. This theorem is the main tool used to classify the
gauge-invariant ideals in @xmath .

Chapter 5 concerns the gauge-invariant ideal structure of @xmath .
Section 5.1 starts with the definition of a hereditary and relatively
saturated set @xmath of vertices. The definition of hereditary is
standard, see Definition 3.1 in [ 19 ] . The notion of a relatively
saturated set, rather than the standard saturated set, is needed as we
want to classify the gauge-invariant ideals of all twisted relative
Cuntz-Krieger algebras, not just the twisted Cuntz-Krieger algebras. In
Section 5.1 given an ideal @xmath , we find a relatively saturated and
hereditary set @xmath and a satiated set @xmath . In Section 5.2 , given
a relatively saturated and hereditary subset @xmath and a satiated set
@xmath , we construct a gauge-invariant ideal @xmath . We show that the
quotient @xmath is canonically isomorphic to a twisted relative
Cuntz-Krieger algebra of a subgraph of @xmath . In Section 5.3 we show
that every gauge-invariant ideal has the form @xmath ; that is, we give
a complete graph-theoretic description of the gauge-invariant ideals in
@xmath .

### 1.3 Main results

The first major result, as was mentioned in ( 1.4 ), is Theorem 3.4.16 :
for @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath . If @xmath is a relative Cuntz-Krieger @xmath -family and if
@xmath is a relative Cuntz-Krieger @xmath -family. Then Theorem 4.5.9
gives us conditions under which

  -- -------- --
     @xmath   
  -- -------- --

This Theorem is crucial in the proof of the gauge-invariant uniqueness
theorem, although in the proof we only need the situation where @xmath
are @xmath are identical. The case where @xmath has found application in
computing the @xmath -theory of twisted Cuntz-Krieger algebras
associated to @xmath -graphs [ 11 ] .

Theorem 4.6.1 is a version of an Huef and Raeburn’s gauge-invariant
uniqueness theorem for twisted relative Cuntz-Krieger algebras. It is an
essential tool in giving a graph-theoretic description of the
gauge-invariant ideals of twisted relative Cuntz-Krieger algebras. The
proof of this theorem for relative algebras is more difficult than the
non-relative case (see [ 18 ] ), and even more so in the twisted
relative case. The main technical result needed is Theorem 3.4.16
discussed above.

In Chapter 5 we present our main result, a complete graph-theoretic
description of the gauge-invariant ideal structure of each twisted
relative Cuntz-Krieger algebra. This result extends the corresponding
result of ( [ 19 ] , Theorem 5.5) for the Cuntz-Krieger algebra in two
ways: here we consider all relative Cuntz-Krieger algebras, which
includes the Cuntz-Krieger algebra; and we also incorporate the
2-cocycle.

## Chapter 2 Higher-rank graphs

In this chapter we recall the definition of a @xmath -graph (higher-rank
graph). We establish the standard notation for dealing with @xmath
-graphs.

### 2.1 Basic category theory

Higher-rank graphs are defined using the language of categories. The
following two definitions are taken from [ 12 ] .

###### Definition 2.1.1.

A small category @xmath is a sextuple @xmath consisting of:

-    sets @xmath and @xmath , called the object and morphism sets;

-    the domain and codomain functions @xmath ;

-    the identity function @xmath ; and

-    the composition function @xmath , where @xmath is the set of
    composable pairs in @xmath ;

and satisfying

-   @xmath for all @xmath ;

-   @xmath and @xmath for all @xmath ;

-    the unit law , @xmath for all @xmath ; and

-   associativity , @xmath .

We say the category @xmath is countable if @xmath is countable.

Since the unit law implies that @xmath and @xmath are surjective, if
@xmath is countable, then @xmath is also countable.

###### Definition 2.1.2.

A covariant functor @xmath from a category @xmath to a category @xmath
is a pair of functions (both denoted @xmath ); an object function @xmath
, and a morphism function @xmath satisfying:

-   @xmath and @xmath for all @xmath ;

-   @xmath for all @xmath ; and

-   @xmath for all @xmath .

We regard the morphisms of a category as arrows connecting their domain
object to their codomain object. Composition of morphisms then becomes
concatenation of arrows. Informally, a covariant functor is a map
between the arrows of one category to the arrows of another category
that preserves connectivity. There is also a notion of a contravariant
functor . Here we will only be dealing with covariant functors, and so
we will just refer to them as functors .

Throughout this thesis @xmath denotes the set @xmath . We will write
@xmath for the usual set of natural numbers. If @xmath and @xmath are
sets, we write @xmath if each element of @xmath is a member of @xmath ;
we write @xmath if @xmath is strictly contained in @xmath .

###### Example 2.1.3.

A monoid @xmath can be regarded as the morphisms of a category @xmath
with a single object @xmath ; that is @xmath , @xmath , @xmath for all
@xmath , @xmath , and @xmath for all @xmath . For us, the most important
category arising from a monoid is @xmath under addition for @xmath .

### 2.2 Definitions and notation

In this section we recall the definition of a @xmath -graph (higher-rank
graph) and establish the standard notation for dealing with them.

We regard @xmath as a monoid under addition, with additive identity
@xmath . We define a partial order @xmath by @xmath if and only if
@xmath . We write @xmath if @xmath . Fix @xmath . We write @xmath for
the @xmath coordinate of @xmath . We write @xmath for the coordinate
maximum of @xmath and @xmath and @xmath for there coordinate minimum;
that is, @xmath and @xmath .

###### Definition 2.2.1 ([7], Definition 1.1).

A @xmath -graph (or higher-rank graph) is a pair @xmath that consists of
a countable category @xmath and a functor @xmath , which satisfies the
factorisation property : for every @xmath and @xmath with @xmath , there
are unique elements @xmath such that @xmath and @xmath , @xmath .

Suppose @xmath and @xmath . If @xmath , then two applications of the
factorisation property ensure there are unique morphisms @xmath such
that @xmath and @xmath , @xmath , @xmath . We write @xmath for @xmath ,
@xmath for @xmath and @xmath for @xmath .

Let @xmath be a @xmath -graph. We claim that

  -- -------- -- -------
     @xmath      (2.1)
  -- -------- -- -------

To see this, recall that @xmath is a functor and @xmath has just one
object @xmath . Thus, for each @xmath we have @xmath . This shows the
@xmath containment in ( 2.1 ). Fix @xmath with @xmath . Write @xmath for
@xmath . As @xmath , the factorisation property implies that there exist
unique morphisms @xmath such that @xmath and @xmath . Both @xmath ,
@xmath and @xmath , @xmath provide such factorisations. The uniqueness
of factorisations implies that @xmath , showing the @xmath containment
in ( 2.1 ).

Due to ( 2.1 ), we regard @xmath as a subset of @xmath and we regard
@xmath as consisting entirely of its morphisms; that is, we write @xmath
for @xmath

For @xmath , we write

  -- -------- --
     @xmath   
  -- -------- --

In particular, @xmath , which we regard as the collection of vertices
via ( 2.1 ). We write @xmath for the domain function @xmath , and @xmath
for the codomain function @xmath . Given @xmath , we call @xmath the
source of @xmath and @xmath the range of @xmath . For @xmath and @xmath
, we write @xmath for @xmath and @xmath for @xmath . We generally
reserve lower-case Greek letters @xmath for paths in @xmath . Notable
exceptions include: @xmath , which we use for the Kronecker delta;
@xmath , which we use for basis elements of Hilbert spaces; and @xmath ,
which we use for the gauge-action (see Section 4.2 ). Lower-case English
letters @xmath typically denote elements of @xmath .

###### Definition 2.2.2.

Let @xmath be a @xmath -graph. For @xmath we define

  -- -------- --
     @xmath   
  -- -------- --

A @xmath -graph @xmath is said to be finitely aligned if the set @xmath
is finite for each @xmath .

###### Definition 2.2.3.

Let @xmath be a @xmath -graph. For @xmath , define the set of minimal
common extensions of @xmath and @xmath , denoted @xmath , to be
collection of @xmath such that @xmath for some @xmath with @xmath . If
the @xmath -graph @xmath is clear from context, we write @xmath for
@xmath . Fix @xmath . For @xmath and @xmath we define

  -- -------- --
     @xmath   
  -- -------- --

###### Proposition 2.2.4.

Let @xmath be a finitely aligned @xmath -graph and suppose @xmath . The
map

  -- -------- --
     @xmath   
  -- -------- --

given by @xmath is a bijection. In particular, @xmath is finite for all
@xmath .

###### Proof.

Fix @xmath . Let @xmath . Then @xmath , and @xmath . So @xmath is
surjective. To see that it is injective suppose @xmath . The
factorisation property implies that @xmath . Now as @xmath , another
application of the factorisation property shows that @xmath . So @xmath
is injective and hence a bijection. Since @xmath is finitely aligned,
@xmath for all @xmath . ∎

### 2.3 Graph morphisms

For each @xmath , we define a @xmath -graph @xmath . For a @xmath -graph
@xmath , we define graph morphisms @xmath , which we regard as
potentially-infinite paths in @xmath . We use such paths for our
analysis of the ideal structure of @xmath in Section 3.4 .

###### Example 2.3.1 ([7], Examples 1.7(ii)).

Let @xmath and @xmath . Define

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

For @xmath , we define @xmath and @xmath . Then @xmath is a countable
category. Define @xmath . The pair @xmath is a @xmath -graph.

###### Definition 2.3.2.

Let @xmath and @xmath be a @xmath -graphs. A graph morphism is a functor
@xmath such that @xmath . We define

  -- -------- --
     @xmath   
  -- -------- --

For @xmath , we write @xmath for @xmath and @xmath for @xmath .

For @xmath , there is a bijection between @xmath and the set of graph
morphisms @xmath : if @xmath , set @xmath (see the paragraph following
Definition 2.2.1 ). The uniqueness clause in factorisation property
implies that @xmath well-defined. If @xmath contains some infinite
coordinates, then graph morphisms @xmath are thought of as partially
infinite paths in @xmath .

## Chapter 3 Twisted relative Cuntz-Krieger algebras

For each finitely aligned @xmath -graph @xmath and each @xmath -valued
2-cocycle @xmath on @xmath , we investigate collections of partial
isometries indexed by @xmath called Toeplitz-Cuntz-Krieger @xmath
-families. We show that there is a universal @xmath -algebra @xmath ,
called the twisted Toeplitz algebra, generated by a
Toeplitz-Cuntz-Krieger @xmath -family @xmath . For each finite
exhaustive set @xmath , where @xmath , we define the associated gap
projection @xmath in @xmath . For a collection @xmath of finite
exhaustive sets, we investigate the associated twisted relative
Cuntz-Krieger algebra @xmath . By definition, @xmath is the quotient of
@xmath by the smallest closed ideal @xmath containing all the gap
projections associated to elements of @xmath . We define relative
Cuntz-Krieger @xmath -families, which are Toeplitz-Cuntz-Krieger @xmath
-families satisfying an additional relation, and show that @xmath is
universal for such a family @xmath . The gap projections associated to
elements of @xmath are, by definition of @xmath , zero in @xmath . Using
a concrete representation of @xmath on @xmath , we determine for which
@xmath the converse is true; that is, for which @xmath we have if @xmath
then @xmath .

### 3.1 Toeplitz-Cuntz-Krieger @xmath-families

We recall the notion of a @xmath -valued 2-cocycle on a @xmath -graph
@xmath . We identity collections of partial isometries indexed by @xmath
called Toeplitz-Cuntz-Krieger @xmath -families, and study their basic
properties. We construct a Toeplitz-Cuntz-Krieger @xmath -family in
@xmath .

###### Definition 3.1.1.

Let @xmath be a @xmath -graph. A @xmath -valued 2-cocycle on @xmath is a
map

  -- -------- --
     @xmath   
  -- -------- --

that satisfies:

1.  @xmath whenever @xmath and @xmath ; and

2.  @xmath for all @xmath .

We call @xmath the 2-cocycle identity . We write @xmath for the set of
all @xmath -valued 2-cocycles on @xmath .

###### Definition 3.1.2.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . A subset
@xmath of a @xmath -algebra is a Toeplitz-Cuntz-Krieger @xmath -family
if:

1.  @xmath is a set of mutually orthogonal projections;

2.  @xmath whenever @xmath ;

3.  @xmath for all @xmath ; and

4.  @xmath for all @xmath .

The following lemma lists some direct consequences of Definition 3.1.2 .

###### Lemma 3.1.3.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Suppose
that @xmath is a Toeplitz-Cuntz-Krieger @xmath -family. Then:

1.  @xmath for all @xmath ;

2.   the range projections @xmath pairwise commute;

3.   if @xmath then @xmath ;

4.   if @xmath and @xmath then

      -- -------- --
         @xmath   
      -- -------- --

5.  @xmath

6.  @xmath is a set of mutually orthogonal projections for each @xmath ;
    and

7.   For @xmath , @xmath if and only if @xmath .

###### Proof.

For @xmath , fix @xmath . We calculate

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Since @xmath for all @xmath , statement @xmath is a consequence of
(TCK4). For (3), fix @xmath such that @xmath . It follows from (TCK1)
that @xmath , giving (3).

For @xmath , fix @xmath such that @xmath and @xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

We now show (5). We have

  -- -------- --
     @xmath   
  -- -------- --

and so it suffices to prove that @xmath is a @xmath -algebra. For this
we need only prove that @xmath is closed under multiplication and taking
adjoints. Since @xmath for each @xmath , the subspace @xmath is closed
under adjoints. Part (4) implies that @xmath is closed under
multiplication.

Fix @xmath . We have @xmath , so @xmath is a projection. So for (6), it
suffices to show that for each @xmath the projections @xmath , @xmath
are mutually orthogonal. Fix @xmath . Suppose that @xmath . We show that
@xmath if @xmath and @xmath otherwise. To see this suppose @xmath .
There exist @xmath such that @xmath . Since @xmath we have @xmath . The
factorisation property therefore implies that @xmath , so @xmath as
claimed. Now (TCK4) gives @xmath . For (7), the @xmath -identity implies
that for @xmath

  -- -------- --
     @xmath   
  -- -------- --

So for @xmath , @xmath if and only if @xmath . ∎

###### Remark 3.1.4.

If @xmath is a Toeplitz-Cuntz-Krieger @xmath -family, then @xmath if and
only if @xmath and @xmath . To see this we first need a calculation.
Suppose that @xmath , two applications of the @xmath -identity gives

  -- -------- -- -------
     @xmath      (3.1)
  -- -------- -- -------

Suppose @xmath . Lemma 3.1.3 (3) implies that @xmath . Equation ( 3.1 )
implies that @xmath , and so @xmath by Lemma 3.1.3 (7). Suppose @xmath
and @xmath . Lemma 3.1.3 (7) implies that @xmath . Equation 3.1 implies
that @xmath .

The following Lemma shows that replacing (TCK3) and (TCK4) in Definition
3.1.2 by the relation in Lemma 3.1.3 (1) would result in an equivalent
definition of a Toeplitz-Cuntz-Krieger @xmath -family.

###### Lemma 3.1.5.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Suppose
that @xmath is a collection of partial isometries in a @xmath -algebra
satisfying (TCK1) and (TCK2). Then @xmath is a Toeplitz-Cuntz-Krieger
@xmath -family if and only if

  -- -------- -- -------
     @xmath      (3.2)
  -- -------- -- -------

for all @xmath .

###### Proof.

Suppose that @xmath is a Toeplitz-Cuntz-Krieger @xmath -family. Relation
( 3.2 ) follows from Lemma 3.1.3 (1). Suppose that ( 3.2 ) holds. We
show (TCK3). Fix @xmath . Equation ( 3.2 ) implies that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

So @xmath satisfies (TCK3). We now show (TCK4). Fix @xmath Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

So @xmath satisfies (TCK4), and hence is a Toeplitz-Cuntz-Krieger @xmath
-family. ∎

To construct a Toeplitz-Cuntz-Krieger @xmath -family in @xmath , we need
a technical lemma.

###### Lemma 3.1.6.

Let @xmath be a separable Hilbert space with basis @xmath . Suppose
@xmath and that @xmath is linear and satisfies @xmath for all @xmath .
Then @xmath is bounded with @xmath , and the unique extension of @xmath
to @xmath is @xmath , the adjoint of @xmath .

###### Proof.

Fix @xmath and @xmath . There is finite @xmath such that @xmath . We
calculate

  -- -------- -------- -- -------
     @xmath   @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      (3.3)
  -- -------- -------- -- -------

Hence

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

So @xmath is bounded with @xmath . Denote the unique extension of @xmath
to @xmath by @xmath . Now ( 3.3 ) gives

  -- -------- -- -------
     @xmath      (3.4)
  -- -------- -- -------

For fixed @xmath , the maps @xmath and @xmath on @xmath are continuous,
and by ( 3.4 ) agree on a dense subset of @xmath . Therefore they agree
on all of @xmath ; that is, @xmath . By the uniqueness of adjoints we
have @xmath . ∎

###### Proposition 3.1.7.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . For
@xmath , let @xmath be the point mass function for @xmath . Consider the
Hilbert space @xmath with the usual inner product. For each @xmath ,
there is a unique bounded linear operator @xmath on @xmath such that

  -- -------- -- -------
     @xmath      (3.5)
  -- -------- -- -------

for all @xmath . The set @xmath is a Toeplitz-Cuntz-Krieger @xmath
-family in @xmath .

###### Proof.

To see that ( 3.5 ) defines a bounded linear operator @xmath on @xmath
for each @xmath , we will show that @xmath is a partial isometry and
hence @xmath . Fix @xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

So if @xmath we have @xmath . So if @xmath then,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

If @xmath then @xmath . So @xmath is a partial isometry and is bounded
with @xmath . The calculation @xmath shows that @xmath . By continuity,
@xmath extends uniquely to a partial isometry in @xmath .

We now will show that for each @xmath the unique linear extension @xmath
of

  -- -------- --
     @xmath   
  -- -------- --

extends by continuity to the adjoint of @xmath . By Lemma 3.1.6 it
suffices to show that @xmath for all @xmath . That is,

  -- -------- --
     @xmath   
  -- -------- --

Fix @xmath and we calculate,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Now we will establish the relations (TCK1)-(TCK4) for @xmath . By
linearity and continuity it suffices to check these relations on basis
vectors. For (TCK1) we show that @xmath and @xmath for each @xmath with
@xmath , so that @xmath is a set of mutually orthogonal projections. Fix
@xmath . Since @xmath for all @xmath ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

and

  -- -------- -------- --
     @xmath   @xmath   
     @xmath            
              @xmath   
  -- -------- -------- --

So @xmath is a set of projections. To see that they are mutually
orthogonal fix @xmath with @xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

This establishes (TCK1). For (TCK2) we must show that @xmath for all
@xmath with @xmath . Fix @xmath with @xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

This establishes (TCK2). For (TCK3) we must show @xmath for all @xmath .
Fix @xmath . Using (C1), we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

This establishes (TCK3). For (TCK4) we must show that @xmath for all
@xmath . It will be helpful to consider the following calculation. Fix
@xmath . Then

  -- -------- -------- -- -------
     @xmath   @xmath      (3.6)
              @xmath      
              @xmath      
  -- -------- -------- -- -------

We will now show that for any @xmath , @xmath for all @xmath and hence
@xmath . Fix @xmath . Using ( 3.6 ) we have,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

If @xmath for some @xmath then the factorisation property ensures that
there is exactly one such @xmath . So

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

establishing (TCK4).

∎

### 3.2 The twisted Toeplitz algebra

We show there is a unique universal @xmath -algebra @xmath , called the
twisted Toeplitz algebra, generated by a Toeplitz-Cuntz-Krieger @xmath
-family @xmath in Theorem 3.2.3 . First we need some technical results.

###### Lemma 3.2.1.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be the Toeplitz-Cuntz-Krieger @xmath -family of Proposition 3.1.7
. Then @xmath are linearly independent.

###### Proof.

Let @xmath be a finite subset of @xmath . Let @xmath be the usual basis
of @xmath . We show that @xmath are linearly independent. The proof is
by induction on @xmath . Suppose that @xmath for all @xmath . If @xmath
, let @xmath be the unique pair such that @xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Hence @xmath . As an inductive hypothesis suppose that @xmath is
linearly independent whenever @xmath . Suppose @xmath . Fix @xmath such
that @xmath for all @xmath . There is such a pair @xmath since @xmath is
finite. Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

As the @xmath are linearly independent with have @xmath for each @xmath
. Let

  -- -------- --
     @xmath   
  -- -------- --

By the inductive hypothesis @xmath is linearly independent. So

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

implies that @xmath for all @xmath . Thus @xmath for all @xmath . ∎

###### Proposition 3.2.2.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath and let @xmath be the complex vector space @xmath under pointwise
addition and scalar multiplication. For each @xmath , let @xmath be the
point mass function for @xmath . There is a unique multiplication on
@xmath satisfying

  -- -------- -- -------
     @xmath      (3.7)
  -- -------- -- -------

for all @xmath . There is an involution @xmath given by @xmath . Under
these operations @xmath is a *-algebra.

###### Proof.

We check:

1.  that @xmath determines a self-inverse conjugate-linear map;

2.  that the multiplication uniquely extends bilinearly to all of @xmath
    ;

3.  that this multiplication is associative and commutes with scalar
    multiplication; and

4.  that @xmath for all @xmath .

For (1), fix @xmath , @xmath and @xmath . We calculate.

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

So @xmath is conjugate linear. The map @xmath is self-inverse since
complex conjugation is, establishing (1). The @xmath are linearly
independent and span @xmath , so each @xmath has the unique expression

  -- -------- --
     @xmath   
  -- -------- --

For (2), the formula

  -- -------- -------- -- -------
     @xmath   @xmath      
              @xmath      
              @xmath      
              @xmath      (3.8)
  -- -------- -------- -- -------

extends multiplication to all of @xmath . Multiplication is bilinear as
the vector space operations are pointwise, establishing (2).

For (3), it suffices to check @xmath and that @xmath for all @xmath and
@xmath , the latter follows from ( 3.7 ).

Fix @xmath . To show associativity, we use our Toeplitz-Cuntz-Krieger
@xmath -family @xmath in @xmath and Lemma 3.2.1 . Define @xmath by
@xmath . This is well-defined since the @xmath are linearly independent.
The map @xmath is linear by definition of the vector space operations in
@xmath and @xmath . We claim that @xmath also preserves multiplication.
As @xmath is linear and multiplication is bilinear, it suffices to show
that @xmath . We have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

We also claim that @xmath is injective. Fix @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

Lemma 3.2.1 implies that @xmath for all @xmath . Hence @xmath . We can
now use the map @xmath to show that the multiplication in @xmath is
associative. As multiplication in @xmath is associative, we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Since @xmath is injective we have @xmath , establishing (3). For (4), it
suffices to check that @xmath for all @xmath . Fix @xmath . We have

  -- -------- -------- -------- --
     @xmath   @xmath            
              @xmath            
              @xmath            
              @xmath   @xmath   
  -- -------- -------- -------- --

We can now construct the twisted Toeplitz algebra @xmath .

###### Theorem 3.2.3.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . There
exists a @xmath -algebra @xmath generated by a Toeplitz-Cuntz-Krieger
@xmath -family @xmath that is universal in the sense that for each
Toeplitz-Cuntz-Krieger @xmath -family @xmath in a @xmath -algebra @xmath
, there exists a homomorphism @xmath such that @xmath for all @xmath .
The @xmath -algebra @xmath is unique in the sense that if @xmath is a
@xmath -algebra generated by a Toeplitz-Cuntz-Krieger @xmath -family
@xmath satisfying the universal property, then there is an isomorphism
of @xmath onto @xmath such that @xmath for all @xmath . We call @xmath
the twisted Toeplitz algebra of @xmath .

###### Proof.

For this proof, we abbreviate Toeplitz-Cuntz-Krieger by TCK and write
@xmath is a TCK @xmath -family for @xmath is a TCK @xmath -family.

First we show that each TCK @xmath -family induces a homomorphism of
@xmath . Fix a TCK @xmath -family t. Define a map @xmath by

  -- -------- --
     @xmath   
  -- -------- --

We claim @xmath is a homomorphism. One easily checks that @xmath is
linear. Fix @xmath . There are finite @xmath such that @xmath and @xmath
. Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

and

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

So @xmath is a homomorphism.

For each @xmath , we claim that

  -- -------- --
     @xmath   
  -- -------- --

is bounded. Fix @xmath and a TCK @xmath -family @xmath . There is finite
@xmath such that @xmath . For each @xmath , we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

As @xmath is a projection it has norm @xmath or @xmath , and the same is
true of @xmath . We have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

which establishes our claim.

For each @xmath , define

  -- -------- --
     @xmath   
  -- -------- --

The function @xmath is a *-algebra seminorm on @xmath since it is
defined as the supremum of a collection of seminorms. For each TCK
@xmath -family @xmath , the kernel of @xmath is a two-sided *-ideal in
@xmath . So

  -- -------- --
     @xmath   
  -- -------- --

is also a two-sided *-ideal in @xmath . Let @xmath . Define @xmath by
@xmath ; this is well defined. To see this suppose that @xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

The calculations

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

and

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

show that @xmath is a Banach *-algebra norm and satisfies the @xmath
-identity. Denote the completion of @xmath by @xmath , which is a @xmath
-algebra by construction.

For @xmath , define @xmath . We claim that @xmath is a TCK @xmath
-family that generates @xmath . If @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

If @xmath with @xmath then @xmath . This gives (TCK1). If @xmath with
@xmath , then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

establishing (TCK2). For @xmath , we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

This gives (TCK3). For (TCK4), fix @xmath . We have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

This gives (TCK4). If @xmath with @xmath , then as

  -- -------- --
     @xmath   
  -- -------- --

the TCK @xmath -family @xmath generates @xmath . We must now check that
@xmath and @xmath have the universal property. Fix a TCK @xmath -family
@xmath . For @xmath , we have

  -- -------- -- -------
     @xmath      (3.9)
  -- -------- -- -------

Hence if @xmath then @xmath , and so @xmath . Hence there is a
well-defined linear map @xmath given by @xmath . This @xmath is a
homomorphism by definition of the operations in the quotient @xmath and
because @xmath is homomorphism. Equation ( 3.9 ) implies that for @xmath
, we have @xmath . So the homomorphism @xmath is continuous, and hence
extends to the desired homomorphism @xmath .

For the final statement, suppose @xmath is a @xmath -algebra generated
by TCK @xmath -family @xmath satisfying the universal property. As
@xmath is universal there is a homomorphism @xmath such that @xmath for
each @xmath . As @xmath is universal there is a homomorphism @xmath such
that @xmath for each @xmath . Since @xmath and @xmath are the identity
maps on the generators of @xmath and @xmath respectively, @xmath and
@xmath are mutually inverse and hence isomorphisms. ∎

### 3.3 Relative Cuntz-Krieger @xmath-families

This section introduces the twisted relative Cuntz-Krieger algebras
associated to finitely aligned @xmath -graph @xmath . For each @xmath
and each collection @xmath of finite exhaustive sets, the twisted
relative Cuntz-Krieger algebra @xmath is the universal @xmath -algebra
generated by a Toeplitz-Cuntz-Krieger @xmath -family @xmath satisfying

  -- -------- --
     @xmath   
  -- -------- --

whenever @xmath . When @xmath , the associated twisted relative
Cuntz-Krieger algebra @xmath is the Toeplitz algebra @xmath studied in
the last section. When @xmath denotes the identity 2-cocycle, we obtain
the relative Cuntz-Krieger algebra @xmath studied in [ 18 ] . When
@xmath is the collection of all finite exhaustive sets @xmath [ 16 ] ,
we obtain the twisted Cuntz-Krieger algebra @xmath . The twisted
relative Cuntz-Krieger algebras @xmath interpolate between the Toeplitz
algebra @xmath , and the Cuntz-Krieger algebra @xmath . More precisely,
for each @xmath there is an ideal @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

and, in particular, there is @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

###### Definition 3.3.1 ([16], Definition 2.4).

Let @xmath be a @xmath -graph and let @xmath . A subset @xmath is said
to be exhaustive if for every @xmath there exists a @xmath such that
@xmath . Define @xmath .

###### Definition 3.3.2.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Suppose that @xmath
and that @xmath is nonempty and finite. We write @xmath for the unique
@xmath such that @xmath . We call the product

  -- -------- --
     @xmath   
  -- -------- --

the gap projection of @xmath associated to @xmath .

###### Remark 3.3.3.

The product

  -- -------- --
     @xmath   
  -- -------- --

is well-defined as the projections @xmath pairwise commute. Hence for
@xmath and @xmath ,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

An induction argument over @xmath therefore shows that @xmath is
independent of the order of multiplication.

The following definition is ( [ 18 ] , Definition 3.2) but with the
2-cocycle incorporated.

###### Definition 3.3.4.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . A relative Cuntz-Krieger @xmath -family is a
Toeplitz-Cuntz-Krieger @xmath -family @xmath that satisfies

  -- -------- -- ------
     @xmath      (CK)
  -- -------- -- ------

When @xmath , we call the resulting relative Cuntz-Krieger @xmath
-family a Cuntz-Krieger @xmath -family .

Note that every Toeplitz-Cuntz-Krieger @xmath -family is a relative
Cuntz-Krieger @xmath -family and every relative Cuntz-Krieger @xmath
-family is a Toeplitz-Cuntz-Krieger @xmath -family.

###### Definition 3.3.5.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Define @xmath to be the intersection of all closed ideals
containing

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma 3.3.6.

Let @xmath be @xmath -algebras and let @xmath . Let @xmath denote the
intersection of all closed ideals containing @xmath . Then @xmath is the
smallest ideal containing @xmath and

  -- -------- --
     @xmath   
  -- -------- --

We call @xmath the ideal generated by @xmath . Suppose @xmath is a
homomorphism such that @xmath for all @xmath . Then @xmath for all
@xmath . There is a unique homomorphism @xmath satisfying @xmath for all
@xmath .

###### Proof.

It is routine to check that an arbitrary intersection of closed ideals
containing @xmath is a closed ideal containing @xmath . The ideal @xmath
is the intersection of all closed ideals containing @xmath and hence the
smallest closed ideal containing @xmath . The set @xmath is a closed
ideal. Let @xmath be an approximate identity for @xmath . Then @xmath
for each @xmath . So @xmath contains @xmath . Since every closed ideal
that contains @xmath must contain @xmath , we have @xmath . Since @xmath
is the smallest closed ideal containing @xmath , we have @xmath .
Suppose that @xmath and that @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

So @xmath for all @xmath . By continuity, we have @xmath for all @xmath
.

To see that the map @xmath is well-defined, suppose that @xmath . Then
@xmath for some @xmath , and so @xmath . Since a closed ideal in a
@xmath -algebra is automatically self-adjoint, there is a well-defined
involution @xmath satisfying @xmath for all @xmath . That @xmath is a
homomorphism then follows from the definitions of the operations in the
quotient @xmath and that @xmath is a homomorphism. ∎

###### Theorem 3.3.7.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . There exists a @xmath -algebra @xmath generated by a relative
Cuntz-Krieger @xmath -family @xmath that is universal in the sense that
if @xmath is a relative Cuntz-Krieger @xmath -family in a @xmath
-algebra @xmath , then there exists a homomorphism @xmath such that
@xmath for all @xmath . The @xmath -algebra @xmath is unique in the
sense that, if @xmath is a @xmath -algebra generated by a relative
Cuntz-Krieger @xmath -family @xmath satisfying the universal property,
there is an isomorphism of @xmath onto @xmath such that @xmath for all
@xmath . We call @xmath the twisted relative Cuntz-Krieger algebra of
@xmath .

###### Proof.

Let @xmath and let @xmath . To prove that @xmath is a relative
Cuntz-Krieger @xmath -family, we only need to show that @xmath for each
@xmath . If @xmath , then @xmath by definition, so @xmath .

We will now construct the homomorphism @xmath . Fix a relative
Cuntz-Krieger @xmath -family @xmath in a @xmath algebra @xmath . Let
@xmath be the homomorphism from Theorem 3.2.3 . If @xmath , then

  -- -------- -- --------
     @xmath      (3.10)
  -- -------- -- --------

Lemma 3.3.6 implies that @xmath for all @xmath , and that there is a
homomorphism @xmath satisfying @xmath for all @xmath . Fix @xmath . Then
@xmath . The proof that @xmath is unique is identical to the proof that
@xmath is unique in Theorem 3.2.3 . ∎

### 3.4 Gap projections and boundary paths

For a collection @xmath , we recall the definition of the satiation
@xmath of @xmath from [ 18 ] in Definition 3.4.7 . We show that for each
collection @xmath , the gap projection @xmath in @xmath associated to a
finite exhaustive set @xmath is zero if and only if @xmath .

For @xmath , we wish to know precisely which finite subsets @xmath of
@xmath satisfy

  -- -------- -- --------
     @xmath      (3.11)
  -- -------- -- --------

The following remark says that if @xmath then @xmath . If @xmath is not
exhaustive, Lemma 3.4.2 implies that @xmath . So in order to find out
precisely which finite subsets @xmath of @xmath satisfy ( 3.11 ), we
only need to consider the case when @xmath is exhaustive; that is,
@xmath .

###### Remark 3.4.1.

Suppose that @xmath is finite and that @xmath . Then since @xmath , we
have

  -- -------- --
     @xmath   
  -- -------- --

for all Toeplitz-Cuntz-Krieger @xmath -families @xmath .

###### Lemma 3.4.2.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath and suppose that @xmath is a Toeplitz-Cuntz-Krieger @xmath
-family. Suppose that @xmath is finite and is not exhaustive. Then

  -- -------- --
     @xmath   
  -- -------- --

whenever @xmath is nonzero for all @xmath .

###### Proof.

Since @xmath is not exhaustive there exists @xmath such that for all
@xmath we have @xmath . By (TCK4) we have @xmath for all @xmath . As
@xmath is a projection @xmath . Since @xmath commutes with @xmath for
each @xmath , we have

  -- -- -------- --
        @xmath   
        @xmath   
        @xmath   
        @xmath   
  -- -- -------- --

Since @xmath , Remark 3.1.4 implies that @xmath , and so @xmath . ∎

The next lemma shows that in the twisted Toeplitz algebra the gap
projections associated to @xmath are all nonzero.

###### Lemma 3.4.3.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath be the Toeplitz-Cuntz-Krieger @xmath -family of Proposition 3.1.7
. For all @xmath and all finite @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

The same is true for the family @xmath .

###### Proof.

Fix @xmath and finite @xmath . We prove by induction on @xmath that

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , say @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

Suppose @xmath whenever @xmath . Then for @xmath and any @xmath , we
have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Hence by induction @xmath for all finite @xmath . In particular @xmath .
By Theorem 3.2.3 there is a unique homomorphism @xmath satisfying @xmath
for all @xmath . Hence @xmath ∎

The next few Lemmas involve technical calculations concerning the
algebraic manipulation of gap projections. Recall from Definition 2.2.3
, that for @xmath and @xmath , we may form the collection @xmath .

###### Lemma 3.4.4.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath . Then for
@xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Suppose that @xmath . Since @xmath is a partial isometry,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Applying (TCK2) and (TCK4) gives

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Factorising gives

  -- -------- -- --
     @xmath      
  -- -------- -- --

For each @xmath such that there is @xmath with @xmath we have @xmath .
Lemma 3.1.3 (6) implies that @xmath is a set of mutually orthogonal
projections. Hence

  -- -------- -------- --
     @xmath   @xmath   
  -- -------- -------- --

Using the definition of @xmath and (TCK3) we have

  -- -------- -------- -------- --
     @xmath   @xmath            
              @xmath            
              @xmath            
              @xmath   @xmath   
  -- -------- -------- -------- --

###### Lemma 3.4.5.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Suppose that @xmath ,
that @xmath and that @xmath is finite. Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

As @xmath for all @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath . The range projections pairwise commute by Lemma 3.1.3
(2). Since @xmath is finite, it follows that

  -- -------- --
     @xmath   
  -- -------- --

We have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Since @xmath is a projection, we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

since @xmath ∎

###### Lemma 3.4.6.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Let @xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Then:

1.   if @xmath and @xmath is finite with @xmath , then @xmath ;

2.   if @xmath with @xmath and if @xmath , then @xmath ;

3.   if @xmath , @xmath for each @xmath and @xmath , then @xmath .

###### Proof.

For (1), suppose that @xmath and that @xmath is finite with @xmath . The
range projections @xmath pairwise commute by Lemma 3.1.3 (2). It follows
that @xmath .

For (2), suppose that @xmath satisfies @xmath and that @xmath . Lemma
3.4.4 implies that @xmath . Multiplying both sides on the left by @xmath
gives

  -- -------- --
     @xmath   
  -- -------- --

For (3), suppose that @xmath and that @xmath for each @xmath . Set
@xmath . Since

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath . It follows that @xmath ∎

Given a collection @xmath , we recall the definition of @xmath , the
satiation of @xmath , from [ 18 ] .

###### Definition 3.4.7 ([18], Definition 4.1).

Let @xmath be a finitely aligned @xmath -graph. We say that a subset
@xmath of @xmath is satiated if it satisfies:

1.   if @xmath and @xmath is finite with @xmath then @xmath ;

2.   if @xmath with @xmath and if @xmath then @xmath ;

3.   if @xmath and @xmath for each @xmath , then @xmath ; and

4.   if @xmath and @xmath for each @xmath , then @xmath .

The smallest collection of subsets of @xmath which contains @xmath and
satisfies (S1)-(S4) is denoted @xmath and called the satiation of @xmath
.

Let @xmath be a finitely aligned @xmath -graph and @xmath .
Definition 5.2 of [ 18 ] defines maps @xmath given by

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

Note that Lemma 5.3 of [ 18 ] implies that @xmath for each @xmath

The following summarises some properties of @xmath .

###### Lemma 3.4.8.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Let @xmath be a relative Cuntz-Krieger @xmath -family. Then:

1.   the satiation @xmath of @xmath is a subset of @xmath ;

2.   if @xmath then @xmath ; and

3.   the ideals @xmath and @xmath of @xmath are equal.

Moreover, @xmath .

###### Proof.

Part (1): Let @xmath . Fix @xmath . Lemma 5.3 of [ 18 ] implies that
@xmath . Write @xmath for

  -- -------- --
     @xmath   
  -- -------- --

We have @xmath . Proposition 5.5 of [ 18 ] implies that @xmath . This
gives part (1).

Part (2): Since @xmath and since @xmath for all @xmath and @xmath , by
induction it suffices to show that if @xmath for all @xmath , where
@xmath then @xmath for all @xmath for each @xmath

Fix @xmath such that @xmath for all @xmath . We consider the cases
@xmath separately. Suppose that @xmath . Fix @xmath . Then @xmath for
some @xmath . Lemma 3.4.6 implies that @xmath . Suppose that @xmath .
Fix @xmath . Then @xmath for some @xmath and @xmath . Lemma 3.4.6
implies that @xmath . Suppose that @xmath . Fix @xmath . Then @xmath for
some @xmath where @xmath for each @xmath . Lemma 3.4.6 implies that
@xmath . Suppose that @xmath . Fix @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

for some @xmath , @xmath and @xmath for each @xmath . Lemma 3.4.5
implies that for each @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

Hence

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

For part (3), since @xmath it suffices to show the reverse containment.
Suppose @xmath . By part (2), we have @xmath . Hence @xmath . So @xmath
contains all the generators of @xmath , hence @xmath . ∎

The main goal for the rest of this chapter is to show that the converse
of Lemma 3.4.8 (2) holds in the @xmath -algebra @xmath ; that is, for
@xmath , @xmath implies that @xmath . This is achieved with Theorem
3.4.16 . First we need several technical lemmas on boundary paths and
the structure of the ideals @xmath .

###### Lemma 3.4.9.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath . Suppose
@xmath . Then:

1.   if @xmath then

      -- -------- -- --------
         @xmath      (3.12)
      -- -------- -- --------

2.   if @xmath then

      -- -------- -- --------
         @xmath      (3.13)
      -- -------- -- --------

###### Proof.

Suppose that @xmath . There exists @xmath and @xmath such that @xmath .
Then @xmath and hence @xmath . As @xmath , Lemma 3.4.4 implies that

  -- -------- --
     @xmath   
  -- -------- --

since @xmath . Suppose @xmath . Then as @xmath , using (TCK1) we have,

  -- -------- -------- -- --------
     @xmath   @xmath      (3.14)
              @xmath      
              @xmath      
  -- -------- -------- -- --------

Hence if @xmath then @xmath , establishing part (1) of the Lemma. Part
(2) is Lemma 3.4.4 . ∎

We can now write down spanning elements for the ideals @xmath .

###### Lemma 3.4.10.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Let

  -- -------- --
     @xmath   
  -- -------- --

Fix @xmath and @xmath such that @xmath and @xmath . We calculate,

  -- -------- -------- -- --------
     @xmath   @xmath      (3.15)
              @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      
  -- -------- -------- -- --------

Since @xmath is satiated, each @xmath , and hence

  -- -------- --
     @xmath   
  -- -------- --

Suppose that @xmath and @xmath . Since multiplication is bilinear,
equation ( 3.15 ) implies that @xmath . Taking adjoints of both sides of
( 3.15 ) shows that @xmath . We show that @xmath is an ideal. Fix @xmath
and @xmath . By Lemma 3.1.3 (5) there is a sequence @xmath such that
@xmath as @xmath . Similarly, there is a sequence @xmath such that
@xmath as @xmath . As multiplication in a @xmath -algebra is jointly
continuous we have @xmath and @xmath as @xmath . The above argument
shows that @xmath for each @xmath and hence @xmath . Hence @xmath is a
closed ideal in @xmath . Since @xmath and @xmath is closed, @xmath . The
set @xmath contains all the gap projections associated to @xmath . As
@xmath is the smallest closed ideal that contains all the gap
projections associated to @xmath , we have @xmath . ∎

For a @xmath -graph @xmath , recall from Definition 2.3.2 the collection
@xmath of graph morphisms @xmath .

###### Definition 3.4.11 ([18], Definition 4.3).

Let @xmath be a finitely aligned @xmath -graph, and let @xmath be a
subset of @xmath . We say that @xmath is an @xmath - relative boundary
path of @xmath if for every @xmath such that @xmath , and every @xmath
such that @xmath , there exists @xmath such that @xmath . We denote the
collection of all @xmath -relative boundary paths of @xmath by @xmath .

Let @xmath be the Toeplitz-Cuntz-Krieger @xmath -family of Proposition
3.1.7 . The next few technical lemmas use @xmath -relative boundary
paths to characterise when, for @xmath , the gap projection @xmath
belongs to the @xmath -algebra @xmath . This charactisation enables us
to prove Theorem 3.4.16 , the main result of this section.

###### Lemma 3.4.12.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Let @xmath be the Toeplitz-Cuntz-Krieger @xmath -family of
Proposition 3.1.7 . Suppose that @xmath and that @xmath satisfy @xmath .
If @xmath satisfies @xmath , then there exists @xmath with @xmath such
that @xmath for all @xmath such that @xmath .

###### Proof.

We consider two cases: @xmath and then @xmath . Suppose first that
@xmath . Fix @xmath . Then @xmath , so @xmath does not have the form
@xmath . Hence @xmath . So @xmath does the job.

Suppose that @xmath . First suppose that @xmath . Fix @xmath . The
factorisation property implies that @xmath does not have the form @xmath
. So @xmath does the job.

Now suppose that @xmath and @xmath . Set @xmath . As @xmath is an @xmath
-relative boundary path and @xmath , there exists @xmath such that
@xmath . Put @xmath and fix @xmath such that @xmath Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Hence

  -- -------- -------- -------- --
     @xmath   @xmath            
              @xmath   @xmath   
  -- -------- -------- -------- --

###### Lemma 3.4.13.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Let @xmath be the Toeplitz-Cuntz-Krieger @xmath -family of
Proposition 3.1.7 . For each @xmath there exists @xmath with @xmath such
that @xmath whenever @xmath .

###### Proof.

Fix @xmath , say, @xmath where @xmath , @xmath and @xmath for each
@xmath . For each @xmath , Lemma 3.4.12 implies that there exists @xmath
such that @xmath for all @xmath . Put @xmath . Then @xmath for all
@xmath . ∎

###### Lemma 3.4.14.

Let @xmath be a finitely aligned @xmath -graph, @xmath and @xmath . Let
@xmath be the Toeplitz-Cuntz-Krieger @xmath -family of Proposition 3.1.7
. For all @xmath , if @xmath then @xmath .

###### Proof.

Fix @xmath and @xmath . There exists @xmath such that @xmath . By Lemma
3.4.10 , there exists

  -- -- --
        
  -- -- --

such that @xmath . Since @xmath is a homomorphism

  -- -------- --
     @xmath   
  -- -------- --

By Lemma 3.4.13 there exists @xmath such that whenever @xmath we have
@xmath . Then whenever @xmath we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Since homomorphisms between @xmath -algebras are norm decreasing, we
have

  -- -------- --
     @xmath   
  -- -------- --

Hence @xmath ∎

Recall from Lemma 4.7 of [ 18 ] that if @xmath is a finitely aligned
@xmath -graph, @xmath , and @xmath , then for each @xmath , both @xmath
and @xmath are nonempty.

###### Lemma 3.4.15.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Let @xmath be the Toeplitz-Cuntz-Krieger @xmath -family of
Proposition 3.1.7 . If @xmath , there exists @xmath such that @xmath for
all @xmath .

###### Proof.

By ( [ 18 ] , Lemma 4.7), there exists @xmath . Fix @xmath and @xmath .
We have @xmath . By the factorisation property @xmath for any @xmath .
Hence

  -- -------- -------- --
     @xmath   @xmath   
  -- -------- -------- --

Hence @xmath . ∎

###### Theorem 3.4.16.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath . We have

1.  @xmath for all @xmath ; and

2.   for @xmath , @xmath if and only if @xmath .

###### Proof.

For (1), fix @xmath . By ( [ 18 ] , Lemma 4.7) there exists @xmath . Let
@xmath be the Toeplitz-Cuntz-Krieger @xmath -family of Proposition 3.1.7
. For any @xmath we have @xmath . Lemma 3.4.14 implies that @xmath .
Since @xmath by Lemma 3.4.8 , we have @xmath and thus @xmath . For (2),
suppose that @xmath . By Lemma 3.4.15 there is @xmath such that @xmath .
Lemma 3.4.14 implies that @xmath . Hence @xmath and thus @xmath . If
@xmath then @xmath . So @xmath . ∎

## Chapter 4 Analysis of the core

In this chapter we establish the existence of a strongly continuous
group action @xmath of @xmath on @xmath . We call @xmath the gauge
action. Averaging over @xmath gives a faithful conditional expectation
of @xmath onto the fixed point algebra for @xmath , which we call the
core. We show that the core @xmath is the closed linear span of elements
of the form @xmath where @xmath . We show that @xmath is AF. If @xmath
is a relative Cuntz-Krieger @xmath -family, we provide conditions under
which

  -- -- --
        
  -- -- --

If @xmath and there is an action @xmath such that @xmath is equivariant
for @xmath and @xmath , we show that @xmath is injective. This
generalisation of an Huef and Raeburn’s gauge-invariant uniqueness
theorem is the main result of the chapter.

### 4.1 Group actions and faithful conditional expectations

This section presents standard results associated to groups actions and
faithful conditional expectations. These results may be recovered,
somewhat nontrivially, from [ 4 ] . Many can also be found in [ 21 ] .
For the most part, we do not give proofs, but just recall the results we
will need later.

###### Definition 4.1.1.

Let @xmath be a @xmath -algebra and let @xmath a compact abelian group.
A group action is a homomorphism

  -- -------- -------- --
     @xmath   @xmath   
  -- -------- -------- --

that is strongly continuous; that is, whenever @xmath as @xmath in
@xmath we have @xmath as @xmath in @xmath for each @xmath .

###### Definition 4.1.2.

Let @xmath be a @xmath -algebra and let @xmath a compact abelian group.
We write @xmath for the dual group of @xmath ; that is, the group of
homomorphisms @xmath with pointwise multiplication. We define

  -- -------- --
     @xmath   
  -- -------- --

and for @xmath we define

  -- -------- --
     @xmath   
  -- -------- --

Note that @xmath where @xmath is given by @xmath for all @xmath .

###### Lemma 4.1.3.

Let @xmath be a @xmath -algebra, let @xmath a compact abelian group and
let @xmath be a group action. Then:

1.  @xmath is a closed subspace for each @xmath ;

2.  @xmath is a @xmath -subalgebra of @xmath ;

3.  @xmath ; and

4.  @xmath for all @xmath .

###### Definition 4.1.4.

Let @xmath be a @xmath -algebra and let @xmath be a @xmath -subalgebra
of @xmath . A map @xmath is called a faithful conditional expectation
if:

1.  @xmath is linear;

2.  @xmath is bounded with @xmath ;

3.  @xmath ; and

4.  @xmath .

###### Lemma 4.1.5.

Let @xmath and @xmath be @xmath -algebras and let @xmath be a
homomorphism. Let @xmath and @xmath be @xmath -subalgebras of @xmath and
@xmath respectively. Suppose there are a faithful conditional
expectation @xmath and a linear map @xmath such that the diagram

[]

commutes. Then @xmath is injective if and only if @xmath is injective.

###### Proof.

Let @xmath . If @xmath is injective then so is @xmath . Suppose @xmath
is injective. Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

As @xmath is linear it follows that @xmath is injective. ∎

###### Lemma 4.1.6.

Let @xmath be a @xmath -algebra, let @xmath a compact abelian group and
let @xmath be a group action. Let @xmath denote the normalised Haar
measure on @xmath . Then @xmath given by

  -- -------- --
     @xmath   
  -- -------- --

is a faithful conditional expectation onto @xmath . Moreover,

  -- -------- --
     @xmath   
  -- -------- --

### 4.2 The gauge action

This section establishes the existence of the gauge action. We show that
the gauge action is strongly continuous and study its fixed point
algebra. We study properties of the faithful conditional expectation
obtained by averaging over the gauge action.

Let @xmath be a finitely aligned @xmath -graph. For @xmath and @xmath ,
define

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma 4.2.1.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a subset of @xmath . Fix @xmath . There is an automorphism
@xmath of @xmath such that @xmath for all @xmath

###### Proof.

We show that

  -- -------- -- -------
     @xmath      (4.1)
  -- -------- -- -------

is a Cuntz-Krieger @xmath -family in @xmath . Theorem 3.3.7 will then
imply that there is a homomorphism @xmath such that @xmath for all
@xmath . Then we show that @xmath so that @xmath is an automorphism.

First we show (TCK1). Fix @xmath . Since @xmath , we have @xmath . So
(TCK1) for @xmath follows from (TCK1) for @xmath .

For each @xmath , @xmath and @xmath . So (TCK3), (TCK4) and (CK) for
@xmath follows from (TCK3), (TCK4) and (CK) for @xmath . So it remains
to show (TCK2). Fix @xmath such that @xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

which establishes (TCK2). So @xmath is a Cuntz-Krieger @xmath -family in
@xmath .

By Theorem 3.3.7 there is a homomorphism @xmath such that @xmath for all
@xmath . Fix @xmath . We have

  -- -------- -------- --
     @xmath            
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

By Theorem 3.3.7 the collection @xmath generates @xmath . Since @xmath
is a homomorphism, we have @xmath . The same calculation but with @xmath
replaced with @xmath gives @xmath . So @xmath is an automorphism. ∎

###### Lemma 4.2.2.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a subset of @xmath . Then @xmath is a homomorphism from @xmath
to @xmath . This homomorphism is strongly continuous in the sense that
if @xmath as @xmath in @xmath then @xmath as @xmath in @xmath for every
@xmath . The map @xmath is called the gauge action.

###### Proof.

First we show that @xmath is a homomorphism from @xmath to @xmath . For
each @xmath , Lemma 4.2.1 implies that @xmath is an automorphism. So it
suffices to show that @xmath is a homomorphism. To see this, fix @xmath
and @xmath . Since @xmath and @xmath are homomorphisms we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Since @xmath and @xmath are homomorphisms, we deduce that @xmath is a
homomorphism.

We will now show that this homomorphism is strongly continuous. Fix
@xmath , @xmath , @xmath and a sequence @xmath in @xmath such that
@xmath as @xmath . The case where @xmath is trivial since @xmath for all
@xmath , so we assume that @xmath . Since

  -- -------- --
     @xmath   
  -- -------- --

there is nonempty and finite @xmath and @xmath with @xmath where @xmath
for all @xmath . Now

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

For @xmath , the map @xmath is continuous for each @xmath . Hence @xmath
as @xmath in @xmath . So for each @xmath , there is @xmath such that if
@xmath then @xmath . So whenever @xmath , the above calculation shows
that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Since homomorphisms of @xmath -algebras are norm decreasing, when we
have @xmath

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

So @xmath as @xmath in @xmath for every @xmath . ∎

###### Lemma 4.2.3.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a subset of @xmath . Let @xmath be a relative Cuntz-Krieger
@xmath -family generating a @xmath -algebra @xmath . Suppose that there
is an action @xmath such that @xmath for all @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We claim that

  -- -------- -- -------
     @xmath      (4.2)
  -- -------- -- -------

for all @xmath , where @xmath denotes the Kronecker delta function.
Recall that each @xmath determines a character @xmath by @xmath for each
@xmath : in fact, @xmath is isomorphism, although we do not need this.
Fix @xmath . If @xmath , then @xmath . Now suppose @xmath . There exists
@xmath such that @xmath . Fix @xmath such that @xmath , and define
@xmath by @xmath and @xmath for @xmath . Then @xmath , demonstrating
that @xmath . To show ( 4.2 ), it now suffices by Lemma 4.1.6 to show
that @xmath for each @xmath . For this, we calculate

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

establishing ( 4.2 ). Lemma 4.1.6 implies that @xmath . This, together
with ( 4.2 ), gives

  -- -------- -------- -------- --
     @xmath   @xmath            
              @xmath            
              @xmath   @xmath   
  -- -------- -------- -------- --

###### Definition 4.2.4.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Applying Lemma 4.2.3 to the gauge-action @xmath on @xmath we
obtain

  -- -------- --
     @xmath   
  -- -------- --

we call this the core of @xmath

###### Proposition 4.2.5.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Let @xmath be the gauge action. Suppose that @xmath is a
relative Cuntz-Krieger @xmath -family in a @xmath -algebra @xmath and
that there exists a group action @xmath such that @xmath for all @xmath
and @xmath . Write @xmath for the homomorphism @xmath given by the
universal property. If @xmath is injective then @xmath is injective.

###### Proof.

By Lemma 4.1.6 there are faithful conditional expectations @xmath and
@xmath . By Lemma 4.2.3 , @xmath and @xmath satisfy

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

If @xmath satisfy @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

So @xmath restricts to a homomorphism from @xmath to @xmath by linearity
and continuity. We have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

So @xmath on the spanning elements of @xmath and hence on all of @xmath
. Thus, the diagram

[]

commutes. Lemma 4.1.5 implies that if @xmath is injective then @xmath is
injective. ∎

### 4.3 Orthogonalising range projections

We want to establish conditions under which the canonical homomorphism
@xmath determined by a relative Cuntz-Krieger @xmath -family @xmath
restricts to an isomorphism of the core. Our strategy is to show that
@xmath is an increasing union of finite-dimensional subalgebras. To find
matrix units for these finite dimensional subalgebras, we first
“orthogonalise” the generators of @xmath . We begin by concentrating on
the “diagonal” subalgebra @xmath .

###### Definition 4.3.1.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Suppose that @xmath
is a finite subset of @xmath . For @xmath , we define

  -- -------- --
     @xmath   
  -- -------- --

###### Remark 4.3.2.

1.   Lemma 3.1.3  (2) shows that for a finite set @xmath , the product
    @xmath is both well-defined and a projection for each @xmath .

2.   By convention, when a formal product in a @xmath -algebra @xmath is
    indexed by the empty set, it is taken to be equal to the unit of the
    multiplier algebra of @xmath . In particular, if @xmath is such that
    there exists no @xmath with @xmath , then @xmath

###### Definition 4.3.3.

Let @xmath be a finitely aligned @xmath -graph. A subset @xmath of
@xmath is said to be closed under minimal common extensions if

  -- -------- --
     @xmath   
  -- -------- --

The main result of this section is the following Proposition.

###### Proposition 4.3.4 (cf. [16], Proposition 3.5).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be a
finite subset of @xmath that is closed under minimal common extensions.
Then @xmath is a collection of mutually orthogonal (possibly zero)
projections such that

  -- -------- -- -------
     @xmath      (4.3)
  -- -------- -- -------

for each @xmath

In order to prove Proposition 4.3.4 we reduce to the case where @xmath
for some @xmath , and @xmath contains @xmath .

###### Lemma 4.3.5.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath . Suppose
that @xmath is a finite subset of @xmath , that @xmath and that @xmath
is closed under minimal common extensions. Then @xmath is a collection
of mutually orthogonal (possibly zero) projections such that

  -- -------- -- -------
     @xmath      (4.4)
  -- -------- -- -------

Using Lemma 4.3.5 we prove Proposition 4.3.4 .

###### Proof of Proposition 4.3.4.

The following argument is taken from the work of Raeburn, Sims and Yeend
in [ 16 ] . The difference here being that we must account for the
2-cocycle, but it turns out that this plays little rôle.

Remark 4.3.2 shows that @xmath is projection for each @xmath . Then
since each @xmath is a projection for each @xmath , equation ( 4.4 )
shows that they are mutually orthogonal. So we are left to prove ( 4.3
).

First, suppose that @xmath is closed under minimal common extensions.
The case where @xmath is exactly Lemma 4.3.5 , so suppose that @xmath .
We must show that @xmath satisfies ( 4.3 ). Let @xmath . Since @xmath
for each @xmath , the set @xmath is closed under minimal common
extensions, contains @xmath and is a subset of @xmath . Hence Lemma
4.3.5 gives

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Now suppose @xmath is finite and closed under minimal common extensions.
Fix @xmath . We will show that @xmath and @xmath satisfy ( 4.3 ). Notice
that for all @xmath with @xmath ,

  -- -------- -- -------
     @xmath      (4.5)
  -- -------- -- -------

Let @xmath . Then @xmath is finite and if @xmath then @xmath ; that is,
@xmath is closed under minimal common extensions. It follows from ( 4.5
) and the previously considered special case that

  -- -------- -------- -------- --
     @xmath   @xmath            
              @xmath   @xmath   
  -- -------- -------- -------- --

The rest of this section is devoted to establishing Lemma 4.3.5 . We
therefore fix, for the duration of this section, a finitely aligned
@xmath -graph @xmath ; a 2-cocycle @xmath ; a Toeplitz-Cuntz-Krieger
@xmath -family @xmath ; @xmath ; and a finite subset @xmath of @xmath .

###### Definition 4.3.6.

Given @xmath , we define

  -- -------- --
     @xmath   
  -- -------- --

and @xmath .

The next two Lemmas are from [ 14 ] .

###### Lemma 4.3.7 ([14], Lemma 8.4).

If @xmath then:

1.  @xmath ;

2.  @xmath is finite;

3.  @xmath implies that @xmath ; and

4.  @xmath implies that @xmath .

###### Lemma 4.3.8 ([14], Lemma 8.7).

Suppose that @xmath , @xmath and @xmath . Then for each @xmath , there
exists a unique @xmath such that

1.  @xmath and @xmath ; and

2.  @xmath and @xmath imply @xmath .

Furthermore, @xmath for each @xmath .

###### Lemma 4.3.9 ([14], Lemma 8.8).

Suppose that @xmath , @xmath and @xmath . Let @xmath and @xmath be the
maximal subpath of @xmath provided by Lemma 4.3.8 . Then

  -- -------- -- -------
     @xmath      (4.6)
  -- -------- -- -------

###### Proof.

First we show that @xmath Since @xmath , we have @xmath . Hence

  -- -------- --
     @xmath   
  -- -------- --

We will show that @xmath whenever @xmath with @xmath . Fix @xmath with
@xmath . Then

  -- -------- -------- -- -------
     @xmath   @xmath      
              @xmath      
              @xmath      
              @xmath      (4.7)
  -- -------- -------- -- -------

Now suppose that @xmath . We claim @xmath and @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

and so Lemma 4.3.8 (2) shows that @xmath Hence @xmath , so @xmath . We
have @xmath and @xmath by assumption, so @xmath by Lemma 4.3.7 (4).
Establishing our claim. Thus, each term in ( 4.7 ) is a factor in @xmath
, so

  -- -------- --
     @xmath   
  -- -------- --

Next we show that if @xmath with @xmath , then @xmath Fix @xmath with
@xmath . The last statement in Lemma 4.3.8 implies that @xmath and
@xmath . Since @xmath we have @xmath , and so @xmath . Since @xmath ,
Lemma 4.3.8 (2) implies that @xmath . Hence @xmath for some @xmath with
@xmath . Since @xmath , we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

which vanishes since @xmath .

Since @xmath and @xmath with @xmath implies that @xmath , we have

  -- -------- -------- -------- --
     @xmath   @xmath            
              @xmath            
              @xmath   @xmath   
  -- -------- -------- -------- --

###### Proof of Lemma 4.3.5.

Fix @xmath and finite @xmath that is closed under minimal common
extensions. Suppose that @xmath . As @xmath is closed under minimal
common extensions, induction on @xmath shows that @xmath implies that
@xmath . Hence @xmath . Lemma 4.3.7 (1) implies that @xmath . Therefore
it suffices to show that @xmath for all @xmath , and that @xmath .

Fix @xmath with @xmath . Suppose that @xmath . We @xmath and @xmath .
Lemma 3.1.3 (2) implies that @xmath . Lemma 3.1.3 (6) implies that
@xmath , giving @xmath .

Now suppose that @xmath . Then @xmath is strictly larger than one of
@xmath or @xmath ; say @xmath . Hence @xmath implies that @xmath and
@xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
                       
              @xmath   
  -- -------- -------- --

It remains to show that @xmath . We proceed by induction on @xmath .
Suppose that @xmath . Since @xmath , we have @xmath . We have @xmath ,
giving the base case.

Now suppose that @xmath and that the result holds whenever @xmath Since
@xmath , there exists @xmath . Set @xmath . Fix @xmath . We have

  -- -------- -------- -- -------
     @xmath   @xmath      
              @xmath      (4.8)
  -- -------- -------- -- -------

Suppose that @xmath and @xmath . Lemma 4.3.8 (2) ensures that @xmath for
some @xmath with @xmath . Since @xmath , the projection @xmath is a
factor in @xmath . Since @xmath , we have @xmath Equation ( 4.8 ) then
implies that

  -- -------- -- -------
     @xmath      (4.9)
  -- -------- -- -------

Lemma 4.3.8 ensures that if @xmath , then @xmath ; in particular, when
@xmath , we have @xmath . Hence if @xmath satisfy @xmath , then @xmath .
Lemma 3.1.3 (6) implies that @xmath . So

  -- -------- --
     @xmath   
  -- -------- --

Equation ( 4.9 ) implies that for all @xmath , we have

  -- -------- -- --------
     @xmath      (4.10)
  -- -------- -- --------

Substituting ( 4.10 ) for those terms in @xmath for which @xmath belongs
to @xmath , we obtain

  -- -------- -------- -- --------
     @xmath   @xmath      
              @xmath      (4.11)
  -- -------- -------- -- --------

Lemma 4.3.8 ensures that for @xmath , the path @xmath is uniquely
determined by @xmath . Hence we can rewrite  ( 4.11 ) as

  -- -------- --
     @xmath   
  -- -------- --

Lemma 4.3.9 allows us to replace each @xmath with @xmath , yielding

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

By the inductive hypothesis, we have @xmath . ∎

###### Corollary 4.3.10 ([16], Corollary 3.7).

If @xmath is closed under minimal common extensions then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Let @xmath . By Proposition 4.3.4 , we have

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath implies that @xmath , we need only show that:

1.  @xmath ; and

2.  @xmath for all @xmath .

Since @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

This establishes (1).

For (2), fix @xmath . If @xmath , then @xmath , by (TCK4). If @xmath ,
then @xmath , and

  -- -------- -------- -- --------
     @xmath   @xmath      
              @xmath      (4.12)
  -- -------- -------- -- --------

Fix @xmath . Since @xmath is closed under minimal common extensions, we
have @xmath and, since @xmath , @xmath . Hence

  -- -------- --
     @xmath   
  -- -------- --

Applying this to each term in ( 4.12 ) gives (2). ∎

### 4.4 Matrix units for the core

Let @xmath be a relative Cuntz-Krieger @xmath -family. For each finite
@xmath , we identify a finite-dimensional subalgebra @xmath of @xmath We
describe matrix units for @xmath .

Lemma 4.4.1 and Corollary 4.4.2 can be deduced from Appendix A of [ 13 ]
.

###### Lemma 4.4.1.

Let @xmath be a @xmath -algebra. Let @xmath a finite set. Suppose that
@xmath satisfies:

1.  @xmath for all @xmath ; and

2.  @xmath for all @xmath .

Suppose that @xmath for each @xmath . Then @xmath is a @xmath
-subalgebra of @xmath that is universal in the sense that if @xmath is a
@xmath -algebra and @xmath satisfies @xmath and @xmath then there exists
a homomorphism @xmath such that @xmath .

If @xmath satisfy (M1) and (M2), we call the @xmath a matrix units.

###### Corollary 4.4.2.

Let @xmath and @xmath be @xmath -algebras. Let @xmath be a finite set.
Suppose that @xmath and @xmath both satisfy @xmath and @xmath . If
@xmath and @xmath for all @xmath , then there is an isomorphism

  -- -------- --
     @xmath   
  -- -------- --

taking @xmath to @xmath for each @xmath .

Let @xmath be a finite set. Let @xmath . For @xmath , define @xmath by
@xmath and @xmath . These operations mimic the usual adjoint and
multiplication of matrices. Each @xmath determines a linear map @xmath
by

  -- -------- --
     @xmath   
  -- -------- --

Define @xmath to be the operator norm of @xmath with respect to the
@xmath norm on @xmath . With this norm @xmath becomes a @xmath -algebra.
For each @xmath , define @xmath by @xmath for all @xmath , where @xmath
denotes the Kronecker delta. Then @xmath is a collection of nonzero
matrix units and @xmath . Corollary 4.4.2 implies that if @xmath is a
collection of nonzero matrix units in a @xmath -algebra @xmath , then
@xmath .

###### Definition 4.4.3.

Let @xmath be a finitely aligned @xmath -graph. For a subset @xmath of
@xmath we define

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Given a finite @xmath
, we show there is a finite @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

is closed under multiplication, and hence is a finite-dimensional @xmath
-subalgebra of

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma 4.4.4 ([16], Lemma 3.2).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite.
There exists a finite set @xmath that contains @xmath and satisfies

  -- -------- -- --------
     @xmath      (4.13)
  -- -------- -- --------

Moreover, for any finite @xmath that contains @xmath and satisfies (
4.13 ),

  -- -------- --
     @xmath   
  -- -------- --

is a finite-dimensional @xmath -subalgebra of @xmath .

###### Proof.

The first statement is the first statement of Lemma 3.2 in [ 16 ] . For
the second statement, suppose that @xmath is finite contains @xmath and
satisfies ( 4.13 ). Then @xmath is a finite-dimensional, and hence
norm-closed, subspace of @xmath , which is closed under adjoints. It
remains to show that @xmath is closed under multiplication. Let @xmath
and @xmath be generators of @xmath . Then @xmath and @xmath . By Lemma
3.1.3 part (4) we have

  -- -------- --
     @xmath   
  -- -------- --

As @xmath satisfies ( 4.13 ) we have @xmath for each @xmath and hence
@xmath . The result then follows since multiplication is bilinear. ∎

The intersection of all sets containing @xmath and satisfying ( 4.13 )
also contains @xmath and satisfies ( 4.13 ), and so we make the
following definition.

###### Definition 4.4.5.

Let @xmath be a finitely aligned @xmath -graph. Let @xmath be finite.
Define

  -- -------- --
     @xmath   
  -- -------- --

The following properties of @xmath will be important.

###### Lemma 4.4.6 ([16], Remark 3.4).

Let @xmath be a finitely aligned @xmath -graph. Let @xmath be finite.
Then

1.  @xmath is finite;

2.   for @xmath with @xmath and @xmath , and for all @xmath ,

      -- -------- --
         @xmath   
      -- -------- --

3.  @xmath is closed under minimal common extensions.

###### Proof.

For (1), the set @xmath is an intersection of finite sets and hence is
finite itself. For (2), the “if” direction follows from ( 4.13 ) with
@xmath , @xmath , and @xmath . The “only if” directions follows from (
4.13 ) with @xmath , @xmath , and @xmath . For (3), suppose that @xmath
and that @xmath . Then ( 4.13 ) with @xmath and @xmath gives @xmath ;
that is, @xmath is closed under minimal common extensions. ∎

###### Definition 4.4.7.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be a
finite subset of @xmath . For @xmath , define

  -- -------- --
     @xmath   
  -- -------- --

###### Proposition 4.4.8 (cf. [16], Proposition 3.9).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be a
finite subset of @xmath . The set

  -- -------- --
     @xmath   
  -- -------- --

is a collection of matrix units for @xmath .

Before we prove Proposition 4.4.8 we need the following Lemma.

###### Lemma 4.4.9 (cf. [16], Lemma 3.10 and 3.11).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be a
finite subset of @xmath . If @xmath then:

  -- -------- -------- -- --------
     @xmath   @xmath      (4.14)
     @xmath   @xmath      (4.15)
  -- -------- -------- -- --------

###### Proof.

For equation ( 4.14 ) we calculate

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

This establishes the first equality. For the second equality in equation
( 4.14 ), we continue to calculate

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

For equation ( 4.15 ) we calculate

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

For each @xmath we have @xmath , since @xmath . So

  -- -------- -------- -------- --
     @xmath   @xmath            
              @xmath            
              @xmath            
              @xmath            
              @xmath            
              @xmath   @xmath   
  -- -------- -------- -------- --

###### Proof of Proposition 4.4.8.

By equation ( 4.15 ) the @xmath span @xmath . Fix @xmath . We need to
show that

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath is a projection we have

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- -------- -------- --
     @xmath   @xmath            
              @xmath            
              @xmath            
              @xmath            
              @xmath            
              @xmath   @xmath   
  -- -------- -------- -------- --

###### Proposition 4.4.10 (cf. [16], Proposition 3.13).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite.
Suppose that @xmath for every @xmath and suppose that @xmath . If @xmath
is not exhaustive, then @xmath . Otherwise, if @xmath is exhaustive,
then @xmath if and only if

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

First suppose that @xmath for every @xmath , @xmath and that @xmath is
not exhaustive. There exists @xmath such that @xmath for all @xmath . So
for each @xmath we have,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Hence

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Since @xmath by Lemma 3.1.3 (7), we have @xmath . Since the 2-cocycle
takes values in the unit circle, we have @xmath .

Now suppose that @xmath is exhaustive. By Lemma 4.4.9 we have

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

and the final assertion follows. ∎

### 4.5 Isomorphisms of the core

In this section we show how each finite-dimensional subalgebra @xmath
decomposes into a direct sum of matrix algebras. For @xmath , we write
down the inclusion map @xmath . If @xmath is a relative Cuntz-Krieger
@xmath -family and @xmath is a relative Cuntz-Krieger @xmath -family, we
provide conditions under which

  -- -------- --
     @xmath   
  -- -------- --

###### Definition 4.5.1 ([20], Definition 3.6.1).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite
and suppose that @xmath and that @xmath are such that @xmath . Define
@xmath to be the subalgebra

  -- -------- --
     @xmath   
  -- -------- --

of @xmath . Define @xmath to be the set

  -- -------- --
     @xmath   
  -- -------- --

of nontrivial tails which extend paths in @xmath to larger elements of
@xmath .

###### Lemma 4.5.2 ([20], Lemma 3.6.2).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite.
Then

  -- -------- --
     @xmath   
  -- -------- --

For fixed @xmath and @xmath ,

  -- -------- -- --------
     @xmath      (4.16)
  -- -------- -- --------

###### Proof.

Suppose that @xmath . Then @xmath and @xmath and so @xmath . Also @xmath
whenever @xmath or @xmath . Hence each of the spanning elements @xmath
of @xmath belong to exactly one of the matrix algebras @xmath . Suppose
that @xmath , say @xmath , @xmath and @xmath , @xmath . If

  -- -------- --
     @xmath   
  -- -------- --

then @xmath by Proposition 4.4.8 , and hence @xmath and @xmath . So if
@xmath or @xmath then @xmath Hence

  -- -------- --
     @xmath   
  -- -------- --

We will now prove ( 4.16 ). Fix @xmath and @xmath . Suppose that

  -- -------- --
     @xmath   
  -- -------- --

Then Proposition 4.4.10 implies that @xmath for all @xmath . Hence
@xmath . Now suppose that

  -- -------- --
     @xmath   
  -- -------- --

Then Proposition 4.4.8 and Proposition 4.4.10 imply that

  -- -------- --
     @xmath   
  -- -------- --

is family of nonzero matrix units which span @xmath . Lemma 4.4.1
therefore implies that @xmath . ∎

###### Lemma 4.5.3 (cf. Lemma 3.6.3, [20]).

Let @xmath be a finitely aligned @xmath -graph, and let @xmath be
finite. Suppose that @xmath and that there exists @xmath such that
@xmath . Then there is a unique path @xmath such that:

1.  @xmath ; and

2.   if @xmath and @xmath , then @xmath .

###### Proof.

Let @xmath and let @xmath . Then @xmath because @xmath is closed under
minimal common extensions. We have @xmath by definition. If @xmath and
@xmath , then @xmath by definition. ∎

###### Definition 4.5.4 (cf. [20], Definition 3.6.4).

Let @xmath be a finitely aligned @xmath -graph, and let @xmath be a
finite subset of @xmath . For those @xmath such there exists @xmath for
which @xmath , the path @xmath is defined by Lemma 4.5.3 . For all other
@xmath , we define @xmath . For @xmath , we define @xmath

Lemma 4.5.3 and Definition 4.5.4 are similar to Lemma 3.6.3 and
Definition 3.6.4 in [ 20 ] . The difference is that here @xmath is
defined for all @xmath , whereas in [ 20 ] it is only defined for @xmath
where @xmath is finite and @xmath . That @xmath is defined for all
@xmath is crucial in the statement of Proposition 4.5.11 and in the
proof of Lemma 4.5.12 .

###### Lemma 4.5.5 (cf. [20], Lemma 3.6.5).

Let @xmath be a finitely aligned @xmath -graph, and let @xmath be finite
with @xmath . Suppose that @xmath , that @xmath and that @xmath . Then
@xmath and @xmath .

###### Proof.

Since @xmath , we have @xmath by Lemma 4.4.6 (2). Suppose for
contradiction that @xmath . Since @xmath and @xmath , Lemma 4.5.3 (2)
ensures that @xmath for some @xmath . Lemma 4.4.6 (2) implies that
@xmath . Since @xmath , we have @xmath Since @xmath , we have @xmath ,
and the factorisation property implies that @xmath for some @xmath .
Another application of the factorisation property gives @xmath . We have
shown that @xmath , that @xmath , and that @xmath . This contradicts
Lemma 4.5.3 (2). ∎

###### Lemma 4.5.6 (cf. [20], Lemma 3.6.6).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite
with @xmath . Then for each @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We first show that

  -- -------- -- --------
     @xmath      (4.17)
  -- -------- -- --------

First suppose that @xmath . We consider two cases:

Case 1: suppose that @xmath . Then @xmath implies that @xmath . For each
@xmath , @xmath is a factor in @xmath . Hence

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Case 2: suppose that @xmath . Since @xmath , Lemma 4.5.3 (2) implies
that @xmath where @xmath . In particular @xmath , and so

  -- -------- --
     @xmath   
  -- -------- --

As @xmath is an initial segment of @xmath , we have @xmath . So (TCK4)
gives

  -- -------- --
     @xmath   
  -- -------- --

We have established that @xmath implies that @xmath . Now suppose that
@xmath . Then

  -- -------- -- --------
     @xmath      (4.18)
  -- -------- -- --------

Suppose that @xmath with @xmath . Since @xmath , the maximality of
@xmath implies that @xmath . So @xmath implies that @xmath . Fix @xmath
. Then @xmath is a factor @xmath . Hence @xmath . Since @xmath , we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Since @xmath , we conclude that @xmath . Applying this to each factor on
the right-hand side of ( 4.18 ) gives @xmath . We have established (
4.17 ).

Fix @xmath . We have @xmath . An application of Corollary 4.3.10 gives

  -- -------- --
     @xmath   
  -- -------- --

Applying ( 4.17 ) to each term in this sum gives

  -- -------- -- --------
     @xmath      (4.19)
  -- -------- -- --------

Fix @xmath with @xmath . Since @xmath ,

  -- -------- -------- -------- --
     @xmath   @xmath            
              @xmath            
              @xmath            
              @xmath   @xmath   
  -- -------- -------- -------- --

###### Definition 4.5.7 ([20], Definition 3.6.7).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite
with @xmath . Suppose that @xmath and that @xmath are such that @xmath
is nontrivial. We define

  -- -------- --
     @xmath   
  -- -------- --

For @xmath , we write @xmath for @xmath for convenience.

###### Corollary 4.5.8 (cf. [20], Corollary 3.6.8).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite
with @xmath . The inclusion map @xmath is given by

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

The result is a direct consequence of Lemma 4.5.2 and Lemma 4.5.6 . ∎

###### Theorem 4.5.9.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath be a subset of @xmath . Suppose that @xmath is a relative
Cuntz-Krieger @xmath -family and that @xmath is a relative Cuntz-Krieger
@xmath -family. Suppose that

1.  @xmath and @xmath for all @xmath , and that

2.  @xmath .

Then there is an isomorphism @xmath satisfying @xmath for all @xmath .
If @xmath , then @xmath for all @xmath with @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

Before proving Theorem 4.5.9 , we need to establish several technical
results.

###### Lemma 4.5.10.

Let @xmath be a finite set. Let @xmath be a set of matrix units in a
@xmath -algebra @xmath . Let @xmath satisfy:

1.  @xmath for all @xmath ; and

2.  @xmath for all @xmath .

Then @xmath is a collection of matrix units and

  -- -------- --
     @xmath   
  -- -------- --

Moreover, if @xmath satisfies properties @xmath and @xmath , then @xmath
defined by @xmath for all @xmath also satisfies @xmath and @xmath .

###### Proof.

Fix @xmath . We show that @xmath and @xmath . This shows @xmath and
@xmath . Firstly, (T1) and then (M1) imply that

  -- -------- -------- --
     @xmath   @xmath   
  -- -------- -------- --

and secondly, (M2) and then (T2) give

  -- -------- -------- --
     @xmath   @xmath   
  -- -------- -------- --

So @xmath is a collection of matrix units. It is clear that

  -- -------- --
     @xmath   
  -- -------- --

since @xmath takes values in the circle. For the final statement, let
@xmath satisfy @xmath and @xmath . Then for @xmath we have,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

and

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

So @xmath satisfies (T1) and (T2). ∎

###### Proposition 4.5.11.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath be a Toeplitz-Cuntz-Krieger @xmath -family. Let @xmath be finite
with @xmath , @xmath and let @xmath . Then @xmath defined by

  -- -------- --
     @xmath   
  -- -------- --

satisfy @xmath and @xmath . If @xmath satisfies @xmath and @xmath then

  -- -------- --
     @xmath   
  -- -------- --

is a collection of matrix units which span @xmath .

###### Proof.

For @xmath , the calculations

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

show that @xmath satisfies (T1) and (T2). A similar calculation shows
that @xmath also satisfies (T1) and (T2). By Proposition 4.4.8

  -- -------- --
     @xmath   
  -- -------- --

is a collection of matrix units which span @xmath . The last statement
is then a direct consequence of Lemma 4.5.10 . ∎

Since @xmath is countable, we can write @xmath . Put @xmath . Then
@xmath for each @xmath and @xmath . So there exists a family @xmath of
finite subsets of @xmath such that @xmath for each @xmath and @xmath .

###### Lemma 4.5.12.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath be a subset of @xmath . Let @xmath be a relative Cuntz-Krieger
@xmath -family and let @xmath be a relative Cuntz-Krieger @xmath -family
such that:

1.  @xmath and @xmath for all @xmath ; and

2.  @xmath .

Fix a family @xmath of finite subsets of @xmath such that @xmath for
each @xmath and @xmath . For each @xmath and each @xmath , let @xmath
and let @xmath as in Definition 4.5.4 . Define @xmath by

  -- -------- -- --------
     @xmath      (4.20)
  -- -------- -- --------

for all @xmath . For each @xmath define @xmath by

  -- -------- -- --------
     @xmath      (4.21)
  -- -------- -- --------

for all @xmath . Then for each @xmath there is a unique isomorphism
@xmath satisfying

  -- -------- -- --------
     @xmath      (4.22)
  -- -------- -- --------

for each @xmath . The diagram

  -- -- --
        
  -- -- --

commutes, where the inclusion maps @xmath and @xmath for @xmath are
given by Lemma 4.5.8 .

###### Proof.

We claim that @xmath satisfies (T1) and (T2) for each @xmath . We
proceed by induction. The map @xmath satisfies (T1) and (T2) because
@xmath for each @xmath . Suppose that @xmath satisfies (T1) and (T2).
Then

  -- -------- --
     @xmath   
  -- -------- --

Proposition 4.5.11 implies that @xmath also satisfies (T1) and (T2).

We will now construct the maps @xmath . Fix @xmath . By Lemma 4.5.2 we
have

  -- -------- --
     @xmath   
  -- -------- --

where each @xmath is spanned by the elements

  -- -------- --
     @xmath   
  -- -------- --

The same holds for the family @xmath . Hence there is at most one linear
map @xmath satisfying ( 4.22 ).

Fix @xmath and @xmath . We claim @xmath if and only if @xmath . We
consider the three cases:

1.  @xmath

2.  @xmath ; and

3.  @xmath .

For case (1), suppose that @xmath . Then @xmath and @xmath by (CK) and
Lemma 3.4.8 . For (2), suppose that @xmath . Then @xmath and @xmath by
hypothesis. For case (3), suppose that @xmath . Since @xmath by
definition, and since @xmath , Lemma 3.4.2 implies that both @xmath and
@xmath are nonzero.

Lemma 4.5.2 implies that @xmath if @xmath and @xmath if @xmath . It
follows from Proposition 4.5.11 that whenever @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

are collections of nonzero matrix units which span @xmath and @xmath
respectively. By Corollary 4.4.2 there is an isomorphism @xmath taking
@xmath for each @xmath such that @xmath . For each @xmath with @xmath ,
@xmath is an isomorphism. Define

  -- -------- -- --------
     @xmath      (4.23)
  -- -------- -- --------

We now check that for each @xmath the diagram

  -- -- --
        
  -- -- --

commutes so that the diagram ( 4.5.12 ) commutes. Fix @xmath and @xmath
. Applying the inclusion map given by Lemma 4.5.6 we have

  -- -------- --
     @xmath   
  -- -------- --

By definition of @xmath , we have @xmath implies that @xmath and @xmath
. Then Lemma 4.5.5 implies that @xmath and @xmath . Using ( 4.23 ), we
have

  -- -------- --
     @xmath   
  -- -------- --

Since each @xmath takes @xmath to @xmath whenever @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

Applying ( 4.21 ) gives

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

We continue,

  -- -------- -------- -------- --
     @xmath   @xmath            
              @xmath            
              @xmath   @xmath   
  -- -------- -------- -------- --

###### Proof of Theorem 4.5.9.

Pick a family @xmath of finite subsets of @xmath such that @xmath for
each @xmath and @xmath . By Lemma 4.4.4 we have

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

For each @xmath , let @xmath be the isomorphism given by Lemma 4.5.12 ,
which satisfies @xmath for each @xmath . Since the diagram ( 4.5.12 )
commutes, there is a well-defined homomorphism @xmath such that @xmath .
As each @xmath is injective on the @xmath -algebra @xmath , each @xmath
isometric. Hence @xmath is isometric on @xmath . By continuity @xmath
extends to an isometric homomorphism on @xmath . Since @xmath is a
homomorphism between the @xmath -algebras @xmath and @xmath , the image
@xmath is closed. Since @xmath is dense in @xmath , the homomorphism
@xmath surjective and hence an isomorphism.

We claim that for all @xmath there is @xmath such that

  -- -------- -- --------
     @xmath      (4.24)
  -- -------- -- --------

To see this, fix @xmath . Choose @xmath such that @xmath . By ( 4.15 )
we have

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

as claimed. Now fix @xmath . Condition (T1) of Lemma 4.5.10 implies that
@xmath for all @xmath . Hence equation ( 4.24 ) implies that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Fix @xmath and suppose that @xmath . Then @xmath for all @xmath .
Hence ( 4.24 ) gives

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

By Theorem 3.4.16 , we have @xmath ∎

### 4.6 The gauge-invariant uniqueness theorem

We state the main result of this chapter.

###### Theorem 4.6.1 (an Huef and Raeburn’s gauge-invariant uniqueness
theorem).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Suppose that @xmath is a relative Cuntz-Krieger @xmath -family.
The homomorphism

  -- -------- --
     @xmath   
  -- -------- --

satisfying @xmath for all @xmath is injective on @xmath if and only if

1.  @xmath for each @xmath ; and

2.  @xmath for all @xmath .

Furthermore, @xmath is injective on @xmath if and only if both (1) and
(2) hold and additionally,

1.   there exists a group action @xmath satisfying @xmath for all @xmath
    .

###### Proof.

Suppose that @xmath is injective on @xmath . Then (1) and (2) follow
from Theorem 3.4.16 . Now suppose that (1) and (2) hold. Then Lemma
3.4.8 shows that for @xmath we have @xmath if and only in @xmath . So by
Theorem 3.4.16 we have

  -- -------- --
     @xmath   
  -- -------- --

Theorem 3.4.16 implies that @xmath for each @xmath , and so by Theorem
4.5.9 , @xmath is injective on @xmath .

Now suppose that @xmath is injective on @xmath . Then setting @xmath
establishes (3) and Theorem 3.4.16 implies both (1) and (2). Finally,
suppose that (1), (2) and (3) hold. Then @xmath is injective on @xmath
by the preceding paragraph. It then follows from Proposition 4.2.5 and
(3) that @xmath is injective on @xmath . ∎

###### Corollary 4.6.2.

Let @xmath be a finitely aligned @xmath -graph. Let @xmath be the
Toeplitz-Cuntz-Krieger @xmath -family of Proposition 3.1.7 . Then @xmath
is injective on @xmath .

###### Proof.

Fix @xmath . The calculation @xmath shows that @xmath . We have @xmath
for all @xmath by Lemma 3.4.3 . The result then follows from Theorem
4.6.1 . ∎

## Chapter 5 Gauge-invariant ideals

In this chapter we provide a graph-theoretic description of the
gauge-invariant ideal structure of @xmath .

### 5.1 From ideals to hereditary sets

For each ideal @xmath , we construct a hereditary and relatively
saturated subset @xmath of vertices and a satiated subset @xmath of a
subgraph @xmath .

###### Definition 5.1.1.

Let @xmath be a finitely aligned @xmath -graph. Let @xmath . Define a
relation @xmath on @xmath by @xmath if and only if @xmath .

1.   A set @xmath is hereditary if @xmath , @xmath and @xmath imply
    @xmath .

2.   A set @xmath is saturated relative to @xmath if @xmath and @xmath
    implies that @xmath .

###### Lemma 5.1.2 (cf. [19], Lemma 3.3).

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Suppose that @xmath is an ideal. Define

  -- -------- --
     @xmath   
  -- -------- --

Then @xmath is hereditary and saturated relative to @xmath .

###### Proof.

To see that @xmath is hereditary suppose that @xmath and @xmath with
@xmath . There is @xmath such that @xmath and @xmath . As @xmath , we
have

  -- -------- --
     @xmath   
  -- -------- --

So @xmath is hereditary.

To see that @xmath is saturated relative to @xmath , suppose that @xmath
satisfies @xmath . We will show that @xmath . The set @xmath is finite
and satisfies @xmath by Lemma 4.3.7 . So @xmath by (S1). By Lemma 3.4.8
we have @xmath . As @xmath is closed under minimal common extensions, by
Definition 4.3.6 , it follows from Proposition 4.3.4 that

  -- -------- -- -------
     @xmath      (5.1)
  -- -------- -- -------

Since @xmath is an ideal, it suffices to show that @xmath implies @xmath
. Fix @xmath . Then @xmath for some @xmath and hence @xmath . Since
@xmath is hereditary and @xmath , it follows that @xmath . So @xmath
Then

  -- -------- --
     @xmath   
  -- -------- --

belongs to @xmath . Now ( 5.1 ) implies that @xmath . ∎

###### Lemma 5.1.3 ([19], Lemma 4.1).

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath be hereditary. Then @xmath is a finitely aligned @xmath -graph.

###### Proof.

First we check the factorisation property for @xmath . Fix @xmath and
suppose that @xmath . By the factorisation property for @xmath , there
are unique @xmath such that @xmath , @xmath and @xmath . Since @xmath we
have @xmath . As @xmath is hereditary and @xmath we have @xmath . But
@xmath , which implies that @xmath . Hence @xmath has the factorisation
property. To see that the @xmath -graph @xmath is finitely aligned note
that @xmath for all @xmath . ∎

###### Definition 5.1.4.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Let @xmath and @xmath be an ideal. Define

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma 5.1.5.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Suppose that @xmath is hereditary and saturated relative to
@xmath . Then @xmath .

###### Proof.

Suppose that @xmath . Since @xmath , there exists @xmath such that
@xmath and @xmath . We need to show that @xmath . Since @xmath is
saturated relative to @xmath , we have @xmath , which implies that
@xmath . Fix @xmath . We will show that @xmath .

We claim @xmath . If @xmath , then @xmath for some @xmath where @xmath
and @xmath . As @xmath is hereditary and @xmath , we have @xmath . Hence
@xmath , and so @xmath . For the reverse containment, suppose @xmath .
Then @xmath for some @xmath where @xmath and @xmath . As @xmath is
hereditary and @xmath , we have @xmath . Hence @xmath , and so @xmath .

So it suffices to show @xmath . If @xmath , then @xmath , and so @xmath
. So suppose @xmath . By (S2), we have @xmath , and @xmath . Since
@xmath is saturated relative to @xmath and @xmath , we have @xmath ;
that is, there is @xmath with @xmath . Hence @xmath . ∎

###### Lemma 5.1.6.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Suppose that @xmath is an ideal. Then @xmath is satiated.

###### Proof.

Let @xmath . To see that @xmath is satiated we will repeatedly apply
Lemma 3.4.6 and use that @xmath is an ideal. For (S1), suppose that
@xmath and @xmath is finite with @xmath . Then as @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

So @xmath . For (S2), suppose that @xmath with @xmath and @xmath . Lemma
3.4.6 implies that

  -- -------- --
     @xmath   
  -- -------- --

So @xmath . For (S3), suppose that @xmath , @xmath for each @xmath . Set
@xmath . Then Lemma 3.4.6 implies that @xmath . Hence

  -- -------- --
     @xmath   
  -- -------- --

So @xmath For (S4), suppose that @xmath , @xmath and @xmath for each
@xmath . Put @xmath . We need to show that @xmath . Lemma 3.4.5 implies
that for each @xmath , we have

  -- -------- -- -------
     @xmath      (5.2)
  -- -------- -- -------

Let @xmath be the quotient map. For each @xmath we have @xmath and so
@xmath . Applying the quotient map to ( 5.2 ) gives

  -- -------- --
     @xmath   
  -- -------- --

for each @xmath . The definition of @xmath implies that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

since @xmath . So @xmath and hence @xmath . ∎

###### Lemma 5.1.7.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Suppose that @xmath is an ideal. Then @xmath .

###### Proof.

Suppose that @xmath . By Lemma 5.1.5 we have @xmath , and so it suffices
to show that @xmath . By definition of @xmath , there is @xmath such
that @xmath and @xmath . Since @xmath we have @xmath , and so

  -- -------- -- -------
     @xmath      (5.3)
  -- -------- -- -------

Let @xmath be the quotient map. Note that @xmath implies @xmath , which
in turn implies that @xmath , by definition of @xmath . Hence for @xmath
we have

  -- -------- --
     @xmath   
  -- -------- --

Applying the quotient map @xmath to ( 5.3 ) we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

So @xmath . ∎

### 5.2 Quotients of twisted relative Cuntz-Krieger algebras

Given a hereditary and relatively saturated subset @xmath and a satiated
subset @xmath , we construct a gauge-invariant ideal @xmath . Using the
gauge-invariant uniqueness theorem, we show that @xmath is a canonically
isomorphic to a twisted relative Cuntz-Krieger algebra of a subgraph.

###### Definition 5.2.1.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Let @xmath be hereditary and let @xmath . We define @xmath to
be the ideal in @xmath generated by

  -- -------- --
     @xmath   
  -- -------- --

Observe that if @xmath is a @xmath -subgraph of @xmath and if @xmath ,
then @xmath is a 2-cocycle for @xmath , where @xmath ; that is, @xmath .
For convenience we write @xmath for @xmath .

###### Lemma 5.2.2.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Let @xmath be hereditary and saturated relative to @xmath .
Suppose that @xmath is satiated and satisfies @xmath . Suppose that
@xmath is a relative Cuntz-Krieger @xmath -family. For @xmath , let
@xmath , and for @xmath , let @xmath . Then @xmath is a relative
Cuntz-Krieger @xmath -family. There is a unique homomorphism @xmath
determined by

  -- -------- -- -------
     @xmath      (5.4)
  -- -------- -- -------

We then have

  -- -------- -- -------
     @xmath      (5.5)
     @xmath      (5.6)
  -- -------- -- -------

###### Proof.

We check axioms (TCK1) to (TCK4) and (CK) for @xmath . The set

  -- -------- --
     @xmath   
  -- -------- --

is a collection of mutually orthogonal projections and @xmath is a
projection satisfying @xmath for any @xmath . So @xmath is a collection
of mutually orthogonal projections. This gives (TCK1).

For (TCK2) we show

  -- -------- -- -------
     @xmath      (5.7)
  -- -------- -- -------

Fix @xmath satisfying @xmath . If @xmath then both sides of ( 5.7 ) are
zero. So suppose @xmath . Since @xmath is hereditary and @xmath we have
@xmath . So

  -- -------- --
     @xmath   
  -- -------- --

For (TCK3), if @xmath then @xmath . If @xmath then @xmath . Thus, @xmath
.

For (TCK4) we must check that @xmath for each @xmath . Suppose that
@xmath or that @xmath . Then @xmath . As @xmath is hereditary, @xmath
implies @xmath . Hence @xmath . Now suppose that @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

This gives (TCK4).

We check (CK). Suppose that @xmath ; we must show that @xmath . If
@xmath , then @xmath So suppose that @xmath . Then

  -- -------- -- -------
     @xmath      (5.8)
  -- -------- -- -------

Since @xmath , ( 5.8 ) implies that @xmath .

We now show there is a unique homomorphism @xmath satisfying ( 5.4 ).
Write @xmath for the universal generating family of @xmath . For @xmath
, let @xmath , and for @xmath , let @xmath . The first part of the Lemma
implies that @xmath is a relative Cuntz-Krieger @xmath -family. By the
universal property for @xmath there is a unique homomorphism

  -- -- --
        
  -- -- --

satisfying @xmath for each @xmath . So the homomorphism @xmath satisfies
( 5.4 ). We now check ( 5.5 ). If @xmath then @xmath by ( 5.4 ).
Conversely, if @xmath then Theorem 3.4.16 implies that @xmath . We now
check ( 5.6 ). If @xmath then

  -- -------- --
     @xmath   
  -- -------- --

Theorem 3.4.16 implies that for @xmath we have @xmath if and only if
@xmath , and ( 5.6 ) follows. ∎

###### Lemma 5.2.3.

Let @xmath be a @xmath -algebra and let @xmath . Let @xmath denote the
ideal generated by @xmath , as in Lemma 3.3.6 . Suppose that @xmath is a
compact abelian group and that @xmath is a group action. If @xmath for
all @xmath and @xmath , then @xmath for each @xmath ; that is, @xmath is
@xmath -invariant.

###### Proof.

By Lemma 3.3.6 @xmath . For any @xmath , @xmath and @xmath , we have
@xmath . Since @xmath is linear and continuous, we have @xmath for each
@xmath . Since @xmath , we have @xmath . ∎

###### Theorem 5.2.4.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . Let @xmath be hereditary and saturated relative to @xmath .
Suppose that @xmath is satiated and that @xmath . Then @xmath is a
relative Cuntz-Krieger @xmath -family in @xmath . The canonical
homomorphism

  -- -- --
        
  -- -- --

is an isomorphism.

###### Proof.

First we check axioms (TCK1) to (TCK4) and (CK) for @xmath . Relations
(TCK1),(TCK2) and (TCK3) follow immediately since the quotient map
@xmath is a homomorphism. For (TCK4), fix @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

If @xmath then @xmath . So @xmath , which implies that @xmath . Hence

  -- -------- --
     @xmath   
  -- -------- --

It remains to check (CK). If @xmath then @xmath . Hence @xmath . We have
shown that @xmath is a relative Cuntz-Krieger @xmath -family in @xmath .
We now aim to use the gauge-invariant uniqueness theorem, Theorem 4.6.1
, to see that @xmath is an isomorphism.

Let @xmath denote the gauge action on @xmath . For @xmath and @xmath ,
we have @xmath and @xmath for each @xmath . Lemma 5.2.3 implies that
@xmath is invariant under the gauge action. Hence there exists an action
@xmath of @xmath on @xmath satisfying @xmath for each @xmath . We claim
that

1.  @xmath

2.  @xmath

Let @xmath be the homomorphism from Lemma 5.2.2 . Equations ( 5.5 ) and
( 5.6 ) imply that

  -- -------- --
     @xmath   
  -- -------- --

Lemma 3.3.6 implies @xmath . If @xmath , then ( 5.4 ) and ( 5.5 ) imply
that @xmath . If @xmath then ( 5.4 ) and ( 5.6 ) imply that @xmath .

Since @xmath is satiated, the gauge-invariant uniqueness theorem,
Theorem 4.6.1 , implies that @xmath is an isomorphism. ∎

### 5.3 Gauge-invariant ideals of the twisted relative Cuntz-Krieger
algebras

###### Definition 5.3.1.

Let @xmath be a finitely aligned @xmath -graph and let @xmath . Let
@xmath be set of all pairs @xmath where @xmath is hereditary and
saturated relative to @xmath , and @xmath is satiated with @xmath .

###### Theorem 5.3.2.

Let @xmath be a finitely aligned @xmath -graph, let @xmath and let
@xmath . The map @xmath is a bijection between @xmath and the
gauge-invariant ideals of @xmath .

###### Proof.

First we check that @xmath is surjective. Fix a gauge-invariant ideal
@xmath . We claim @xmath . We have @xmath by definition. Hence there is
a well-defined homomorphism @xmath from @xmath onto @xmath such that
@xmath for each @xmath . The set @xmath is hereditary and saturated
relative to @xmath by Lemma 5.1.2 . The set @xmath is satiated by Lemma
5.1.6 and satisfies @xmath by Lemma 5.1.7 . Theorem 5.2.4 implies that
@xmath is an isomorphism. Since

  -- -- -- -------
           (5.9)
  -- -- -- -------

for each @xmath , @xmath is a relative Cuntz-Krieger @xmath -family. The
uniqueness clause in Theorem 3.3.7 implies that @xmath

Suppose @xmath satisfies @xmath . Then @xmath and so @xmath by
definition. Thus, @xmath implies @xmath . Suppose @xmath satisfies
@xmath . Then @xmath and so @xmath by definition. Hence, @xmath implies
@xmath .

Since @xmath is gauge-invariant, there exists an action @xmath on @xmath
satisfying @xmath for each @xmath and @xmath . The gauge-invariant
uniqueness theorem, Theorem 4.6.1 implies that @xmath is an isomorphism.
Hence @xmath is an isomorphism and the diagram

  -- -- --
        
  -- -- --

commutes, where @xmath and @xmath denote the quotient maps. If @xmath
then @xmath . So @xmath . A similar calculation shows the reverse
containment. So @xmath .

Now we check that @xmath is injective. Fix @xmath . We will show that
@xmath and @xmath . The containments @xmath and @xmath follow by
definition.

If @xmath then @xmath . The map @xmath is an isomorphism by Theorem
5.2.4 . It follows that @xmath . Since @xmath is satiated Theorem 3.4.16
implies @xmath for all @xmath . Hence @xmath . So @xmath .

Now suppose that @xmath . Then @xmath . We have @xmath . As @xmath is
injective @xmath . Since @xmath is satiated, Theorem 3.4.16 implies that
@xmath . So @xmath . ∎