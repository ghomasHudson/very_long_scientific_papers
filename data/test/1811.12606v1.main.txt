# Acknowledgments

This work would not have been done without the encouragement and the
support from some people I have met during my fascinating Ph.D. journey.

First and foremost, I would like to thank my supervisor Professor
Jinhong Yuan with my deepest gratitude for offering me a Ph.D.
opportunity three and half years ago and having faith in me ever since.
He guides me throughout this work with patience, technical and personal
support, and encouragement. He tolerates my shortcomings and helps me to
overcome my weakness. Besides, he is passionate about new technologies
and exciting ideas. I feel fortunate to pursue my Ph.D. degree under his
supervision.

Second, I would like to thank my co-supervisor, Dr. Derrick Wing Kwan
Ng, for his guidance, constructive suggestions, and help on my research.
Derrick is talented, extremely self-disciplined, and very hard-working.
I will regard him as the role model of my academic career.

I would also like to thank Dr. Giovanni Geraci and Dr. Tao Yang for the
first step of my research. Many thanks to Dr. Lei Yang, Dr. Yixuan Xie,
Dr. Tao Huang, Dr. Mengyu Huang, Dr. Chenxi Liu, Dr. Shuang Tian, Dr.
Nan Yang, Dr. Shihan Yan, Dr. Yansha Deng, Dr. Yeqing Hu, and others for
having a lot of discussions with me. Special thanks to my colleagues and
friends at the University of New South Wales, you guys make the Ph.D.
journey funny and interesting. I will always hold dear the days and
nights spent in the office.

Finally, my deepest appreciation goes to my beloved family for
everything they have done for me. I would like to dedicate this thesis
to my parents, my wife, and my son. To my son, you make my life
brighter.

## List of Publications

Journal Articles:

1.   L. Zhao , D. W. K. Ng, and J. Yuan, “Multi-user precoding and
    channel estimation for hybrid millimeter wave systems,” IEEE J. Sel.
    Areas Commun. , vol. 35, no. 7, pp. 1576–1590, Jul. 2017.

2.   L. Zhao , G. Geraci, T. Yang, D. W. K. Ng, and J. Yuan, “A
    tone-based AoA estimation and multiuser precoding for millimeter
    wave massive MIMO,” IEEE Trans. Commun. , vol. 65, no. 12, pp.
    5209–5225, Dec. 2017.

3.   L. Zhao , Z. Wei, D. W. K. Ng, J. Yuan, and M. C. Reed, “Multi-cell
    hybrid millimeter wave systems: Pilot contamination and interference
    mitigation,” IEEE Trans. Commun. , vol. 66, no. 11, pp. 5740-5755,
    Nov. 2018.

4.  Z. Wei, L. Zhao , J. Guo, D. W. K. Ng, and J. Yuan, “Multi-Beam NOMA
    for Hybrid mmWave Systems,” accepted, IEEE Trans. Commun. ,
    Nov. 2018.

Conference Articles:

1.   L. Zhao , T. Yang and G. Geraci and J. Yuan “Downlink multiuser
    massive MIMO in Rician channels under pilot contamination” in Proc.
    IEEE Intern. Commun. Conf. (ICC) , Kuala Lumpur, May 2016, pp. 1–6.

2.   L. Zhao , D. W. K. Ng, and J. Yuan, “Multiuser precoding and
    channel estimation for hybrid millimeter wave MIMO systems,” in
    Proc. IEEE Intern. Commun. Conf. (ICC) , Paris, May 2017, pp. 1–7.

3.   L. Zhao , Z. Wei, D. W. K. Ng, J. Yuan and M. C. Reed, “Mitigating
    pilot contamination in multi-cell hybrid millimeter Wave Systems,”
    in Proc. IEEE Intern. Commun. Conf. (ICC) , Kansas City, May 2018.

4.  Z. Wei, L. Zhao , J. Guo, D. W. K. Ng, and J. Yuan, “A multi-beam
    NOMA framework for hybrid mmWave systems,” in Proc. IEEE Intern.
    Commun. Conf. (ICC) , Kansas City, May 2018 (ICC best paper awards).

## Abbreviations

## List of Notations

Boldface upper-case letters denote matrices, boldface lower-case letters
denote vectors, and italics denote scalars.

###### Contents

-    Abstract
-    List of Publications
-    Abbreviations
-    List of Notations
-    \thechapter Introduction
    -    1 Background
        -    1.1 The Concepts of Massive MIMO
            -    1.1.1 Key Aspects of Massive MIMO:
        -    1.2 MmWave Channels Statistics
            -    1.2.1 Path Loss:
            -    1.2.2 Power Delay Profile and Delay Spread:
    -    2 Challenges and Motivations
        -    2.1 Hardware Constraint: Fully Digital vs Hybrid Structure
        -    2.2 Hybrid Precoding: Basic Concepts
        -    2.3 Combination of MmWave Systems and A Small-cell Scenario
        -    2.4 MmWave Channel Estimation
            -    2.4.1 Pilot-aided Channel Estimation and Pilot
                Contamination:
            -    2.4.2 Open-Loop Beamforming Channel Estimation:
        -    2.5 TDD or FDD Feedback?
        -    2.6 Hardware Impairments
    -    3 Thesis Outline and Contributions
-    \thechapter Fully Digital mmWave MIMO Systems: A Tone-based Channel
    Estimation Strategy
    -    4 Introduction
    -    5 System Model
    -    6 Channel Estimation and Downlink Transmission
        -    6.1 MU MmWave Channel Estimation
    -    7 Performance Analysis
        -    7.1 SLOS-based MRT Precoding
        -    7.2 SLPS-based ZF Precoding
    -    8 Comparison with PAC-based Precoding
        -    8.1 PAC-MRT and PAC-ZF Precoding under Pilot Contamination
        -    8.2 Achievable Rate Comparison
        -    8.3 Large-system Analysis
    -    9 Impact of Imperfect Hardware: Phase Quantization Error
    -    10 Summary
-    \thechapter Hybrid mmWave MIMO Systems: Multi-user Precoding and
    Channel Estimation
    -    11 Introduction
    -    12 System Model
    -    13 Proposed Channel Estimation for Hybrid System
        -    13.1 Details of Proposed Channel Estimation
        -    13.2 Performance Analysis of Proposed Channel Estimation
    -    14 ZF Precoding and Performance Analysis
        -    14.1 ZF Precoding
        -    14.2 Performance Upper Bound of ZF Precoding
        -    14.3 Comparison with Fully Digital Systems
    -    15 Performance Analysis with Hardware Impairments
        -    15.1 Transceiver Beamforming Errors and Random Phase Errors
        -    15.2 Hardware Impairment and Imperfect Channel Estimation
    -    16 Simulation and Discussion
    -    17 Summary
-    \thechapter Multi-cell Hybrid mmWave MIMO Systems: Pilot
    Contamination and Interference Mitigation
    -    18 Introduction
    -    19 System Model
    -    20 Multi-cell Uplink Channel Estimation Performance Analysis
        -    20.1 Channel Estimation and Pilot Contamination Analysis
    -    21 Multi-cell Downlink Achievable Rate
        -    21.1 Downlink Achievable Rate Performance
        -    21.2 Intra-cell and Inter-cell Interference Performance
            Analysis
    -    22 Discussions and Simulations
    -    23 Summary
-    \thechapter Conclusions and Future Works
    -    24 Conclusions
    -    25 Future Works
        -    25.0.1 Hybrid architectures with extra RF chains:
        -    25.0.2 Distributed hybrid mmWave MIMO network to recapture
            the geographic degree of freedom:
        -    25.0.3 Extension to the wideband frequency selective :
-    \thechapter Proof of Theorem 2.1
-    \thechapter Proof of Corollary 2.1
-    \thechapter Proof of Theorem 3.1
-    \thechapter Proof of Theorem 3.2
-    \thechapter Proof of Theorem 4.1
-    \thechapter Proof of Lemma 4.2

###### List of Figures

-    1 Illustration of different hybrid structures.
-    2 Fully digital massive MIMO architecture.
-    3 Tone-based AoA channel estimation.
-    4  (a) Illustration of AoA estimation for the SLOS component and
    scattering components for @xmath and @xmath ; (b) Illustration of
    AoA estimation for the SLOS component and scattering components for
    @xmath and @xmath ; (c) Successful rate of the SLOS estimation
    versus the Rician K-factor for various number of antennas; (d)
    Normalized MSEs of channel estimation versus the Rician K-factor for
    various number of antennas. For (a), (b), (c), and (d), we set the
    number of combination AoAs as @xmath and the number of search steps
    as @xmath .
-    5 Illustration of the practical 5G NR CSI acquisition/initial
    access procedure.
-    6 Illustration of the overhead signalling difference between the
    practical 5G NR CSI acquisition procedure and the proposed
    algorithm.
-    7 Average achievable sum-rate [bits/s/Hz] versus SNR [dB] for
    different precoding schemes with @xmath and @xmath . We set the
    Rician K-factor as @xmath and the normalized @xmath for the
    SLPS-based ZF, the PAC-based ZF, and the PAC-based MRT.
-    8 Illustration of the main lobe and side lobes of ULA in the space
    domain with respect to the BS.
-    9 Average rate per user [bits/s/Hz] based on deterministic channel
    versus different @xmath for @xmath , the Rician K-factor @xmath ,
    @xmath , and the normalized @xmath .
-    10 Average achievable sum-rate [bits/s/Hz] versus Rician K-factor
    comparison with different @xmath , @xmath , and @xmath .
-    11 Average achievable sum-rate [bits/s/Hz] under phase quantization
    error versus SNR [dB], for @xmath , @xmath , the normalized @xmath
    and Rician K-factor of @xmath .
-    12 The impact of @xmath -bit phase quantization resolutions on
    average achievable rate per user of SLOS-based MRT versus the number
    of antennas with the normalized @xmath and Rician K-factor of @xmath
    .
-    13 A mmWave massive MIMO communication system with a hybrid system
    of transceivers.
-    14 A block diagram of an RF chain for an antenna array.
-    15 An illustration of the proposed channel estimation algorithm for
    hybrid mmWave systems.
-    16 The NMSE performance comparison between the proposed pilot-aided
    channel estimation algorithm for the hybrid system and the
    conventional pilot-aided LS for the fully digital system.
-    17 Average achievable rate per user [bits/s/Hz] versus SNR for the
    hybrid and the fully digital systems with @xmath , @xmath and @xmath
    .
-    18 Average achievable rate [bits/s/Hz] versus Rician K-factor for
    different systems with @xmath dB, @xmath , @xmath , and @xmath .
-    19 The average achievable rate per user [bits/s/Hz] versus SNR for
    algorithm proposed in [3] and our proposed algorithm.
-    20 The average achievable rate per user [bits/s/Hz] versus SNR for
    the hybrid system.
-    21 Average achievable rate [bits/s/Hz] versus different number of
    BS antennas for different structures with @xmath , the number of
    users @xmath , the normalized CSI @xmath , @xmath dB, and the Rician
    K-factor of @xmath .
-    22 Average achievable rate [bits/s/Hz] versus different number of
    users antennas for different structures with @xmath , the number of
    users @xmath , the normalized CSI @xmath , @xmath dB, and the Rician
    K-factor of @xmath .
-    23 A multi-cell MU mmWave cellular system with @xmath neighboring
    cells.
-    24 A block diagram of an RF chain of a subarray antenna structure.
-    25  (a) The illustration of equivalent channel estimation under the
    impact of pilot contamination. (b) The illustration of sidelobe
    suppression for different numbers of antennas @xmath .
-    26 The illustration of multi-cell normalized MSE performance under
    the impact of pilot contamination versus the number of antennas
    @xmath in the high SNR regime, i.e., maximum transmit power @xmath
    [dBm], for @xmath , @xmath , @xmath and channel estimation error
    @xmath .
-    27 The illustration of multi-cell normalized MSE performance under
    the impact of pilot contamination versus the number of antennas
    @xmath in the high SNR regime with different @xmath settings.
-    28 The average achievable rate per user [bits/s/Hz] under the
    impact of pilot contamination and inter-cell downlink transmission
    interference versus maximum transmit power at the desired BS [dBm]
    with @xmath .
-    29 The achievable rate per user [bits/s/Hz] under the impact of
    pilot contamination effects and inter-cell interference versus the
    number of antennas @xmath in the high SNR regime (maximum BS
    transmit power is @xmath [dBm]).

## Chapter \thechapter Introduction

The significantly increased data rate requirement and quality-of-service
(QoS) triggered by the proliferation of smartphones and tablets cannot
be satisfied by current communication networks. In particular, the
tremendous number of devices and appliances are expected to connect
wirelessly to the Internet, e.g.
device-to-device (D2D) communications and internet-of-things (IoT)
applications, the required capacity exceeds the limit of existing
networks. To address the aforementioned requirements, the fifth
generation ( @xmath G), the true revolution of technologies in both the
radio access network and the mobile core network, is expected to support
@xmath times higher system capacity than current the fourth generation (
@xmath G) systems and have attracted tremendous interests from both
academia and industry, e.g. [ 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 ,
11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25
, 26 , 27 , 28 , 29 , 30 ] . For example, @xmath G should support @xmath
Gb/s peak data rate, @xmath Mb/s guaranteed data rate, @xmath Tb/s/km
@xmath mobile data volume, less than @xmath ms end-to-end latency,
@xmath million/km @xmath number of devices, higher than @xmath
reliability, and less than @xmath meter outdoor terminal location
accuracy. As a result, denser network, larger bandwidth, and higher
spectral efficiency are necessary to satisfy these demands. To meet the
stringent spectral efficiency requirement, massive multiple-input
multiple-output (MIMO) technology is introduced by using hundreds of
antennas equipped at the base station (BS) to serve tens of users
simultaneously [ 28 , 27 , 31 , 32 ] . It is proved that, by adopting
low computational complexity linear precoding schemes, such as
maximal-ratio transmission (MRT) and zero-forcing (ZF), massive MIMO
systems can significantly improve the spectral efficiency and fully
explore a large amount of available spatial degrees of freedom [ 28 , 14
, 33 , 34 , 35 , 15 ] . Besides, to overcome the bandwidth limitation in
licensed band, millimeter wave (mmWave) systems that migrate from sub-
@xmath GHz to higher frequencies in unlicensed band can inevitably offer
a huge trunk of a bandwidth of the order of gigahertz, e.g. an
unlicensed spectrum ranging from @xmath GHz to @xmath GHz, to achieve
ultra-high data rate communication [ 3 , 36 , 37 , 2 , 18 , 19 , 20 , 21
, 33 , 38 , 17 , 5 , 39 ] . In practice, mmWave and massive MIMO can
complement each other to overcome some drawbacks in each technology. For
example, due to the short wavelength of mmWave frequencies, mmWave
technology can shrink the physical size of antenna arrays of massive
MIMO systems. Therefore, the antenna array of mmWave massive MIMO is
small which enables flexible and practical deployment. On the other
hand, massive MIMO, equipping a BS with hundreds of antennas, can
provide significant antenna array gains to help mmWave communication
systems to compensate the inherent high propagation path loss, low
penetration coefficients, and high signal attenuation caused by raindrop
absorption [ 40 , 29 ] . Thus, the combination of mmWave communication
systems with massive MIMO systems is considered as one of the promising
candidate technologies for 5G communication systems with many potential
opportunities for research [ 3 , 41 , 37 , 18 , 33 ] .

### 1 Background

In this section, we will briefly introduce the concepts of massive MIMO
and the characteristics of mmWave channels.

#### 1.1 The Concepts of Massive MIMO

Massive MIMO technology is one of the key technologies for @xmath G.
Compared with the conventional multi-user (MU) MIMO systems, massive
MIMO is a special form of MIMO systems with hundreds of antennas
equipped at the BS to simultaneously serve tens of users in their cells
[ 42 ] . In general, a large amount of experimental and theoretical
research shows that several favorable properties can be obtained when
the number of antennas equipped at the BS is significantly larger than
the number of users.

There are several main advantages when the number of antennas is
sufficiently large: (1) the effects of small-scaling fading vanish (also
known as channel hardening); (2) simple linear signal processing
algorithms can achieve considerable rate performance compared to optimal
algorithms, e.g. dirty paper coding (DPC); (3) higher spectral
efficiency and higher energy efficiency [ 28 , 43 , 44 , 45 , 46 , 47 ]
. The more antennas the transmitter/receiver are equipped with, the
better performance in terms of data rate and link reliability the system
can achieve. However, the cost, the energy consumption, and the
complexity of hardware (power amplifier (PA) and analog-to-digital
converter/digital-to-analog converter (ADC/DAC)) increase with the
increasing number of antennas [ 21 , 37 , 27 , 14 , 48 ] .

##### 1.1.1 Key Aspects of Massive MIMO:

A lot of efforts have been dedicated to the investigation of massive
MIMO from different aspects, e.g. architecture aspects [ 49 , 43 , 50 ,
16 , 51 ] , capacity and fundamental aspects [ 28 , 52 , 44 , 45 , 46 ,
53 , 54 ] , channel state information (CSI) acquisition [ 55 , 56 , 57 ,
58 , 59 , 60 , 61 , 2 , 62 , 63 ] , detection algorithms [ 64 , 65 , 66
, 67 , 36 ] , downlink precoding design [ 68 , 69 , 70 , 3 , 20 , 71 ,
72 , 73 ] , channel measurements and modeling [ 74 , 51 , 75 ] ,
resource allocation [ 15 , 76 , 42 , 77 , 78 , 79 , 80 ] , hardware
impairments [ 80 , 81 , 1 , 82 , 83 ] , beamforming and precoding [ 84 ,
85 , 86 , 87 , 88 , 89 ] and performance analysis [ 90 , 91 , 92 , 93 ,
94 , 95 , 96 , 97 , 76 , 42 ] . These aspects of massive MIMO had been
well studied and interested readers may refer to these works for
details.

#### 1.2 MmWave Channels Statistics

The study of mmWave channels can be dated back to decades ago [ 98 , 99
] . Due to the high propagation path loss, mmWave technology has not
been widely adopted for cellular application in the past.

Nowadays, the spectral resource below @xmath GHz becomes tense while
sufficiently large bandwidth is still available at the mmWave band.
Thus, large efforts have been devoted to the research of mmWave
communication and there are some practical communication systems
utilizing the mmWave band, e.g. mmWave wireless local area networks
(WLAN) IEEE @xmath ad. However, these frequencies have not been
well-explored for cellular applications. As mmWave technology is
considered as a key feature for @xmath G, the features of mmWave
channels must be considered carefully for system design.

##### 1.2.1 Path Loss:

According to the free space propagation path loss model provided by the
Friis transmission formula, the received power can be expressed as [ 100
]

  -- -- -- -----
           (1)
  -- -- -- -----

where @xmath is wavelength, @xmath is the transmission distance between
the desired BS and the user, @xmath is the path loss exponent, and
@xmath is the transmit power. In addition, @xmath and @xmath are the
antenna gains of the transmitter and receiver, respectively.

We can rewrite Equation ( 1 ) in the form of path loss. The commonly
adopted empirical propagation path loss model is considered as a
function of distance and carrier frequency, which is given by

  -- -------- -- -----
     @xmath      (2)
  -- -------- -- -----

where in a log-log plot of the path loss curve, slope @xmath and
intercept @xmath are estimated by least squares (LS) linear regression
over the measured data [ 101 , 102 ] . For different scenarios, @xmath
and @xmath may have different values, e.g. line-of-sight (LOS)
environment and non line-of-sight (NLOS) environment. In addition, the
propagation path loss model should also take into account the impacts of
rain attenuation, atmospheric absorption, and shadowing [ 101 , 29 , 102
, 103 , 18 ] .

Generally speaking, the severe path loss of mmWave channels is one of
the key technical challenges in preventing mmWave technology to be
implemented in conventional cellular communication systems [ 101 , 29 ,
102 , 104 ] . Nowadays, there are two methods to overcome such a
challenge, e.g. increasing antenna array gain and decreasing the
propagation distance. In fact, it is expected that small cell will serve
as a core structure of future cellular systems [ 49 , 105 ] . Hence,
applying mmWave technology to small-cell urban mobile networks becomes a
new trend [ 106 ] . In particular, it can significantly reduce the
requirement of transmit power of mmWave systems. In addition, the high
antenna array gain can be enabled by adopting the massive numbers of
antennas.

##### 1.2.2 Power Delay Profile and Delay Spread:

The power delay profile gives the intensity of a signal received through
a multi-path channel as a function of time delay. The shape of power
delay profile (PDP) in mmWave channel measurements is a superposition of
multiple exponentially decaying spectrums. The delay spread (DS) is
usually quantified through root mean square (r.m.s.) and considered as a
collection of the multi-path containing significant energy which spread
over the PDP. Besides, the DS of the channel is an important metric to
understand the required system overhead to facilitate communication [
107 ] . To provide sufficient channel characteristics information for
the system design (concerning the length of cyclic prefix for a
multi-carrier design), it is necessary to proceed the PDP estimation in
mmWave channel measurements, which is called channel sounding.

Channel sounding for the estimation of PDP and calculating DS can be
performed with both omni-directional antenna as well as directional
antenna array/horn antennas. The basic procedure of channel sounding
with directional horn antennas is listed as follows [ 108 , 107 , 109 ]
:

-   Perform an azimuthal scan and produce @xmath number of slices (the
    beamwidth of main lobe of directional horn antenna can cover @xmath
    degrees)

-   Mark the absolute propagation times for different sounding slices

-   Synthesize the equivalent omni-directional PDP over an absolute
    propagation time axis

The PDP sounding and DS calculation for the indoor environment can be
conducted via omni-directional antennas due to the short propagation
distance. The results illustrate that for most indoor scenarios the DS
estimated via directional antennas as well as omni-directional antennas
are small, e.g. @xmath ns indoor office and @xmath ns indoor shopping
mall [ 108 , 107 , 109 ] . However, the outdoor PDP environment sounding
should be conducted via directional horn antennas with large
antenna-gain to compensate the severe propagation path loss. Then, by
synthesizing the estimated PDP via directional antennas over an absolute
propagation time axis, we can obtain the equivalent omni-directional
PDP. For the equivalent omni-directional PDP, there are different
outdoor scenarios where a significantly large DS have been observed,
e.g. @xmath ns for street canyon settings and even up to @xmath ns for
open square settings [ 108 , 107 , 109 ] . In addition, the simulation
results conducted by adopting ray tracing demonstrate that scattering
and reflections from small objects affect the mmWave propagation channel
[ 110 , 102 , 108 ] . These simulation and experiment results for
outdoor scenarios can be explained with radar cross-section (RCS)
effect, where small objects that do not participate in electromagnetic
propagation at low frequencies show up at higher frequencies [ 108 , 107
, 102 ] . According to the simulation and experiment results as
mentioned earlier, the sparse scattering assumption of mmWave channels
holds for most indoor scenarios. The omni-directional delay spread is
comparable with after-beamforming delay spread . However, for non-sparse
mmWave channels, the omni-directional delay spread is significantly
larger than that of after-beamforming delay spread. Thus, how to support
these extremes without incurring a high amount of signaling overhead is
an important unsolved problem. Fortunately, field test results showed
that the after-beamforming delay spread could be significantly smaller
than the omni-directional delay spread [ 108 , 107 , 109 ] .
Furthermore, the blocking capability improves with the increasing number
of antennas equipped at the BS/horn antenna gains [ 111 , 1 ] .
Specifically, the beamwidth of the main lobe becomes narrower and the
magnitude of sidelobes becomes lower when the number of antennas becomes
larger [ 111 , 102 , 1 ] . Thus, the non-sparse scattering environment
and the analog beamforming technology should be taken into account in
the design of future mmWave systems, e.g. channel estimation and
frequency selectivity [ 108 , 107 , 109 , 101 , 29 , 102 ] .

### 2 Challenges and Motivations

There are plenty of implementation challenges for mmWave massive MIMO
communication systems, such as efficient hardware structures, low-cost
hardware elements, hybrid precoding strategies, and channel estimation
algorithms. In this thesis, channel estimation for mmWave hybrid systems
as well as the impact of hardware impairments on rate performance are
the primary focus of this thesis.

#### 2.1 Hardware Constraint: Fully Digital vs Hybrid Structure

From the literature, it is certain that conventional fully digital MIMO
systems, in which each antenna connects with a dedicated radio frequency
(RF) chain, are impractical for mmWave systems due to the prohibitively
high cost, e.g. tremendous energy consumption of high-resolution ADC/DAC
and PAs [ 112 , 113 , 114 , 17 ] .

As a result, several mmWave hybrid systems were proposed as compromised
solutions which strike a balance between hardware complexity and system
performance [ 3 , 115 , 116 , 117 , 20 , 118 , 37 , 18 , 33 ] , such as
fully access hybrid structure, subarray hybrid structure and lens-based
hybrid structure [ 113 , 17 , 112 , 36 ] , as shown in Figure 1 . In
particular, the trade-offs between system performance, hardware
complexity ¹ ¹ 1 The hardware includes PA, ADC/DAC, phase shifters, and
antenna array. , and energy consumption are still unclear [ 17 , 112 ] .

In the hybrid structure, @xmath data streams are first through the
baseband digital precoding, and then the output is through the @xmath RF
chains. After the RF analog beamforming, the RF signals are outputted to
the @xmath antennas. With @xmath , the number of RF chains can be
significantly reduced for practical implementation. Specifically, the
use of a large number of antennas, connected with only a small number of
independent RF chains at transceivers, is adopted to exploit the large
array gain to compensate the inherent high path loss in mmWave channels
[ 29 , 102 ] . In the fully access structure shown in Figure 1 (a), an
RF chain is connected to all the antennas through the network of analog
phase shifters. In the subarray structure shown in Figure 1 (b), the
array is divided into sub-arrays, and each sub-array is fed by its RF
chain. The lens antenna array structure shown in Figure 1 (c), which is
formed by an electromagnetic lens with energy focusing capability and a
matching antenna array with elements located on the focal surface, can
simultaneously realize signal-emitting and phase-shifting. In general,
the hybrid system imposes a restriction on the number of RF chains which
introduces a paradigm shift in the design of both resource allocation
algorithms, transceiver signal processing, and channel estimation
algorithms.

#### 2.2 Hybrid Precoding: Basic Concepts

For a hybrid mmWave system, the utmost important issues should be
developing channel estimation algorithms and hybrid precoding algorithms
[ 18 ] .

To address the importance in designing hybrid precoding algorithms, we
take a MU hybrid mmWave system with the fully access structure as an
example, which consists of one @xmath -antenna BS with @xmath RF chains
and @xmath single-RF-chain users with @xmath -antenna.

During the downlink transmission, the signal received at user @xmath is
given by

  -- -------- -- -----
     @xmath      (3)
  -- -------- -- -----

where @xmath is the downlink mmWave channel between the BS and user
@xmath , @xmath is the analog beamformer at the BS, @xmath is the
digital precoder at the BS, @xmath is the analog beamformer at user
@xmath , @xmath , @xmath is the transmitted symbols, @xmath , @xmath is
the total transmit power, @xmath is an additive white Gaussian noise
(AWGN) vector, @xmath , and @xmath is the noise variance at each antenna
equipped at a user. The achievable system sum rate is given by [ 3 , 18
]

  -- -------- -- -----
     @xmath      (4)
  -- -------- -- -----

In Equation ( 4 ), @xmath is the rate achieved by user @xmath and can be
expressed as

  -- -------- -- -----
     @xmath      (5)
  -- -------- -- -----

where @xmath is the @xmath -th column of @xmath .

The optimal joint digital precoder and analog beamformer design is to
maximize the achievable sum rate. Thus, the optimal precoders design can
be found by solving the following optimization problem [ 3 , 20 , 36 ,
47 , 18 , 103 ] :

  -- -------- -------- -- -----
     @xmath   @xmath      (6)
     @xmath   @xmath      
              @xmath      
              @xmath      
  -- -------- -------- -- -----

where @xmath and @xmath are the hardware constraint for the design of
analog beamformers and the total power constraint is enforced by
normalizing @xmath in @xmath .

The problem in Equation ( 6 ) is a non-convex optimization problem. In
particular, the digital precoder design is under the constraint of the
number of RF chains and the designed analog beamformers. Thus, the
optimal solution to the hybrid precoding design is not known in general
and only suboptimal iterative solutions exist [ 116 , 3 , 70 , 119 , 112
] .

In order to avoid the exhaustive search for the optimal analog
beamforming and digital precoding design, Ref. [ 3 ] proposed a
two-stage algorithm which designs analog beamformer and digital precoder
separately. In the first-stage, for each user @xmath , @xmath , the BS
and user @xmath select their analog beamformers respectively to solve

  -- -------- -------- -- -----
     @xmath   @xmath      (7)
     @xmath   @xmath      
              @xmath      
  -- -------- -------- -- -----

In fact, the main idea of the first-stage is to jointly design analog
beamformers at the user and the BS to maximize the desired signal power
of each user. For the analog beamformer design, Equation ( 7 ) is widely
adopted in many works [ 112 , 120 ] . It is true that the power of the
received signal before analog beamforming is typically low due to high
mmWave path losses, additional blockage, and penetration losses. Thus,
it is reasonable that the proposed analog beamformer design tries to
maximize the received power of the desired signal. However, it neglects
the resulting interference among different users [ 47 , 107 , 1 ] .
Actually, the MU inter-user interference due to the analog beamformers
may cause severe impacts and should be taken into account. Thus, we
should consider the trade offs between the received power of the desired
signal and the MU interference for the joint analog beamformer design [
106 , 107 , 121 , 109 , 108 , 118 ] . Then, a novel low-complexity
practical algorithm for the design of analog beamformers is highly
desirable.

In the second-stage of the hybrid precoding design, all the users feed
back the downlink equivalent CSI to the BS based on the jointly designed
analog beamformers:

  -- -------- -- -----
     @xmath      (8)
  -- -------- -- -----

where @xmath , @xmath . The digital precoder of the BS based on the
feedback of equivalent channel to manage the MU interference

  -- -- -- -----
           (9)
  -- -- -- -----

However, explicit CSI feedback from users is still required for
estimating these channel. In practice, CSI feedback may cause high
complexity and extra signallings overhead. In addition, there will be a
system rate performance degradation due to the limited amount of the
feedback and the limited resolution of CSI quantization.

Therefore, a low computational complexity mmWave channel estimation
algorithm, which does not require explicit CSI feedback, is necessary to
unlock the potential of hybrid mmWave systems.

#### 2.3 Combination of MmWave Systems and A Small-cell Scenario

To further improve the network spectral efficiency, the small-cell
scenario has been proposed to cooperate with mmWave systems [ 22 , 37 ,
119 ] . In fact, the combination of hybrid mmWave systems and a
small-cell scenario is still unexplored and possesses many exciting
research opportunities [ 37 ] . For example, cell shrinking/small-cell
scenario can bring numerous benefits for hybrid mmWave systems. In
particular, it facilitates the reuse of the same piece of spectrum
across a large geographic area for achieving a high network spectral
efficiency [ 122 ] and reducing of the severe large-scale propagation
path loss by shortening the distances between transceivers [ 22 , 119 ]
. For the multi-small-cell mmWave network, the interference received at
the desired user originates from two sources, as illustrated in Figure
@xmath of [ 119 ] : interference among different BSs and interference
within the desired cell. It is mentioned in [ 22 ] that, mmWave beams
are highly directional, which completely changes the interference
behavior as well as the sensitivity to beams misalignment. In
particular, the interference adopts an on/off behavior where strong
interference occurs intermittently [ 22 ] . With a shrinking cell
radius, distances from neighbouring BSs to the desired user decrease,
which may lead to severe inter-cell interference to the desired user.
Recently, it is also mentioned in work [ 123 ] that the received
interference significantly increases when directional transmission is
simultaneously adopted in both transceivers for the same amount of total
emitted energy. Besides, due to the impact of imperfect CSI on the
design of downlink precoder, the desired BS will cause severe intra-cell
interference on the desired user. Thus, for the multi-small-cell mmWave
downlink transmission with imperfect CSI and a large number of antennas,
the desired user may suffer severe intra-cell and inter-cell
interference. Hence, it is necessary to study the performance in the
multi-small-cell hybrid mmWave network.

#### 2.4 MmWave Channel Estimation

Several channel estimation algorithms are widely adopted in different
works, such as multi-resolution hierarchical codebook algorithms,
compress sensing algorithms, open-loop beamforming algorithms, and
pilot-aided algorithms, cf. [ 24 , 124 , 125 , 126 , 59 , 127 , 26 , 128
, 129 , 130 , 131 , 132 , 133 , 134 , 135 , 112 , 5 , 60 , 57 , 37 , 136
] . Some of the algorithms mentioned above are based on the assumption
of sparse mmWave channels, which may not hold true for some scenarios as
shown recent field measurements. The field test results show that both
strong LOS components and non-negligible scattering components may exist
in mmWave propagation channels, especially in urban areas, e.g. building
valley environment [ 108 , 107 , 109 , 101 , 29 , 102 ] . Therefore, we
introduce two widely adopted algorithms which do not rely on the
assumption of sparse mmWave channels.

##### 2.4.1 Pilot-aided Channel Estimation and Pilot Contamination:

Pilot-aided channel estimation, which relies on orthogonal pilot
symbols, is widely adopted by MIMO systems and is suitable for sparse or
non-sparse environments. The majority of contributions in the literature
considered that massive MIMO systems rely on pilot sequences to estimate
CSI [ 21 , 53 , 44 , 28 , 96 ] . Due to the limited orthogonal pilot
resources, they must be reused across different cells. Thus, the reuse
of orthogonal pilot sequences causes interference during channel
estimation, which is known as pilot contamination [ 53 , 28 ] . As a
result, the downlink transmission based on the CSI obtained via
contaminated pilots causes severe intra-cell and inter-cell interference
in the desired cell. In fact, pilot contamination is considered as a
fundamental performance bottleneck of the conventional multi-cell MU
massive MIMO systems, since the resulting channel estimation errors do
not vanish even if the number of antennas is sufficiently large, cf. [
28 , 86 , 53 , 137 , 35 , 46 , 138 , 139 ] .

Recently, various algorithms [ 53 , 60 , 140 , 141 , 142 , 143 , 58 , 63
, 144 ] have been proposed to alleviate the impact of pilot
contamination, e.g. data-aided iterative channel estimation algorithms,
pilot design algorithms, multi-cell minimum mean square error (MMSE)
based precoding algorithm, and so forth. However, some algorithms, e.g.
multi-cell MMSE algorithm, are mostly based on the assumption that the
desired BS can have perfect knowledge of covariance matrices of
pilot-sharing users in neighbouring cells, which is overly optimistic.
Besides, the condition that the desired BS has the perfect knowledge of
covariance matrices is a necessary but not sufficient condition for
pilot contamination mitigation, cf. [ 58 , 63 , 144 ] . The algorithm
proposed in [ 58 ] requires that covariance matrices of pilot-sharing
users in neighbouring cells are orthogonal, which is unlikely in
practice [ 144 ] . Also, the requirement of [ 63 ] for completely
eliminating pilot contamination is that the number of antennas equipped
at the BS and the size of a coherence time block jointly go to infinity.
In the literature, most of existing multi-cell massive MU-MIMO works for
pilot contamination [ 28 , 53 , 22 , 60 , 86 ] assumed that cross-cell
channels from pilot-sharing users in neighbouring cells to the desired
BS are Rayleigh fading channels with zero means. However, as discussed
in Section IV of [ 145 ] , it is probably not accurate for modeling the
inter-cell interference as a Gaussian random variable with a small-cell
setting. In fact, recent field measurements have confirmed that the
strongest angle-of-arrival/angle-of-departure (AoA/AoD) components
always exist in the inter-cell mmWave channels in small-cell systems [
101 , 29 , 102 , 146 ] . Besides, the mean values of cross-cell channels
are not zero and different from each other. In other words, the
distribution of cross-cell mmWave channels is different from that of the
sub- @xmath GHz channels. Thus, the results obtained in works mentioned
above for pilot contamination mitigation and performance analysis, e.g.
[ 28 , 53 , 22 , 60 , 144 , 37 ] , cannot be applied directly.
Furthermore, a thorough study on the impact of pilot contamination in
such a practical network system with small cell radius has not been
reported yet.

##### 2.4.2 Open-Loop Beamforming Channel Estimation:

Channel estimation of practical mmWave systems may rely on AoA
estimation in mmWave channels [ 37 , 33 , 32 ] . As a result, for mmWave
channel estimation, the open-loop beamforming (OLB) channel estimation
has been widely adopted. Generally, the OLB algorithm is widely used in
analog beamforming and hybrid precoding. In particular, the BS transmits
@xmath beamforming vectors to its users. Then, each user reports the
index of a beam with the largest gain in the @xmath beams via a feedback
link with @xmath numbers of bits. However, due to the limited amount of
feedback bits, the OLB algorithm does not allow the BS to accurately
estimate the channel responses of a large number of users.
Interestingly, fully digital systems, which can be considered as a
subcase of hybrid systems, can also adopt the OLB algorithm for AoAs
estimation [ 37 , 147 ] . Thus, the fully digital system, which contains
more RF chains than analog and hybrid structures, can simultaneously
transmit predesigned beams in all estimation directions., e.g. [ 148 ,
135 , 149 , 114 , 29 ] . For the OLB channel estimation, the required
number of beams depends on the required resolutions and is predesigned
by the codebook. The number of beams for AoA estimation does not
necessarily scale up with the number of transmit antennas. However, to
serve an area with an increasing user density, it is expected that the
BS should increase the spatial resolution. For example, if the system
requires an half-power beam width (HPBW) coverage for the OLB training,
that the required number of beams should be @xmath [ 111 ] , where
@xmath is the number of antennas equipped at the BS. In this case, the
required number of beams for the OLB training scales with an increasing
number of antennas, which may not be suitable for mmWave systems
employing massive MIMO technology. In fact, it is expected that the
required coherence time resources of channel estimation for mmWave
massive MIMO systems shall neither scale up with the number of users nor
with the number of antennas [ 37 , 41 , 33 ] . Therefore, a simple AoA
channel estimation algorithm with low overhead is highly desirable for
hybrid mmWave system design.

#### 2.5 TDD or FDD Feedback?

In practice, the conventional fully digital systems and the hybrid
systems are designed based on different hardware architectures. Hence,
intuitively, the channel estimation algorithms for hybrid mmWave systems
are different from that for fully digital systems. Currently, the
majority of contributions in the literature focus on the development of
CSI feedback based channel estimation methods for frequency division
duplex (FDD) hybrid mmWave systems, e.g. [ 3 , 32 , 150 , 96 , 118 , 10
] . This is motivated by the assumption of the sparsity of mmWave
channels that the numbers of resolvable AoA/AoD paths are finite and
limited. Thus, the CSI acquisition via feedbacks only leads to a small
amount of signaling overhead compared to non-sparse CSI acquisition.
Generally, due to the high propagation path loss, the sparsity may only
exist in outdoor long distance propagation mmWave channels [ 102 ] . In
some scenarios, the assumption of the sparsity of mmWave channel may not
hold anymore. For example, for practical urban micro-cell (UMi)
scenarios, such as the city center, the number of scattering clusters
increases significantly and the channels are expected to be non-sparse.
In [ 101 , 29 , 102 ] , recent field test results, as well as
ray-tracing simulation results, have shown that reflections from street
signs, lamp posts, parked vehicles, passing people, etc., could reach a
receiver from all possible directions in urban micro-cell (UMi)
scenarios. In other words, the AoAs of scattering components between the
users and the BS are uniformly distributed between @xmath . In [ 151 ] ,
the authors revealed that the presence of significant amount of
scatterers in propagation environment has a non-negligible impact on the
achievable rate performance of FDD systems when the conventional CSI
feedback algorithms are adopted. Besides, the required amount of
feedback signalling overhead increases tremendously with the number of
scattering components, consuming a significant portion of system
resources [ 3 ] . Moreover, recent field test results have also verified
that, for both fully digital and hybrid massive MIMO systems in
different channel environments, time division duplex (TDD) based
beamforming exploiting channel reciprocity for channel estimation can
outperform the FDD based beamforming scheme utilizing CSI feedback in
terms of achievable sum-rate [ 151 , 107 ] . To overcome the
aforementioned common drawbacks of conventional CSI feedback based FDD
mmWave channel estimation algorithms, a TDD-based beamforming channel
estimation algorithm for mmWave channels is strongly welcomed. However,
time synchronization and calibration issues between the forward and
reverse links need to be taken into account [ 18 ] .

#### 2.6 Hardware Impairments

In practice, considering the high cost and the high complexity of
hardware for high frequency bands, it is likely to build mmWave systems
with low-cost components that are prone to hardware imperfection. Thus,
constraints due to non-ideal hardware should be taken account in the
designs of mmWave MIMO systems. In practice, hardware components may
have various types of impairments that may degrade the achievable rate
performance. For example, practical transceiver hardware is impaired by
phase noise, limited phase shifters resolution, non-linear power
amplifiers, in-phase/quadrature (I/Q) imbalance, and limited ADC/DAC
resolution [ 152 , 83 , 153 , 154 , 136 , 114 , 88 ] .

Generally, three different hardware impairments are considered in the
literatures, e.g. additive distortions, incorporate multiplicative
phase-drifts, and quantization loss caused by low-resolution ADC/DAC.
The authors of [ 152 ] proved that for a fully digital massive MIMO
system, the additive distortion caused by hardware impairments creates
finite ceilings on the channel estimation accuracy and on the
uplink/downlink capacity. In other words, the system performance cannot
be improved by increasing the number of antennas equipped at the BS as
well as the signal-to-noise ratio (SNR). In addition, the work in [ 153
] concluded that the impact of phase error on hybrid beamforming has a
further reduction on the potential gain brought by mmWave systems. In
fact, the achievable rate degradation caused by phase errors can be
compensated by simply employing more transmit antennas, e.g. phase
errors in phase shifters induced by thermal noise, transceiver RF
beamforming errors caused by AoA estimation errors, and channel
estimation errors affected by independent additive distortion noises [
152 , 83 , 153 ] . However, the rate performance degradation caused by
joint hardware imperfections, i.e., random phase errors, transceiver
analog beamforming errors, and channel estimation errors, has not been
thoroughly discussed.

### 3 Thesis Outline and Contributions

The main contributions and the outline of the thesis are summarized as
follows.

In Chapter @xmath , we investigate channel estimation and MU downlink
transmission of a TDD massive MIMO system in mmWave channels. We propose
a tone-based linear search algorithm to facilitate the estimation of
AoAs of the strongest LOS (SLOS) channel component as well as scattering
components of the users at the BS. Based on the estimated AoAs, we
reconstruct the SLOS component and scattering components of the users
for downlink transmission. We then derive the achievable rates of MRT
and ZF precoding based on the SLOS component and the
SLOS-plus-scattering components (SLPS), respectively. Taking into
account the impact of pilot contamination, our analysis and simulation
results show that the SLOS-based MRT can achieve a higher data rate than
that of the traditional Pilot-aided-CSI based (PAC-based) MRT, under the
same mean squared error (MSE) of channel estimation. As for ZF
precoding, the achievable rates of the SLPS-based and the PAC-based are
identical. Furthermore, we quantify the achievable rate degradation of
the SLOS-based MRT precoding caused by phase quantization errors in the
large number of antennas regime. We show that the impact of phase
quantization errors on the considered systems cannot be mitigated by
increasing the number of antennas and therefore the resolutions of RF
phase shifters is critical for the design of efficient mmWave massive
MIMO systems.

The results in Chapter 2 have been presented in the following
publications:

-    L. Zhao , G. Geraci, T. Yang, D. W. K. Ng, and J. Yuan, “A
    tone-based AoA estimation and multiuser precoding for millimeter
    wave massive MIMO,” IEEE Trans. Commun. , vol. 65, no. 12, pp.
    5209–5225, Dec. 2017.

-    L. Zhao , T. Yang and G. Geraci and J. Yuan “Downlink multiuser
    massive MIMO in Rician channels under pilot contamination” in Proc.
    IEEE Intern. Commun. Conf. (ICC) , Kuala Lumpur, May 2016, pp. 1–6.

In Chapter 3, we develop a low-complexity channel estimation for hybrid
mmWave systems, where the number of RF chains is much lower than the
number of antennas equipped at each transceiver. The proposed mmWave
channel estimation algorithm first exploits multiple frequency tones to
estimate the strongest AoAs at both BS and user sides for the design of
analog beamforming matrices. Then all the users transmit orthogonal
pilot symbols to the BS along the directions of the estimated strongest
AoAs in order to estimate the channel. The estimated channel will be
adopted to design the digital ZF precoder at the BS for the multi-user
downlink transmission. The proposed channel estimation algorithm is
applicable to both non-sparse and sparse mmWave channel environments.
Furthermore, we derive a tight achievable rate upper bound of the
digital ZF precoding with the proposed channel estimation algorithm
scheme. Our analytical and simulation results show that the proposed
scheme obtains a considerable achievable rate of fully digital systems,
where the number of RF chains equipped at each transceiver is equal to
the number of antennas. Besides, by taking into account the effect of
various types of errors, i.e., random phase errors, transceiver analog
beamforming errors, and equivalent channel estimation errors, we derive
a closed-form approximation for the achievable rate of the considered
scheme. We illustrate the robustness of the proposed channel estimation
and multi-user downlink precoding scheme against the system
imperfection.

The results in Chapter 3 have been presented in the following
publications:

-    L. Zhao , D. W. K. Ng, and J. Yuan, “Multi-user precoding and
    channel estimation for hybrid millimeter wave systems,” IEEE J. Sel.
    Areas Commun. , vol. 35, no. 7, pp. 1576–1590, Jul. 2017.

-    L. Zhao , D. W. K. Ng, and J. Yuan, “Multiuser precoding and
    channel estimation for hybrid millimeter wave MIMO systems,” in
    Proc. IEEE Intern. Commun. Conf. (ICC) , Paris, May 2017, pp. 1–7.

In Chapter 4, we investigate the system performance of a multi-cell MU
hybrid mmWave MIMO network. Due to the simultaneous reuse of pilot
symbols among different cells, the performance of channel estimation is
expected to be degraded by pilot contamination, which is considered as a
fundamental performance bottleneck of conventional multi-cell MU massive
MIMO networks. To analyze the impact of pilot contamination to the
system performance, we first derive the closed-form approximation
expression of the normalized MSE of the channel estimation algorithm
proposed in [ 1 ] over Rician fading channels. Our analytical and
simulation results show that the channel estimation error incurred by
the impact of pilot contamination and noise vanishes asymptotically with
an increasing number of antennas equipped at each RF chain at the
desired BS. Furthermore, by adopting ZF precoding in each cell for
downlink transmission, we derive a tight closed-form approximation of
the average achievable rate per user. Our results unveil that the
intra-cell interference and inter-cell interference caused by pilot
contamination over Rician fading channels can be mitigated effectively
by simply increasing the number of antennas equipped at the desired BS.

The results in Chapter 4 have been accepted to appear in the following
publications:

-    L. Zhao , Z. Wei, D. W. K. Ng, J. Yuan, and M. C. Reed, “Multi-cell
    hybrid millimeter wave systems: Pilot contamination and interference
    mitigation,” IEEE Trans. Commun. , vol. 66, no. 11, pp. 5740-5755,
    Nov. 2018.

-    L. Zhao , Z. Wei, D. W. K. Ng, J. Yuan and M. C. Reed, “Mitigating
    pilot contamination in multi-cell hybrid millimeter Wave Systems,”
    in Proc. IEEE Intern. Commun. Conf. (ICC) , Kansas City, May 2018.

In Chapter 5, future works and conclusions are presented.

## Chapter \thechapter Fully Digital mmWave MIMO Systems: A Tone-based
Channel Estimation Strategy

### 4 Introduction

In this chapter, we consider a mmWave MU massive MIMO system. First, we
propose a novel and simple channel estimation algorithm, which is
inspired by the signal processing of radar and sonar systems. We
illustrate the proposed channel estimation for mmWave channels via
analysis and simulation results. In addition, we analyze the rates
achieved by utilizing MRT and ZF precoding, which are based on the
estimated components of mmWave channels. Furthermore, we discuss some
hardware constraints that may affect the achievable rate performance,
e.g. the limited resolutions of digital RF phase shifters. Our main
contributions are summarized as follows:

-   We propose a novel MU channel estimation scheme via tone-based AoA
    estimation. By introducing multiple frequency tones, the proposed
    scheme can simultaneously and efficiently estimate all users’ AoAs.
    More importantly the accuracy of the proposed channel estimation
    algorithm increases with the number of antennas available at the BS.
    Compared to existing the pilot-aided channel estimation and the OLB
    channel estimation methods, our proposed AoA estimation over Rician
    fading channles neither causes pilot contamination nor requires a
    channel estimation overhead which increases with the numbers of
    users and antennas equipped at the BS.

-   Based on various components of the estimated CSI, we derive the
    achievable rates of the MRT and the ZF precodings. In particular,
    the SLOS is adopted for the SLOS-based MRT. In addition, the
    combination of multiple AoAs from the users to the BS are utilized
    for the SLPS-based ZF downlink transmissions. We also derive
    closed-form approximations for the achievable rates of the MRT and
    the ZF precoding strategies in mmWave channels when the traditional
    PAC estimation is adopted. We analytically show that the achievable
    rates per user for the SLPS-based and the PAC-based ZF precoding
    strategies are identical, if the MSEs of CSI are the same. Also, it
    is interesting to note that the achievable rate per user of the
    SLOS-based MRT is better than that of the PAC-based MRT.

-   To obtain system design insights, we perform an asymptotic analysis
    on achievable rates of the MRT and ZF precoding strategies. The
    analysis and simulation results verify that the mmWave massive MIMO
    can achieve a high sum rate performance even with dense users
    population. On the other hand, we show that the resolutions of RF
    phase shifters is critical for mmWave massive MIMO design. In fact,
    the negative impact of limited resolutions of shifters on the system
    rate performance cannot be mitigated by increasing the number of
    antennas.

The rest of the chapter is organized as follows. Section 2.2 describes
the system model considered in the chapter. In Section 2.3, we detail
the proposed channel estimation algorithm. In Section 2.4, we derive the
downlink achievable rate performance based on the CSI estimated by the
proposed algorithm. In Section 2.5, we compare rate performance between
the conventional algorithms and that investigated in Section 2.4. The
impact of imperfect hardware are discussed in Section 2.6. Finally,
Section 2.7 summarizes the chapter.

### 5 System Model

In this chapter, an mmWave massive MU MIMO system is considered, which
is shown in Figure 2 . The system consists of @xmath neighboring cells
and there are @xmath users per cell. The BS in each cell is equipped
with @xmath antennas to serve the @xmath single-antenna users
simultaneously, @xmath . Due to the significant propagation attenuation
at mmWave, the system is dedicated to cover a small area, e.g. with a
cell radius of approximately @xmath m. The channels from the BS to the
users in the same cell are modeled by Rician fading and with large
K-factors ( @xmath @xmath @xmath dB) [ 29 , 155 , 156 ] . We assume that
the users and the BSs in all cells are fully synchronized in time and
that the uplink and downlink in each cell adopt TDD [ 28 , 53 ] .

Let @xmath be the uplink channel matrix between the users and the BS in
the desired cell. We assume that @xmath is a narrowband slow
time-varying block fading Rician fading channel, i.e., the channel is
constant in a time slot but varies slowly from one time slot to another.
Each time slot is divided into three phases: channel estimation phase,
uplink transmission phase, and downlink transmission phase. We denote
the @xmath -th column vector of @xmath as @xmath representing the
channel vector between the BS and user @xmath in the desired cell.
According to the field measurement of mmWave channels [ 29 ] , a strong
LOS component is expected and other propagation paths can be considered
as scattering components. We assume that the large scale path loss can
be compensated by using automatic gain control (AGC). Thus, the channel
vector of user @xmath can be expressed as a combination of a
deterministic strongest LOS channel vector @xmath and a multiple-path
scattered channel vector @xmath , i.e.,

  -- -- -- ------
           (10)
  -- -- -- ------

where @xmath is the Rician K-factor of user @xmath , which denotes the
ratio between the power of the SLOS component and the power of the
scattering components. In general, we can re-express Equation ( 10 ) as

  -- -------- -- ------
     @xmath      (11)
  -- -------- -- ------

where @xmath , @xmath . In addition, we have @xmath , and @xmath . We
adopt uniform linear array (ULA) as in [ 135 , 157 ] . Here, @xmath
@xmath is the @xmath -th column vector of the SLOS matrix @xmath and it
can be expressed as

  -- -------- -- ------
     @xmath      (12)
  -- -------- -- ------

where @xmath is the distance between the neighboring antennas at the BS,
@xmath is the wavelength of the carrier frequency, and @xmath is the AoA
of the SLOS component from user @xmath to the BS in the desired cell.
For convenience, we set @xmath for the rest of the chapter which is an
assumption commonly adopted in the literature [ 158 , 159 ] . The
scattering component @xmath is the @xmath -th column vector of the
scattering matrix @xmath and can be expressed as

  -- -------- -- ------
     @xmath      (13)
  -- -------- -- ------

where @xmath denotes the number of propagation paths, @xmath is the
complex path gain and @xmath is the AoA associated to the @xmath -th
propagation path [ 117 ] , and @xmath is the @xmath -th propagation path
of user @xmath given by

  -- -------- -- ------
     @xmath      (14)
  -- -------- -- ------

We assume that all the users have various AoAs which are uniformly
distributed over @xmath and they are separated by at least hundreds of
wavelengths [ 28 , 160 ] . To facilitate the investigation of channel
estimation and downlink transmission, we assume that perfect long-term
power control is performed to compensate for path loss and shadowing
between the desired BS and the desired users and that equal power
allocation is used among different data streams of the users [ 3 , 115 ,
46 ] .

### 6 Channel Estimation and Downlink Transmission

In this section, we first propose a novel MU mmWave channel estimation
algorithm based on various single carrier frequency tones, which is
inspired by signal processing of radar and sonar systems [ 147 , 161 ] .
Based on the estimated SLOS component and scattering components, we
propose the SLOS-based MRT and the SLPS-based ZF precoders for MU
downlink precoding. In addition, the achievable rate performance of
these two precoders are derived and used for comparison in the following
section.

#### 6.1 MU MmWave Channel Estimation

We note that the channel estimation of mmWave channels is equivalent to
the AoA estimation of the SLOS and scattering components. In this
section, we propose to use the frequency tone resources to
simultaneously estimate the AoAs of the users without causing collision
among different cells. The details are discussed in the following
paragraphs.

At the beginning of a coherence time block, all the users register at
the desired BS and transmit unique tones separated in frequency. This
initialization can be done during the time synchronization in the
handshaking between the desired BS and the users. The frequency tone of
user @xmath for the AoA estimation is a single carrier continuous wave
(CW) signal, @xmath , where @xmath is the carrier frequency for user
@xmath and @xmath is the time variable of the tone signal. We also
denote that @xmath is the system carrier frequency, @xmath is the total
available bandwidth for all tone frequencies, and @xmath is at the very
center of the total bandwidth.

For the channel estimation, we choose to transmit tone signals from the
users to the BS via one of the omni-directional antennas equipped at the
users.

The reasons are three:

-    The utilizing of only one omni-directional antenna at the user to
    transmit the tone signal is to sound mmWave channels in every
    direction;

-    In practice, the number of antennas equipped at the users is much
    smaller than the number of antennas equipped at the BS, @xmath . As
    long as a sufficiently large number of antennas, @xmath , is
    equipped at the BS, the power gain loss can be compensated;

-    For the AoA estimation, tone signal is robust to the background
    noise. It is known that the thermal noise power is determined by the
    signal bandwidth and the noise spectral density level. Due to the
    extreme narrow bandwidth of the tone signal, the receive thermal
    noise power is low. Thus, it is easy to detect the tone signal even
    with a slightly low receive signal power [ 147 ] .

For any two different frequency tones @xmath and @xmath , @xmath , in
the @xmath , if the frequency tones satisfy the following condition,

  -- -------- -- ------
     @xmath      (15)
  -- -------- -- ------

the AoA estimation performance by using ULA with any tones in @xmath is
identical ² ² 2 The difference of different carrier wavelengths is less
than @xmath micrometers for a carrier frequency of @xmath GHz. . The
condition also can be re-expressed as @xmath [ 111 ] . For example, if
the system operates at a carrier frequency of @xmath GHz, then @xmath is
@xmath MHz. Any frequency tones in the frequency range of @xmath have an
identical performance in the AoA estimation. However, the frequency
tones will be affected due to users’ doppler frequency shift @xmath .

In addition, to overcome the collisions caused by users’ doppler
frequency shift @xmath between neighboring frequency tones, a frequency
protectional gap @xmath need to satisfy

  -- -------- -- ------
     @xmath      (16)
  -- -------- -- ------

For example, if the system operates at @xmath GHz and the maximum speed
of users is @xmath km/h, then the minimum frequency protection gap is
@xmath kHz. In practice, a single carrier frequency CW signal can be
easily generated by a commercial @xmath GHz signal generator [ 162 ] ,
which has a narrow bandwidth of @xmath @xmath @xmath Hz. Therefore, for
a bandwidth of @xmath MHz we can generate @xmath single carrier CW
signals, which can estimate @xmath users’ AoAs simultaneously. For
mmWave massive MIMO systems, according to the 3GPP medium user density
standard [ 163 ] , the number of users in each cell ranges from @xmath
to @xmath . Therefore, the frequency resources can support at least
three cells without causing any collision in the AoA estimation among
different cells.

The basic idea of utilizing frequency tone signal for the AoA estimation
is borrowed from single-carrier monopulse radar systems [ 147 ] . The
key idea is that the narrow-band single-carrier frequency CW signal can
be performed for the AoA estimation. Therefore, orthogonal pilot symbols
are no longer required for the AoA estimation of mmWave channels. In
addition, different users can be distinguished at the BS via different
carrier frequencies. At the beginning of a coherence time block, all the
users register at the desired BS. At the same time, the desired BS
instructs all the users’ unique tone carrier frequencies. At the user’s
side, according to the allocated tone carrier frequencies, a
single-carrier frequency CW pass-band signal is created in the user’s RF
chain and broadcasted via one of its antennas. For example, the
frequency tone of user @xmath for the AoA estimation is @xmath , where
@xmath is the carrier frequency for user @xmath and @xmath is the time
variable of the tone signal. The pass-band received signal of user
@xmath at the BS is given by

  -- -------- -- ------
     @xmath      (17)
  -- -------- -- ------

where @xmath is the AWGN vector at the BS antennas, whose entries follow
independent and identically distributed (i.i.d.) @xmath and @xmath is
the noise variance at each antenna of the BS. At the BS, different
frequency tones will be generated as the reference signals for the
down-conversion of received signals, as shown in Figure 3 . Take user
@xmath for example, the reference signal is @xmath at the BS and the
received signal after down-conversion is given by

  -- -------- -------- -- ------
     @xmath   @xmath      
     @xmath   @xmath      (18)
  -- -------- -------- -- ------

Then the mixed signal will pass through different narrow low pass
filters with an appropriate filter bandwidth to remove high frequency
components [ 147 ] . After the high frequency components are filtered
and removed, the received base-band signal which contains the AoA
information can be expressed as

  -- -------- -- ------
     @xmath      (19)
  -- -------- -- ------

To facilitate the estimation of AoAs, we perform a linear search in the
angular domain ranged from @xmath to @xmath with an angle search step
size of @xmath , where @xmath is the maximum number of search steps. The
AoA detection matrix for all users is @xmath , where @xmath is a column
vector of matrix @xmath given by

  -- -------- -- ------
     @xmath      (20)
  -- -------- -- ------

where @xmath , @xmath , stands for a potential AoA of user at the BS. We
note here, the coefficient @xmath appears in Equations (2.11) is the
normalization factor. The size of matrix @xmath represents the
computational complexity of AoA estimation. We then utilize different
AoA detection vectors, e.g. @xmath to obtain detection output of user
@xmath . Specifically, for @xmath ,

  -- -------- -- ------
     @xmath      (21)
  -- -------- -- ------

Now we obtain the detection outputs @xmath . The potential AoA of the
SLOS, which leads to the maximum value among the @xmath observation
directions, i.e.,

  -- -------- -- ------
     @xmath      (22)
  -- -------- -- ------

is considered as the SLOS component of user @xmath . If the number of
search steps @xmath is sufficiently large, we accurately approximate the
channel of user @xmath , @xmath , by using AoAs from the @xmath
strongest detection outputs. We first sort the detection outputs @xmath
in descending order and obtain the ordered detection output vector as
@xmath , where @xmath . Then, we can obtain the estimated channel @xmath
as

  -- -------- -- ------
     @xmath      (23)
  -- -------- -- ------

where @xmath is the @xmath -th strong AoA given by

  -- -------- -- ------
     @xmath      (24)
  -- -------- -- ------

and the Rician K-factor is given by

  -- -------- -- ------
     @xmath      (25)
  -- -------- -- ------

We note that the exact number of combined AoAs @xmath is hard to obtain
in practice. As a result, the number of combined AoAs is set as a
reasonable value for practical implementation. In the sequel, we set as
@xmath for simplicity [ 102 ] . In fact, the tone-based AoA channel
estimation error is mainly caused by the uncertainty of @xmath .

Utilizing the estimated SLOS component as the estimated channel, the MSE
of the proposed algorithm in the high SNR regime is given by

  -- -------- -------- -- ------
     @xmath   @xmath      (26)
  -- -------- -------- -- ------

We demonstrate and validate the accuracy of the proposed AoA estimation
via simulation in Figures 4(a) , 4(b) , 4(c) , and 4(d) . The accuracy
of the AoA estimation is determined by the number of search steps @xmath
as well as the number of strongest AoAs @xmath .

Searching for @xmath can be processed via baseband digital signal
processing. More details on the Cramér-Rao lower-bound of the ULA AoA
estimation can be found in [ 161 ] . In practice, larger number of
antennas @xmath means higher spatial resolution for AoAs estimation.

In Figures 4(a) and 4(b) , we illustrate the proposed AoA estimation for
different @xmath . The SNR of tone signal adopted in the simulations for
Figures 4(a) and 4(b) is @xmath dB.

With a large @xmath , the impact of noise @xmath on the AoA estimation
is mitigated, as shown in Figures 4(a) and 4(b) . These figures indicate
that the proposed algorithm is robust to the AWGN when the BS is
equipped with a sufficiently large number of antennas. If the norm of
the angle difference between the estimated SLOS component and the actual
SLOS component is less than @xmath , we denote the estimation of the
SLOS component as successful.

Figure 4(c) shows the successful rate of the AoA estimation achieved by
the proposed algorithm versus the Rician K-factor for different number
of antennas @xmath . It is clear that the successful rate increases with
the number of antennas as well as with the Rician K-factor. In addition,
we also see that the successful rates of the SLOS estimation for @xmath
dB with @xmath are almost the same as those for @xmath dB with @xmath .
Figure 4(d) shows the normalized MSEs of channel estimation versus the
Rician K-factor for different number of antennas @xmath . It shows that
the SLPS algorithm has better MSE performance than the SLOS algorithm.
In Figure 4(d) , the correctness of Equation ( 26 ) is also verified. In
Figures 4(c) and 4(d) , we also observe that the improvement in MSE is
saturated for a large number of antennas. Compared to conventional
orthogonal pilot-aided and the OLB algorithm approaches for channel
estimation [ 28 , 53 , 37 ] , the proposed tone-based AoA estimation
scheme is simpler and the required coherence time resources will neither
increase with the number of users nor the number of antennas. In
addition, the proposed channel estimation relies on the antenna array
gain for AoA estimation and the tone-based AoA estimation can be
extended to hybrid systems by following a similar approach as in [ 1 ] .
Literally, the more antennas used, the more antenna array gain can be
obtained. Therefore, it is expected that the required power of the
transmitted tone is low in the considered massive MIMO mmWave system.
More importantly, the proposed tone-based AoA estimation algorithm can
avoid the system performance degradation due to pilot contamination.
With a sufficiently large number of antennas, the proposed algorithm can
accurately estimate the SLOS component as well as scattering components.

In mmWave systems, channel estimation is important for unlocking the
potential of the system performance. Majority of contributions in the
literature focus on the development of CSI feedback based channel
estimation methods for hybrid mmWave systems, e.g. [ 3 , 32 , 150 , 96 ,
118 , 10 ] . In practice, the 5G NR specification includes a set of
basic beam-related procedures for the above 6 GHz CSI acquisition [ 164
] . The beam management of 5G NR mmWave systems consists of four
different operations which are shown in Figure 5 , i.e., beam sweeping,
beam measurement, beam determination, and beam reporting. Taking a
single antenna user in 5G NR stand-alone (SA) downlink scheme for
example, the BS sequentially transmits synchronization signals (SS) and
CSI reference signals (CSI-RSs) to the users by using a predefined
codebook of directions. Then, the users search and track their optimal
beams by measuring the collected CSI-RSs. At the end of CSI acquisition
phase, beam reporting, the users feed back the determined beam
information (beam quality and beam decision) and the random access
channel (RACH) preamble to the BS.

Mainly, the difference between the channel estimation algorithm adopted
in practical mmWave systems and the proposed tone-based algorithm is the
overhead signalling consumed for the channel estimation phase. Figure 6
illustrates the overhead signalling difference between our proposed
tone-based algorithm and the practical 5G NR mmWave channel estimation
protocol. It shows that utilizing tone signals can significantly save
the overhead signalling resource. In addition, the MSE performance of
aforementioned algorithms are the same. The reason is simple and
straightforward. The antenna array adopted in these two algorithms to
facilitate the channel estimation is same and has the same Cramér Rao
lower bound (CRLB).

In the following sections, we analyze the system rate performance of
downlink transmission based on the estimated CSI via the proposed
tone-based AoA estimation scheme.

### 7 Performance Analysis

For the downlink transmission performance analysis, we first discuss the
adopted assumptions. In reference [ 101 ] , which is based on recent
field test results, the authors suggested that the angles between the
users and the BS are uniformly distributed between @xmath . In addition,
reference [ 102 ] adopted ray-tracing model to characterize the AoAs of
users at different locations. The ray-tracing simulation results are
verified and supported by field test results (Figure 5 of [ 102 ] ). It
is shown that reflections from street signs, lamp posts, parked cars,
passing people, etc., could reach the receiver from all directions.
Based on these field test results, it is clear that the AoAs between the
BS and the users are caused by many clusters in the propagation
directions. In fact, the clusters around different separated users are
different with high probability in the urban areas as shown in Figure 2
of [ 102 ] . Although some users may share part of the clusters [ 150 ]
, to simplify the average achievable rate performance analysis, we
assume that the set of AoAs of multi-path between different users will
be different with high probability [ 165 ] in the large number of
antennas regime. In other words, the scattering components of different
users are assumed not highly correlated due to the random clusters in
the urban scenario in the considered system. Specifically, in the large
number of antennas regime, for @xmath , it is expected that

  -- -------- -- ------
     @xmath      (27)
  -- -------- -- ------

We assume that given the random location of the scatters, the set of
AoAs of multi-path between different users will be different with high
probability [ 165 ] . Therefore, for @xmath , we have the following
result:

  -- -------- -- ------
     @xmath      (28)
  -- -------- -- ------

#### 7.1 SLOS-based MRT Precoding

MRT is considered as the simplest precoding strategy, due to its low
computational complexity. In [ 159 ] , the authors proved that
single-user massive MIMO systems are more suitable to exploit strong LOS
components of Rician fading channels by comparison with pure Rayleigh
fading environments. In this section, we study the rate performance of
the considered MU mmWave systems when MRT downlink transmission is
employed and designed based on the estimated SLOS component. To
facilitate the following study, we assume that the perfect SLOS
component is available ³ ³ 3 It was verified by simulation that, for the
proposed SLOS estimation with a sufficiently large number of antennas at
the BS, e.g. @xmath antennas, our proposed SLOS estimation algorithm is
highly accurate. The simulation results are shown in Figure 4(c) . and
the downlink MRT precoder is given by @xmath . The rate performance
achieved by using the MRT precoder @xmath can be considered as the
system performance benchmark. We then express the received signal of
user @xmath as

  -- -------- -- ------
     @xmath      (29)
  -- -------- -- ------

where @xmath is the power normalization factor, @xmath is the
transmitted signal from the BS to user @xmath in the desired cell,
@xmath , and @xmath is the transmit power. We then present the
signal-to-interference-plus-noise ratio (SINR) expression of user @xmath
as

  -- -------- -- ------
                 
     @xmath      (30)
  -- -------- -- ------

where @xmath represents the transmit SNR. In the large number of
antennas and high receive SNR regime, the approximated average
achievable rate of the MRT precoding can be expressed as

  -- -------- -- ------
     @xmath      (31)
  -- -------- -- ------

where @xmath @xmath in Equation ( 31 ) is considered as the interference
to the desired user @xmath caused by SLOS components of different users.
In addition, @xmath @xmath decreases significantly with an increasing
number of antennas @xmath . @xmath @xmath in Equation ( 31 ) is
considered as the interference caused by the scattering parts, which is
determined by the Rician K-factor and the number of users to the number
of antennas ratio.

#### 7.2 SLPS-based ZF Precoding

ZF precoding is widely adopted for MU systems due to its capability in
interference suppression. It was verified by simulation that the
estimated SLPS can achieve a better MSE performance in channel
estimation than the estimated SLOS, which is shown in Figure 4(d) .
While the estimated SLPS is adopted for the design of ZF precoder, the
achievable rate of the SLPS-based ZF can be considered as the rate
performance benchmark. Based on the estimated SLPS-based uplink channel
@xmath , the downlink precoder is expressed as

  -- -------- -- ------
     @xmath      (32)
  -- -------- -- ------

The received signal at user @xmath in the desired cell is given by

  -- -------- -- ------
     @xmath      (33)
  -- -------- -- ------

where the variable @xmath is the number of neighbouring cells, @xmath is
the @xmath -th column vector of @xmath and @xmath is the normalization
factor. For the ZF precoder under the perfect CSI, the precoder matrix
is given by @xmath . Let @xmath denote the @xmath -th column vector of
@xmath @xmath , and @xmath . We re-express Equation ( 33 ) as

  -- -------- -- ------
     @xmath      (34)
  -- -------- -- ------

where @xmath denotes the @xmath -th column vector of the ZF precoder
error matrix @xmath , and @xmath denotes the transmitted signal vector.
We then express the SINR of user @xmath as

  -- -------- -- ------
     @xmath      (35)
  -- -------- -- ------

Now we summarize the achievable rate per user in the large number of
antennas and high SNR regime in the following theorem.

###### Theorem \thechapter.1.

For a large receive SNR and large number of antennas, the average
achievable rate of the ZF precoding based on the estimated CSI can be
approximated by

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      (36)
  -- -------- -------- -- ------

where @xmath , @xmath represents the @xmath -th diagonal element of
@xmath , and @xmath is the normalized MSE of proposed channel estimation
algorithm.

Proof: Please refer to Appendix A. @xmath

Observing Equation ( 36 ), the approximated average achievable rate of
the ZF precoding is bounded by above. The finite achievable rate ceiling
is mainly determined by the normalized MSE of the estimated SLPS.

### 8 Comparison with PAC-based Precoding

In this section, we analyze the achievable rates performance of the MRT
and the ZF precoders in multi-cell mmWave systems via pilot-aided
estimated CSI. The adopted CSI for the design of these precoders is
under the impact of pilot contamination, which is caused by the reuse of
orthogonal pilot symbols among different cells. The analytical results
obtained in this section will be used as a performance reference in the
subsequent sections. In particular, our analysis quantifies the
connection between rate performance and the MSE of channel estimation.

#### 8.1 PAC-MRT and PAC-ZF Precoding under Pilot Contamination

Here we study the performance of the MRT precoding based on pilot-aided
CSI in the presence of pilot contamination in mmWave channels. The pilot
contamination leads to two types of interference in the considered
system: intra-cell interference and inter-cell interference [ 28 , 53 ]
. For the uplink channel estimation, we denote the received pilot
sequences at the BS in the desired cell as

  -- -------- -- ------
     @xmath      (37)
  -- -------- -- ------

where @xmath stands for the reused orthogonal pilot sequences matrix and
@xmath is the cross-cell path loss attenuation coefficient. In Equation
( 37 ), @xmath is the channel matrix from the users in the @xmath -th
neighboring cell to the BS in the desired cell. According to the field
test, the probability of existing LOS component decreases significantly
with increasing propagation distance [ 29 ] . In this case, we model the
entries of cross-cell channels @xmath as i.i.d. random variable @xmath .

Conventionally, the MMSE channel estimation, which requires the prior
channel information, can achieve a better channel estimation performance
than LS channel estimation. However, the prior information of mmWave
channels, e.g. the Rician K-factor, is hard to obtain. Therefore, we
adopt the LS algorithm for channel estimation instead of the MMSE
algorithm, the estimated channel can be expressed as

  -- -------- -------- -- ------
     @xmath   @xmath      (38)
  -- -------- -------- -- ------

where @xmath and @xmath is the equivalent channel estimation error
matrix due to the impact of pilot contamination. Let @xmath be the
@xmath -th column of the channel estimation error matrix @xmath and the
expression of @xmath is given by

  -- -------- -- ------
     @xmath      (39)
  -- -------- -- ------

where @xmath , with entries follow @xmath , is the channel vector from
the @xmath -th neighboring cell.

The relationships between @xmath , @xmath , and @xmath can be expressed
as

  -- -------- -- ------
     @xmath      (40)
  -- -------- -- ------

where @xmath is the normalized MSE of channel estimation [ 166 ] .

In addition, we have @xmath for the desired signal in the desired cell.
The reason is that the perfect long-term power control is performed to
compensate for path loss and shadowing between the desired BS and the
desired users to facilitate the investigation of channel estimation and
downlink transmission [ 3 , 115 , 46 ] . Due to the cross-cell
propagation path loss, the received energy of desired pilot symbols at
the desired BS is significantly larger than the energy of pilot symbols
from neighboring cells to the desired BS.

For example, the @xmath meters mmWave path loss is approximately above
@xmath dB and the @xmath meters propagation path loss is about @xmath dB
[ 102 , 29 ] . The received energy of desired pilot symbols is about
@xmath dB larger than that of the energy of contaminated pilot symbols
(Table IV of [ 102 ] ). Thus, the impact of pilot contamination on the
channel estimation is assumed as @xmath .

The received signal at user @xmath with the MRT precoder @xmath is given
by

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      (41)
  -- -------- -------- -- ------

where @xmath is the normalization factor, @xmath is the downlink
precoder of user @xmath in @xmath -th cell, and @xmath accounts for
AWGN. Substituting Equation ( 10 ) into Equation ( 41 ), the received
SINR at user @xmath can be expressed as

  -- -------- -- ------
     @xmath      
     @xmath      (42)
  -- -------- -- ------

We next present an asymptotic SINR of Equation ( 42 ) in the following
corollary.

###### Corollary \thechapter.1.

As SNR and the number of antennas approach infinity, the average
achievable rate of the MRT precoding under pilot contamination can be
approximated by

  -- -------- -- ------
     @xmath      
                 (43)
  -- -------- -- ------

Proof: Please refer to Appendix B. @xmath

@xmath @xmath and @xmath @xmath of Equation ( 43 ) represent the
interference caused by the corresponding SLOS components and scattering
components of different users, respectively. In addition, @xmath @xmath
and @xmath @xmath of Equation ( 43 ) denote the intra-cell and
inter-cell interference caused only by channel estimation error due to
pilot contamination, respectively. It is interesting to note that, the
intra-cell interference in @xmath @xmath is much larger than that of the
inter-cell interference in @xmath @xmath .

It is clear that with an increasing number of antennas @xmath , the
achievable rate increases. Besides, with increasing the Rician K-factor
@xmath , the interference caused by scattering components in @xmath
@xmath of Equation ( 43 ) vanishes.

For the downlink ZF precoding, similar to the signal processing in
Equations ( 33 ) @xmath ( 34 ), @xmath is the downlink ZF precoder and
@xmath is the normalization factor.

We then express the SINR of user @xmath under the PAC-based ZF precoding
as

  -- -- -------- -- ------
        @xmath      
        @xmath      (44)
  -- -- -------- -- ------

Now we summarize the average achievable rate per user in the large
number of antennas and high SNR regime in the following corollary.

###### Corollary \thechapter.2.

For a large receive SNR and a large number of antennas, the average
achievable rate of the ZF precoding under pilot contamination can be
approximated by

  -- -------- -- ------
     @xmath      
     @xmath      (45)
  -- -------- -- ------

where @xmath , @xmath represents the @xmath -th diagonal element of
@xmath , and @xmath is the normalized MSE of LS channel estimation given
by Equation ( 40 ).

Proof: Following a similar approach as in Appendix A. @xmath

Equations ( 43 ) and ( 45 ) represent the ceiling of the achievable rate
of MU mmWave massive MIMO systems when the conventional PAC is adopted.
The performance gap between Equations ( 43 ) and ( 45 ) will be
quantized via simulation in Figure 7 in the following sections.

#### 8.2 Achievable Rate Comparison

In this section, we compare the achievable rates of the PAC-based MRT
and the PAC-based ZF precoders to the achievable rates of the SLOS-based
MRT and the SLPS-based ZF precoders, respectively. For mmWave cellular
systems, the deployment of small cell is necessary to facilitate high
data rate communications [ 102 ] . In our work, the radius of the cell
is assumed approximately less than @xmath meters. Under such a scenario,
for a reasonably large transmit power and the use of large number of
antennas, high SNR is expected to the system operating regime ⁴ ⁴ 4 By
calculating the link budget [ 102 ] , it can be shown that the
considered system operates at high SNR regimes. . In fact, the derived
downlink achievable rate analysis is based on the high SNR assumption
with practical interests for high data rate communication. For the
comparison between the achievable rates of the PAC-based ZF precoding
and the SLPS-based ZF precoding, we observe the mathematical similarity
between Equations ( 45 ) and ( 36 ). While the MSEs of two different
channel estimation are identical, i.e., @xmath , the difference between
@xmath and @xmath is negligible.

This observation will also be verified via simulation in Figure 7 .
Then, we compare the achievable rates between the SLOS-based MRT and the
PAC-based MRT and summarize the performance comparison in the following
theorem.

###### Theorem \thechapter.2.

If the Rician factor satisfies @xmath , the rate performance gap between
the proposed SLOS-based MRT and the PAC-based MRT is always larger than
@xmath , even if the MSE of pilot-aided channel estimation is @xmath ,
i.e.,

  -- -------- -- ------
     @xmath      (46)
  -- -------- -- ------

Proof: The result follows by substituting ( 43 ) and ( 31 ) into ( 46 ).
@xmath

Intuitively, the required coherence time resource for the conventional
PAC estimation, increases with an increasing number of users @xmath .
Interestingly, the time resource consumption of the proposed AoA channel
estimation algorithm, @xmath , does not increase with the number of
antennas nor the number of users. In this case, we note that the
coherence time saved by adopting the proposed algorithm is @xmath
symbols, which can be used for downlink data transmission.

In Figure 7 , we present a comparison between the achievable sum-rates
of the SLOS-based MRT, the PAC-based MRT, the SLPS-based ZF, and the
PAC-based ZF for the same MSEs of channel estimation @xmath . This
result verifies the accuracy of our derived analytical expressions in
Equations ( 31 ), ( 36 ), ( 43 ), and ( 45 ). The achievable rates of
the SLPS-based and the PAC-based ZF precoders are almost identical. As
expected, the ZF precoding can achieve a higher rate performance than
the MRT precoding due to its interference suppression capability,
especially in the high SNR regime. It is interesting that in the high
SNR regime, the SLOS-based MRT can achieve a significant performance
gain in terms of achievable rate than the PAC-based MRT. The reasons are
two-fold. First, for the SLOS-based MRT precoding, the signal energy
focuses on the strong LOS propagation path leading to a smaller amount
of signal energy leakage into the scattering paths. In fact, the less
signal energy leaks into the scattering part, the smaller inter-user
interference it will cause. In contrast, pilot-aided CSI naturally
contains scattering components, which leads to a inter-user
interference. Second, the PAC-based channel estimation error may cause
extra MU interference. However, the proposed tone-based AoA channel
estimation error, which is due to not taking into account scattering
components, does not cause extra MU interference as shown in Equation (
31 ). Thus, the SLOS-based MRT can achieve a better SINR performance
than the PAC-based MRT.

#### 8.3 Large-system Analysis

In this section, we study the system performance while the numbers of
users and antennas are large. In fact, the achievable rate approximation
expressions of the MRT and the ZF in Equations ( 31 ), ( 36 ), ( 43 ),
and ( 45 ) still rely on instantaneous channel realization of the SLOS
components of all the users. These channel dependent expressions are
inconvenient to provide useful guidelines for system design.

Fortunately, similar to conventional massive MIMO systems while the
numbers of users and antennas are large, the law of large number can
bring us some interesting results [ 96 , 167 ] . Now, we focus on a
scenario where the number of users and the number of antennas are large
while their ratio is bounded above by a finite constant. To facilitate
the analysis, we assume that all the users are uniformly distributed [
168 ] with certain degrees separation in angular domain. To illustrate
the concepts of angular separation, the main lobe and side lobes of ULA
is shown in Figure 8 .

The range of the main lobe in the space domain ⁵ ⁵ 5 The spatial domain
constraint is given by @xmath [ 111 ] . for user @xmath [ 58 ] , @xmath
, is given by

  -- -------- -- ------
     @xmath      (47)
  -- -------- -- ------

where @xmath is the AoA of the SLOS of user @xmath . If the AoA of the
SLOS of user @xmath is not in the main lobe of user @xmath , we consider
that user @xmath is in the side lobes of user @xmath from the BS point
of view. The minimum angular separation between different users from the
BS point of view in a far-field region can be expressed as

  -- -------- -- ------
     @xmath      (48)
  -- -------- -- ------

Let us consider the extreme case that all the users are separated one by
one and with the minimal angular separation @xmath . The maximum number
of users @xmath , which can be supported by the BS equipped with @xmath
antennas, should satisfy the following constraint:

  -- -------- -- ------
     @xmath      (49)
  -- -------- -- ------

Therefore, the maximum number of users @xmath is approximately @xmath .
Here, we justify that the density of users due to the angular separation
assumption in Equation ( 48 ) is reasonable with the following example.

For typical mmWave massive MIMO systems operating at @xmath GHz, the
cell radius is roughly @xmath meters. For a BS equipped with a @xmath
-antenna ULA array serving @xmath users simultaneously, the user density
is @xmath devices/ @xmath km @xmath which is the medium user density as
stated in 3GPP [ 163 ] . Besides, the @xmath -antenna ULA array, which
is deployed for half wavelength separation, is only @xmath meter long.
Under such an assumption, we note that the channels between any two
users are not orthogonal. Such non-orthogonality has already been
verified via field experiments [ 160 , 74 ] .

Based on the angular separation assumption in Equation ( 48 ), we can
then make a further approximation [ 111 ] for the achievable rates of
the MRT and the ZF precoding in Equations ( 31 ), ( 36 ), and ( 43 ).
@xmath @xmath of Equation ( 31 ) and @xmath @xmath of Equation ( 43 )
can be rewritten as

  -- -------- -- ------
     @xmath      (50)
  -- -------- -- ------

While the number of antennas @xmath and the number of users @xmath are
large with their ratio @xmath fixed, the asymptotic SINR expressions of
the SLOS-based MRT and the PAC-based MRT in the high SNR regime can be
expressed as

  -- -------- -- ------
     @xmath      (51)
  -- -------- -- ------

  -- -------- -- ------
     @xmath      (52)
  -- -------- -- ------

respectively.

Interestingly, if Rician K-factor @xmath does not approach infinity, the
result shows that Equation ( 51 ) is always larger than Equation ( 52 )
for a fixed ratio @xmath .

Now we focus on the asymptotic rate performance of the PAC-based ZF
precoding and the SLPS-based ZF precoding. To this end, we have

  -- -- -- ------
           (53)
  -- -- -- ------

We can obtain several properties of symmetric matrix @xmath via singular
value decomposition (SVD) as

  -- -------- -- ------
     @xmath      (54)
  -- -------- -- ------

where @xmath is the non-negative eigenvalues of @xmath and @xmath . We
can obtain

  -- -------- -- ------
     @xmath      (55)
  -- -------- -- ------

where @xmath is the @xmath -th column vector of @xmath As we assume that
all the users are distinguishable in the angular domain, we have the
following expression:

  -- -- -- ------
           (56)
  -- -- -- ------

Based on the previous results Equations ( 36 ) and ( 56 ), the SINR
expression of user @xmath under the SLPS-based ZF precoding in the high
SNR regime is given by

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      (57)
  -- -------- -------- -- ------

With the fixed system load, the number of users to the number of
antennas ratio @xmath , we have the observations: a) Equation ( 57 ) is
determined by the MSE of channel estimation @xmath ; b) @xmath is
saturated with respect to @xmath .

In Figures 9 and 10 , we validate Theorem \thechapter .2 and the
asymptotic analysis in Equations ( 51 ), ( 52 ), and ( 57 ). In Figure 9
, user scheduling (US) stands for that the AoAs of all the users’ SLOS
components satisfy the assumption in Equation ( 48 ) and random angle
(RA) stands for that the AoAs of all the users’ SLOS components are
uniformly distributed from @xmath to @xmath . Figure 9 shows that the
proposed SLOS-based precoder outperforms the conventional imperfect
PAC-based precoder for a wide range of scenarios.

In Figure 10 , interestingly, for a wide range of Rician K-factor, the
proposed SLOS-based MRT can achieve a significant higher rate
performance than that of the PAC-based MRT, even the pilot-aided
estimated CSI is perfect. As the MSE of channel estimation increases,
the sum-rate gap between the SLOS-based MRT and the PAC-based MRT
increases significantly. The results shown in Figure 10 indicates that
the SLOS-based MRT is a better choice than the conventional PAC-based
MRT for mmWave massive MIMO systems. It is interesting to note that,
while the assumption in Equation ( 48 ) is satisfied, the achievable
rate performance under the assumption of US can significantly
outperforms the achievable rate performance under RA assumption. These
simulation results imply that, an appropriate US algorithm selecting a
set of users satisfying Equation ( 48 ) can improve the achievable rate
performance for mmWave massive MIMO communication systems. Therefore,
Equation ( 48 ) can be considered as a guideline of US.

### 9 Impact of Imperfect Hardware: Phase Quantization Error

Hardware impairments in massive MIMO systems causing performance
degradation have been widely discussed [ 80 , 38 ] . The hardware
structure is widely adopted as a fully digital conventional MIMO scheme
that @xmath RF chains with @xmath phase shifters are connected to @xmath
antennas. In particular, most of the works in the literature modeled
that the impact of phase and amplitude errors are additive distortions
and hardware imperfections are uncorrelated with the desired signals.
Some works, e.g. [ 80 ] , proved that the additive distortion created by
hardware impairments at the BS will not vanish even the number of
antennas goes large. In this section, we analyze the impact of phase
quantization errors on the average achievable rate performance in the
high SNR and large number of antennas regime. The large-system analysis
results provide important design guidelines for mmWave massive MIMO
systems. Amplitude quantization errors are critical important for the
performance of MIMO systems. However, amplitude quantization errors,
which are partially contributed by the limited resolution of ADC/DAC and
hardware imperfection attenuation, are nonlinear and very hard to model.
Currently, to our best knowledge, no existing mathematical model is
precise enough for capturing the characteristics of amplitude
quantization errors. Thus, we leave this amplitude quantization errors
problem as a future work.

Transceiver RF chains need to provide accurate phase information for
different antennas at the BS. Yet, digital/analog RF chains have limited
resolutions in practical systems. Thus, phase quantization error may
cause strong impacts on mmWave massive MIMO systems. For example, if the
digital phase shifters of each RF chain can only provide a @xmath -bit
of resolution for quantization, the quantized phase responses are @xmath
degrees. If the exact phase responses in different antennas are @xmath
degrees, the obtained phase responses after quantization in different
antennas will be @xmath . The differences between the actual and the
quantized phase responses may lead to serious phase mismatch in
transmission.

We now discuss the rate performance degradation of the SLOS-based MRT
precoding due to the phase quantization error. Then we compare the
obtained result to the conventional pilot-aided CSI based MRT. We derive
the relationship between the quantization resolutions of phase shifters
and the associated rate performance degradation. We first denote the
equivalent channel of user @xmath after phase quantization as ⁶ ⁶ 6 We
note that the phase quantization error cannot be modeled as an additive
distortion [ 25 , 153 ] .

  -- -------- -- ------
     @xmath      (58)
  -- -------- -- ------

where the quantization error diagonal matrix is expressed as [ 25 , 153
]

  -- -------- -- ------
     @xmath      (59)
  -- -------- -- ------

The phase quantization error of user @xmath is @xmath , where the exact
phase quantization error @xmath on the @xmath -th phase shifter @xmath
is uniformly distributed over @xmath , and @xmath is the maximal phase
quantization error [ 134 ] . The exact uniformly distributed phase
quantization errors on different phase shifters have following property
that

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      (60)
  -- -------- -------- -- ------

Then the received signal of user @xmath under limited phase quantization
resolutions mismatch can be expressed as

  -- -------- -------- -- ------
     @xmath               
              @xmath      (61)
  -- -------- -------- -- ------

We denote the received signal power of user @xmath as

  -- -------- -- ------
     @xmath      (62)
  -- -------- -- ------

Then we can approximate the inter-user interference by ignoring small
random part as:

  -- -------- -------- -- ------
     @xmath   @xmath      
                          (63)
  -- -------- -------- -- ------

For different AoAs, the phase quantization errors are different. We then
present the approximated average SINR expression in the high SNR regime
as

  -- -------- -------- -- ------
     @xmath   @xmath      
                          (64)
  -- -------- -------- -- ------

By exploiting the property that

  -- -------- -------- -- ------
     @xmath   @xmath      (65)
  -- -------- -------- -- ------

and the SINR expression ( 64 ) can be rewritten as

  -- -------- -- ------
     @xmath      
                 (66)
  -- -------- -- ------

For a special case of @xmath the sum of sinc function is @xmath In the
considered system, as we assume that all users are separated by hundreds
of wavelength and the AoAs angular separation condition in ( 48 ) is
satisfied, the inter-user interferences are from the side lobes. For
@xmath @xmath , and @xmath is fixed, we have the following asymptotic
SINR expression for the SLOS-based MRT in the high SNR regime:

  -- -------- -- ------
     @xmath      (67)
  -- -------- -- ------

For @xmath @xmath , and @xmath is fixed, we have the following
asymptotic SINR expression for the PAC-based MRT in the high SNR regime:

  -- -------- -- ------
     @xmath      (68)
  -- -------- -- ------

From Equations ( 67 ) and ( 68 ), we observe that the SINR expressions
are affected by the range of phase quantization error @xmath . With the
fixed quantization error, the performance degradation may not vanish,
even if more antennas are adopted for transmission.

By comparing Equations ( 67 ) to ( 68 ), the SLOS-based MRT still
achieves a better rate performance than that of the PAC-based MRT,
despite the presence of phase quantization errors.

Accordingly, the considered mmWave massive MIMO system requires the
support of high phase quantization resolutions RF hardware in mmWave
channels.

###### Remark \thechapter.1.

In order to maintain the system performance (no more than a @xmath -dB
of SINR degradation compared to ideal hardware), the quantization
resolutions of phase shifters in each RF chain should satisfy:

  -- -------- -- ------
     @xmath      (69)
  -- -------- -- ------

Based on Equations ( 67 ) and ( 51 ), we can obtain the rate performance
degradation of the SLOS-based MRT under different quantization
resolutions in the following simulation. In Figures 11 and 12 , we
illustrate the impact of phase quantization error on system rate
performance. We assume that the resolutions of the phase quantization
per RF chain is @xmath bits. In Figure 11 , we show the performance
degradation for the SLOS-based MRT and the PAC-based MRT for @xmath
@xmath . In the high SNR regime, the system rate performance degradation
due to the limited phase quantization resolutions is significant.
However, the SLOS-based MRT can still achieve a better sum rate, which
verifies the correctness of our derived results in Equations ( 67 ) and
( 68 ).

In Figure 12 , we demonstrate the derived results for different system
loads. In particular, we observe that the impact of phase quantization
errors will not vanish with the increase of the number of antennas. The
rate performance degradation caused by phase quantization errors is
@xmath bits/s/Hz per user, which is close to the predicted value (
@xmath bits/s/Hz per user) via Equation ( 67 ). It indicates that the
hardware requirement of mmWave massive MIMO system is very stringent and
should be taken into account in system design.

### 10 Summary

In this chapter, we first proposed a frequency tone-based AoAs channel
estimation algorithm in mmWave massive MIMO systems and we analyzed the
performance of the associated SLOS-based MRT and the SLPS-based ZF
precoder. We also derived the achievable rates of the PAC-based MRT and
the PAC-based ZF precoding under the impact of pilot contamination. In
particular, we compared the achievable rates of the SLOS-based MRT and
the SLPS-based ZF precoding to the achievable rates of the PAC-based MRT
and the PAC-based ZF precoding, respectively. We showed that, for the
same MSE of channel estimation and large numbers of antennas and users,
the achievable rates of the SLPS-based and the PAC-based ZF precoding
are identical. Besides, our proposed SLOS-based MRT precoder can achieve
a higher rate than that of the traditional PAC-based MRT precoder.
Furthermore, we analyzed the impact of phase quantization error on
system rate performance, revealing that such impact cannot be mitigated
in mmWave massive MIMO systems by increasing the number of antennas.

## Chapter \thechapter Hybrid mmWave MIMO Systems: Multi-user Precoding
and Channel Estimation

### 11 Introduction

In this chapter, we consider a TDD MU hybrid mmWave system. In the
previous chapter, we proposed a frequency tone-based channel estimation
algorithm for the estimation of strongest AoAs. Besides, we proved that
our proposed SLOS-based MRT precoder can achieve a higher rate
performance than that of the traditional PAC-based MRT precoder. Based
on these prior information, we propose and detail a novel non-feedback
non-iterative channel estimation algorithm which is applicable to both
non-sparse and sparse mmWave channels.

The proposed three-step channel estimation algorithm is an extension of
the tone-based AoA channel estimation algorithm proposed for fully
digital mmWave MIMO in Chapter @xmath . Also, we analyze the achievable
rate performance of the mmWave system using digital ZF precoding based
on the estimated channel information. Furthermore, we analyze the
performance degradation under some practical hardware imperfections,
such as random phase errors, RF transceiver beamforming errors, and
channel estimation errors.

Our main contributions are summarized as follows:

-   We propose a three-step MU channel estimation scheme for mmWave
    channels. In the first two steps, we estimate the strongest AoAs at
    both the BS and the users sides instead of estimating the
    combination of multiple AoAs. The estimated strongest AoAs will be
    exploited for the design of analog beamforming matrices at the BS
    and users. In the third step, all the users transmit orthogonal
    pilot symbols to the BS along the beamforming paths of the strongest
    AoA directions to facilitate the equivalent channel estimation,
    which will be exploited to design the digital ZF precoder at the BS
    for the downlink transmission. Our proposed hybrid scheme can
    suppress the downlink MU interference effectively via its analog
    beamforming and digital precoder. Firstly, the proposed analog
    beamforming allow signal transmission and reception along the
    strongest AoA direction, which reduces the interference outside the
    strongest AoA directions and utilizes the transmission power more
    efficiently. Secondly, the digital ZF precoder can suppress the MU
    interference within the strongest AoA directions.

-   We analyze the achievable rate performance of the proposed scheme
    based on the estimated equivalent channel CSI, analog beamforming
    matrices, and digital ZF precoding. While assuming the equivalent
    CSI is perfectly known at the BS, we derive a tight performance
    upper bound on the achievable rate of our proposed scheme. Also, we
    quantify the performance gap between the proposed hybrid scheme and
    the fully digital system in terms of achievable rate per user. It is
    interesting to note that the performance gap is determined by the
    ratio between the power of the strongest AoA component and the power
    of the scattering component, Rician K-factor @xmath . The
    performance gap of the average achievable rate per user between the
    hybrid system and the fully digital system is only @xmath bits/s/Hz
    in the large numbers of antennas regime.

-   We further analyze the system performance degradation and derive the
    closed-form approximation of achievable rate under various types of
    errors, i.e., random phase errors, transceiver analog beamforming
    errors, and equivalent channel estimation errors, in the high
    receiver signal-to-noise ratio (SNR) and the large numbers of
    antennas regimes. Interestingly, our results confirm that the impact
    of phase errors and transceiver beamforming errors will not cause a
    performance ceiling in terms of achievable rate. Besides, the
    performance gap in terms of the achievable rate between the system
    under phase errors and transceiver beamforming errors and the system
    with perfect hardware is approximated.

The rest of the chapter is organized as follows. Section 3.2 describes
the system model considered throughout the chapter. In Section 3.3, we
detail the proposed channel estimation algorithm for hybrid systems. In
Section 3.4, we investigate the downlink transmission rate performance
based on the equivalent CSI estimated in Section 3.3. Besides, we
further have rate performance analysis under the impact of hardware
impairments in Section 3.5. Numerical results and related discussions
are presented in Section 3.6. Finally, Section 3.7 summarizes the
chapter.

### 12 System Model

We consider a MU hybrid mmWave system which consists of one BS and
@xmath users in a single cell, as shown in Figure 13 . Generally, there
are two kind of hybrid structures which are widely adopted by
researchers [ 17 , 3 ] : the full access hybrid architecture and the
subarray hybrid architecture. The full access hybrid architecture, where
each RF chain is connected to all the antennas, can provide a higher
array gain and a narrower beam width than that of the subarray hybrid
architecture, where each RF chain is connected to a part of the
antennas. In this chapter, we adopt the full access hybrid architecture
since it offers higher flexibility in the design of channel estimation
algorithm. We assume that the BS is equipped with @xmath antennas and
@xmath RF chains to serve the @xmath users. Besides, each user is
equipped with @xmath antennas and a single RF chain. We also assume that
@xmath . In the following sections, we set @xmath to simplify the
analysis ⁷ ⁷ 7 We note that our proposed channel estimation scheme,
precoding scheme, and analysis can be generalized to the case of @xmath
, at the expense of a more involved notation. .

Each RF chain at the BS can access to all the antennas by using @xmath
phase shifters, as shown in Figure 14 . At each BS, the number of phase
shifters is @xmath . Due to significant propagation attenuation at
mmWave frequency, the system is dedicated to cover a small area, e.g.
cell radius is @xmath m. We assume that the users and the BS are fully
synchronized and TDD is adopted to facilitate uplink and downlink
communications [ 28 ] .

In previous work [ 3 ] , mmWave channels were assumed to have sparse
propagation paths between the BS and the users. Yet, in recent field
tests, especially in the urban microcell environments, both a strong LOS
component and non-negligible scattering components may exist in mmWave
propagation channels [ 165 , 29 , 102 ] . Therefore, for the urban
short-distance propagation environment, mmWave channels are more
suitable to be modeled by non-sparse Rician fading and with a large
Rician K-factor [ 102 , 29 , 155 ] . On the other hand, for the suburban
long-distance propagation environment, mmWave channels can be modeled by
a sparse channel model. The reason is that scattering components will
vanish during the long-distance propagation because of the high
reflection loss and large propagation path loss. In addition, the
blockage of LOS component is critical for mmWave systems and widely
considered in previous works [ 169 , 113 ] . In [ 169 ] , the authors
proved that the optimal cell size to achieve the maximum SINR scales
with the average size of the area that is LOS to a user. Therefore, with
a properly designed radius of cells, one should expect the existence of
at least one LOS component from the BSs to any user. When the LOS
component from a certain BS to a user is blocked, the user can still
exploit other existing LOS components from other BSs for channel
estimation and data transmission.

Let @xmath be the uplink channel matrix between user @xmath and the BS
in the cell. We assume that @xmath is a slow time-varying block Rician
fading channel, i.e., the channel is constant in a block but varies
slowly from one block to another. Then, in this chapter, we assume that
the channel matrix @xmath can be decomposed into a deterministic LOS
channel matrix @xmath and a scattered channel matrix @xmath [ 165 ] ,
i.e.,

  -- -------- -- ------
     @xmath      (70)
  -- -------- -- ------

where @xmath and @xmath are diagonal matrices with entries

  -- -------- -- ------
     @xmath      (71)
  -- -------- -- ------

respectively, and @xmath is the Rician K-factor of user @xmath .
Besides, Equations ( 70 ) and ( 71 ) are the generalization of mmWave
channel models, which capture both the scattered and non-scattered
components. In general, we can adopt different array structures, e.g.
ULA and uniform panel array (UPA) for both the BS and the users. Here,
we adopt the ULA as it is commonly implemented in practice [ 3 ] . We
assume that all the users are separated by hundreds of wavelengths or
more [ 28 ] . Thus, we can express the deterministic LOS channel matrix
@xmath of user @xmath as [ 170 ]

  -- -------- -- ------
     @xmath      (72)
  -- -------- -- ------

where @xmath @xmath and @xmath @xmath are the antenna array response
vectors of the BS and user @xmath respectively.

In particular, @xmath and @xmath can be expressed as [ 170 , 111 ]

  -- -------- -------- -- ------
     @xmath   @xmath      (73)
     @xmath   @xmath      (74)
  -- -------- -------- -- ------

respectively, where @xmath is the distance between the neighboring
antennas and @xmath is the wavelength of the carrier frequency.
Variables @xmath and @xmath are the angles of incidence of the LOS path
at antenna arrays of the BS and user @xmath , respectively. For
convenience, we set @xmath for the rest of the chapter which is an
assumption commonly adopted in the literature [ 111 , 170 ] . Without
loss of generality, we assume that the scattering component @xmath
consists @xmath clusters and each cluster contributes @xmath propagation
paths [ 165 ] , which can be expressed as

  -- -- -- ------
           (75)
  -- -- -- ------

where @xmath and @xmath are the antenna array response vectors of the BS
and user @xmath associated to the @xmath -th propagation path,
respectively. Here @xmath represents the path attenuation of the @xmath
-th propagation path and @xmath is the @xmath -th column vector of
@xmath . With the increasing number of clusters, the path attenuation
coefficients and the AoAs between the users and the BS become randomly
distributed [ 165 , 102 ] . Therefore, we model the entries of
scattering component @xmath in a general manner as an i.i.d. random
variable ⁸ ⁸ 8 To facilitate the study of the downlink hybrid precoding,
we assume that perfect long-term power control is performed to
compensate for path loss and shadowing at the desired users and equal
power allocation among different data streams of the users [ 3 , 115 ,
46 ] . Thus, the entries of scattering component @xmath are modeled by
i.i.d. random variables. @xmath .

### 13 Proposed Channel Estimation for Hybrid System

In this section, we propose and detail our mmWave channel estimation for
hybrid mmWave systems. In practice, the hybrid system imposes a
fundamental challenge for mmWave channel estimation. Unfortunately, the
conventional pilot-aided channel estimation algorithm for fully digital
systems, e.g. [ 5 , 3 ] , is not applicable to the considered hybrid
mmWave system. The reasons are that the number of RF chains is much
lower than the number of antennas equipped at the BS and the transceiver
beamforming matrix cannot be acquired.

To address this important issue, we propose a novel channel estimation
algorithm, which contains three steps as shown in Figure 15 and
Algorithm \thechapter .1 . In the first and second steps, we introduce
unique unmodulated frequency tones to estimate the strongest AoAs at the
BS and user sides. The unique frequency tones and linear search
algorithm are inspired by signal processing in monopulse passive
electronically scanned array (PESA) radar and sonar systems [ 170 ] .
The unmodulated frequency tone-based AoA beam sweeping search signal
processing procedures are different while adopting different hardware
architectures, e.g. hybrid architecture and fully digital architecture.
These estimated strongest AoAs will be exploited to develop analog
transmit and receive beamforming matrices at the BS and users. In the
third step, the users transmit orthogonal pilot symbols to the BS along
the beamforming paths in order to estimate the equivalent channel via
the strongest AoA directions. Then, the estimated channel will be used
for the design of BS digital baseband precoder for the downlink
transmissions by exploiting the reciprocity between the uplink and
downlink channels.

0: Multiple single-carrier frequency tone signals @xmath , pilot
sequences matrix @xmath , the detection matrices @xmath of AoA at the
BS, and the detection matrices @xmath of AoA at the users STEP 1:
Estimate the AoA at the BS and design BS analog beamforming matrix

1: The estimation of AoA at the BS: all the users transmit their unique
frequency tones by using only one omni-directional antenna

2: The BS calculates @xmath , as shown in ( 78 ) to estimate the uplink
AoA of user @xmath and its corresponding beamforming vector: @xmath

3: The BS analog beamforming matrix is @xmath STEP 2: Estimate the AoA
at the users and design user analog beamforming matrix

4: The estimation of AoA at the users: the BS transmits frequency tones
back to all the users using @xmath as a transmit beamforming matrix

5: Calculate @xmath , as shown in ( 82 ) to estimate the downlink AoA of
user @xmath and its corresponding beamforming vector: @xmath

6: The users analog beamforming matrix is @xmath STEP 3: Estimate
equivalent channel and design digital ZF precoder

7: All the users transmit orthogonal pilot sequences by using @xmath as
beamforming matrix and the BS uses @xmath as beamforming matrix to
receive pilot sequences

8: The BS obtains and calculates @xmath as shown in ( 85 ) @xmath

9: The BS sets the baseband digital ZF precoder as @xmath

Algorithm \thechapter .1 Channel Estimation Algorithm for Hybrid Systems

#### 13.1 Details of Proposed Channel Estimation

Step @xmath , Line 1 in Algorithm \thechapter .1 : Firstly, all the
users transmit unique frequency tones to the desired BS in the uplink
simultaneously. For user @xmath , an unique unmodulated frequency tone,
@xmath , is transmitted from one of the omni-directional antennas in the
antenna array to the BS. Here, @xmath is the single carrier frequency
and @xmath stands for time and @xmath . For the AoA estimation, if the
condition @xmath , is satisfied, the AoA estimation difference by using
different tones is generally negligible [ 111 ] , where @xmath is the
system carrier frequency. The pass-band received signal of user @xmath
at the BS, @xmath , is given by

  -- -------- -- ------
     @xmath      (76)
  -- -------- -- ------

where @xmath denotes the thermal noise at the antenna array of the BS,
@xmath , and @xmath is the noise variance at each antenna of the BS. To
facilitate the estimation of AoA, we perform a linear search in the
angular domain ranged from @xmath to @xmath with an angle search step
size of @xmath . Therefore, the AoA detection matrix @xmath , @xmath ,
contains @xmath column vectors. In general, the typical value of the
minimum search steps @xmath depends on the number of antennas @xmath
used for the AoA search. In particular, @xmath [ 111 ] . The @xmath -th
vector @xmath , stands for a potential AoA of user @xmath at the BS and
is given by

  -- -------- -- ------
     @xmath      (77)
  -- -------- -- ------

where @xmath , is the assumed AoA and @xmath . For the AoA estimation of
user @xmath , @xmath is implemented in the @xmath phase shifters
connected by the @xmath -th RF chain. The local oscillator (LO) of the
@xmath -th RF chain at the BS generates the same carrier frequency
@xmath to down convert the received signals to the baseband, as shown in
Figure 14 . After the down-conversion, the signals will be filtered by a
low-pass filter which can remove other frequency tones. The equivalent
received signal at the BS from user @xmath at the @xmath -th potential
AoA is given by

  -- -------- -- ------
     @xmath      (78)
  -- -------- -- ------

The potential AoA, which leads to the maximum value among the @xmath
observation directions, i.e.,

  -- -------- -- ------
     @xmath      (79)
  -- -------- -- ------

is considered as the strongest AoA of user @xmath . In addition, the
strongest AoA estimation shown in Equations ( 78 ) and ( 79 ) can be
performed by using either a series of analog comparators in analog
domain or digital buffer in digital domain. Besides, vector @xmath
corresponding to the AoA with the maximum value in ( 79 ) will be
exploited for the design of the analog beamforming vector of user @xmath
at the BS. As a result, we can also estimate all other users’ uplink
AoAs at the BS from their corresponding transmitted signals
simultaneously. For notational simplicity, we denote @xmath as the BS
analog beamforming matrix.

Step @xmath , Line 4 in Algorithm \thechapter .1 : The BS sends unique
frequency tones to all the users exploiting analog beamforming matrix ⁹
⁹ 9 This procedure can be done simultaneously in all the RF chains for
all the users. @xmath obtained in Step @xmath . This facilitates the
downlink AoAs estimation at the users and this AoA information will be
used to design analog beamforming vectors to be adopted at the users.
The received signal @xmath at user @xmath can be expressed as

  -- -------- -- ------
     @xmath      (80)
  -- -------- -- ------

where @xmath denotes the thermal noise at the antenna array of the
users, @xmath and @xmath is the noise variance for all the users.

The AoA detection matrix for user @xmath , @xmath , which also contains
@xmath estimation column vectors, is implemented at phase shifters of
user @xmath . The @xmath -th column vector of matrix @xmath for user
@xmath , @xmath , is given by

  -- -------- -- ------
     @xmath      (81)
  -- -------- -- ------

where @xmath , is the @xmath -th potential AoA of user @xmath and @xmath
. With similar procedures as shown in Step @xmath , the equivalent
received signal from the BS at user @xmath of the @xmath -th potential
AoA is given by

  -- -------- -- ------
     @xmath      (82)
  -- -------- -- ------

Similarly, we search for the maximum value among @xmath observation
directions and design the analog beamforming vector based on the
estimated AoA of user @xmath . The beamforming vector for user @xmath is
given by

  -- -------- -- ------
     @xmath      (83)
  -- -------- -- ------

and we denote @xmath as the users analog beamforming matrix.

Step @xmath , Line 7 in Algorithm \thechapter .1 : The BS and users
analog beamforming matrices based on estimated uplink AoAs and downlink
AoAs are designed via Step @xmath and Step @xmath , respectively. After
that, all the users transmit orthogonal pilot sequences to the BS via
user beamforming vectors @xmath . In the meanwhile, the BS receives
pilot sequences via the BS analog beamforming matrix @xmath . With the
analog beamforming matrices, we have the equivalent channel between the
BS and the users along the strongest AoA paths ¹⁰ ¹⁰ 10 The equivalent
channel consists of the BS analog beamforming matrix, the mmWave
channel, and the users analog beamforming matrix. .

We denote the pilot sequences of user @xmath in the cell as @xmath ,
@xmath , stands for @xmath symbols transmitted across time. The pilot
symbols used for the equivalent channel estimation are transmitted in
sequence from symbol @xmath to symbol @xmath . The pilot symbols for all
the @xmath users form a matrix, @xmath where @xmath is a column vector
of matrix @xmath given by @xmath , @xmath , @xmath , @xmath , where
@xmath represents the transmitted pilot symbol energy. Note that @xmath
. Meanwhile, the BS analog beamforming matrix @xmath is utilized to
receive pilot sequences at all the RF chains. As the length of the pilot
sequences is equal to the number of users, we obtain an @xmath
observation matrix from all the RF chains at the BS. In particular, the
received signal at the @xmath -th RF chain at the BS is @xmath , which
is given by

  -- -------- -- ------
     @xmath      (84)
  -- -------- -- ------

where @xmath denotes the additive white Gaussian noise matrix at the BS
and the entries of @xmath are modeled by i.i.d. random variable with
distribution @xmath .

After @xmath is obtained, we then adopt the LS method for our equivalent
channel estimation. We note here, the LS method is widely used in
practice since it does not require any prior channel information.
Subsequently, with the help of orthogonal pilot sequences, we can
construct an equivalent uplink channel matrix @xmath formed by the
proposed scheme via the LS estimation method. Then, by exploiting the
channel reciprocity, the equivalent downlink channel of the hybrid
system @xmath can be expressed as:

  -- -------- -------- -- ------
     @xmath   @xmath      (85)
  -- -------- -------- -- ------

where @xmath is the @xmath -th column vector of matrix @xmath . From
Equation ( 85 ), we observe that the proposed channel estimation
algorithm can obtain all users’ equivalent CSI simultaneously.

#### 13.2 Performance Analysis of Proposed Channel Estimation

In the high SNR regime, the effective noise component is negligible and
Equation ( 85 ) can be simplified ¹¹ ¹¹ 11 The performance degradation
due to the high SNR assumption will be verified by analysis and
simulation in the following sections. as

  -- -- -- ------
           (86)
  -- -- -- ------

From Equation ( 86 ), we can see that without the impact of noise, we
can perfectly estimate the equivalent channels, which consists of the BS
analog beamforming matrix @xmath , the users analog beamforming matrix
@xmath , and mmWave channels between the BS and all the users.

Now, we analyze the performance of the proposed channel estimation. With
the normalization factor @xmath , the normalized mean squared error
(NMSE) of equivalent channel estimation @xmath is given by

  -- -- -------- -- ------
        @xmath      
        @xmath      
        @xmath      (87)
  -- -- -------- -- ------

From ( 87 ), we observe that the NMSE of the equivalent channel of user
@xmath decreases with an increasing transmitted pilot symbol power
@xmath as well as the numbers of antennas equipped at the BS and at each
user. As the numbers of antennas @xmath and @xmath approach infinity,
the impact of noise will vanish asymptotically. In contrast, the channel
estimation errors caused by noise in conventional fully digital massive
MIMO systems cannot be mitigated by increasing the number of antennas
equipped at the BS and the users [ 28 , 53 ] . Therefore, the proposed
channel estimation for the hybrid system outperforms the conventional
pilot-aided channel estimation for the fully digital system in terms of
noise mitigation. The NMSE analysis result will be verified via
simulation. Here, we would point out that the proposed channel
estimation scheme can exploit large array gains offered by the antenna
arrays via using the BS analog beamforming matrix @xmath and the users
analog beamforming matrix @xmath to enhance the receive SNR of pilot
symbols [ 170 ] . Therefore, it is expected that the performance of the
proposed channel estimation scheme improves with increasing the numbers
of antennas equipped at the BS and each user.

For a multi-cell scenario, the received pilot sequences at the RF chains
of the desired BS will be affected by the reused pilot sequences from
neighboring cells [ 28 , 53 , 86 ] . The threat of pilot contamination
attack will be detailed and discussed in the next chapter.

Figure 16 shows the NMSE of the equivalent channel estimation of user
@xmath versus the total numbers of antennas equipped at the BS and the
user. In Figure 16 , we see that the simulation results match with
analytical results derived in Equation ( 87 ). For the SNR of the
transmitted pilot at @xmath dB, it can be seen that the NMSE of the
proposed algorithm decreases with an increasing @xmath . On the
contrary, we have the observation that the numbers of antennas equipped
at the BS and users have no significant impact on the conventional
pilot-aided LS channel estimation for the fully digital system.
Furthermore, Figure 16 also shows that a high transmitted pilot energy
is helpful to lower the NMSE of the proposed algorithm, since the impact
of noise is reduced proportional to @xmath as shown in Equation ( 87 ).
It is interesting to note that, to meet a certain required NMSE of
channel estimation, we can either increase the number of antennas
equipped at the BS or the number of antennas at each user. This
indicates that increasing the number of antennas equipped at the BS can
always improve the system performance, despite the possibly limited
numbers of antennas equipped at the users.

### 14 ZF Precoding and Performance Analysis

In this section, we illustrate and analyze the achievable rate
performance per user of the considered hybrid mmWave system under
digital ZF downlink transmission. The digital ZF downlink precoding is
based on the estimated equivalent channel @xmath , which is a
concatenation of the BS analog beamforming matrix @xmath and the users
analog beamforming matrix @xmath . We derive a closed-form upper bound
of achievable rate per user of the ZF precoding in the considered hybrid
system. Also, we compare the system achievable rate upper bound obtained
by the fully digital system exploiting the ZF precoding for a large
number of antennas. The achievable rate performance gap between the
considered hybrid mmWave system and the fully digital system is
characterized, which is verified via analysis and simulation results.

#### 14.1 ZF Precoding

Now, we utilize the estimated equivalent channel for downlink digital ZF
precoding. To study the best achievable rate performance, we first
assume that the equivalent channel is estimated in the high SNR regime.
In this case, the equivalent channel is considered as perfectly
estimated as the proposed channel estimation is only affected by noise
as shown in Equation ( 87 ). Therefore, the baseband digital ZF precoder
@xmath based on @xmath is given by

  -- -------- -- ------
     @xmath      (88)
  -- -------- -- ------

where @xmath is the @xmath -th column of ZF precoder for user @xmath .
As each user is equipped with only one RF chain, one superimposed signal
is received at each user at each time instant with hybrid transceivers.
The received signal at user @xmath after beamforming can be expressed
as:

  -- -- -- ------
           (89)
  -- -- -- ------

where @xmath is the transmitted symbol energy from the BS to user @xmath
, @xmath , @xmath is the average transmitted power for each user, @xmath
is the transmission power normalization factor, and the effective noise
part @xmath . Due to the fact that the MU interference within the AoA
directions can be suppressed by the digital ZF precoder, thus

  -- -- -- -- ------
              (90)
  -- -- -- -- ------

Then we express the SINR of user @xmath as

  -- -------- -- ------
     @xmath      (91)
  -- -------- -- ------

In the sequal, we study the performance of the considered hybrid mmWave
systems. For simplicity, we assume that channels of all the users have
the same Rician K-factor, i.e., @xmath .

#### 14.2 Performance Upper Bound of ZF Precoding

Now, exploiting the SINR expression in Equation ( 91 ), we summarize the
upper bound of achievable rate per user of the digital ZF precoding with
the proposed channel estimation algorithm in the following theorem.

###### Theorem \thechapter.1.

The achievable rate per user of the proposed ZF precoding is bounded by

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      (92)
  -- -------- -------- -- ------

Proof: Please refer to Appendix C. @xmath

From Equation ( 92 ), we see that the upper bound of achievable rate per
user of the proposed ZF precoding depends on the Rician K-factor, @xmath
. Also, we can further observe that the upper bound of the achievable
rate per user also depends on the BS analog beamforming matrix @xmath
designed in Step @xmath of the proposed channel estimation algorithm. We
note that since the analog beamforming only allows the BS to transmit
each user’s signal via its strongest AoA direction, the proposed scheme
can utilize the transmission power more effectively. In addition, the
interference outside the strongest AoA directions is reduced as less
transmission power will leak to undesired users. On other hand, with an
increasing number of antennas at the BS, the communication channels are
more likely to be orthogonal to each other. Therefore, it is interesting
to evaluate the asymptotic upper bound @xmath for the case of a large
number of antennas. We note that, even if the number of antennas
equipped at the BS is sufficiently large, the required number of RF
chains is still only required to equal to the number of users in the
hybrid mmWave system structures.

###### Corollary \thechapter.1.

In the large numbers of antennas regime, i.e., @xmath , such that @xmath
@xmath the asymptotic achievable rate per user of the hybrid system is
bounded above by

  -- -------- -- ------
     @xmath      (93)
  -- -------- -- ------

Proof: The result follows by substituting @xmath into ( 92 ). @xmath

From Equation ( 93 ), we have an intuitive observation that the
asymptotic performance of the proposed precoding is mainly determined by
the numbers of equipped antennas and RF chains.

#### 14.3 Comparison with Fully Digital Systems

In this section, we derive the achievable rate performance of a fully
digital mmWave system in the large numbers of antennas regime. The
obtained analytical results in this section will be used as a reference
for comparing to the proposed hybrid system. To this end, for the fully
digital mmWave system, we assume that each user is equipped with one RF
chain and @xmath antennas. The @xmath antenna array equipped at each
user can provide @xmath dB array gain. We note that, the number of
antennas equipped at the BS is @xmath and the number of RF chains
equipped at the BS is equal to the number of antennas. The channel
matrix from the BS to user @xmath is given by

  -- -------- -- ------
     @xmath      (94)
  -- -------- -- ------

We assume that the CSI is perfectly known to the users and the BS. The
BS with the fully digital system is adopted to illustrate the maximal
performance gap in terms of achievable rate between the fully digital
system and the considered hybrid system. The CSI at the BS for the
downlink information transmission is given by

  -- -------- -- ------
     @xmath      (95)
  -- -------- -- ------

The ZF precoder for the equivalent channel @xmath is denoted as

  -- -------- -- ------
     @xmath      (96)
  -- -------- -- ------

Therefore, the achievable rate per user of the fully digital system is
bounded by

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      (97)
  -- -------- -------- -- ------

where @xmath follows ( 161 ) in Appendix C.

###### Corollary \thechapter.2.

In the large numbers of antennas regime, the asymptotic achievable rate
per user of the fully digital system is bounded by

  -- -------- -- ------
     @xmath      (98)
  -- -------- -- ------

Proof: The result follows by substituting @xmath into ( 97 ). @xmath

Based on Equations ( 93 ) and ( 98 ), we further quantify the achievable
rate performance gap between the considered hybrid system and the fully
digital system in the large numbers of antennas regime.

###### Corollary \thechapter.3.

In the large numbers of antennas regime, the gap between the achievable
rate upper bounds for the hybrid system and the fully digital system can
be expressed as:

  -- -------- -- ------
     @xmath      (99)
  -- -------- -- ------

where @xmath stands for @xmath

Proof: The result follows by substituting ( 93 ) and ( 98 ) into ( 99 ).
@xmath

In the large numbers of antennas regime, based on Equations ( 93 ) and (
98 ), it is interesting to observe that with an increasing Rician
K-factor @xmath , the performance upper bounds of the two considered
systems will coincide. Intuitively, as the Rician K-factor increases,
the LOS component becomes the dominant element of the communication
channel, as shown in Equation ( 70 ). Therefore, the BS analog
beamforming matrix based on the estimated strongest AoA will allocate a
smaller portion of the transmitted signal energy to the scattering
component. At the same time, the interference caused by other users is
suppressed by the digital baseband ZF precoding, @xmath .

In Figure 17 , we present a comparison between the achievable rate per
user of the hybrid system and the fully digital system for @xmath @xmath
, and a Rician K-factor of @xmath . Firstly, our simulation results
verify the tightness of derived upper bounds in Equations ( 93 ) and (
98 ). It can be observed from Figure 17 that even for a small value of
Rician K-factor, e.g. @xmath , our proposed channel estimation scheme
with ZF precoding can achieve a considerable high sum rate performance
due to its interference suppression capability.

In Figure 18 , the achievable rate performance gap between the fully
digital system and the hybrid system decreases with the increasing
Rician K-factor, which is predicted by Equation ( 99 ). In particular,
with a sufficiently large Rician K-factor, the achievable rates of these
two systems will coincide.

### 15 Performance Analysis with Hardware Impairments

In the last section, we study the proposed mmWave hybrid system in ideal
hardware and ideal estimation conditions. In practice, hardware
components may have various types of impairments that may degrade the
achievable rate performance ¹² ¹² 12 The authors of [ 152 ] proved that
for a fully digital massive MIMO system, the additive distortion caused
by hardware impairments create finite ceilings on the channel estimation
accuracy and on the uplink/downlink capacity, which are irrespective of
the SNR and the number of base station antennas. In addition, work [ 153
] concluded that the impact of phase error on hybrid beamforming is a
further reduction on the number of effective antenna per user. In fact,
the achievable rate degradation caused by phase errors can be
compensated by simply employing more transmit antennas. , e.g. phase
errors in phase shifters induced by thermal noise, transceiver RF
beamforming errors caused by AoA estimation errors, and channel
estimation errors affected by independent additive distortion noises [
152 , 83 , 153 ] . In this section, we analyze the rate performance
degradation under hardware impairments.

#### 15.1 Transceiver Beamforming Errors and Random Phase Errors

Here, we first discuss the scenario that the equivalent channels are
estimated in the high pilot transmit power regime, i.e., @xmath , where
errors caused by thermal noise are negligible. As a result, we focus on
the effect of the phase errors in phase shifters and transceiver analog
beamforming errors on the achievable rate performance.

Firstly, we start from quantifying the impact of transceiver beamforming
errors, which is caused by AoA estimation errors. As the number of
antennas equipped at the BS is sufficiently large, the beamwidth of the
antenna array is narrow. Therefore, even a small AoA estimation error
may cause significant impacts on the system performance. Here, the BS
analog beamforming error matrix of user @xmath , @xmath , which is
caused by the AoA estimation error, can be expressed as

  -- -------- -- -------
     @xmath      (100)
  -- -------- -- -------

where the AoA estimation error @xmath at the BS for user @xmath is
modeled by i.i.d. random variable with the distribution @xmath . In
addition, the user beamforming error matrix @xmath , which is caused by
AoA estimation error @xmath , can also be similarly formulated. Now, we
assume that the hybrid system is only affected by AoA estimation errors.
Therefore, the received pilot symbols at the BS during the third step of
channel estimation is expressed as:

  -- -------- -- -------
     @xmath      (101)
  -- -------- -- -------

where the entries of effective noise part @xmath can still be modeled by
i.i.d. random variable with distribution @xmath . As we assumed that
@xmath , the estimated equivalent channel under transceiver analog
beamforming errors, @xmath , is given by

  -- -- -- -------
           (102)
  -- -- -- -------

Following the similar signal processing procedures as in Equations ( 88
)–( 90 ), the average achievable rate per user under the BS and users
analog beamforming errors can be expressed as

  -- -------- -- -------
     @xmath      (103)
  -- -------- -- -------

where @xmath is the transmission power normalization factor and @xmath
is the downlink ZF precoder based on @xmath . From Equation ( 103 ), it
is interesting to observe that the achievable rate performance is not
bounded by above. This is due to the fact that the impact of transceiver
analog beamforming errors on different RF chains can be estimated by the
pilot matrix @xmath , treated as parts of the channel, and compensated
by the digital ZF transmission. Therefore, it is expected that our
proposed scheme is robust against transceiver analog beamforming errors.

Observing Equations ( 103 ) and ( 91 ), we see that the performance
degradation caused by AoA estimation errors can be quantified by
comparing power normalization factors @xmath to @xmath . In particular,
the hybrid system with hardware impairments incurs a power loss in the
received SINR at the users. However, it is difficult to provide an
explicit mathematical expression to quantify the loss. Therefore, we
borrow the “power loss” concept from the literature of array signal
processing. Specifically, the power loss due to AoA estimation errors is
related to the HPBW [ 111 ] and the HPBW can be approximated (p. 48, [
111 ] )

  -- -------- -- -------
     @xmath      (104)
  -- -------- -- -------

where @xmath is the number of antennas equipped in the array. Hence, we
can approximate the impact of AoA estimation errors by introducing a
power loss coefficient @xmath , which is determined by the beam pattern
of the array and the variance of the distribution of AoA estimation
errors. For example, if the variance of AoA estimation errors is assumed
no larger than half of the HPBW of the antenna array ¹³ ¹³ 13 In
general, this assumption is valid for practical communication systems
with a sufficiently large number of antennas. , i.e., @xmath , the power
loss coefficient is given by @xmath according to the half power loss
principle [ 111 ] . With an increasing AoA estimation error variance
@xmath , @xmath decreases significantly ¹⁴ ¹⁴ 14 The calculation of
@xmath for different numbers of antennas and AoA errors is well studied
for linear arrays and interested readers may refer to [ 111 ] for a
detailed discussion. . With the help of @xmath , we now can express the
approximation of @xmath , the average achievable rate per user under
transceiver beamforming errors, in the large numbers of antennas regime
as

  -- -------- -- -------
     @xmath      (105)
  -- -------- -- -------

From ( 105 ), it is interesting to note that, the beamforming errors
matrices @xmath and @xmath only lead to a certain power loss, which
depends on @xmath . Besides, this loss can be compensated at the expense
of a higher transmit power, i.e., increase @xmath .

Now, we discuss the impact of phase errors, which are caused by the AWGN
and the limited quantization resolution of the phase shifters. At the
users sides, phase errors of user @xmath are modeled by [ 153 ]

  -- -------- -- -------
     @xmath      (106)
  -- -------- -- -------

where phase errors @xmath , are uniformly distributed over @xmath and
@xmath is the maximal phase error of user @xmath . Similarly, for the
phase shifters connected with the @xmath -th RF chain in the BS, the
associated phase errors are given by

  -- -- -- -------
           (107)
  -- -- -- -------

where the errors @xmath , are uniformly distributed over @xmath and
@xmath is the maximal phase error of the BS. The property of @xmath and
@xmath can be expressed as

  -- -------- -- -------
     @xmath      
     @xmath      (108)
  -- -------- -- -------

respectively. Then, the received pilot symbols @xmath used for the
equivalent channel estimation at the @xmath -th RF chain, which is under
the impact of phase errors and transceiver analog beamforming errors,
can be expressed as

  -- -------- -- -------
     @xmath      (109)
  -- -------- -- -------

Similarly, we can express the average achievable rate per user as

  -- -------- -- -------
     @xmath      (110)
  -- -------- -- -------

where @xmath is the transmission power normalization factor under phase
errors and transceiver beamforming errors. Based on Equations ( 93 ), (
105 ), and ( 108 ), the approximation of the average achievable rate per
user @xmath in the large numbers of antennas regime is given by

  -- -------- -- -------
     @xmath      (111)
  -- -------- -- -------

where @xmath is the equivalent power loss coefficient. From Equation (
111 ), we note that the joint impact of random phase errors and
transceiver beamforming errors on the average achievable rate cause
performance degradation compared to the case of perfect hardware.
Besides, using extra transmission power can compensate the performance
degradation.

#### 15.2 Hardware Impairment and Imperfect Channel Estimation

In this section, we further study the system performance by jointly
taking account the impact of hardware impairments and equivalent channel
estimation errors caused by noise. The estimated equivalent channel
@xmath can be expressed as

  -- -------- -- -------
     @xmath      (112)
  -- -------- -- -------

where @xmath is the equivalent channel under random phase errors and
transceiver beamforming errors and the entries of the normalized channel
estimation error @xmath are modeled by i.i.d. random variables with
distribution @xmath , @xmath , which is given by Equation ( 87 ). The ZF
precoding matrix for the considered hybrid system based on the imperfect
CSI is given by

  -- -------- -- -------
     @xmath      (113)
  -- -------- -- -------

where @xmath is the @xmath -th column vector of @xmath and @xmath is the
precoder based on @xmath . The received signal at user @xmath under
imperfect CSI is given by

  -- -- -- -------
           (114)
  -- -- -- -------

where @xmath is the power normalization factor. @xmath denotes the
@xmath -th column vector of the ZF precoder error matrix @xmath and
@xmath @xmath denotes the transmitted signal for all users.

We then express the SINR of user @xmath as

  -- -------- -- -------
     @xmath      (115)
  -- -------- -- -------

Now we summarize the achievable rate per user in the high SNR regime in
the following theorem.

###### Theorem \thechapter.2.

As the receive @xmath approaches infinity, the approximated achievable
rate of user @xmath of ZF precoding under imperfect hybrid CSI is given
by

  -- -------- -------- -- -------
     @xmath   @xmath      
              @xmath      (116)
  -- -------- -------- -- -------

where @xmath , @xmath represents the @xmath -th diagonal element of
@xmath , and @xmath is the NMSE of channel estimation given by Equation
( 87 ).

Proof: Please refer to Appendix D. @xmath

###### Corollary \thechapter.4.

In the large numbers of antennas regime, i.e., @xmath , the asymptotic
average achievable rate per user of the hybrid system is approximated by

  -- -------- -------- -- -------
     @xmath   @xmath      
              @xmath      
              @xmath      (117)
  -- -------- -------- -- -------

Proof: The result follows by substituting @xmath into ( 116 ). @xmath

Based on ( 111 ) and ( 117 ), the additional achievable rate performance
degradation, which is caused jointly by random phase errors and
transceiver beamforming errors, is further summarized in the following
corollary.

###### Corollary \thechapter.5.

In the large numbers of antennas regime, i.e., @xmath , the approximated
achievable rate per user performance gap between the system with ideal
hardware and the system under phase errors and transceiver beamforming
errors is given by

  -- -------- -- -------
     @xmath      (118)
  -- -------- -- -------

Proof: The result comes after some mathematical manipulation on ( 111 )
and ( 117 ). @xmath

### 16 Simulation and Discussion

In this section, we present further numerical results to validate our
analysis. We consider a small single-cell hybrid mmWave system.

In Figure 19 , we compare the achievable rates using the proposed
algorithm and the algorithm proposed by [ 3 ] for sparse and non-sparse
mmWave channels. We assume perfect channel estimation with @xmath @xmath
and @xmath . For non-sparse mmWave channels, @xmath . Firstly, we
illustrate the effectiveness of the proposed channel estimation
algorithm over non-sparse mmWave channels. For sparse single-path
channels, the achievable rate of the proposed algorithm matches with the
algorithm proposed in [ 3 ] . For non-sparse mmWave channels, e.g. with
the number of multi-paths @xmath , we observe that the proposed
algorithm achieves a better system performance than that of the
algorithm proposed in [ 3 ] . The reasons are two-fold. Firstly, the
proposed algorithm can effectively reduce the MU interference via the
proposed analog beamformers and digital ZF precoder. In particular, the
analog beamformers adopted at the BS and the users allow transmission
and receiving along the strongest AoA directions, respectively.
Therefore, the interference outside the strongest AoA directions is
reduced. Secondly, the digital ZF precoder designed based on the
equivalent channels can remove the MU interference within the strongest
AoAs. We note that since the analog beamforming only allows the
transmission along the strongest AoA directions, the proposed scheme can
utilize the transmission power more efficiently. In contrast, the
algorithm proposed in [ 3 ] , which aims to maximize the desired signal
energy, does not suppress the MU interference as effective as our
proposed algorithm. Furthermore, Figure 19 also illustrates that a
significant achievable rate gain can be brought by the proposed channel
estimation and the digital ZF precoding over a simple analog-only
beamforming steering scheme.

In Figure 20 , we illustrate two sets of comparisons to validate our
derived results in Equations ( 111 ) and ( 117 ), and to show the impact
of hardware impairments on system performance. In the simulations, we
set the Rician K-factor as @xmath , the number of antennas equipped at
the BS is @xmath , the number of antennas equipped at each user is
@xmath , and the number of users is @xmath . We assume that the maximum
phase error value of phase shifters is @xmath degrees and the variance
of AoA estimation errors at the BS side is @xmath . In this case, the
equivalent coefficient is @xmath , which predicts that there is a @xmath
-dB loss in SNR caused by AoA estimation errors and phase errors. First,
we observe that even with transceiver beamforming errors and random
phase errors, the achievable rate of the proposed scheme (curve @xmath )
scales with increasing SNR and is unbounded by above. The small gap
between the achievable rate per user with perfect hardware (curve @xmath
) and the achievable rate per user with hardware impairment (curve
@xmath ) confirms the robustness of the proposed scheme against random
phase errors as well as transceiver beamforming errors, which is
predicted by Equation ( 111 ). In addition, the @xmath dB of extra power
consumption caused by hardware impairments is also verified via the
comparison between curves @xmath and @xmath . Figure 20 also illustrates
a comparison between the proposed scheme with imperfect equivalent CSI
under perfect hardware (curve @xmath ) and the proposed scheme with
imperfect CSI under random phase errors and transceiver beamforming
errors (curve @xmath ), which validates the correctness of Theorem
\thechapter .2 . These two simulation curves assume an identical
normalized CSI error variance @xmath . In particular, we set the NMSE of
CSI as @xmath , which is achieved by the proposed channel estimation
scheme as shown in Figure 16 . In the high receive SNR and large numbers
of antennas regimes, curve @xmath and curve @xmath can be asymptotically
approximated by curve @xmath and curve @xmath , respectively.
Interestingly, the performance gaps between curve @xmath and curve
@xmath as well as curve @xmath and curve @xmath are approximately @xmath
bits/s/Hz, which are accurately characterized by Equation ( 118 ).

Now, we evaluate the achievable rate versus the number of antennas in
Figures 21 and 22 .

The setup in Figure 21 is considered at receive @xmath dB and the number
of antennas equipped at each user is @xmath , with different numbers of
BS antennas. Figure 21 shows that the achievable rate performance of the
proposed digital ZF precoding increases with increasing numbers of
antennas at the BS, despite the existence of CSI estimation errors. This
is mainly due to the fact that equipping more antennas at the BS and the
users can lead to higher array gains. It can be observed that the
achievable rate of the proposed system scales with the number of BS
antennas with a similar slope as the fully digital system, which shows
the effectiveness of the proposed scheme for the hybrid system in
exploiting the spatial degrees of freedom. In Figure 22 , the SNR setup
and @xmath are the same as Figure 21 but with different numbers of users
antennas. Similar phenomena are observed as in Figure 21 . With the same
value of @xmath and identical NMSE @xmath , it is shown in Figure 21 and
Figure 22 that the achievable rate performance degradations (the gap
between the dash lines and the solid lines) caused by CSI errors are
identical.

### 17 Summary

In this chapter, we proposed a low-complexity mmWave channel estimation
algorithm exploiting the strongest AoA for the MU hybrid mmWave systems,
which is applicable for both sparse and non-sparse mmWave channel
environments. The NMSE performance of the proposed channel estimation
was analyzed and verified via numerical simulation. The achievable rate
performance of designed analog beamforming and digital ZF precoding
based on the proposed channel estimation scheme was derived and compared
to that of the fully digital system. The analytical and simulation
results indicated that the proposed scheme can approach the rate
performance achieved by the fully digital system with sufficiently large
Rician K-factors. By taking into consideration of the effects of random
phase errors, transceiver beamforming errors, and CSI errors in the rate
performance analysis, closed-form approximation of achievable rate in
the high SNR regime was derived and verified via simulation. Our results
showed that the proposed scheme is robust against random phase errors
and transceiver beamforming errors.

## Chapter \thechapter Multi-cell Hybrid mmWave MIMO Systems: Pilot
Contamination and Interference Mitigation \nomenclature

@xmath The number of angels per unit area \nomenclature @xmath The
number of angels per needle point \nomenclature @xmath The area of the
needle point

### 18 Introduction

In this chapter, we consider a multi-cell MU hybrid mmWave system. In
the previous chapter, we propose and detail a novel non-feedback
non-iterative channel estimation algorithm which is applicable to both
non-sparse and sparse mmWave channels. In particular, we apply the
non-feedback TDD-based mmWave channel estimation algorithm proposed in
Chapter @xmath and [ 1 ] to the considered multi-cell scenario and study
the corresponding performance of channel estimation under the impact of
pilot contamination. In addition, we analyze the downlink achievable
rate performance of the hybrid mmWave system by taking into account the
CSI errors caused by pilot contamination and inter-cell interferences
originated from the BSs in neighboring cells. Note that, for pilot
contamination mitigation, this chapter does not require any information
of covariance matrices of pilot-sharing users in neighbouring cells as
required by the multi-cell MMSE-based precoding algorithm proposed in [
144 ] . In addition, the algorithm adopted in this chapter can work well
while mean values of cross-cell channels from pilot-sharing users in
neighbouring cells to the desired BS are non-zero. Our main
contributions are summarized as follows:

-   We study the impact of pilot contamination on the uplink mmWave
    channel estimation due to the reuse of orthogonal pilot symbols
    among different cells. Our results reveal that in the phase of
    channel estimation, the receive analog beamforming matrix adopted at
    the desired BS forms a spatial filter which blocks the signal
    reception of the undesired pilot symbols from neighboring cells. In
    particular, with an increasing number of antennas equipped at each
    RF chain, the main lobe beamwidth of the spatial filter, which
    aligns to the strongest AoA direction, becomes narrower and the
    amplitude of sidelobes becomes lower. Thus, the impact of pilot
    contamination caused by the users outside strongest AoA directions
    can be mitigated. We mathematically prove that the normalized MSE
    performance of the channel estimation algorithm improves
    proportionally with the increasing number of antennas equipped at
    each RF chain, which is different from previous results in [ 28 , 53
    ] .

-   We adopt ZF precoding for the downlink transmission based on the
    estimated CSI. Taking into account the impact of pilot contamination
    and the inter-cell interference from the neighboring BSs, we analyze
    and derive the closed-form approximation of the average achievable
    rate performance in the large number of antennas regimes. In
    addition, we show that the achievable rate scales with @xmath in the
    multi-cell scenario, where @xmath is the number of antennas equipped
    at each RF chain. We derive a scaling law of the achievable rate per
    users, @xmath . In contrast, the average achievable rate of fully
    digital systems adopting the conventional LS channel estimation
    algorithm suffers from the severe impact of pilot contamination. All
    the derived analytical results are verified via simulations.

The rest of the chapter is organized as follows. Section 4.2 describes
the system model considered throughout the chapter. In Section 4.3, we
detail the uplink channel estimation under the pilot contamination. In
Section 4.4, we investigate the downlink transmission rate performance
under pilot contamination. Numerical results and related discussions are
presented in Section 4.5. Finally, Section 4.6 summarizes the chapter.

### 19 System Model

In this chapter, a multi-cell MU hybrid subarray mmWave system is
considered. The system consists of @xmath neighboring cells and there
are one BS and @xmath users in each cell, cf. Figure @xmath . The BS in
each cell is equipped with @xmath RF chains serving the @xmath users
simultaneously. We assume that each RF chain equipped at the BS can
access to a ULA with @xmath antennas by using @xmath phase shifters.
Besides, each user is equipped with one RF chain and a @xmath -antenna
array. In addition, we focus on @xmath , which exploits a large antenna
array gain with limited number of RF chains.

Work [ 20 ] proved that when the number of RF chains equipped at the BS
is more than twice of the number of users, the hybrid systems can
realize the rate performance of the fully digital systems. In general,
for the case of @xmath , the hybrid system can provide enough degrees of
freedom to serve @xmath users simultaneously. If the BS can equip with
more RF chains, more degrees of freedom can be exploited for the design
of analog beamformers and digital precoders. In addition, the extra RF
chains adopted by the BS can be used for user scheduling design and
multipath diversity exploitation. Thus, for the case that @xmath ,
hybrid systems can achieve higher rate performance than that of @xmath .
In addition, authors of [ 171 , 172 , 48 ] employed RF chains with sets
of digitally controlled phase paired phase-shifters and switches to
achieve the same rate performance as that of the fully digital system.
Furthermore, with the support of an advanced hybrid architecture [ 171 ,
172 , 48 ] , hybrid systems can achieve higher rate performance than
that of adopting a simple ULA antenna array case.

However, how to exploit extra RF chains as well as advanced hybrid
architectures to further improve the rate performance of hybrid systems
is beyond the scope of this chapter. We may consider the case of @xmath
and the case of adopting advanced hybrid architectures for channel
estimation and downlink transmission precoding in our future works. To
simplify the analysis in the following sections, without loss of
generality, we set @xmath and each cell has the same number of RF chains
equipped at the BS.

According to the widely adopted setting for multi-cell TDD in uplink
channel estimation and downlink data transmission, we assume that the
users and the BSs in all cells are fully synchronized in time [ 28 , 53
] . We denote @xmath as the uplink channel matrix between the desired BS
and user @xmath in the desired cell. Besides, @xmath is a narrowband
slow time-varying block fading channel. Recent field tests show that
both strongest AoA components and non-negligible scattering components
may exist in mmWave propagation channels [ 29 , 102 ] , especially in
the urban areas. In this chapter, without loss of generality, @xmath ,
consists of a strongest AoA component @xmath and @xmath scattering
clusters/paths @xmath , @xmath [ 173 , 174 , 175 , 146 , 168 ] , which
can be expressed as

  -- -------- -- -------
     @xmath      (119)
  -- -------- -- -------

where @xmath accounts for the corresponding large-scale path loss,
@xmath is the complex gain corresponding to the strongest AoA component
and @xmath , @xmath represents the complex gain corresponding to the
@xmath -th cluster. We can also assume that @xmath are in non-increasing
order, i.e., @xmath . We note here, the strongest AoAs can be either
from the LOS components or the NLOS components.

Then, the strongest AoA component of user @xmath in the desired cell,
@xmath , can be expressed as [ 170 ]

  -- -- -- -------
           (120)
  -- -- -- -------

where @xmath @xmath and @xmath @xmath are the antenna array response
vectors of the BS and user @xmath , respectively. In particular, @xmath
and @xmath can be expressed as [ 170 ]

  -- -------- -------- -- -------
     @xmath   @xmath      (121)
     @xmath   @xmath      (122)
  -- -------- -------- -- -------

respectively, where @xmath is the distance between the neighboring
antennas at the BS and users and @xmath is the wavelength of the carrier
frequency. Variables @xmath and @xmath are the angle of incidence of the
strongest path at antenna arrays of the desired BS and user @xmath ,
respectively. As commonly adopted in the literature [ 170 ] , we set
@xmath for convenience. Similarly, the scattering components of user
@xmath in the desired cell, @xmath , can be expressed as

  -- -------- -- -------
     @xmath      (123)
  -- -------- -- -------

where @xmath and @xmath are the antenna array response vectors of the BS
and user @xmath associated to the @xmath -th propagation path,
respectively. By introducing the power ratio of the strongest cluster
power over the other scattered paths of user @xmath ¹⁵ ¹⁵ 15 According
to field test results summarized in Table I of [ 146 ] in the case of
LOS and NLOS environments, the power ratio of the strongest cluster
power over the other scattered paths’ power, @xmath , is larger than
@xmath . , @xmath , we can rewrite Equation ( 119 ) as

  -- -------- -- -------
     @xmath      (124)
  -- -------- -- -------

With the increasing number of clusters, the path attenuation
coefficients and the AoAs between the users and the BS behave randomly [
102 ] . Let @xmath be the inter-cell mmWave uplink channel between user
@xmath in the @xmath -th neighboring cell and the desired BS, @xmath ,
cf. Figure 23 . Let @xmath be the inter-cell downlink mmWave channel
between the BS of the @xmath -th neighboring cell and user @xmath in the
desired cell, cf. Figure 23 . Since the inter-cell distance is shortened
in small-cell systems, the inter-cell channels usually contain the
strongest AoA components. Thus, the inter-cell uplink and downlink
mmWave channels can be expressed as

  -- -------- -------- -- -------
     @xmath   @xmath      (125)
     @xmath   @xmath      (126)
  -- -------- -------- -- -------

respectively, where @xmath and @xmath are the corresponding large-scale
path loss coefficients. We note that @xmath and @xmath are the power
ratios of the strongest cluster power over the other scattered paths’
power for the uplink and downlink inter-cell channels, respectively. The
strongest AoA components @xmath , and @xmath follow similar assumptions
as in Equations @xmath . Besides, the scattering components @xmath and
@xmath follow similar assumption as in Equation @xmath . All these
mentioned inter-cell propagation path loss coefficients are related to
the propagation distance and modeled as in [ 102 , 101 , 29 ] .
According to recent field measurements, e.g. [ 102 , 101 , 29 , 155 ,
156 ] , the typical values of the power ratios of the strongest cluster
power over the other scattered paths’ power @xmath and @xmath for @xmath
and @xmath are in @xmath , respectively.

### 20 Multi-cell Uplink Channel Estimation Performance Analysis

In this section, we adopt the algorithm proposed in [ 1 ] for the
estimation of an equivalent mmWave channel which comprise the physical
mmWave channels and analog beamforming matrices adopted at the desired
transceivers. The proposed algorithm is suitable for both the
conventional fully digital systems and the emerging hybrid systems with
fully access and subarray implementation structures. For the sake of
presentation, we provide a summary of the algorithm proposed in [ 1 ] in
the following. For illustration, we adopt the subarray structure as an
example, as shown in Figure 24 . Specifically, each RF chain can access
to the @xmath antennas via a phase shifter network.

There are three steps in the algorithm proposed in [ 1 ] . In first and
second step, strongest AoAs between the desired BS and the users are
estimated. Then, the desired BS and the users design their analog
beamforming matrices by aligning the beamforming direction to the
estimated strongest AoAs. In the third step, orthogonal pilot symbols
are transmitted from the users to the BS by using the pre-designed
analog beamforming matrices. Then, by exploiting the channel
reciprocity, the equivalent downlink channel can be estimated and
adopted at the BS as the input for the digital baseband precoder.

Note that, orthogonal pilot symbols are used for the estimation of the
equivalent channels in the third step. For the multi-cell scenario,
pilot symbols are reused among different cells which results in pilot
contamination and cause a severe impact on the equivalent channel
estimation performance. We note that only single-cell scenario was
considered in [ 1 ] and it is unclear if the channel estimation
algorithm provides robustness against pilot contamination. Furthermore,
the performance analysis studied in [ 1 ] does not take into account the
impact of potential out-of-cell interference on the performance of
channel estimation. In the following sections, we investigate the impact
of pilot contamination on the mmWave channel estimation performance for
small-cell scenarios.

#### 20.1 Channel Estimation and Pilot Contamination Analysis

Basically, step one and step two of the proposed algorithm in [ 1 ]
provide the analog beamforming matrices at the desired BS and the
desired users to facilitate the estimation of equivalent channel. In
particular, the analog beamforming matrices pair the desired BS and the
users and align the directions of data stream transmission. Due to the
inter-cell large-scale propagation path loss, the impact of multi-cell
interference on the design of the analog beamforming matrices is usually
negligible ¹⁶ ¹⁶ 16 For strongest AoAs estimation at the desired BS in a
multi-cell scenario, the received power of the reused pilot symbols
transmitted from the users in neighboring cells is smaller than that of
the desired pilot symbols transmitted from the users in the desired
cell. In addition, strongest AoAs estimation may not rely on pilot
symbols [ 2 ] . . Besides, simulation results show that the pilot
contamination does not affect strongest AoAs estimation result ¹⁷ ¹⁷ 17
The simulation result of the strongest AoAs estimation is omitted here
due to the space limitation. However, the impact of pilot contamination
on the strongest AoAs estimation will be captured in the final
simulation. . Therefore, to facilitate the performance analysis of the
multi-cell equivalent channel estimation, we assume that strongest AoAs
among the users and the BS are perfectly estimated and the desired
signals always fall in the main lobe.

Based on the strongest AoAs, which are perfectly estimated at the users
and the BS , the analog receive beamforming vector of user @xmath
adopted at the desired BS is given by

  -- -------- -- -------
     @xmath      (127)
  -- -------- -- -------

and the analog transmit beamformer of user @xmath in the desired cell is
given by

  -- -------- -- -------
     @xmath      (128)
  -- -------- -- -------

In addition, we denote the analog beamforming matrix at the desired BS
as

  -- -- -- -------
           (129)
  -- -- -- -------

Let @xmath denote the pilot symbols of user @xmath in the desired cell.
The pilot symbols for all the @xmath users in the desired cell form a
matrix, @xmath where @xmath is a column vector of matrix @xmath given by
@xmath , @xmath , @xmath , @xmath , where @xmath represents the
transmitted pilot symbol energy.

In the equivalent channel estimation, user @xmath transmits the pilot
symbols @xmath via transmit beamformer @xmath and the desired BS
receives the pilot symbols utilizing the analog beamforming matrix
@xmath . However, the reuse of pilot symbols in neighboring cells
affects the performance of equivalent channel estimation. The received
signal of the @xmath -th RF chain at the desired BS in the uplink is
given by

  -- -------- -- -------
     @xmath      (130)
  -- -------- -- -------

where @xmath is the analog beamforming vector of user @xmath in the
@xmath -th cell, the entries of noise matrix, @xmath , are modeled by
i.i.d. random variables with distribution @xmath . To facilitate the
investigation of channel estimation and downlink transmission, we assume
that long-term power control is performed to compensate the different
strongest AoAs’ path loss among different desired users in the desired
cell. As a result, it can be considered that large-scale propagation
path losses of different users in the desired cell are identical. Thus,
we can express the estimated equivalent downlink channel @xmath at the
desired BS under the impact of pilot contamination as

  -- -------- -------- -- -------
              @xmath      
     @xmath               (131)
  -- -------- -------- -- -------

where @xmath is the equivalent channel estimation error caused by pilot
contamination and noise, and the path loss compensation matrix @xmath is
given by

  -- -------- -- -------
     @xmath      (132)
  -- -------- -- -------

In the following, for notational simplicity , we denote @xmath as the
inter-cell propagation path loss coefficients. Now, to evaluate the
impact of pilot contamination, we introduce a theorem which reveals the
normalized MSE performance of equivalent channel estimation.

###### Theorem \thechapter.1.

The normalized MSE of the equivalent channel estimation with respect to
the @xmath -th RF chain under the impacts of pilot contamination and
noise can be approximated as

  -- -------- -------- -- -------
     @xmath   @xmath      
     @xmath               
     @xmath               (133)
  -- -------- -------- -- -------

In particular, when the number of antennas equipped at the desired BS
and the users are sufficiently large, we have

  -- -------- -- -------
     @xmath      (134)
  -- -------- -- -------

Proof: Please refer to Appendix A. @xmath

In Equation ( 133 ), the impact of the multi-cell pilot contamination
term on the normalized MSE performance is inversely proportional to the
number of antennas @xmath and @xmath . In addition, the noise term
decreases with the increasing transmit pilot symbol energy and the
number of antennas, @xmath and @xmath . It is important to note that,
the impact of noise on channel estimation will vanish in the high SNR
regime, e.g. @xmath . However, the impact of pilot contamination on the
MSE performance cannot be mitigated by simply increasing the transmit
pilot symbol energy @xmath .

It is known that the conventional massive MIMO pilot-aided LS channel
estimation performance under the impact of pilot contamination cannot be
improved by increasing the number of antennas equipped at the BS [ 28 ,
53 ] . Interestingly, the result of Theorem unveils that the impacts of
pilot contamination and noise on the equivalent channel estimation will
vanish asymptotically with the increasing number of antennas equipped at
each RF chain, @xmath and @xmath . Actually, the numbers of antennas
@xmath and @xmath have an identical effect on the normalized MSE
performance.

This is because the direction of analog beamforming matrices adopted at
the desired BS and the desired users align with the strongest AoA path.
Hence, the analog beamforming matrices adopted at the desired BS and the
users form a pair of spatial filters which block the pilot signals from
undesired users to the desired BS via non-strongest paths. In addition,
transmitting the pilot signals from the desired users via the analog
beamforming matrix can reduce the potential energy leakage to other
undesired cells, which further reduces the impact of pilot
contamination.

In order to help the readers to understand Theorem \thechapter .1 from
the physical point of view, we provide a detail discussion in this
subsection on the result of Equation ( 133 ) via an illustrative example
of a single-antenna user in the high SNR regime.

In the single-antenna user scenario, we focus on the normalized
estimated equivalent channel of user @xmath , @xmath , in the high SNR
regime which is given by

  -- -- -- -------
           (135)
  -- -- -- -------

From Equation ( 135 ), it is shown that the equivalent channel @xmath is
formed by projecting the actual mmWave channel @xmath on the analog
beamforming matrix @xmath . Then, @xmath , the @xmath -th entry of the
estimated equivalent channel vector @xmath , representing the projection
of channel of user @xmath in the desired cell on the @xmath -th
strongest AoA direction, is given by

  -- -------- -------- -- -------
     @xmath               
     @xmath   @xmath      
     @xmath               (136)
  -- -------- -------- -- -------

where @xmath is the AoA from user @xmath in the @xmath -th cell to the
desired BS, @xmath is the scattering component of the channel of user
@xmath in the desired cell, and @xmath is the scattering component of
the channel from user @xmath in the @xmath -th cell to the desired BS.
For the projection of channel of user @xmath on the @xmath -th RF
chain’s analog beamforming vector @xmath , we have @xmath . Thus, the
@xmath -th entry of the vector @xmath can be expressed as

  -- -- -- -------
           (137)
  -- -- -- -------

where @xmath denotes the projection of the scattering component @xmath
on @xmath and @xmath denotes the projection of inter-cell channels
@xmath on @xmath .

The computation of Equation ( 137 ) can be illustrated graphically via
the concept of vector space with projection as shown in Figure 25(a) .
The first term of Equation ( 137 ), @xmath , which is the projection of
the strongest AoA component on the analog beamforming direction, is a
constant and is independent of @xmath . For the second term and the
third term of Equation ( 137 ), @xmath and @xmath , which consist of
multiple paths with various AoAs, cannot enjoy the array gain @xmath .
Actually, @xmath and @xmath , these two terms will vanish asymptotically
with the increasing number of antennas @xmath .

We note that for the conventional pilot-aided channel estimation
algorithms, e.g. LS-based algorithms, they estimate the channels from
all the directions. Thus, BSs adopting these algorithms receiving reused
pilot symbols from the undesired users and cannot be distinguished from
the desired pilot symbols. It is known as pilot contamination. However,
adopting analog beamforming matrices for receiving pilot symbols at the
desired BS via the strongest AoA directions forms a spatial filter,
which blocks the undesired pilot symbols from neighboring cells via
different AoA paths. Furthermore, the “blocking capability” improves
with the increasing number of antennas equipped at the BS. Specifically,
the beamwidth of main lobe becomes narrower and the magnitude of
sidelobes is lower, which is illustrated in Figure 25(b) . In fact, this
is an important feature for mitigating the impact of pilot
contamination.

Therefore, with the equivalent channel estimation proposed in [ 1 ] ,
the impact of pilot contamination vanishes asymptotically with an
increasing number of antennas @xmath equipped at the desired BS.

### 21 Multi-cell Downlink Achievable Rate

In the last section, we mathematically prove that the impact of pilot
contamination on the equivalent channel estimation can be effectively
mitigated. Analytical and simulation results show that CSI errors caused
by pilot contamination vanish asymptotically with the increasing numbers
of antennas equipped at each RF chain of the BS and the users, @xmath
and @xmath .

Now, we aim to study the downlink performance of multi-cell hybrid
mmWave networks, which takes into account the impact of inter-cell
interference caused by the neighboring BSs as well as the intra-cell
interference caused by channel estimation errors. In this section, we
illustrate and derive the closed-form approximations of achievable rate
per user under the impact of intra-cell and the inter-cell interference
of the considered hybrid system. Our results reveal that the intra-cell
interference as well as the inter-cell interference can be mitigated
effectively by simply increasing the number of antennas equipped at the
desired BS.

#### 21.1 Downlink Achievable Rate Performance

We now detail the received information signal at user @xmath in the
desired cell. Due to the channel reciprocity, we utilize the estimated
equivalent channel @xmath in Equation ( 131 ) for the digital baseband
precoder design during the downlink transmission. To suppress the
inter-user interference among different users, we adopt a ZF precoder
for the downlink transmission. In addition, equal power allocation is
used among different data streams of the users [ 3 , 115 , 46 ] . The
desired baseband digital ZF precoder @xmath is given by

  -- -- -- -------
           (138)
  -- -- -- -------

The received signal at user @xmath in the desired cell under the
intra-cell and inter-cell interference is given by

  -- -------- -------- -- -------
     @xmath   @xmath      
     @xmath   @xmath      (139)
  -- -------- -------- -- -------

where @xmath is the transmitted symbol from the desired BS to the
desired user @xmath , @xmath is the average transmitted symbol energy
for each user, @xmath is the transmission power normalization factor of
the desired BS, @xmath denotes the @xmath -th column vector of the ZF
precoder error matrix @xmath , @xmath is the designed ZF precoder based
on the estimated equivalent channel, and the effective noise @xmath . In
addition, @xmath is the digital precoder of the BS in cell @xmath based
on the estimated equivalent channel @xmath , @xmath is the analog
beamforming matrix of the BS in cell @xmath , @xmath @xmath denotes the
transmitted signal for all the users in cell @xmath , and @xmath is the
power normalization factor of the BS in cell @xmath . Compared to the
system model in [ 1 ] , the intra-cell interference, which is caused by
CSI errors due to pilot contamination effects, is captured and
investigated. In addition, the model considered here also captures the
inter-cell interference caused by the simultaneous transmission from the
neighboring BSs. We then express the average receive SINR expression of
user @xmath in the desired cell as

  -- -------- -- -------
     @xmath      
     @xmath      (140)
  -- -------- -- -------

#### 21.2 Intra-cell and Inter-cell Interference Performance Analysis

In this section, we aim at deriving a closed-form expression of the
average achievable rate per user. To this end, we first focus on the
intra-cell interference term @xmath shown in Equation ( 140 ). Note that
the intra-cell interference @xmath is caused by CSI errors, which is due
to the impact of pilot contamination on channel estimation. Then we
detail and analyze the inter-cell interference @xmath . The expression
of intra-cell interference, @xmath , can be summarized in the following
lemma.

###### Lemma \thechapter.1.

In the large number of antennas regimes, the asymptotic intra-cell
interference under the impact of pilot contamination can be approximated
by

  -- -------- -------- -- -------
     @xmath   @xmath      
              @xmath      (141)
  -- -------- -------- -- -------

Proof: The proof follows a similar approach as in [ 1 ] . Due to the
page limitation, we omit the proof here. @xmath

Now, we introduce the following lemma which simplifies the expression of
the intra-cell interference.

###### Lemma \thechapter.2.

In the large numbers of antennas regime, the asymptotic inter-cell
interference, which is caused by the BSs in neighboring cells, can be
approximated as

  -- -------- -- -------
     @xmath      (142)
  -- -------- -- -------

Proof: Please refer to Appendix B. @xmath

From Equation ( 142 ), the inter-cell interference is mainly contributed
by the downlink transmission of neighboring BSs. Besides, the power
normalization factor @xmath can be approximated as [ 1 ]

  -- -- -- -------
           (143)
  -- -- -- -------

Then, we summarize the average achievable rate of user @xmath in the
large number of antennas and high SNR regime in the following theorem.

###### Theorem \thechapter.2.

For a large number of antennas regime, the average achievable rate of
user @xmath adopting the ZF precoding under the intra-cell and the
inter-cell interference is approximated by

  -- -------- -------- -- -------
     @xmath   @xmath      
                          (144)
  -- -------- -------- -- -------

where @xmath .

Proof: The result follows by substituting Equations ( 141 ), ( 142 ),
and ( 143 ) into ( 140 ). @xmath

In the high SNR and large antenna regimes, the average achievable rate
under the impact of intra-cell interference caused by CSI errors and the
inter-cell interference caused by neighboring BSs can be mitigated by
simply increasing the number of antennas @xmath . Thus, the average
achievable rate per user can increase unboundedly with an increasing
antenna @xmath .

For comparison, we also derive the achievable rate of user @xmath in a
single-cell hybrid system. The performance of this system, @xmath ,
serves as a performance upper bound of the considered multi-cell system
as there is no out-of-cell interference. The expression of @xmath is
given by (Equation (24) of Corollary @xmath in [ 1 ] )

  -- -- -- -------
           (145)
  -- -- -- -------

###### Corollary \thechapter.1.

Now, we derive the scaling law of the average achievable rate of user
@xmath in the high SNR regime which is given by

  -- -- -- -------
           (146)
  -- -- -- -------

Proof: The result comes after some straightforward mathematical
manipulation. Due to the page limitation, we omit the proof here. @xmath

It is found that the system data rate scales with @xmath . In other
words, pilot contamination is not a fundamental problem for massive MIMO
with hybrid mmWave systems, when the CSI estimation algorithm proposed
in [ 1 ] is adopted. In contrast, the average achievable rate
performance of multi-cell MU massive MIMO networks adopting a
conventional LS-based channel estimation algorithm is limited by the
effects of pilot contamination, e.g. [ 21 ] . Note that the algorithm
proposed in [ 1 ] does not require any information of covariance
matrices of pilot-sharing users in neighbouring cells as required by the
multi-cell MMSE-based precoding algorithm proposed in [ 144 ] . In
addition, the algorithm proposed in [ 1 ] can work well while mean
values of cross-cell channels from pilot-sharing users in neighbouring
cells to the desired BS are non-zero.

###### Remark \thechapter.1.

Hybrid mmWave systems are the special case of fully digital systems, the
algorithm proposed in [ 1 ] can be extended to the case of fully digital
systems. Under such circumstance, the derived analysis can be applied to
the latter systems.

### 22 Discussions and Simulations

In this section, we will discuss and verify the derived results via
simulations. In the following simulations unless specified otherwise,
simulation settings are listed as follows. The transmit antenna gain of
the BS antennas is assumed as @xmath dBi. The maximum BS transmit power
is set as @xmath dBm. We set the number of neighboring cells as @xmath
and the number of users per cell @xmath . For the adopted simulation
parameters, the large-scale path loss coefficients ¹⁸ ¹⁸ 18 The commonly
adopted empirical propagation path loss model is considered as a
function of distance and carrier frequency, which is given by @xmath ,
where @xmath is the distance between the desired BS and user @xmath in
the desired cell, @xmath and @xmath are the least square fits of
floating intercept and slope over the measured distance [ 101 ] . ,
@xmath and @xmath , may have different values for different scenarios.
We have @xmath and @xmath for corresponding large-scale path loss
calculation [ 101 ] . In addition, the receiving thermal noise power is
@xmath dBm ¹⁹ ¹⁹ 19 Thermal noise power is determined by the signal
bandwidth @xmath and the noise spectral density level @xmath , where
@xmath MHz, @xmath K, and @xmath J/K is the Boltzmann constant [ 101 ] .
. The channel estimation errors of a user caused by pilot contamination
is given by @xmath , @xmath . Besides, we define the average achievable
rate per user as @xmath .

To verify the correctness of the analytical results derived in Equation
( 133 ), here, we provide some simulation results in Figure 26 , which
illustrates the normalized MSE performance of the equivalent channel
estimation versus the number of antennas equipped at the desired BS,
@xmath , under the impact of pilot contamination. In the simulation, we
take into account the inter-cell propagation path loss and AoA
estimation errors in estimating the strongest AoA paths. For
illustration, channel estimation errors caused by pilot contamination is
set as @xmath . Due to the existence of the inter-cell strongest AoA
components, this setting can be considered as the worst case scenario of
pilot contamination as the impact of inter-cell interference is
magnified. In Figure 26 , we can observe that with an increasing number
of antennas @xmath , the normalized MSE decreases monotonically. In
addition, an increasing number of antennas equipped at the users @xmath
can also improve the normalized MSE. Besides, the simulation results
match the analytical results derived in Equation ( 133 ). Thus, the
impact of pilot contamination on the channel estimation of multi-cell
hybrid mmWave systems vanishes asymptotically, for a sufficiently large
number of antennas equipped at the desired BS @xmath .

In Chapter @xmath , to simplify the performance analysis, we assume the
same average large scale fading coefficient for LOS components and
scattering components. Thus, the change of cross-cell LOS to NLOS power
ratio @xmath does not change the MSE performance of the channel
estimation, which is demonstrated in Equation ( 133 ) of Theorem
\thechapter .1 . However, in practice, large scale propagation path loss
coefficients for cross-cell LOS and NLOS components are supposed to be
different. In Figure 27 , we set a simulation with different large scale
propagation path loss coefficients for cross-cell LOS and NLOS
components (the large scale path loss coefficient of NLOS components is
larger than that of LOS components). The simulation results reveal that
with increasing the cross-cell LOS to NLOS power ratio @xmath , the
normalized MSE performance decreases.

In Figure 28 , we verify the tightness of the derived approximation in
Equation ( 144 ) of Theorem \thechapter .2 . Figure 28 illustrates the
average achievable rate per user under the intra-cell and inter-cell
interference versus SNR. Besides, we illustrate the corresponding upper
performance which is based on a single-cell hybrid mmWave system. In
Figure 28 , the number of antennas equipped at the users is set to
@xmath , @xmath , @xmath , @xmath , the channel estimation error caused
by pilot contamination is set as @xmath . We can observe that the
derived approximation is tight for a wide range of SNR. It also can be
observed that, with a finite number of antennas, there is still a
ceiling of the achievable rate performance in the high SNR regime.

The setup in Figure 29 is considered at @xmath , @xmath , @xmath , and
the number of antennas equipped at each user is @xmath . In Figure 29 ,
we first illustrate the upper bounds of the average achievable rate per
user of the single-cell hybrid mmWave system and the single-cell fully
digital system as the system benchmarks. Without any intra-cell
interference and inter-cell interference, the corresponding upper
performance of the fully digital system as well as the hybrid mmWave
system increases linearly with the increasing number of BS antennas
@xmath . Then, we compare the achievable rate per user of the fully
digital system using a conventional LS-based CSI estimation algorithm to
that of the hybrid system adopting CSI estimation algorithm proposed in
[ 1 ] in the high SNR regime. For the fully digital system, we assume
that the receive CSI at the users’ side is perfectly known. Thus, the
@xmath antenna array equipped at each user can provide @xmath dB array
gain.

In addition, we assume that channel estimation errors of a user at the
desired BS due to the impact of pilot contamination effects for both the
fully digital system and the hybrid system are set as @xmath . As
expected, in the large number of antennas and high SNR regimes, the
average achievable rate of the hybrid system increases unboundedly and
logarithmically with the increasing number of antennas @xmath , despite
the existence of pilot contamination as well as inter-cell interference.
The average achievable rate of the hybrid system scales with the number
of BS antennas in the order of @xmath , which is the same as that of the
upper performance of the single-cell hybrid system, and verifies the
correctness of the derived scaling law (Equation ( 146 ) in Corollary
\thechapter .1 ).

However, the average achievable rate of the fully digital system
adopting the conventional LS-based CSI estimation algorithm under the
impact of pilot contamination is saturated with the increasing number of
antennas at the desired BS. Thus, pilot contamination is the performance
bottleneck of massive MIMO systems when the conventional LS-based
channel estimation algorithm is adopted [ 21 ] . In contrast, when the
channel estimation algorithm proposed in [ 1 ] is applied to the
multi-cell MU mmWave hybrid system, the impacts of CSI errors caused by
pilot contamination and the inter-cell interference caused by
neighboring BSs on the achievable rate performance will vanish
asymptotically for a sufficiently large number of antennas equipped at
the desired BS. For a practical number of antennas setup, @xmath , the
average rate performance achieved by the algorithm proposed in @xmath
can also increase with an increasing number of antennas @xmath and
outperforms that of a fully digital system, which is illustrated in
Figure 29 . Meanwhile, the number of RF chains required in the hybrid
system is significantly lower than that of fully digital system. In
addition, our simulation results in Figure 29 also verify the tightness
of the analytical approximation derived in Theorem \thechapter .2 .

### 23 Summary

In this chapter, we investigated the normalized MSE performance of the
channel estimation proposed in [ 1 ] for multi-cell hybrid mmWave
systems. The derived closed-form approximation of the normalized channel
estimation MSE performance revealed that the channel estimation error
caused by the impact of pilot contamination and noise would vanish
asymptotically with the increasing number of antennas. Furthermore,
based on the estimated CSI, we adopted ZF precoding for the downlink
transmission and derived the closed-form approximation of the average
achievable rate per user in the multi-cell scenario. The analytical and
simulation results showed that the intra-cell interference caused by
pilot contamination as well as the inter-cell interference incurred by
neighboring BSs can be mitigated effectively with an increasing antenna
array gain. It is an excellent feature for multi-cell hybrid mmWave
systems with small-cell radius for improving the network spectral
efficiency.

## Chapter \thechapter Conclusions and Future Works

We conclude this thesis by summarizing our contributions and discussing
some potential future works.

### 24 Conclusions

This thesis mainly focused on channel estimation, analog beamformer and
digital precoder design, and performance analysis that address key
challenges in mmWave systems, by considering, the hardware constraints,
the hardware impairments, non-sparse mmWave channels, the channel
acquisition overhead, the analog beamformer/digital precoder design
complexity, and the cross-cell interference caused by users and BSs in
neighbouring cells.

First, we proposed a tone-based AoA estimation channel estimation
algorithm for mmWave channels to reduce the channel acquisition overhead
significantly. Then, we proposed efficient analog beamformer/digital
precoder technologies for MU hybrid mmWave MIMO systems. Finally, we
applied this solution to multi-small-cell scenarios. We proved that this
channel estimation and analog beamformer/digital precoder design scheme
could effectively mitigate cross-cell interference during uplink and
downlink phases.

In Chapter @xmath , for the channel estimation problem of the massive
MIMO system in mmWave frequencies over Rician fading channels, we
developed a tone-based AoA estimation algorithm leveraging the angular
resolution. Based on estimated CSIs, we proposed an MU SLOS-based MRT
strategy to achieve higher rate performance than that of the
conventional PAC-based MRT strategy. The rate performance gap between
the SLOS-based MRT and the PAC-based MRT was analytically evaluated and
verified via simulation. Besides, the impact of phase quantization
errors on the system rate performance had also been analyzed.

In Chapter @xmath , we proposed a low complexity channel estimation
algorithm for MU TDD hybrid mmWave MIMO systems during the uplink phase,
which was applicable to both non-sparse and sparse mmWave channel
environments. The proposed channel estimation solution leverages the
characteristics of the mmWave channels (the strongest AoAs), the
orthogonal pilot symbols, and the hybrid structures. Exploiting the
estimated strongest AoAs, analog beamforming matrices could be designed.
Then, leveraging the designed analog beamforming matrices and orthogonal
pilot symbols, the BS could estimate the equivalent mmWave channels for
the design of digital precoding matrices. The performance of the
proposed channel estimation algorithm was analyzed. Analytical and
simulation results indicated that the downlink achievable rate based on
the proposed estimated CSI could obtain a considerable achievable rate
of fully digital systems. Furthermore, the robustness of the proposed
channel estimation and MU downlink precoding scheme against hardware
impairments was illustrated via analytical and simulation results.

In Chapter @xmath , we investigated the system rate performance of a
multi-small-cell MU hybrid mmWave MIMO network. We applied the channel
estimation algorithm and the analog beamforming/digital precoding design
scheme proposed in Chapter @xmath to multi-small-cell scenarios.
Different than the conventional massive MIMO system with the
conventional LS channel estimation algorithm, our analytical and
simulation results showed that the channel estimation error incurred by
the impact of pilot contamination and noise vanished asymptotically with
an increasing number of antennas equipped at the desired BS. The results
unveiled that even facing severe intra-cell interference and inter-cell
interference, the average achievable rate performance does not saturate
with increasing the number of antennas equipped at the desired BS. It
was an excellent feature for multi-cell hybrid mmWave systems with
small-cell radius for improving the network spectral efficiency. The
obtained analytical and simulation results could be generalized and
extended for sub- @xmath GHz massive MIMO systems in Rician fading
channels. In other words, pilot contamination was no longer the
fundamental problem for massive MIMO systems in Rician fading channels.

### 25 Future Works

There are several possible directions for future research.

##### 25.0.1 Hybrid architectures with extra RF chains:

The hybrid architecture adopted in Chapter @xmath considered that the
number of RF chains is equal to the number of users. This assumption is
adopted to simplify the notation and the derivation. In general, for the
case of @xmath , the hybrid system can provide enough degrees of freedom
to serve @xmath users simultaneously. However, in the work [ 20 ] , the
authors proved that when the number of RF chains equipped at the BS is
more than twice of the number of users, the hybrid systems can realize
the rate performance of the fully digital systems. If the BS can equip
with more RF chains, more degrees of freedom can be exploited for the
design of analog and digital precoders. In addition, the extra RF chains
adopted by the BS can be used for user scheduling design, anti-blocking
design, and multipath diversity exploitation. Thus, for the case that
@xmath , hybrid systems can achieve a higher rate than that of @xmath .
However, how to exploit the extra RF chains to further improve the rate
performance and the channel estimation performance of hybrid systems is
not considered in this thesis. The case of @xmath should be considered
in the future works. In addition, authors of [ 171 , 172 , 48 ] employed
RF chains with sets of digitally controlled phase paired phase-shifters
and switches to achieve the same rate performance as that of the fully
digital system. Furthermore, with the support of an advanced hybrid
architecture [ 171 , 172 , 48 ] , hybrid systems can achieve higher rate
performance than that of adopting a simple ULA antenna array case.
However, how to exploit extra RF chains as well as advanced hybrid
architectures to further improve the rate performance of hybrid systems
is still an unexplored/interesting research topic and is beyond the
scope of this thesis. We may consider the case of @xmath and the case of
adopting advanced hybrid architectures, e.g. phase shifts with digital
controlled phase and amplitude, for channel estimation and downlink
transmission precoding in our future works.

##### 25.0.2 Distributed hybrid mmWave MIMO network to recapture the
geographic degree of freedom:

The multi-small-cell hybrid mmWave MIMO network adopted in Chapter
@xmath pointed out that the inter-cell and intra-cell interference
during the downlink transmission can be suppressed by simply increasing
the number of antennas equipped at each BS. These features are useful
for small cell scenarios and the dense deployment of BSs. Thus,
cooperating multiple BSs across a large geographic area with small cell
radius can facilitate the reuse of the same piece of spectrum and
further improve the network spectral efficiency [ 122 ] . Besides, with
the dense deployment of BSs, beamforming transmission technology offers
robustness against blockages via inter-BS beam switching. In addition,
the desired user may have multiple paths to multiple BSs. If users are
equipped with multiple RF chains, the SNR maximization principle [ 3 ]
for the design of analog beamforming matrices does not exploit the full
channel capacity. Thus, it would be interesting to develop analog
beamforming matrices and channel estimation solutions jointly to strike
a balance among the channel capacity, the robustness of mmWave systems,
the inter-BS handover, and the energy efficiency.

##### 25.0.3 Extension to the wideband frequency selective :

In general, wideband mmWave channels are assumed as frequency selective.
Since the scalable OFDM structure has been accepted as the standard of
5G NR and mmWave systems are attractive due to their wide bandwidth (in
practice, mmWave are mostly operated at wideband frequencies to support
higher data streams), developing efficient mmWave channel estimation for
frequency selective channels is of great importance.

Current works in the literature assume that the analog beamforming
matrices are frequency flat and are generated using a fully connected
architecture with digitally controlled quantized phase shifters.
However, analog beamforming matrices are frequency selective and have
been discussed in the literature about optimal array signal processing.
To extend the proposed tone-based algorithm, which estimates mmWave
channels by sending narrow bandwidth pulses, to frequency selective
wideband mmWave channels, there are several possible directions for
future research: 1) It is necessary to discuss the spatial beam pattern
distortion of the analog beamforming in frequency selective mmWave
channels. 2) If the digitally controlled quantized amplifier can be
introduced to the hybrid architecture (combined with digitally
controlled quantized phase shifters), can advanced array signal
processing algorithms be introduced for the frequency selective
compensation/equalization?

## Chapter \thechapter Proof of Theorem 2.1

The SINR expression of SLPS-based ZF is given by

  -- -------- -- -------
     @xmath      (147)
  -- -------- -- -------

To express @xmath , first we present the expression of @xmath as

  -- -------- -------- -- -------
     @xmath   @xmath      
              @xmath      (148)
              @xmath      (149)
              @xmath      (150)
  -- -------- -------- -- -------

and @xmath Then, exploiting the matrix inversion approximation [ 176 ]

  -- -------- -- -------
     @xmath      (151)
  -- -------- -- -------

we re-express ( 148 ) as

  -- -------- -- -------
     @xmath      (152)
  -- -------- -- -------

Finally, we could express the closed-form approximation of

  -- -------- -------- -- -------
     @xmath   @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      (153)
  -- -------- -------- -- -------

In (a), we omit some negligibly small random scattering correlation
parts. Also, due to the reason that @xmath is symmetric and small, we
can obtain the approximation @xmath in (b). We substitute ( 153 ) into (
35 ), then the result comes immediately after some straight forward
mathematical manipulation.

## Chapter \thechapter Proof of Corollary 2.1

Now we prove Corollary \thechapter .1 . The desired signal part @xmath
of the received signal at user @xmath is given by

  -- -------- -- -------
     @xmath      (154)
  -- -------- -- -------

Then we express the interference part @xmath as

  -- -------- -------- -- -------
     @xmath               
              @xmath      (155)
  -- -------- -------- -- -------

where @xmath is given by

  -- -------- -------- -- -------
     @xmath               
                          
              @xmath      (156)
  -- -------- -------- -- -------

and @xmath is given by

  -- -------- -------- -- -------
     @xmath   @xmath      
              @xmath      (157)
  -- -------- -------- -- -------

In (c), we omit the negligibly small random scattering correlation part.
Then, the expression in Equation ( 43 ) comes immediately after some
straight forward mathematical manipulation.

## Chapter \thechapter Proof of Theorem 3.1

Now we prove Theorem \thechapter .1 .

  -- -------- -- -------
     @xmath      (158)
  -- -------- -- -------

First, we introduce some preliminaries.

Since @xmath is a positive definite Hermitian matrix, by eigenvalue
decomposition, it can be decomposed as @xmath , @xmath is the positive
diagonal eigenvalue matrix, while @xmath and @xmath are unitary
matrixes, @xmath .

The trace of the eigenvalues of @xmath equals to the trace of matrix
@xmath .

Then we can rewrite the power normalization factor in ( 158 ) as

  -- -------- -------- -- -------
     @xmath   @xmath      (159)
              @xmath      
  -- -------- -------- -- -------

In addition, @xmath , @xmath , is a strictly decreasing convex function
and exploiting the convexity, we have the following results [ 177 ]

  -- -------- -- -------
     @xmath      (160)
  -- -------- -- -------

Therefore, based on ( 159 ) and ( 160 ), we have the following
inequality:

  -- -------- -------- -- -------
     @xmath   @xmath      (161)
  -- -------- -------- -- -------

Based on ( 161 ), Equation ( 158 ) can be rewritten as

  -- -------- -------- -- -------
     @xmath               
     @xmath   @xmath      
     @xmath   @xmath      (162)
  -- -------- -------- -- -------

In @xmath we follow ( 161 ) and in @xmath we adopt the Jensen’s
inequality. This completes the proof.

## Chapter \thechapter Proof of Theorem 3.2

Now we prove Theorem \thechapter .2 .

The receive SINR of user @xmath is given by

  -- -------- -- -------
     @xmath      (163)
  -- -------- -- -------

To express @xmath , first we present the normalized expression of @xmath

  -- -------- -- -- -------
     @xmath         (164)
  -- -------- -- -- -------

where @xmath , @xmath and @xmath

The matrix inversion approximation is given by

  -- -------- -- -------
     @xmath      (165)
  -- -------- -- -------

In this case, we re-express ( 164 ) as

  -- -------- -------- -- -------
     @xmath   @xmath      (166)
  -- -------- -------- -- -------

Finally, we have

  -- -------- -- -------
     @xmath      
                 
                 (167)
                 
     @xmath      (168)
  -- -------- -- -------

In (b), we omit some negligibly small parts which neither dominate the
performance nor scale with @xmath . In (d), while the number of antennas
@xmath , @xmath holds, where @xmath . We substitute ( 167 ) into ( 115 )
and substitute ( 168 ) into ( 115 ), the Equations ( 116 ) and ( 117 )
come immediately after some straight forward mathematical manipulation.

## Chapter \thechapter Proof of Theorem 4.1

The normalized MSE performance of equivalent channel estimation under
the impact of pilot contamination is given by

  -- -------- -------- -- -------
     @xmath   @xmath      
                          
              @xmath      (169)
  -- -------- -------- -- -------

In (a), we omit some small part. Due to the small-cell radius, the
inter-cell uplink propagation channels contain the strongest AoA
components from the users in the neighboring cells to the desired BS.
Thus, the part associated with pilot contamination can be expressed as

  -- -------- -------- -- -------
              @xmath      
     @xmath   @xmath      
                          
     @xmath               
              @xmath      (170)
  -- -------- -------- -- -------

where @xmath . Then, the inter-cell interference caused by scattering
component can be further approximated as

  -- -------- -------- -- -------
                          
     @xmath   @xmath      (171)
  -- -------- -------- -- -------

Now, we would like to approximate the inter-cell interference caused by
the multi-cell strongest AoA components

  -- -------- -------- -- -------
              @xmath      
     @xmath               (172)
  -- -------- -------- -- -------

In Equation ( 172 ), we have

  -- -------- -------- -- -------
     @xmath   @xmath      (173)
     @xmath   @xmath      (174)
  -- -------- -------- -- -------

where variables @xmath is the angle of incidence of the strongest AoA
path at antenna arrays of user @xmath in cell @xmath , and @xmath is the
angle of incidence of the inter-cell strongest AoA path at antenna
arrays from user @xmath of cell @xmath to the desired BS. By defining
the array gain function @xmath , cf. [ 170 ] , as

  -- -------- -- -------
     @xmath      (175)
  -- -------- -- -------

where @xmath . Then, we have:

  -- -------- -------- -- -------
              @xmath      
     @xmath               (176)
  -- -------- -------- -- -------

Similarly, we can have following preliminaries, i.e.,

  -- -------- -------- -- -------
              @xmath      
     @xmath   @xmath      (177)
  -- -------- -------- -- -------

Based on expressions mentioned above, we rewrite @xmath as

  -- -------- -------- -- -------
              @xmath      
              @xmath      
     @xmath   @xmath      (178)
  -- -------- -------- -- -------

Then, Equation ( 172 ) can be re-expressed as

  -- -------- -------- -- -------
                          
     @xmath               
              @xmath      (179)
  -- -------- -------- -- -------

where @xmath , @xmath , @xmath , and @xmath are uniformly distributed
over @xmath . Besides, they are independent with each other. Exploiting
the periodic property of function @xmath , the linear antenna array gain
@xmath is equal in distribution to @xmath and @xmath is equal in
distribution to @xmath , where @xmath , @xmath , and @xmath , @xmath are
uniformly distributed over @xmath (Lemma @xmath of [ 178 ] ). In
addition, @xmath and @xmath is independent with each other. Thus, we
re-express Equation ( 179 ) as

  -- -------- -------- -- -------
              @xmath      
              @xmath      
     @xmath   @xmath      
     @xmath   @xmath      
     @xmath   @xmath      
     @xmath   @xmath      (180)
  -- -------- -------- -- -------

In (b), we exploit the fact that

  -- -------- -- -------
     @xmath      (181)
  -- -------- -- -------

In (c), we explore the law of integration of sinc function for the
number of antennas @xmath is sufficiently large, i.e.,

  -- -------- -------- -- -------
              @xmath      
     @xmath   @xmath      (182)
  -- -------- -------- -- -------

where @xmath . We substitute Equation ( 171 ) and ( 180 ) into ( 169 ),
the expression in ( 133 ) comes immediately after some straightforward
mathematical manipulation.

## Chapter \thechapter Proof of Lemma 4.2

The inter-cell downlink transmission interference is given by

  -- -------- -- -------
     @xmath      
     @xmath      
     @xmath      (183)
  -- -------- -- -------

Following similar approaches shown in Equations ( 172 ) @xmath ( 178 ),
we can re-express the inter-cell interference caused by the strongest
AoA components as

  -- -------- -------- -- -------
                          
              @xmath      
     @xmath   @xmath      
              @xmath      (184)
  -- -------- -------- -- -------

where @xmath , @xmath and @xmath are also independent uniformly
distributed in @xmath . In addition, variables @xmath is the angle of
incidence of the inter-cell strongest AoA path at antenna arrays of user
@xmath in the desired cell from the BS in cell @xmath , and @xmath is
the angle of incidence of the inter-cell strongest AoA path at antenna
arrays of the BS of cell @xmath for user @xmath . Further, in the large
number of antennas regime, @xmath , can be approximated as

  -- -------- -- -------
     @xmath      (185)
  -- -------- -- -------

In the large number of antennas regime, @xmath , @xmath , can be
asymptotically approximated as

  -- -------- -- -------
     @xmath      (186)
  -- -------- -- -------

As variables @xmath and @xmath are independent with each other, here we
first derive @xmath . We rewrite @xmath as

  -- -- -- -------
           (187)
  -- -- -- -------

Since the value of @xmath is uniformly distributed over @xmath , we can
obtain the following result:

  -- -------- -- -------
     @xmath      (188)
  -- -------- -- -------

Based on Equation ( 188 ) and Equation ( 187 ), we have the following
inequality

  -- -- -- -------
           (189)
  -- -- -- -------

Now, we can obtain the following result by exploring the law of
integration of sinc function for a sufficiently large number of antennas
@xmath :

  -- -------- -------- -- -------
              @xmath      
     @xmath   @xmath      
     @xmath   @xmath      
     @xmath   @xmath      (190)
  -- -------- -------- -- -------

where @xmath .

According to the squeeze theorem [ 179 ] , we have

  -- -------- -- -------
     @xmath      (191)
  -- -------- -- -------

Thus, for @xmath , @xmath and the large number of antennas regime,
@xmath can be approximated as

  -- -------- -- -------
     @xmath      (192)
  -- -------- -- -------

In the large number of antennas regime, Equation ( 185 ) can be
asymptotically approximated as

  -- -------- -- -------
     @xmath      (193)
  -- -------- -- -------

Thus, Equation ( 184 ) can be asymptotically approximated as

  -- -------- -- -------
                 
     @xmath      
                 (194)
  -- -------- -- -------

On the other hand, we re-express the inter-cell interference caused by
scattering components in the large number of antennas regime as

  -- -------- -- -------
     @xmath      
     @xmath      (195)
  -- -------- -- -------

By substituting Equations ( 194 ) and ( 195 ) into Equation ( 183 ), we
have

  -- -------- -- -------
     @xmath      (196)
  -- -------- -- -------

This completes the proof.