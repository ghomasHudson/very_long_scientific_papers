# Acknowledgements {SingleSpace}

This thesis would not exist, nor would the years leading up to its
creation have been as fun, without the support of a great many people.

My supervisor is Misha Rudnev, and without his guidance, support,
encouragement and patience nothing here would have been possible. Whilst
none of the work here is specifically joint with Misha, everything
herein has benefitted from his scrutiny and suggestions. My studentship
is funded by the EPSRC, and I have been looked after very well by both
the University of Bristol and the School of Mathematics.

The postgraduate community of the School of Mathematics, and my
long-running housemates Amanda and Nic, who do proper science, have been
an invaluable source of support and distraction. To list everyone from
maths would necessistate several pages, so I will limit myself to
mentioning my combinatorial colleagues Tom Bloom and Olly Roche-Newton,
with whom I have had many fruitful conversations. One of the results in
this thesis is joint work with Tom.

I am also grateful to Jo Bryant and everyone in At-Bristol, and to
Alastair Iles and the leaders and cubs of the 7th Bristol cub pack, for
reminders of the importance of the world outside sumset calculus and
covering methods, and for giving me fun, challenging and most especially
non-mathematical things to do.

Finally, Helen has made me more cups of tea than I care to recall, and
put up with me at the lows (not being able to prove things, and so fed
up) and highs (being able to prove something, and so unable to sit
still) of research.

I have, overall, been very lucky indeed.

## Author’s declaration {SingleSpace}

I declare that the work in this dissertation was carried out in
accordance with the requirements of the University’s Regulations and
Code of Practice for Research Degree Programmes and that it has not been
submitted for any other academic award. Except where indicated by
specific reference in the text, the work is the candidate’s own work.
Work done in collaboration with, or with the assistance of, others is
indicated as such. Any views expressed in the dissertation are those of
the author.

  Signed:
  Date:

###### Table of contents

-    Standard notation
-    Prologue
-    \thechapter Incidence geometry
    -    1 Incidence bounds in a plane
    -    2 The Szemerédi-Trotter theorem
    -    3 Line counting and Beck’s theorem
    -    4 Incidence geometry in @xmath
        -    4.1 Points and lines
        -    4.2 Points and planes in @xmath
        -    4.3 Points and pseudolines
    -    5 Other fields
-    \thechapter Growth
    -    6 Sum-product estimates
        -    6.1 Real and complex sum-products
        -    6.2 Finite field sum-products
    -    7 Expander functions
-    \thechapter A handbook on sumset calculus
    -    8 Introduction
    -    9 The Plünnecke-Ruzsa inequalities
    -    10 Partial sumsets
        -    10.1 High-density partial sumsets
        -    10.2 Less-dense partial sumsets
    -    11 Additive energy
    -    12 Covering methods
-    \thechapter Incidence theorems over finite fields
    -    13 Results
        -    13.1 Incidence bounds
        -    13.2 Line counting
        -    13.3 Structure
    -    14 Foci and configurations
    -    15 How to find foci
    -    16 Bounding partial sum-products
    -    17 Proving Theorems \thechapter .1 and \thechapter .2
    -    18 Further work
-    \thechapter Expander functions
    -    19 Results
        -    19.1 Two variables
        -    19.2 Three and four variables
        -    19.3 Structure
    -    20 Two-variable finite field expanders
        -    20.1 Bounding partial sumsets
        -    20.2 Proving Theorem \thechapter .1
            -    20.2.1 @xmath
            -    20.2.2 @xmath
    -    21 Three and four-variable real and complex expanders
        -    21.1 Cross ratios
        -    21.2 Points, planes and transformations
        -    21.3 Proving Theorems \thechapter .2 and \thechapter .3
    -    22 Further work
-    \thechapter A sum-product theorem in function fields
    -    23 Results
    -    24 Function fields
        -    24.1 Background
        -    24.2 Sum-product considerations
    -    25 Separable sets
    -    26 Finding many separable sets
    -    27 Proof of Theorem \thechapter .1
    -    28 Further work
-    \thechapter Pigeonholing
    -    A Averaging
    -    B Dyadic pigeonholing
    -    C The Cauchy-Schwarz inequality
-    \thechapter Projective geometry
    -    D Projective space
    -    E The hyperplane at infinity
    -    F Projective transformations

*

###### List of figures

-    1 Counting incidences
-    2 @xmath collinear points determine @xmath edges.
-    3 The two extremes for counting lines.
-    4 A point set and focus
-    5 Sum-product configurations
-    6 An illustration of Desargues’ theorem.

*

\settocdepth

section

\OnehalfSpacing

## Standard notation

The following standard conventions are used.

-   Write @xmath , @xmath , or @xmath if there is a fixed constant
    @xmath such that @xmath . The constant @xmath is referred to as the
    ‘implicit constant’.

-   Using this notation, we will often use the fact that @xmath if and
    only if @xmath .

-   If @xmath and @xmath then write @xmath or @xmath .

-   If the implicit constant depends on some parameter @xmath then this
    is reflected with a subscript, e.g. @xmath or @xmath .

-   Write @xmath , @xmath , @xmath or @xmath if @xmath for all @xmath .
    In particular, this notation is used when @xmath for some @xmath .

-   Write @xmath for an indicator function, that is if @xmath is a
    proposition then @xmath is equal to @xmath if @xmath is true and is
    zero otherwise.

-   The letters @xmath have their usual meaning. By @xmath we mean a
    finite field of prime order @xmath , and by @xmath a finite field of
    order @xmath , where @xmath is a prime power. The letters @xmath and
    @xmath will also be used to denote points in a plane or
    higher-dimensional vector space, but the context will ensure that no
    confusion arises.

-   For subsets @xmath of a field, write @xmath and @xmath for the
    sumset and product set of @xmath and @xmath . The difference set
    @xmath and ratio set @xmath are defined analogously.

-   If @xmath is an element and @xmath a subset of a field then write
    @xmath for the translation @xmath and @xmath for the dilation @xmath
    .

-   If @xmath is a natural number and @xmath is a subset of a field then
    write @xmath for the iterated sumset @xmath Context will ensure that
    no confusion between a dilation and an iterated sumset of @xmath
    arises.

## Prologue

  ‘And if you take one from three hundred and sixty-five what remains?’
  ‘Three hundred and sixty-four, of course.’
  Humpty Dumpty looked doubtful, ‘I’d rather see that done on paper,’ he
  said.
  \sourceatright Lewis Carroll, Through the Looking-Glass

This thesis sets new records at the interface of two areas of
mathematics: incidence geometry and growth. The first of these,
incidence geometry, is about points and lines in a plane and incidences
between them; a point is ‘incident’ to a line if it lies on that line.
The following sorts of problem are typical:

-   [ ]

-    Incidence bounds. Incidences are counted with multiplicity, in the
    sense that if several lines cross at a single point then we count
    several incidences. In total, how many incidences could there be
    between a finite set of points and a finite set of lines?

-    Line counting. A pair of distinct points determines a line. In
    total, how many distinct lines might be determined by pairs from a
    finite set of points?

There are many natural generalisations, for example to higher
dimensional vector spaces instead of planes, to curves instead of lines,
and so forth.

The second area, growth, is about how much bigger a finite subset of a
field becomes after passing to its image under some function of two or
more variables. Examples are:

-   [ ]

-    Sum-product estimates. For a set @xmath of given cardinality, how
    much bigger must the quantity @xmath be? Here, @xmath and @xmath are
    respectively the sets of pairwise sums and products of elements of
    @xmath .

-    Expander functions. Let @xmath be the ambient field and @xmath be
    an integer. What functions @xmath are there for which the set @xmath
    is always much bigger than a finite subset @xmath of @xmath ?

There is a common theme to all of this: estimating how much
regimentation can be forced onto a finite set. For example, on the
incidence geometry side the existence of too many incidences corresponds
to the existence of extremely structured sets of points and lines.
Understanding incidence bounds means placing a cap on such structure. As
an example on the growth side, the only way in which the sumset @xmath
or the product set @xmath can be small is if the elements of @xmath are
arranged respectively in some kind of additive or multiplicative
‘conspiracy’, such as an arithmetic or geometric progression.
Understanding sum-product estimates therefore means working out how far
such conspiracies could coincide.

There are applications of this theme, and of the specific problems
above, to theoretical computer science and cryptography, where they can
be used to obtain rigorous estimates of pseudorandom behaviour. However
these are not pursued here, the motivation instead being for progress on
the problems in their own right. The only exception to this approach of
not worrying about applications is the interaction between the problems
themselves. Incidence results have applications to growth, and growth
results have applications to incidences, and this is one of the things
that will contribute to progress on both.

When it comes to results the philosophy is one of ‘hard analysis’,
placing the emphasis on finding explicit bounds and making them as
strong as possible. Quite how strong this might be depends very much on
the choice of underlying field. Historically the attention was on real
numbers. There are powerful results in this setting, which is still
extremely active. With work, many incidence and growth results extend
verbatim from the real to complex settings. More recently a lot of
research has focused on finite fields ¹ ¹ 1 Recall that the finite field
@xmath of prime order @xmath is simply the set of residues modulo @xmath
under addition and multiplication, and that the finite field @xmath of
prime power order @xmath is a degree @xmath algebraic extension of
@xmath . . This thesis presents work in all of these areas, and also
breaks new ground in the relatively unexplored setting of function
fields ² ² 2 The function field @xmath is the field of rational
functions over the finite field @xmath .

### Some remarks on finite fields

Much, but by no means all, of the work in this thesis concerns finite
fields, and it is worth pausing to explain a couple of considerations
versus the real and complex settings. There is also a slightly different
set of considerations in the study of function fields, but these are
deferred to Chapter \thechapter since that is the only place they arise.

There are two main complications in finite fields. The first is the
existence of finite subfields, which must be ruled out before anything
nontrivial can be said. In the case of the field @xmath of prime order
@xmath , this collapses into a cardinality condition since there are no
proper subfields. For this reason much finite field research focuses on
the prime order case; the hoops that one must jump through are similar
to the general case, but the mathematics is usually cleaner.

The second complication is an issue of tools and difficulty. Many
methods in the real and complex settings depend critically on their
topologies and so do not extend to finite fields. This makes it a lot
harder to prove things and forces a more combinatorial approach, which
is a mixed blessing. The bad news is that quantitative results are
usually not as strong. But the good news is that methods and results
achieved in finite fields usually extend elsewhere without difficulty.
Thus finite field results carry a certain amount of moral authority as
they correspond to the worst possible cases.

Although not considered here in detail, it is worth remarking that there
is an additional ‘large set’ paradigm for finite field results, with
extensive literature. This features strong results for sets satisfying
an additional minimum density condition, typically at least a
square-root barrier. However the methods have a very different flavour,
drawing for example on estimates for exponential sums. On top of this,
they cannot be so easily exported to other settings; the interest here
is in finite sets, but a minimum density condition in finite fields is
usually analogous to a requirement for infinite sets elsewhere.

### Structure of the thesis

The first three chapters build up background and preliminaries.

-    Chapters \thechapter and \thechapter introduce incidence geometry
    and growth respectively in more detail. They also record particular
    incidence and growth results for use in later chapters.

-    Chapter \thechapter is a handbook of results in sumset calculus,
    which is a workhorse of much of the later mathematics.

The subsequent chapters are concerned with original results, developing
state of the art incidence geometry and growth in several directions.
Between them, there are new results on all four problems from page
Prologue : incidence bounds, line counting, sum-product estimates and
expander functions. Moreover they encompass real, complex and finite
field settings, and also break new ground in the relatively unexplored
function field setting.

-    Chapter \thechapter considers incidence geometry over finite fields
    and sets two new records.

    -   [*]

    -   The first is a new incidence bound. If @xmath and @xmath are a
        set of points and lines respectively in @xmath with @xmath then,
        writing @xmath for the number of incidences between @xmath and
        @xmath , non-trivial bounds are of the form @xmath for @xmath .

        A new bound of @xmath is established, holding whenever @xmath .
        This improves by an order of magnitude on the previous bound of
        @xmath

    -   The second is a new line counting result. If @xmath is a set of
        points in @xmath with @xmath then either @xmath of the points
        are collinear, or @xmath determines at least @xmath distinct
        lines.

        This improves on previous results in two ways. Quantitatively,
        the exponent is stronger than the previously best-known @xmath .
        And qualitatively, the result applies to all subsets of @xmath
        satisfying the cardinality condition; the previously best-known
        result applies only for @xmath of the form @xmath for @xmath .

-    Chapter \thechapter sets three new records for expander functions.

    -   [*]

    -   First, there is a result on two-variable expanders in finite
        fields. If @xmath then @xmath whenever @xmath is a subset of
        @xmath with @xmath . This improves on the previous best-known
        exponent of @xmath .

    -   Second, there is a result on three-variable expanders for
        complex numbers. The function @xmath , which has not been
        previously considered in this context, is shown to satisfy
        @xmath for any finite @xmath . Previously-known functions with
        this property were all of four variables and applied only to
        sets of real numbers.

    -   Third, there is a result on four-variable expanders for real
        numbers. The function @xmath again not previously considered in
        this context, is shown to satisfy @xmath whenever @xmath is a
        finite set of real numbers. The previously best-obtained bound
        for a function of four variables was @xmath .

-    Chapter \thechapter is joint work with Thomas Bloom and breaks new
    ground by establishing a sum-product estimate in the function field
    @xmath , a relatively unexplored setting for this kind of work.
    Function fields form an interesting intermediate case between the
    finite field and real and complex settings since they have an
    unusually rigid ‘non-archimedean’ topology.

    A sum-product estimate of

      -- -------- --
         @xmath   
      -- -------- --

    is established for any finite subset @xmath of @xmath . The exponent
    of @xmath lies between the @xmath known for finite fields and the
    @xmath known for real and complex numbers.

There are two appendices, which summarise standard background
information.

-    Appendix \thechapter covers standard pigeonholing results used
    throughout the thesis. The phrases ‘by averaging’, ‘by
    Cauchy-Schwarz’ and ‘by dyadic pigeonholing’ are deployed frequently
    and implicitly refer to results from here.

-    Appendix \thechapter covers material on projective geometry
    necessary for Chapter \thechapter and Chapter \thechapter .
    Additional standard material on the projective theory of cross
    ratios is covered at an appropriate point in Chapter \thechapter .

## Chapter \thechapter Incidence geometry

The prologue mentioned two areas of incidence geometry: incidence bounds
and line counting. This chapter introduces them properly, with an
emphasis on the real and complex settings, the case of finite fields
being deferred to Chapter \thechapter . In so doing it also records
results which will be of use in Chapter \thechapter .

Incidence bounds are covered first, establishing a trivial estimate
which holds regardless of the underlying field. Non-trivial incidence
bounds depend on the setting; the best-understood case is the plane
@xmath , where the classical Szemerédi-Trotter theorem holds. Line
counting is then tackled in @xmath , establishing Beck’s theorem as a
consequence of Szemerédi-Trotter.

Three ways of generalising to higher-dimensions are also considered, as
is a generalisation from the real to complex setting.

Apart from Theorem \thechapter .8 , which is a straightforward variation
of existing results, all of the mathematics in this chapter is drawn
from the literature.

### 1 Incidence bounds in a plane

A plane is simply @xmath where @xmath is a field. A point is an element
of @xmath and a line is the set of points @xmath satisfying an equation

  -- -------- --
     @xmath   
  -- -------- --

for fixed @xmath that are not all zero. A point @xmath is incident to a
line @xmath if @xmath . If @xmath is a finite set of points in a plane,
and @xmath is a finite set of lines, then write @xmath for the number of
incidences between points in @xmath and lines in @xmath , that is

  -- -------- -- -----
     @xmath      (1)
  -- -------- -- -----

where

  -- -------- --
     @xmath   
  -- -------- --

Incidences are therefore counted with multiplicity, as illustrated in
Figure 1 .

It is worth remarking (see Appendix \thechapter ) that a ‘plane’ could
instead be taken to be the projective plane @xmath containing @xmath ,
and ‘lines’ to be projective lines within it. Indeed, all the results in
this chapter extend without difficulty to projective space. But since no
properties of the projective setting will be used, it makes sense to
stay with the affine one. Chapters \thechapter and \thechapter make
active use of the properties of projective space, and we will cross that
bridge when we come to it.

An important topic in incidence geometry is the study of upper bounds on
@xmath in terms of @xmath and @xmath , referred to as incidence bounds .
When considering these, the most straightforward observation to make is
that each point in @xmath is incident to at most @xmath lines in @xmath
, implying that

  -- -------- --
     @xmath   
  -- -------- --

However it is immediate from the definition of points and lines that two
lines in @xmath are simultaneously incident to at most one point in
@xmath , and two points in @xmath are simultaneously incident to at most
one line in @xmath . This fact, combined with the Cauchy-Schwarz
inequality, leads to the following somewhat better estimate, which is
nonetheless referred to as trivial.

###### Lemma \thechapter.1 (Trivial incidence bound).

If @xmath is a set of points in a plane, and @xmath is a set of lines,
then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Cauchy-Schwarz and ( 1 ) imply that

  -- -------- -------- -- -----
     @xmath   @xmath      
              @xmath      (2)
  -- -------- -------- -- -----

Split the summation over lines @xmath according to whether or not @xmath
and @xmath are distinct, so that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Substituting into ( 2 ) yields

  -- -------- -------- -- -----
     @xmath   @xmath      (3)
  -- -------- -------- -- -----

Two distinct lines are simultaneously incident to at most one point, and
so

  -- -------- --
     @xmath   
  -- -------- --

whenever @xmath , since this is the number of points in @xmath incident
to both @xmath and @xmath . Hence from ( 3 ),

  -- -------- --
     @xmath   
  -- -------- --

So either @xmath in which case @xmath , or @xmath in which case @xmath .
Overall therefore

  -- -------- --
     @xmath   
  -- -------- --

The proof that @xmath is the same, except that the roles of points and
lines are reversed. ∎

It is often helpful to consider the ‘critical’ case where @xmath and
@xmath have the same cardinality, say @xmath . In this case, the trivial
bound from Lemma \thechapter .1 is

  -- -------- --
     @xmath   
  -- -------- --

and so non-trivial bounds will be of the form

  -- -------- --
     @xmath   
  -- -------- --

for @xmath .

The following standard result shows that best non-trivial bound that can
be hoped for is @xmath , that is @xmath .

###### Lemma \thechapter.2 (Constraint on incidence bounds).

Let @xmath be a field. If @xmath has characteristic @xmath then for any
positive integer @xmath there is a set @xmath of points in @xmath and a
set @xmath of lines, with @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

If the characteristic of @xmath is @xmath then the same result holds,
but with the constraint that @xmath must be less than @xmath .

###### Proof.

Write @xmath for the line given by @xmath . In the zero-characteristic
case take

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

There are @xmath distinct points in @xmath and @xmath distinct lines in
@xmath , and it is easy to check that each line in @xmath is incident to
@xmath points in @xmath , meaning that there are @xmath incidences.

The characteristic @xmath case is the same; simply replace @xmath in the
construction with @xmath . The constraint that @xmath ensures that all
the points and lines are distinct. ∎

### 2 The Szemerédi-Trotter theorem

What can be said about non-trivial incidence bounds? The answer depends
on the underlying field over which the plane is defined. This section
considers the classical case of the plane @xmath where Szemerédi and
Trotter [ 46 ] proved the following flagship result of incidence
geometry.

###### Theorem \thechapter.3 (Szemerédi, Trotter).

If @xmath is a set of points in @xmath and @xmath is a set of lines,
then

  -- -------- --
     @xmath   
  -- -------- --

In the critical case this gives @xmath , which is sharp up to the
implicit constant by Lemma \thechapter .2 . Before proving
Szemerédi-Trotter it is worth recording an immediate consequence which
is often useful in applications to other problems.

###### Corollary \thechapter.4.

Let @xmath be a set of lines in @xmath . Then the number of points
incident to at least @xmath lines in @xmath is @xmath . Similarly, the
number of lines incident to at least @xmath points in a point set @xmath
is @xmath .

###### Proof.

Let @xmath be the set of points incident to at least @xmath lines in
@xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

On the other hand, the Szemerédi-Trotter theorem shows that

  -- -------- --
     @xmath   
  -- -------- --

and so comparing upper and lower bounds on @xmath gives

  -- -------- --
     @xmath   
  -- -------- --

as required. The proof for the number of lines incident to at least
@xmath points is similar. ∎

Now for a proof of the Szemerédi-Trotter theorem. There have been
several proofs since Szemerédi and Trotter’s original. The one here is
due to Székely [ 45 ] . A third proof, using different techniques again,
can be found in a recent paper of Kaplan, Matous̆ek and Sharir [ 27 ] .

###### Proof of Theorem \thechapter.3..

Without loss of generality assume that every point is incident to at
least one line, and every line is incident to at least one point. Recall
that a graph @xmath consists of a set @xmath of vertices , and a set
@xmath of unordered pairs of vertices, called edges .

Construct a graph @xmath as follows. Take the set @xmath of vertices to
be the set of points @xmath . To construct the set @xmath of edges, say
that @xmath is an edge if and only if @xmath and @xmath are adjacent
along a line in @xmath , in the sense that the line segment connecting
them is contained in a line from @xmath and contains no other points
from @xmath .

For each @xmath write @xmath for the number of points @xmath that are
incident to @xmath . Note that @xmath contains @xmath edges from @xmath
, as illustrated in Figure 2 .

It follows that

  -- -------- -------- -- -----
     @xmath   @xmath      
              @xmath      
              @xmath      (4)
  -- -------- -------- -- -----

We now apply a graph-theoretic result. A drawing of @xmath is an
identification of each vertex in @xmath with a distinct point in @xmath
, and of each edge @xmath with a curve connecting @xmath and @xmath . A
crossing occurs whenever two curves corresponding to edges intersect
away from a vertex. Write @xmath for the minimum number of crossings in
a drawing of @xmath . We will employ the following lemma; see Chapter 8
of the book of Tao and Vu [ 48 ] for a proof.

###### Lemma \thechapter.5 (Crossing number lemma).

Let @xmath be a graph with @xmath . Then @xmath .

Applying the crossing number lemma and ( 4 ) shows that at least one of
the following bounds holds

  -- -------- -------- -- -----
     @xmath   @xmath      (5)
     @xmath   @xmath      (6)
  -- -------- -------- -- -----

Let’s consider what happens when ( 6 ) holds. It is clear that

  -- -------- -- -----
     @xmath      (7)
  -- -------- -- -----

since for two edges to cross it is necessary that two lines cross.
Comparing the bounds ( 6 ) and ( 7 ) yields

  -- -------- --
     @xmath   
  -- -------- --

and hence

  -- -------- -- -----
     @xmath      (8)
  -- -------- -- -----

whenever ( 6 ) holds. Thus either ( 5 ) or ( 8 ) holds, implying overall
that

  -- -------- --
     @xmath   
  -- -------- --

as required. ∎

The key to the above proof is the crossing number inequality. Beyond
this the only properties used are the trivial facts that any two lines
are simultaneously incident to at most one point, and any two points are
simultaneously incident to at most one line. With a few modifications ³
³ 3 See for example Theorem 8.10 of the book of Tao and Vu [ 48 ] . the
same argument goes through when @xmath is a set of curves rather than
lines, such that any two points in @xmath are simultaneously incident to
at most @xmath curves and any two curves in @xmath are simultaneously
incident to at most @xmath points in @xmath . The implicit constant in
the statement then depends on @xmath and @xmath and so the theorem
becomes

  -- -------- --
     @xmath   
  -- -------- --

The required changes are to replace the crossing number lemma for graphs
with one for multigraphs, and to replace ( 7 ) with

  -- -------- --
     @xmath   
  -- -------- --

Pach and Sharir [ 35 ] took this approach further, to encompass the case
where any @xmath points, rather than any two points, are simultaneously
incident to at most @xmath curves. Note that the condition on curves
remains the same; any two curves are simultaneously incident to at most
@xmath points, rather than any @xmath .

###### Theorem \thechapter.6 (Pach, Sharir).

Let @xmath be a set of points in @xmath and @xmath be a set of curves,
such that any @xmath points in @xmath are simultaneously incident to at
most @xmath curves in @xmath and any two curves in @xmath are
simultaneously incident to at most @xmath points in @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

### 3 Line counting and Beck’s theorem

This section gives an application of the Szemerédi-Trotter theorem to
the line counting problem. Two distinct points in @xmath determine a
line, and so for a set @xmath of points we can consider the set @xmath
of lines determined by pairs of points in @xmath . This could have just
one element, which would happen if all the points in @xmath lie along a
single line as in Figure 3 (a). Or it could be as large as @xmath if the
points are in general position as in Figure 3 (b).

The following theorem of Beck [ 3 ] asserts that, up to multiplicative
constants, these two extremes are essentially the only two
possibilities.

###### Theorem \thechapter.7 (Beck).

If @xmath is a set of points in @xmath then at least one of the
following holds

1.   At least @xmath points in @xmath are incident to a single line.

2.  @xmath .

Beck’s theorem was originally published in the same journal edition as
the Szemerédi-Trotter theorem. But it is in fact also a consequence of
Szemerédi-Trotter. This latter proof, given here, is more
straightforward and can be found for example as exercise 8.2.6 in the
book of Tao and Vu [ 48 ] .

###### Proof of Theorem \thechapter.7.

For each @xmath write @xmath for the number of points @xmath that are
incident to @xmath . It is clear that

  -- -------- --
     @xmath   
  -- -------- --

since the right-hand side counts pairs of distinct points in @xmath
incident to @xmath . It follows that

  -- -------- -------- --
     @xmath   @xmath   
  -- -------- -------- --

For fixed @xmath there is precisely one line in @xmath that is incident
to @xmath and @xmath , so

  -- -------- --
     @xmath   
  -- -------- --

and hence by combining the above equations

  -- -------- -- -----
     @xmath      (9)
  -- -------- -- -----

Now for each integer @xmath let @xmath be the set of @xmath for which
@xmath Corollary \thechapter .4 implies that

  -- -------- -- ------
     @xmath      (10)
  -- -------- -- ------

For points @xmath write @xmath for the line determined by @xmath and
@xmath . For any constant @xmath , let @xmath be the set of pairs of
distinct points @xmath for which

  -- -------- --
     @xmath   
  -- -------- --

From ( 10 ),

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      (11)
  -- -------- -------- -- ------

Summing geometric series yields

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

and so ( 11 ) implies

  -- -------- -- ------
     @xmath      (12)
  -- -------- -- ------

Comparing ( 9 ) and ( 12 ) it is possible to pick a constant @xmath
sufficiently large that

  -- -------- --
     @xmath   
  -- -------- --

Thus for this fixed @xmath , either

  -- -------- --
     @xmath   
  -- -------- --

or

  -- -------- --
     @xmath   
  -- -------- --

In the former case there are @xmath pairs @xmath for which @xmath , and
so in particular there is at least one line in @xmath that is incident
to @xmath points. This corresponds to the first case in the conclusion
of the theorem.

In the latter case there are @xmath pairs of points @xmath for which
@xmath , meaning that there are @xmath distinct lines in @xmath . This
corresponds to the second case in the conclusion of the theorem. ∎

Since it is a consequence of Szemerédi-Trotter, which extends to points
and curves, the statement of Beck’s theorem generalises in the same way.
This can be further developed by using the Pach-Sharir theorem in place
of Szemerédi-Trotter, for example to the following result.

###### Theorem \thechapter.8.

For finite @xmath , write @xmath for the set of circles determined by
non-collinear triples of points from @xmath . For any @xmath , at least
one of the following holds:

1.   There are @xmath cocircular points in @xmath .

2.   There are @xmath collinear points.

3.  @xmath .

The details of the proof are similar to that of Beck’s theorem, using
instead the @xmath case of the Pach-Sharir theorem and the fact that
three distinct non-collinear points determine a circle.

### 4 Incidence geometry in @xmath

It is interesting, and useful for applications to other problems, to
consider incidence geometry in higher-dimensional vector spaces than the
plane. This section generalises the material of the previous two
sections from @xmath to @xmath . Since Beck’s line-counting theorem
follows from the Szemerédi-Trotter incidence bound, the focus is on
higher-dimensional incidence bounds, with their application to line
counting in @xmath left as an exercise.

There are several ways to formulate higher-dimensional results. One is
to simply consider point-line incidences in the higher-dimensional
setting. Another is to consider higher-dimensional objects than lines,
for example incidences between points and planes in @xmath . Somewhere
between these two is the study of ‘pseudolines’ which may be higher
dimensional than lines but intersect pairwise in at most @xmath points.

#### 4.1 Points and lines

The Szemerédi-Trotter theorem extends by a random projection argument to
the setting where the points and lines lie in @xmath rather than @xmath
. Simply project @xmath and @xmath onto a randomly chosen @xmath -plane
in @xmath . With positive probability the number of incidences between
the projected points and projected lines will be the same as those
between the originals.

Since Szemerédi-Trotter is sharp in @xmath it is also sharp in @xmath .
However improvements are available subject to constraints on the
arrangements of lines so that, for example, not too many of them lie in
any one plane. Guth and Katz [ 18 ] obtained a breakthrough result of
this kind in @xmath which enabled them to solve the famous ‘distinct
distances’ problem of Erdös. Their incidence result is as follows:

###### Theorem \thechapter.9 (Guth, Katz).

Let @xmath be a set of lines in @xmath of which no more than @xmath are
simultaneously incident to the same point, plane or regulus ⁴ ⁴ 4 A
regulus is a ‘doubly-ruled’ surface. That is, every point in a regulus
@xmath is incident to at least two lines entirely contained in @xmath .
. Then the number of points in @xmath incident to at least @xmath lines
in @xmath is at most @xmath

The bound in Theorem \thechapter .9 should be compared to the
Szmerédi-Trotter bound @xmath arising from Corollary \thechapter .4 when
@xmath . The two bounds agree when @xmath but Theorem \thechapter .9 is
stronger for smaller @xmath .

#### 4.2 Points and planes in @xmath

Some kind of nondegeneracy condition is necessary to say anything
interesting about incidences between a set @xmath of points and a set
@xmath of planes, since if all the planes in @xmath intersect along a
single line that is incident to all the points in @xmath , then @xmath

Edelsbrunner, Guibas and Sharir [ 8 ] proved the following result under
the fairly strong condition that no three planes are collinear. There
are also plenty of examples [ 1 , 2 , 7 , 12 ] of point-plane incidence
results under other nondegeneracy conditions.

###### Theorem \thechapter.10 (Edelsbrunner, Guibas, Sharir).

Let @xmath and @xmath be a set of points and planes respectively in
@xmath . If no three planes are collinear then

  -- -------- --
     @xmath   
  -- -------- --

In the original paper [ 8 ] this bound is multiplied by a factor of the
form @xmath . However Apfelbaum and Sharir [ 2 ] showed that this
additional factor can be eliminated with more careful analysis and so
the refined version is used here.

Like the Szemerédi-Trotter theorem, the Edelsbrunner-Guibas-Sharir
theorem has a standard corollary, the derivation of which follows
precisely as for Corollary \thechapter .4 .

###### Corollary \thechapter.11.

Let @xmath be a set of planes in @xmath , no three of which are
collinear. Then the number of points incident to at least @xmath planes
in @xmath is @xmath

#### 4.3 Points and pseudolines

A set @xmath of points and a collection @xmath of varieties in @xmath
form a pseudoline system if

1.  Any pair of varieties from @xmath intersect in at most @xmath points
    in @xmath .

2.  Any pair of points from @xmath are simultaneously incident to at
    most @xmath varieties in @xmath .

3.  Points in @xmath can be incident to varieties in @xmath only at
    their smooth points.

4.  If two varieties intersect at a point in @xmath then their tangent
    spaces intersect only at that point.

Solymosi and Tao [ 44 ] proved the following result which generalises
the Szemerédi-Trotter theorem, up to a loss of @xmath in the exponent of
@xmath , to pseudoline systems in @xmath for which the varieties are of
dimension at most @xmath .

###### Theorem \thechapter.12 (Solymosi, Tao).

Let @xmath and let @xmath and @xmath form a pseudoline system in @xmath
. If the varieties in @xmath are at most @xmath -dimensional, and all
have degree at most @xmath then

  -- -------- --
     @xmath   
  -- -------- --

The case with @xmath and @xmath is particularly important in the next
section, as it corresponds to a Szemerédi-Trotter theorem for complex
numbers. In this case, Zahl [ 51 ] succeeded in eliminating the @xmath
loss to give the following result.

###### Theorem \thechapter.13 (Zahl).

Let @xmath and @xmath form a pseudoline system in @xmath . If the
varieties in @xmath are all @xmath -dimensional, and all have degree at
most @xmath then

  -- -------- --
     @xmath   
  -- -------- --

### 5 Other fields

So far we have considered only real vector spaces. But we are also
interested in other settings, in particular complex numbers and finite
fields. Chapter \thechapter examines incidence geometry over finite
fields and proves several original results, so we keep our powder dry
and consider only the complex setting here.

Tóth [ 49 ] announced ⁵ ⁵ 5 The 2011 preprint referenced here is a more
recent version of the 2003 original. the following generalisation of the
Szemerédi-Trotter theorem to @xmath in 2003, but nearly ten years later
it is still in the review process.

###### Theorem \thechapter.14 (Tóth).

If @xmath is a set of points in @xmath and @xmath is a set of lines,
then

  -- -------- --
     @xmath   
  -- -------- --

The usual corollary to Szmerédi-Trotter applies here as well:

###### Corollary \thechapter.15.

Let @xmath be a set of lines in @xmath . Then the number of points
incident to at least @xmath lines in @xmath is @xmath . Similarly, the
number of lines incident to at least @xmath points in @xmath is @xmath .

More recently, the work of Solymosi, Tao and Zahl on pseudolines yields
Tóth’s result as a special case. Indeed, lines in @xmath are pseudolines
in @xmath and so Theorem \thechapter .14 is an immediate corollary of
Theorem \thechapter .13 .

One can of course then consider complex versions of the
higher-dimensional generalisations in Section 4 . Theorem \thechapter
.14 extends to point-line incidences @xmath , in the same way as
Szemerédi-Trotter, although it is not known if the Guth-Katz theorem for
@xmath generalises to @xmath .

## Chapter \thechapter Growth

Just as the last chapter did for incidence geometry, the purpose here is
to introduce the two examples of growth highlighted in the prologue:
sum-product estimates and expander functions. The chapter also records
particular results that will be useful in Chapter \thechapter .

The idea for sum-product estimates is that, for a subset @xmath of a
field, at least one of the sumset @xmath and the product set @xmath must
always be large. Chapter \thechapter will use finite field sum-product
estimates as a key ingredient to proving new finite field incidence
theorems. Chapter \thechapter will establish a sum-product theorem in
function fields, a relatively unexplored setting for the problem.

Expander functions are slightly different from sum-products. Rather than
considering both the sumset and the product set, the concern is with the
cardinality of a single image set @xmath of some multivariate function
@xmath . A medley of new results on expander functions are proved in
Chapter \thechapter .

All of the mathematics in this chapter is drawn from the literature.

### 6 Sum-product estimates

Let @xmath be a finite subset of a field @xmath , and consider the
cardinalities of the sumset

  -- -------- --
     @xmath   
  -- -------- --

and the product set

  -- -------- --
     @xmath   
  -- -------- --

It is clear that both these sets have at least the same cardinality as
@xmath . And it is certainly possible to have @xmath or @xmath , for
example if @xmath is either an arithmetic or geometric progression. But
the idea of sum-product estimates is that it is not possible to have
both of these at once . Results are therefore of the form

  -- -------- --
     @xmath   
  -- -------- --

with @xmath , holding for any finite set @xmath that possibly satisfies
some nondegeneracy conditions. Larger values of @xmath correspond to
stronger results.

Sum-products were first studied by Erdös and Szemerédi [ 13 ] , who
proved the existence of an unquantified @xmath holding for any finite
set @xmath of integers. They conjectured that @xmath . It is not
possible to remove the @xmath from this conjecture, as demonstrated by
the case where @xmath is the set of integers between @xmath and @xmath ;
in this case @xmath but @xmath .

Sum-product estimates can of course be considered in the more general
setting of rings instead of fields, and indeed Erdös and Szemerédi’s
initial work concerned the ring of integers. However, when working over
general rings the sum-product phenomenon is constrained by the
possibility of zero divisors. If @xmath contains too many then the
sumset and the product set might both be small. The motivation for
sticking with fields in this thesis is therefore that avoiding
zero-divisor considerations means working with an integrel domain, and
when given an intergral domain one may as well work with its field of
fractions. Tao [ 47 ] has recently obtained a general, non-explicit,
sum-product result for rings in the absence of too many zero divisors.

#### 6.1 Real and complex sum-products

The strongest known sum-product estimate is @xmath , which was proved
for any finite set of reals by Solymosi [ 43 ] and recently generalised
to any finite set of complex numbers by Konyagin and Rudnev [ 30 ] .
There is a fairly extensive list [ 9 , 14 , 34 , 41 , 42 ] of previous
results in the real and complex settings.

The incidence geometry of Chapter \thechapter yields a lot of
information about sum-products via the Szemerédi-Trotter theorem. An
example, not quite as strong as the more recent Solymosi and
Konyagin-Rudnev bounds, is the following result of Elekes [ 9 ] . A more
involved version of this approach can be found in another paper of
Solymosi [ 42 ] .

###### Theorem \thechapter.1 (Elekes).

Let @xmath be finite. Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Define a point set @xmath and a line set @xmath by

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

where @xmath is the line given by @xmath . It is clear that

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

Each line @xmath is incident to at least @xmath points in @xmath since
for each @xmath the point @xmath is an element of @xmath . Thus

  -- -------- --
     @xmath   
  -- -------- --

Applying the the complex Szemerédi-Trotter theorem (Theorem \thechapter
.14 ) shows that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Comparing the upper and lower bounds on @xmath yields

  -- -------- --
     @xmath   
  -- -------- --

So either

  -- -------- --
     @xmath   
  -- -------- --

or

  -- -------- --
     @xmath   
  -- -------- --

In the event of the former, rearranging gives

  -- -------- --
     @xmath   
  -- -------- --

On the other hand, if the latter holds then

  -- -------- --
     @xmath   
  -- -------- --

Either way the proof is complete. ∎

#### 6.2 Finite field sum-products

Sum-product results for finite fields must be prefaced with a
nondegeneracy condition, to prevent the set @xmath being too close to a
copy of a subfield. For example if @xmath is a field then @xmath and so
non-trivial estimates are impossible. To keep this issue as
straightforward as possible it is often convenient to concentrate on the
finite field @xmath of prime order @xmath , where it collapses into the
requirement for an upper bound on @xmath in terms of @xmath .

Let’s now see what estimates are known in @xmath . The breakthrough
result was due to Bourgain, Katz and Tao [ 6 ] who proved the existence
of an absolute @xmath dependent on @xmath that holds whenever @xmath .

Garaev [ 15 ] made the Bourgain-Katz-Tao result explicit, obtaining
@xmath whenever @xmath . This has been subsequently improved by a
variety of authors [ 5 , 29 , 31 , 40 , 37 ] . The most recent estimate
is @xmath whenever @xmath , due to Rudnev [ 37 ] . Li and Roche-Newton [
33 ] built on a technique of Katz and Shen [ 28 ] to extend this
estimate to any finite field, not necessarily of prime order, so long as
@xmath is not too close to being a subfield.

Chapter \thechapter will use a particular form of Rudnev’s @xmath
result. Its statement involves the multiplicative energy @xmath of
@xmath , which is the number of solutions to @xmath with @xmath ; this
is developed more fully in Chapter \thechapter . As Rudnev remarks in
his paper, the result is really an upper bound on @xmath in terms of the
sumset @xmath , and works just as well when this is replaced with the
difference set @xmath . In these terms, the estimate can be formulated
as follows.

###### Theorem \thechapter.2 (Rudnev).

Let @xmath . If @xmath then

  -- -------- --
     @xmath   
  -- -------- --

The estimate @xmath follows from the fact (again, see Chapter
\thechapter ) that @xmath is greater than or equal to @xmath

The proofs of all the above finite field results, including Theorem
\thechapter .2 , take the same overall approach, sketched below.

###### Sketch of finite field sum-product proofs.

Given a set @xmath consider the set

  -- -------- --
     @xmath   
  -- -------- --

Note that if @xmath then

  -- -------- --
     @xmath   
  -- -------- --

since different pairs of elements from @xmath give different elements of
@xmath . Indeed if there were a solution to to

  -- -------- --
     @xmath   
  -- -------- --

with @xmath then rearranging would yield the contradiction

  -- -------- --
     @xmath   
  -- -------- --

Now, assume that @xmath . This is immediate if @xmath , and with a
little effort we may assume something very similar so long as @xmath .
Since @xmath contains no non-trivial additive subgroups, there must
exist

  -- -------- --
     @xmath   
  -- -------- --

such that

  -- -------- --
     @xmath   
  -- -------- --

Therefore

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Thus an iterated sumset of the product set @xmath must be large. With
some work, and analysing multiplicative energy rather than the product
set directly, it turns out that the only way this can happen is if
either @xmath is large itself or @xmath is large. ∎

As a final remark for this section, it is worth thinking about what a
reasonable sum-product conjecture might be for finite fields. Since the
conjecture in the real case is @xmath , it might be natural to suppose
that this should hold over @xmath whenever @xmath . After all, this
condition ensures there is no danger of the sumset or product set
filling up the whole field. However the following result of Bourgain [ 4
] , refined by Garaev [ 15 ] , shows that under this constraint the best
that can be hoped for is @xmath . To obtain @xmath will require @xmath
as a necessary condition.

###### Lemma \thechapter.3 (Bourgain, Garaev).

For any prime @xmath and any integer @xmath there is a set @xmath with
@xmath such that

  -- -------- --
     @xmath   
  -- -------- --

In particular there is a set @xmath with @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Let @xmath be a generator of @xmath . Let @xmath . By rearranging orders
of summation it is immediate that

  -- -- -------- --
        @xmath   
  -- -- -------- --

Therefore there exists @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

It is therefore possible to pick a set @xmath contained in the set on
the left hand side such that @xmath . Since @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

And since @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

So altogether,

  -- -------- --
     @xmath   
  -- -------- --

as required. ∎

As explained in the prologue, we are not too worried in this thesis
about the ‘large-set’ finite field paradigm, where sets are subject to a
minimum as well as a maximum density requirement. However it is worth
noting that under this regime, with @xmath , Garaev [ 15 ] obtained the
bound

  -- -------- --
     @xmath   
  -- -------- --

which is optimal in view of Lemma \thechapter .3 .

### 7 Expander functions

Expander functions are another example of growth, and a natural
variation on sum-products. An @xmath -variable expander function is a
function @xmath for which the set

  -- -------- --
     @xmath   
  -- -------- --

has cardinality at least @xmath for some @xmath and any @xmath , again
possibly satisfying some nondegeneracy conditions. Stronger expander
results correspond not only to a larger growth exponent @xmath as per
sum-product estimates, but also to a smaller number @xmath of variables.

Sum-product estimates give a trivial method of constructing
four-variable expander functions, because it is immediate that

  -- -------- --
     @xmath   
  -- -------- --

However it is often possible to do better, both in terms of fewer
variables and bigger exponents.

In the two-variable case, Elekes, Nathanson and Ruzsa [ 10 ] obtained
@xmath for the function

  -- -------- --
     @xmath   
  -- -------- --

whenever @xmath is a finite set of reals. This was subsequently extended
to @xmath by Li and Roche-Newton [ 32 ] , and was also considered by
Bourgain [ 4 ] in the prime finite field setting for an absolute @xmath
. The same paper of Bourgain also gives the example of the function

  -- -------- --
     @xmath   
  -- -------- --

which has the peculiar property of not even requiring @xmath and @xmath
to be drawn from the same set in order to establish a growth result.
Hart, Li and Shen [ 19 ] obtained @xmath over finite fields for the
function

  -- -------- --
     @xmath   
  -- -------- --

However, the strongest-known two-variable expander in the real, complex
and finite field setting is the function

  -- -------- --
     @xmath   
  -- -------- --

This function was first studied by Garaev and Shen [ 16 ] , and a new
result is established in Chapter \thechapter .

In the four-variable case, an expander follows from the recent
breakthrough of Guth and Katz [ 18 ] on the Erdös distinct distance
problem. They showed that a finite point-set @xmath determines at least
@xmath distinct pairwise distances. In the particular case @xmath this
shows that

  -- -------- --
     @xmath   
  -- -------- --

is a four-variable expander over @xmath with @xmath . This methodology
was also adapted by Iosevich, Roche-Newton and Rudnev [ 21 ] to show
that

  -- -------- --
     @xmath   
  -- -------- --

is likewise a four-variable expander with @xmath . New, stronger,
results on three and four-variable expanders over @xmath and @xmath are
proved in Chapter \thechapter .

## Chapter \thechapter A handbook on sumset calculus

This chapter comprises a useful arsenal of technical results for
analysing sumsets and product sets. Everything is stated in terms of
addition and sumsets, but extends without complication to multiplication
and product sets.

The basic tools of sumset calculus are the Plünnecke-Ruzsa inequalities,
which relate the cardinalities of different sumsets. These will be of
use in Chapters \thechapter , \thechapter and \thechapter .

Partial sumsets are a generalisation of sumsets, where interest is
restricted to sums determined by only a subset of possible pairs.
Balog-Szemerédi-Gowers type results reduce the study of partial sumsets
to that of complete sumsets, but at the price of reduced efficiency. Two
such results will come in handy in Chapters \thechapter and \thechapter
.

The additive and multiplicative energy of a set were briefly touched on
in Chapter \thechapter , but the treatment here is more developed.
Energy is useful for two reasons. First, sets with small sumset have
high energy, which is helpful to know when analysing their structure.
Second, energy-based arguments go through just as easily for partial as
complete sumsets, and so can in some cases be more efficient than a
Balog-Szemerédi-Gowers approach. This is useful in Chapters \thechapter
and \thechapter .

Energy considerations also have a particular application in covering
methods. When considering complete sumsets, these can sometimes more
efficient than the Plünnecke-Ruzsa inequalities. And since they are
energy-based, they apply equally well to complete and partial sumsets,
and so in some cases are stronger than Balog-Szemerédi-Gowers type
results. These will be useful in Chapter \thechapter .

Except for Lemma \thechapter .14 and Lemma \thechapter .15 , which are
original variations on covering lemmata, all of the mathematics in this
chapter is drawn from the literature. However it should be remarked that
the very useful Lemma \thechapter .4 does not seem to be widely known or
used in the research community.

### 8 Introduction

Chapter \thechapter defined the sumset @xmath and product set @xmath of
a subset @xmath of a field. This extends naturally to the sumset @xmath
and product set @xmath of two different sets @xmath , defined as

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

Define also the difference set

  -- -------- --
     @xmath   
  -- -------- --

and ratio set

  -- -------- --
     @xmath   
  -- -------- --

The essential problem of sumset calculus is that we are given a pair of
sets @xmath and another related pair @xmath . Given information about
the sum, difference, product or ratio set of @xmath and @xmath , what
can be said about that of @xmath and @xmath ?

The results in this chapter are general, in the sense that they depend
only on the fact that sets are finite and contained in an abelian group.
So they are quoted and proved for sumsets @xmath , taking @xmath to be
an abelian group operation rather than necessarily the additive group of
a field. They therefore extend to multiplication and product sets
without complication. In some instances it will be convenient to adopt
slightly different notation in the multiplicative case to avoid
confusion in later chapters; this will be indicated where appropriate.

### 9 The Plünnecke-Ruzsa inequalities

Information on sumsets is often expressed in terms of cardinalities.
There are trivial estimates

  -- -------- --
     @xmath   
  -- -------- --

Informally, a sumset set is ‘small’ if its cardinality is close to the
lower bound @xmath and ‘large’ if it is close to the upper bound @xmath
. The ‘efficiency’ of an estimate corresponds to the number of factors
of the form @xmath which turn up; the fewer the better since this allows
the proof of stronger theorems.

The most basic tool available for analysing sumset cardinalities is the
Ruzsa triangle inequality, which applies to difference sets but not
immediately to sumsets.

###### Lemma \thechapter.1 (Ruzsa triangle inequality).

For sets @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

For each element @xmath , pick @xmath and @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Consider the map @xmath from @xmath to @xmath given by

  -- -------- --
     @xmath   
  -- -------- --

We show that @xmath is an injection. Suppose that @xmath . Then

  -- -------- -------- -- ------
     @xmath   @xmath      (13)
     @xmath   @xmath      (14)
  -- -------- -------- -- ------

Subtracting ( 14 ) from ( 13 ) gives @xmath and so @xmath , which in
turn forces @xmath and @xmath . Plugging this back into ( 13 ) shows
that @xmath , and so @xmath Thus @xmath is an injection and

  -- -------- --
     @xmath   
  -- -------- --

Rearranging gives the required inequality. ∎

Note that the essential observation used in the above proof is that

  -- -------- --
     @xmath   
  -- -------- --

for any @xmath . Variations on this approach are used several more times
in the thesis, and are referred to as ‘Ruzsa-type’.

The Ruzsa triangle inequality is a simple and useful tool, but it
applies only to difference sets and it is often necessary to care about
general sum sets. This can be mitigated by clever applications, for
example in the case @xmath taking @xmath gives

  -- -------- --
     @xmath   
  -- -------- --

but this is not always terribly efficient. Moreover the Ruzsa triangle
inequality does not help very much when analysing iterated sumsets of
the form

  -- -------- --
     @xmath   
  -- -------- --

Such situations call for Plünnecke’s theorem, which was promulgated in
this context by Ruzsa [ 38 ] . A much shorter proof was recently given
by Petridis [ 36 ] , for which we follow an exposition given by Gowers [
17 ] .

###### Lemma \thechapter.2 (Plünnecke).

For sets @xmath there exists @xmath such that for any natural number
@xmath ,

  -- -------- -- ------
     @xmath      (15)
  -- -------- -- ------

In particular,

  -- -------- -- ------
     @xmath      (16)
  -- -------- -- ------

###### Proof.

Pick @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

is minimal across all subsets of @xmath . It suffices to prove that

  -- -------- -- ------
     @xmath      (17)
  -- -------- -- ------

since by minimality in the choice of @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

To establish ( 17 ) it suffices in turn to show that

  -- -------- -- ------
     @xmath      (18)
  -- -------- -- ------

for any set @xmath . Indeed, once ( 18 ) is established, inequality ( 17
) follows by induction on @xmath , since taking @xmath gives

  -- -------- --
     @xmath   
  -- -------- --

and by inductive hypothesis

  -- -------- --
     @xmath   
  -- -------- --

Now to prove ( 18 ). Induction is used here as well, this time on @xmath
. When @xmath it is immediate that @xmath for any set @xmath . In
particular,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

so ( 18 ) holds with equality by definition of @xmath . Now suppose that
@xmath and write

  -- -------- --
     @xmath   
  -- -------- --

so that by inductive hypothesis,

  -- -------- --
     @xmath   
  -- -------- --

By inclusion-exclusion,

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      
              @xmath      
                          (19)
  -- -------- -------- -- ------

On the other hand,

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      
              @xmath      (20)
  -- -------- -------- -- ------

and so subsituting ( 20 ) into ( 19 ) gives

  -- -------- --
     @xmath   
  -- -------- --

as required. ∎

Lemma \thechapter .2 is typically applied in the form ( 16 ) since this
omits mention of the subset @xmath . However Katz and Shen [ 29 ]
observed that with a little work it is possible to show that @xmath ,
which can in some circumstances make ( 15 ) a better bet.

###### Corollary \thechapter.3 (Katz, Shen).

For sets @xmath , there exists @xmath with @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

In situations where nothing is lost by passing to a constant-proportion
subset of @xmath , Corollary \thechapter .3 effectively implies that

  -- -------- --
     @xmath   
  -- -------- --

which is better than Lemma \thechapter .2 by a factor of @xmath .

###### Proof of Corollary \thechapter.3.

Let @xmath be any subset of @xmath with @xmath . By Lemma \thechapter .2
there exists @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Apply the above observation recursively. Begin by taking @xmath to find
@xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Now take @xmath to find @xmath disjoint from @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Repeat this process until reaching @xmath such that @xmath is of
cardinality at least @xmath . Let

  -- -------- --
     @xmath   
  -- -------- --

Since all of the @xmath are disjoint it follows that @xmath and

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

as required. ∎

### 10 Partial sumsets

For sets @xmath and @xmath , call the set

  -- -------- --
     @xmath   
  -- -------- --

a partial sumset . In the case where @xmath this collapses into the
sumset @xmath , referred to as the complete sumset where there is a
possibility for confusion. The motivation for using the letter @xmath is
that @xmath corresponds to (the edges of) a bipartite graph connecting
@xmath and @xmath .

Analysing partial sumsets is critical to the research in Chapters
\thechapter and \thechapter , but the Plünnecke-Ruzsa inequalities
developed above apply only to complete sumsets and so are not
immediately useful. Fortunately, it turns out that if @xmath is a
reasonably large part of @xmath and the partial sumset @xmath is small,
then there are large subsets of @xmath and @xmath whose complete sumset
is small as well. Results of this kind are called Balog-Szemerédi-Gowers
type or BSG-type after the standard theorem in this area, due to Balog
and Szemerédi and strengthened by Gowers ⁶ ⁶ 6 See Theorem 2.29 of [ 48
] for a formulation and proof of the Balog-Szemerédi-Gowers theorem.
Note however that the factor @xmath in equation (2.20) of that
formulation should be replaced with @xmath due to an error in the text.
.

Despite their usefulness, Balog-Szemerédi-Gowers type results are
disproportionately costly. This is in the sense that they yield upper
bounds on complete sumsets that are out of proportion to the density of
@xmath in @xmath , and in particular they pick up more than a constant
factor when @xmath . Sections 11 and 12 describe methods which do not
see this distinction and so can in some circumstances be more efficient.

This thesis uses two BSG-type results. The first result is more
efficient but is applicable only when @xmath is especially dense in
@xmath . It is a consequence of Exercise 2.5.4 in [ 48 ] .

###### Lemma \thechapter.4 (BSG-type for dense sets).

Let @xmath and let @xmath with @xmath . Then there exists @xmath with
@xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Lemma \thechapter .4 does not seem to be widely used in the literature.
But, where it is applicable, it is remarkably efficient for a BSG-type
result.

The second BSG-type result, due to Bourgain and Garaev [ 5 ] , is less
efficient but is on the other hand applicable in a wider variety of
situations.

###### Lemma \thechapter.5 (BSG-type for less-dense sets ).

For sets @xmath and @xmath there exists @xmath with @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

There is considerable overlap between the proofs of Lemma \thechapter .4
and Lemma \thechapter .5 . For both it is convenient to adopt the
following definitions.

For @xmath , write @xmath for the set of @xmath such that @xmath . Call
the cardinality of @xmath the @xmath -degree of @xmath , and the
cardinality of the intersection @xmath the joint @xmath -degree of
@xmath and @xmath .

For both results it suffices to find a large subset of @xmath with the
property that the joint @xmath -degree of any two distinct elements is
large. This is demonstrated by the following Ruzsa-type lemma.

###### Lemma \thechapter.6.

Let @xmath . Suppose that @xmath and @xmath are such that every the
joint @xmath -degree of any @xmath is at least @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

In particular, if the joint @xmath -degree of any pair of elements from
@xmath is at least @xmath then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

For each @xmath pick @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be given by

  -- -------- --
     @xmath   
  -- -------- --

By hypothesis,

  -- -------- --
     @xmath   
  -- -------- --

On the other hand, the injection

  -- -------- --
     @xmath   
  -- -------- --

from @xmath into @xmath shows that

  -- -------- --
     @xmath   
  -- -------- --

Comparing the upper and lower bounds on @xmath gives the result. ∎

The ease of finding sets satisfying the conditions of Lemma \thechapter
.6 depends on the density of @xmath , corresponding to the two different
BSG-type results. Over the next few pages, Section 10.1 builds the proof
of Lemma \thechapter .4 and Section 10.2 builds the proof of Lemma
\thechapter .5 .

#### 10.1 High-density partial sumsets

This section proves Lemma \thechapter .4 , the BSG-type result for
high-density partial sumsets. In view of Lemma \thechapter .6 this is
accomplished by the following.

###### Lemma \thechapter.7.

Let @xmath and @xmath with @xmath . There exists @xmath with @xmath such
that the @xmath -degree of every @xmath is at least @xmath .

In particular, any two elements of @xmath have joint @xmath -degree at
least @xmath whenever @xmath .

Applying Lemma \thechapter .6 to the conclusion of Lemma \thechapter .7
with @xmath and @xmath immediately yields the statement of Lemma
\thechapter .4 .

###### Proof of Lemma \thechapter.7.

Let @xmath be the set of @xmath with @xmath -degree at least @xmath . It
suffices to show that @xmath . To this end, observe that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

It follows that

  -- -------- --
     @xmath   
  -- -------- --

and so @xmath as required. ∎

#### 10.2 Less-dense partial sumsets

This section proves Lemma \thechapter .5 , the BSG-type result for
less-dense partial sumsets. The proof is not quite as direct as that for
Lemma \thechapter .4 , and the main additional ingredient is the
following lemma.

###### Lemma \thechapter.8.

Let @xmath . Then for any @xmath there exists @xmath with @xmath , and
@xmath with @xmath , such that the joint @xmath -degree of any @xmath is
at least @xmath .

###### Proof.

Let @xmath be the set of @xmath with joint @xmath -degree at least
@xmath . To prove the lemma it suffices to find @xmath with @xmath such
that

  -- -------- --
     @xmath   
  -- -------- --

It is clear that

  -- -------- --
     @xmath   
  -- -------- --

and hence

  -- -- -- ------
           (21)
  -- -- -- ------

Also, @xmath and so by Cauchy-Schwarz

  -- -------- -- ------
     @xmath      (22)
  -- -------- -- ------

Comparing ( 21 ) and ( 22 ) shows that

  -- -------- --
     @xmath   
  -- -------- --

Rearranging gives

  -- -------- --
     @xmath   
  -- -------- --

So there exists @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Evaluating the left hand side shows

  -- -------- --
     @xmath   
  -- -------- --

Since the left hand side is at most @xmath it follows that @xmath . Take
@xmath so that

  -- -------- --
     @xmath   
  -- -------- --

This implies @xmath as required. ∎

With this established, it is now possible to prove Lemma \thechapter .5
.

###### Proof of Lemma \thechapter.5.

Let @xmath be sufficiently small, and fixed. By Lemma \thechapter .8
there exists @xmath and @xmath with @xmath and @xmath , such that any
@xmath have joint @xmath -degree at least @xmath . Lemma \thechapter .6
implies

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .7 there is a subset @xmath with @xmath such that
any two @xmath have joint @xmath -degree at least @xmath . A final
application of Lemma \thechapter .6 shows that

  -- -------- -------- --
     @xmath   @xmath   
  -- -------- -------- --

as required. ∎

### 11 Additive energy

Define the additive energy @xmath of set @xmath and @xmath to be the
number of solutions to the equation

  -- -------- -- ------
     @xmath      (23)
  -- -------- -- ------

with @xmath and @xmath . Note that

  -- -------- --
     @xmath   
  -- -------- --

since ( 23 ) holds if and only if @xmath . Define the additive energy of
a single set @xmath to be

  -- -------- --
     @xmath   
  -- -------- --

When working with the multiplicative group of a field, we refer instead
to multiplicative energy , denoted by @xmath , i.e. the number of
solutions to @xmath with @xmath and @xmath .

Energy and sumsets are closely related, since the only way in which
@xmath can be small is if there are many pairs of elements giving the
same sums. This would necessitate many solutions to ( 23 ) and thus a
large energy. This intuition will shortly be made rigorous, but in order
to do so it is first necessary to generalise and slightly reformulate
energy.

Just like generalising sumsets to partial sumsets, given @xmath it is
natural to consider the number of solutions to ( 23 ) with @xmath . This
restriction is called the additive energy of @xmath and denoted by
@xmath . As with partial sumsets, this collapses to the definition of
@xmath when @xmath .

The following lemma shows that additive energy can be helpfully
formulated as an @xmath norm.

###### Lemma \thechapter.9 (Reformulation of additive energy).

For @xmath , let @xmath denote the number of @xmath with @xmath . Then

  -- -------- -------- -- ------
     @xmath   @xmath      (24)
              @xmath      (25)
  -- -------- -------- -- ------

###### Proof.

It is clear that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

which establishes ( 24 ). Similarly,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

which gives ( 25 ). ∎

When @xmath we have @xmath and the following corollary.

###### Corollary \thechapter.10.

For sets @xmath we have

  -- -------- -------- -- ------
     @xmath   @xmath      (26)
              @xmath      (27)
              @xmath      (28)
  -- -------- -------- -- ------

###### Proof.

Equations ( 26 ) and ( 27 ) follow immediately from Lemma \thechapter .9
and the fact that @xmath when @xmath . Equation ( 28 ) follows by
rearranging orders of summation from ( 27 ).

∎

Now let’s make rigorous the earlier discussion of the relationship
between energy and sumsets. The following estimates are trivial.

  -- -------- --
     @xmath   
  -- -------- --

Energy close to @xmath is ‘low’ and that close to @xmath is ‘high’. The
following result shows that, as expected, small sumset implies high
energy. This can be useful to know when analysing the structure of sets
with small sumset.

###### Lemma \thechapter.11.

If @xmath then

  -- -------- --
     @xmath   
  -- -------- --

Note that in this lemma, partial and complete sumsets are on the same
footing: unlike BSG-type results there is no additional premium to pay
for working with partial sumsets.

###### Proof of Lemma \thechapter.11.

It is clear that

  -- -------- --
     @xmath   
  -- -------- --

So by Cauchy-Schwarz,

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .9 the right-hand side is equal to @xmath and so

  -- -------- --
     @xmath   
  -- -------- --

which completes the proof. ∎

The converse to Lemma \thechapter .11 is false: high energy does not
automatically imply small sumset. For example if @xmath is the union of
an arithmetic progression @xmath and a geometric progression @xmath ,
each of cardinality @xmath , then @xmath is high-energy since

  -- -------- --
     @xmath   
  -- -------- --

However the sumset @xmath is also large since

  -- -------- --
     @xmath   
  -- -------- --

What does hold, however, is the following partial converse. If a set has
high energy then there must exist a fairly large @xmath for which the
partial sumset @xmath is small. This fact will not be required in the
thesis and so precise details are omitted.

### 12 Covering methods

A covering lemma is a result of the following form. If @xmath and @xmath
have small sumset then a large part of @xmath can be ‘covered by’
(contained in the union of) a small number of translates of @xmath or
some modification of @xmath . The canonical example is due to Ruzsa, for
which a proof can be found in [ 48 ] :

###### Lemma \thechapter.12 (Ruzsa).

For any sets @xmath , the set @xmath is contained in the union of @xmath
translates of @xmath

Another more recent example is due to Shen [ 40 ] . In a similar spirit
to the improvement of Lemma \thechapter .3 over Lemma \thechapter .2 ,
this enables a covering with translates of @xmath instead of @xmath , at
the expense of leaving a small part of @xmath uncovered.

###### Lemma \thechapter.13 (Shen).

For sets @xmath and @xmath there exists @xmath with @xmath such that
@xmath is contained in the union of @xmath translates of @xmath .

The proof of Shen’s covering result is based on additive energy, and so
with some tweaks applies to the situation where only a dense partial
sumset, rather than a complete sumset, is small. In certain situations,
such as in Chapter \thechapter , this can be a more-efficient substitute
for Balog-Szemerédi-Gowers type methods, since there is no additional
cost for dealing with partial rather than complete sumsets.

Two original variations on this theme are used in Chapter \thechapter .
The first, below, essentially restates Shen’s result with @xmath
replaced by @xmath .

###### Lemma \thechapter.14 (Shen variation 1).

Let @xmath and @xmath . If @xmath then there exists @xmath with @xmath
such that @xmath is contained in the union of @xmath translates of
@xmath .

Similarly, there is a subset @xmath with @xmath such that @xmath in
contained in the union of @xmath translates of @xmath .

###### Proof.

We shall prove the case for covering with translates of @xmath , and
remark on the slight alteration needed to cover with translates of
@xmath .

Since @xmath there is by Lemma \thechapter .7 a subset @xmath with
@xmath such that every element of @xmath has @xmath -degree at least
@xmath .

Now for any subset @xmath let @xmath so that

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .11 it follows that

  -- -------- --
     @xmath   
  -- -------- --

By Corollary \thechapter .10 ,

  -- -------- -- ------
     @xmath      (29)
  -- -------- -- ------

and so for any @xmath there exist @xmath , @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Apply the above discussion to a sequence of subsets of @xmath . Begin by
taking @xmath to find @xmath , @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

The translate @xmath covers @xmath elements of @xmath . Discard @xmath
from @xmath and let @xmath be the set of elements remaining, now taking
@xmath and repeating the process.

Iterate @xmath times until the set remaining is of cardinality no more
than @xmath . Then take @xmath to be the set of elements discarded
across all iterations, so that @xmath . Since @xmath we get @xmath as
required, which completes the proof for covering with translates of
@xmath .

The proof for covering with translates of @xmath is identical, except
that in place of ( 29 ), the identity

  -- -------- --
     @xmath   
  -- -------- --

is used instead. ∎

The second original variation on Shen’s result has a slightly different
formulation. Instead of covering a large part of @xmath with translates
of @xmath , it yields a large part of @xmath whose corresponding partial
difference set is covered by few translates of @xmath .

###### Lemma \thechapter.15 (Shen variation 2).

Let @xmath and @xmath . Then there exists @xmath with @xmath such that
@xmath is contained in the union of @xmath translates of @xmath .

###### Proof.

Let @xmath be any subset of @xmath . By Lemma \thechapter .11 there are
at least @xmath solutions to

  -- -------- --
     @xmath   
  -- -------- --

with @xmath . So there exists @xmath for which there are at least @xmath
pairs @xmath with

  -- -------- --
     @xmath   
  -- -------- --

In other words, the translate @xmath accounts for the differences of
@xmath pairs from @xmath .

Apply the above discussion to a sequence of subsets of @xmath . Begin by
taking @xmath to find a translate of @xmath accounting for the
differences of @xmath pairs from @xmath . Discard these pairs from
@xmath and let @xmath be the set of pairs remaining, now taking @xmath
and repeating the process.

Iterate @xmath times until the subset of @xmath remaining is of
cardinality no more than @xmath . Then take @xmath to be the set of
discarded pairs, so that @xmath , and @xmath is contained in no more
than @xmath translates of @xmath , as required. ∎

## Chapter \thechapter Incidence theorems over finite fields

Chapter \thechapter introduced incidence geometry but deferred
discussion of the finite field case. This chapter now picks up that
baton.

The state of the art for incidences is weaker over finite fields than
@xmath and @xmath , and the discrepancy is much greater than the
analogous gap for growth results. This chapter narrows that divide with
two new theorems: an incidence bound and a line-counting result.

An earlier version of this work has been submitted to the European
Journal of Combinatorics. A preprint [ 23 ] , and a more recent update [
24 ] also used here, are available on the arXiv.

### 13 Results

This section describes the two results proved in this chapter.

#### 13.1 Incidence bounds

Chapter \thechapter showed that in the ‘critical’ case @xmath ,
non-trivial incidence bounds are of the form

  -- -------- --
     @xmath   
  -- -------- --

for @xmath . The Szemerédi-Trotter theorem (Theorem \thechapter .3 )
gives the sharp result @xmath in @xmath and generalises to the complex
setting @xmath (Theorem \thechapter .14 ).

Chapter \thechapter noted that any nontrivial results on growth in
finite fields must be predicated on keeping away from subfields. The
same is true for incidence bounds, but this time one must keep away from
subplanes. Just like growth, to keep these considerations as
straightforward as possible it is often convenient to work with the
field @xmath of prime order @xmath .

To see why avoiding subplanes is necessary, consider the example where
@xmath is the whole plane @xmath and @xmath is the set of all lines in
@xmath . Taking @xmath gives @xmath , but since every line in @xmath is
incident to @xmath points in @xmath it follows that @xmath and so in
this case a non-trivial estimate is impossible.

Working over @xmath , Bourgain, Katz and Tao [ 6 ] proved the existence
of a non-trivial @xmath , dependent on @xmath , whenever @xmath . This
has been made explicit in two cases:

-   In the ‘small-set’ regime @xmath , Helfgott and Rudnev [ 20 ]
    obtained a bound of @xmath .

-   In the ‘large-set’ regime @xmath , Vinh [ 50 ] obtained @xmath .

For the purposes of this thesis, where as explained in the prologue the
emphasis is on small rather than large sets, the Helfgott-Rudnev bound
is the one to beat.

It is instructive to compare with the situation for growth and
sum-products. With sum-products there is a growth exponent of @xmath
over @xmath and @xmath , and @xmath over finite fields, which is a bit
weaker but not excessively so. By contrast the finite field incidence
bound of @xmath is an awfully long way from the real and complex bound
of @xmath implied by Szemerédi-Trotter.

The first new result in this chapter goes some way to redressing this
disparity by obtaining a much stronger finite field incidence bound of
@xmath .

###### Theorem \thechapter.1.

Let @xmath . If @xmath and @xmath are a set of points and lines over
@xmath with @xmath then

  -- -------- --
     @xmath   
  -- -------- --

#### 13.2 Line counting

Beck’s theorem from Chapter \thechapter shows that any set of points in
@xmath satisfies at least one of two extremes. Either there are at least
@xmath collinear points, or the set @xmath of lines determined by pairs
of points in @xmath is of cardinality at least @xmath .

As with incidence bounds, a nondegeneracy condition is required for
Beck-type theorems over finite fields. For example if @xmath then no
more than @xmath points are collinear, and so the first possible
conclusion of Beck’s theorem cannot hold. But the second cannot hold
either since @xmath .

As with incidence bounds, there have been explicit finite field versions
of Beck’s theorem in two instances:

-   In the particular case of the ‘small-set’ regime @xmath for which
    @xmath with @xmath , Helfgott and Rudnev [ 20 ] showed that @xmath .

-   In the ‘large-set’ regime, Iosevich, Rudnev and Zhai [ 22 ] recently
    showed that @xmath whenever @xmath .

The ‘small-set’ Helfgott-Rudnev result is again, for the purposes of
this thesis, the one to beat. The second new result in this chapter does
so in two respects. First, there is a stronger exponent of @xmath in
place of @xmath . Second, the result holds for general @xmath with
@xmath rather than simply those of the form @xmath .

###### Theorem \thechapter.2.

If @xmath and @xmath then at least one of the following must occur:

1.   At least @xmath points from @xmath are contained in a single line.

2.  @xmath .

#### 13.3 Structure

The body of this chapter is concerned with the proofs of Theorems
\thechapter .1 and \thechapter .2 . Both follow from new observations
that efficiently relate incidences to sum-product estimates.

Unlike the incidence material in Chapter \thechapter , the analysis here
makes crucial use of the properties of the projective plane. Section 14
uses this to show that the existence of a certain configuration of
points and lines would imply the existence of sets @xmath and fairly
dense @xmath such that the difference set @xmath and the ratio set
@xmath are both small. Such a configuration is called a ‘sum-product
configuration’.

Section 15 goes on to show that if there are too many points incident to
too many lines, which would arise if either Theorem \thechapter .1 or
Theorem \thechapter .2 were to fail, then there must also exist a large
sum-product configuration.

The situation is then almost ripe for applying a finite field
sum-product theorem from Chapter \thechapter to show that a sum-product
configuration cannot arise, and so there cannot be too many incidences.
The final hurdle is to relate the partial difference and ratio sets
arising from a sum-product configuration to complete sets. This is
accomplished in Section 16 using a concoction of Balog-Szemerédi-Gowers
type results from Chapter \thechapter .

Section 17 then uses the analysis from the previous sections to prove
Theorems \thechapter .1 and \thechapter .2 .

Section 18 gives pointers for further work.

### 14 Foci and configurations

This section uses the theory of projective transformations to interpret
particular types of point-line configurations in terms of sum-product
(or strictly speaking, difference-ratio) estimates. The key observation
is that difference and ratio sets can be interpreted in terms of
gradients, and that a projective transformation enables these to be
viewed as point-line incidences.

There are several pictures of points and lines in this section,
apparently treating them as if in @xmath . These are for illustration
only; they do not correspond rigorously to the plane @xmath , although
the definitions they illustrate do.

Let @xmath be any field. Recall, or quickly check Appendix \thechapter ,
that the projective plane @xmath is given by equivalence classes of
@xmath modulo dilation. More concretely, it can be viewed as the union
of @xmath with a ‘line at infinity’ @xmath . Points of @xmath correspond
to gradients in @xmath , so that for each @xmath there is a point @xmath
that is incident to all lines of gradient @xmath .

Recall also some theory on projective transformations of @xmath . These
are line-preserving permutations of @xmath . A frame in @xmath is a set
of four distinct points, no three of which are collinear. For any two
frames there is a unique projective transformation that maps one to the
other.

Now for some new definitions. If @xmath is a set of points in @xmath and
@xmath is an individual point then say that @xmath is a @xmath -focus
for @xmath if @xmath is supported over at most @xmath lines through
@xmath . This is illustrated in Figure 4 where the red point is a
3-focus for the blue points. Note that if @xmath is a @xmath -focus for
@xmath then it is also a @xmath -focus for any subset of @xmath .

We also give a highly suggestive name to a particular configuration of
points and foci. Let @xmath be a point set and @xmath be distinct
points. Say that @xmath and the @xmath form a @xmath -sum-product
configuration if

1.  Each @xmath is a @xmath -focus for @xmath .

2.  There is a line, which we call the base line , incident to @xmath
    and @xmath but not @xmath .

3.  No point in @xmath is incident to the base line.

Figure 5 illustrates sum-product configurations with (a) the base line
in general position and (b) the base line at infinity. The red, black,
green and yellow points are the foci @xmath and the blue points are the
elements of @xmath .

The following lemma justifies the choice of definition by showing that a
sum-product configuration does indeed correspond to a (partial) sumset
and product set.

###### Lemma \thechapter.3.

Let @xmath be a field. Suppose @xmath is a set of points in @xmath , and
that it forms a @xmath -sum-product configuration with points @xmath .
Then there exist sets @xmath and @xmath with

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

There is a projective transformation mapping any frame (four points, no
three of which are collinear) to any other frame, and so certainly there
is one mapping any non-collinear triple to any other. Since @xmath and
@xmath are not collinear, and nor are @xmath , it is possible to pick a
projective transformation @xmath such that

-   @xmath is sent to the origin @xmath of @xmath .

-   @xmath is sent to @xmath .

-   @xmath is sent to @xmath .

Since @xmath preserves linearity and sends @xmath and @xmath , which are
incident to the base line, to points on @xmath , it in fact sends the
whole base line to @xmath .

Let @xmath . This is contained in @xmath since none of the points in
@xmath are incident to the base line and so none are mapped into @xmath
.

The set @xmath is supported over @xmath ‘vertical’ lines ⁷ ⁷ 7 that is,
lines of the form @xmath for some @xmath and @xmath ‘horizontal’ lines ⁸
⁸ 8 that is, lines of the form @xmath for some @xmath , since lines
incident to @xmath are all vertical and those incident to @xmath are all
horizontal. Let @xmath be the set of @xmath -intercepts of the vertical
lines and @xmath be the set of @xmath -intercepts of the horizontal
lines, so that

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

These correspond to the yellow and black lines respectively in Figure 5
.

Furthermore, @xmath is supported over @xmath lines through the origin.
These are identified by their gradient, and a point @xmath is incident
to the line with gradient @xmath if and only if @xmath . Thus each
element of @xmath corresponds to a different line through the origin,
i.e. a red line in Figure 5 , and so

  -- -------- --
     @xmath   
  -- -------- --

Finally, @xmath is supported over @xmath lines through @xmath . Since
@xmath preserves linearity and sends the base line, which is incident to
@xmath , to @xmath we know that @xmath . So all lines incident to @xmath
have the same gradient, say @xmath . These are identified by the
intercept with the @xmath -axis, and a point @xmath is incident to the
line with intercept @xmath if and only if @xmath . Thus each element of
@xmath corresponds to a different line of gradient @xmath , i.e. a green
line in Figure 5 . Therefore

  -- -------- --
     @xmath   
  -- -------- --

Now let @xmath and @xmath to obtain

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

∎

### 15 How to find foci

Section 14 shows that a sum-product configuration of points and foci
corresponds to an upper bound on partial sum-products. This section
shows that such a configuration must arise whenever there are many
point-line incidences. The main result is the following lemma.

###### Lemma \thechapter.4 (Finding a sum-product configuration).

Let @xmath and @xmath be a set of points and lines respectively in a
plane such that every point in @xmath is incident to @xmath lines in
@xmath . Suppose that @xmath , and that each line in @xmath is incident
to at most

  -- -------- --
     @xmath   
  -- -------- --

points in @xmath .

Then there exists a subset of @xmath of cardinality @xmath , and points
@xmath with which it forms a @xmath -sum-product configuration.

It will be helpful when proving Lemma \thechapter .4 to adopt some
additional notation. For points @xmath in the plane, let @xmath be the
line determined by @xmath and @xmath . Given a set @xmath of points and
a set @xmath of lines, both satisfying the conditions of Lemma
\thechapter .4 , and a single point @xmath , define

  -- -------- --
     @xmath   
  -- -------- --

so that @xmath is the set of points in @xmath incident to lines in
@xmath going through @xmath . Thus @xmath has @xmath as an @xmath
-focus, since every point in @xmath is incident to @xmath lines in
@xmath .

As a first step, it is convenient to record the following standard
result.

###### Lemma \thechapter.5 (Rich points and lines).

Let @xmath be the set of points in @xmath incident to at least @xmath
lines in @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

Similarly, if @xmath is the set of lines in @xmath incident to at least
@xmath points in @xmath then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We prove the result for points, leaving that for lines as an exercise.
Let @xmath be the set of points in @xmath incident to at most @xmath
lines in @xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
  -- -------- -------- --

Since

  -- -------- --
     @xmath   
  -- -------- --

it follows that

  -- -------- --
     @xmath   
  -- -------- --

as required. ∎

Armed with Lemma \thechapter .5 we now build incrementally towards Lemma
\thechapter .4 . We shall show how to find individual foci, and
simultaneous pairs of foci, before finding four arranged in a
sum-product configuration. The initial results on finding singleton or
paired foci are adjustments of similar methods used in the proofs of
Bourgain-Katz-Tao [ 6 ] and Helfgott-Rudnev [ 20 ] ; they are applied in
the proof of the more developed Lemma \thechapter .4 .

The following result enables us find individual foci.

###### Lemma \thechapter.6 (Finding individual foci).

Let @xmath be a set of points and @xmath a set of lines, such that every
point is incident to @xmath lines in @xmath . Then there exists @xmath
with @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

for each @xmath .

###### Proof.

Since every point in @xmath is incident to @xmath lines in @xmath it is
immediate that

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be the set of lines in @xmath incident to @xmath points in
@xmath so that by Lemma \thechapter .5 , it follows that

  -- -------- --
     @xmath   
  -- -------- --

Now let @xmath be the set of points in @xmath incident to @xmath lines
in @xmath . By Lemma \thechapter .5 again,

  -- -------- -- ------
     @xmath      (30)
  -- -------- -- ------

Since @xmath and @xmath , each point in @xmath is incident to at most
@xmath lines in @xmath and so

  -- -------- -- ------
     @xmath      (31)
  -- -------- -- ------

Comparing ( 30 ) and ( 31 ) shows that that @xmath , implying that
@xmath since @xmath is a subset of @xmath .

Now, each @xmath is incident to @xmath lines in @xmath , and each of
these lines is incident to @xmath points in @xmath . So

  -- -------- --
     @xmath   
  -- -------- --

for each @xmath , as required. ∎

The following result now takes the ability to find singleton foci, and
uses it to find them in simultaneous pairs.

###### Lemma \thechapter.7 (Finding paired foci).

Let @xmath and @xmath be a set of points and lines respectively in a
plane such that every point in @xmath is incident to @xmath lines in
@xmath . Then there exist @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

By Lemma \thechapter .6 there exists @xmath with @xmath such that @xmath
for each @xmath . In particular there is a point @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Applying Lemma \thechapter .6 again, this time to @xmath and @xmath ,
there is a point @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

as required. ∎

Now with the ability to find foci both one and two at a time, it is time
for a proof of Lemma \thechapter .4

###### Proof of Lemma \thechapter.4.

It suffices to find @xmath with

  -- -------- --
     @xmath   
  -- -------- --

such that @xmath and @xmath are collinear along a line in @xmath that is
not incident to @xmath . There will then exist an @xmath -sum-product
configuration of appropriate size since:

-   Each @xmath is incident to @xmath lines in @xmath , and so is an
    @xmath -focus for @xmath . This means that the first condition in
    the definition of an @xmath -sum-product configuration is satisfied
    for any subset of @xmath .

-   The second condition of a sum-product configuration is clearly
    satisfied by virtue of the arrangement of @xmath .

-   No line in @xmath is incident to more than @xmath points in @xmath ,
    and so @xmath contains a subset of cardinality @xmath for which the
    third condition of an @xmath -sum-product configuration is
    satisfied.

Observe first that by Lemma \thechapter .7 there exist points @xmath
such that

  -- -------- -- ------
     @xmath      (32)
  -- -------- -- ------

For convenience, define

  -- -------- -- ------
     @xmath      (33)
  -- -------- -- ------

The proof will be complete if we can find distinct @xmath collinear with
@xmath along a line in @xmath that is not incident to @xmath such that

  -- -------- -- ------
     @xmath      (34)
  -- -------- -- ------

Now since @xmath , every point in @xmath is incident to @xmath lines in
@xmath . So by Lemma \thechapter .6 there exists @xmath with @xmath such
that

  -- -------- -- ------
     @xmath      (35)
  -- -------- -- ------

for each @xmath .

Since @xmath is an @xmath -focus for @xmath , and @xmath , it follows
that @xmath is an @xmath -focus for @xmath as well. Let @xmath be the
set of @xmath lines through @xmath supporting @xmath , so that

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be the set of @xmath incident to at least @xmath points in
@xmath . Observe that @xmath . Indeed, Lemma \thechapter .5 implies

  -- -------- -- ------
     @xmath      (36)
  -- -------- -- ------

But since @xmath and @xmath , and it is a hypothesis that each line in
@xmath is incident to at most

  -- -------- --
     @xmath   
  -- -------- --

points in @xmath , it follows that each line in @xmath is incident to at
most @xmath points in @xmath . Hence

  -- -------- -- ------
     @xmath      (37)
  -- -------- -- ------

Comparing ( 36 ) and ( 37 ) gives @xmath . So by appropriate choice of
constants in the statement of the theorem @xmath as claimed.

Since there are at least two lines in @xmath , and they are all incident
to @xmath , at least one of them is not incident to @xmath . Fix this
line @xmath , which will be the base line of the sum-product
configuration. Since @xmath is incident to @xmath but not @xmath , it
suffices to establish that ( 34 ) holds for some distinct @xmath .

Because @xmath we have

  -- -------- -- ------
     @xmath      (38)
  -- -------- -- ------

From ( 35 ) it follows that

  -- -------- -- ------
     @xmath      (39)
  -- -------- -- ------

On the other hand, by Cauchy-Schwarz,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

If the first summation on the right were to dominate then it would mean

  -- -------- --
     @xmath   
  -- -------- --

Comparing with ( 39 ) and applying ( 38 ) would then yield @xmath . By (
32 ) and ( 33 ), this would mean @xmath , and so by an appropriate
choice of constant contradict the hypothesis @xmath .

Thus the second summation on the right dominates instead and so by ( 39
),

  -- -------- --
     @xmath   
  -- -------- --

Hence there exist distinct @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

as required. ∎

### 16 Bounding partial sum-products

Between them, Section 14 and Section 15 show that the existence of too
many incidences implies the existence of @xmath and a large @xmath for
which the partial difference and ratio sets @xmath and @xmath are both
small relative to @xmath and @xmath .

This offends our sum-product sensibilities, since Chapter \thechapter
showed that one or other of a product set or sumset must always be
large. However those results were concerned with complete sumsets and
product sets, whereas here only partial sum-products are controlled.
Fortunately, Chapter \thechapter has tools designed for this kind of
situation, in the form of Balog-Szemerédi-Gowers type results that allow
passage from partial to complete sets.

The main results in this section are the following ‘partial sum-product’
results for @xmath . They will be proved using a combination of BSG-type
results and Rudnev’s finite field sum-product estimate Theorem
\thechapter .2 .

###### Lemma \thechapter.8 (Partial sum-products in @xmath, v1).

Let @xmath and @xmath . If @xmath then

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma \thechapter.9 (Partial sum-products in @xmath, v2).

Let @xmath and @xmath . If @xmath then

  -- -------- --
     @xmath   
  -- -------- --

Because sumsets and product sets are being analysed simultaneously, care
is required when using Balog-Szemerédi-Gowers type results to prove
these lemmata. Results from Chapter \thechapter yield the following
preliminary result, which captures all the additive and multiplicative
properties that need to be controlled.

###### Lemma \thechapter.10 (BSG-type for sum-products).

If @xmath and @xmath then there exists @xmath with @xmath such that

1.  @xmath

2.  @xmath

3.  @xmath .

###### Proof.

Let @xmath be sufficiently small. By Lemma \thechapter .8 there exist
@xmath and @xmath with

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

such that every pair @xmath has joint @xmath -degree at least @xmath .
By Lemma \thechapter .6 , applied once additively and once
multiplicatively,

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

Apply Lemma \thechapter .4 once additively and once multiplicatively to
obtain @xmath with

  -- -------- --
     @xmath   
  -- -------- --

such that

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

Let @xmath . By the cardinalities of @xmath and @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

That @xmath satisfies properties 1 and 2 is immediate from the above
difference and ratio set estimates. To show that property 3 is also
satisfied, let

  -- -------- --
     @xmath   
  -- -------- --

Since both @xmath and @xmath are of cardinality at least @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

and so

  -- -------- --
     @xmath   
  -- -------- --

which completes the proof. ∎

We can now prove Lemma \thechapter .8 and Lemma \thechapter .9 .

###### Proof of Lemma \thechapter.8..

Apply Lemma \thechapter .10 to obtain @xmath with @xmath such that

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

Since @xmath , the set @xmath is of cardinality at most @xmath as well,
and the sum-product estimate Theorem \thechapter .2 can be applied to
obtain

  -- -------- --
     @xmath   
  -- -------- --

Rearranging gives

  -- -------- --
     @xmath   
  -- -------- --

and so

  -- -------- --
     @xmath   
  -- -------- --

as required. ∎

###### Proof of Lemma \thechapter.9..

Apply Lemma \thechapter .10 to obtain @xmath with @xmath such that

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

Unlike in the proof of Lemma \thechapter .8 , where multiplicative
energy was involved, these properties are preserved when passing to
subsets of @xmath and so we may assume that @xmath . Since @xmath the
set @xmath is then of cardinality at most @xmath and so Theorem
\thechapter .2 can be applied to obtain

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Rearranging gives

  -- -------- --
     @xmath   
  -- -------- --

as required. ∎

### 17 Proving Theorems \thechapter.1 and \thechapter.2

This section uses the analysis from Sections 14 , 15 and 16 to give
proofs of Theorems \thechapter .1 and \thechapter .2 .

###### Proof of Theorem \thechapter.1..

Suppose that @xmath . The aim is to show that @xmath .

First, a standard argument enables overly rich lines to be discarded.
Let @xmath be the set of lines in @xmath incident to at most @xmath
points in @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

since if @xmath is the set of lines in @xmath incident to at least
@xmath points in @xmath then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

and so by an appropriate choice of constant @xmath .

By a dyadic pigeonholing there is a subset @xmath and an integer @xmath
with

  -- -------- -- ------
     @xmath      (40)
  -- -------- -- ------

such that every point in @xmath is incident to @xmath lines in @xmath .
Note moreover that

  -- -------- -- ------
     @xmath      (41)
  -- -------- -- ------

since @xmath . Applying Lemma \thechapter .4 to @xmath and @xmath , at
least one of the following is true:

1.  @xmath .

2.  There is a line in @xmath incident to at least @xmath points in
    @xmath .

3.  There is a line in @xmath incident to at least @xmath points in
    @xmath .

4.  There exists @xmath with @xmath and points @xmath in an @xmath
    -sum-product configuration.

The first three cases are quickly dispensed with. For the first,
applying ( 40 ) and then ( 41 ) yields @xmath , which is far better than
required. For the second, since every line in @xmath is incident to at
most @xmath points in @xmath , it follows that @xmath as well. The third
case is like the second, but this time yields @xmath .

The fourth case remains, and is the core of the argument. Apply Lemma
\thechapter .3 to @xmath to obtain @xmath with

  -- -------- --
     @xmath   
  -- -------- --

and @xmath with

  -- -------- --
     @xmath   
  -- -------- --

such that

  -- -------- -- ------
     @xmath      (42)
  -- -------- -- ------

Note that either @xmath or @xmath since if

  -- -------- --
     @xmath   
  -- -------- --

then @xmath which contradicts the fact that @xmath .

If @xmath then @xmath and an application of Lemma \thechapter .8 gives

  -- -------- --
     @xmath   
  -- -------- --

which implies by the cardinality of @xmath that

  -- -------- --
     @xmath   
  -- -------- --

Applying ( 40 ), ( 41 ) and the fact that @xmath gives after rearranging

  -- -------- --
     @xmath   
  -- -------- --

which implies @xmath as required.

On the other hand, suppose that @xmath . Assume also that @xmath since
otherwise we are done by the previous paragraph. Note that with a fixed
@xmath , the bounds in ( 42 ) are not affected by passing to supersets
of @xmath or @xmath . So assume @xmath and thus

  -- -------- --
     @xmath   
  -- -------- --

Hence Lemma \thechapter .9 is applicable, giving

  -- -------- --
     @xmath   
  -- -------- --

and therefore

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath and @xmath this means

  -- -------- --
     @xmath   
  -- -------- --

By ( 40 ) it falls out that @xmath , which is far better than required.
∎

###### Proof of Theorem \thechapter.2..

For @xmath , write @xmath for the number of points in @xmath incident to
@xmath . It is clear, as per the proof of Beck’s theorem in Chapter
\thechapter that

  -- -------- --
     @xmath   
  -- -------- --

By a dyadic pigeonholing there exists @xmath and an integer @xmath such
that @xmath for all @xmath and

  -- -------- -- ------
     @xmath      (43)
  -- -------- -- ------

To prove the theorem it suffices to show that either

  -- -------- --
     @xmath   
  -- -------- --

in which case there are @xmath collinear points, or

  -- -------- --
     @xmath   
  -- -------- --

in which case @xmath and so @xmath as required.

Note that @xmath . So by another dyadic pigeonholing there exists @xmath
and an integer @xmath such that every point in @xmath is incident to
@xmath lines in @xmath and

  -- -------- -- ------
     @xmath      (44)
  -- -------- -- ------

Since @xmath we also have

  -- -------- -- ------
     @xmath      (45)
  -- -------- -- ------

Applying Lemma \thechapter .4 to @xmath and @xmath , at least one of the
following is true:

1.  @xmath .

2.  There is a line in @xmath incident to at least @xmath points in
    @xmath .

3.  There is a line in @xmath incident to at least @xmath points in
    @xmath .

4.  There exists @xmath with @xmath and points @xmath in a @xmath
    -sum-product configuration.

As with Theorem \thechapter .1 , the first three cases fall easily. In
the first case ( 44 ) and ( 45 ) give

  -- -------- --
     @xmath   
  -- -------- --

By ( 43 ) this in turn implies that @xmath which is far better than
required. In the second case, since all lines in @xmath are incident to
@xmath points in @xmath and hence @xmath points in @xmath , it follows
that

  -- -------- --
     @xmath   
  -- -------- --

By ( 44 ) and ( 45 ) this gives @xmath and so ( 43 ) implies @xmath .
The third case similarly yields @xmath .

The fourth case is left. Apply Lemma \thechapter .3 to to @xmath to
obtain @xmath with @xmath and @xmath with

  -- -------- --
     @xmath   
  -- -------- --

such that

  -- -------- --
     @xmath   
  -- -------- --

As with the proof of Theorem \thechapter .1 , either @xmath or @xmath .
If @xmath then as per the last proof, Lemma \thechapter .8 gives

  -- -------- --
     @xmath   
  -- -------- --

By ( 44 ) and ( 45 ) this gives

  -- -------- --
     @xmath   
  -- -------- --

By ( 43 ) we then get @xmath , which is better than the sufficient
@xmath .

On the other hand, if @xmath and @xmath then by Lemma \thechapter .9

  -- -------- --
     @xmath   
  -- -------- --

By ( 44 ) and ( 45 ) this gives

  -- -------- --
     @xmath   
  -- -------- --

By ( 43 ) it follows that

  -- -------- --
     @xmath   
  -- -------- --

as required. ∎

### 18 Further work

An intrinsic proof in the plane? The work here, and the previous work of
Bourgain-Katz-Tao and Helfgott-Rudnev uses finite field sum-product
estimates as an animating force. The progress in this chapter comes down
to finding a particularly efficient way of relating this to incidences
by showing that a ‘sum-product’ configuration of points and lines must
arise if there are too many incidences, but that such a configuration
cannot exist since it would contradict known finite field growth
results.

Is it instead possible to construct a proof that lives entirely in the
plane? Such an approach, if it worked, could yield better incidence
results. Since the Elekes result (Theorem \thechapter .1 ) in Chapter
\thechapter shows that incidence bounds yield growth results, this could
also drive forward the study of growth in finite fields.

There may be some cause for optimism. The setup of points and lines that
we called a ‘sum-product’ configuration is not only interesting because
of its relationship to sum-products. It is also of intrinsic interest on
the plane, where it invites comparison with Desargues’ theorem. This
theorem, actually a defining property of the projective plane, says that
two triangles of points are perspective to a point if and only if they
are perspective to a line, the meaning of which is illustrated in Figure
6 below.

A sum-product configuration should imply the existence of many pairs of
triangles perspective to the same point and perspective to the same
line, at the same three places. Could pursuing the geometric
implications of such an arrangement be a fruitful line of inquiry?

## Chapter \thechapter Expander functions

Chapter \thechapter introduced expander functions as a type of growth
result. Recall that for a field @xmath , an @xmath -variable expander is
a function @xmath such that for any subset @xmath of @xmath , maybe
satisfying some nondegeneracy conditions, the set @xmath is of
cardinality at least @xmath with @xmath . This chapter sets new records
in two variables over finite fields, and in three and four variables
over real and complex numbers.

An earlier version of the two-variable finite field work formed one half
of a joint paper [ 26 ] ⁹ ⁹ 9 The paper is the union of two theorems
proved independently by the two authors. with Oliver Roche-Newton has
been accepted for publication in the Journal of Combinatorial Theory
Series A.

An earlier version of the three and four-variable real and complex
results has been submitted to Discrete and Computational Geometry, and a
preprint [ 25 ] is available on the arXiv.

### 19 Results

This section describes the new theorems proved in the chapter.

#### 19.1 Two variables

As mentioned in Chapter \thechapter , the strongest known two variable
expanders is the function @xmath , which was first studied by Garaev and
Shen [ 16 ] . They proved three results about the size of the set @xmath
, depending on the ambient field and the density of @xmath within it:

  -- -------- -- ------
     @xmath      (46)
     @xmath      (47)
     @xmath      (48)
  -- -------- -- ------

Result ( 47 ) is sharp but ( 46 ) and ( 48 ) are not. The first new
result of this chapter is the following improvement on ( 46 ).

###### Theorem \thechapter.1.

If @xmath and @xmath then

  -- -------- --
     @xmath   
  -- -------- --

Result ( 48 ), has also been recently improved, in the same paper [ 26 ]
as that containing an earlier version of Theorem \thechapter .1 , to
@xmath .

#### 19.2 Three and four variables

As mentioned in Chapter \thechapter , the breakthrough result of Guth
and Katz [ 18 ] on the distinct distances problem yields the function

  -- -------- --
     @xmath   
  -- -------- --

as a four-variable expander over @xmath with @xmath . Iosevich,
Roche-Newton and Rudnev [ 21 ] used the same methodology to show that

  -- -------- --
     @xmath   
  -- -------- --

is likewise a four-variable expander with @xmath . Both this and the
Guth-Katz result are sharp, as shown by the case where @xmath is an
arithmetic progression.

The next two new results in this chapter are examples of functions with
stronger growth properties. The first is a function in only three real
variables rather than four which is nevertheless an expander with @xmath
.

###### Theorem \thechapter.2.

Let @xmath . For any finite @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

The second is a four-variable expander with @xmath instead of @xmath .

###### Theorem \thechapter.3.

Let @xmath . For any finite @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

As with the results of Guth and Katz and Iosevich, Roche-Newton and
Rudnev, the example of an arithmetic progression shows that Theorem
\thechapter .2 is sharp up to logarithmic factors. However it is not
clear that the same is true of Theorem \thechapter .3 : in the case of
an arithmetic progression one has @xmath and so there may well be scope
for improvement.

#### 19.3 Structure

In the rest of this chapter, Section 20 gives the proof of Theorem
\thechapter .1 , and Section 21 gives the proofs of Theorems \thechapter
.2 and \thechapter .3 . Section 22 suggests possible further work.

### 20 Two-variable finite field expanders

This section is concerned with proving Theorem \thechapter .1 . The
overall strategy is similar to the finite field case in the work of
Garaev and Shen [ 16 ] , exploiting the fact that

  -- -------- --
     @xmath   
  -- -------- --

can be written as simply the product set @xmath . A sum-product
philosophy suggests that at least one of @xmath and the difference set
@xmath must be large. If it is the former then of course there is
nothing to prove, so the idea is to deal with the latter case. That is,
we want to show that if the difference set is large then so is @xmath .

The innovation here is to take a more efficient route than [ 16 ] , via
the simple Ruzsa-type observation that if @xmath then

  -- -------- --
     @xmath   
  -- -------- --

Section 20.1 establishes the new key result and shows three different
ways of implementing it. Section 20.2 then deploys these in a modified
sum-product type proof to establish Theorem \thechapter .1 .

#### 20.1 Bounding partial sumsets

The following result is the key to our progress.

###### Lemma \thechapter.4.

Let @xmath , and let @xmath . There exists @xmath with @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Without loss of generality assume that @xmath . Note that

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be the set of @xmath for which @xmath . Then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

and so

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be given by

  -- -------- --
     @xmath   
  -- -------- --

so that

  -- -------- -------- --
     @xmath   @xmath   
  -- -------- -------- --

For each @xmath pick @xmath and @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be given by

  -- -------- --
     @xmath   
  -- -------- --

Note that

  -- -------- --
     @xmath   
  -- -------- --

since there are @xmath choices of @xmath , each of which has at least
@xmath associated pairs @xmath . We now show that

  -- -------- --
     @xmath   
  -- -------- --

This will follow after showing that the map

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

is an injection, i.e. that for given @xmath in @xmath there is only one
choice of @xmath for which @xmath . Indeed for given @xmath in @xmath it
is immediate that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

so we know @xmath and therefore @xmath and @xmath . We therefore also
know @xmath since

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

So @xmath is indeed an injection and the upper bound on @xmath holds.

Comparing the upper and lower bounds on @xmath shows that

  -- -------- --
     @xmath   
  -- -------- --

and so

  -- -------- --
     @xmath   
  -- -------- --

as required. ∎

Let’s now apply this, using sumset calculus from Chapter \thechapter ,
to give upper bounds on @xmath in terms of @xmath . First, a
Balog-Szemerédi-Gowers approach yields a quite-efficient relationship:

###### Corollary \thechapter.5.

For any set @xmath there exists @xmath with @xmath such that @xmath

###### Proof.

Apply Lemma \thechapter .4 with @xmath and some fixed sufficiently small
@xmath to find @xmath with @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .4 there exists @xmath with @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .1 applied multiplicatively, @xmath and so the
result follows. ∎

Corollary \thechapter .5 is useful by itself, but we can do better in
some places. Covering results are often used in sum-product proofs, and
applying Lemma \thechapter .14 to Lemma \thechapter .4 yields one that
will be helpful here.

###### Corollary \thechapter.6.

Let @xmath , and @xmath for some @xmath . Let @xmath . Then @xmath
elements of @xmath can be covered by

  -- -------- --
     @xmath   
  -- -------- --

translates of @xmath . Similarly, @xmath elements of @xmath can be
covered by this many translates of @xmath .

###### Proof.

Applying Lemma \thechapter .4 to the sets @xmath and @xmath there exists
@xmath of cardinality at least @xmath such that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Then let

  -- -------- --
     @xmath   
  -- -------- --

to obtain

  -- -------- --
     @xmath   
  -- -------- --

The result follows by applying Lemma \thechapter .14 to @xmath , with
@xmath replaced by @xmath . ∎

Applying Lemma \thechapter .15 yields another helpful covering result.

###### Corollary \thechapter.7.

Let @xmath . Then there exists @xmath with @xmath such that @xmath is
covered by @xmath translates of @xmath .

###### Proof.

By Lemma \thechapter .4 , with @xmath replaced by @xmath , there exists
@xmath with @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Then by Lemma \thechapter .15 there exists @xmath with

  -- -------- --
     @xmath   
  -- -------- --

such that @xmath is covered by @xmath translates of @xmath , as
required. ∎

#### 20.2 Proving Theorem \thechapter.1

This section uses Corollaries \thechapter .5 , \thechapter .6 and
\thechapter .7 to prove Theorem \thechapter .1 .

By Corollary \thechapter .5 and passing to a subset of @xmath if
necessary we may assume that

  -- -------- -- ------
     @xmath      (49)
  -- -------- -- ------

By Corollary \thechapter .3 and again passing to a subset if necessary
we may assume that

  -- -------- -- ------
     @xmath      (50)
  -- -------- -- ------

Now, by Corollary \thechapter .10 and Lemma \thechapter .11 ,

  -- -------- --
     @xmath   
  -- -------- --

So there exists @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

By dyadic pigeonholing there exists @xmath and @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath and

  -- -------- -- ------
     @xmath      (51)
  -- -------- -- ------

Since @xmath this also implies

  -- -------- -- ------
     @xmath      (52)
  -- -------- -- ------

Now consider the set

  -- -------- --
     @xmath   
  -- -------- --

and break into two cases according to whether or not @xmath .

##### 20.2.1 @xmath

The important thing about @xmath is that if @xmath then

  -- -------- -- ------
     @xmath      (53)
  -- -------- -- ------

for any @xmath . Note that ( 53 ) employs a slight abuse of notation: by
@xmath it means the set of @xmath for which @xmath . It holds because
there can be no repetition in @xmath , since if

  -- -------- --
     @xmath   
  -- -------- --

with @xmath then @xmath which is a contradiction.

Now since @xmath there must exist @xmath such that @xmath . For any
@xmath it follows that

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      
              @xmath      (54)
  -- -------- -------- -- ------

where there is another abuse of notation in ( 54 ).

Now proceed to fix a particular choice of @xmath . Let @xmath be
sufficiently small and for convenience write

  -- -------- --
     @xmath   
  -- -------- --

Applying Corollary \thechapter .6 to the sets @xmath and @xmath shows
that there is a set @xmath with

  -- -------- --
     @xmath   
  -- -------- --

such that @xmath is contained in the union of @xmath translates of
@xmath . Similarly, there are sets @xmath with

  -- -------- --
     @xmath   
  -- -------- --

such that @xmath and @xmath are contained in the union of @xmath
translates of @xmath , and @xmath is contained in the union of @xmath
translates of @xmath . Let

  -- -------- --
     @xmath   
  -- -------- --

so that

  -- -------- --
     @xmath   
  -- -------- --

By Corollary \thechapter .7 there exists @xmath with

  -- -------- --
     @xmath   
  -- -------- --

such that @xmath is covered by @xmath translates of @xmath . Fix this
choice of @xmath so that from ( 54 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Since

  -- -------- --
     @xmath   
  -- -------- --

and @xmath are each contained in the union of @xmath translates of
@xmath , and @xmath is contained in the union of @xmath translates of
@xmath , it follows that

  -- -------- -------- -- ------
     @xmath   @xmath      (55)
              @xmath      
              @xmath      
  -- -------- -------- -- ------

By ( 50 ), this gives

  -- -------- -- ------
     @xmath      (56)
  -- -------- -- ------

Now by the Ruzsa triangle inequality (Lemma \thechapter .1 ) applied
multiplicatively,

  -- -------- -- ------
     @xmath      (57)
  -- -------- -- ------

Applying ( 49 ) and ( 57 ) to ( 56 ) yields

  -- -------- -------- --
     @xmath   @xmath   
  -- -------- -------- --

Rearranging and applying ( 51 ) and ( 52 ) gives

  -- -------- --
     @xmath   
  -- -------- --

and so

  -- -------- --
     @xmath   
  -- -------- --

as required.

##### 20.2.2 @xmath

Let @xmath be the number of solutions to

  -- -------- -- ------
     @xmath      (58)
  -- -------- -- ------

with @xmath and @xmath . Moreover, for each @xmath recall that @xmath is
the additive energy of @xmath and @xmath , i.e. the number of solutions
to ( 58 ) with @xmath fixed, so that

  -- -------- --
     @xmath   
  -- -------- --

There are no more than @xmath solutions to ( 58 ) for which @xmath . And
there are no more than @xmath solutions with @xmath . So in total

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath this gives

  -- -------- --
     @xmath   
  -- -------- --

So there exists @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Moreover, for any @xmath we have also

  -- -------- --
     @xmath   
  -- -------- --

Now by Lemma \thechapter .11 ,

  -- -------- --
     @xmath   
  -- -------- --

and so if @xmath then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

Let @xmath be as before and fix

  -- -------- --
     @xmath   
  -- -------- --

This yields the same situation as considered at ( 55 ) in the @xmath
case, but with one less factor of @xmath to deal with. So we obtain (and
in fact exceed) the required bound. ∎

### 21 Three and four-variable real and complex expanders

This section is concerned with the proofs of Theorems \thechapter .2 and
\thechapter .3 .

Let’s first place these in the context of the Guth-Katz proof on
distinct distances, which led to the example of the function @xmath as a
four-variable expander. This was based on a framework of Elekes and
Sharir [ 11 ] . The idea, when counting the number of distinct objects
determined by a set, is to analyse functions under which that object is
invariant.

In the Guth-Katz proof, where the objective is to count distances, the
approach is to analyse the group @xmath of orientation-preserving
isometries. This analysis can be parameterised as an incidence problem
of points and lines in @xmath . The usual Szmerédi-Trotter theorem is
too weak to be of help directly, but Guth and Katz were able to amplify
it to Theorem \thechapter .9 , which they developed using a novel
‘polynomial partitioning’ technique specifically for this purpose.

The approach of Iosevich, Roche-Newton and Rudnev for showing that
@xmath is a four-variable expander follows the same approach, but uses
the fact that this function can be viewed as a determinant. Thus the
approach is to analyse determinant-preserving maps, i.e. elements of
@xmath . Like the Guth-Katz result, this too required an application of
Theorem \thechapter .9 .

The approach for proving Theorems \thechapter .2 and \thechapter .3 is
likewise founded on the Elekes-Sharir paradigm. Whereas Guth and Katz
counted distances by analysing isometries from the group @xmath , and
Iosevich, Roche-Newton and Rudnev counted determinants by analysing
@xmath , the functions @xmath and @xmath considered here are instances
of cross ratios , which are preserved by the group @xmath of projective
transformations of the line.

There are several advantages to working with cross ratios:

-   As shown in Section 19 , we are able to prove quantitatively
    stronger expander results.

-   A smaller arsenal is required. Neither Theorem \thechapter .9 nor
    any other application of the Guth-Katz polynomial partitioning
    technique is required. Instead only the Szemerédi-Trotter theorem on
    points and lines is used when proving Theorem \thechapter .2 and
    only the Edelsbrunner-Guibas-Sharir theorem on points and planes is
    used when proving Theorem \thechapter .3 .

-   Parameterising as an incidence problem is more straightforward. The
    Guth and Katz and Iosevich, Roche-Newton and Rudnev proofs go
    through a certain amount of hassle in order to make the
    parameterisation and verify that appropriate nondegeneracy
    conditions are satisfied. But with cross ratios and projective
    transformations everything falls out naturally.

In what follows, Section 21.1 describes the standard theory of cross
ratios, establishing that they are invariants of projective
transformations. Section 21.2 then identifies projective transformations
in a natural way with points in three-dimensional projective space, and
establishes how the transformations’ behaviour corresponds to line and
plane structures of points. Section 21.3 then uses the results of the
preceding two sections to prove Theorems \thechapter .2 and \thechapter
.3 .

#### 21.1 Cross ratios

This section records some standard theory on cross ratios.

Recall, or consult Appendix \thechapter , that for a field @xmath the
projective line @xmath is the set of equivalence classes @xmath of
@xmath modulo dilation, and that it can more concretely be viewed as the
extended line @xmath by identifying @xmath with @xmath and @xmath with
@xmath . Under this identification, the cross ratio @xmath of four
elements @xmath is given by

  -- -------- --
     @xmath   
  -- -------- --

interpreted in the sense of limits where necessary. Note that the
functions @xmath and @xmath from Theorems \thechapter .2 and \thechapter
.3 are given by

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

So to prove the theorems it suffices respectively to show that

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

The importance of the cross ratio is that it is a projective invariant
of quadruples, in the sense of the following result which can be found
in [ 39 ] , for example.

###### Lemma \thechapter.8.

Let @xmath be distinct for @xmath and the same for @xmath . Then @xmath
if and only if there is a projective transformation in @xmath that sends
each @xmath to @xmath .

###### Proof.

By Lemma \thechapter .1 there is a unique projective transformation
@xmath that sends @xmath to @xmath for @xmath . We shall show that
@xmath if and only if @xmath also sends @xmath to @xmath .

First note that @xmath where @xmath is the unique projective
transformation that sends @xmath to @xmath . To see this it suffices
simply to check that

  -- -------- --
     @xmath   
  -- -------- --

and then that @xmath .

It follows that

  -- -------- --
     @xmath   
  -- -------- --

if and only if

  -- -------- -- ------
     @xmath      (59)
  -- -------- -- ------

Now by definition of @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

and so by injectivity of @xmath , equation ( 59 ) holds precisely when
@xmath This completes the proof. ∎

#### 21.2 Points, planes and transformations

This section contains two results that apply to any field @xmath . The
first, a ‘points lemma’, identifies projective transformations from
@xmath with points in @xmath . The second, a ‘planes lemma’, establishes
that the behaviour of transformations corresponds to line and plane
structures of their associated points.

###### Lemma \thechapter.9 (Points lemma).

Define @xmath by

  -- -------- --
     @xmath   
  -- -------- --

The map @xmath is well-defined and injective, and its image is @xmath
where @xmath is the quadratic surface given by @xmath .

###### Proof.

That @xmath is well-defined and injective follows from checking that if
@xmath then @xmath if and only if @xmath . That the image is @xmath
follows from the definition @xmath . ∎

###### Lemma \thechapter.10 (Planes lemma).

Let @xmath be as in the points lemma. For each @xmath there is a plane
@xmath with the following properties.

1.   If @xmath then @xmath if and only if @xmath .

2.   No three planes are collinear.

3.   Different pairs @xmath determine different planes @xmath .

4.   Different pairs of planes @xmath intersect in different lines
    @xmath .

5.   For any @xmath , a point @xmath is incident to at most @xmath of
    the planes from @xmath .

###### Proof.

From the theory in Appendix \thechapter , a projective transformation
@xmath sends @xmath to @xmath if and only if

  -- -------- --
     @xmath   
  -- -------- --

which is the same as

  -- -------- --
     @xmath   
  -- -------- --

For fixed @xmath this is an homogeneous linear constraint on @xmath and
so describes a plane in @xmath , which we define to be @xmath . Property
@xmath is satisfied by construction, and it is now straightforward to
establish properties @xmath to @xmath in turn

1.  It suffices to show that three planes intersect in a point. Let
    @xmath and @xmath be two triples of distinct elements of @xmath . By
    Lemma \thechapter .1 there is a unique @xmath that sends @xmath to
    @xmath . So

      -- -------- --
         @xmath   
      -- -------- --

    which is a single point in @xmath .

2.  If @xmath for some @xmath then @xmath is either a line or a plane
    for any third pair @xmath , which contradicts property @xmath .

3.  Suppose that

      -- -------- --
         @xmath   
      -- -------- --

    Then

      -- -------- --
         @xmath   
      -- -------- --

    But by property @xmath the set on the left hand side is a point,
    whereas that on the right is a line, unless @xmath . Similarly a
    contradiction follows unless @xmath

4.  Let @xmath be a point in @xmath , so that @xmath for some @xmath .
    For each @xmath there is at most one @xmath for which @xmath is
    incident to @xmath , as otherwise @xmath would take two different
    values. Counting over all @xmath shows that @xmath is incident to at
    most @xmath planes.

∎

#### 21.3 Proving Theorems \thechapter.2 and \thechapter.3

This section uses the results from Sections 21.1 and 21.2 to prove
Theorems \thechapter .2 and \thechapter .3 . We first give the proof of
Theorem \thechapter .2 , which uses the Szemerédi-Trotter theorem.

###### Proof of Theorem \thechapter.2..

Since

  -- -------- --
     @xmath   
  -- -------- --

we want to show that

  -- -------- --
     @xmath   
  -- -------- --

for any finite @xmath . To this end write @xmath for the number of
solutions to the equation

  -- -------- -- ------
     @xmath      (60)
  -- -------- -- ------

with each of the @xmath and @xmath in @xmath . Write @xmath for the
number of @xmath with @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

and Cauchy-Schwarz implies that

  -- -------- --
     @xmath   
  -- -------- --

So it suffices to show

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .8 , equation ( 60 ) is satisfied precisely when
there exists @xmath that fixes @xmath and sends each @xmath to @xmath .
So if we define

  -- -------- --
     @xmath   
  -- -------- --

and write @xmath for the number of @xmath for which @xmath , then

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      
              @xmath      (61)
  -- -------- -------- -- ------

Let @xmath be as in the points lemma. Define a set @xmath of points by

  -- -------- --
     @xmath   
  -- -------- --

and a set of @xmath lines by

  -- -------- --
     @xmath   
  -- -------- --

so that @xmath . The points and lines all lie in the plane @xmath .
Moreover, if we write @xmath for the number of lines from @xmath
incident to a point @xmath , then

  -- -------- -------- -- ------
     @xmath   @xmath      
              @xmath      
              @xmath      (62)
  -- -------- -------- -- ------

Combining ( 61 ) and ( 62 ) gives

  -- -------- -- ------
     @xmath      (63)
  -- -------- -- ------

For each @xmath write @xmath for the set of @xmath with @xmath .
Applying the complex Szemerédi-Trotter theorem in the form of Corollary
\thechapter .15 gives

  -- -------- --
     @xmath   
  -- -------- --

and so

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

as required. ∎

We now give the proof of Theorem \thechapter .3 , which uses the
Edelsbrunner-Guibas-Sharir theorem.

###### Proof of Theorem \thechapter.3..

This time we want to show that

  -- -------- --
     @xmath   
  -- -------- --

for any finite @xmath . To this end, we this time write @xmath for the
number of solutions to the equation

  -- -------- -- ------
     @xmath      (64)
  -- -------- -- ------

with the @xmath . Using Cauchy-Schwarz as in Theorem \thechapter .2
shows that

  -- -------- --
     @xmath   
  -- -------- --

so it suffices to show that

  -- -------- --
     @xmath   
  -- -------- --

Equation ( 64 ) is satisfied precisely when there exists @xmath that
sends @xmath to @xmath for each @xmath . Define

  -- -------- --
     @xmath   
  -- -------- --

and write @xmath for the number of @xmath for which @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be as in the points lemma. Define a set @xmath of points by

  -- -------- --
     @xmath   
  -- -------- --

and a set @xmath of planes by

  -- -------- --
     @xmath   
  -- -------- --

so that @xmath . If we write @xmath for the number of planes from @xmath
incident to a point @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

So, following the same argument as for ( 63 ) in the preceding proof,

  -- -------- --
     @xmath   
  -- -------- --

For each @xmath write @xmath for the set of @xmath with @xmath . Then
applying the Edelsbrunner-Guiber-Sharir theorem on points and planes in
the form of Corollary \thechapter .11 gives

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

as required. ∎

### 22 Further work

-    Where else could Ruzsa-type observations lead? The Ruzsa-type
    observation that

      -- -------- --
         @xmath   
      -- -------- --

    whenever @xmath leads to a doubling of the growth exponent for the
    function @xmath over finite fields. Could similar observations
    enable the construction of other expander functions, or give
    improved bounds on existing ones like @xmath , @xmath , or @xmath ?

-    What more can be proved using cross ratios? Cross ratios turned out
    to be very useful when constructing expanders in Theorems
    \thechapter .2 and \thechapter .3 . For example, Theorem \thechapter
    .2 is a sharp three-variable result whose bound of @xmath is as
    strong as the best previously known four-variable results. What more
    can be said?

    As a start, it seems reasonable to conjecture that the four-variable
    Theorem \thechapter .3 can be strengthened to @xmath . This would
    bring the theorem into line with the case where @xmath is an
    arithmetic progression, which is a sharp example for Theorem
    \thechapter .2 .

    In terms of applications to other growth results, might the strength
    of cross-ratio estimates enable new things to be said about
    two-variable expanders, or about sum-product estimates?

## Chapter \thechapter A sum-product theorem in function fields

This chapter proves a sum-product theorem in the function field @xmath ,
showing that if @xmath is a finite subset of @xmath then

  -- -------- --
     @xmath   
  -- -------- --

The exponent of @xmath lies between the @xmath known in the complex
setting and the @xmath known in the finite field setting. This reflects
the fact that unlike finite fields, @xmath has an associated norm and
topology, but that this norm is very different from that on @xmath ,
with an unusually rigid ‘non-archimedean’ geometry.

The material in this chapter is joint work with Thomas Bloom.

### 23 Results

Recall that @xmath denotes the finite field of order @xmath , where
@xmath is a prime power. The prime @xmath is the characteristic of
@xmath , i.e. the least @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath . Throughought this chapter the letter @xmath will be
reserved for this characteristic. The function field @xmath is the field
of rational functions of a transcendental element @xmath over @xmath .
Elements are therefore of the form

  -- -------- --
     @xmath   
  -- -------- --

where the @xmath are elements of @xmath . Note that this means that
although @xmath is finite, the function field @xmath is not.

As with finite fields, it is necessary to rule out the possibility of
finite subfields to be able to say anything non-trivial about growth in
@xmath . But unlike finite fields, this is accomplished by a minimum
rather than a maximum condition on the cardinality of a set @xmath . The
reason is that the only finite subfields of @xmath are @xmath and its
subfields: to rule these out it suffices to insist that @xmath is a bit
bigger than @xmath . Think therefore of @xmath as being small and fixed,
as opposed to finite fields where it is taken to be very large indeed. A
convenient way of capturing this necessity is to introduce an implicit
dependency on @xmath when formulating sum-product estimates, so that
results are of the form

  -- -------- --
     @xmath   
  -- -------- --

for an absolute @xmath and any finite @xmath .

As mentioned in Chapter \thechapter , Li and Roche-Newton [ 33 ]
obtained a sum-product estimate @xmath for a finite field @xmath whose
order is not necessarily prime, extending the applicability of Rudnev’s
result for @xmath . Because of its combinatorial generality this proof
should go through in the function field setting without additional
complication.

It is possible to do better by developing techniques specific to
function fields. This chapter proves the following theorem

###### Theorem \thechapter.1.

If @xmath is finite then

  -- -------- --
     @xmath   
  -- -------- --

A sum-product result for function fields with @xmath follows
immediately.

###### Corollary \thechapter.2.

If @xmath is finite then

  -- -------- --
     @xmath   
  -- -------- --

The next section provides more background on function fields, and
explains the structure of the proof and the rest of the chapter.

### 24 Function fields

This section has two parts. The first part, Section 24.1 , gives some
standard background on the geometry of function fields. The second part,
Section 24.2 , explains how this will be used in the proof of Theorem
\thechapter .1 and describes how the rest of the chapter is organised.

#### 24.1 Background

The field @xmath has a norm or valuation @xmath given by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the degree of @xmath , i.e. the maximal @xmath for which
@xmath is non-zero. This valuation has the non-archimedean property that

  -- -------- --
     @xmath   
  -- -------- --

which is stronger than the usual triangle inequality. As a consequence
@xmath has an unusually rigid geometry, which will be exploited when
proving sum-product estimates. A particular concern will be the
behaviour of balls , which are as usual sets of the form

  -- -------- --
     @xmath   
  -- -------- --

In @xmath , the non-archimedean property implies the following fact,
which is considered to be standard.

###### Lemma \thechapter.3.

If @xmath and @xmath are balls in @xmath then either they are disjoint,
or @xmath , or @xmath . If in addition @xmath and @xmath have the same
radius then either they are disjoint or @xmath .

###### Proof.

Let @xmath and @xmath . If there exists @xmath then

  -- -------- --
     @xmath   
  -- -------- --

If @xmath then this implies @xmath since if @xmath then

  -- -------- --
     @xmath   
  -- -------- --

Conversely if @xmath then @xmath . Hence if @xmath then @xmath . ∎

#### 24.2 Sum-product considerations

The @xmath sum-product proof builds upon an approach of Solymosi [ 41 ]
for sum-products in @xmath . When adapting this method, the
non-archimedean geometry of @xmath turns out to be a mixed blessing.

First, the bad news. Solymosi’s argument fails at a critical point in
the @xmath setting, for the following reason. For each @xmath , let
@xmath be such that @xmath is minimal, and let @xmath be the ball of
radius @xmath centred on @xmath . Solymosi’s method uses the crucial
fact that a single complex number can be contained in at most @xmath of
the @xmath . This fails spectacularly in @xmath : in this setting an
element could be contained in as many as @xmath of the @xmath , as
demonstrated by the example

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

for @xmath and @xmath , meaning that every one of the @xmath balls
contains @xmath as an element.

But all is not lost. In the example above, the astute reader will notice
that @xmath , and so a strong-sum product estimate holds despite the
failure of Solymosi’s argument. In fact we will be able to show that
something like this is possible whenever the Solymosi argument fails, by
defining and considering separable sets .

Say that a set @xmath is separable if its elements can be indexed as

  -- -------- --
     @xmath   
  -- -------- --

in such a way that for any @xmath there is a ball @xmath with

  -- -------- --
     @xmath   
  -- -------- --

Separability is fairly unexciting in the complex setting, but in the
non-archimedean regime of @xmath it is a stronger notion. The rigid
geometry makes it harder to find separable sets, but where they do exist
it will in fact imply the existence of large sumsets. The idea,
therefore, is to show that a large separable sets must exist whenever
the Solymosi approach fails. Combining this with an analysis of
separable sets as having large sumsets will lead to a proof of Theorem
\thechapter .1 .

In what follows, Section 25 analyses separable sets and develops the
necessary results about their sumsets. Section 26 then adapts Solymosi’s
proof from [ 41 ] to establish that if @xmath and @xmath are both small
then @xmath must contain a large separable set. Section 27 uses these
results to prove Theorem \thechapter .1 . Section 28 considers some
directions for further work.

### 25 Separable sets

This section analyses sumsets of separable sets. Recall that a set
@xmath is separable if its elements can be indexed as

  -- -------- --
     @xmath   
  -- -------- --

in such a way that for each @xmath there is a ball @xmath with

  -- -------- --
     @xmath   
  -- -------- --

Say that the balls @xmath separate @xmath . It is an immediate
consequence of the definition that a subset of a separable set is itself
separable.

As in Chapter \thechapter write @xmath for the @xmath -fold sumset of
@xmath . The following lemma shows that if @xmath is separable then
@xmath has essentially maximum-possible cardinality.

###### Lemma \thechapter.4.

If @xmath is separable then

  -- -------- --
     @xmath   
  -- -------- --

for any natural number @xmath .

###### Proof.

Let @xmath denote the @xmath -fold additive energy of @xmath , i.e. the
number of solutions to

  -- -------- -- ------
     @xmath      (65)
  -- -------- -- ------

with the @xmath . For @xmath write @xmath for the number of solutions to
@xmath . By Cauchy-Schwarz as in Lemma \thechapter .11 ,

  -- -------- --
     @xmath   
  -- -------- --

and so it suffices to show that @xmath , i.e. that there are at most
@xmath solutions to ( 65 ).

Say that a solution to ( 65 ) is trivial if at least @xmath of the
@xmath terms occur with multiplicity at least @xmath . By elementary
counting there are at most @xmath trivial solutions, so it suffices to
show that there are no non-trivial solutions.

Suppose for a contradiction that a non-trivial solution to ( 65 )
exists. Gathering terms gives an expression of the form

  -- -------- -- ------
     @xmath      (66)
  -- -------- -- ------

where the @xmath are distinct elements of @xmath and, since we are in
characteristic @xmath , the @xmath are integers non-strictly between
@xmath and @xmath . The assumption of non-triviality implies that @xmath
, since at least two of the terms have @xmath . Additionally, note that

  -- -------- -- ------
     @xmath      (67)
  -- -------- -- ------

Indeed after gathering terms on the left the different multiplicities
@xmath must sum to zero, since there are the same number of terms on the
left of ( 65 ) as on the right. Any @xmath for which @xmath is
discarded, meaning that the sum of the remaining multiplicities is
@xmath as well.

Now since @xmath is separable and the @xmath are in @xmath we may
relabel them if necessary to assume the existence of a ball @xmath such
that @xmath but @xmath . By ( 66 ),

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Then by ( 67 ) and the non-archimedean property it follows that

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

and hence @xmath which is a contradiction. Thus there are no non-trivial
solutions and the proof is complete. ∎

### 26 Finding many separable sets

The goal in this section is to show that if the sumset and product set
of a set @xmath are both small then it must contain a large separable
set. For this it adapts the argument of Solymosi [ 41 ] for complex
sum-products discussed in Section 24.2 . Note that all of the analysis
remains in the @xmath setting; indeed some of the facts of
non-archimedean geometry deployed here are manifestly false in @xmath .

A couple of new definitions are required. Define

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

Additionally, say that @xmath is an @xmath -chain if its elements can be
indexed as @xmath in such a way that

  -- -------- --
     @xmath   
  -- -------- --

The following argument, a strengthened form of that found in [ 41 ] ,
finds a large chain in @xmath as long as the sumset and product set are
both small. In the event that this condition were to fail there would of
course be nothing to prove.

###### Lemma \thechapter.5.

Any set @xmath contains an @xmath -chain of cardinality

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

For each @xmath write @xmath for the maximal cardinality @xmath of an
@xmath -chain @xmath for which @xmath . Note for future reference that

  -- -------- --
     @xmath   
  -- -------- --

since if @xmath is such an @xmath -chain then @xmath by definition and
for each @xmath we have @xmath .

It suffices to find @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Begin with a dyadic pigeonholing. For each @xmath define @xmath to be
the set of @xmath for which @xmath . The @xmath partition @xmath and so

  -- -------- --
     @xmath   
  -- -------- --

Hence there exists @xmath for which @xmath . We shall show that

  -- -------- --
     @xmath   
  -- -------- --

To this end, say that a pair @xmath is additively good if

  -- -------- --
     @xmath   
  -- -------- --

and that @xmath is multiplicatively good if

  -- -------- --
     @xmath   
  -- -------- --

Say that a quadruple @xmath is good if

1.  @xmath .

2.  @xmath .

3.  @xmath is additively good.

4.  @xmath is multiplicatively good.

Write @xmath for the number of good quadruples. We shall bound @xmath
from below to obtain

  -- -------- -- ------
     @xmath      (68)
  -- -------- -- ------

and bound it from above to obtain

  -- -------- -- ------
     @xmath      (69)
  -- -------- -- ------

Comparing ( 68 ) and ( 69 ) will then give the required bound on @xmath
since @xmath . Let’s first establish ( 68 ). For fixed @xmath we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

where @xmath is the set of @xmath with @xmath .

Note that @xmath is an @xmath -chain. This follows from Lemma
\thechapter .3 since for any two @xmath we have @xmath and so either
@xmath or @xmath .

Now since @xmath and @xmath is an @xmath -chain, there is an @xmath for
which

  -- -------- --
     @xmath   
  -- -------- --

We therefore have

  -- -------- --
     @xmath   
  -- -------- --

and hence

  -- -------- --
     @xmath   
  -- -------- --

holds for at least @xmath elements @xmath . So for fixed @xmath there
are at least @xmath elements @xmath for which @xmath is additively good.

By the same argument we may show that for fixed @xmath there are at
least @xmath elements @xmath for which @xmath is multiplicatively good.

Thus for any @xmath and @xmath there are at least @xmath elements @xmath
for which @xmath is additively good and @xmath is multiplicatively good,
i.e. for which conditions 3 and 4 hold. Furthermore for each such @xmath
there are at least @xmath elements @xmath for which condition 2 holds,
since

  -- -------- --
     @xmath   
  -- -------- --

In total therefore,

  -- -------- --
     @xmath   
  -- -------- --

which concludes the proof of ( 68 ).

We now prove ( 69 ). Note that the map

  -- -------- --
     @xmath   
  -- -------- --

is injective and so it suffices to bound the number of possibilities for
this latter expression, subject to the constraint that @xmath is good.
There are certainly at most @xmath possibilities for @xmath and at most
@xmath for @xmath , so it suffices to show that if these are fixed then
there are at most @xmath possibilities for @xmath and at most @xmath for
@xmath .

First establish the bound on the number of @xmath . Note that if

  -- -------- --
     @xmath   
  -- -------- --

then either

  -- -------- --
     @xmath   
  -- -------- --

or

  -- -------- --
     @xmath   
  -- -------- --

since both sets are balls with the same centre @xmath .

As a consequence, if @xmath is the set of additively good pairs @xmath ,
then for any @xmath there is a fixed additively good pair @xmath such
that

  -- -------- --
     @xmath   
  -- -------- --

whenever @xmath and @xmath is additively good. Thus if @xmath is the
fixed first co-ordinate and @xmath is a possible second co-ordinate then
since @xmath and @xmath we have

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

Since @xmath is additively good, there are, as required, at most @xmath
possibilities for @xmath . The argument that there are at most at most
@xmath for @xmath is similar.

In total therefore

  -- -------- --
     @xmath   
  -- -------- --

which concludes the proof of ( 69 ) and thus of the lemma. ∎

The following result shows that any chain contains a large separable
subset, allowing Lemma \thechapter .4 to be applied to the chain found
in Lemma \thechapter .5 .

###### Lemma \thechapter.6.

If @xmath is an @xmath -chain then @xmath contains a separable set of
cardinality at least @xmath .

###### Proof.

Observe that any subset @xmath with

  -- -------- --
     @xmath   
  -- -------- --

is separable. Indeed, such a set is separated by the balls @xmath
because if @xmath were an element of @xmath it would follow that @xmath
and so by Lemma \thechapter .3 we would have the contradiction @xmath

Define an equivalence relation on elements of @xmath by @xmath if and
only if @xmath . To prove the lemma it suffices to show that each
equivalence class contains at most @xmath elements of @xmath .

Note first that if @xmath then

  -- -------- --
     @xmath   
  -- -------- --

Indeed, since @xmath it follows that @xmath and so @xmath . However by
minimality, @xmath and so @xmath . Similarly @xmath .

Suppose for a contradiction that there is an equivalence class
containing elements @xmath . Consider differences @xmath for @xmath . By
the last paragraph we have

  -- -------- --
     @xmath   
  -- -------- --

Now look at the leading terms of the @xmath . Since the leading term
must be non-zero, there are only @xmath possibilities and so by the
pigeonhole principle there must exist @xmath such that @xmath and @xmath
have the same leading term. Since

  -- -------- --
     @xmath   
  -- -------- --

it follows that @xmath and @xmath have the same degree, and that this is
strictly greater than the degree of

  -- -------- --
     @xmath   
  -- -------- --

This yields the contradiction

  -- -------- --
     @xmath   
  -- -------- --

and so concludes the proof. ∎

### 27 Proof of Theorem \thechapter.1

Theorem \thechapter .1 now follows by combining Lemma \thechapter .4
from Section 25 with Lemma \thechapter .5 and Lemma \thechapter .6 from
Section 26 .

###### Proof of Theorem \thechapter.1.

By Lemma \thechapter .5 , the set @xmath contains an @xmath -chain of
cardinality

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .6 it therefore contains a separable set @xmath of
cardinality

  -- -------- --
     @xmath   
  -- -------- --

and so Lemma \thechapter .4 implies

  -- -------- --
     @xmath   
  -- -------- --

Plünnecke’s inequality (Lemma \thechapter .2 ) shows that @xmath for any
@xmath and so combining upper and lower bounds on @xmath gives

  -- -------- --
     @xmath   
  -- -------- --

Taking @xmath -th roots, we get

  -- -------- --
     @xmath   
  -- -------- --

Letting @xmath tend to infinity and rearranging then yields

  -- -------- --
     @xmath   
  -- -------- --

as required.

∎

### 28 Further work

-    Incidences and expanders. Now that we have a sum-product estimate
    in @xmath , it is possible to obtain expander results like Theorem
    \thechapter .1 and incidence results like Theorem \thechapter .1 and
    Theorem \thechapter .2 for function fields without much fuss. These
    will be stronger than the finite field case, but the gap versus the
    @xmath sum-product estimate will be quite large.

    Is it possible to do better by working directly with the
    non-archimedean geometry of @xmath ? For example, can we obtain an
    incidence bound in @xmath that is almost as strong as the
    Szmererédi-Trotter theorem in @xmath ?

-    Computer science applications. At the start of the thesis, we said
    that we would not worry about applications. However it is worth
    mentioning that some existing applications of finite field growth
    results to theoretical computer science may be improved by
    considering @xmath instead.

-    Other arithmetic combinatorics problems. There are many more topics
    in arithmetic combinatorics than considered in this chapter, or
    indeed in this thesis. Thomas Bloom, with whom the work in this
    chapter is joint, is investigating a number of such problems in
    @xmath . His upcoming thesis is likely to be worth a read.

\addappheadtotoc

## Chapter \thechapter Pigeonholing

This appendix summarises some standard pigeonholing results used
throughout the thesis.

## Appendix A Averaging

Averaging results enable us to take information about the average
behaviour of a set and deduce the existence of elements with particular
behaviour. The most basic result of this kind shows that at least one
element must be at least average, and at least one element must be at
most average. It follows by elementary pigeonholing and so we record it
without proof.

###### Lemma \thechapter.1.

Let @xmath be a finite set of real numbers. Then at least one element of
@xmath must be greater than or equal to @xmath and at least one must be
less than or equal to @xmath .

Lemma \thechapter .1 is so standard that it is used throughout the
thesis without reference. More developed versions of this approach
enable one to show that not just one element but many must exhibit
behaviour not very much different from the average. These are
constructed in the main body of the thesis to deal with particular
situations.

## Appendix B Dyadic pigeonholing

The phrase ‘dyadic pigeonholing’ refers to the following result, which
at the price of a logarithmic factor allows us to assume that a variable
is essentially constant.

###### Lemma \thechapter.2 (Dyadic pigeonholing).

Let @xmath be a finite set of real numbers strictly greater than one and
less than or equal to @xmath . Then there exists an integer @xmath and a
subset @xmath of @xmath such that every element of @xmath lies in the
interval @xmath and

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

For each integer @xmath , let

  -- -------- --
     @xmath   
  -- -------- --

The sets @xmath partition @xmath and so

  -- -------- --
     @xmath   
  -- -------- --

Hence there is a @xmath for which

  -- -------- --
     @xmath   
  -- -------- --

Setting @xmath and @xmath , the proof is complete. ∎

## Appendix C The Cauchy-Schwarz inequality

The phrase ‘by Cauchy-Schwarz’ typically has two meanings in the
literature, and this is reflected in the thesis. It should be clear from
the context which meaning is implied. The first meaning is the standard
Cauchy-Schwarz inequality.

###### Lemma \thechapter.3 (Cauchy-Schwarz).

Let @xmath be finite sets of real numbers. Then

  -- -------- --
     @xmath   
  -- -------- --

The second meaning is a particular application of Cauchy-Schwarz to
pairwise intersection of sets, as follows.

###### Corollary \thechapter.4.

Let @xmath be a finite set, and suppose we have a collection of subsets
@xmath , indexed by a finite set @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We have

  -- -------- --
     @xmath   
  -- -------- --

Hence by the Cauchy-Schwarz inequality,

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

∎

## Chapter \thechapter Projective geometry

This appendix gives the background in projective geometry necessary for
Chapters \thechapter and \thechapter .

First it defines projective space @xmath over a field @xmath . Then it
shows how @xmath can be considered as the union of affine space @xmath
and a hyperplane ‘at infinity’. Lastly, it defines projective
transformations and establishes some useful facts about their
transitivity.

The approach is based on that in [ 39 ] .

## Appendix D Projective space

Let @xmath be a field. Define projective @xmath -space @xmath to be

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the equivalence relation given by dilation, i.e if
@xmath then @xmath if and only if @xmath for some @xmath . Elements of
@xmath are therefore equivalence classes, and we write @xmath for the
equivalence class containing @xmath .

We will be concerned with linear subspaces of @xmath . In affine space
@xmath an @xmath -dimensional hyperplane is the locus of zeroes @xmath
of a linear, possibly inhomogeneous, equation in @xmath variables

  -- -------- -- ------
     @xmath      (70)
  -- -------- -- ------

where the @xmath are fixed elements of @xmath .

But in projective space, an @xmath -dimensional hyperplane is the set of
@xmath for which @xmath satisfies a linear homogeneous equation in
@xmath variables

  -- -------- -- ------
     @xmath      (71)
  -- -------- -- ------

The homogeneity of ( 71 ) ensures that this is well-defined. Note that
@xmath and @xmath lie in the same @xmath -dimensional projective
hyperplane of @xmath if and only if @xmath and @xmath lie in the same
@xmath -dimensional affine hyperplane of @xmath .

## Appendix E The hyperplane at infinity

It is often helpful to think of @xmath as the union of @xmath with an
@xmath -dimensional hyperplane ‘at infinity’. The idea is that two
parallel @xmath -spaces are disjoint in @xmath , but in @xmath they
intersect in an @xmath -space on the hyperplane at infinity. Moreover,
all @xmath -spaces of the same gradient will intersect in the same
@xmath space at infinity.

For example, the projective line @xmath can be viewed as the extended
line @xmath . And the projective plane @xmath can be viewed as @xmath
where @xmath is the projective line at infinity. In this latter case,
two parallel lines in @xmath intersect in a point on @xmath , and all
lines of the same gradient intersect at the same such point.

To justify this interpretation, view @xmath as @xmath and identify
@xmath with @xmath . This preserves hyperplanes, since @xmath lies in
the affine hyperplane given by ( 70 ) if and only if @xmath lies in the
projective hyperplane given by ( 71 ). This accounts for all elements of
@xmath apart from those of the form @xmath with @xmath . These form the
projective @xmath -space given by @xmath , which we call the ‘hyperplane
at infinity’. The verification of the claim that all @xmath -spaces of
the same gradient intersect in the same @xmath -space is left as an
exercise.

## Appendix F Projective transformations

The group @xmath of projective transformations of @xmath is defined by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the identity. Elements are therefore equivalence classes
@xmath of linear transformations @xmath . The group has an action on
@xmath given by

  -- -------- --
     @xmath   
  -- -------- --

It is easy to check that this action is well-defined, that elements of
@xmath are permutations of @xmath , and that they preserve linear
subspaces.

The action also has an important transitivity property. Say that @xmath
distinct points @xmath are a frame if no @xmath of them lie in the same
@xmath -dimensional projective hyperplane. For example, three distinct
elements of @xmath are a frame, and four distinct elements of @xmath are
a frame if no three of them are collinear. The following result shows
that the action of @xmath is sharply transitive on frames.

###### Lemma \thechapter.1 (Sharp transitivity on frames).

Let @xmath and @xmath be two frames of points in @xmath . There is a
unique projective transformation @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Let @xmath with @xmath be elements of the canonical basis of @xmath ,
let @xmath and define

  -- -------- --
     @xmath   
  -- -------- --

and @xmath .

It suffices to show that for any frame @xmath of points in @xmath there
exists a unique @xmath that sends @xmath to @xmath for each @xmath and
sends @xmath to @xmath . Indeed, if this is established then given
frames @xmath and @xmath there are unique @xmath that send both to
@xmath . Then @xmath is the unique map that sends @xmath to @xmath .

We first prove the existence of an appropriate @xmath . Say that @xmath
is given by @xmath with @xmath . Since the first @xmath points @xmath
are not coplanar in @xmath , the corresponding @xmath are not coplanar
in @xmath and so form a basis. Hence we can write

  -- -------- -- ------
     @xmath      (72)
  -- -------- -- ------

with the @xmath all elements of @xmath . Let @xmath be a linear
transformation that sends the @xmath -basis @xmath to a scalar multiple
of the canonical basis @xmath . Let @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

for each @xmath . Additionally ( 72 ) and the choice of @xmath imply
that

  -- -------- --
     @xmath   
  -- -------- --

and so we have established existence.

We now prove uniqueness, for which it suffices to show that our choice
of @xmath is the only one that sends @xmath to @xmath for @xmath and
@xmath to @xmath . So suppose that @xmath has this property. Then @xmath
and so there exists @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

But since @xmath there exists @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

Combining gives

  -- -------- --
     @xmath   
  -- -------- --

and so by linear independence @xmath for all @xmath . In other words,
@xmath sends the basis @xmath to a scalar multiple of the canonical
basis @xmath , as required. ∎

\SingleSpacing \nobibintoc