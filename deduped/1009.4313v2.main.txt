# 1 Introduction and the classification of Fano 3-folds

A Fano @xmath -fold @xmath is a normal projective 3-fold whose
anticanonical divisor @xmath is @xmath -Cartier and ample. We eventually
impose additional conditions on the singularities and class group of
@xmath , such as terminal, @xmath -factorial, quasismooth, prime (that
is, class group @xmath of rank 1) or @xmath , but more general cases
occur in the course of our arguments.

We study @xmath via its anticanonical graded ring

  -- -------- --
     @xmath   
  -- -------- --

Choosing generators of @xmath embeds @xmath as a projectively normal
subvariety @xmath in weighted projective space. The anticanonical ring
@xmath is known to be Gorenstein, and we say that @xmath is projectively
Gorenstein. The codimension of @xmath refers to this anticanonical
embedding. The discrete invariants of a Fano 3-fold @xmath are its genus
@xmath (defined by @xmath ) together with a basket of terminal cyclic
quotient singularities; for details see 3.1 and [ ABR ] .

In small codimension we can write down hypersurfaces, codimension 2
complete intersections and codimension 3 Pfaffian varieties fluently.
This underlies the classification of Fano @xmath -folds in codimension
@xmath (see [ C3f ] , [ F ] and [ A0 ] ): the famous 95 weighted
hypersurfaces, 85 codimension 2 families, and 70 families in
codimension 3, of which 69 are @xmath Pfaffians. Gorenstein in
codimension 4 remains one of the frontiers of science: there is no
automatic structure theory, and deformations are almost always
obstructed. Type I projection and Kustin–Miller unprojection (see [ KM ]
, [ Pr ] , [ Ki ] ) is a substitute that is sometimes adequate. This
paper addresses codimension 4 Fano @xmath -folds in this vein.

The analysis of [ A0 ] , [ A ] , [ ABR ] , [ GRDB ] provides 145
numerical candidates for codimension 4 Fano @xmath -folds. This paper
isolates 115 of these that can be studied using Type I projections,
hence as Kustin–Miller unprojections. Our main result is Theorem 3.2 :
each of these 115 numerical candidates occurs in at least two ways (the
Tom and Jerry of the title), that give rise to topologically distinct
varieties @xmath .

The reducibility of the Hilbert scheme of Fano 3-folds is a systematic
feature of our results, that goes back to Takagi’s study of prime Fano
3-folds with basket of @xmath points ( [ T ] , Theorem 0.3). He
describes families of varieties having the same invariants, but arising
from different “Takeuchi programs”, that is, different Sarkisov links.
Four of his numerical cases have codimension 4. The first, No. 1.4 in
the tables of [ T ] , is our initial case @xmath ; it projects to the
@xmath complete intersection, so has @xmath resolution and is unrelated
to Tom and Jerry. Takagi’s three other pairs of codimension 4 cases
correspond to our Tom and Jerry families as follows:

  -- -------- --
     @xmath   
  -- -------- --

Each of these is prime. In our treatment, each of these numerical cases
admits one further Jerry family consisting of Fano 3-folds of Picard
rank @xmath .

Section 2 traces the origin of Tom and Jerry back to the geometry of
linear subspaces of @xmath and associated unprojections to twisted forms
of @xmath and @xmath ; for more on this, see Section 9 . Section 3 is a
detailed discussion of our Main Theorem 3.2 , whose proof occupies the
rest of the paper. Flowchart 3.5 maps out the proof, which involves many
thousand computer algebra calculations. Section 9 discusses the wider
issue of codimension 4 formats, and serves as a mathematical counterpart
to the computer algebra of Sections 5 – 8 . We do not elaborate on this
point, but Tom and Jerry star in many other parallel or serial
unprojection stories beyond Fano 3-folds or codimension 4, notably the
diptych varieties of [ BR ] .

We are indebted to a referee for several pertinent remarks that led to
improvements, and to a second referee who verified our computer algebra
calculations independently. This research is supported by the Korean
government WCU Grant R33-2008-000-10101-0.

## 2 Ancestral examples

### 2.1 Linear subspaces of @xmath

A del Pezzo variety of degree 5 is an @xmath -fold @xmath of
codimension 3, defined by 5 quadrics that are Pfaffians of a @xmath skew
matrix of linear forms. Thus @xmath is a linear section of Plücker
@xmath (here @xmath ). We want to unproject a projective linear subspace
@xmath contained as a divisor in @xmath to construct a degree 6 del
Pezzo variety @xmath . The crucial point is the following.

###### Lemma 2.1

The Plücker embedding @xmath contains two families of maximal linear
subspaces. These arise from

1.   The @xmath -dimensional vector subspace @xmath for a fixed @xmath .

2.   The @xmath -dimensional subspace @xmath for a fixed @xmath
    -dimensional vector subspace @xmath .

Thus there are two different formats to set up @xmath . Case I gives
@xmath . A section of @xmath by a general @xmath containing @xmath is a
4-fold @xmath whose unprojection is @xmath . Case II gives @xmath . A
section of @xmath by a general @xmath containing @xmath is a 3-fold
@xmath whose unprojection is @xmath .

The proof is a lovely exercise. Hint: use local and Plücker coordinates

  -- -------- -- -------
     @xmath      (2.1)
  -- -------- -- -------

with Plücker equations @xmath , etc.; permute the indices and choose
signs pragmatically to make this true. Prove that in Plücker @xmath ,
the tangent plane @xmath intersects @xmath in the cone over the Segre
embedding of @xmath .

### 2.2 Tom@xmath and Jer@xmath in equations

Tom @xmath is

  -- -------- -- -------
     @xmath      (2.2)
  -- -------- -- -------

with @xmath arbitrary elements, and the six entries @xmath linear
combinations of a regular sequence @xmath of length four. Expressed
vaguely, there are “two constraints on these six entries”; these two
coincidences take the simplest form when @xmath . In this case, the
Pfaffian equations all reduce to binomials, and can be seen as the
@xmath minors of an array: as a slogan,

  -- -- -- -------
           (2.3)
  -- -- -- -------

That is, the @xmath Pfaffians on the left equal the five @xmath minors
of the array on the right. To see the Segre embedding of @xmath and its
linear projection from a point, replace the star entry by the
unprojection variable @xmath .

In a similar style, Jer @xmath is

  -- -------- -- -------
     @xmath      (2.4)
  -- -------- -- -------

with @xmath arbitrary, and the seven entries @xmath linear combinations
of @xmath . Vaguely, “three constraints on these seven entries”; most
simply, these take the form @xmath , @xmath . We leave you to see this
as the linear projection of @xmath , starting from the hint:

  -- -- -- -------
           (2.5)
  -- -- -- -------

that is, on the right, take @xmath minors of the three square faces out
of @xmath , together with the “diagonal” minors @xmath , then replace
the star by an unprojection variable. Compare ( 9.6 ).

### 2.3 General conclusions

###### Definition 2.2

Tom @xmath and Jer @xmath are matrix formats that specify unprojection
data, namely a codimension 3 scheme @xmath defined by a @xmath Pfaffian
ideal, containing a codimension 4 complete intersection @xmath . Given a
regular sequence @xmath in a regular ambient ring @xmath generating the
ideal @xmath , the ideal of @xmath is generated by the Pfaffians of a
@xmath skew matrix @xmath with entries in @xmath , subject to the
conditions

    Tom @xmath : the 6 entries @xmath for all @xmath ; in other words,
    the 4 entries @xmath of the @xmath th row and column are free
    choices, but the other entries of @xmath are required to be in
    @xmath . See ( 4.6 ) for an example.

    Jer @xmath : the 7 entries @xmath if either @xmath or @xmath equals
    @xmath or @xmath . See ( 4.7 ) for an example. The bound entries are
    the pivot @xmath and the two rows and columns through it. The 3 free
    entries are the Pfaffian partners @xmath , @xmath , @xmath of the
    pivot, where @xmath . In @xmath , the pivot vanishes twice on @xmath
    .

Case I in 2.1 is the ancestor of our Tom constructions and II that of
Jerry. Our main aim in what follows is to work out several hundred
applications of the same formalism to biregular models of Fano 3-folds,
when our “constraints”

  -- -------- -- -------
     @xmath      (2.6)
  -- -------- -- -------

are not linear, do not necessarily reduce to a simple normal form, and
display a rich variety of colourful and occasionally complicated
behaviour.

Nevertheless, the same general tendencies recur again and again. Tom
tends to be fatter than Jerry. Jerry tends to have a singular locus of
bigger degree than Tom, and the unprojected varieties @xmath have
different topologies, in fact different Euler numbers. For example,
@xmath in Case I has two lines of transversal nodes; the @xmath in
Case II has three nodes. If we only look at 3-folds in 2.1 (cutting
@xmath by a hyperplane), the unprojected varieties @xmath are then the
familiar del Pezzo 3-folds of index 2, namely the flag manifold of
@xmath versus @xmath ; see Section 7 (especially Remark 7.2 ) for the
number of nodes (2 and 3 in the two cases) via enumerative geometry. Tom
equations often relate to extensions of @xmath such as the
“extrasymmetric @xmath format”; Jerry equations often relate to
extensions of @xmath such as the “rolling factors format” (an
anticanonical divisor in a scroll) or the “double Jerry format”; Section
9 gives a brief discussion.

## 3 The main result

### 3.1 Numerical data of Fano 3-folds

Let @xmath be a Fano @xmath -fold. As explained in [ ABR ] , the
numerical data of @xmath consists of an integer genus @xmath plus a
basket @xmath of terminal cyclic orbifold points; this data determines
the Hilbert series @xmath of @xmath , and is equivalent to it. At
present we only treat cases when the ring is generated as simply as
possible, and not (say) cases that fall in a monogonal or hyperelliptic
special case. The database [ GRDB ] lists cases of small codimension,
including 145 candidate cases in codimension 4 from Altınok’s thesis [
A0 ] . We sometimes say Fano 3-fold to mean numerical candidate; the
abuse of terminology is fairly harmless, because practically all the
candidates in codimension @xmath (possibly all of them) give rise to
quasismooth Fano 3-folds; in fact usually more than one family, as we
now relate.

### 3.2 Type I centre and Type I projection

An orbifold point @xmath of type @xmath with @xmath is a Type I centre
if its orbinates are restrictions of global forms @xmath , @xmath ,
@xmath of the same weight. The condition means that after projecting,
the exceptional locus of the projection is a weighted projective plane
@xmath that is embedded projectively normally.

One may view a projection @xmath in simple terms: in geometry, as the
map @xmath analogous to linear projection @xmath from centre @xmath ; or
in algebra, as eliminating a variable, corresponding to passing to a
graded subring @xmath ; to be clear, the distinguishing characteristic
is not the eliminated variable @xmath , rather the point @xmath and the
complementary system of variables @xmath that vanish there.

We take the more sophisticated view of [ CPR ] , 2.6.3 of a projection
as an intrinsic biregular construction of Mori theory; namely a diagram

  -- -------- -- -------
     @xmath      (3.1)
  -- -------- -- -------

consisting of an extremal extraction @xmath centred at @xmath followed
by the anticanonical morphism @xmath . In more detail, we have the
following result.

###### Lemma 3.1

The Type I assumption implies that @xmath is semiample. The
anticanonical morphism @xmath contracts only curves @xmath with @xmath
meeting the exceptional divisor @xmath transversely in one point.

#### Proof

A theorem of Kawamata [ Ka ] (discussed also in [ CPR ] , 3.4.2) says
that the @xmath weighted blowup @xmath is the unique Mori extremal
extraction whose centre meets the @xmath orbifold point @xmath . It has
exceptional divisor the weighted plane @xmath with discrepancy @xmath .
Thus @xmath , and the anticanonical ring of @xmath consists of forms of
weight @xmath in @xmath vanishing to order @xmath on @xmath . The
homogenising variable @xmath of degree @xmath with @xmath does not
vanish at all, so is eliminated. By assumption, the orbinates @xmath at
@xmath are global forms of weights @xmath vanishing to order exactly
@xmath , so these extend to regular elements of @xmath . Locally at
@xmath , appropriate monomials in @xmath base the sheaves @xmath modulo
any power of the maximal ideal @xmath , so we can adjust the remaining
generators @xmath of @xmath to vanish to order @xmath , and so they lift
to @xmath . It follows that @xmath is semiample and the anticanonical
morphism @xmath takes @xmath isomorphically to @xmath . @xmath

In our cases, @xmath contracts a nonempty finite set of flopping curves
to singular points of @xmath on @xmath , and @xmath is a codimension 3
Fano 3-fold. The anticanonical model @xmath is not @xmath -factorial
because the divisor @xmath is not @xmath -Cartier. It is the midpoint of
a Sarkisov link (compare [ CPR ] , 4.1 (3)); we develop this idea in
Part II. The ideal case is when each @xmath is a copy of @xmath with
normal bundle @xmath , or equivalently, @xmath has only ordinary nodes
on @xmath . We prove that this happens generically in all our families.

In other situations, Type I allows @xmath to be an isomorphism,
typically for @xmath of large index. At the other extreme, the Type I
condition on its own does not imply that @xmath is big, and @xmath could
be an elliptic Weierstrass fibration over @xmath , although this never
happens for codimension 4 Fano 3-folds. Also @xmath might contract a
surface to a curve of canonical singularities of @xmath ; then @xmath is
a “bad link” in the sense of [ CPR ] , 5.5. We know examples of this if
@xmath is not required to be @xmath -factorial and prime, but none with
these conditions.

###### Example

Consider the general codimension 2 complete intersection

  -- -------- -- -------
     @xmath      (3.2)
  -- -------- -- -------

The coordinate point @xmath is necessarily contained in @xmath : near
it, the two equations @xmath and @xmath express @xmath and @xmath as
implicit functions of the other variables, so that @xmath is locally the
orbifold point @xmath with orbinates @xmath .

Eliminating @xmath from @xmath projects @xmath birationally to the
hypersurface @xmath . Note that @xmath contains the plane @xmath , and
has in general @xmath ordinary nodes at the points @xmath of @xmath .

In this case, the Kustin–Miller unprojection of the “opposite” divisor
@xmath completes the 2-ray game on @xmath to a Sarkisov link, in the
style of Corti and Mella [ CM ] : the flop @xmath blows this up to a
@xmath -Cartier divisor, and the unprojection variable @xmath then
contracts it to a nonorbifold terminal point @xmath .

### 3.3 Main theorem

Write @xmath for the numerical type of a codimension 4 Fano 3-fold of
index 1 marked with a Type I centre. There are 115 or 116 candidates for
@xmath (depending on how you count the initial case); some have two or
three centres, and treating them separately makes 162 cases for @xmath .

###### Theorem 3.2

Let @xmath be as above; then the projected variety is realised as a
codimension @xmath Fano @xmath , and @xmath can be made to contain a
coordinate stratum @xmath of @xmath in several ways.

For every numerical case @xmath , there are several formats, at least
one Tom and one Jerry (see Definition 2.2 ) for which the general @xmath
only has nodes on @xmath , and unprojects to a quasismooth Fano @xmath
-fold @xmath . In different formats, the resulting @xmath have different
numbers of nodes on @xmath , so that the unprojected quasismooth
varieties @xmath have different Betti numbers. Therefore in each of the
@xmath numerical cases for @xmath , the Hilbert scheme has at least two
components containing quasismooth Fano @xmath -folds.

### 3.4 Discussion of the result

The theorem constructs around 320 different families of quasismooth Fano
@xmath -folds. We do not burden the journal pages with the detailed
lists, the Big Table in the Graded Ring Database [ GRDB ] ; the case
worked out in Section 4 may be adequate for most readers. Our data and
the software tools for manipulating them are available from [ GRDB ] .

Our 162 cases for @xmath project to @xmath ; of the 69 codimension 3
families of Fanos @xmath that are @xmath Pfaffians, 67 are the images of
projections, each having up to four candidate planes @xmath . For each
of the 162 candidate pairs @xmath , we study 5 Tom and 10 Jerry formats,
of which at least one Tom and one Jerry succeeds (often one more,
occasionally two), so that Theorem 3.2 describes around 450
constructions of pairs @xmath of quasismooth Fano @xmath -folds with
marked centre of projection, giving around 320 different families of
@xmath .

Theorem 3.2 covers codimension 4 Fano 3-folds of index 1 for which there
exists a Type I centre. If one believes the possible conjecture raised
in [ ABR ] , 4.8.3 that every Fano 3-fold in the Mori category (that is,
with terminal singularities) admits a @xmath -smoothing, this also
establishes the components of the Hilbert scheme of codimension 4 Fano
3-folds in these numerical cases. The main novelty of this paper (and
this was a big surprise to us) is that in every case, the moduli space
has 2, 3 or 4 different components.

An important remaining question is which @xmath are prime. In some
cases, our Tom or Jerry matrices have a zero entry, possibly after
massaging. Then 3 of the Pfaffian equations are binomial, which implies
that @xmath has class group of rank @xmath . This happens in the
ancestral examples of Section 2 and the easier cases 4.2 – 4.3 of
Section 4 . Our Big Table confirms that if we set aside all these cases
with a zero, each of our numerical possibilities for Type I centres
@xmath admits exactly one Tom and one Jerry construction that is
potentially prime. Compare Takagi’s cases discussed in Section 1 . We
return to this question in Part II.

### 3.5 Flowchart

Our proof in Sections 5 – 8 applies computer algebra calculations and
verifications to a couple of thousand cases; any of these could in
principle be done by hand. We go to the database for candidates for
@xmath , figure out the weights of the coordinates of @xmath and the
matrix of weights, and list all inequivalent Tom and Jerry formats.
Section 5 gives criteria for a format to fail. In the cases that pass
these tests, Section 6 contains an algorithm to produce @xmath in the
given format, and to prove that it has only allowed singularities (that
is, only nodes on @xmath ). Section 7 contains the Chern class
calculation for the number of nodes, so proving that the different
constructions build topologically distinct varieties. Section 8 gives
“quick start-up” instructions; do not under any circumstances read the
           README           file.

### 3.6 Further outlook

The reducibility phenomenon appearing in this paper is characteristic of
Gorenstein in codimension 4; we have several current preprints and work
in progress addressing different aspects of this. See for example [ Ki ]
.

This paper concentrates on 115 numerical cases of codimension 4 Fano
3-folds of index 1. Most of the remaining numerical cases from Altınok’s
list of 145 [ A0 ] can be studied in terms of more complicated Type II
or Type IV unprojections, when the unprojection divisor is not
projectively normal; see [ Ki ] for an introduction. We believe that
codimension 5 is basically similar: most cases have two or more Type I
centres that one can project to smaller codimension, leading to parallel
unprojection constructions.

The methods of this paper apply also to other categories of varieties,
most obviously K3 surfaces and Calabi–Yau 3-folds. K3 surfaces are
included as general elephants @xmath in our Fano 3-folds, although the
K3 is unobstructed, so that passing to the elephant hides the
distinction between Tom and Jerry. We can also treat some of the Fano
3-folds of index @xmath of Suzuki’s thesis [ S ] , [ BS ] ; we have
partial results on the existence of some of these families, and hope
eventually to cover the cases not excluded by Prokhorov’s birational
methods [ Pr ] .

This paper uses Type I projections @xmath to study the biregular
question of the existence and moduli of @xmath ; however, in each case,
the Kawamata blowup @xmath initiates a 2-ray game on @xmath , with the
anticanonical model @xmath and its flop @xmath as first step. In many
cases, we know how to complete this to a Sarkisov link using Cox rings,
in the spirit of [ CPR ] , [ CM ] , [ BCZ ] and [ BZ ] ; we return to
this in Part II.

## 4 Extended example

The case @xmath plus basket @xmath gives the codimension 4 candidate
@xmath with Hilbert numerator

  -- -------- -- -------
     @xmath      (4.1)
  -- -------- -- -------

It has three different possible Type I centres, namely the @xmath ,
@xmath or @xmath points. We project away from each of these, obtaining
consistent results; each case leads to four unprojection constructions
for @xmath , two Toms and two Jerries:

    from @xmath : gives @xmath with matrix of weights

      -- -------- -- -------
         @xmath      (4.2)
      -- -------- -- -------

    from @xmath : gives @xmath with matrix of weights

      -- -------- -- -------
         @xmath      (4.3)
      -- -------- -- -------

    from @xmath : gives @xmath with matrix of weights

      -- -------- -- -------
         @xmath      (4.4)
      -- -------- -- -------

Specifically, we assert that in each of these 12 cases, if we pour
general elements of the ideal @xmath and general elements of the ambient
ring into the Tom or Jerry matrix @xmath as specified in Definition 2.2
, the Pfaffians of @xmath define a Fano @xmath -fold @xmath having only
the stated number of nodes on @xmath , and the resulting @xmath is
quasismooth. Section 6 verifies this claim by cheap computer algebra,
although we work out particular cases here without such assistance.
Section 7 computes the number of nodes in each case from the numerical
data. Imposing the unprojection plane @xmath on the general quasismooth
@xmath introduces singularities on @xmath , nodes in general, which are
then resolved on the quasismooth @xmath . Each node thus gives a
conifold transition, replacing a vanishing cycle @xmath by a flopping
line @xmath , and therefore adds 2 to the Euler number of @xmath ; so
the four different @xmath have different topology.

The unprojection formats and nonsingularity algorithms establish the
existence of four different families of quasismooth Fano 3-folds @xmath
. The rest of this section analyses these in reasonably natural formats;
an ideal would be to free ourselves from unprojection and computer
algebra, although we do not succeed completely.

For illustration, work from @xmath ; take @xmath , and assume that
@xmath is a Type 1 centre on @xmath of type @xmath . The assumption
means that @xmath is quasismooth with orbinates @xmath . The cone over
@xmath is thus a manifold along the @xmath -axis, and therefore, by the
implicit function theorem, four of the generators of @xmath form a
regular sequence locally at @xmath , with independent derivatives, say
@xmath , @xmath , @xmath , @xmath of degrees @xmath . Eliminating @xmath
gives the Type I projection @xmath where @xmath has Hilbert numerator

  -- -------- -- -------
     @xmath      (4.5)
  -- -------- -- -------

Let @xmath be a @xmath Pfaffian matrix with weights as in ( 4.2 ). Since
rows 2 and 3 have the same weights, we can interchange the indices 2 and
3 throughout; thus Tom @xmath is equivalent to Tom @xmath , Jer @xmath
to Jer @xmath , and so on.

### 4.1 Failure

Some Tom and Jerry cases fail, either for coarse or for more subtle
reasons; for example, it sometimes happens that for reasons of weight,
one of the variables @xmath cannot appear in the matrix, so the variety
is a cone, which we reject. Section 5 discusses failure systematically.

In the present case @xmath , the generators of @xmath all have weight
@xmath , but @xmath . Thus requiring @xmath forces them to be zero,
making the Pfaffians @xmath and @xmath reducible. This kills Tom @xmath
, Tom @xmath , Jer @xmath for any @xmath and Jer @xmath . The same
argument says that Tom @xmath has @xmath and Jer @xmath has @xmath , a
key simplification in treating them: a zero in @xmath makes three of the
Pfaffians binomial.

We see below that Jer @xmath fails for an interesting new reason. The
other cases all work, as we could see from the nonsingularity algorithm
of Section 6 . Tom @xmath and Jer @xmath are simpler, and we start with
them, whereas Tom @xmath and Jer @xmath involve heavier calculations;
they are more representative of constructions that possibly lead to
prime @xmath .

### 4.2 Tom@xmath

The analysis of the matrix proceeds as:

  -- -------- -- -------
     @xmath      (4.6)
  -- -------- -- -------

here @xmath is forced by low degree, @xmath , @xmath , @xmath , @xmath
are general forms of the given degrees, that we can treat as tokens
(independent indeterminates), and the four entries @xmath are general
elements of @xmath that we write @xmath by choice of coordinates. Next,
@xmath can be whittled away to 0 by successive row-column operations
that do not harm the remaining format; seeing this is a “crossword
puzzle” exercise that uses the fact that @xmath and all the entries in
Row 2 are general forms. For example, subtracting a suitable multiple of
Row 1 from Row 5 (and then the same for the columns) kills the @xmath in
@xmath , while leaving @xmath and @xmath unchanged (because @xmath ) and
modifying @xmath by a multiple of @xmath , which is harmless because
@xmath is just a general ring element of weight 5.

The two zeros imply that all the Pfaffians are binomial, and, as in 2.2
, putting in the unprojection variable @xmath of weight 4 gives the
@xmath minors of the matrix on the right. The equations describe @xmath
inside the projective cone over @xmath with vertex @xmath as the
complete intersection of three general forms of degree @xmath expressing
@xmath in terms of the other variables. (It is still considerably easier
to do the nonsingularity computation after projecting to smaller
codimension.)

### 4.3 Jer@xmath

We start from

  -- -------- -- -------
     @xmath      (4.7)
  -- -------- -- -------

where @xmath is forced by low degree, and we put tokens @xmath in place
of the free entries @xmath . We have cleaned out @xmath and @xmath as
much as we can; the quantities @xmath are general ring elements of the
given weights.

We have to adjoin @xmath together with unprojection equations for @xmath
. There are various ways of doing this, including the systematic method
of writing out the Kustin–Miller homomorphism between resolution
complexes, that we use only as a last resort. An ad hoc parallel
unprojection method is to note that @xmath appears only as the entry
@xmath , so we can project it out to a codimension 2 c.i. containing the
plane @xmath :

  -- -------- -- -------
     @xmath      (4.8)
  -- -------- -- -------

The equations for @xmath come from Cramer’s rule, and we can write the
unprojection in rolling factors format:

  -- -------- -- -------
     @xmath      (4.9)
  -- -------- -- -------

The first set of equations of ( 4.9 ), with the entries viewed as
indeterminates, defines @xmath ; the second set is a single quadratic
form evaluated on the rows, so defines a divisor in the cone over this
with vertex @xmath . Finally, setting @xmath general forms gives @xmath
as a complete intersection in this.

### 4.4 Jer@xmath fails

The matrix has the form

  -- -------- -- --------
     @xmath      (4.10)
  -- -------- -- --------

The entries in the rows and columns through the pivot @xmath are general
elements of the ideal @xmath . As before, @xmath is forced by degrees.
Although 5.2 , (5) fails this for a mechanical reason, we discuss it in
more detail as an instructive case, giving a perfectly nice construction
of the unprojected variety @xmath , that happens to be slightly too
singular. First, please check that the entry @xmath can be completely
taken out by row and column operations. For example, to get rid of the
@xmath term in @xmath , add @xmath times Row 3 to Row 5; in @xmath this
changes @xmath to @xmath , that we rename @xmath .

One sees that the equations of the unprojected variety @xmath take the
form

  -- -------- -- --------
     @xmath      (4.11)
  -- -------- -- --------

(exercise, hint: project out @xmath or @xmath ). In straight projective
space, these equations define @xmath where @xmath is the quadric cone.
This is singular in codimension 2, so the 3-fold @xmath cannot have
isolated singularities.

### 4.5 Tom@xmath

The matrix and its clean form are

  -- -------- -- --------
     @xmath      (4.12)
  -- -------- -- --------

where @xmath and @xmath are general forms, that we treat as tokens. We
add a multiple of Column 2 to Column 5 to clear @xmath from @xmath , so
we cannot use the same operation to clear @xmath from @xmath . The
nonsingularity algorithm of Section 6 ensures that for general choices
this has only nodes on @xmath .

We show how to exhibit @xmath as a triple parallel unprojection from a
hypersurface in the product of three codimension 2 c.i. ideals (compare
9.1 ). Since @xmath only appears as @xmath , it is eliminated by writing
the two Pfaffians @xmath and @xmath as:

  -- -------- -- --------
     @xmath      (4.13)
  -- -------- -- --------

in the same way, @xmath and @xmath eliminate @xmath :

  -- -------- -- --------
     @xmath      (4.14)
  -- -------- -- --------

Cramer’s rule applied to these gives the unprojection equations for
@xmath :

  -- -------- -- --------
     @xmath      (4.15)
  -- -------- -- --------

The combination eliminating @xmath , @xmath and @xmath is

  -- -------- -- --------
     @xmath      (4.16)
  -- -------- -- --------

This is a hypersurface @xmath contained in the product ideal of @xmath ,
@xmath , @xmath . The unprojection planes @xmath , @xmath , @xmath are
projectively equivalent to @xmath , @xmath , @xmath , but we cannot
normalise all three of them to coordinate planes at the same time. Their
pairwise intersection is:

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
     @xmath   @xmath   
  -- -------- -------- --

#### Nonsingularity based on (4.16)

All the assertions we need for @xmath and @xmath are most simply derived
from ( 4.16 ). The linear system @xmath of hypersurfaces through the
three unprojection planes has base locus the planes themselves, together
with the curve @xmath , which is in the base locus because the term
@xmath has degree 11 and so does not appear in the equation of @xmath .
This curve is a pair of generating lines @xmath . One sees that for
general choices, one of the terms @xmath or @xmath in @xmath provides a
nonzero derivative @xmath or @xmath at every point along this curve away
from the three planes.

The singular locus of @xmath on @xmath is given by

  -- -------- -- --------
     @xmath      (4.17)
  -- -------- -- --------

For general choices, these are @xmath reduced points of @xmath ,
including the 4 points of @xmath and the 3 points of @xmath ; after
unprojecting @xmath and @xmath , this leaves 14 nodes of Tom @xmath , as
we asserted in ( 4.2 ). The calculations for the other planes are
similar.

We believe that @xmath has class group @xmath generated by the
hyperplane section @xmath and the three planes @xmath , @xmath , @xmath
, so that @xmath is prime.

### 4.6 Jer@xmath

The tidied up matrix is

  -- -------- -- --------
     @xmath      (4.18)
  -- -------- -- --------

with pivot @xmath ; we use row and column operations and changes of
coordinates in @xmath to clean @xmath and @xmath out of @xmath , but we
cannot modify the pivot @xmath without introducing multiples of @xmath
into Row 4 or Row 5, spoiling the Jer @xmath format.

We get parallel unprojection constructions for @xmath by eliminating
@xmath or @xmath or both. First, subtract @xmath times Row 2 from Row 4,
and ditto with the columns, to take @xmath out of @xmath . This spoils
the format by @xmath in @xmath , but does not change the Pfaffian ideal.
The new matrix only contains @xmath in @xmath ; the two Pfaffians not
involving it are @xmath and the modified @xmath , giving

  -- -------- -- --------
     @xmath      (4.19)
  -- -------- -- --------

Eliminating @xmath is similar, with @xmath and modified @xmath giving

  -- -------- -- --------
     @xmath      (4.20)
  -- -------- -- --------

We derive the unprojection equations for @xmath using Cramer’s rule:

  -- -------- -- --------
     @xmath      (4.21)
  -- -------- -- --------

This is also a triple parallel unprojection, but with a difference: the
hypersurface @xmath obtained by eliminating @xmath from ( 4.19 ) or
@xmath from ( 4.20 ) or @xmath from the first two rows of ( 4.21 ) is
now

  -- -------- -- --------
     @xmath      (4.22)
  -- -------- -- --------

It is in the intersection of the three codimension 2 c.i. unprojection
ideals @xmath , @xmath , @xmath , but not in their product: the first 4
terms are clearly in the product ideal. The interesting part is the
bracket in the last term, which cannot be in the product since it has
terms of degree 2, but is in @xmath , because

  -- -------- -- --------
     @xmath      (4.23)
  -- -------- -- --------

The slogan is like lines on a quadric ; the three ideals have linear
combinations of @xmath as first generator, and of @xmath as second
generator, like three disjoint lines @xmath , @xmath and @xmath on
@xmath . One analyses the singularities of @xmath from this much as
before; we believe that @xmath , so that the triple unprojection @xmath
is prime.

## 5 Failure

We give reasons for failure following the introductory discussion in
Section 4 ; we don’t need to treat all the possible tests in rigorous
detail, or the logical relations between them. For the structure of our
proof, the point of this section is merely to give cheap preliminary
tests to exclude all the candidates @xmath that will not pass the
nonsingularity algorithm in Section 6 .

### 5.1 Easy fail at a coordinate point

Consider a coordinate point @xmath . In either of the following cases,
@xmath cannot be a hyperquotient point, let alone terminal, and we can
safely fail the candidate @xmath :

1.  @xmath does not appear in the matrix @xmath .

2.  @xmath does not appear as a pure power in any entry of @xmath ,
    which thus has rank zero at @xmath .

### 5.2 Fishy zero in @xmath and excess singularity

Suppose we can arrange that @xmath , if necessary after row and column
operations; then the subscheme @xmath is in the singular locus of @xmath
. Indeed, the three Pfaffians @xmath are in @xmath , so do not
contribute to the Jacobian at points of @xmath . The case that @xmath
and @xmath is perfectly acceptable and happens in a fraction of our
successful constructions (see Tom @xmath and Jer @xmath in Section 4 ).
Notice that @xmath if and only if the 6 forms @xmath make up a regular
sequence for @xmath ; in the contrary case, the zero is fishy . Thus any
little coincidence between the six @xmath fails @xmath . The tests we
implement are:

1.  Two collinear zeros in @xmath ; see 4.1 for an example.

2.  Two of the @xmath coincide; see Section 4 , Jer @xmath .

3.  An entry @xmath or @xmath is in the ideal generated by the other
    five.

In fact, the tricky point here is how to read our opening “Suppose we
can arrange that @xmath ”. The row and column operations clearly need a
modicum of care to preserve the format (i.e., the entries we require to
be in @xmath ). The harder point is that we may need a particular change
of basis in @xmath for the zero to appear. For example, in the Tom
@xmath format for @xmath , with matrix of weights @xmath , the lowest
degree Pfaffian is quadratic in three variables of weight 1, so we can
write it @xmath . Mounting this as a Pfaffian in these coordinates, we
can force a fishy zero, with two equal entries @xmath arising from the
term @xmath . (The same applies to several candidates, but this is the
only one that fails solely for this reason.)

### 5.3 More sophisticated and ad hoc reasons for failure

For the unprojected @xmath to have terminal singularities, @xmath itself
must also: it is the anticanonical model of the weak Fano 3-fold @xmath
. We can test for this at a coordinate point @xmath of index @xmath : by
Mori’s classification, @xmath is either quasismooth at @xmath , or a
hyperquotient singularity with local weights @xmath or @xmath . Thus we
can fail the candidate @xmath if:

1.  A coordinate point off @xmath is a nonterminal hyperquotient
    singularity.

2.  A coordinate point on @xmath is a nonterminal hyperquotient
    singularity.

These tests dispatch most of the remaining failing candidates.

1.  Ad hoc fail. Just two cases have nonisolated singularities not
    revealed by the elementary tests so far:

    1.  Tom @xmath for @xmath with weights @xmath ;

    2.  Jer @xmath for @xmath with weights @xmath .

    Each of these has a @xmath hyperquotient singularity at the @xmath
    point of @xmath . Such a point may be terminal if it is an isolated
    double point, but the format of the matrix prevents this. The second
    case also fails at the index 4 point @xmath lying off @xmath : it is
    a hyperquotient singularity of the exceptional type @xmath with the
    right quadratic part to be terminal. However, it lies on a curve of
    double points along the line @xmath joining @xmath to the @xmath
    point on @xmath : in local coordinates @xmath at @xmath , the
    equation is @xmath .

## 6 Nonsingularity and proof of Theorem 3.2

To prove Theorem 3.2 , we need to run through a long list of candidate
3-folds @xmath with choice of format Tom @xmath or Jer @xmath . We
exclude many of these by the automatic methods of Section 5 . In every
remaining case, we run a nonsingularity algorithm to confirm that the
candidate can be unprojected to a codimension 4 Fano 3-fold @xmath with
terminal singularities (in fact, we conclude also quasismooth). For the
proof of Theorem 3.2 , we check that at least one Tom and one Jerry
works for each case @xmath .

We outline the proof as a pseudocode algorithm; our implementation is
discussed in Section 8 . The justification of the algorithm is that it
works in practice. A priori, it could fail, e.g., the singular locus of
@xmath on @xmath could be more complicated than a finite set of nodes,
or all three coordinate lines of @xmath could contain a node, but by
good luck such accidents never happen.

### 6.1 Nonsingularity analysis

We work with any @xmath not failed in Section 5 . The homogeneous ideal
@xmath is generated by the @xmath Pfaffians of @xmath . Differentiating
the 5 equations @xmath with respect to the seven variables gives the
@xmath Jacobian matrix @xmath . Its ideal @xmath of @xmath minors
defines the singular locus of @xmath ; more precisely, it generates the
ideal sheaf @xmath . Our claim is that the only singularities of @xmath
lie on @xmath , and are nodes. For this, we check that

1.  @xmath , or equivalently @xmath .

2.  The restriction @xmath defines a reduced subscheme of @xmath .

In fact (b) together with Lemma 7.1 imply that @xmath has only nodes. In
practice, we may work on a standard affine piece of @xmath containing
all the singular points: it turns out in every case that some 1-strata
of @xmath is disjoint from the singular locus.

### 6.2 Proof of Theorem 3.2

We start with the data for a candidate @xmath : a genus @xmath and a
basket @xmath of terminal quotient singularities, or equivalently, the
resulting Hilbert series (see [ ABR ] ). We give a choice of 8 ambient
weights @xmath of @xmath and a choice of Type I centre @xmath from the
basket. The Type I definition predicts that the ambient weights of
@xmath are @xmath and that @xmath can be chosen to be a coordinate
stratum of @xmath . We analyse all possible Tom and Jerry formats for
@xmath .

#### Step 1

Set up coordinates @xmath , @xmath on @xmath ; here @xmath is a regular
sequence generating @xmath , and @xmath are coordinates on @xmath .

#### Step 2

The numerics of [ CR ] determine the weights @xmath of the @xmath skew
matrix @xmath from the Hilbert numerator of @xmath .

#### Step 3

Set each entry @xmath of @xmath equal to a general form, respectively a
general element of the ideal @xmath of the given degree @xmath ,
according to the chosen Tom or Jerry format (see Definition 2.2 ).

Tidy up the matrix @xmath as much as possible while preserving its Tom
or Jerry format. Some entries of @xmath may already be zero. Use
coordinate changes on @xmath to set some entries of @xmath equal to
single variables. If possible, use row and column operations to simplify
@xmath further. Check every zero of @xmath for failure for the
mechanical reasons discussed in 5.2 , followed by the other failing
conditions of 5.1 . Now any candidate that passes these tests actually
works.

#### Step 4

Carry out the singularity analysis of 6.1 .

#### Step 5

Calculate the number of nodes as in Section 7 ; check that no two sets
of unprojection data give the same number of nodes.

#### Step 6 (optional)

Apply the Kustin–Miller algorithm [ KM ] to construct the equations of
@xmath . This is not essential to prove that @xmath exists, but knowing
the full set of equations is useful if we want to put the equations in a
codimension 4 format, for example by projecting from another Type I
centre.

## 7 Number of nodes

The unprojection divisor @xmath is a codimension 4 c.i., with conormal
bundle @xmath the direct sum of four orbifold line bundles @xmath on
@xmath . The ideal sheaf @xmath is generated by 5 Pfaffians that vanish
on @xmath , so each is @xmath . Thus the Jacobian matrix @xmath
restricted to @xmath is the @xmath matrix @xmath , where bar is
restriction mod @xmath ; the induced homomorphism to the conormal bundle

  -- -------- -- -------
     @xmath      (7.1)
  -- -------- -- -------

has generic rank 3. Its cokernel @xmath is the conormal sheaf to @xmath
in @xmath . It is a rank 1 torsion free sheaf on @xmath whose second
Chern class @xmath counts the nodes of @xmath on @xmath . The more
precise result is as follows:

###### Lemma 7.1

1.   The cokernel @xmath is an orbifold line bundle at points of @xmath
    where @xmath , that is, at quasismooth points of @xmath .

2.   Assume that @xmath is a nonsingular point (not orbifold), and that
    @xmath at @xmath and @xmath in a punctured neighbourhood of @xmath
    in @xmath ; then @xmath is isomorphic to a codimension @xmath
    c.i. ideal @xmath locally at @xmath . This coincides locally with
    the ideal @xmath generated by the @xmath minors of the Jacobian
    matrix.

3.   Assume that @xmath is reduced (locally the maximal ideal @xmath at
    each point). Then @xmath has an ordinary node at @xmath .

4.   If this holds everywhere then @xmath is the number of nodes of
    @xmath on @xmath .

#### Proof

The statement is the hard part; the proof is just commutative algebra
over a regular local ring. The rank 1 sheaf @xmath is the quotient of a
rank 4 locally free sheaf by the image of the @xmath matrix @xmath , of
generic rank 3. It is a line bundle where the rank is 3, and where it
drops to 2, we can use a @xmath nonsingular block to take out a rank 2
locally free summand. The cokernel is therefore locally generated by 2
elements, so is locally isomorphic to an ideal sheaf @xmath , a
c.i. because the rank drops only at @xmath .

The minimal free resolution of @xmath is the Koszul complex of @xmath ;
now ( 7.1 ) is also part of a free resolution of @xmath , so covers the
Koszul complex. This means that the matrix @xmath can be written as its
@xmath nonsingular block and a complementary @xmath block of rank 1,
whose two rows are @xmath and @xmath for @xmath a 3-vector with entries
generating the unit ideal. Therefore @xmath generates the same ideal
@xmath .

If @xmath is the maximal ideal at @xmath then the shape of @xmath says
that two of the Pfaffians @xmath express two of the variable @xmath as
implicit functions; then a linear combination @xmath of the remaining
three has @xmath and @xmath , so that @xmath is a hypersurface with an
ordinary node at @xmath . @xmath

We now show how to resolve @xmath by an exact sequence involving direct
sums of orbifold line bundles on @xmath , and deduce a formula for
@xmath .

#### Tom@xmath

The matrix is

  -- -------- -- -------
     @xmath      (7.2)
  -- -------- -- -------

where @xmath are linear forms in @xmath with coefficients in the ambient
ring. When we write out @xmath , the only terms that contribute are the
derivatives @xmath , with the @xmath set to zero; thus only the terms
that are exactly linear in the @xmath contribute. Since @xmath is of
order @xmath in the @xmath , the corresponding row of the matrix @xmath
is zero and we omit it in ( 7.3 ). Moreover, the first row @xmath of
@xmath provides a syzygy @xmath between the 4 remaining Pfaffians. Hence
we can replace @xmath by the resolution

  -- -------- -- -------
     @xmath      (7.3)
  -- -------- -- -------

where @xmath , @xmath and @xmath , and leave the reader to think of
names for the maps. Therefore @xmath has total Chern class

  -- -------- -- -------
     @xmath      (7.4)
  -- -------- -- -------

The number of nodes @xmath is then the @xmath term in the expansion of (
7.4 ); recall that we view @xmath as an orbifold class, so that @xmath
for @xmath .

#### Jer@xmath

The pivot @xmath appears in three Pfaffians @xmath for @xmath as the
term @xmath , together with two other terms @xmath of order @xmath in
@xmath . The Jacobian matrix restricted to @xmath thus has three
corresponding rows that are @xmath times the same vector @xmath . This
proportionality gives three syzygies @xmath between these three rows,
yoked by a second syzygy @xmath in degree @xmath . In other words, the
conormal bundle has the resolution

  -- -------- -- -------
     @xmath      (7.5)
  -- -------- -- -------

so that the total Chern class of @xmath is the alternate product

  -- -------- -- -------
     @xmath      (7.6)
  -- -------- -- -------

with @xmath equal to the @xmath term in this expansion.

###### Example 7.2

We read the number of nodes mechanically from the Hilbert numerator, the
matrix of weights and the choice of format. As a baby example, the
“interior” projections of the two del Pezzo 3-folds of degree 6
discussed in 2.2 have 2 and 3 respective nodes. These numbers are the
coefficient of @xmath in the formal power series

  -- -------- -- -------
     @xmath      (7.7)
  -- -------- -- -------

As a somewhat more strenuous example, in ( 4.2 ),

    Tom @xmath has @xmath , @xmath , @xmath , so that

      -- -------- --
         @xmath   
      -- -------- --

    Jer @xmath has the same @xmath , @xmath , @xmath , adjunction number
    = 19, @xmath , so @xmath , giving @xmath nodes.

Try the other cases in ( 4.2 )–( 4.4 ) as homework.

## 8 Computer code and the GRDB database

A Big Table with the detailed results of the calculations proving
Theorem 3.2 is online at the Graded Ring Database webpage

                                      http://grdb.lboro.ac.uk                                 
  + Downloads.

This website makes available computer code implementing our calculations
systematically, together with the Big Table they generate. The code is
for the Magma system [ Ma ] , and installation instructions are
provided; at heart, it only uses primary elements of any computer
algebra system, such as polynomial ideal calculations and matrix
manipulations. The code runs online in the Magma Calculator

                                      http://magma.maths.usyd.edu.au/calc                                 

All the data on the codimension 4 Fano 3-folds we construct is available
on webloc. cit.: follow the link to Fano 3-folds, select Fano index
@xmath (the default value), codimension @xmath and Yes for Projections
of Type I, then submit. The result is data on the 116 Fano 3-folds with
a Type I projection (the 116th is an initial case with @xmath
resolution, that projects to the complete intersection @xmath containing
a plane, so is not part of our story here). The @xmath link reveals
additional data on each Fano.

The computer code follows closely the algorithm outlined as the proof of
Theorem 3.2 . For each Tom and Jerry format, we build a matrix with
random entries; some of these can be chosen to be single variables,
since we assume @xmath is general for its format. We use row and column
operations to simplify the matrix further without changing the format.
The first failure tests (fishy zeroes, cone points and points of
embedding dimension 6) are now easy, and inspection of the equations on
affine patches at coordinate points on @xmath is enough to determine
whether their local quotient weights are those of terminal
singularities. An ideal inclusion test checks that the singularities lie
on @xmath . By good fortune, in every case that passes the tests so far,
the singular locus lies on one standard affine patch of @xmath . We pass
to this affine patch and check that @xmath defines a reduced scheme
there. We calculate the length of the quotient @xmath on this patch,
providing an alternative to the computation of Section 7 (and a
comforting sanity check).

The random entries in the matrix are not an issue: our nonsingularity
requirements are open, so if one choice leads to a successful @xmath ,
any general choice also works. The only concern is false negative
reports, for example, an alleged nonreduced singular locus on @xmath .
To tackle such hiccups, if a candidate fails at this stage (in practice,
a rare occurrence), we simply rerun the code with a new random matrix;
the fact that the code happens to terminate justifies the proof.

The conclusion is that every possible Tom and Jerry format for every
numerical Type I projection either fails one of the human-readable tests
of Section 5 (and we have made any number of such hand calculations), or
is shown to work by constructing a specific example.

To complete the proof of Theorem 3.2 , we check that the final output
satisfies the following two properties:

1.  Every numerical candidate admits at least one Tom and one Jerry
    unprojection.

2.  Whenever a candidate has more than one Type I centre, the successful
    Tom and Jerry unprojections of any two correspond one-to-one, with
    compatible numbers of nodes: the difference in Euler number computed
    by the nodes is the same whichever centre we calculate from; compare
    ( 4.2 )–( 4.4 ).

The polynomial ideal calculations of Nonsingularity analysis 6.1 (that
is, the inclusion @xmath and the statement that @xmath is reduced) are
the only points where we use computer power seriously (other than to
handle hundreds of repetitive calculations accurately). In cases with 2
or 3 centres, even this could be eliminated by projecting to a complete
intersection and applying Bertini’s theorem, as in Section 4 .

## 9 Codimension 4 Gorenstein formats

The Segre embeddings @xmath and @xmath are well known codimension 4
projectively Gorenstein varieties with @xmath resolution. Singularity
theorists consider the affine cones over them to be rigid, because they
have no nontrivial infinitesimal deformations or small analytic
deformation. Nevertheless, both are sections of higher dimensional
graded varieties in many different nontrivial ways. Each of these
constructions appears at many points in the study of algebraic surfaces
by graded rings methods.

### 9.1 Parallel unprojection and extrasymmetric format

The extrasymmetric @xmath format occurs frequently, possibly first in
Dicks’ thesis [ D ] . It is a particular case of triple unprojection
from a hypersurface in the product of three codimension 2 c.i. ideals.
Start from the “undeformed” @xmath skew matrix

  -- -------- -- -------
     @xmath      (9.1)
  -- -------- -- -------

with the “extrasymmetric” property that the top right @xmath block is
symmetric, and the bottom right @xmath block equals minus the top left
block. So instead of 15 independent entries, it has only 9 independent
entries and 6 repeats.

Direct computation reveals that the @xmath Pfaffians of @xmath fall
under the same numerics: of its 15 Pfaffians, 9 are independent and 6
repeats. One sees they generate the same ideal as the @xmath minors of
the @xmath matrix

  -- -------- -- -------
     @xmath      (9.2)
  -- -------- -- -------

Here @xmath is the generic @xmath matrix (written as symmetric plus
skew), with minors defining Segre @xmath , and thus far we have not
gained anything, beyond representing @xmath as a nongeneric section of
@xmath .

However @xmath can be modified to preserve the codimension 4 Gorenstein
property while destroying the sporadic coincidence with @xmath . The
primitive one-parameter way of doing this is to choose the triangle
@xmath and multiply the entries @xmath by a constant @xmath . This gives

  -- -------- -- -------
     @xmath      (9.3)
  -- -------- -- -------

One checks that the three Pfaffians @xmath for @xmath are @xmath times
others, whereas three other repetitions remain unchanged. So the @xmath
Pfaffians of @xmath still defines a Gorenstein codimension 4 subvariety
with @xmath resolution. We can view it as the Tom @xmath unprojection of
the codimension 3 Pfaffian ideal obtained by deleting the final column,
with @xmath as unprojection variable.

If @xmath is a perfect square then floating the square root @xmath to
the complementary entries @xmath restores the original extrasymmetry. In
general this is a “twisted form” of @xmath : changing the sign of @xmath
swaps the two factors.

A more elaborate version of this depends on 8 parameters:

  -- -------- -- -------
     @xmath      (9.4)
  -- -------- -- -------

Now the same three Pfaffians @xmath are divisible by @xmath , and the
complementary three are divisible by @xmath with the same quotient, so
one has to do a little cancellation to see the irreducible component.
The necessity of cancelling these terms (although cheap in computer
algebra as the colon ideal) has been a headache in the theory for
decades, since it introduces apparent uncertainty as to the generators
of the ideal.

The right way to view this is as the triple parallel unprojection of the
hypersurface

  -- -------- -- -------
     @xmath      (9.5)
  -- -------- -- -------

in the product ideal @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

etc., and the ideal is generated by the Pfaffians of the three matrices

  -- -------- --
     @xmath   
  -- -------- --

If the @xmath and @xmath are nonzero constants, one still needs the
square root of the discriminant @xmath to get back to @xmath .

### 9.2 Double Jerry

The equations of Segre @xmath are the minors of a @xmath array; they
admit several extensions, and it seems most likely that there is no
irreducible family containing them all. One family consists of various
“rolling factors” formats discussed below; here we treat “double Jerry”.

Start from the equations written as

  -- -------- -- -------
     @xmath      (9.6)
  -- -------- -- -------

corresponding to a hexagonal view of the cube centred at vertex @xmath
(with three square faces @xmath , and @xmath behind the page, cf. ( 2.5
)):

  -- -- -- -------
           (9.7)
  -- -- -- -------

Eliminating both @xmath and @xmath gives the codimension 2 c.i.

  -- -------- -- -------
     @xmath      (9.8)
  -- -------- -- -------

containing the two codimension 3 c.i.s @xmath and @xmath as divisors. We
can view @xmath as a row vector and @xmath a column vector, and the two
equations ( 9.8 ) as the matrix products

  -- -------- -- -------
     @xmath      (9.9)
  -- -------- -- -------

The unprojection equations for @xmath and @xmath separately take the
form

  -- -------- -- --------
     @xmath      (9.10)
  -- -------- -- --------

where @xmath is cross product of vectors in @xmath , with the convention
that the cross product of two row vectors is a column vector and vice
versa. For example, @xmath , @xmath and the equations @xmath giving the
first line of ( 9.6 ) are deduced via Cramer’s rule from ( 9.8 ).

We can generalise this at a stroke to @xmath general @xmath matrices.
That is, for @xmath a row vector and @xmath a column vector, @xmath is a
codimension 2 c.i.; since these are general bilinear forms in @xmath and
@xmath , it represents a universal solution to two elements of the
product ideal @xmath . It has two single unprojections:

  -- -------- -- --------
     @xmath      (9.11)
     @xmath      (9.12)
  -- -------- -- --------

either of which is a conventional @xmath Pfaffian, and a parallel
unprojection putting those equations together with a 9th long equation

  -- -------- -- --------
     @xmath      (9.13)
  -- -------- -- --------

The equation certainly exists by the Kustin–Miller theorem. It can be
obtained easily in computer algebra by coloning out any of @xmath from
the ideal generated by the eight equations ( 9.11 ) and ( 9.12 ). Its
somewhat amazing right hand side has 144 terms, each bilinear in @xmath
and biquadratic in @xmath . Taking a hint from @xmath , we suspect that
it may have a product structure of the form

  -- -------- -- --------
     @xmath      (9.14)
  -- -------- -- --------

with “ @xmath ” and “ @xmath ” still requiring elucidation.

If the entries of @xmath and @xmath are constants, one gets back to
@xmath after coordinate changes based on the three roots @xmath of the
relative characteristic equation @xmath and the three eigenvectors
@xmath . Swapping the roots permutes the three factors.

The significance of the double Jerry parallel unprojection format is
that it covers any Jerry case where the pivot is one of the generators
of @xmath . Indeed, if the regular sequence generating @xmath is @xmath
, a Jerry matrix for @xmath is

  -- -------- -- --------
     @xmath      (9.15)
  -- -------- -- --------

for some @xmath matrices @xmath . Unprojecting @xmath gives a double
Jerry.

### 9.3 Rolling factors format

Rolling factors view a divisor @xmath on a normal projective variety
@xmath as residual to a nice linear system. This phenomenon occurs
throughout the literature, with typical cases a divisor on the Segre
embedding of @xmath , or on a rational normal scroll @xmath , or on a
cone over a Veronese embedding. A divisor @xmath in the linear system
@xmath is of course defined by a single bihomogeneous equation in the
Cox ring of @xmath , but to get equations in the homogeneous coordinate
ring of Segre @xmath we have to add @xmath . This is a type of
hyperquotient, given by one equation in a nontrivial eigenspace.

Dicks’ thesis [ D ] discussed the generic pseudoformat

  -- -------- -- --------
     @xmath      (9.16)
  -- -------- -- --------

One sees that under fairly general assumptions the “scroll” @xmath
defined by the first set of equations of ( 9.16 ) is codimension 3 and
Cohen–Macaulay, with resolution

  -- -------- --
     @xmath   
  -- -------- --

On the right, the identity is a preliminary condition on quantities in
the ambient ring. If we assume (say) that @xmath is a regular local ring
and @xmath satisfy it (and are “fairly general”), the second set defines
an elephant @xmath (anticanonical divisor) which is a codimension 4
Gorenstein variety with @xmath resolution.

The identity in ( 9.16 ) is a quadric of rank 16. It is a little
close-up view of the “variety of complexes” discussed in [ Ki ] ,
Section 10. To use this method to build genuine examples, we have to
decide how to map a regular ambient scheme into this quadric; there are
several different solutions. If we take the @xmath to be independent
indeterminates, the first set of equations gives the cone on Segre
@xmath , and the second set consists of a single quadratic form @xmath
in 4 variables evaluated on the two rows, so that @xmath is given by
@xmath , with @xmath the associated symmetric bilinear form (cf. ( 4.9
)). This format seems to be the only commonly occurring codimension 4
Gorenstein format that tends not to have any Type I projection.

On the other hand, if there are coincidences between the @xmath , there
may be other ways of choosing the @xmath to satisfy the identity in (
9.16 ) without the need to take @xmath quadratic in the @xmath : for
example, if @xmath , we can roll @xmath and @xmath .