##### Contents

-    1 T-varieties
-    2 Deformations and first order deformations
-    3 Problem setup and main results
-    4 T-varieties and polyhedra
-    5 Deformations
-    6 Schlessinger’s formula for @xmath
-    7 Cech complexes cohomology
-    8 Leray spectral sequence
-    9 Stably dominant morphisms
-    10 Notation and terminology
    -    10.1 List of notation introduced further
-    11 Regularity locus and fiber structure of the map @xmath
-    12 Sufficient systems of open subsets of @xmath
-    13 Computation of @xmath in terms of cohomology of sheaves on
    @xmath
    -    13.1 Computation of @xmath
    -    13.2 Computation of @xmath
    -    13.3 Computation of @xmath
    -    13.4 Computation of @xmath
    -    13.5 Final remarks for the computation of @xmath
-    14 Construction of a particular sufficient system
-    15 Computation of the dimension of @xmath
-    16 Computation of the dimension of @xmath
-    17 Construction of the deformation
-    18 Kodaira-Spencer map for a deformation given by perturbation of
    generators
-    19 Kodaira-Spencer map in the particular case of a deformation of a
    T-variety
-    20 Surjectivity of the Kodaira-Spencer map

## Chapter \thechapter Introduction

### 1 T-varieties

As proved and explained in [ 1 ] , normal affine varieties of dimension
@xmath with a faithful action of a @xmath -dimensional torus @xmath
(which are called T-varieties in the sequel) are described by so-called
proper polyhedral divisors. To define them, consider the character
lattice @xmath , the rational character lattice @xmath , the dual
character lattice @xmath , and the dual vector space (the dual rational
character lattice) @xmath .

A polyhedron in a @xmath -vector space is the nonempty intersection of
finitely many closed affine half-spaces. A particular case of a
polyhedron is a polyhedral cone, a polyhedron is called a polyhedral
cone if it can be obtained as the intersection of finitely many closed
linear half-spaces, i. e. the boundary of all these half-spaces should
contain the origin. If @xmath is a polyhedron in a @xmath -vector space
@xmath , its tail cone is defined as the set of vectors @xmath such that
for all @xmath one has @xmath . It is denoted by @xmath . Fig. 1 shows
an example of a polyhedron and of its tail cone.

All polyhedra in a given @xmath -vector space @xmath with a given tail
cone @xmath form a semigroup with the operation of Minkowski addition.
@xmath is the neutral element. Denote the Grothendick construction for
this semigroup by @xmath .

The next object we need to define to study @xmath -varieties is a
polyhedral divisor. Suppose that we have a normal variety @xmath . A
polyhedral divisor @xmath is an element of the group @xmath , where
@xmath is the group of @xmath -Cartier divisors.

Now we can say that a T-variety is determined by the following data:

1.  A @xmath -dimensional normal (not necessarily affine) variety @xmath
    .

2.  A pointed cone @xmath in the rational dual character lattice @xmath
    .

3.  A proper (see definition below, in Section 4 ) polyhedral divisor
    @xmath .

As we said, the definition of properness in the whole generality will be
given later, but in the case we will need it now, namely when @xmath ,
it is easy to formulate an equivalent condition for properness. Namely,
the polyhedral divisor @xmath on @xmath is proper if and only if it can
be written in the form

  -- -------- --
     @xmath   
  -- -------- --

where @xmath are points, and @xmath are polyhedra (they should be
”genuine” polyhedra, not elements of the Grothendick group), and the
Minkowski sum of all polyhedra @xmath is strictly contained in @xmath .

The construction of a @xmath -variety out of these data will be given in
Section 4 .

### 2 Deformations and first order deformations

For a general reference on deformation theory, see [ 2 ] .

In general, a deformation of a variety @xmath with a scheme @xmath with
a marked point @xmath being the parameter space of the deformation is a
flat morphism @xmath , where @xmath is a scheme, together with an
isomorphism @xmath between @xmath and @xmath . Two deformations @xmath
and @xmath with the same parameter space @xmath and the same marked
point @xmath are called equivalent if there exists an isomorphism @xmath
such that @xmath and @xmath .

A deformation @xmath with a torus action @xmath is called equivariant if
@xmath is @xmath -equivariant and @xmath is @xmath -invariant.

If @xmath is the double point, i. e. @xmath , and @xmath is affine (
@xmath ), then the set of all possible deformations is denoted by @xmath
, and one can define an @xmath -module structure on it. See Section 5
for details.

Deformations can be pulled back from one parameter space to another
using fiber product. In particular, if we have a vector space @xmath ,
then each tangent vector at the marked point defines an embedding of the
double point into @xmath . We can pullback the deformation from @xmath
to the double point and get an element of @xmath . So we get a map from
the tangent space at the marked point to @xmath . In fact, this map is
linear. It is called the Kodaira-Spencer map and is an important
characteristic of the original deformation.

If @xmath is a lattice, and @xmath is an @xmath -graded algebra, then
@xmath actually becomes a graded @xmath -module. Moreover, if @xmath ,
then an @xmath -grading on @xmath is equivalent to a torus action on
@xmath , and the graded component of @xmath of degree zero (it will be
further denoted by @xmath ) contains exactly the equivariant
deformations. (More precisely, @xmath contains the set of deformations
that can be made equivariant by the appropriate choice of a @xmath
-action on @xmath , but such a choice is unique up to an isomorphism of
the deformation.)

### 3 Problem setup and main results

We start with a two-dimensional torus @xmath . We choose a
two-dimensional pointed cone @xmath . Then we fix a proper polyhedral
divisor @xmath on @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

@xmath are arbitrary points, and @xmath are (nonempty) polyhedra with
tail cone @xmath . Additionally, we suppose that all vertices of all
polyhedra @xmath are lattice points. ¹ ¹ 1 The @xmath -varieties
obtained from polyhedral divisors without this ”lattice point” condition
can be obtained from the @xmath -varieties under consideration by taking
the quotient modulo a finite group action. In this case all divisors
@xmath are integral, not rational. The properness condition in this case
means that the Minkowski sum of all polyhedra @xmath is strictly
contained in @xmath . We are going to study the 3-dimensional variety
@xmath with an action of the 2-dimensional torus @xmath defined as above
by @xmath , @xmath , and @xmath . More specifically, we are going to
find the dimension of the space of equivariant first order deformations
of @xmath , and to find a formally versal equivariant deformation space
for @xmath .

The dimension of @xmath is computed in Chapters Equivariant deformations
of algebraic varieties with an action of an algebraic torus of
complexity 1 and Equivariant deformations of algebraic varieties with an
action of an algebraic torus of complexity 1 . The answer is given by
Theorem \thechapter .32 . It can also be formulated as follows.

###### Theorem \thechapter.1.

We maintain the assumptions and the notation introduced above in this
section. The dimension of @xmath is the sum of two summands:

1.   The maximum of 0 and

      -- -------- --
         @xmath   
      -- -------- --

2.   The sum of the amounts of integral points inside the finite part of
    the boundary of @xmath (i. e. the boundary of @xmath except for the
    two rays). For example, if @xmath is a shift of @xmath , then the
    finite part of the boundary is just one vertex, and we count zero.
    If @xmath has one edge, which is a primitive lattice segment, then
    we still count zero since there are no lattice points inside it. But
    if, for example, @xmath has two edges, and both of them are
    primitive lattice segments, then we count one, because the vertex
    between these two edges is inside the finite part of the boundary.

In Chapter Equivariant deformations of algebraic varieties with an
action of an algebraic torus of complexity 1 we find a fromally versal
deformation space for the equivariant deformations of @xmath . The
construction of the total space of this deformation requires more
technical details and will be given in Section 17 , but the parameter
space is just a vector space. In particular, it is smooth, so all
equivariant first order deformations are unobstructed.

To prove that the deformation in question is formally versal, we will
need to compute the Kodaira-Spencer map of a deformation defined by
perturbation of generators of a subalgebra of the polynomial algebra.
See Section 18 for more details. The results about the Kodaira-Spencer
map for such deformations may be of independent interest.

Some of these results were preliminarily announced in an arxiv.org
preprint by the author, [ 3 ] .

## Chapter \thechapter Preliminaries

### 4 T-varieties and polyhedra

We will need an explicit construction of a @xmath -variety out of a
polyhedral divisor.

First, we need one more definition concerning polyhedral cones. If
@xmath is a polyhedral cone in a @xmath -vector space @xmath , its dual
cone is defined as the set of all vectors @xmath such that for all
@xmath one has @xmath .

Now we have to define the evaluation function @xmath as follows: @xmath
for all polyhedra @xmath with tail cone @xmath and for all @xmath . One
checks directly that this function is well-defined on @xmath , that it
is linear in the first argument and is piecewise-linear in the second
argument. If we fix a polyhedron as the first argument (a real
polyhedron, not an element of the Grothendick construction, i. e. @xmath
), then the resulting function is also convex. If this polyhedron is of
the form @xmath , where @xmath , then this function is linear, not just
piecewise-linear. If @xmath is a polyhedron, we shortly call the
function @xmath defined by @xmath the individual evaluation function of
the polyhedron @xmath .

We are going to construct a @xmath -dimensional variety with an action
of a @xmath -dimensional torus @xmath . Suppose that we have a @xmath
-dimensional normal (not necessarily affine) variety @xmath , a pointed
cone @xmath in the rational dual character lattice @xmath , and a
polyhedral divisor @xmath on @xmath .

For every element @xmath , @xmath defines a rational divisor @xmath as
follows. Notice that @xmath can be considered as a function on @xmath .
Let @xmath , where @xmath , @xmath ’s are irreducible hypersurfaces in
@xmath , and @xmath ’s and @xmath ’s are polyhedra with the tail cone
@xmath . We put @xmath .

###### Definition \thechapter.1.

A polyhedral divisor @xmath is called principal , if it can be written
in the form @xmath , where @xmath ’s are rational functions on @xmath
and @xmath .

###### Definition \thechapter.2.

A polyhedral divisor @xmath is called proper , if

1.  It can be written in the form @xmath , where @xmath , efficient
    Cartier divisors in @xmath , and @xmath ’s are polyhedra with the
    tail cone @xmath and @xmath .

2.  For every @xmath , @xmath is semiample, and if @xmath is in the
    interior of @xmath , @xmath is big.

Now, notice that if @xmath , then @xmath is an effective divisor, so a
product of (rational) functions from @xmath and from @xmath is in @xmath
. So we have a graded algebra

  -- -------- --
     @xmath   
  -- -------- --

One can prove that if @xmath is proper, this algebra is finitely
generated. The T-variety in question is @xmath . Since @xmath is graded,
@xmath acts on @xmath . If @xmath is proper, @xmath .

If we add a principal polyhedral divisor to @xmath , then @xmath will
not change as a graded algebra, so @xmath will stay the same, and the
action of the torus on @xmath will also stay the same. Notice also that
if @xmath are proportional, then @xmath , and in general the function
@xmath is piecewise-linear.

Within the construction of @xmath we use, the elements of @xmath may be
interpreted in two ways: they are rational functions on @xmath and they
are global algebraic functions on @xmath . If @xmath , we will write
@xmath for a rational function on @xmath and @xmath for a global
function on @xmath .

###### Proposition \thechapter.3.

(see [ 1 , Theorem 3.1] ) There exists a rational surjective map @xmath
such that for every degree @xmath , for every point @xmath such that
@xmath is defined at @xmath , and for every @xmath the following
conditions are equivalent:

1.  @xmath is defined at @xmath as a rational function.

2.  @xmath is defined at @xmath as a rational function.

In this case, @xmath .

### 5 Deformations

If @xmath is an affine algebraic variety, we will need to understand how
to define an @xmath -module structure on @xmath . Namely, choose an
embedding @xmath , then @xmath can be written as @xmath , where @xmath
is an ideal. Then @xmath is an @xmath -module. Consider also the
following @xmath -module @xmath : its elements are of the form @xmath ,
where @xmath . Every such differential operator defines an @xmath
-homomorphism between @xmath and @xmath : if @xmath , then @xmath maps
to @xmath . If @xmath , @xmath , then @xmath , so the map is
well-defined. If @xmath , @xmath , then @xmath , so @xmath , and the map
is @xmath -linear. So in fact we have defined a map @xmath .

Moreover, if @xmath , i. e. if all @xmath are in @xmath , then @xmath
for all @xmath , so @xmath is well-defined on @xmath , which is an
@xmath -module. It is clear that @xmath is @xmath -linear.

One can prove that @xmath can be identified with @xmath so that these
identifications for all affine varieties together have good
category-theoretical properties. We will not need these properties
explicitly, and we will use this identification as a definition of
@xmath . However, we will need to understand how the identification
itself works exactly, because at some point a first order deformation
will arise from a different source (actually, as a restriction of a
deformation over an affine line to a tangent vector at the origin), and
we will need to understand how it is represented by an element of @xmath
. Here is a brief description.

Suppose that we have a first order deformation with a total space @xmath
. It can be shown that @xmath is an affine scheme. Denote @xmath . Then
the flat morphism @xmath means that @xmath is a @xmath -module, and the
isomorphism @xmath determines an isomorphism @xmath . We keep the
assumption that @xmath is generated by @xmath generators @xmath , and
that @xmath is the ideal such that @xmath and that this isomorphism maps
@xmath to @xmath for each @xmath . The flatness of @xmath implies that
there exist elements @xmath such that @xmath and that all elements
@xmath generate @xmath . It also follows from the flatness of @xmath
that if @xmath , in other words, if @xmath is a polynomial in @xmath
variables such that @xmath , then there exists a polynomial @xmath such
that @xmath . Moreover, it can be shown that this @xmath is unique
modulo @xmath . So, we have a well-defined map @xmath , and it can also
be shown that it is well-defined on @xmath and is @xmath -linear. We say
by definition that the isomorphism between @xmath and @xmath maps the
deformation under consideration to the class of this map in @xmath . One
still has to show that this is really an isomorphism, but this is a
known fact. Note that a deformation itself only defines a class of a map
@xmath in @xmath , but if we lift the generators of @xmath to @xmath ,
the map @xmath itself will be already uniquely determined (while it
depends on the choice of the lift).

If @xmath is a lattice, @xmath is @xmath -graded, and the generators
@xmath are homogeneous, then one has an @xmath -grading on @xmath as
well. Then @xmath becomes an @xmath -graded ideal, and @xmath becomes an
@xmath -graded module with @xmath . The map @xmath preserves this
grading, so we have a grading on @xmath .

### 6 Schlessinger’s formula for @xmath

Extending Schlessinger’s result [ 4 , Lemma 2] , we prove the following
theorem:

###### Theorem \thechapter.4.

Let @xmath be an affine normal algebraic variety, and let @xmath be a
non-singular open subset of @xmath such that @xmath . Then @xmath can be
computed as follows. Let @xmath denote the tangent sheaf on @xmath , and
let @xmath be a set of generators. Consider the following map @xmath :
it maps a (locally defined) vector field @xmath to @xmath .

Then @xmath as @xmath -modules.

The difference from Lemma 2 in [ 4 ] itself is the following. First, we
speak about a normal affine variety @xmath , while Lemma 2 in [ 4 ]
speaks about local geometric schemes. Second, we allow @xmath to have
any singularities as long as @xmath is normal, while Lemma 2 in [ 4 ]
says that the singularity must be isolated. Finally, here @xmath is an
arbitrary smooth open subset of @xmath such that @xmath , while in Lemma
2 in [ 4 ] it must be the smooth locus of @xmath . On the other hand,
here @xmath is only embedded into a vector space, while in [ 4 ] it can
be embedded into an arbitrary smooth local geometric scheme @xmath .
However, despite all these differences, the proof of Lemma 2 in [ 4 ]
can be used as a proof of Lemma \thechapter .4 here without any
significant changes.

###### Proof of Theorem \thechapter.4.

If @xmath is a coherent sheaf on @xmath , denote @xmath . First, we
prove three lemmas, which extend Lemma 1 from [ 4 ] . Here we use the
following notion of sections and cohomology with support (for more
details, see, for example, [ 5 , Section II.1] and [ 5 , Section III.2]
). Given a sheaf @xmath on a variety @xmath and a closed subset @xmath ,
we denote by @xmath (or by @xmath ) the space of all global sections
@xmath of @xmath that vanish outside @xmath ( @xmath ). We call the
space @xmath the space of global sections of @xmath with support on
@xmath . The functor @xmath is left exact, and it has classical right
derived functors, which are called cohomology with support and denoted
by @xmath .

###### Lemma \thechapter.5.

Let @xmath be a normal affine algebraic variety, @xmath be an open
subset such that @xmath , and @xmath be a free sheaf of finite rank on
@xmath . Then @xmath .

###### Proof.

Write the long exact sequence for cohomology with support:

  -- -------- --
     @xmath   
  -- -------- --

@xmath is a free sheaf of finite rank, @xmath is normal, and @xmath ,
therefore the restriction map @xmath is an isomorphism. Hence, @xmath
and the map @xmath is an embedding. Since @xmath is affine, @xmath , so
@xmath . ∎

The following lemma is known, but for convenience of the reader we give
a proof here.

###### Lemma \thechapter.6.

Let @xmath be a normal affine algebraic variety, @xmath be an open
subset such that @xmath , and @xmath be a coherent sheaf on @xmath such
that there exists a coherent sheaf @xmath on @xmath such that @xmath .
Then @xmath .

###### Proof.

Since @xmath is a coherent sheaf, there exists an exact sequence of
coherent sheaves on @xmath

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is free. Since @xmath and @xmath are left exact functors,
the corresponding map

  -- -------- --
     @xmath   
  -- -------- --

is an embedding. @xmath is free and coherent, i. e. it is a free sheaf
of finite rank, so @xmath is also a free sheaf of finite rank. By Lemma
\thechapter .5 , @xmath . Hence, @xmath . ∎

###### Remark \thechapter.7.

Strictly speaking, we will not need this fact later, but the statement
of the lemma is closely related to the notion of a reflexive sheaf.
Namely, a sheaf @xmath is called reflexive if @xmath . Clearly, if
@xmath is reflexive, then it satisfies the conditions of the lemma, we
can take @xmath . One can prove that the contrary is also true, i. e. if
@xmath can be written as @xmath , then @xmath is reflexive.

###### Lemma \thechapter.8.

Let @xmath be a normal affine algebraic variety, @xmath be an open
subset such that @xmath , and @xmath be a coherent sheaf on @xmath such
that there exists a coherent sheaf @xmath on @xmath such that @xmath .
Then the restriction map @xmath is an isomorphism.

###### Proof.

Again write an exact sequence of coherent sheaves on @xmath

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is free. The dualization functor is left exact, so the
corresponding map @xmath is an embedding, and its cokernel (denote it by
@xmath ) is a subsheaf of @xmath . By Lemma \thechapter .6 , @xmath .
Since @xmath is a subsheaf of @xmath and @xmath is a left exact functor,
@xmath . Again, since @xmath is free and coherent, @xmath is a free
sheaf of finite rank. By Lemma \thechapter .5 , @xmath . We have the
following exact sequence of cohomology:

  -- -------- --
     @xmath   
  -- -------- --

and we see that @xmath . By Lemma \thechapter .6 , @xmath . Now write
the following long exact sequence:

  -- -------- --
     @xmath   
  -- -------- --

We see that the restriction map @xmath is an isomorphism. ∎

Now we are ready to prove Theorem \thechapter .4 . Denote @xmath . The
generators @xmath define an embedding @xmath and a morphism of algebras
@xmath so that @xmath . Denote the kernel of this algebra morphism by
@xmath . As we have previously seen, @xmath is an @xmath -module. Denote
the corresponding sheaf on @xmath by @xmath . Observe that the @xmath
-module @xmath introduced in the definition of @xmath is isomorphic to
the free @xmath -module of rank @xmath as an @xmath -module. The kernel
of the map @xmath consists of all @xmath -tuples @xmath of functions on
@xmath such that for all @xmath one has @xmath in @xmath (to evaluate
this expression, we take arbitrary representatives in the cosets
corresponding to @xmath and to @xmath in @xmath and in @xmath ,
respectively, we have seen previously that its value in @xmath does not
depend on this choice). In other words, the @xmath -tuple @xmath defines
a tangent vector field to @xmath . The embedding of the tangent bundle
on @xmath into the rank @xmath trivial bundle on @xmath we have just
obtained coincides with the map @xmath in the statement of Theorem
\thechapter .4 . So, we have the following exact sequence of @xmath
-modules:

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath is affine, we also have an exact sequence of sheaves
(denote the sheaf generated by the @xmath -module @xmath by @xmath ):

  -- -------- --
     @xmath   
  -- -------- --

Denote the map between sheaves @xmath and @xmath by @xmath . It is known
that (see, for example, [ 2 , Exercise 3.5 and Theorem 4.9] ) if @xmath
is smooth, then @xmath . So, if @xmath is, in addition, affine, we have
the following exact sequence:

  -- -------- --
     @xmath   
  -- -------- --

In particular, this holds for affine sets @xmath forming an affine cover
of @xmath . Therefore, we have the following exact sequence of sheaves
on @xmath :

  -- -------- --
     @xmath   
  -- -------- --

and we can write the long exact sequence of cohomology:

  -- -- --
        
  -- -- --

Denote the map between @xmath and @xmath by @xmath . We have @xmath .

Recall the exact sequence of @xmath -modules we started with:

  -- -------- --
     @xmath   
  -- -------- --

We can write @xmath as @xmath . and @xmath as @xmath . Now we can apply
Lemma \thechapter .8 . @xmath is dual to @xmath , @xmath is dual to
itself, and @xmath is dual to @xmath by construction. So we can rewrite
the exact sequence as follows:

  -- -------- --
     @xmath   
  -- -------- --

and we see that @xmath . ∎

###### Remark \thechapter.9.

If a torus @xmath acts on @xmath and preserves @xmath , all generators
of @xmath we have are homogeneous, and we find an affine covering of
@xmath by sets preserved by @xmath , then @xmath becomes a graded @xmath
-module. The @xmath -module @xmath also becomes graded (see Section 5 ).

In this case, the argument above proves that @xmath is isomorphic to
@xmath as a graded @xmath -module.

### 7 Cech complexes cohomology

We need two more facts related to Cech complexes. The first proposition
explains how to compute derived direct images using Cech resolutions.

Let @xmath be a quasicoherent sheaf on a separated algebraic variety
@xmath , and let @xmath be an affine covering of @xmath . Consider the
following sheaf Cech resolution of @xmath : it consists of sheaves
@xmath on @xmath , @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

where if @xmath is an open subset, then @xmath . The differentials in
the resolution are defined in the usual Cech sense: given a section

  -- -------- --
     @xmath   
  -- -------- --

the differential maps it to

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

Notice that if we take the global sections of all @xmath , we obtain a
Cech complex of @xmath in the ”usual”, non-sheaf sense.

Suppose we have a map @xmath , where @xmath is also a separated
algebraic variety.

###### Proposition \thechapter.10.

[ 5 , Proposition III.8.7]

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the @xmath th cohomology of the complex formed by @xmath
for @xmath , not the @xmath th cohomology of a particular sheaf.∎

The second fact gives an easier way to compute the first cohomology of
complexes that ”look like a Cech complex” under certain circumstances in
any abelian category. Suppose that @xmath is an abelian category, let
@xmath be an object, let @xmath , and let for every @xmath indices
@xmath satisfying @xmath @xmath be a subobject of @xmath (i. e. an
object together with a morphism @xmath whose kernel is zero). Suppose
also that if @xmath is a subsequence of @xmath , then @xmath is a
subobject of @xmath , and the embedding @xmath commutes with the
embeddings of these objects into @xmath .

Now consider the following complex @xmath :

  -- -------- --
     @xmath   
  -- -------- --

Here we allow @xmath and say that @xmath , so @xmath The differential
@xmath is defined using a sign-alternating sum, as it is usually defined
in Cech complexes. Here we have objects in an abelian category, not
necessarily abelian groups or modules over a ring, so we use universal
properties of direct sums to interpret formulas with addition and
subtraction signs.

We also need the following complex @xmath :

  -- -------- --
     @xmath   
  -- -------- --

Here we also allow @xmath , and @xmath . Again, the differentials are
defined ”as usual” using universal properties of direct sums.

###### Proposition \thechapter.11.

For @xmath , @xmath . This isomorphism is functorial in @xmath and
@xmath if the embeddings @xmath are functorial in @xmath and @xmath .

###### Proof.

Consider the following complex @xmath :

  -- -------- --
     @xmath   
  -- -------- --

The differential is again the standard Cech differential. Clearly, we
have an exact sequence of complexes:

  -- -------- --
     @xmath   
  -- -------- --

Let us check that @xmath is acyclic.

###### Lemma \thechapter.12.

@xmath is acyclic.

###### Proof.

First, consider the topological complex for a simplex with @xmath
vertices, i. e. the following complex @xmath :

  -- -------- --
     @xmath   
  -- -------- --

Here we do not allow @xmath , and the differential again coincides with
the standard Cech differential (although initially it is defined by
topological means). It is a well-known topological fact that @xmath and
@xmath for @xmath . One easily checks directly that @xmath consists of
classes of the elements of @xmath that have all coordinates equal, i. e.
of the elements of the form @xmath , where @xmath .

Therefore, the following complex @xmath of abelian groups is acyclic:

  -- -------- --
     @xmath   
  -- -------- --

Now let us use Mitchell’s embedding theorem. Consider the abelian
subcategory in @xmath in @xmath generated by @xmath . This is a small
category, therefore by Mitchell’s embedding theorem it is equivalent to
an abelian subcategory in the category of left modules over a (not
necessarily commutative) ring @xmath . So, we can consider @xmath as a
complex of @xmath -modules. In particular, @xmath also becomes a complex
of abelian groups, and it is acyclic as a complex of @xmath -modules iff
it is acyclic as a complex of abelian groups. And for complexes of
abelian groups, we clearly have @xmath .

Let us deduce that @xmath is also acyclic. We cannot be sure that @xmath
is a flat object in the category of abelian groups, but we can argue
differently. Since @xmath is acyclic and consists of free abelian groups
of finite rank, it can be considered as a projective resolution for the
abelian group @xmath . Then @xmath . But @xmath , so @xmath is acyclic.
∎

Now let us write the long exact sequence for the exact triple

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

We have @xmath and @xmath for all @xmath , so @xmath . ∎

###### Corollary \thechapter.13.

If @xmath for all @xmath , then @xmath , where @xmath is mapped to
@xmath diagonally.∎

###### Corollary \thechapter.14.

In general, if it is not necessarily true that @xmath for all @xmath ,
then

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is mapped to @xmath diagonally.∎

### 8 Leray spectral sequence

We are going to use the following theorem:

###### Theorem \thechapter.15.

(see, for example, [ 6 , Section 3.3, page 74] and [ 7 , §III.7, Theorem
7] ) Let @xmath be a morphism of algebraic varieties, and let @xmath be
a quasicoherent sheaf on @xmath . Then there exists a spectral sequence
called Leray spectral sequence with the second sheet

  -- -------- --
     @xmath   
  -- -------- --

where the corresponding differentials map @xmath to @xmath , @xmath ,
that converges to @xmath . Denote the corresponding filtration on @xmath
by @xmath .

The sheaves @xmath can be considered as sheaves of @xmath -modules, and
@xmath can be therefore considered as @xmath -modules. In this sense,
the isomorphism

  -- -------- --
     @xmath   
  -- -------- --

is an isomorphism of @xmath -modules.

Here @xmath denotes the @xmath th derived functors of the direct image
functor in quasicoherent sheaf category (or shortly, ” @xmath th derived
direct image”).

Notice that if @xmath , then (since all sheaves @xmath are coherent)
@xmath for @xmath (and @xmath ), so all differentials vanish, @xmath ,
and we have a short exact sequence

  -- -------- --
     @xmath   
  -- -------- --

We will also need an explicit description of the maps in this exact
sequence for @xmath . By adopting the general construction from [ 7 ,
§III.7] one can check that the exact sequence above for @xmath looks as
follows.

Choose an affine open covering @xmath of @xmath . Also choose an affine
open covering @xmath of @xmath (here @xmath , where @xmath is a finite
set of pairs of natural numbers) so that if @xmath , then @xmath , and
@xmath .

Then the map @xmath works as follows: An element of @xmath is
represented by a tuple of sections @xmath , where @xmath satisfy the
cocycle conditions. By definition, @xmath , and, since @xmath we can
define restrictions @xmath for all @xmath and @xmath such that @xmath .
These sections together with zeros for the sets @xmath , where @xmath ,
form a class in @xmath .

The map @xmath works as follows: Suppose that we have an element of
@xmath defined by sections @xmath ( @xmath and @xmath for some prefixed
order on @xmath ) satisfying the cocycle conditions. These sections
together can be interpreted as a global section of the sheaf @xmath from
Proposition \thechapter .10 and, therefore, as a global section @xmath .
It follows from the cocycle conditions on @xmath that @xmath , so @xmath
defines a class in @xmath .

Finally, consider an even more particular situation. Denote @xmath and
@xmath . We keep all of the assumptions from the three previous
paragraphs, but also suppose the following:

1.  @xmath and @xmath are irreducible.

2.  @xmath and @xmath are nonempty.

3.  @xmath .

4.  All restriction maps for the sheaf @xmath to nonempty open subsets
    are injective (for example, this is true for vector bundles of
    finite rank). I. e., if @xmath are nonempty open subsets, then the
    restriction map @xmath is injective. Then all restriction maps for
    the sheaf @xmath to open sets containing @xmath are also injective.

5.  @xmath if @xmath . This assumption enables us to use Corollary
    \thechapter .13 to compute cohomology groups of @xmath .

We can apply Corollary \thechapter .13 to @xmath and apply Corollary
\thechapter .14 to @xmath . Moreover, we can consider the sheaf @xmath .
In other words, for all open subsets @xmath set @xmath . Then all
sheaves @xmath and @xmath from Proposition \thechapter .10 are
subobjects of @xmath , and, since the functor @xmath is left exact, each
sheaf @xmath and @xmath is a subobject of @xmath . So, we can also apply
Corollary \thechapter .14 to the first cohomology of the complex @xmath
. We get the following isomorphisms:

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

These identifications enable us to write the maps @xmath and @xmath .

The map @xmath is induced by the following map @xmath . For each @xmath
( @xmath ), a section from the @xmath th direct summand @xmath is
restricted to @xmath and then mapped diagonally to @xmath . Note that
@xmath if @xmath , therefore, the image of this map indeed belongs to
the correct subobject of @xmath .

To get the map @xmath , note that each global section of @xmath induces
a global section of @xmath . On the other hand, by the definition of
@xmath , @xmath , and the map @xmath is induced by this equality.

###### Remark \thechapter.16.

Suppose that a torus @xmath acts on @xmath , the morphism @xmath is
@xmath -invariant, and each set @xmath is preserved by the action of
@xmath . Then one can introduce grading on @xmath , on @xmath , and on
@xmath in the obvious way.

It follows from the above descriptions of the maps between these
cohomology groups that this grading is preserved.

### 9 Stably dominant morphisms

###### Definition \thechapter.17.

(This is definition 10.80.1, tag 058I in Stacks project [ 8 ] ) Let
@xmath be an algebra. A map of @xmath -modules @xmath is called
universally injective if it is injective and for every @xmath -module
@xmath , the map @xmath is injective.

###### Remark \thechapter.18.

A direct summand embedding is always universally injective.

Consider the following situation. Let @xmath and @xmath be two affine
schemes with base @xmath , in other words, let @xmath and @xmath be two
morphisms of affine schemes. Let @xmath be a relative morphism, i. e. a
morphism such that @xmath . In other words, we have the following
commutative diagram:

  -- -- --
        
  -- -- --

Algebraically this means that @xmath and @xmath are @xmath -modules, and
that @xmath is a morphism of @xmath -algebras.

###### Definition \thechapter.19.

We call @xmath a stably dominant morphism if @xmath is a universally
injective morphism of @xmath -modules.

###### Lemma \thechapter.20.

The functor of base change preserves relatively dominant morphisms. In
other words, suppose that we have a morphism of schemes @xmath , and
@xmath is a stably dominant morphism of @xmath -schemes. Then @xmath is
a relatively dominant morphism of @xmath -schemes.

###### Proof.

In algebraic terms, we know that @xmath is universally injective. Then
@xmath is a universally injective morphism of @xmath -modules. Finally,
@xmath , @xmath , and @xmath . ∎

Let @xmath be a morphism of affine schemes. If @xmath is an affine
@xmath -scheme, @xmath induces a morphism @xmath , which we will denote
by @xmath . Algebraically, if @xmath is a regular function on @xmath ,
then @xmath , where @xmath is the unit of the algebra @xmath . This is
illustrated by the following commutative diagram

  -- -- --
        
  -- -- --

For example, if @xmath is an ideal, and @xmath is the vanishing locus of
@xmath , then @xmath as a @xmath -module, @xmath is the embedding of
@xmath into @xmath , @xmath is the canonical projection @xmath , and
@xmath is the canonical projection @xmath .

###### Lemma \thechapter.21.

Let @xmath be an affine scheme, let @xmath be a stably dominant morphism
of affine @xmath -schemes, and let @xmath be a closed embedding. Then
@xmath as a subalgebra of @xmath .

Before we give a proof, let us provide a commutative diagram with all
involved morphisms.

  -- -- --
        
  -- -- --

###### Proof.

Since @xmath is a closed embedding, @xmath is surjective, and then
@xmath is also surjective. So, @xmath . And the commutativity @xmath
follows directly from the definitions of @xmath , @xmath , and @xmath .
∎

In particular, we can use this lemma to compute fibers of the morphism
@xmath if we already know fibers of the morphism @xmath (such a fiber is
a particular case of base change applied to @xmath , namely, we change
the base of @xmath from @xmath to a point in @xmath ).

### 10 Notation and terminology

First, we need some notation for lattice polyhedra. Let @xmath be a
polyhedron with tail cone @xmath and with all vertices in @xmath , where
@xmath , and @xmath is pointed. We denote the number of vertices of
@xmath by @xmath and we denote the vertices of @xmath by @xmath so that
pairs of consecutive vertices in this enumeration form the finite edges
of @xmath . We denote the finite edge between @xmath and @xmath by
@xmath . We denote the infinite edge with the endpoint @xmath by @xmath
and the infinite edge with the endpoint @xmath by @xmath . For each
vertex @xmath denote by @xmath the subcone of @xmath consisting of all
@xmath such that @xmath . We call @xmath the normal subcone of the
vertex @xmath . One checks easily that this is really a subcone, that
@xmath , that the intersection of two such cones is either a ray or the
origin, and it is a ray if and only if the two corresponding vertices
form an edge @xmath . In the latter case this ray is exactly the set of
all @xmath whose minimum on @xmath is attained on @xmath . We denote
this ray by @xmath and call it the normal ray of the edge @xmath .
Finally, we extend this notation for infinite edges of @xmath : we
denote by @xmath (resp. @xmath ) the ray in @xmath consisting of all
@xmath whose minimum on @xmath is attained on @xmath (resp. @xmath ).
These two rays are in fact the two rays forming @xmath , and they are
also called the normal rays of the corresponding edges. The normal
subcones of all vertices and the normal rays of all (finite and
infinite) edges form a fan, which is called the normal fan of @xmath .

We always choose the order on vertices of @xmath so that @xmath is
always the same one of the two rays forming @xmath (it must not depend
on @xmath ). This ray is denoted by @xmath , and the other ray of @xmath
is denoted by @xmath .

The previous notation applies to polyhedra with tail cone @xmath , let
us extend it to the vertex and edges of @xmath . Namely, the boundary of
@xmath consists of two infinite edges and one vertex at the origin.
Denote the vertex at the origin by @xmath . If @xmath is a polyhedron
with tail cone @xmath , then @xmath is always the same edge of @xmath
(independently of @xmath ), and @xmath is always the other edge of
@xmath . Denote @xmath and @xmath . In particular, this is true for
@xmath , i. e. @xmath and @xmath . Denote the primitive lattice vectors
on @xmath by @xmath .

Fig. 2 shows an example of this notation for a polyhedron @xmath , its
tail cone @xmath , and its normal fan.

If @xmath is a ray in @xmath , we denote the primitive lattice vector on
@xmath by @xmath . If @xmath is a vector or a segment in @xmath , denote
by @xmath the lattice length of @xmath , i. e. the number of lattice
points in @xmath including exactly one of the endpoints.

#### 10.1 List of notation introduced further

The notation listed below will be properly introduced later, we list it
now to ease reading and navigation only, without going into details of
the underlying notions.

1.  We fix a two-dimensional pointed cone @xmath (recall that @xmath ).

2.  We fix points @xmath and polyhedra @xmath with tail cone @xmath .

3.  We denote by @xmath a divisor on @xmath . It will be used to
    construct a T-variety.

4.  The T-variety will be denoted by @xmath .

5.  We shortly write @xmath instead of @xmath and @xmath instead of
    @xmath for @xmath .

6.  We also need a notion of an essential special point, which is a
    point @xmath such that @xmath is not a translation of @xmath . We
    denote the number of essential special points by @xmath , and we
    will assume that the points @xmath are essential.

7.  We will introduce a set of degrees containing the union of Hilbert
    bases of several subcones of @xmath , and we will denote the degrees
    in this set by @xmath .

8.  Since @xmath is a @xmath -variety, @xmath is an @xmath -graded
    algebra. As usual, we will denote the degree of a homogeneous
    element @xmath with respect to this grading by @xmath .

9.  We will choose homogeneous generators of this algebra, and denote
    them by

      -- -- --
            
      -- -- --

    Here @xmath . Also note that the @xmath th graded component of
    @xmath is by construction identified with @xmath . The generators
    @xmath will span @xmath .

10. We denote the total number of these generators by @xmath .

11. We will fix a smooth open subset @xmath such that @xmath .

12. We will fix an affine open covering of @xmath , which we will denote
    by @xmath .

## Chapter \thechapter Formula for the graded component of @xmath of
degree 0 in terms of sheaf cohomology

### 11 Regularity locus and fiber structure of the map @xmath

Let @xmath be a pointed full-dimensional cone, @xmath be points on
@xmath , @xmath be polyhedra whose vertices are lattice points and whose
tail cones are all @xmath . Unlike what is assumed sometimes, we do not
allow @xmath to appear among these polyhedra. ² ² 2 In terms of the
notation where @xmath is allowed among the coefficients, this means that
the locus of the polyhedral divisor will be the whole @xmath . These
data define a polyhedral divisor @xmath and a graded algebra @xmath . If
@xmath does not coincide with any of the points @xmath , we denote
@xmath . Suppose in the sequel that @xmath is proper, then @xmath
defines a 3-dimensional variety @xmath with an action of a 2-dimensional
torus. We use the notation @xmath for the rational map from @xmath to
@xmath introduced in Proposition \thechapter .3 . It is known that all
such varieties are normal.

In the sequel we will always keep in mind that very ample divisors on
@xmath are exactly the divisors of positive degree and principal
divisors are exactly the divisors of degree zero. We call a point @xmath
ordinary if it is not one of the points @xmath , otherwise we call it
special . We require that the sum @xmath is finite, but we do not
require that all summands are nontrivial, i. e. we allow summands of the
form @xmath , which are zeros in the polyhedral divisor group. We call
such points @xmath special anyway, according to the definition above. So
in fact the notions of a special point and an ordinary point depend on
the choice of exact presentation @xmath , and we suppose that it is also
fixed. If @xmath for some @xmath , (including @xmath ), we call such
@xmath a removable special point, otherwise we call @xmath an essential
special point. If @xmath , we call @xmath a trivial special point.

Fix a coordinate @xmath on @xmath , i. e. fix a rational function @xmath
on @xmath that has one pole of order 1 and one zero of order 1.

###### Lemma \thechapter.1.

Given two nonzero rational functions @xmath and @xmath on @xmath such
that @xmath has one zero and one pole, and both of them are of order
one, there exist @xmath such that @xmath .

###### Proof.

First, let us find @xmath such that @xmath is regular at all points
where @xmath is finite and has pole of order one at @xmath . If @xmath
at @xmath , then this zero is of order one, and @xmath yield the
function @xmath , which has pole of degree one at @xmath . It has no
other poles since they would be other zeros of @xmath , so this function
has the desired properties. Otherwise denote the value of @xmath at
@xmath by @xmath . Consider the following function: @xmath . Clearly, it
has a zero at @xmath . Observe that @xmath has exactly one pole of order
one, namely, at the point where @xmath has zero of order one. Hence,
@xmath also has exactly one pole of order one. The sum of minus orders
of all poles and of (plus) orders of all zeros of a rational function on
@xmath is zero. Thus, @xmath has exactly one zero, and this zero is of
order one. But we already know one zero of @xmath , namely, @xmath .
Therefore, this zero is of order one, and @xmath has exactly one pole,
this pole is of order one and is at @xmath .

Now we have a function @xmath , which is regular at all points where
@xmath takes finite value and has a pole of order one at @xmath . Denote
the value of this function at @xmath by @xmath . Consider the following
function: @xmath . It has exactly one pole, this pole is at @xmath and
of order one, and it has a zero at @xmath . If we divide this function
by @xmath , the resulting function @xmath has no poles on @xmath , so it
is a constant. Therefore, if we multiply @xmath by the appropriate
constant, it will be equal to @xmath . ∎

###### Corollary \thechapter.2.

For every divisor @xmath on @xmath of positive degree and for every
non-zero rational function @xmath there exist @xmath and @xmath such
that @xmath .

###### Proof.

Since @xmath , @xmath is an effective divisor. Write @xmath , where
@xmath , @xmath . Since @xmath is a rational function on @xmath , @xmath
, and @xmath . There exists a point @xmath such that @xmath . Choose
another point @xmath , and consider the following divisor: @xmath . This
is an effective divisor since @xmath . Let @xmath be a rational function
on @xmath such that @xmath . Then @xmath . Hence, @xmath , and we can
apply Lemma \thechapter .1 to @xmath and @xmath since @xmath . ∎

###### Corollary \thechapter.3.

Let @xmath . If there exists a degree @xmath such that @xmath and @xmath
such that @xmath , then @xmath is defined at @xmath .

###### Proof.

Apply Corollary \thechapter .2 to @xmath and @xmath . There exists
@xmath and @xmath such that @xmath on @xmath . The functions @xmath and
@xmath cannot be proportional, otherwise @xmath would be a constant on
@xmath . Then @xmath and @xmath cannot be proportional either, and
@xmath is a rational function on @xmath . The rational function @xmath ,
considered as a rational map from @xmath to @xmath (we suppose that it
computes the coordinate @xmath of a point on @xmath ), coincides with
@xmath by Proposition \thechapter .3 . The pairs @xmath and @xmath
cannot be proportional, and @xmath , so the functions @xmath and @xmath
cannot vanish simultaneously. Therefore, the rational map from @xmath to
@xmath defined by @xmath is defined at @xmath . This rational map
coincides with @xmath , so we are done. ∎

So we define an open subset @xmath as follows: it consists of all points
@xmath such that there exists a degree @xmath such that @xmath and there
exists @xmath such that @xmath . Corollary \thechapter .3 shows that
@xmath is defined on @xmath . In fact, @xmath is not defined outside
@xmath , but we will not need this.

Our next goal is to understand fibers of @xmath . First, consider an
ordinary point @xmath . For every degree @xmath , the sections of @xmath
do not have poles at @xmath . For each @xmath , choose a basis

  -- -------- --
     @xmath   
  -- -------- --

of @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

In particular, observe that for @xmath we have @xmath , and the only
global functions of degree @xmath are constants. The condition @xmath
guarantees in this case that @xmath and @xmath everywhere. By
Proposition \thechapter .3 , if @xmath and @xmath , then @xmath , so
@xmath since @xmath is a global function.

For every @xmath , @xmath , @xmath is an element of @xmath , so it can
be written as

  -- -------- --
     @xmath   
  -- -------- --

This equality holds for rational functions on @xmath , and evaluation at
@xmath shows that @xmath . The equality also holds for the corresponding
global functions on @xmath .

These computations prove the following lemma:

###### Lemma \thechapter.4.

For every @xmath , @xmath and for every @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

∎

Recall that we have denoted the two rays on the boundary of @xmath by
@xmath and @xmath , and the primitive lattice vectors on these edges
were denoted by @xmath and @xmath , respectively.

###### Lemma \thechapter.5.

For a point @xmath , @xmath , there are at most three possibilities:

1.   For every @xmath , @xmath .

2.   For every @xmath , @xmath , and @xmath for all other @xmath . This
    is possible if and only if @xmath

3.   For every @xmath , @xmath , and @xmath for all other @xmath . This
    is possible if and only if @xmath .

###### Proof.

Until the end of the proof, denote the sublattice in @xmath generated by
@xmath and @xmath by @xmath . First, consider a degree @xmath . We know
that if @xmath , then @xmath . So there can be four possibilities:

1.  @xmath and @xmath . Then @xmath for all @xmath .

2.  @xmath , but @xmath . Then for all @xmath we have @xmath if and only
    if @xmath .

3.  @xmath , @xmath . Similarly, @xmath if and only if @xmath .

4.  @xmath . Then @xmath for all @xmath except @xmath .

Since @xmath is a sublattice of finite index in @xmath (recall that
@xmath ), for every @xmath there is @xmath , @xmath . We have @xmath ,
so @xmath if and only if @xmath . Therefore, the classification above
also works for @xmath :

1.  @xmath and @xmath . Then @xmath for all @xmath .

2.  @xmath , but @xmath . Then for all @xmath we have @xmath if and only
    if @xmath .

3.  @xmath , @xmath . Similarly, @xmath if and only if @xmath .

4.  @xmath . Then @xmath for all @xmath except @xmath .

Notice that case 4 is impossible in @xmath , and case 2 (resp. 3 ) is
possible if and only if there is a degree @xmath (resp. @xmath ) such
that @xmath . Now recall that @xmath becomes a linear function after a
restriction to a line in @xmath , so existence of such @xmath is
equivalent to @xmath (resp. @xmath ). ∎

This lemma can be reformulated without mentioning bases of @xmath
explicitly as follows:

###### Proposition \thechapter.6.

For each @xmath , there exists a subcone @xmath such that if @xmath and
@xmath , then

  -- -------- --
     @xmath   
  -- -------- --

For the cone @xmath (which depends on @xmath ) there are at most three
possibilities:

1.  @xmath .

2.  @xmath . This is possible if and only if @xmath .

3.  @xmath . This is possible if and only if @xmath .

###### Proof.

First, fix a degree @xmath . Notice that if @xmath , then @xmath if and
only if the decomposition of @xmath into a linear combination of
functions @xmath contains @xmath with a nonzero coefficient. Now fix a
point @xmath . Recall that all functions @xmath for @xmath vanish on
@xmath . We see that @xmath if and only if @xmath for all @xmath such
that @xmath . We also see that, independently of the value of @xmath ,
@xmath for all @xmath such that @xmath . ∎

Following [ 9 , Section 6.2] , denote the set of all points @xmath such
that case 1 (resp. case 2 , 3 ) holds by @xmath (resp. by @xmath ,
@xmath ). In fact (see [ 9 , Section 6.2] , [ 1 , Corollary 7.11,
Theorem 10.1] ), these sets are orbits of the torus, and their closures
are affine toric varieties constructed by the standard toric
construction from the cone @xmath , but we will not need these facts.
Sometimes we can simply write @xmath instead of @xmath .

Now we are going to understand the structure of a fiber @xmath over a
special point @xmath . The function @xmath (which defines the
coefficient for @xmath in @xmath , denote it shortly by @xmath ) is
piecewise linear. One checks easily that the maximal subcones of @xmath
where @xmath is linear are exactly the cones @xmath ( @xmath ), In what
follows, we write @xmath instead of @xmath and @xmath instead of @xmath
for brevity. Observe that @xmath if and only if @xmath is a removable
special point.

This time we choose bases of @xmath as follows: let

  -- -------- --
     @xmath   
  -- -------- --

be a basis of @xmath such that @xmath and @xmath for @xmath . Then
functions @xmath for @xmath are defined at @xmath and evaluate to @xmath
there, so if @xmath , then by Proposition \thechapter .3 @xmath , and
@xmath for @xmath . In this case we demand explicitly for @xmath that
@xmath and @xmath everywhere.

Now let @xmath , @xmath , then @xmath is an element of @xmath , so it
can be written as

  -- -------- --
     @xmath   
  -- -------- --

We have @xmath , @xmath and @xmath for @xmath . Therefore, @xmath if and
only if @xmath if and only if @xmath or @xmath or @xmath and @xmath are
in the same subcone of @xmath where @xmath is linear, i. e. @xmath for
some @xmath .

These computations prove the following lemma:

###### Lemma \thechapter.7.

For every @xmath , @xmath and for every @xmath , @xmath , where @xmath
depends on @xmath and on the choice of @xmath , but not on @xmath .
@xmath if and only if @xmath or @xmath or there exists a vertex @xmath
of @xmath such that @xmath (in other words, @xmath and @xmath belong to
the same cone of the normal fan of @xmath ).∎

###### Corollary \thechapter.8.

Let @xmath , @xmath , @xmath . Suppose that there exist no vertex @xmath
such that @xmath . Then for every @xmath , @xmath we have @xmath .∎

###### Lemma \thechapter.9.

Let @xmath be a point, @xmath . The set of degrees @xmath such that
@xmath can be the set of all lattice points in one of the following
cones:

1.  @xmath for some @xmath , @xmath .

2.  @xmath for some @xmath , @xmath .

3.  @xmath for @xmath or @xmath . This is possible if and only if @xmath
    .

###### Proof.

Denote @xmath for @xmath . (In particular, we have @xmath and @xmath .
Consider all indices @xmath such that @xmath . Since @xmath is in @xmath
only for @xmath or @xmath , there can be at most two such indices @xmath
, and if there are two of them, they should be two consecutive natural
numbers.

Suppose first that @xmath and @xmath for some @xmath . The argument is
similar to the proof of Lemma \thechapter .5 . Namely, consider the
sublattice in @xmath generated by @xmath and @xmath . It is a sublattice
of finite index, denote it by @xmath . For every @xmath , @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

so @xmath . For every @xmath there exists @xmath such that @xmath , so
@xmath . By lemma \thechapter .7 ,

  -- -------- --
     @xmath   
  -- -------- --

and @xmath , so @xmath . Finally, for a degree @xmath choose an
arbitrary degree @xmath in the interior of @xmath . Then by Lemma
\thechapter .7 , @xmath , we already know that @xmath , so @xmath .

Now suppose that there exists a degree @xmath such that @xmath and
@xmath is in the interior of a cone @xmath . Again denote the lattice
generated by @xmath and @xmath by @xmath . There exists @xmath such that
@xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

so @xmath . @xmath is also in the interior of @xmath , so there exist
@xmath such that @xmath . Again we have

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , so @xmath and @xmath . Therefore, if there exists a
degree @xmath in the interior of a cone @xmath such that @xmath , then
there are two indices @xmath such that @xmath .

Now consider the case when there is only one @xmath such that @xmath .
We already know that in this case for all degrees @xmath from the
interiors of the cones @xmath , we have @xmath . So the only possible
degrees @xmath such that @xmath are multiples of @xmath . And for these
degrees we have

  -- -------- --
     @xmath   
  -- -------- --

so @xmath . Such @xmath can be in @xmath only if @xmath . Properness
guarantees this for @xmath , and for @xmath or @xmath we have to check
this explicitly. ∎

And again this lemma can be reformulated without referring to bases of
@xmath .

###### Proposition \thechapter.10.

For each @xmath , there exists there exists a subcone @xmath such that
if @xmath and @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

@xmath can be one of the following cones:

1.   The normal subcone @xmath of a vertex @xmath of @xmath .

2.   The normal subcone @xmath of a finite edge @xmath ( @xmath ).

3.   The normal subcone @xmath of an infinite edge @xmath ( @xmath or
    @xmath , respectively). This is possible if and only if @xmath or
    @xmath , respectively.

###### Proof.

The proof is very similar to the proof of Proposition \thechapter .6 .
Again, we fix a degree @xmath and notice that if @xmath , then @xmath if
and only if the decomposition of @xmath into a linear combination of
functions @xmath contains @xmath with a nonzero coefficient. Fix a point
@xmath . Again for all functions @xmath , where @xmath , we have @xmath
. Therefore, @xmath if and only if @xmath for all @xmath such that
@xmath . And, independently of the value of @xmath , @xmath for all
@xmath such that @xmath . ∎

And again, following [ 9 , Section 6.2] , we denote the set of all
points @xmath such that case 1 (resp. case 2 or 3 ) holds by @xmath
(resp. by @xmath ). In fact (see [ 9 , Section 6.2] , [ 1 , Corollary
7.11, Theorem 10.1] ), these sets are orbits of the torus.

It follows easily from Proposition \thechapter .10 that for each vertex
@xmath ( @xmath ),

  -- -------- --
     @xmath   
  -- -------- --

Moreover, all sets @xmath are two-dimensional, and all sets @xmath (
@xmath ) are one-dimensional. This is illustrated by Fig. 3 .

### 12 Sufficient systems of open subsets of @xmath

We are going to use Theorem \thechapter .4 , Leray spectral sequence for
the map @xmath and Proposition \thechapter .10 to compute @xmath . To do
this, we need an open subset @xmath suitable for Theorem \thechapter .4
(i. e. smooth and such that @xmath ) and an affine covering of @xmath .
We first choose several affine subsets of @xmath . The amount of these
sets will be denoted by @xmath , the sets themselves will be denoted by
@xmath ( @xmath ). Then we will set @xmath . As we will see later, the
intersection of a set @xmath and a fiber of @xmath will be either an
empty set, or a two-dimensional torus orbit, or the union of a
two-dimensional and a one-dimensional torus orbit. In the last base the
one-dimensional orbit belongs to the closure of the two-dimensional
orbit, and the entire intersection is isomorphic to @xmath . Very
roughly and informally speaking, each set @xmath will correspond to a
choice of several special points and of two-dimensional orbits in the
fibers above these points, one orbit above each special point.

To define a set @xmath , we fix the following data:

1.  a pair of degrees @xmath generating @xmath as a lattice and such
    that @xmath , @xmath , and @xmath is in the interior of @xmath ,

2.  two sections @xmath , @xmath .

3.  Let @xmath be an arbitrary open subset of the set of all points
    @xmath such that:

    1.  @xmath , @xmath (in particular, if @xmath is an ordinary point,
        @xmath ).

    2.  If @xmath is a special point and @xmath is in the interior of
        @xmath , then @xmath and @xmath are in the interior of the same
        normal subcone @xmath of the same vertex @xmath .

    3.  If @xmath is a special point and @xmath , then @xmath is in the
        interior of @xmath .

    4.  If @xmath is a special point and @xmath , then @xmath is in the
        interior of @xmath .

After these data are fixed, we will denote the basis of @xmath dual to
the basis @xmath of @xmath by @xmath . In other words, for each @xmath
we have @xmath .

@xmath is defined to be the set of points @xmath such that:

1.  @xmath ,

2.  @xmath ,

3.  if @xmath is in the interior of @xmath , then @xmath .

###### Lemma \thechapter.11.

If @xmath is an ordinary point, then:

1.   If @xmath , then @xmath .

2.   If @xmath , then @xmath .

3.   If @xmath is a degree in the interior of @xmath , then @xmath .

If @xmath is a special point, then:

1.   If @xmath , then @xmath .

2.   If @xmath , then @xmath .

3.   If @xmath is a degree in the interior of @xmath , and @xmath ),
    then @xmath .

###### Proof.

This follows directly from the definitions of the @xmath sets and of
@xmath . ∎

Fig. 4 shows how a set @xmath can intersect the fibers of @xmath in
@xmath .

We say that sets @xmath defined this way form a sufficient system if

1.  for every ordinary point @xmath there exists @xmath such that @xmath
    ,

2.  for every special point @xmath and for every normal subcone @xmath
    there exists an index @xmath such that @xmath and @xmath ,

3.  for every primitive degree @xmath such that @xmath and for every
    point @xmath there exists an index @xmath such that @xmath and
    @xmath .

Clearly, sufficient systems exist. An example of a sufficient system is
constructed in Section 14 . Fix a sufficient system and set @xmath .
Denote the number of sets @xmath in the sufficient system we chose by
@xmath .

We are going to prove that @xmath , i. e. that @xmath .

###### Lemma \thechapter.12.

@xmath .

###### Proof.

Let @xmath . For every degree @xmath such that @xmath , for every @xmath
we have @xmath . @xmath can be zero only if @xmath . If there are
functions @xmath , @xmath that do not vanish at @xmath , then @xmath ,
@xmath , but @xmath . So for at most one of the degrees @xmath and
@xmath there are functions of this degree that vanish at @xmath .
Without loss of generality suppose that if @xmath , then @xmath . If
@xmath , then @xmath for all multiples @xmath of @xmath , so for every
such @xmath all functions of degree @xmath vanish at @xmath . Otherwise
@xmath for every multiple @xmath of @xmath , and if @xmath , @xmath ,
then @xmath generate @xmath as a vector space, so all functions of
degree @xmath vanish at @xmath . Summarizing, we conclude that if @xmath
, then all functions of degree @xmath vanish at @xmath . Consequently,
if @xmath , then all functions of nonzero degree, i. e. all nonconstant
functions on @xmath vanish at @xmath . There exists only one such point
@xmath . Otherwise, if @xmath forms a basis of @xmath , then @xmath
forms a basis of @xmath , so values of all functions of all degrees at
@xmath are determined by @xmath . Therefore, such points @xmath form a
1-dimensional subset. ∎

Now we are going to consider points from @xmath .

###### Lemma \thechapter.13.

For every ordinary point @xmath we have @xmath .

###### Proof.

Clearly, @xmath . To prove the other inclusion, we use the description
of @xmath from Proposition \thechapter .6 . Recall that if @xmath for
some index @xmath , then @xmath . If @xmath , then it is sufficient to
take any index @xmath such that @xmath (it exists by the definition of a
sufficient system). Then by Proposition \thechapter .6 , @xmath , @xmath
, and @xmath . If @xmath , then @xmath , and there exists an index
@xmath such that @xmath and @xmath . Then @xmath is a function of degree
@xmath , so Proposition \thechapter .6 says that @xmath , and, since
@xmath , this is enough for @xmath to be in @xmath . The case @xmath can
be considered similarly. ∎

Now we are going to consider the fiber of @xmath over a special point
@xmath .

###### Lemma \thechapter.14.

Let @xmath be a special point. Then @xmath .

###### Proof.

We use the description of @xmath from Proposition \thechapter .10 .
First, pick a vertex @xmath ( @xmath ) and consider a point @xmath .
Since the system @xmath is sufficient, there exists @xmath such that
@xmath and @xmath . By the definition of @xmath , @xmath and @xmath ,
and by the definition of @xmath , @xmath and @xmath . Hence, @xmath .
Therefore, if @xmath , but @xmath , then @xmath for some (finite or
infinite) edge @xmath .

It is sufficient to prove that for each (finite or infinite) edge @xmath
, we have @xmath . Denote @xmath and choose a basis

  -- -------- --
     @xmath   
  -- -------- --

of @xmath as previously, i. e. so that @xmath , and @xmath for @xmath .
Consider a degree @xmath , @xmath . Choose a basis of @xmath as follows.
Its first element is @xmath , so we have @xmath . All other elements of
the basis, denoted by

  -- -------- --
     @xmath   
  -- -------- --

satisfy @xmath . We have already seen for such a basis that @xmath for
all @xmath , @xmath . So again values of all functions of all degrees at
@xmath are determined by @xmath , and @xmath is at most one-dimensional.
∎

We are going to use @xmath to compute cohomology groups, so we are going
to prove that all @xmath are affine. Fix an index @xmath .

###### Lemma \thechapter.15.

Let @xmath be a degree. Let @xmath . Then, independently of the signs of
@xmath and @xmath , @xmath .

###### Proof.

Recall that the function @xmath is always linear on the cone spanned by
@xmath and @xmath if @xmath . Hence, if @xmath and @xmath , then @xmath
. If @xmath or @xmath , in other words, if @xmath is not in the cone
generated by @xmath and @xmath , then, since @xmath is a convex
function, @xmath . ∎

###### Lemma \thechapter.16.

@xmath is isomorphic to @xmath , where @xmath is isomorphic to @xmath or
@xmath . More exactly, @xmath if and only if @xmath , otherwise @xmath .
@xmath is isomorphic to an open set in an affine line. The isomorphism
is given by @xmath . (Note that despite @xmath is rational on @xmath ,
it is defined everywhere on @xmath since @xmath by definition.)

###### Proof.

We know that @xmath , and to prove that @xmath is isomorphic to an open
subset in an affine line, it is sufficient to prove that @xmath cannot
be equal to @xmath . Indeed, if @xmath , then, in particular, @xmath .
If @xmath , this would mean that @xmath . But @xmath , and @xmath .

Consider the map @xmath given by @xmath (recall that @xmath is possible
in @xmath if and only if @xmath ). To define its inverse, we need for
every triple @xmath , where @xmath , @xmath , @xmath , define a point
@xmath . To do this, we define a homomorphism @xmath . We define it on
each graded component of @xmath .

Let @xmath be a degree. By Lemma \thechapter .15 ,

  -- -------- --
     @xmath   
  -- -------- --

Therefore, if @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

and the rational function @xmath is defined at @xmath .

Now we define a map @xmath as follows: if @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

Note that @xmath is possible if and only if @xmath , i. e. exactly if
and only if @xmath . It is clear from the construction that this map is
an algebra homomorphism, so it defines a point @xmath . If we choose a
set of homogeneous generators of @xmath , we see that the values of
these generators at @xmath depend algebraically on @xmath , @xmath , and
@xmath , so we have defined an algebraic morphism @xmath .

Now we are going to prove that two morphisms we have defined are
mutually inverse. Fix points @xmath , @xmath , and @xmath , denote
@xmath . First, @xmath since @xmath and @xmath . Now denote @xmath . For
every degree @xmath and for every pair of functions @xmath we have the
following equalities of rational functions ( @xmath , @xmath , @xmath
are arbitrary points):

  -- -------- --
     @xmath   
  -- -------- --

Choose a degree @xmath such that @xmath . By Corollary \thechapter .2 ,
there exist functions @xmath such that @xmath is defined at @xmath , and
if @xmath for some @xmath , then @xmath . By Proposition \thechapter .3
, @xmath is defined at @xmath , and @xmath . On the other hand, it
follows from the computation above that @xmath , so @xmath , and @xmath
. We have already checked that @xmath , a similar computation shows that
@xmath . The conditions from the definition of @xmath are therefore
satisfied, and @xmath .

Finally, check that the other composition of morphisms @xmath is also
the identity morphism. To do this, fix a point @xmath , a degree @xmath
and a function @xmath . We have the following equality of rational
functions:

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

since @xmath and @xmath are functions of the same degree. ∎

Since each set @xmath is affine and @xmath is separated, all
intersections of sets @xmath are also affine, and we can use them to
compute Cech cohomology on @xmath . However, we will also need to
understand the structure of intersections of @xmath . Fix several
indices @xmath .

###### Lemma \thechapter.17.

@xmath is isomorphic to @xmath , where @xmath is an open subset of
@xmath , and @xmath is isomorphic to @xmath or @xmath . The isomorphism
is given by @xmath (this is exactly the restriction of the isomorphism
from Lemma \thechapter .16 to the subset @xmath ).

In this case, @xmath if and only if @xmath .

Here the set of ordinary points in @xmath is the set of ordinary points
in @xmath . If @xmath is a special point, then @xmath if and only if
@xmath and all degrees @xmath belong to the normal subcone of the same
vertex of @xmath .

###### Proof.

Consider a fiber @xmath , where @xmath . It is a subset of @xmath ,
which is isomorphic to @xmath by Lemma \thechapter .16 . It is
sufficient to prove that for each @xmath , in terms of this isomorphism,
@xmath either is the empty set, or equals @xmath .

First, let @xmath be an ordinary point. If there exists an index @xmath
such that @xmath , then @xmath . Otherwise, consider a point @xmath .
There are two possibilities: either @xmath (in other words, the last
coordinate of @xmath in terms of the isomorphism @xmath from Lemma
\thechapter .16 is nonzero), or @xmath and @xmath (in other words, the
last coordinate of @xmath in terms of the isomorphism from Lemma
\thechapter .16 is zero). If the first possibility takes place, then, by
Proposition \thechapter .6 , @xmath for all @xmath . If the second
possibility takes place, then it follows from Proposition \thechapter .6
that @xmath if and only if @xmath (i. e. we have no condition for @xmath
, which is in fact zero since @xmath is in the interior of @xmath ) and
@xmath (otherwise @xmath ). This finishes the proof for an ordinary
point.

Now let @xmath be a special point. Again, if there exists an index
@xmath such that @xmath , then @xmath . Moreover, by Proposition
\thechapter .10 , if there exist no vertex @xmath such that @xmath for
all @xmath , then @xmath (recall that we require that @xmath is in the
interior of the normal cone of a vertex of @xmath , unless @xmath , in
the definition of @xmath , so @xmath cannot be in the normal cones of
two different vertices simultaneously). And again, if @xmath for all
@xmath and there exists a vertex @xmath such that @xmath for all @xmath
(by the definition of @xmath , this implies that @xmath is in the
interior of @xmath for all @xmath ), then there are two possibilities.
Either @xmath , (i. e. the last coordinate of @xmath is nonzero), or
@xmath and @xmath , (i. e. the last coordinate of @xmath is zero). The
rest of the proof repeats the proof for an ordinary point. Namely, if
the first possibility holds, it follows from Proposition \thechapter .10
that @xmath for all @xmath . If the second possibility holds, then, by
Proposition \thechapter .10 , @xmath if and only if @xmath (i. e. we
have no condition for @xmath , while @xmath since @xmath is in the
interior of @xmath ) and @xmath (this is a criterion for @xmath ,
nevertheless, this condition can only be violated if @xmath , i. e.
@xmath is a removable special point). ∎

### 13 Computation of @xmath in terms of cohomology of sheaves on @xmath

We know that @xmath , so Theorem \thechapter .4 can be applied. To apply
it, we need a set of generators of @xmath . We choose it as follows. For
each special point @xmath , the cone @xmath can be split into the union
of normal cones of all vertices of @xmath . All intersections of these
cones (for different special points) split @xmath into a fan, which we
call the total normal fan of @xmath . (It equals the normal fan of the
Minkowski sum of all polyhedra @xmath .) For each cone @xmath in this
fan, the function @xmath is linear. Choose a set of degrees @xmath
satisfying the following conditions:

1.  It contains the Hilbert bases of all cones of the total normal fan
    of @xmath .

2.  For each special point @xmath :

    1.  For each (finite or infinite) edge @xmath , @xmath .

    2.  For each vertex @xmath there exists a degree @xmath such that
        @xmath and @xmath form a lattice basis of @xmath

    3.  For each vertex @xmath there exists a degree @xmath such that
        @xmath and @xmath form a lattice basis of @xmath .

In fact, the first condition implies all three parts of the second one,
but we don’t need this fact and we will not prove it. For each @xmath ,
@xmath let @xmath be a basis of @xmath .

###### Lemma \thechapter.18.

All @xmath (for @xmath , @xmath ) together generate @xmath .

###### Proof.

It is sufficient to prove that every homogeneous element of @xmath can
be generated by @xmath . So, fix a degree @xmath , and let @xmath . If
@xmath , the claim is clear. Otherwise, choose a cone @xmath from the
total normal fan so that @xmath . @xmath is not an element of the
Hilbert basis of @xmath , so there exist @xmath , @xmath , @xmath , such
that @xmath . Since @xmath becomes a linear function after being
restricted to @xmath , @xmath .

Let @xmath be the number of points @xmath that are either special or are
zeros of @xmath . Denote zeros of @xmath that are ordinary points by
@xmath (recall that we have @xmath special points @xmath ). Consider the
following @xmath integers: @xmath . By the definition of @xmath , all
these numbers are nonnegative integers. Also, @xmath . Then it is
possible to split each of these numbers into a sum @xmath of two
nonnegative integers so that @xmath and @xmath (recall that @xmath ).
Then @xmath and @xmath are divisors of degree 0, and @xmath , @xmath .
Therefore, there exist functions @xmath and @xmath such that @xmath and
@xmath . Now, for every point @xmath we have the following: @xmath .
Hence, @xmath is a rational function on @xmath that does not have zeros
or poles, so it is a constant, and @xmath is a multiple of @xmath .

Repeating this procedure by induction on @xmath , we can write @xmath as
a product of functions whose degrees are in the set @xmath . ∎

Now we construct a map @xmath required for Theorem \thechapter .4 using
these generators. Recall that @xmath maps a vector field to the sequence
of the derivatives of all generators @xmath along this vector field.
Denote the total number of these generators by @xmath . By Theorem
\thechapter .4 , we have the following isomorphism of @xmath -modules:

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .16 , @xmath form an affine covering of @xmath , so
it can be used to compute homology groups in this formula as Cech
homology. Moreover, all conditions defining @xmath as subsets of @xmath
are formulated in terms of fibers of @xmath and inequalities of the form
@xmath , where @xmath is a homogeneous function. Since @xmath is @xmath
-invariant and the inequalities of form @xmath are also invariant if
@xmath is homogeneous, the sets @xmath are @xmath -invariant. The
sheaves involved in the formula above are the tangent bundle and the
trivial bundle, so @xmath acts on the modules of their sections on
@xmath . Hence, these modules are @xmath -graded. This enables us to
introduce an @xmath -grading on @xmath and on @xmath . The map @xmath is
defined by @xmath maps @xmath , each of them corresponds to a generator
@xmath of degree @xmath . It maps the graded component of @xmath of
degree @xmath to the graded component of @xmath of degree @xmath .
Hence, @xmath maps different graded components of @xmath to different
graded components of @xmath , and @xmath is a graded submodule in @xmath
. It follows from the proof of Theorem \thechapter .4 that the
isomorphism @xmath is an isomorphism of graded @xmath -modules. We are
going to study the zeroth graded component of @xmath .

Now, we apply Leray spectral sequence for the map @xmath and get the
following short exact sequences of @xmath -modules (note that Lemmas
\thechapter .13 and \thechapter .14 guarantee that @xmath ):

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

The Snake lemma yields the following exact sequence:

  -- -- --
        
  -- -- --

This is an isomorphism of @xmath -modules, and it is possible to
introduce an @xmath -grading on these modules. Indeed, in fact the
sheaves @xmath and @xmath are graded themselves, i. e. they are direct
sums of their graded components in the category of sheaves of @xmath
-modules, since their sections on any open subset @xmath are sections of
the tangent bundle and of rank @xmath trivial bundle on a @xmath
-invariant subset @xmath , and multiplication by functions from @xmath
does not change the grading of a section. This is also true for the
sheaves @xmath and @xmath if we compute them using Proposition
\thechapter .10 with @xmath being the required affine covering of @xmath
since in this case the module of sections of any sheaf in the complex on
any open subset @xmath is also a direct sum of modules of sections of
the tangent bundle or of the trivial bundle on a @xmath -invariant
subset of @xmath , and the differentials in the complex preserve this
grading. So, again there is an @xmath -grading on cohomology groups: on
@xmath , on @xmath , on @xmath , and on @xmath . And again, the map
@xmath is defined by @xmath maps @xmath , each of them corresponds to a
generator @xmath . It maps the graded component of @xmath of degree
@xmath to graded components of @xmath of degree @xmath . So, @xmath is
an @xmath -graded @xmath -module. This grading coincides (in terms of
the isomorphisms mentioned above) with gradings on @xmath and on @xmath
.

Now we are going to obtain a formula for the graded component of @xmath
of degree 0. Denote it by @xmath . Denote also the graded component of
@xmath of degree 0 by @xmath , the graded component of @xmath of degree
0 by @xmath . The superscript ” @xmath ” here indicates that these
sheaves by definition are just pushforwards of sheaves on @xmath , they
are defined ”invariantly” in contrast with the sheaves we will define
later using trivializations and transition matrices.

We need graded components of @xmath and of @xmath of different degrees,
so for a degree @xmath denote by @xmath the graded component of @xmath
of degree @xmath , and denote by @xmath the graded component of @xmath
of degree @xmath . The morphism @xmath maps @xmath to @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

The morphism @xmath maps @xmath to @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

So, the above exact sequence for @xmath can be written in the graded
form as follows:

###### Proposition \thechapter.19.

The following sequence is exact:

  -- -- --
        
  -- -- --

∎

Our next goal is to find expressions for the sheaves @xmath , @xmath ,
@xmath , and @xmath including only functions on @xmath and the
combinatorics of @xmath . Given an index @xmath and a point @xmath ,
Proposition \thechapter .16 provides an isomorphism between @xmath and
@xmath , where @xmath is @xmath or @xmath . Call the point identified by
this isomorphism with @xmath the canonical point in the fiber @xmath
with respect to @xmath . In other words, the canonical point in @xmath
with respect to @xmath is the (unique) point @xmath such that @xmath .

#### 13.1 Computation of @xmath

For each @xmath ( @xmath ) fix an embedding @xmath . As long as such an
embedding is fixed, we identify each point of @xmath with its coordinate
@xmath . Denote the coordinates of a point @xmath provided by the
isomorphism @xmath by @xmath , @xmath , @xmath .

We are going to study homogeneous vector fields of degree 0 (i. e.
@xmath -invariant vector fields) on open sets @xmath of the form @xmath
, where @xmath is an open subset, @xmath is @xmath or @xmath , @xmath is
defined in Lemma \thechapter .16 , and @xmath is embedded in @xmath as a
subset of @xmath via isomorphism from Lemma \thechapter .16 .

###### Lemma \thechapter.20.

Let @xmath be an open subset, @xmath be an open subset that can be equal
@xmath or @xmath , @xmath . A homogeneous vector field of degree 0 on
@xmath is uniquely determined by its values at canonical points in all
fibers @xmath (for @xmath ) with respect to @xmath . These values can be
arbitrary vectors depending algebraically on @xmath .

###### Proof.

Let @xmath be a vector field of degree 0 on @xmath , and suppose that
@xmath , where @xmath are algebraic functions. Since @xmath is the
character lattice of @xmath , and @xmath and @xmath form a basis of
@xmath , every pair @xmath uniquely and algebraically determines an
element @xmath such that @xmath , @xmath . This element acts on @xmath ,
i. e. it defines an automorphism of @xmath , which we also denote by
@xmath . Recall that @xmath , @xmath , and @xmath (resp. @xmath ) is a
function of degree @xmath (resp. @xmath ), so @xmath for every @xmath .
By the definition of a @xmath -invariant vector field, @xmath is a field
of degree 0 if and only if @xmath for every @xmath , @xmath . In
particular, this holds for @xmath , @xmath , so @xmath is uniquely
determined on @xmath , which is at least an open subset in @xmath , so
it is determined uniquely on @xmath .

We still have to check that if we start with arbitrary functions @xmath
, the vector field on @xmath constructed this way can be extended to the
whole @xmath if and only if @xmath satisfy the statement of the Lemma
and that the resulting vector field on @xmath is @xmath -invariant. To
do this, let us first write the vector field we have constructed in
terms of @xmath and @xmath . Take a point @xmath , @xmath . We have
@xmath . Clearly, functions of the form @xmath with @xmath , @xmath can
be extended to the whole @xmath .

Observe that to check homogeneity, we have to check an equality of two
vector fields for each @xmath . This equality holds if it holds on an
open subset of @xmath , in particular, it is sufficient to check
homogeneity of the resulting vector field on @xmath . Take a point
@xmath and an element @xmath . Denote by @xmath the element of @xmath
such that @xmath , @xmath . We have @xmath , and the vector field is
@xmath -invariant. ∎

###### Corollary \thechapter.21.

A homogeneous vector field @xmath of degree 0 on @xmath is also uniquely
determined by the following data:

1.   The derivatives of @xmath ( @xmath ) along @xmath at canonical
    points, considered as two algebraic functions @xmath .

2.   The vector field on @xmath obtained by applying @xmath to the
    values of @xmath at canonical points, @xmath .

The vector field and two functions can be arbitrary algebraic.

###### Proof.

Write @xmath . Then @xmath , @xmath ( @xmath ). ∎

Note that these data (the image of a vector at a canonical point under
@xmath , the derivatives of functions along @xmath ) do not depend on
the choice of an embedding @xmath . Given a vector field @xmath of
degree 0 on @xmath , we call the data from Corollary \thechapter .21 the
@xmath -description of @xmath . Also, the @xmath -description only
depends on the data we used to define the set @xmath (the degrees @xmath
and @xmath and the sections @xmath and @xmath ), not on the whole
sufficient system @xmath .

Observe also that the operation of taking the @xmath -description is
compatible with replacing @xmath by a smaller subset @xmath of the same
form, or, more precisely, we can say the following:

###### Remark \thechapter.22.

Let @xmath be a subset of @xmath of the same form, i. e. let @xmath be
an open subset, let @xmath be an open subset that can be equal @xmath or
@xmath , and let @xmath be embedded into @xmath via the embeddings
@xmath and @xmath above. Let @xmath be the restriction of @xmath to
@xmath . Then the @xmath -description of @xmath consists of the
restrictions from @xmath to @xmath of the vector field and two functions
forming the @xmath -description of @xmath .

Note that there are many possible descriptions for a given vector field
on @xmath , each one corresponds to one of the chosen open subsets
@xmath . Sometimes we will need many descriptions of a given vector
field on @xmath simultaneously. And sometimes we will simultaneously
deal with descriptions of many different vector fields. To distinguish
between these situations clearly, we will usually use ”standard”
subscripts to enumerate different descriptions of the same vector field,
for example:

  -- -------- --
     @xmath   
  -- -------- --

Here @xmath is the @xmath -description of a vector field that does not
depend on @xmath . If we have several different vector fields and one
description of each of them, we enumerate them using indices in
brackets, for example:

  -- -------- --
     @xmath   
  -- -------- --

Here @xmath can be, for example, the @xmath -description of a vector
field @xmath on @xmath , and these vector fields may vary independently.
These are only generic rules, they are stated here to demonstrate what
kind of notation will be used later. Every time, when we consider a
description of a vector field, we say explicitly which set @xmath we
use, which vector field or function on @xmath we describe, and how we
denote the description.

Later we will introduce @xmath -descriptions of homogeneous functions on
@xmath in a similar way, the only difference will be that the @xmath
-description of a homogeneous function consists of only one function on
@xmath , not of two functions and a vector field. When we have several
@xmath -descriptions of functions, we will use the same generic rules to
write their indices.

Choose two indices @xmath and @xmath ( @xmath ). The following lemma
relates the @xmath -description with the @xmath -description of a vector
field @xmath of degree 0. We need some more notation to formulate it.
Denote by @xmath the following @xmath -matrix:

  -- -------- --
     @xmath   
  -- -------- --

Denote

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is an arbitrary point, and the first and the second entry
in the third column are understood as rational covector fields on @xmath
. In particular, if @xmath , @xmath and @xmath are unit matrices. By
Lemma \thechapter .17 , @xmath is isomorphic to @xmath , where @xmath is
an open subset of @xmath , and @xmath is @xmath or @xmath . This product
is embedded into @xmath via the isomorphism from Lemma \thechapter .16 .

###### Lemma \thechapter.23.

Let @xmath be an open subset of @xmath , @xmath be an open subset of
@xmath , @xmath or @xmath , and let @xmath be embedded into @xmath via
the map from Lemma \thechapter .17 . Let @xmath be a vector field on
@xmath of degree 0, and let @xmath , @xmath , @xmath be the @xmath
-description of @xmath , and @xmath , @xmath , @xmath be the @xmath
-description of @xmath . Then for every @xmath

  -- -------- --
     @xmath   
  -- -------- --

In particular, @xmath .

###### Proof.

It is sufficient to check this equality on an arbitrary open subset of
@xmath , so let @xmath be an ordinary point. Let @xmath be the canonical
point in @xmath with respect to @xmath . It follows from the definition
of the canonical point that @xmath . Let @xmath be the canonical point
in @xmath with respect to @xmath . By Proposition \thechapter .6 ,
@xmath , @xmath , so @xmath .

Let @xmath be the element of @xmath such that @xmath , @xmath . It
defines an automorphism of @xmath , and we also denote this automorphism
by @xmath . Then @xmath , @xmath , @xmath , so @xmath .

Since @xmath is a vector field of degree 0, @xmath . Since @xmath , we
have @xmath , and @xmath .

Now we are going to compute @xmath . Until the end of the proof, denote
@xmath , @xmath , @xmath , and @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

Taking into account that @xmath , we get

  -- -------- --
     @xmath   
  -- -------- --

We are computing @xmath . We have @xmath . Since @xmath is a homogeneous
function of degree @xmath , we have the following equality of maps
@xmath : @xmath . So, @xmath . Similarly, @xmath .

Now we are going to deal with the last summand in the formula for @xmath
above. Since @xmath and @xmath are functions of the same degree @xmath ,
by Proposition \thechapter .3 we have the following equalities of maps
from the open subset where they are defined as regular functions, not
only as rational functions, to @xmath :

  -- -------- --
     @xmath   
  -- -------- --

As we already know, @xmath , @xmath . Also, @xmath by the definition of
@xmath , so these maps are defined at @xmath , and we get

  -- -------- --
     @xmath   
  -- -------- --

Finally, we get the following formula for @xmath :

  -- -------- --
     @xmath   
  -- -------- --

Similarly,

  -- -------- --
     @xmath   
  -- -------- --

∎

Now we are ready to describe the sheaf @xmath only using functions on
@xmath and the notion of a sufficient system of @xmath (which uses only
combinatorics of @xmath and functions on @xmath ). We will prove that it
is isomorphic to another sheaf (denoted by @xmath ), which will be
defined using functions and vector fields on @xmath satisfying certain
conditions. This is similar to the approach using transition matrices,
but the sheaf we will define does not have to be locally free.

Namely, consider the following sheaf @xmath . Let @xmath be an open
subset. The space of sections @xmath is the space of sequences of length
@xmath

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , @xmath satisfy the following condition: For every indices
@xmath :

  -- -------- --
     @xmath   
  -- -------- --

###### Proposition \thechapter.24.

@xmath is isomorphic to @xmath . For an open set @xmath , the
isomorphism maps a vector field @xmath defined on @xmath to the sequence

  -- -------- --
     @xmath   
  -- -------- --

such that @xmath is the @xmath -description of @xmath .

###### Proof.

This is a direct consequence of Lemma \thechapter .23 , Lemma
\thechapter .16 , and the definition of a pushforward of a sheaf. ∎

The following three lemmas make it easier to construct sections of
@xmath explicitly.

###### Lemma \thechapter.25.

All entries of @xmath are regular at ordinary points @xmath such that
@xmath .

###### Proof.

For constant entries the claim is clear, and non-constant entries are
logarithmic derivatives of functions

  -- -------- --
     @xmath   
  -- -------- --

If @xmath is an ordinary point and @xmath , then, by the definition of
@xmath and of @xmath , @xmath . Hence, both functions

  -- -------- --
     @xmath   
  -- -------- --

are defined at @xmath and do not vanish at @xmath , so their logarithmic
derivatives are regular at @xmath . ∎

###### Lemma \thechapter.26.

Let @xmath be a special point, and let @xmath and @xmath be two indices
such that @xmath , and @xmath and @xmath belong to the normal vertex
cones of two different vertices of @xmath . Then each non-constant entry
of @xmath has pole of degree exactly 1 at @xmath .

###### Proof.

We know that each of the degrees @xmath and @xmath belongs to the normal
subcone of exactly one vertex of @xmath , and this vertex is the same
one for @xmath and for @xmath . @xmath belong to the normal subcone of a
different vertex of @xmath , which is also unique. Since @xmath is a
convex function, it cannot be linear on the union of these two subcones,
and @xmath . Therefore,

  -- -------- --
     @xmath   
  -- -------- --

and, by a property of logarithmic derivative,

  -- -------- --
     @xmath   
  -- -------- --

The argument for the second non-constant entry of @xmath is similar. ∎

###### Lemma \thechapter.27.

For the matrices @xmath and @xmath defined above, one has @xmath and
@xmath for every triple of indices @xmath .

###### Proof.

The equality @xmath can be proved by a direct computation using linear
algebra. We omit this computation.

Now, to prove that @xmath , it is sufficient to check that

  -- -------- --
     @xmath   
  -- -------- --

By a property of logarithmic derivatives, if @xmath are (rational)
functions,

  -- -------- --
     @xmath   
  -- -------- --

Hence, the left-hand side of the equality we are proving can be written
as

  -- -- --
        
  -- -- --

Similarly, the right-hand side can be written as

  -- -------- --
     @xmath   
  -- -------- --

By taking into account that @xmath , we obtain the desired equality. ∎

#### 13.2 Computation of @xmath

Recall that we have denoted the graded component of @xmath of degree 0
by @xmath . Now we are going to compute @xmath using Proposition
\thechapter .10 . We can use @xmath as an affine covering of @xmath . We
have to consider a complex of sheaves on @xmath that we temporarily
denote by @xmath . For an open subset @xmath , @xmath consists of
sequences @xmath , where @xmath is a vector field on @xmath , @xmath
consists of sequences @xmath , where @xmath is a vector field on @xmath
, and @xmath consists of sequences @xmath , where @xmath is a vector
field on @xmath . Denote the graded components of degree 0 of the
pushforwards of these sheaves by @xmath , @xmath , @xmath ,
respectively. Using Corollary \thechapter .21 we get the following
description of these sheaves:

Consider the following sheaves @xmath , @xmath , and @xmath . For an
open subset @xmath , @xmath consists of sequences

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , @xmath . Then @xmath is isomorphic to @xmath , and the
isomorphism maps a sequence of @xmath vector fields @xmath to the
sequence

  -- -------- --
     @xmath   
  -- -------- --

where @xmath form the @xmath -description of @xmath .

@xmath consists of sequences @xmath , where @xmath , @xmath . Similarly,
@xmath is isomorphic to @xmath , and the isomorphism maps a sequence
@xmath of vector fields on open subsets of @xmath to the sequence @xmath
, where @xmath , @xmath and @xmath form the @xmath -description of a
vector field defined on @xmath . (In fact, at this point we can choose
arbitrarily whether this is the @xmath -description or the @xmath
-description of @xmath , and we choose that this is the @xmath
-description, and not the @xmath -description.)

Finally, @xmath consists of sequences @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

The isomorphism between @xmath and @xmath is constructed similarly, and
here we again say (we choose) that @xmath is the @xmath -description of
a vector field on @xmath , not its @xmath - or @xmath -description.

Let us compute the kernel @xmath . Denote it by @xmath . A kernel of a
sheaf map can be computed on each open subset independently, and the map
here comes from the standard Cech map @xmath via the pushforward and the
isomorphisms @xmath and @xmath defined above. Summarizing these
definitions (and choices between @xmath -descriptions made there), we
get the following formula for the map @xmath , where we have to
calculate a @xmath -description from a @xmath -description once:

  -- -------- --
     @xmath   
  -- -------- --

So we get the following description for @xmath . The space of sections
of @xmath over an open subset @xmath is the space of sequences of length
@xmath of the form @xmath , where @xmath and @xmath satisfy the
following condition: For every indices @xmath :

  -- -------- --
     @xmath   
  -- -------- --

Finally, by Proposition \thechapter .10 , @xmath is isomorphic to @xmath
, where the map @xmath can be written as follows:

  -- -------- --
     @xmath   
  -- -------- --

#### 13.3 Computation of @xmath

The sheaves @xmath can be computed similarly to @xmath . We start with
the following Lemma.

###### Lemma \thechapter.28.

Let @xmath be an open subset, @xmath be an open subset that can be equal
@xmath or @xmath , @xmath . A homogeneous function of degree @xmath on
@xmath is uniquely determined by its values at canonical points in all
fibers @xmath (for @xmath ) with respect to @xmath .

1.   If @xmath or @xmath , these values can form an arbitrary function
    depending algebraically on @xmath .

2.   If @xmath and @xmath , these values must vanish. This is only
    possible if @xmath .

###### Proof.

The proof is similar to the proof of Lemma \thechapter .20 . Denote the
coordinates of a point @xmath provided by the isomorphism @xmath by
@xmath , @xmath , @xmath . Let @xmath be a function of degree @xmath on
@xmath , and suppose that @xmath , where @xmath is an algebraic
function. Fix a pair @xmath and let @xmath be the element of @xmath such
that @xmath , @xmath . Denote by @xmath the automorphism of @xmath
provided by @xmath as well. By the definition of a homogeneous function
of degree @xmath , @xmath , so @xmath determines @xmath uniquely on
@xmath , which is at least an open subset in @xmath .

We still have to check that if we start with an arbitrary functions
@xmath , the resulting function on @xmath can be extended to the whole
@xmath if and only if @xmath or @xmath (in the last case there is
nothing to extend) and that the resulting function on @xmath is
homogeneous of degree @xmath . The function we have constructed can be
written as follows: @xmath . Recall that @xmath (resp. @xmath ) is a
function on @xmath of degree @xmath (resp. @xmath ), so this function is
clearly homogeneous of degree @xmath on @xmath . If the function can be
extended to the whole @xmath , it remains homogeneous there since
homogeneity means an equality of two functions for each element of
@xmath , and this equality holds if it holds on an open subset.

If @xmath , there is nothing to extend. If @xmath , @xmath can be
extended to @xmath if and only if @xmath .

Finally, @xmath , then @xmath , and if @xmath in this case, then @xmath
. ∎

Given a homogeneous function @xmath of degree @xmath defined on a set
@xmath as described in Lemma \thechapter .28 , we call the function
@xmath such that @xmath , where @xmath is the canonical point in @xmath
with respect to @xmath the @xmath -description of @xmath . Again, the
@xmath -description of a function only depends on the data we used to
define the set @xmath (the degrees @xmath and @xmath and the sections
@xmath and @xmath ), not on the whole sufficient system @xmath . And
again we can make a remark similar to Remark \thechapter .22 :

###### Remark \thechapter.29.

Let @xmath and @xmath be open subset, and @xmath or @xmath . These
embeddings give rise to an embedding of @xmath into @xmath . Let @xmath
be the restriction of @xmath to @xmath . Then the @xmath -description of
@xmath is the restriction of the @xmath -description of @xmath to @xmath
.

Now we are going to relate the @xmath -description of a homogeneous
function of degree @xmath defined on an open subset of @xmath with its
@xmath -description. To formulate this relation, we need to introduce
some notation. Denote the following rational function of @xmath :

  -- -------- --
     @xmath   
  -- -------- --

In particular, if @xmath , then @xmath . This time it is a trivial
observation that these functions satisfy conditions similar to Lemma
\thechapter .27 for matrices @xmath and @xmath :

###### Remark \thechapter.30.

For every three indices @xmath one has @xmath .

By Lemma \thechapter .17 , @xmath can be written as @xmath , where
@xmath is an open subset, and @xmath equals @xmath or @xmath . This
product is embedded into @xmath via the isomorphism from Lemma
\thechapter .16 .

###### Lemma \thechapter.31.

Let @xmath be an open subset of @xmath , @xmath be an open subset of
@xmath , @xmath or @xmath , and let @xmath be embedded into @xmath via
the map from Lemma \thechapter .17 .

Let @xmath be a homogeneous function on @xmath of degree @xmath , and
let @xmath (resp. @xmath ) be the @xmath -description (resp. @xmath
-description) of @xmath . Then for every @xmath :

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

As in the proof of Lemma \thechapter .23 , it is sufficient to prove the
equality for all ordinary points @xmath . So let @xmath be an ordinary
point and let @xmath (resp. @xmath ) be the canonical point in @xmath
with respect to @xmath (resp. to @xmath ). It follows from Proposition
\thechapter .6 that @xmath , @xmath , hence @xmath .

Let @xmath be the element of @xmath such that @xmath , @xmath . As
usual, denote the corresponding automorphism of @xmath by @xmath as
well. Since @xmath (resp. @xmath ) is a homogeneous function of degree
@xmath (resp. @xmath ), @xmath , @xmath , so @xmath .

Since @xmath is a homogeneous function of degree @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Recall that @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

Since the numerator and the denominator of this fraction are homogeneous
functions of degree @xmath , by Proposition \thechapter .3 ,

  -- -------- --
     @xmath   
  -- -------- --

∎

Recall that for a degree @xmath we have denoted by @xmath the graded
component of @xmath of degree @xmath . Lemma \thechapter .31 enables us
to formulate a description of @xmath similar to the description of
@xmath above. Namely, define a sheaf @xmath as follows: Let @xmath be an
open subset. The space of sections @xmath is the space of sequences
@xmath of functions on @xmath satisfying the following conditions:

1.  @xmath for all indices @xmath .

2.  If @xmath and @xmath , then @xmath .

###### Lemma \thechapter.32.

@xmath is isomorphic to @xmath . If @xmath is a function on @xmath of
degree @xmath , then the isomorphism maps it to @xmath , where @xmath is
the @xmath -description of @xmath .∎

The following lemma gives an alternative description of @xmath if @xmath
.

###### Lemma \thechapter.33.

If @xmath , then @xmath . The isomorphism @xmath is given by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , @xmath is an open subset.

###### Proof.

First, let @xmath be a function. Then it is clear that @xmath satisfy
the conditions @xmath from Lemma \thechapter .32 by construction. The
condition 2 from the definition of @xmath is void since @xmath . We have
to check that @xmath are well-defined at points @xmath . If @xmath ,
then by Lemma \thechapter .15 , @xmath . By the definition of @xmath ,
@xmath , @xmath . Since @xmath , @xmath , so @xmath , and @xmath is
well-defined on @xmath . Therefore, @xmath defines an element of @xmath
.

Now, let @xmath . The condition @xmath guarantees that @xmath does not
depend on @xmath as a rational function. We have to check that @xmath .
Let @xmath be an ordinary point. By the definition of a sufficient
system, there exists an index @xmath such that @xmath . Then @xmath is
well-defined as @xmath , and @xmath and @xmath are defined at @xmath
since @xmath is an ordinary point.

Now suppose that @xmath is a special point. Let @xmath be a vertex such
that @xmath By the definition of a sufficient system, there exists an
index @xmath such that @xmath and @xmath . The function @xmath is linear
on @xmath so @xmath . Then @xmath . Therefore, @xmath . ∎

###### Corollary \thechapter.34.

@xmath .

###### Proof.

Recall that

  -- -------- --
     @xmath   
  -- -------- --

where @xmath form the Hilbert basis of @xmath , in particular, @xmath .
Therefore,

  -- -------- --
     @xmath   
  -- -------- --

In particular, @xmath are divisors of non-negative degree on @xmath ,
and @xmath . ∎

#### 13.4 Computation of @xmath

We can compute @xmath using Proposition \thechapter .10 with @xmath
being the required affine covering of @xmath . Recall that for each
@xmath , @xmath is the graded component of @xmath of degree @xmath .
Again denote temporarily the complex of sheaves on @xmath we have to
consider in Proposition \thechapter .10 by @xmath . Let @xmath be an
open subset of @xmath . Then @xmath consists of sequences @xmath , where
@xmath , @xmath consists of sequences @xmath , where @xmath , and @xmath
consists of sequences @xmath , where @xmath . Denote the graded
components of degree @xmath of the pushforwards of these sheaves by
@xmath , @xmath , @xmath , respectively. Denote also

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

  -- -- --
        
  -- -- --

We get the following descriptions of these sheaves from Lemma
\thechapter .28 :

Define sheaves @xmath , @xmath , @xmath as follows. Fix an an open
subset @xmath . Let @xmath be the space of sequences of the form @xmath
, where @xmath and @xmath if @xmath and @xmath . Then @xmath , and the
isomorphism maps a sequence @xmath of functions of degree @xmath defined
on open subsets of @xmath to @xmath , where @xmath is the @xmath
-description of @xmath .

Let @xmath be the space of sequences @xmath , where @xmath . These
functions should be zero in some cases if @xmath (see Lemma \thechapter
.17 ). To define these cases, note first that if @xmath , then @xmath .
So, the condition is: If @xmath , then @xmath . Again, @xmath , and the
isomorphism maps a sequence @xmath of functions of degree @xmath defined
on open subsets of @xmath to the sequence @xmath of functions on @xmath
such that @xmath is the @xmath -description of @xmath . (Again, we could
choose the @xmath -description here, as well, but we choose the @xmath
-description.)

Finally, let @xmath be the space of sequences @xmath , where @xmath and,
as in the previous case, @xmath if @xmath and @xmath . Then @xmath , the
isomorphism is constructed similarly, and again we say that @xmath is
the @xmath -description of a function defined on @xmath , not its @xmath
- or @xmath -description.

Denote @xmath , where the map @xmath comes from the standard Cech map
@xmath via the pushforward, then the restriction to the degree @xmath ,
and then the isomorphisms @xmath and @xmath defined above. To compute a
kernel of a map between sheaves, it is sufficient to compute the kernels
of the corresponding maps between modules on each open subset. So let
@xmath be an open subset. Taking into account the choice of @xmath
-description in the definition of the isomorphisms @xmath and @xmath ,
we see that the corresponding map @xmath can be written as follows:

  -- -------- --
     @xmath   
  -- -------- --

and @xmath is the space of sequences of the form @xmath , where @xmath
satisfy the following conditions:

1.  @xmath for all indices @xmath .

2.  If @xmath and @xmath then @xmath .

Now, by Proposition \thechapter .10 , @xmath is isomorphic to @xmath ,
where the map @xmath can be written as follows: @xmath . After we have
defined the sheafs @xmath and @xmath isomorphic to @xmath and @xmath
(respectively) for each degree @xmath , we define

  -- -------- --
     @xmath   
  -- -------- --

We can also shortly write

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

Then @xmath is the cohomology in the middle of the complex @xmath .

#### 13.5 Final remarks for the computation of @xmath

Proposition \thechapter .19 involves (in particular) the map @xmath .
The isomorphisms @xmath and @xmath constructed above enable us to
consider a map @xmath instead. Denote it by @xmath , The following lemma
establishes relations between @xmath -descriptions of sections of @xmath
and their images under @xmath , so it will help us to understand this
map.

###### Lemma \thechapter.35.

Let @xmath be an open subset of @xmath , @xmath be an open subset of
@xmath , @xmath or @xmath , and let @xmath be embedded into @xmath via
the map from Lemma \thechapter .16 .

Let @xmath be the @xmath -description of a vector field @xmath defined
on @xmath , @xmath be a degree, @xmath . Then the @xmath -description of
@xmath is

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

The proof is similar to the proof of Lemma \thechapter .23 . It is
sufficient to prove the equality for an arbitrary open subset of @xmath
, so let @xmath be an arbitrary point, and let @xmath be the canonical
point in @xmath with respect to @xmath . Denote @xmath , @xmath , and
denote by @xmath the @xmath -description of the function @xmath . Then
@xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

@xmath and @xmath are homogeneous functions of degree @xmath , so by
Proposition 1 we have the following equality of rational maps from
@xmath to @xmath :

  -- -------- --
     @xmath   
  -- -------- --

Therefore,

  -- -------- --
     @xmath   
  -- -------- --

Finally, we get

  -- -------- --
     @xmath   
  -- -------- --

∎

Summarizing, we have found an explicit description for the sheaves
@xmath , @xmath , @xmath , @xmath , @xmath , and @xmath and for the map
@xmath , and all sheaves involved in Proposition \thechapter .19 can be
obtained from these sheaves by taking a cokernel of a map we have
explicitly described and forming a direct sum.

By Corollary \thechapter .34 ,

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

and the exact sequence from Proposition \thechapter .19 can be written
in the following form:

###### Theorem \thechapter.36.

Let @xmath , @xmath , and @xmath be the sheaves on @xmath introduced
above, on pages \thechapter .23 , 13.2 , and 13.4 (respectively). Then
the following sequence is exact:

  -- -------- --
     @xmath   
  -- -------- --

∎

Let us prove one more lemma about functions defined on @xmath . We will
need it later.

###### Lemma \thechapter.37.

Let @xmath be a degree, and let @xmath . Let @xmath be a rational
function on @xmath . The rational function @xmath on @xmath is regular
on @xmath if and only if:

1.   A rational function @xmath is defined at all regular points of
    @xmath .

2.   For each special point @xmath , @xmath

###### Proof.

Let us suppose that conditions 1 and 2 are satisfied and prove that
@xmath is regular on @xmath .

First, note that

  -- -------- --
     @xmath   
  -- -------- --

is a regular function on @xmath . Indeed, if @xmath is an ordinary
point, then @xmath has no pole at @xmath , and the functions @xmath
@xmath do not have poles or zeros at @xmath . And if @xmath is a special
point, then @xmath for @xmath . So, @xmath is the @xmath -description of
a regular homogeneous function of degree @xmath on @xmath , which we
will denote by @xmath .

Let @xmath be an ordinary point. Suppose that @xmath is defined at
@xmath . Then @xmath is defined at each point of @xmath . Let @xmath be
the canonical point in @xmath . By the definition of an @xmath
-description, @xmath . On the other hand, by Proposition \thechapter .3
,

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath is the canonical point in @xmath , @xmath , and @xmath .
So, @xmath . Moreover, both @xmath and @xmath are homogeneous functions
of degree @xmath with respect to the torus action, so, @xmath and @xmath
coincide on the whole fiber @xmath .

All ordinary points @xmath such that @xmath is defined at @xmath form a
non-empty open subset of @xmath . Therefore, @xmath coincides with
@xmath on an open subset of @xmath . But @xmath is regular on @xmath ,
so @xmath is regular on @xmath as well.

Now suppose that @xmath is regular on @xmath . Again consider the
following rational function @xmath on @xmath :

  -- -------- --
     @xmath   
  -- -------- --

If @xmath is an ordinary point, @xmath is defined at @xmath , and @xmath
is the canonical point in @xmath , then by Proposition \thechapter .3 ,

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath is the canonical point, @xmath . Therefore, @xmath
coincides with the @xmath -description of @xmath on a non-empty open
subset of @xmath . But then @xmath is the @xmath -description of @xmath
, and @xmath is defined everywhere on @xmath . Again, recall that @xmath
@xmath do not have poles or zeros at ordinary points of @xmath , and if
@xmath is a special point, then @xmath for @xmath . ∎

## Chapter \thechapter Combinatorial formula for the dimension of the
graded component of @xmath of degree zero

### 14 Construction of a particular sufficient system

Without loss of generality, in this section we will assume that there
are at least two special points (we always can add trivial special
points). Recall that we have a coordinate function @xmath on @xmath .
Now we will need more coordinate functions on @xmath (i. e. rational
functions with one pole and one zero, both are of order 1). Namely, for
each special point @xmath , we will need a coordinate function on @xmath
that vanishes at @xmath . Choose such coordinate functions and denote
them by @xmath . We are also going to construct a sufficient system of
sets @xmath more explicitly.

###### Lemma \thechapter.1.

Let @xmath be a special point and let @xmath be a degree. There exists a
rational function @xmath such that @xmath , and @xmath does not have
zeros or poles at ordinary points.

###### Proof.

Choose a rational function @xmath on @xmath that has one simple zero and
one simple pole, and that takes finite values at all special points.
(For example, if @xmath is an ordinary point, we can take @xmath ,
otherwise we can take @xmath , where @xmath and @xmath is an ordinary
point.) Then each function @xmath , where @xmath again has one simple
zero and one simple pole.

Recall that we have denoted all special points by @xmath . Let @xmath .
Denote @xmath . Since @xmath , there exist @xmath such that @xmath and
@xmath for @xmath . Consider the following function: @xmath Since the
sum of the exponents is zero, @xmath is defined and takes value 1 at the
(ordinary) point of @xmath where @xmath . Clearly, @xmath has no zeros
or poles at other ordinary points. At @xmath , we have @xmath , and at
@xmath ( @xmath ), we have @xmath . ∎

We are going to use a sufficient system @xmath constructed as follows.
We have several (in fact, up to two) sets @xmath for every pair @xmath ,
where @xmath is a special point, and @xmath corresponds to a vertex
@xmath of @xmath ( @xmath , we write @xmath instead of @xmath to
simplify notation). Each of these sets @xmath chosen for @xmath
corresponds to a face of @xmath (which can be @xmath , @xmath , or the
interior of @xmath ). These sets together are @xmath Additionally, we
will use one more set, which is @xmath , and which does not correspond
to any special point.

More precisely, for every special point @xmath , for every vertex @xmath
of @xmath and for each of the two rays @xmath and @xmath forming @xmath
we choose a basis of @xmath as follows. First, let @xmath be the lattice
basis of the chosen ray. If @xmath , we do not choose a basis for this
pair @xmath and for this ray. If @xmath , we do not choose a basis for
this pair @xmath and for this ray. Otherwise, we choose a basis @xmath
of @xmath , where @xmath and @xmath is a lattice point in the interior
of @xmath .

We choose a basis of @xmath corresponding to a pair @xmath and to the
interior of @xmath only if at the previous step we finally did not
choose any basis corresponding to the pair @xmath and to one of the two
rays @xmath and @xmath (for example, this can happen if @xmath ). In
this case, we choose a basis @xmath of @xmath such that @xmath and
@xmath are lattice points in the interior of @xmath . We continue using
the notation @xmath for the dual bases.

Observe that we chose exactly one or two bases for each pair @xmath . We
chose two bases if and only if @xmath is a removable special point and
@xmath and @xmath .

Now for every chosen basis, we choose functions @xmath and @xmath
satisfying the conditions of Lemma \thechapter .1 for the corresponding
special point @xmath and the degree @xmath or @xmath , respectively.
Then we may set @xmath to consist of all ordinary points and @xmath .

We enumerate the sets @xmath so that the sets corresponding to @xmath go
first, then the sets corresponding to @xmath , etc. Among the sets
corresponding to a single essential special point @xmath , we have
exactly one set @xmath for each vertex of @xmath . We enumerate them
along with the enumeration of vertices, i. e. first we take the set
corresponding to @xmath , then the set corresponding to @xmath , etc,
then the set corresponding to @xmath . If we have two sets @xmath
corresponding to the same removable special point, we enumerate them
arbitrarily.

These were the sets @xmath . To define the set for the sufficient
system, i. e. @xmath , choose an arbitrary basis @xmath of @xmath such
that @xmath are in the interior of @xmath , and choose functions @xmath
and @xmath that do not have zeros or poles at ordinary points (such
functions exist by Lemma \thechapter .1 ). In this case, let @xmath be
the set of all ordinary points.

Note that if we remove @xmath , we will still get a sufficient system.
We will use whole system @xmath to compute @xmath , and the smaller
sufficient system @xmath to compute @xmath and @xmath , During the
computation of @xmath and @xmath , the set @xmath will only be used
sometimes to define @xmath -descriptions sometimes.

### 15 Computation of the dimension of @xmath

We start with @xmath . To compute this space, we need an affine covering
of @xmath . So, for each special point @xmath , we denote by @xmath the
set consisting of all ordinary points of @xmath and @xmath . These sets
@xmath really form an affine covering since we have at least two special
points. Denote also the set of all ordinary points by @xmath . It
follows directly from the definition of @xmath that the restriction maps
to nonempty open sets are injective. Note also that if @xmath are
special points, then @xmath . So we can use Corollary \thechapter .13
for Cech cohomology. By Corollary \thechapter .13 ,

  -- -------- --
     @xmath   
  -- -------- --

For an essential special point @xmath , denote by @xmath the space of
triples @xmath , where @xmath , @xmath , and @xmath . The last index
@xmath indicates that these triples will be considered as @xmath
-descriptions of vector fields on @xmath .

###### Lemma \thechapter.2.

Let @xmath be an essential special point. Then @xmath can be identified
with @xmath .

The isomorphism here maps @xmath to @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

First, we have to check that the @xmath -tuple obtained this way from an
element of @xmath really defines an element of @xmath . The equalities

  -- -------- --
     @xmath   
  -- -------- --

for arbitrary indices @xmath follow from Lemma \thechapter .27 . All
functions @xmath and @xmath are regular at ordinary points by Lemma
\thechapter .25 . Let @xmath be an index such that @xmath corresponds to
the special point @xmath in the above construction. We have

  -- -------- --
     @xmath   
  -- -------- --

The covector field in the last summand is a logarithmic derivative of a
rational function on @xmath , so it cannot have a pole of order more
than 1. Since @xmath , @xmath is defined at @xmath . The argument for
@xmath is similar.

Clearly, this map from the space of triples to @xmath is injective. To
prove surjectivity, we have to check that if @xmath , then @xmath and
@xmath and @xmath have no poles at @xmath . Let @xmath and @xmath be two
open subsets corresponding to the special point @xmath and two normal
subcones of two different vertices of @xmath . If @xmath , then by Lemma
\thechapter .26 ,

  -- -------- --
     @xmath   
  -- -------- --

and @xmath , @xmath and @xmath cannot be defined at @xmath
simultaneously. Therefore, @xmath . Finally,

  -- -------- --
     @xmath   
  -- -------- --

Again, covector field in the last summand here is a logarithmic
derivative of a rational function on @xmath , so it cannot have a pole
of order more than 1. Since @xmath , @xmath has no pole at @xmath .
Similarly, @xmath has no pole at @xmath . ∎

Now let @xmath be an essential special point. Recall that @xmath is a
coordinate function on @xmath that has a (simple) zero at @xmath .
Denote by @xmath the space of triples of Laurent polynomials of the form
@xmath .

###### Lemma \thechapter.3.

If @xmath is an essential special point, then @xmath is isomorphic to
@xmath . The isomorphism here is the composition of the map

  -- -- --
        
  -- -- --

where

  -- -------- --
     @xmath   
  -- -------- --

and the canonical projection @xmath .

If @xmath is a section that belongs to the same coset in @xmath as the
image of @xmath under the isomorphism above, then @xmath and @xmath are
functions regular at @xmath , and @xmath is a vector field that vanishes
at @xmath .

###### Proof.

The proof is similar to the proof of the previous lemma. Let @xmath .
Denote its image in @xmath by @xmath . The functions @xmath and @xmath
and the vector field @xmath have no poles except @xmath , the entries of
@xmath have no poles at ordinary points by Lemma \thechapter .25 , so
@xmath . Therefore, @xmath really defines an element of @xmath since all
necessary equations are satisfied by Lemma \thechapter .27 .

Now let @xmath be a section. Let

  -- -------- --
     @xmath   
  -- -------- --

be the Laurent series for @xmath , @xmath , and @xmath , respectively
(in the sense of complex analysis). Denote

  -- -------- --
     @xmath   
  -- -------- --

These sums are finite, so they define algebraic rational functions and
an algebraic rational vector field. Hence, @xmath , @xmath , and @xmath
are also algebraic rational. They are defined at @xmath in
complex-analytic sense, hence they have no poles at @xmath in algebraic
sense. Note also that @xmath . By Lemma \thechapter .2 , the triple
@xmath defines an element of @xmath , so @xmath is equivalent to @xmath
in @xmath . But @xmath , so the map from @xmath to @xmath is surjective.
The injectivity of the map @xmath is clear, and it follows from Lemma
\thechapter .2 that the only triple that maps to @xmath is @xmath . ∎

Let @xmath be a removable special point, and let @xmath be a subset of
@xmath corresponding to @xmath . Denote by @xmath the space of triples
@xmath , where @xmath , @xmath , but this time it is not necessarily
true that @xmath . The last index @xmath in the notation @xmath
indicates that these triples will be considered as @xmath -descriptions
of vector fields on @xmath .

###### Lemma \thechapter.4.

Let @xmath be a removable special point, and let @xmath be a subset of
@xmath corresponding to @xmath . Then @xmath can be identified with
@xmath .

The isomorphism here maps @xmath to @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

The proof is similar to the proofs of two previous lemmas. All necessary
linear equations in the definition of @xmath are satisfied by Lemma
\thechapter .27 . We only have to check that if @xmath is another subset
of @xmath corresponding to @xmath , then @xmath and @xmath do not have
poles at @xmath . The only entries of @xmath that could have poles at
@xmath are

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

Consider the first one of them, the second one is considered similarly.
We have @xmath , @xmath , @xmath . Since @xmath is a removable special
point and @xmath , @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

Therefore, the logarithmic derivative of this function does not have a
zero or a pole at @xmath , and @xmath is well-defined at @xmath . The
argument for @xmath is similar.

The injectivity of the map from @xmath to @xmath is again clear since a
@xmath -tuple defines the zero section only if all entries are zeros,
and the surjectivity is also clear this time since in every section from
@xmath , @xmath , @xmath , and @xmath should be well-defined at @xmath .
∎

Note that in this lemma, we use an affine open set @xmath , which
depends on @xmath , and in fact used the @xmath -description of a vector
field, while in Lemma \thechapter .2 we used @xmath , which did not
depend on @xmath , and used the @xmath -description. However, in the
next lemma, we are going to use @xmath again.

For a removable special point @xmath , denote by @xmath the space of
triples of Laurent polynomials of the form @xmath .

###### Lemma \thechapter.5.

If @xmath is a removable special point, the space @xmath can be
identified with @xmath .

More exactly, these three Laurent polynomials are three last entries in
a @xmath -tuple defining an element of @xmath , which in turn defines a
coset in @xmath . In other words, the isomorphism is the composition of
the map

  -- -- --
        
  -- -- --

where

  -- -------- --
     @xmath   
  -- -------- --

and the canonical projection @xmath .

The vector field here always differs from the last entry of any element
of @xmath from the same coset in @xmath by a vector field that has no
pole at @xmath . This is true for the two functions if the vector field
is zero in both representatives of the coset.

###### Proof.

First, if @xmath , then @xmath , @xmath , and @xmath have no poles
outside @xmath , entries of @xmath have no poles at ordinary points, and
all necessary equations are satisfied by Lemma \thechapter .27 , so
these functions and this vector field really define an element of @xmath
, and hence an element of @xmath .

The proof of injectivity is quite easy. If @xmath , then @xmath since
otherwise it has pole at @xmath . But then we can choose an open set
@xmath corresponding to @xmath and write

  -- -------- --
     @xmath   
  -- -------- --

The matrix @xmath has only constant entries, so if @xmath and @xmath are
regular at @xmath , then @xmath and @xmath are regular at @xmath as
well. But then @xmath .

Now we prove surjectivity. Let @xmath be a section. Choose an index
@xmath such that @xmath corresponds to @xmath and write complex-analytic
Laurent series:

  -- -------- --
     @xmath   
  -- -------- --

Set

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath ( @xmath ). Observe that @xmath , @xmath and @xmath are
well-defined at @xmath , so @xmath . The image of this element of @xmath
under the isomorphism from Lemma \thechapter .4 equals @xmath , hence,
by Remark \thechapter .22 , @xmath defines the zero coset in @xmath . It
is sufficient to prove that @xmath is in the image of the morphism
@xmath .

Now write

  -- -------- --
     @xmath   
  -- -------- --

(without loss of generality, we may suppose that @xmath and @xmath did
not change, we may add more zeros in the negative part of Laurent
series) and recall that

  -- -------- --
     @xmath   
  -- -------- --

Set

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath ( @xmath ). Then @xmath . Since @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

Hence, @xmath and @xmath are regular at @xmath , @xmath , and the
isomorphism from Lemma \thechapter .4 maps this triple to @xmath .
Therefore, @xmath defines the same coset in @xmath as @xmath , which is
the image of @xmath .

During the proof of surjectivity, we have changed the vector field from
@xmath to @xmath , and we chose @xmath so that @xmath is regular at
@xmath . If we started with @xmath , then @xmath as well. In this case

  -- -------- --
     @xmath   
  -- -------- --

@xmath and @xmath are regular at @xmath by construction, all entries in
@xmath are constants, so @xmath and @xmath are regular at @xmath .
Recall also that @xmath and @xmath are regular at @xmath by
construction, so finally we see that @xmath and @xmath are regular at
@xmath if @xmath . ∎

Note that in this lemma, we do not claim (and this is not true in
general) that if @xmath is any representative of the coset in @xmath
defined by three Laurent polynomials in lemma, then, for example, the
difference between the first of these Laurent polynomials and @xmath is
regular at @xmath . We only claim that this is true if @xmath and the
third Laurent polynomial is also @xmath , and we also claim that
independently of @xmath , there always exists such a representative in
the coset.

Using Lemmas \thechapter .3 and \thechapter .5 , we identify the direct
sum

  -- -------- --
     @xmath   
  -- -------- --

with the space

  -- -------- --
     @xmath   
  -- -------- --

of @xmath -tuples of Laurent polynomials of a certain form, where the
first three polynomials correspond to @xmath , the second three
polynomials correspond to @xmath , etc.

###### Lemma \thechapter.6.

Let

  -- -------- --
     @xmath   
  -- -------- --

be an element of @xmath . Then there exists another element

  -- -------- --
     @xmath   
  -- -------- --

such that these two elements represent the same class in

  -- -------- --
     @xmath   
  -- -------- --

and @xmath is a vector field regular at @xmath for all @xmath .

###### Proof.

All @xmath ’s can be written using Laurent polynomials as follows:
@xmath or @xmath , the exact form depends on whether @xmath is a
removable special point or an essential special point. Denote @xmath (if
@xmath is removable, then @xmath ). This vector field is regular at all
points of @xmath except @xmath (including the point @xmath , where it
has a zero of of order 3). Then @xmath , and we can construct an element
of @xmath similarly to what we did in previous proofs: we set @xmath ,
and

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .25 , all entries in @xmath are regular at ordinary
points, and

  -- -- --
        
  -- -- --

Now, by Lemmas \thechapter .3 and \thechapter .5 , this section defines
elements of @xmath of the form @xmath , where @xmath is regular at
@xmath . Recall that @xmath is regular at @xmath if @xmath , so @xmath
is regular at @xmath as well. Also, @xmath is regular at @xmath , so
@xmath is regular at @xmath . Finally, we set

  -- -------- --
     @xmath   
  -- -------- --

The sequence @xmath defines an element of the zero coset in

  -- -------- --
     @xmath   
  -- -------- --

by construction. Therefore, @xmath defines the same coset as @xmath in

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Lemma \thechapter.7.

Suppose that

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

define the same class in @xmath , and for every @xmath , @xmath and
@xmath are regular at @xmath . Then there exists a globally defined
vector field @xmath such that @xmath if @xmath is an essential special
point.

And vice versa, if

  -- -------- --
     @xmath   
  -- -------- --

is such that every @xmath is regular at @xmath , and @xmath is a
globally defined vector field, then there exists

  -- -------- --
     @xmath   
  -- -------- --

equivalent to @xmath in

  -- -------- --
     @xmath   
  -- -------- --

and such that @xmath is regular at @xmath for every @xmath . Here @xmath
for all @xmath such that @xmath is an essential special point.

###### Proof.

The first statement follows easily from Lemmas \thechapter .3 and
\thechapter .5 . Namely, all triples @xmath define the same section from
@xmath in the sense of Lemmas \thechapter .3 and \thechapter .5 applied
at @xmath . This element of @xmath can be written as @xmath . Let us
prove that @xmath is the desired vector field. We know that @xmath is
defined at all ordinary points. If @xmath is a removable special point,
then by Lemma \thechapter .5 , @xmath is regular at @xmath , but we
already know that @xmath is regular at @xmath , so @xmath is regular at
@xmath . If @xmath is an essential special point, then by Lemma
\thechapter .3 , @xmath is defined at @xmath and equals 0 there. Hence,
@xmath is defined at @xmath , and @xmath .

The proof of the second statement is similar to the proof of the
previous lemma. Namely, we start with @xmath and construct a section
@xmath via

  -- -------- --
     @xmath   
  -- -------- --

This section defines elements of @xmath , and the isomorphisms from
Lemmas \thechapter .3 and \thechapter .5 map them to @xmath . Both
Lemmas say that @xmath is defined at @xmath , and, since @xmath is
defined globally, @xmath is defined at @xmath . So we can set @xmath ,
@xmath , and @xmath . If @xmath is an essential special point, Lemma
\thechapter .3 says that @xmath , so @xmath . ∎

###### Lemma \thechapter.8.

Let

  -- -------- --
     @xmath   
  -- -------- --

Then this element of @xmath and

  -- -------- --
     @xmath   
  -- -------- --

define the same class in

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

The proof is similar to the proof of Lemma \thechapter .6 . Since all
@xmath here are Laurent polynomials of the form @xmath (we do not mean
here that @xmath , so we can use the same @xmath for all polynomials),
they have no poles except @xmath , and functions @xmath and @xmath have
no poles at ordinary points. Using these functions, we can construct a
section @xmath as in proofs of previous lemmas, namely

  -- -------- --
     @xmath   
  -- -------- --

or, in other words,

  -- -------- --
     @xmath   
  -- -------- --

Since all entries in @xmath are constants, all functions @xmath are
defined on @xmath , and they define an element of @xmath .

A function @xmath or @xmath that has pole at @xmath only if @xmath .
Hence, the class of @xmath in @xmath is mapped by the isomorphism from
Lemma \thechapter .3 or \thechapter .5 to @xmath . Therefore, @xmath
defines the zero coset in

  -- -------- --
     @xmath   
  -- -------- --

and @xmath and @xmath define the same coset in

  -- -------- --
     @xmath   
  -- -------- --

∎

Denote now by @xmath the number of essential special points. Denote
these special points by @xmath .

###### Lemma \thechapter.9.

If @xmath , then every globally defined vector field on @xmath is
uniquely determined by its values at @xmath . If @xmath , then for every
set of tangent vectors at @xmath there exists a globally defined vector
field that takes these values at these points.

###### Proof.

Every globally defined vector field on @xmath can be written as @xmath .
(If the polynomial here is of higher degree, the vector field has a pole
at infinity.) A polynomial of degree 2 is completely determined by its
values at at least three points (if there are more than three points,
these values cannot be arbitrary, but a polynomial of degree two is
still unique if it exists). A polynomial of degree 2 can take arbitrary
prescribed values at at most three points. ∎

###### Proposition \thechapter.10.

If @xmath , then @xmath .

If @xmath , then there exists a vector space @xmath of dimension @xmath
and an embedding @xmath such that @xmath . Therefore, @xmath in this
case.

###### Proof.

By applying first Lemma \thechapter .6 , and then Lemma \thechapter .8
to an element of @xmath , we can get another element of @xmath of the
form @xmath equivalent to the original element of @xmath in @xmath .
Here, @xmath are Laurent polynomials regular at @xmath , i. e. they
don’t have non-zero coefficients at negative degrees. But Lemmas
\thechapter .3 and \thechapter .5 describe exact form of these
polynomials, and the highest possible degree of a non-zero term is 0 if
@xmath is an essential special point, and @xmath if it is removable. We
conclude that if @xmath is a removable special point, then @xmath .
Otherwise, @xmath is a vector field of the form @xmath ( @xmath ), which
is completely determined by its value at @xmath .

Therefore, we have constructed a surjective linear map from

  -- -------- --
     @xmath   
  -- -------- --

to @xmath . Denote this map by @xmath . @xmath can be mapped to @xmath
via evaluation of a vector field at points @xmath . Denote this map by
@xmath . Let us prove that @xmath . First, if @xmath is a globally
defined vector field, by the second part of Lemma \thechapter .7 , there
exists @xmath equivalent to 0 in @xmath and such that @xmath is defined
at @xmath and @xmath for all essential special points @xmath . As we
have already seen, @xmath if @xmath is removable. By Lemma \thechapter
.8 , @xmath is equivalent to @xmath , so @xmath . On the other hand, if
@xmath , then by the first part of Lemma \thechapter .7 , there exists a
vector field @xmath such that @xmath for all essential special points
@xmath . This means that @xmath , and we finally conclude that @xmath .

Now, by Lemma \thechapter .9 , @xmath is surjective if @xmath , and
@xmath is injective if @xmath , and the claim follows. ∎

### 16 Computation of the dimension of @xmath

Now we continue with @xmath . Recall that we use the sufficient system
@xmath to compute @xmath and @xmath and that @xmath (resp. @xmath ) is
the first cohomology of the complex @xmath (resp. @xmath ). The map
between @xmath and @xmath can also be written as the cohomology in the
middle of a map between these two complexes. Here @xmath can be written
as a direct sum of sheaves, each of them corresponds to an open subset
@xmath , namely, its sections over an open set @xmath are the @xmath
-descriptions of homogeneous vector fields of degree 0 defined on @xmath
. Denote this direct summand by @xmath . The sheaves @xmath and @xmath
can be decomposed into direct sums similarly, and each direct summand
corresponds to two or three of the sets @xmath , respectively. Denote
these direct summands by @xmath and by @xmath , respectively. Similarly,
we can define decompositions @xmath , @xmath , @xmath .

@xmath , @xmath , and @xmath can also be decomposed into sums of direct
summands corresponding to one, two, or three sets @xmath , respectively.
The sections of each of these summands over an open subset @xmath are
sequences of length @xmath , where each entry is the @xmath -description
of a function of degree @xmath defined on the intersection of @xmath and
one, two, or three of the sets @xmath , respectively. Denote these
direct summands by @xmath , @xmath , @xmath , respectively. Again, we
can also decompose @xmath , @xmath , @xmath .

The maps @xmath , @xmath , @xmath map each of these direct summands in
@xmath , @xmath , @xmath to the corresponding direct summand in @xmath ,
@xmath , @xmath , respectively.

Our next goal is to simplify the expressions for @xmath and @xmath we
have now. For this goal, it will be more convenient to deal with the
”invariant” versions of the sheaves, i. e. with @xmath , @xmath , @xmath
, @xmath , @xmath , @xmath , @xmath , and @xmath , which do not involve
any @xmath -descriptions explicitly. By Lemma \thechapter .17 , @xmath
is a dense open subset for all @xmath . Hence, each of the sheaves
@xmath , @xmath , and @xmath can be embedded into the following sheaf
that we denote by @xmath : @xmath is the space of @xmath -invariant
vector fields on @xmath . Similarly, each of sheaves @xmath , @xmath ,
and @xmath can be embedded into the following sheaf @xmath : @xmath is
the space of sequences of length @xmath of functions of degree @xmath
defined on @xmath . Then by Corollary \thechapter .14 we have the
following formulas for @xmath and @xmath :

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

And again, the map @xmath maps each direct summand of @xmath in this
formula to the corresponding direct summand of @xmath . Note that
Corollary \thechapter .13 cannot be applied here directly because it is
not always true that @xmath . However, we can prove the following two
lemmas. Recall that by Lemma \thechapter .16 , @xmath is isomorphic to
@xmath , where @xmath is isomorphic to @xmath or @xmath .

###### Lemma \thechapter.11.

Let @xmath be an open subset. The space of @xmath -invariant vector
fields defined on @xmath and on @xmath coincide, in other words, the
restriction homomorphism from the space of @xmath -invariant vector
fields on @xmath to the space of @xmath -invariant vector fields on
@xmath is in fact an isomorphism. This is also true for functions of
degree @xmath instead of vector fields of degree 0, if @xmath .

###### Proof.

The claim for vector fields follows directly from Corollary \thechapter
.21 , namely, the description of the space of vector fields there does
not depend on whether @xmath or @xmath (in terms of the notation used in
Corollary \thechapter .21 ). For functions of degree @xmath , Lemma
\thechapter .28 gives the same description for @xmath and for @xmath ,
if @xmath ∎

###### Lemma \thechapter.12.

The embeddings @xmath and @xmath are isomorphisms for @xmath , except
for the following case: both indices @xmath and @xmath correspond to the
same removable special point @xmath . In this case, the embeddings
@xmath , @xmath , @xmath , @xmath are isomorphisms.

###### Proof.

If @xmath and @xmath correspond to different special points, then @xmath
, and by Lemma \thechapter .17 , @xmath , where @xmath is isomorphic to
@xmath or @xmath . If @xmath and @xmath correspond to the same essential
special point @xmath , then they must correspond to the normal subcones
of different vertices of @xmath , so Lemma \thechapter .17 says that
@xmath is isomorphic to @xmath again. If @xmath , then @xmath as well,
and the isomorphism here, as well as in the equality @xmath , is given
by the isomorphism defined by Lemma \thechapter .16 for @xmath , so
@xmath . We already know that @xmath , @xmath , so @xmath if @xmath . If
@xmath , then @xmath and @xmath , where the isomorphism in both
equalities is given by the isomorphism defined by Lemma \thechapter .16
for @xmath . Let @xmath be an open subset. Now it follows from Lemma
\thechapter .11 that we always have @xmath and @xmath if @xmath and
@xmath correspond to different special points or @xmath and @xmath
correspond to the same essential special point @xmath .

Suppose now that both @xmath and @xmath correspond to the same removable
special point @xmath . Let us prove that the embeddings @xmath and
@xmath are isomorphisms, the situation for @xmath and @xmath is
completely symmetric. We have @xmath , but @xmath , so by Lemmas
\thechapter .16 and \thechapter .17 , @xmath , @xmath , and the
isomorphism in the second equality is a restriction of the isomorphism
in the first equality. The claim again follows from Lemma \thechapter
.11 . ∎

Since kernels of sheaf maps can be computed on each open subset
independently, Lemma \thechapter .12 implies that

  -- -------- --
     @xmath   
  -- -------- --

can be computed as follows. Its sections over an open subset @xmath are
sequences of the form @xmath satisfying the following conditions: if
indices @xmath and @xmath correspond to the same removable special point
@xmath , then @xmath . So we can do the following. For each removable
special point @xmath , if there are two indices @xmath and @xmath
corresponding to @xmath , choose one of them and call it excessive .
Then the kernel is isomorphic to the following sheaf:

  -- -------- --
     @xmath   
  -- -------- --

Similarly,

  -- -------- --
     @xmath   
  -- -------- --

So we get the following formulas for @xmath and @xmath :

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

Sections of quotients of sheaves can only be computed directly on affine
subsets. To compute the space of global sections on @xmath , we should
first compute sections for an affine covering of @xmath , then global
sections are tuples of local sections that coincide on the intersections
of the sets from the affine covering. We already have an affine covering
of @xmath , namely, we have sets @xmath . Recall that @xmath for every
pair of special points @xmath .

###### Lemma \thechapter.13.

Let @xmath be an open subset and @xmath be a special point such that
@xmath . Let an index @xmath correspond to @xmath . Then @xmath and
@xmath .

###### Proof.

@xmath (resp. @xmath ) is the space of @xmath -invariant vector fields
(resp. sequences of functions of certain degrees) defined on @xmath ,
where @xmath or @xmath . By Lemma \thechapter .11 , these spaces are
isomorphic to the spaces of (respectively) vector fields and sequences
of functions of certain degrees defined on @xmath , where the embedding
is given by the isomorphism for @xmath in Lemma \thechapter .16 . On the
other hand, by Lemma \thechapter .17 , @xmath is also isomorphic to
@xmath , and the isomorphism here is also the restriction of the
isomorphism in Lemma \thechapter .16 for @xmath to @xmath . Therefore,
in fact we have proved that the restriction of spaces of @xmath
-invariant vector fields and of functions of the required degrees from
@xmath to @xmath are isomorphisms. But @xmath , and @xmath (resp. @xmath
) is the space of @xmath -invariant vector fields (resp. of sequences
functions of the required degrees) defined on @xmath . ∎

###### Corollary \thechapter.14.

@xmath , @xmath .

###### Proof.

@xmath for all special points @xmath , so all direct summands of the
from @xmath and @xmath in the formulas above vanish. ∎

This corollary enables us to omit the condition that sections of @xmath
(or of @xmath ) over different sets @xmath should coincide on
intersections to form a global section. Therefore,

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

This formulas can be simplified more. Namely, recall that every set
@xmath equals @xmath or @xmath . If @xmath is a special point, and
@xmath or @xmath , where @xmath , then @xmath , and by Lemma \thechapter
.13 , @xmath and @xmath . So, we can write global sections of @xmath and
of @xmath as follows:

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

Now each sheaf @xmath and @xmath occurs only once in these summations.
Each direct summand in the first direct sum in the formula for @xmath is
mapped to the corresponding direct summand of @xmath , so we have proved
the following lemma:

###### Lemma \thechapter.15.

The kernel @xmath is isomorphic to the following direct sum:

  -- -------- --
     @xmath   
  -- -------- --

∎

Fix a special point @xmath . Recall that we have a coordinate function
@xmath on @xmath with the only zero at @xmath . Our next goal is to
compute the kernel

  -- -------- --
     @xmath   
  -- -------- --

Recall first that if @xmath is a removable special point, then there
exists only one non-excessive index @xmath corresponding to @xmath . But
then each direct sum in the formula above contains only one summand, and
@xmath . So in the sequel we suppose that @xmath is an essential special
point. Then there are no excessive indices corresponding to @xmath .
Moreover, in this case we chose exactly one set @xmath for each pair
@xmath , where @xmath . In other words, these sets @xmath (and the
summands in each of the direct sums in the formula above) are in
bijection with the vertices @xmath of @xmath . For each pair @xmath ,
denote the index @xmath such that @xmath corresponds to @xmath by @xmath
. So, now we are computing the kernel

  -- -------- --
     @xmath   
  -- -------- --

Fix an index @xmath , @xmath . Now we come back to using @xmath
-descriptions, namely, We are going to use @xmath -descriptions to
compute

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

@xmath is the space of @xmath -invariant vector fields defined on @xmath
, and, by Corollary \thechapter .21 , they are determined by triples of
a vector field and two functions defined on @xmath , which form @xmath .
We shortly write @xmath . @xmath is the space of @xmath -invariant
vector fields defined on @xmath , and by Lemma \thechapter .17 and by
Corollary \thechapter .21 , they are determined by triples of a vector
field and two functions defined on @xmath . Denote this space of triples
of a vector field and two functions defined on @xmath by @xmath .
Observe that the space itself does not depend on @xmath and @xmath , but
the isomorphism between @xmath and @xmath we use depends on @xmath and
@xmath . Denote this isomorphism by

  -- -- --
        
  -- -- --

By Remark \thechapter .22 , the embedding @xmath after applying these
isomorphisms becomes the restriction of vector fields and functions from
@xmath to @xmath .

Similarly, @xmath is the space of sequences of functions of certain
degrees from @xmath defined on @xmath . Lemma \thechapter .28 for @xmath
identifies this space with the space of sequences of functions defined
on @xmath (each function is identified with its @xmath -description),
denote this space of sequences of functions by @xmath . @xmath is the
space of sequences of functions of the same degrees, but they are
defined on @xmath . Again, Lemma \thechapter .28 for @xmath identifies
this space with the space of sequences of functions defined on @xmath
(again, each function is identified with its @xmath -description, not
with its @xmath -description). Denote this space of sequences of
functions by @xmath , and denote this isomorphism between @xmath and
@xmath by @xmath . And again, despite the spaces themselves do not
depend on @xmath and @xmath , the isomorphism is based on @xmath
-descriptions and depends on @xmath and @xmath . By Remark \thechapter
.29 , the embedding @xmath after these identifications becomes the
restriction of functions from @xmath to @xmath .

Finally, the formula in Lemma \thechapter .35 (for different indices
@xmath ) defines morphisms

  -- -------- --
     @xmath   
  -- -------- --

Denote the corresponding morphisms between @xmath and @xmath by @xmath .
Denote also the map

  -- -------- --
     @xmath   
  -- -------- --

formed by maps @xmath for all @xmath ( @xmath ) by @xmath . It follows
from functoriality of the isomorphism in Proposition \thechapter .11
that @xmath induces the morphism in question between

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma \thechapter.16.

Let @xmath be a special point, @xmath be an index, @xmath .

The composition of the restriction of @xmath to the space of triples of
the form

  -- -------- --
     @xmath   
  -- -------- --

and the natural projection @xmath is an isomorphism.

###### Proof.

The proof is similar to the proof of Lemma \thechapter .3 . Namely, let
@xmath , @xmath Consider complex-analytic Laurent series:

  -- -------- --
     @xmath   
  -- -------- --

Set

  -- -------- --
     @xmath   
  -- -------- --

These functions and this vector field are algebraic since the sums are
finite. The functions have zero of degree at least 1 at @xmath , the
vector field has zero of degree at least 3 at @xmath , so @xmath and
@xmath . Hence, @xmath , @xmath and @xmath , but @xmath , @xmath , and
@xmath have no poles at @xmath , so they define an element of @xmath
Hence, @xmath and @xmath define the same element of @xmath , and the
composition of the restriction of @xmath and the natural projection
under consideration is surjective. Injectivity is also clear since if a
Laurent polynomial of the considered form has no pole at @xmath , then
it is zero. ∎

Note that despite the proof is similar to the proof of Lemma \thechapter
.3 , Laurent polynomials here and in Lemma \thechapter .3 have different
meanings: here they from the @xmath -description of a vector field on
@xmath , while in Lemma \thechapter .3 they formed the @xmath
-description of a vector field on @xmath .

Denote the direct sum of maps @xmath , which maps @xmath to @xmath , by
@xmath . Denote by @xmath the subspace of @xmath formed by the @xmath
-tuples of the form

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma \thechapter.17.

The restriction of the composition of @xmath and the natural projection

  -- -------- --
     @xmath   
  -- -------- --

to @xmath is surjective. Its kernel is one-dimensional.

###### Proof.

To prove surjectivity, consider a @xmath -tuple @xmath . For every
@xmath , @xmath , set

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .25 , these functions and vector fields are regular
on @xmath . By Lemma \thechapter .23 , @xmath . Hence,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

define the same coset in

  -- -------- --
     @xmath   
  -- -------- --

Observe that @xmath , @xmath , and @xmath . Now, by Lemma \thechapter
.16 , every triple @xmath can be replaced with @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

so that @xmath and @xmath define the same coset in @xmath . Hence,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

define the same element of

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

therefore, the restriction of the composition to @xmath is surjective.

Now suppose that

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

defines the zero coset in

  -- -------- --
     @xmath   
  -- -------- --

For simplicity of notation, denote @xmath , @xmath . Then there exist
@xmath and @xmath ( @xmath ) such that @xmath , @xmath and

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .23 this means that

  -- -------- --
     @xmath   
  -- -------- --

In particular, @xmath and all functions @xmath and all vector fields
@xmath are determined by @xmath . On the other hand, the conditions
@xmath , @xmath for @xmath mean that @xmath , @xmath . Therefore, @xmath
, @xmath , and @xmath are regular at @xmath . By Lemma \thechapter .26 ,
@xmath for @xmath , @xmath . Now it follows from the definition of
@xmath that @xmath for some @xmath , and @xmath . Moreover, it follows
from a consideration of Laurent series of @xmath , of entries of @xmath
, and of @xmath that all numbers @xmath are uniquely determined by the
value of @xmath at @xmath , which is an element of a one-dimensional
space (the tangent space of @xmath at @xmath ). Therefore, the kernel of
the composition of @xmath and the projection is at most one-dimensional.

Now let us prove that the kernel contains a nonzero element. Set @xmath
, @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .25 , all functions @xmath are regular on @xmath .
By Lemma \thechapter .23 ,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

defines the zero coset in

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .26 ,

  -- -------- --
     @xmath   
  -- -------- --

So we can write @xmath , where @xmath (here @xmath , and for @xmath we
also have @xmath ) and @xmath is regular at @xmath (and hence on @xmath
). By the definition of matrices @xmath , @xmath , and we can set @xmath
, @xmath . Then @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

defines the zero coset in

  -- -------- --
     @xmath   
  -- -------- --

By construction,

  -- -------- --
     @xmath   
  -- -------- --

Since

  -- -------- --
     @xmath   
  -- -------- --

we have @xmath . Since @xmath and @xmath , @xmath is an element of the
kernel of the composition of @xmath and the projection from @xmath to

  -- -------- --
     @xmath   
  -- -------- --

∎

Now we are going to use the map

  -- -------- --
     @xmath   
  -- -------- --

we have introduced before using Lemma \thechapter .35 . Each of the
functions it computes is the @xmath -description of a function of a
degree @xmath on @xmath ( @xmath ), and exactly @xmath of these
functions are of this degree. Denote the morphism @xmath computing the
@xmath th of the functions of degree @xmath by @xmath . Denote also by
@xmath the direct sum of morphisms @xmath , which maps @xmath to @xmath
. We are computing the kernel of the map

  -- -------- --
     @xmath   
  -- -------- --

induced by @xmath , so by Lemma \thechapter .17 , it is sufficient to
consider the restriction of @xmath to @xmath . Then @xmath maps the
kernel of the composition of @xmath and the natural projection

  -- -- --
        
  -- -- --

to

  -- -------- --
     @xmath   
  -- -------- --

surjectively, and the kernel of this composition contains the
one-dimensional kernel @xmath since @xmath induces the map

  -- -------- --
     @xmath   
  -- -------- --

via @xmath and @xmath . So we have to find the preimage

  -- -------- --
     @xmath   
  -- -------- --

###### Remark \thechapter.18.

This is illustrated by the following commutative diagram:

  -- -- --
        
  -- -- --

###### Lemma \thechapter.19.

Let

  -- -------- --
     @xmath   
  -- -------- --

Suppose that

  -- -------- --
     @xmath   
  -- -------- --

where the last summand is embedded into @xmath diagonally. Pick two
vertices @xmath and @xmath of @xmath and denote @xmath , @xmath . Also
choose @xmath and an index @xmath ( @xmath ).

Then it is possible to write

  -- -------- --
     @xmath   
  -- -------- --

as

  -- -------- --
     @xmath   
  -- -------- --

where @xmath for @xmath .

###### Proof.

Since

  -- -------- --
     @xmath   
  -- -------- --

@xmath can be written as @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

and, in addition,

  -- -------- --
     @xmath   
  -- -------- --

does not depend on @xmath . By the definition of @xmath , @xmath for all
@xmath . It also follows from Lemma \thechapter .31 that @xmath . Thus,

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Corollary \thechapter.20.

If the hypothesis of Lemma \thechapter .19 holds, then

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Corollary \thechapter.21.

Suppose that the hypothesis of Lemma \thechapter .19 holds. Let @xmath .
Denote @xmath , @xmath , @xmath , and @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Observe that the function under the @xmath sign in the left-hand side of
the inequality is linear in @xmath , and the right-hand side does not
depend on @xmath , so it is sufficient to prove the inequality for all
functions @xmath forming a basis of @xmath . For example, we can use the
functions of degree @xmath among the generators of @xmath we have chosen
to define the map @xmath for Theorem \thechapter .4 . Recall that we
have denoted these generators by @xmath and that they form a basis of
@xmath . So, set @xmath . By Lemma \thechapter .35 ,

  -- -------- --
     @xmath   
  -- -------- --

and the claim follows from Corollary \thechapter .20 . ∎

Now we need more information about the behavior of @xmath depending on
@xmath . Here we perform arithmetic actions on vertices of @xmath , they
are understood as arithmetic actions in @xmath .

###### Lemma \thechapter.22.

For each degree @xmath and for any two vertices @xmath , @xmath ( @xmath
) one has @xmath .

###### Proof.

Again denote @xmath , @xmath , @xmath , @xmath , @xmath , and @xmath .
We chose @xmath , @xmath , @xmath , and @xmath so that @xmath , @xmath ,
@xmath , @xmath . By the definition of @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , the minimum @xmath is attained at @xmath . In other
words, @xmath . Similarly, @xmath (since @xmath ), @xmath , and @xmath
(since @xmath ). Hence,

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Lemma \thechapter.23.

Let @xmath be a finite edge of @xmath ( @xmath ), let @xmath . Choose
@xmath so that @xmath and @xmath form a lattice basis of @xmath . Then
@xmath and @xmath .

###### Proof.

Since @xmath , the minimum @xmath is attained at both @xmath and @xmath
, so @xmath , @xmath , and @xmath . It follows from the definition of
@xmath that @xmath is a primitive lattice vector. Hence, elements of
@xmath can take arbitrary values at it. Since @xmath and @xmath form a
lattice basis of @xmath and @xmath , we conclude that @xmath , and
@xmath . But the minimum @xmath is attained at @xmath since @xmath , so
@xmath . ∎

The following lemma is proved completely similarly to Lemma \thechapter
.23 , one only has to interchange @xmath and @xmath .

###### Lemma \thechapter.24.

Let @xmath be a finite edge of @xmath ( @xmath ), let @xmath . Choose
@xmath so that @xmath and @xmath form a lattice basis of @xmath . Then
@xmath and @xmath .∎

###### Lemma \thechapter.25.

Let @xmath be a vertex of @xmath , let @xmath be a finite edge of @xmath
( @xmath ), and suppose that @xmath . Pick a degree @xmath . Suppose
that @xmath . (Note that the contrary is possible since we allow @xmath
.)

Then @xmath .

###### Proof.

Let @xmath . Let @xmath be a degree such that @xmath and @xmath form a
lattice basis of @xmath . By Lemma \thechapter .23 , @xmath and @xmath .
Since @xmath and @xmath from a basis of @xmath , we can write @xmath .
The line containing @xmath separates the normal subcones of the vertices
@xmath with @xmath from the normal subcones of the vertices @xmath with
@xmath . In particular, it does not separate @xmath from @xmath , and it
does not separate @xmath from @xmath . Therefore, @xmath . If @xmath and
@xmath , then @xmath , @xmath , and @xmath cannot be a pointed cone. If
@xmath and @xmath , then @xmath , and this contradicts our assumption.
Therefore, @xmath . Then

  -- -- --
        
  -- -- --

∎

The following lemma can be proved completely similarly using Lemma
\thechapter .24 instead of Lemma \thechapter .23 .

###### Lemma \thechapter.26.

Let @xmath be a vertex of @xmath , let @xmath be a finite edge of @xmath
( @xmath ), and suppose that @xmath . Pick a degree @xmath . Suppose
that @xmath . Then @xmath .∎

###### Lemma \thechapter.27.

Let @xmath . Suppose that @xmath .

Then @xmath for @xmath .

###### Proof.

Fix an index @xmath , @xmath . For simplicity of notation, denote @xmath
, @xmath . Set @xmath . It follows from the choice of the degrees @xmath
above that @xmath . Denote @xmath , @xmath , @xmath , and @xmath .

By Lemma \thechapter .1 , there exists a function @xmath defined at all
ordinary points such that @xmath . @xmath is in the interior of @xmath ,
so @xmath , while @xmath . Hence, there exists a point @xmath such that
@xmath . Choose a rational function @xmath on @xmath that has exactly
one zero of order one at @xmath and exactly one pole of order one at
@xmath . Then @xmath . Note also that @xmath is regular at @xmath and
@xmath . Set @xmath . Then @xmath is also defined at all ordinary
points, and @xmath .

Since @xmath is linear on @xmath , @xmath . According to the choice of
the functions @xmath and @xmath for all indices @xmath , we have @xmath
. Denote @xmath , @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

and it follows from Corollary \thechapter .21 that

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .23 , @xmath . Hence, these two functions under the
@xmath signs are regular at @xmath . Subtract the expressions under the
@xmath signs and substitute the definition of @xmath . We see that the
following function is regular at @xmath :

  -- -------- --
     @xmath   
  -- -------- --

By a property of logarithmic derivative we can rewrite this as

  -- -------- --
     @xmath   
  -- -------- --

Now we can rewrite @xmath as @xmath . As we noted before, @xmath does
not have a zero or a pole at @xmath . We have chosen @xmath and @xmath
so that @xmath , hence @xmath does not have a zero or a pole at @xmath
either. We conclude that @xmath is regular at @xmath .

Now recall that @xmath , therefore @xmath is regular at @xmath for every
@xmath . Finally, it follows from the definition of @xmath that if
@xmath is regular at @xmath , then @xmath . ∎

Now we can reformulate Corollary \thechapter .21 as follows:

###### Corollary \thechapter.28.

Let @xmath . Suppose that @xmath . Pick two vertices @xmath and @xmath
of @xmath and denote @xmath , @xmath . Also choose @xmath and denote
@xmath , @xmath , @xmath , @xmath . Let @xmath be an arbitrary function.

Then

  -- -------- --
     @xmath   
  -- -------- --

∎

When we deal with elements of @xmath such that all vector fields @xmath
are zeros, it is more convenient to use @xmath -descriptions instead of
@xmath -descriptions. So denote by @xmath the space of @xmath -tuples of
the form form

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

Denote by @xmath the map that computes @xmath -descriptions out of
@xmath -descriptions, i. e. @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

In other words,

  -- -------- --
     @xmath   
  -- -------- --

Clearly, @xmath is injective. It also follows from Lemma \thechapter .27
that @xmath contains

  -- -- --
        
  -- -- --

So now we are going to find the following preimage:

  -- -- --
        
  -- -- --

###### Lemma \thechapter.29.

Let

  -- -------- --
     @xmath   
  -- -------- --

be such that

  -- -------- --
     @xmath   
  -- -------- --

Pick two vertices @xmath and @xmath of @xmath , choose @xmath .

Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Denote @xmath , @xmath , @xmath , @xmath .

Denote also @xmath , @xmath , @xmath , @xmath . Since @xmath , we can
write @xmath , @xmath . These equalities can be written in a matrix
form:

  -- -------- --
     @xmath   
  -- -------- --

Similarly,

  -- -------- --
     @xmath   
  -- -------- --

Denote

  -- -------- --
     @xmath   
  -- -------- --

Then by Lemma \thechapter .27 ,

  -- -------- --
     @xmath   
  -- -------- --

We can write

  -- -- --
        
  -- -- --

By Lemma \thechapter .1 , there exists @xmath such that @xmath . Since
@xmath , @xmath is linear on @xmath , and @xmath , we can write @xmath .
We chose @xmath and @xmath so that @xmath , @xmath . Therefore,

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .22 , @xmath . Since @xmath , @xmath is a point
where @xmath attains its minimum on @xmath . Hence, @xmath . The claim
now follows from Corollary \thechapter .28 . ∎

Now we are ready to formulate an exact description for

  -- -- --
        
  -- -- --

Let @xmath be the space of @xmath -tuples of the form

  -- -------- --
     @xmath   
  -- -------- --

such that

1.  @xmath is a Laurent polynomial in @xmath with no terms of
    nonnegative degree.

2.  @xmath .

3.  For each @xmath such that @xmath is a finite edge (i. e. @xmath ),

      -- -------- --
         @xmath   
      -- -------- --

4.  @xmath , @xmath for all finite edges @xmath ( @xmath ).

###### Remark \thechapter.30.

@xmath .

###### Proposition \thechapter.31.

  -- -- --
        
  -- -- --

###### Proof.

The inclusion

  -- -------- --
     @xmath   
  -- -------- --

follows easily from Lemmas \thechapter .29 and \thechapter .23 . Namely,
let

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

Properties 1 and 2 in the definition of @xmath follow from the
definition of @xmath . Fix a finite edge @xmath , @xmath . Let @xmath .
According to our choice of the set @xmath , @xmath . There also exists a
degree @xmath such that @xmath and @xmath and @xmath form a basis of
@xmath . By Lemma \thechapter .29 ,

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .23 , @xmath , in other words,

  -- -------- --
     @xmath   
  -- -------- --

is a function regular at @xmath . On the other hand, it is a Laurent
polynomial whose terms of nonnegative degree are zeros, so

  -- -------- --
     @xmath   
  -- -------- --

Now, using Lemmas \thechapter .29 and \thechapter .23 again, we see that

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath and @xmath form a basis of @xmath , and @xmath and @xmath
form a basis of @xmath , the matrix

  -- -------- --
     @xmath   
  -- -------- --

is nondegenerate. Therefore, @xmath and @xmath . So, the conditions 3
and 4 from the definition of @xmath hold, and @xmath .

Now we are going to prove the other inclusion. Let

  -- -------- --
     @xmath   
  -- -------- --

We have to write @xmath as @xmath , where

  -- -------- --
     @xmath   
  -- -------- --

and, in addition,

  -- -------- --
     @xmath   
  -- -------- --

does not depend on @xmath . In other words, we have to find functions
@xmath regular at @xmath and functions @xmath such that (see the
definition of @xmath ) @xmath for each @xmath , @xmath . These
conditions can be verified for different degrees @xmath and different
indices @xmath independently, so fix a degree @xmath and a generator
@xmath until the end of the proof. Denote @xmath , @xmath .

The map @xmath uses @xmath -descriptions of functions and of vector
fields on @xmath , but it follows from the definitions of @xmath , of an
@xmath -description and of an @xmath -description that instead of
computing the @xmath th component of @xmath using @xmath and @xmath , we
can first compute the @xmath -description of the derivative of @xmath
along the vector field on @xmath whose @xmath -description is @xmath ,
and then use @xmath to compute the @xmath -description of the function
on @xmath whose @xmath -description we obtain this way. So, consider the
@xmath -descriptions of the functions on @xmath whose @xmath
-descriptions are functions @xmath and @xmath we are looking for. Denote
these @xmath -descriptions by by @xmath and @xmath , respectively (we do
not use indices @xmath and @xmath here, because they are already fixed
until the end of the proof, and we do not mean that these functions are
the same for different @xmath and @xmath ). In other words, @xmath and
@xmath . In terms of these functions, we need to meet the following
conditions: first, @xmath should be regular at @xmath for each @xmath ,
and second, @xmath and @xmath should be the @xmath - and @xmath
-descriptions (respectively) of the same function defined on @xmath .
These conditions can be reformulated as follows: the inequality @xmath
should hold, and all functions @xmath should be the same function @xmath
, which should not depend on @xmath .

Let @xmath be the maximal index such that @xmath . (The convention that
we take the maximal index is nontrivial if @xmath .) Fix this index
@xmath until the end of the proof. Set

  -- -------- --
     @xmath   
  -- -------- --

and for each @xmath ( @xmath ) set

  -- -------- --
     @xmath   
  -- -------- --

Observe that @xmath . By Lemma \thechapter .35 , @xmath is the @xmath
-description of the derivative of @xmath along the vector field whose
@xmath -description is @xmath . It is sufficient to prove that @xmath .
Denote @xmath , @xmath , @xmath , and @xmath . Then we can write this
function as follows:

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , @xmath . We chose @xmath and @xmath so that @xmath and
@xmath . We know that

  -- -------- --
     @xmath   
  -- -------- --

@xmath , and @xmath is linear on @xmath , therefore

  -- -------- --
     @xmath   
  -- -------- --

Hence,

  -- -------- --
     @xmath   
  -- -------- --

So, now we are done for @xmath . Otherwise, we have to consider two
cases: @xmath and @xmath . Suppose first that @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .22 ,

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath for all @xmath , by Lemma \thechapter .25 we have

  -- -------- --
     @xmath   
  -- -------- --

This sum contains at least one summand since @xmath . By the definition
of @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

We have

  -- -------- --
     @xmath   
  -- -------- --

therefore @xmath is regular at @xmath .

Now consider the case @xmath . This time we are going to consider
indices smaller than @xmath , and it is possible that @xmath for some
@xmath , namely for @xmath (and this is the only possibility). So, we
have to consider two cases: @xmath and @xmath . Suppose first that
@xmath . Then we can again write

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath (and @xmath for all @xmath ), we can apply Lemmas
\thechapter .22 and \thechapter .26 . We see that

  -- -------- --
     @xmath   
  -- -------- --

And again, by the definition of @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Therefore,

  -- -------- --
     @xmath   
  -- -------- --

Finally, consider the case when @xmath and @xmath . Then @xmath , and
property 3 in the definition of @xmath guarantees that

  -- -------- --
     @xmath   
  -- -------- --

It also follows from Lemmas \thechapter .22 and \thechapter .23 that

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , then we already see that

  -- -------- --
     @xmath   
  -- -------- --

hence @xmath , in particular, this function is regular at @xmath . If
@xmath we write

  -- -------- --
     @xmath   
  -- -------- --

as previously. This time

  -- -------- --
     @xmath   
  -- -------- --

And here we can apply Lemma \thechapter .26 since @xmath for all @xmath
. We conclude that

  -- -------- --
     @xmath   
  -- -------- --

The order of the other multiplier can be rewritten as

  -- -------- --
     @xmath   
  -- -------- --

Again we see that

  -- -------- --
     @xmath   
  -- -------- --

and @xmath is regular at @xmath . ∎

Now it is clear that

  -- -------- --
     @xmath   
  -- -------- --

and, since @xmath is injective,

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .17 ,

  -- -- --
        
  -- -- --

By Lemma \thechapter .15 , we have the following equality:

  -- -------- --
     @xmath   
  -- -------- --

Finally, we get the following theorem from Theorem \thechapter .36 and
Proposition \thechapter .10 :

###### Theorem \thechapter.32.

We maintain the assumptions from Section 3 . Then the dimension of the
space of equivariant first order deformations of @xmath can be computed
as follows.

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the number of integer points on the edge @xmath of
@xmath , including exactly one of its endpoints. ∎

Observe that the sum @xmath can also be understood as follows. The
integer points on the boundary of @xmath split this boundary into
segments (containing no integer points in the interior). Then @xmath is
the amount of these segments in the finite edges of @xmath . Later, in
Chapter Equivariant deformations of algebraic varieties with an action
of an algebraic torus of complexity 1 , we will see how to construct
some actual first order deformations, which will span a @xmath
-dimensional vector space.

## Chapter \thechapter Connections between the graded component of
degree @xmath of @xmath and graded components of @xmath of toric
varieties

Given an affine toric 3-dimensional variety @xmath , one can restrict
the space the action of the 3-dimensional torus to a 2-dimensional
subtorus, and consider @xmath as a 3-dimensional @xmath -variety with an
action of a 2-dimensional torus. Toric varieties are parametrized by
pointed cones of the same dimension, and @xmath -varieties are
parametrized by polyhedral divisors as described in the Introduction.
These two parametrizations are related via the following toric downgrade
procedure.

Let @xmath be an affine toric 3-dimensional variety defined by a pointed
cone @xmath in @xmath , where @xmath is a 3-dimensional lattice. Denote
the dual lattice of @xmath by @xmath , and denote the 3-dimensional
torus acting on @xmath by @xmath . Then two-dimensional subtori of
@xmath are parametrized by primitive vectors @xmath . Fix one of them
until the end of this section, denote it by @xmath . We are going to
consider the action of @xmath on @xmath . To describe this action by a
polyhedral divisor, choose a line @xmath complementary to @xmath . These
choices are illustrated by the following diagram:

  -- -- --
        
  -- -- --

Consider also the projection from @xmath to @xmath along @xmath . It
maps each face of @xmath surjectively onto a cone in @xmath Then the
variety @xmath , where the polyhedral divisor will be constructed, is
defined by the coarsest fan in @xmath containing all these cones. It can
be @xmath , @xmath , or @xmath , depending on whether the image of
@xmath is the whole line, a half-line, or a point, respectively. We are
interested in the case @xmath , so suppose in the sequel that it holds.
It takes place if and only if @xmath separates @xmath into two nonempty
two-dimensional cones, or, equivalently, if @xmath .

To construct the polyhedral divisor itself, recall that the two
half-lines of @xmath correspond to the two fixed points of a torus
acting on @xmath , which we can denote by 0 and @xmath . More exactly,
let 0 (resp. @xmath ) correspond to the half-line @xmath (resp. @xmath
). Then the polyhedral divisor contains nontrivial polyhedra at 0 and at
@xmath only, and the polyhedron at 0 (resp. at @xmath ) is the
projection of @xmath (resp. of @xmath ) to @xmath along @xmath . As
previously, denote these polyhedra by @xmath and @xmath . The tail cone
of both of these polyhedra is @xmath . We only considered the cases when
it was full-dimensional, and, together with the requirement @xmath ,
this means that @xmath is full-dimensional. An example of this situation
is shown by Fig. 5

The last requirement we had says that all vertices of @xmath and @xmath
have to be lattice points. Since @xmath is a primitive vector, @xmath
and @xmath are lattice points, so the projections of the planes @xmath
and @xmath onto @xmath along @xmath map lattice points to lattice
points. Hence, the last condition we should impose says that if a
one-dimensional face of @xmath intersects one of the planes @xmath and
@xmath , then the intersection point is a lattice point.

Now we need some notation and terminology. Call an edge of @xmath
positive (resp. nonnegative , negative , nonpositive ) if @xmath takes
positive (resp. nonnegative, negative, nonpositive) values on this edge
(except the origin). Call an edge of @xmath orthogonal if @xmath takes
only zero values in this edge. Call a facet of @xmath positive (resp.
negative ) if @xmath takes only positive (resp. only negative) values on
the interior of this facet. Denote the edges of @xmath by @xmath and the
facets of @xmath by @xmath . The intersections of these edges and facets
with the affine planes @xmath and @xmath are vertices and edges of
@xmath and @xmath , respectively, for more details see Remark
\thechapter .1 . Sometimes we can write @xmath (resp. @xmath , @xmath ,
@xmath ) instead of @xmath (resp. @xmath , @xmath , @xmath ). We
enumerate edges and facets so that @xmath . We also require that @xmath
is a positive edge, and @xmath is a nonpositive edge. This requirement
allows one to choose one of exactly two enumerations of edges and
facets, we choose one of them arbitrarily.

It is also convenient to introduce some notation for positive and
negative edges separately. Denote the number of positive edges by @xmath
. Denote the positive edges themselves by @xmath . Here the edges are
enumerated in the same order as when we enumerated all edges, i. e.
@xmath for @xmath . Similarly, denote the number of negative edges by
@xmath , and denote the negative edges themselves by @xmath . This time
we reverse the order that we used when we enumerated all edges together.
In other words, if @xmath for some @xmath (which can equal @xmath or
@xmath ), then @xmath for @xmath . The notation @xmath may look a bit
redundant, but it is convenient to have uniform notation for positive
and negative edges.

Now let us introduce notation for positive and negative facets. Denote
the facet whose boundary is @xmath (resp. @xmath ) by @xmath (resp.
@xmath ) for @xmath (resp @xmath ). Again we have @xmath for @xmath .
Extend this notation as follows. First, set @xmath and @xmath . If
@xmath , denote @xmath and @xmath . In other words, @xmath is the facet
of @xmath with the highest index such that one of the edges on its
boundary is negative. The other edge on its boundary is nonnegative, and
the negative edge on the boundary of @xmath is @xmath . And @xmath is
the facet of @xmath with the lowest index such that one of the edges on
its boundary is negative. The other edge on its boundary is nonnegative,
and the negative edge on the boundary of @xmath is @xmath .

An example of this notation is shown by Fig. 6 .

###### Remark \thechapter.1.

Here is how the notation introduced now is related with the notation for
edges and vertices of @xmath we introduced in the beginning. Namely,
within the notation that we introduced now, we have @xmath , @xmath for
@xmath , @xmath for @xmath , @xmath , @xmath for @xmath , and @xmath for
@xmath .

The faces of the cone @xmath dual to @xmath put be set into bijection
with the faces of @xmath . Namely, each face @xmath of @xmath defines a
face of @xmath consisting of all @xmath such that @xmath . We call this
face of @xmath the normal face of @xmath and denote it by @xmath .
Clearly, the normal faces of edges are facets and vice versa.

A formula for the graded components of the first-order deformation space
of a toric variety was given in [ 10 ] . To formulate it, we need to
quote also some notation from [ 10 ] . (We slightly change the letters
we use there to avoid confusion.) First, let @xmath be the Hilbert basis
of @xmath . If @xmath is an edge of @xmath , and @xmath is a degree,
denote

  -- -------- --
     @xmath   
  -- -------- --

Now, if @xmath is a facet of @xmath , we set

  -- -------- --
     @xmath   
  -- -------- --

and for the origin (which is also a face of @xmath ) we set

  -- -------- --
     @xmath   
  -- -------- --

Finally, we set

  -- -------- --
     @xmath   
  -- -------- --

for @xmath . Here @xmath denotes the sublattice of @xmath generated by
the subset of @xmath under the @xmath sign. In the sequel we will also
use notation @xmath for the @xmath -linear subspace of @xmath generated
by a set of elements of @xmath or of @xmath . generated Consider the
complex

  -- -------- --
     @xmath   
  -- -------- --

where the maps are standard Cech differentials. Denote the graded
component of @xmath of degree @xmath by @xmath .

###### Theorem \thechapter.2.

[ 10 , Theorem 2.1]

  -- -------- --
     @xmath   
  -- -------- --

Our goal for this section is to deduce Theorem \thechapter .32 in the
case of toric @xmath from Theorem \thechapter .2 . It is known that the
0th graded component of @xmath considered as a @xmath -variety is
isomorphic to

  -- -------- --
     @xmath   
  -- -------- --

where the degrees are understood with respect to the action of the
three-dimensional torus. So, in the sequel we will study the spaces
@xmath , where @xmath is a multiple of @xmath .

###### Lemma \thechapter.3.

Let @xmath be a multiple of @xmath and @xmath be an edge of @xmath .
Then @xmath if one of the following conditions holds:

1.  @xmath .

2.  @xmath is an orthogonal edge.

3.  @xmath , where @xmath , and @xmath is a negative edge.

4.  @xmath , where @xmath , and @xmath is a positive edge.

###### Proof.

Choose a Hilbert basis element @xmath , where @xmath . Since @xmath , we
have @xmath . On the other hand, @xmath if case 1 or 2 from the above
classification holds. If case 3 or 4 takes place, then @xmath . Hence,
@xmath , and @xmath . ∎

###### Corollary \thechapter.4.

If @xmath , then @xmath and @xmath .∎

###### Lemma \thechapter.5.

If @xmath is a positive (resp. negative) edge of @xmath , then @xmath
equals 1 (resp. @xmath ).

###### Proof.

If @xmath is a positive edge, denote @xmath . If @xmath is a negative
edge, denote @xmath . Recall that one of the requirements we have
imposed on @xmath says that the planes @xmath and @xmath intersect edges
of @xmath at lattice points (otherwise the polyhedral divisor we obtain
from @xmath does not consist of lattice polyhedra), so @xmath is a
lattice point, and hence @xmath is a multiple of @xmath . On the other
hand, if @xmath , then @xmath cannot be an integer. So, @xmath , and
@xmath (resp. @xmath ) if @xmath is a positive (resp. negative) edge. ∎

###### Lemma \thechapter.6.

If @xmath is a positive (resp. negative) edge of @xmath , and @xmath
(resp. @xmath ), then @xmath and @xmath .

###### Proof.

Without loss of generality, suppose that @xmath is a positive edge and
@xmath (the other case can be considered completely analogously). Then
by Lemma \thechapter .5 , @xmath . So, if @xmath , then @xmath , so
@xmath (this is an integer number), and @xmath . Hence, @xmath . On the
other hand, if @xmath , then @xmath , and @xmath . Hence, @xmath .

Therefore, @xmath is the intersection of the Hilbert basis of @xmath and
the normal facet of @xmath , which is the Hilbert basis of @xmath . In
particular, @xmath generates @xmath as a @xmath -vector space. ∎

###### Lemma \thechapter.7.

If @xmath is a positive (resp. negative) edge of @xmath , and @xmath ,
where @xmath (resp. @xmath ), then @xmath .

###### Proof.

Again, without loss of generality we may suppose that @xmath is a
positive edge and @xmath , the other case is completely similar.

First, let us prove that there exists a degree @xmath such that @xmath .
This is done by a standard continuity argument. Namely, consider a
lattice point @xmath in the relative interior of @xmath . Consider also
a line @xmath . This line cannot be contained in the plane containing
@xmath since @xmath . So, the intersection of this line and this plane
is exactly @xmath , and @xmath splits the line @xmath into two rays, and
one of these rays passes through the interior of @xmath . Since @xmath
and @xmath , the ray passing through the interior of @xmath cannot be
@xmath , and it must be @xmath . Hence, if @xmath is large enough,
@xmath . Then @xmath , but @xmath is a lattice point, and @xmath , so we
can take @xmath .

Since all @xmath form the Hilbert basis of @xmath , @xmath can be
written as a positive integer linear combination of @xmath . Since
@xmath , there exists @xmath such that @xmath .

As we have already noted previously, the set of all @xmath such that
@xmath form the Hilbert basis of @xmath , therefore they generate @xmath
as a @xmath -vector space. Clearly, all these @xmath are in @xmath .
Together they generate a 2-dimensional vector space, so if we add one
more vector, which is outside @xmath , all vectors together will
generate a bigger vector space, but then this space must be @xmath since
@xmath . But we already know that there exists a @xmath such that @xmath
. By the definition of @xmath , all vectors from @xmath vanish on @xmath
, so this @xmath cannot be in @xmath . Therefore, @xmath . ∎

###### Corollary \thechapter.8.

If @xmath , @xmath , @xmath , then @xmath can be written as follows:

1.   If @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

2.   If @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

3.   If @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

4.   If @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

∎

These lemmas also enable us to describe @xmath explicitly:

###### Corollary \thechapter.9.

If @xmath , @xmath , @xmath , then @xmath can be written as follows:

1.   If @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

2.   If @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

3.   If @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

4.   If @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

∎

Now we have to find @xmath , where @xmath is a multiple of @xmath . To
compute this kernel, we need some information about @xmath . First, let
us make the following observation. An element of @xmath can be written
as a sequence @xmath , where @xmath . In particular, the image of an
element of @xmath can be written in this form. Consider an entry @xmath
such that @xmath consists only of edges such that @xmath . Observe that
in this case @xmath since in this case @xmath is the difference of two
elements of two vector spaces, and each of this vector spaces has
dimension 0. So, it is sufficient to consider only the facets whose
boundary contains at least one edge @xmath such that @xmath . Using
Corollary \thechapter .8 , we can say that if @xmath , where @xmath
(resp. @xmath ), then it is sufficient to consider only the facets of
@xmath whose boundary contains at least one positive (resp. negative)
edge. These are exactly the facets we have denoted by @xmath (resp. by
@xmath ).

###### Lemma \thechapter.10.

If @xmath , where @xmath , then @xmath for @xmath and @xmath .

###### Proof.

Let us consider the case @xmath , the other case is completely similar.
By the definition of @xmath , its boundary consists of @xmath , which is
a positive edge, and another edge @xmath , which is nonpositive. Hence,
by Lemma \thechapter .3 , @xmath , so @xmath as well, and @xmath . ∎

###### Lemma \thechapter.11.

If @xmath , where @xmath , then @xmath for @xmath and @xmath .

###### Proof.

The proof here is again completely similar to the proof of the previous
lemma, but this time we present it to ease reading. Let us consider the
case @xmath , the other case is completely similar. By the definition of
@xmath , its boundary consists of @xmath , which is a negative edge, and
another edge @xmath , which is nonnegative. Hence, by Lemma \thechapter
.3 , @xmath , so @xmath as well, and @xmath . ∎

To understand the behavior of @xmath , where @xmath , (resp. of @xmath ,
where @xmath ) for degrees @xmath with @xmath (resp. @xmath ), we start
with the following lemma.

###### Lemma \thechapter.12.

Let @xmath be a two-dimensional lattice, and let @xmath be its dual
lattice. Let @xmath and @xmath be such that @xmath and @xmath . Then
@xmath and @xmath generate @xmath as a @xmath -vector space.

Denote the primitive lattice point on the ray @xmath by @xmath .
Similarly, denote by @xmath the primitive lattice point on the ray
@xmath

Then @xmath . The sets

  -- -------- --
     @xmath   
  -- -------- --

for @xmath behave as follows:

1.   If @xmath , then @xmath is the set of all @xmath of the form @xmath
    , @xmath .

2.   If @xmath , then @xmath contains @xmath and @xmath .

###### Proof.

Consider the @xmath -linear span of @xmath and @xmath in @xmath . Since
@xmath and @xmath , this linear span can be one-dimensional only if
@xmath is a @xmath -multiple of @xmath . But in this case, since @xmath
, @xmath and @xmath must coincide, and this is a contradiction.

Denote @xmath and denote @xmath . Then @xmath , and @xmath is a
primitive lattice vector. Hence, there exists a function @xmath such
that @xmath . Since @xmath , we also have @xmath . Consider the
following functions @xmath ( @xmath ): @xmath . We have @xmath , so
@xmath is a multiple of @xmath and @xmath is a multiple of @xmath ,
since @xmath and @xmath are primitive vectors on the corresponding rays.

We also have @xmath and @xmath . On the other hand, @xmath and @xmath .
Hence, @xmath is a multiple of @xmath and @xmath is a multiple of @xmath
. Recall that @xmath is a multiple of @xmath and @xmath is a multiple of
@xmath . Summarizing, we conclude that @xmath and @xmath . But then
@xmath and @xmath . Since @xmath and @xmath by the definitions of @xmath
and @xmath , we have @xmath .

Now fix some @xmath and consider the set

  -- -------- --
     @xmath   
  -- -------- --

If @xmath , then it is already clear that @xmath contains @xmath and
@xmath since @xmath , @xmath , @xmath , and @xmath . So suppose that
@xmath . In this case it is also clear that @xmath for @xmath since
@xmath .

Suppose that @xmath . Without loss of generality, @xmath . Consider
@xmath . We have @xmath and @xmath . So, @xmath is a lattice point on
the (closed) ray @xmath . But we already know that the primitive lattice
vector on this ray is @xmath , so @xmath is a (possibly zero) integer
multiple of @xmath . If @xmath , then @xmath , and we have a
contradiction with @xmath since @xmath , @xmath , and @xmath . If @xmath
, then we see that @xmath and @xmath take the same values on @xmath and
@xmath . Since @xmath and @xmath @xmath -generate @xmath , we can
conclude that @xmath as desired. ∎

###### Lemma \thechapter.13.

Let @xmath be facet of @xmath , and let @xmath be an edge of @xmath on
the boundary of @xmath . Let @xmath be the other edge on the boundary of
@xmath . Suppose that we have a degree @xmath such that @xmath .

Then there exists @xmath such that @xmath .

###### Proof.

Let @xmath be the facet of @xmath such that @xmath . In other words,
@xmath and @xmath are the two facets whose boundary contains @xmath .
Then @xmath is determined inside @xmath by two inequalities
corresponding to @xmath and @xmath . For an inequality corresponding to
@xmath , we can take the restriction to @xmath of the inequality in the
definition of @xmath corresponding to the other facet of @xmath whose
boundary contains @xmath . This other facet is @xmath ), and the
corresponding inequality says that if @xmath , then @xmath takes
nonnegative values on @xmath , in other words, @xmath .

Similarly, for an inequality corresponding to @xmath , we can take the
restriction to @xmath of the inequality corresponding to the facet of
@xmath different from @xmath and whose boundary contains @xmath . This
facet is the normal facet of the edge on the boundary of @xmath
different from @xmath . Denote it by @xmath so that @xmath . Then the
inequality corresponding to @xmath in the definition of @xmath says that
if @xmath , then @xmath takes nonnegative values on @xmath , in other
words, @xmath . Therefore, @xmath is determined inside @xmath by the
restrictions to @xmath of the inequalities @xmath and @xmath for @xmath
.

Therefore, if @xmath , then we can take @xmath . Suppose that @xmath .

We chose @xmath so that

  -- -------- --
     @xmath   
  -- -------- --

and we also know that

  -- -------- --
     @xmath   
  -- -------- --

so

  -- -------- --
     @xmath   
  -- -------- --

Hence,

  -- -------- --
     @xmath   
  -- -------- --

Then there exists @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

In other words,

  -- -------- --
     @xmath   
  -- -------- --

We have

  -- -------- --
     @xmath   
  -- -------- --

We also have

  -- -------- --
     @xmath   
  -- -------- --

since @xmath . Hence,

  -- -------- --
     @xmath   
  -- -------- --

by assumption, and

  -- -- --
        
  -- -- --

∎

###### Lemma \thechapter.14.

Let @xmath (resp. @xmath ), where @xmath (resp. @xmath ), be a facet of
@xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Since

  -- -------- --
     @xmath   
  -- -------- --

it takes nonnegative values on the edges of @xmath . Since

  -- -------- --
     @xmath   
  -- -------- --

the only two edges of @xmath where

  -- -------- --
     @xmath   
  -- -------- --

vanishes are @xmath and @xmath (resp. @xmath and @xmath ). But both of
these edges are positive (resp. negative), so if @xmath is one of these
two edges, then

  -- -------- --
     @xmath   
  -- -------- --

Hence,

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

for @xmath or @xmath (resp. @xmath or @xmath ).

Now suppose that @xmath is another edge, i. e.

  -- -------- --
     @xmath   
  -- -------- --

Then

  -- -------- --
     @xmath   
  -- -------- --

and, since @xmath (resp. @xmath ) and @xmath are lattice points, we have

  -- -------- --
     @xmath   
  -- -------- --

Now recall that if an edge of @xmath intersects one of the planes @xmath
and @xmath , then the intersection point is a lattice point. This
lattice point must be the primitive lattice vector on this edge,
otherwise @xmath would have taken a noninteger value at the primitive
lattice vector. Therefore, if @xmath intersects one of the planes @xmath
and @xmath , then @xmath can only equal 1 or @xmath . If @xmath
intersects none of these planes, then @xmath vanishes on @xmath
everywhere, in particular @xmath . Therefore, in all cases we have
@xmath . But then

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

Summarizing, we see that if @xmath is an arbitrary edge of @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

Therefore,

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Proposition \thechapter.15.

Let @xmath (resp. @xmath ), where @xmath (resp. @xmath ), be a facet of
@xmath . Let @xmath (resp. @xmath ), where @xmath .

1.   If @xmath , then

      -- -------- --
         @xmath   
      -- -------- --

2.   If @xmath (resp. @xmath ) and @xmath (resp. @xmath ), then

      -- -------- --
         @xmath   
      -- -------- --

      -- -------- --
         @xmath   
      -- -------- --

3.   If @xmath (resp. @xmath ), then @xmath .

###### Proof.

Again, the positive and the negative cases here are completely similar.
This time let us consider the negative case.

Consider the lattices

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

By the definition of @xmath , a function from @xmath vanishes on the
whole @xmath (which is a saturated sublattice of @xmath by construction)
if and only if this function is contained in @xmath . Therefore, @xmath
is the dual lattice of @xmath , and the values of elements of @xmath at
points from @xmath are well-defined. We denote the class of a function
@xmath in @xmath by @xmath .

Denote @xmath , @xmath . Recall that @xmath , so @xmath . We have
already seen that @xmath and that

  -- -------- --
     @xmath   
  -- -------- --

So, @xmath , @xmath , and @xmath satisfy the hypothesis of Lemma
\thechapter .12 , and @xmath . Consider the set @xmath from Lemma
\thechapter .12 . It follows directly from the definitions of @xmath and
of @xmath that the image of @xmath under the canonical projection @xmath
is contained in @xmath . Moreover, if @xmath is an element of the
Hilbert basis of @xmath such that @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

so @xmath . Similarly,

  -- -------- --
     @xmath   
  -- -------- --

so @xmath . Hence,

  -- -------- --
     @xmath   
  -- -------- --

Consider the case @xmath . Then by Lemma \thechapter .12 , @xmath , and
all elements of @xmath are in @xmath . On the other hand, since @xmath
is a face of @xmath , @xmath is an element of the Hilbert basis of
@xmath , @xmath for some @xmath . As we have seen previously, this means
that @xmath . Hence, @xmath .

Now suppose that @xmath and @xmath . Then by Lemma \thechapter .12 ,
@xmath is contained in the line generated by @xmath . Hence, @xmath is
contained in the plane generated by @xmath and @xmath . On the other
hand, we already know that @xmath is an element of the Hilbert basis of
@xmath , and, since it represents the zero class in @xmath and @xmath ,
it is also contained in @xmath . By Lemma \thechapter .14 , @xmath . If
@xmath is not an element of the Hilbert basis of @xmath , it can be
decomposed into an integer positive linear combination of elements of
the Hilbert basis. Since @xmath , the elements of the Hilbert basis
present in this combination may only take values 0 or 1 at @xmath and
@xmath (in arbitrary order). But if there exists @xmath such that @xmath
and @xmath , then @xmath , and this is a contradiction with Lemma
\thechapter .12 . Similarly, one cannot have @xmath and @xmath . Hence,
there exist an element @xmath of the Hilbert basis such that @xmath . By
Lemma \thechapter .12 , @xmath and @xmath @xmath -generate @xmath .
Therefore, elements of @xmath are determined by their values at @xmath
and @xmath , and @xmath . We already know that this means that @xmath .
Since @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and @xmath and @xmath together @xmath -generate the same plane as @xmath
and @xmath @xmath -generate, i. e. they @xmath -generate @xmath .
Therefore,

  -- -------- --
     @xmath   
  -- -------- --

Finally, let us consider the case @xmath . By Lemma \thechapter .12 ,
there exist @xmath such that @xmath , @xmath , @xmath , and @xmath .
Pick arbitrary @xmath such that @xmath and @xmath . We have @xmath ,
@xmath , @xmath , and @xmath , so, by the definitions of @xmath and of
@xmath , we have @xmath and @xmath . Therefore, we can apply Lemma
\thechapter .13 to the facet @xmath of @xmath , to the edge @xmath of
@xmath , and to the degree @xmath and find another degree @xmath such
that @xmath is a multiple of @xmath and @xmath . Similarly, by Lemma
\thechapter .13 applied to @xmath , to @xmath , and to @xmath , there
exists a degree @xmath such that @xmath is a multiple of @xmath . In
other words, @xmath and @xmath .

Now we have degrees @xmath satisfying the following conditions: @xmath ,
@xmath , @xmath . Decompose @xmath into a positive integer linear
combination of @xmath . The elements @xmath of the Hilbert basis
occurring in this decomposition satisfy @xmath and @xmath , and for at
least one of them we have @xmath . Similarly, there exists @xmath
satisfying @xmath and @xmath . We can write this as

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

so @xmath . Similarly, @xmath . Finally, as we saw previously, @xmath is
an element of the Hilbert basis, its class in @xmath is @xmath , so

  -- -------- --
     @xmath   
  -- -------- --

Now we claim that @xmath , @xmath , and @xmath @xmath -generate @xmath .
Indeed, @xmath , while

  -- -------- --
     @xmath   
  -- -------- --

by the definition of @xmath . Hence, @xmath and @xmath are linearly
independent and @xmath -generate @xmath . Similarly, @xmath and @xmath
@xmath -generate @xmath . The linear span of these two planes can be
two-dimensional only if these two planes coincide, but @xmath and @xmath
are two different facets of @xmath , so

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Corollary \thechapter.16.

If @xmath (resp. @xmath ), then @xmath equals the space of sequences of
the form @xmath (resp. @xmath ), where @xmath is a linear function on
@xmath (resp on @xmath ), and where

  -- -------- --
     @xmath   
  -- -------- --

for @xmath (resp.

  -- -------- --
     @xmath   
  -- -------- --

for @xmath ).

###### Proof.

The claim follows directly from Corollary \thechapter .8 , Lemma
\thechapter .10 , Lemma \thechapter .11 , and Proposition \thechapter
.15 . ∎

###### Corollary \thechapter.17.

If @xmath (resp. @xmath ), where @xmath , @xmath , then @xmath equals
the space of sequences of the form @xmath (resp. @xmath ), where @xmath
are linear functions on @xmath satisfying the following conditions for
@xmath (resp. for @xmath ):

1.   If @xmath (resp. @xmath ), then

      -- -------- --
         @xmath   
      -- -------- --

    (resp.

      -- -------- --
         @xmath   
      -- -------- --

    ).

2.   If @xmath (resp. @xmath ), then @xmath .

###### Proof.

The claim follows directly from Corollary \thechapter .8 , Lemma
\thechapter .10 , Lemma \thechapter .11 , and Proposition \thechapter
.15 . ∎

Now we construct a less invariant, but more explicit vector space
isomorphic to @xmath . Namely, denote by @xmath (resp. by @xmath ) the
space of sequences of the form @xmath (resp. @xmath ), where @xmath is a
linear function on @xmath (resp. on @xmath ). For @xmath , @xmath ,
denote by @xmath (resp. by @xmath ) the space of sequences of the form
@xmath (resp. @xmath ), where

1.  @xmath is a linear function on @xmath .

2.  If @xmath (resp. @xmath ) and @xmath (resp. @xmath ), then @xmath is
    a linear function on

      -- -------- --
         @xmath   
      -- -------- --

      -- -------- --
         @xmath   
      -- -------- --

3.  If @xmath (resp. @xmath ) and @xmath (resp. @xmath ), then @xmath .

###### Lemma \thechapter.18.

If @xmath (resp. @xmath ), then @xmath is isomorphic to @xmath (resp. to
@xmath ). After this identification, the map @xmath (in fact, the map
@xmath ) becomes the following map: it maps @xmath to the sequence of
restrictions of @xmath to the lines @xmath for @xmath (resp. @xmath for
@xmath ).

###### Proof.

Again, the positive and the negative cases are completely analogous, so
we consider only one of them, for example, the case when @xmath .

First, we should note that a function from @xmath is really defined on
all lines @xmath (and the restriction mentioned in the statement of the
Lemma really exists) by Lemma \thechapter .9 since each normal cone
@xmath (for @xmath ) is contained in (the boundary of) a cone @xmath for
some @xmath , @xmath .

The isomorphism is constructed as follows. Given a sequence

  -- -------- --
     @xmath   
  -- -------- --

we set

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

for @xmath and say that @xmath . Observe that by Corollary \thechapter
.16 , we also have

  -- -- --
        
  -- -- --

for @xmath . Since @xmath is a two-dimensional space, and @xmath and
@xmath are its noncoinciding one/dimensional subspaces, a linear
function on @xmath is uniquely determined by its restrictions to @xmath
and @xmath , and these restrictions can be arbitrary linear functions.
Therefore, the map we have constructed is really an isomorphism. The
correctness of the explicit description of the map @xmath in the
statement of the lemma follows directly from the definition of the map
@xmath and of the isomorphism between @xmath and @xmath . ∎

###### Lemma \thechapter.19.

If @xmath (resp. @xmath ), where @xmath , @xmath , then @xmath is
isomorphic to @xmath (resp. to @xmath ). After this identification, the
map @xmath becomes the following map: it maps @xmath to @xmath .

###### Proof.

This time let us consider the case @xmath , the other case is completely
similar.

First, let us construct a map from @xmath to @xmath . Given a sequence

  -- -------- --
     @xmath   
  -- -------- --

we set

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

for @xmath . By Corollary \thechapter .17 ,

  -- -------- --
     @xmath   
  -- -------- --

if @xmath , and @xmath if @xmath . (here @xmath . Recall that @xmath .
So, we can say that

  -- -------- --
     @xmath   
  -- -------- --

if @xmath , and @xmath if @xmath . Therefore, @xmath really defines an
element of @xmath , and we say that @xmath .

The inverse map can be constructed by induction on @xmath . Let @xmath .
First, set @xmath . Now suppose that we already have @xmath . If @xmath
, set @xmath . Otherwise, @xmath is a linear function on @xmath . It
gives rise to a function on @xmath , which vanishes on @xmath and which
we also denote by @xmath . Set @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

Now we have a sequence @xmath of functions on @xmath , and by Corollary
\thechapter .17 , @xmath . So, we have constructed a map @xmath . It is
clear from the construction that the two maps we have are mutually
inverse.

By Corollary \thechapter .9 , @xmath . Again, it is clear from the
definition of the map @xmath and from the construction of the
isomorphism between @xmath and @xmath that after this identification
@xmath the map @xmath becomes the map

  -- -- --
        
  -- -- --

∎

###### Corollary \thechapter.20.

If @xmath (resp. @xmath ) and @xmath (resp. @xmath ), then @xmath .

If @xmath (resp. @xmath ) and @xmath (resp. @xmath ), then @xmath (resp.
@xmath ).

###### Proof.

We consider the case @xmath , the other case is completely similar. Note
that @xmath , so @xmath . Also note that it follows from the description
of @xmath in Corollary \thechapter .9 and from Lemma \thechapter .18
that the map @xmath is in fact an embedding, so @xmath . Now, since
@xmath ) for different @xmath are different edges of @xmath , we have
@xmath . Thus, @xmath if @xmath and @xmath if @xmath . Finally, we have
@xmath if @xmath and @xmath if @xmath . ∎

###### Proposition \thechapter.21.

If @xmath (resp. @xmath ), where @xmath , @xmath , then @xmath equals
the number of indices @xmath such that @xmath (resp. @xmath ) and @xmath
(resp. @xmath ).

###### Proof.

This follows directly from the definition of @xmath and Lemma
\thechapter .19 . ∎

Now it is already easy to deduce Theorem \thechapter .32 in the case
when @xmath is in fact toric from Theorem \thechapter .2 . First, let us
compute the sum

  -- -------- --
     @xmath   
  -- -------- --

By Proposition \thechapter .21 , this sum can be decomposed into @xmath
sums (indexed by @xmath ), and each of these sums contributes 1 for
@xmath and 0 for larger values of @xmath . Therefore, the @xmath th of
these sums equals @xmath , and we have

  -- -------- --
     @xmath   
  -- -------- --

Observe that this sum vanishes if @xmath (i. e. if @xmath is a removable
special point). Similarly,

  -- -------- --
     @xmath   
  -- -------- --

And again, this sum vanishes if @xmath , i. e. if @xmath is a removable
special point. Now, by Corollary \thechapter .20 , @xmath if @xmath is a
removable special point, and @xmath otherwise. Similarly, @xmath if
@xmath is a removable special point, @xmath otherwise. Hence, if @xmath
is a removable special point, then

  -- -------- --
     @xmath   
  -- -------- --

and if @xmath is an essential special point, then

  -- -------- --
     @xmath   
  -- -------- --

Similarly, if @xmath is a removable special point, then

  -- -------- --
     @xmath   
  -- -------- --

and if @xmath is an essential special point, then

  -- -------- --
     @xmath   
  -- -------- --

Finally, recall that by Corollary \thechapter .4 , @xmath , and we get
the formula from Theorem \thechapter .32 .

## Chapter \thechapter A formally versal @xmath-equivariant deformation
over affine space

### 17 Construction of the deformation

In this section we construct a formally versal @xmath -equivariant
deformation of a @xmath -variety @xmath over an affine space used as the
parameter space. The Kodaira-Spencer map of this deformation maps the
tangent space to this parameter space surjectively onto the zeroth
graded component of @xmath . These properties of the deformation will
enable us to prove that the deformation has some good versality
properties, namely so-called formal versality.

We maintain the notations and the assumptions from the Introduction.
Recall that we have a polyhedral divisor @xmath , where @xmath are
polyhedra, and all their vertices are lattice points. From now on,
without loss of generality, we may and will suppose that the point with
coordinate @xmath on @xmath is a removable special point, @xmath .
Recall that if we add a principal polyhedral divisor to @xmath , the
@xmath -variety will not change. So, after we add several principal
polyhedral divisors, each of which has two (removable) special points,
@xmath ( @xmath ) and @xmath , to @xmath , we may suppose that @xmath
(the origin in @xmath ) for all special points @xmath except @xmath . In
other words, @xmath is always a ray, which begins at the origin.

###### Remark \thechapter.1.

After these changes, all special points except @xmath will be either
essential or trivial.

###### Lemma \thechapter.2.

If @xmath is a polyhedron with tail cone @xmath and such that @xmath ,
then its individual evaluation function takes only nonpositive values.

###### Proof.

It is clear that if @xmath , then @xmath . ∎

###### Lemma \thechapter.3.

In the assumptions stated above, the individual evaluation function of
@xmath takes only nonnegative values and takes positive values on the
interior of @xmath . Therefore, @xmath .

###### Proof.

If @xmath , then @xmath since @xmath is semiample. Since @xmath for
@xmath , @xmath . If @xmath , moreover, is in the interior of @xmath
then @xmath since @xmath is big. So, @xmath . ∎

Denote @xmath .

###### Remark \thechapter.4.

If @xmath , then @xmath and @xmath .

###### Definition \thechapter.5.

We call a polyhedron @xmath with tail cone @xmath primitive if:

1.  @xmath .

2.  @xmath .

3.  @xmath .

In other words, a primitive polyhedron is the Minkowski sum of @xmath
and a specially chosen primitive lattice segment. One of the endpoints
of the segment should be the origin, but this segment cannot be chosen
totally arbitrarily, otherwise we could also obtain a polyhedron @xmath
with @xmath , not @xmath , or we could also get @xmath itself, if the
segment is inside @xmath . Fig. 7 shows an example of a primitive
polyhedron.

###### Remark \thechapter.6.

If @xmath is a primitive polyhedron with tail cone @xmath , then its
individual evaluation function takes only nonpositive values.

Clearly, if @xmath is a lattice polyhedron with tail cone @xmath and
with @xmath , then @xmath can be decomposed into a Minkowski sum of
several primitive polyhedra (each of them can be taken several times).
Decompose each polyhedron @xmath ( @xmath ) into a sum of primitive
polyhedra. Denote by @xmath all non-isomorphic primitive polyhedra we
have. We have @xmath for @xmath and for some numbers @xmath . Denote
@xmath . In other words, @xmath is the total number of times when a
polyhedron @xmath occurs in the decomposition of some of the polyhedra
@xmath (for some @xmath , @xmath ) into a Minkowski sum of primitive
polyhedra.

###### Remark \thechapter.7.

For each @xmath ( @xmath ), the individual evaluation function of @xmath
is linear on each of the cones in the total normal fan of @xmath .

###### Remark \thechapter.8.

@xmath .

First, let us construct an affine variety @xmath , which will be the
total space of the deformation. It will also be a variety with an action
of a torus of dimension 2, and we use the general construction of such
varieties outlined in the Introduction. Consider a vector space @xmath
with coordinates @xmath Here we take @xmath coordinates for each
primitive polyhedron @xmath we have. Consider also a projective line
@xmath with coordinate @xmath . Set @xmath . For divisors @xmath (
@xmath ) we take the vanishing loci of the polynomials @xmath (these are
polynomials in @xmath variables @xmath , not just in one variable @xmath
). Consider one more divisor @xmath . Finally, for a polyhedral divisor
we take @xmath .

It is not very easy to check directly that this polyhedral divisor is
proper, but it is clear that it defines a (possibly non-finitely
generated) algebra @xmath . We will find an easy description of this
algebra and then see directly that it is finitely generated.

The easiest way to describe the algebra @xmath is to embed it into an
algebra of polynomials. First, choose a @xmath -basis @xmath of @xmath
so that all points of @xmath are linear combinations of @xmath and
@xmath with positive coefficients . In other words, the cone generated
by @xmath and @xmath contains @xmath . Denote the dual basis of @xmath
by @xmath and @xmath . Then we will embed @xmath into @xmath , where the
variables @xmath and @xmath determine a grading (i. e. we introduce an
@xmath -grading on this algebra, and @xmath and @xmath , while the
degrees of all other variables equal zero). For each @xmath denote by
@xmath the following polynomial:

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma \thechapter.9.

Let @xmath be a degree. Then @xmath , and the @xmath th graded component
of @xmath is a free @xmath -module generated by

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

@xmath is a linear combination of the divisors @xmath ( @xmath ) with
nonpositive coefficients (Remark \thechapter .6 ) and of the divisor
@xmath with a nonnegative coefficient (Lemma \thechapter .3 ).
Therefore, @xmath is a subspace in the polynomial ring in the variables

  -- -------- --
     @xmath   
  -- -------- --

Namely, these polynomials are of degree at most @xmath with respect to
@xmath , and they are divisible by each of the polynomials

  -- -------- --
     @xmath   
  -- -------- --

To get the corresponding graded component of @xmath , we have to
multiply them by @xmath . Therefore, the @xmath th graded component is
generated by

  -- -------- --
     @xmath   
  -- -------- --

as a @xmath -module. The claim follows from Remark \thechapter .8 . ∎

Recall that in Chapter Equivariant deformations of algebraic varieties
with an action of an algebraic torus of complexity 1 we chose a set of
degrees @xmath , which contained Hilbert bases of all cones in the total
normal fan of @xmath .

###### Lemma \thechapter.10.

The algebra @xmath is finitely generated. More precisely, the generators
from Lemma \thechapter .9 for degrees @xmath generate @xmath .

###### Proof.

Fix a degree @xmath , and let @xmath be a cone from the total normal fan
of @xmath containing @xmath . Then all individual evaluation functions
of polyhedra @xmath are linear on @xmath , and the individual evaluation
function of @xmath is also linear on @xmath (and even on @xmath ) since
@xmath is a removable special point. If @xmath and @xmath , then @xmath
, and each element of the basis of the @xmath th graded component of
@xmath from Lemma \thechapter .9 is a product of an element of the basis
of the @xmath th graded component and of an element of the basis of the
@xmath th graded component. Therefore, since @xmath contains the Hilbert
basis of @xmath , all components of @xmath of degrees @xmath generate
the @xmath th graded component. ∎

So, @xmath is an algebraic variety, and @xmath acts on it. We have
@xmath global @xmath -invariant functions @xmath on @xmath , so we have
a @xmath -invariant map @xmath , which we denote by @xmath . It follows
directly from Lemma \thechapter .9 that this morphism is flat. We can
consider both @xmath and @xmath as varieties over the base @xmath .

###### Lemma \thechapter.11.

The morphism @xmath of @xmath -varieties is stably dominant.

###### Proof.

We will construct a graded @xmath -module @xmath such that @xmath and
@xmath . We are going to construct each @xmath -graded component of
@xmath separately. Fix a degree @xmath . Note that if we consider @xmath
as a polynomial in @xmath only, its leading coefficient will be equal 1,
and its degree will be @xmath . Now it follows from Lemma \thechapter .9
that for the @xmath th graded component of @xmath we can take the module
generated by the following generators: @xmath , where @xmath or @xmath .
The claim follows from Remark \thechapter .18 . ∎

Now we are ready to compute the fibers of @xmath using Lemma \thechapter
.21 . For an arbitrary point

  -- -------- --
     @xmath   
  -- -------- --

we define a divisor

  -- -------- --
     @xmath   
  -- -------- --

on a projective line as follows. Consider a projective line @xmath with
a coordinate function @xmath . For each @xmath ( @xmath ) denote by
@xmath the zeros of the function

  -- -------- --
     @xmath   
  -- -------- --

on @xmath with multiplicities (i. e. if we have a zero of order more
than one, we write the same point several times, for example, @xmath and
@xmath can be the same point). Then, for each @xmath ( @xmath ) and for
each @xmath ( @xmath ) we put @xmath at the point @xmath . If we put
several polyhedra at the same point of @xmath (for example, if we had a
zero of order more than one, or if the functions different values of
@xmath vanish at the same point), we take the Minkowski sum of them
instead. Finally, we put @xmath at the point of @xmath with coordinate
@xmath .

###### Lemma \thechapter.12.

Let

  -- -------- --
     @xmath   
  -- -------- --

be an arbitrary point. The fiber of @xmath over this point is the
T-variety defined by

  -- -------- --
     @xmath   
  -- -------- --

a polyhedral divisor on @xmath .

More precisely, the construction of a T-variety out of a polyhedral
divisor identifies the global functions on the T-variety with sections
of line bundles on @xmath . In this case, this identification works ”in
the natural way”, namely, as follows. Fix a degree @xmath . The
restriction of a function @xmath to the fiber is identified with the
rational function

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

First, let us check that

  -- -------- --
     @xmath   
  -- -------- --

is a proper polyhedral divisor. Since this is a polyhedral divisor on
@xmath , it is sufficient to check that for each @xmath

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the original divisor on @xmath describing the variety we
are going to deform. We have

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

is a proper polyhedral divisor.

Fix a degree @xmath . Let us compute

  -- -------- --
     @xmath   
  -- -------- --

Recall that Minkowski addition of two polyhedra leads to summation of
their individual evaluation functions. Denote all distinct points among
@xmath by @xmath . For each @xmath ( @xmath ) and for each @xmath (
@xmath ) denote by @xmath the order of zero of the function

  -- -------- --
     @xmath   
  -- -------- --

at the point @xmath . In other words, @xmath is the amount of indices
@xmath ( @xmath ) such that @xmath . Then the polyhedron in

  -- -------- --
     @xmath   
  -- -------- --

above a point @xmath is @xmath .

Then the global sections of

  -- -------- --
     @xmath   
  -- -------- --

are the polynomials in @xmath of degree at most @xmath divisible by

  -- -------- --
     @xmath   
  -- -------- --

On the other hand, if @xmath , then, by Lemmas \thechapter .21 and
\thechapter .11 , the functions of degree @xmath on

  -- -------- --
     @xmath   
  -- -------- --

are @xmath -generated by the images of polynomials

  -- -------- --
     @xmath   
  -- -------- --

under the quotient map

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the ideal in @xmath generated by equations @xmath . In
other words, the polynomials

  -- -------- --
     @xmath   
  -- -------- --

after the substitutions @xmath @xmath -generate the space of the
functions of degree @xmath on the fiber. ∎

###### Corollary \thechapter.13.

@xmath .∎

For each @xmath ( @xmath ), denote by @xmath the coefficients of the
polynomial with leading coefficient 1 and with roots at the points
@xmath , where the root at @xmath has multiplicity @xmath . In other
words,

  -- -------- --
     @xmath   
  -- -------- --

as polynomials in @xmath . Fix this notation until the end of Chapter
Equivariant deformations of algebraic varieties with an action of an
algebraic torus of complexity 1 .

###### Corollary \thechapter.14.

The fiber

  -- -------- --
     @xmath   
  -- -------- --

is isomorphic to the original @xmath -variety @xmath , which we are
deforming, and which was constructed from the polyhedral divisor @xmath
.∎

Therefore, we have constructed a deformation of @xmath over @xmath . Now
we are going to compute the Kodaira-Spencer map of this deformation.

### 18 Kodaira-Spencer map for a deformation given by perturbation of
generators

We are going to consider the following general situation. Suppose that
we have a deformation of a normal variety @xmath over an affine line.
Denote the total space of the deformation by @xmath and the function
from @xmath to @xmath by @xmath . Note that by definition this means
that the scheme-theoretic fiber @xmath is @xmath . Suppose also that
@xmath is embedded into a vector space, where @xmath is one of the
coordinates, and the other coordinates are @xmath . These data
canonically define a set of generators of the algebra @xmath , denote
them by @xmath . Suppose also that we have another vector space @xmath
with coordinates @xmath , and a dominant morphism @xmath . Note that it
already follows that @xmath is irreducible. Suppose that @xmath
satisfies the following two conditions:

1.  @xmath , in other words, the coordinate @xmath of a point @xmath
    equals @xmath . This condition implies that @xmath , moreover, the
    scheme-theoretic fiber also equals @xmath .

2.  The restriction of @xmath to the hyperplane @xmath is a dominant
    morphism to @xmath . This condition implies that @xmath is
    irreducible.

3.  The restriction of @xmath to the hyperplane @xmath maps it
    birationally to @xmath .

In algebraic terms, the existence of such a morphism @xmath and these
conditions mean the following. Suppose that @xmath is given by
polynomials: @xmath . Then @xmath can be understood as the subalgebra of
@xmath generated by @xmath and @xmath . For each @xmath such that @xmath
is dominant, the algebra of functions on @xmath can be understood as the
subalgebra of @xmath generated by @xmath . In particular, @xmath becomes
the subalgebra of @xmath generated by @xmath , and then, informally
speaking, when @xmath is deformed, the generators of the subalgebra are
also deformed, and the algebra of functions on the deformed variety is
the subalgebra generated by these deformed generators.

First, let us prove in this setting the following easy corollary of
Hilbert Nullstellensatz.

###### Lemma \thechapter.15.

Let @xmath be a regular function such that @xmath (which is a regular
function on @xmath ) can be written as @xmath , where @xmath . Then
there exists @xmath such that @xmath and @xmath .

###### Proof.

For each point @xmath of @xmath of the form @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

The set @xmath is open and dense in @xmath , so @xmath . By Hilbert
Nullstellensatz, some power of @xmath is divisible by @xmath , but since
@xmath is the scheme-theoretic fiber of @xmath above zero, the ideal
@xmath is radical, and @xmath itself is divisible by @xmath . Let @xmath
be such that @xmath . Then @xmath . Therefore, @xmath . ∎

Let @xmath be a smooth open sunset such that @xmath . And let @xmath be
a subset such that @xmath is defined on @xmath . Consider the following
section of @xmath : at each point @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

The first coordinate of this vector (the coefficient in front of @xmath
) is always one.

Consider the restriction of the deformation @xmath to the double point
at the origin corresponding to the vector @xmath . Denote the total
space of the deformation by @xmath and the flat morphism by @xmath
Denote the restrictions of functions @xmath to @xmath by @xmath .

Let @xmath be the ideal of equations of @xmath , i. e. @xmath . Since we
have chosen lifts of generators of @xmath to @xmath , we have a uniquely
determined map @xmath representing the deformation.

###### Proposition \thechapter.16.

For each function @xmath , denote by @xmath the image of @xmath under
the natural embedding @xmath ( @xmath actually does not depend on @xmath
and, informally speaking, equals @xmath as it is written). Set @xmath
(we apply the differential of a function to a rational vector field and
get a rational function).

1.   For each @xmath , @xmath is a regular function on the whole @xmath
    (by definition we only know that it is defined on @xmath )

2.  @xmath is a well-defined @xmath -linear morphism @xmath .

3.  @xmath represents the deformation @xmath in @xmath .

###### Proof.

The function @xmath is a rational function on @xmath , so it can be
written as a ratio of two polynomials in @xmath , and the second of them
has no zeros inside @xmath . Fix these two polynomials and consider them
now as polynomials in @xmath . Then we will get two regular functions on
@xmath , denote them by @xmath and @xmath , respectively. Then @xmath if
@xmath , and @xmath if @xmath .

Now consider a rational function @xmath on @xmath . Let @xmath be a
point such that @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

Therefore, the functions @xmath and @xmath coincide on @xmath . Then the
functions @xmath and @xmath (both of them are regular) also coincide on
@xmath , which is an open subset of the hyperplane @xmath , and their
difference @xmath is a polynomial divisible by @xmath .

Consider the following regular function on @xmath : @xmath . Clearly, it
vanishes if @xmath . Moreover,

  -- -------- --
     @xmath   
  -- -------- --

so

  -- -------- --
     @xmath   
  -- -------- --

and @xmath is a polynomial divisible by @xmath . Hence, @xmath is also
divisible by @xmath . We also know that @xmath is divisible by @xmath ,
so @xmath is divisible by @xmath . Then by Lemma \thechapter .15 applied
twice, @xmath is divisible by @xmath in @xmath .

Recall that we have lifts @xmath of the functions @xmath on @xmath . So,
the restriction of the deformation @xmath to the double point at the
origin can be represented by an element of @xmath . In particular, there
exists a polynomial @xmath such that @xmath in @xmath . By the
definition of @xmath this means that @xmath is divisible by @xmath in
@xmath . Denote the function @xmath understood as a function on the
whole @xmath by @xmath . Then @xmath is also divisible by @xmath .
Therefore, @xmath is divisible by @xmath in @xmath . Since @xmath is an
irreducible variety, @xmath is divisible by @xmath . So, @xmath , and
this by definition of the field of rational functions means that @xmath
in @xmath , and @xmath is in fact a regular function on @xmath .

Let us check that the map @xmath is @xmath -linear. The additivity of
@xmath is clear. Choose a polynomial @xmath and denote by @xmath the
polynomial @xmath understood as a polynomial in @xmath . Then @xmath ,
but @xmath is a function on @xmath , and the second summand on @xmath
equals zero, and the first summand on @xmath equals @xmath .

Now, since @xmath is a @xmath -linear map from @xmath to @xmath , it
vanishes on @xmath and induces a @xmath -linear map from @xmath to
@xmath . And we have already seen before that @xmath coincides with the
image of @xmath under the map @xmath corresponding to the first order
deformation in @xmath . ∎

We keep the notation @xmath introduced in Proposition \thechapter .16
for further usage. Recall that the first coordinate of any vector @xmath
, where @xmath , equals 1, and that @xmath does not actually depend on
@xmath . Denote the projection of @xmath to @xmath by @xmath . So, If we
replace @xmath by @xmath in the definition of @xmath , we will get the
same function. We will call @xmath the field of deformation speeds of
the deformation @xmath .

To formulate the next proposition, recall that @xmath .

###### Proposition \thechapter.17.

There exists a section @xmath such that @xmath coincides with the image
of the field of deformation speeds under the canonical map of sheaves
@xmath . Denote the image of @xmath under the snake map for the exact
sequence of sheaves

  -- -- --
        
  -- -- --

by @xmath . Then in the sense of Theorem \thechapter .4 , @xmath
represents the deformation @xmath .

###### Proof.

Recall the sheaf @xmath on @xmath , which was used in the proof of
Theorem \thechapter .4 . Since @xmath is affine, each sheaf on @xmath is
determined by the @xmath -module of its global sections, and @xmath . By
Proposition \thechapter .16 , @xmath represents an element of @xmath ,
and this element represents the deformation @xmath . Denote the
restriction of this element of @xmath to @xmath by @xmath .

The subset @xmath satisfies the conditions of Theorem \thechapter .4 .
Recall one more exact sequence of sheaves we have seen in the proof of
Theorem \thechapter .4 :

  -- -------- --
     @xmath   
  -- -------- --

The sheaves @xmath and @xmath are isomorphic, and this isomorphism
identifies @xmath and the embedding of the tangent vector bundles. So,
we have an isomorphism @xmath . By construction, this isomorphism
identifies the quotient map of vector bundles and @xmath . A direct
diagram-chase computation shows that this isomorphism identifies @xmath
with a section @xmath whose restriction to @xmath coincides with @xmath
.

It follows from the proof of Theorem \thechapter .4 that the element
@xmath representing the first order deformation is obtained from @xmath
via the snake map for the short exact sequence

  -- -------- --
     @xmath   
  -- -------- --

But we have identified this exact sequence with the short exact sequence

  -- -- --
        
  -- -- --

so that @xmath is identified with @xmath , therefore, @xmath is also
obtained from @xmath via the snake map for this sequence. ∎

### 19 Kodaira-Spencer map in the particular case of a deformation of a
T-variety

Let us apply the results of Section 18 to the deformation of the
T-variety we have. Section 18 speaks about one-parameter deformations,
and we have a deformation over a @xmath -dimensional space @xmath .
Moreover, the variety @xmath we want to deform is the fiber over the
point

  -- -------- --
     @xmath   
  -- -------- --

not above the origin. We are going to restrict the deformation to lines
(with a fixed coordinate, which we will denote by @xmath ) passing
through this point, and then restrict it further to the double point
corresponding to the tangent vector @xmath at the origin of this line.
So we will get a map @xmath , which is called Kodaira-Spencer map and
which is linear. Since this map is linear, it is sufficient to compute
it for the lines parallel to the coordinate axes in @xmath only.

So, until the end of Section 19 , fix two indices, @xmath and @xmath ,
@xmath , @xmath and consider the following map from an affine line
@xmath with coordinate @xmath to @xmath :

  -- -------- --
     @xmath   
  -- -------- --

Now let us apply the base change @xmath to the @xmath -varieties @xmath
and @xmath and to the morphism @xmath , which was stably dominant by
Lemma \thechapter .11 . We will get two new @xmath -varieties, @xmath
and @xmath (denote @xmath ) and a morphism @xmath (denote it by @xmath
). By Lemma \thechapter .20 , this morphism is a stably dominant
morphism of @xmath -varieties. Since @xmath is a @xmath -variety, we
have a morphism @xmath , which we will denote in Section 19 by @xmath ,
because it computes the coordinate on @xmath , which is @xmath . In the
subsequent sections, where the indices @xmath and @xmath will not be
fixed anymore, we will denote this morphism by @xmath .

The fact that @xmath means that @xmath is the pullback of the
deformation @xmath to the affine line. Informally speaking, we restrict
the deformation to an affine line (with a fixed coordinate function) in
@xmath . By Corollary \thechapter .14 , @xmath . We are going to
reformulate Lemmas \thechapter .9 and \thechapter .10 and describe
@xmath .

For each @xmath , denote

  -- -------- --
     @xmath   
  -- -------- --

These are polynomials in @xmath and @xmath .

###### Lemma \thechapter.18.

For each @xmath , the @xmath th graded component of @xmath (understood
as a subalgebra of @xmath ) is the free @xmath -module generated by

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We are going to use Lemma \thechapter .21 . We treat @xmath as a
subalgebra of @xmath , and @xmath as a subalgebra of @xmath . Then, by
Lemma \thechapter .21 , @xmath is the image of @xmath under the map
@xmath , @xmath for all @xmath . By a standard argument for tensor
products, this map works as follows: given a polynomial @xmath in
variables

  -- -------- --
     @xmath   
  -- -------- --

one should substitute

  -- -------- --
     @xmath   
  -- -------- --

instead of the variables

  -- -------- --
     @xmath   
  -- -------- --

respectively. So, the polynomials @xmath become exactly @xmath , and the
claim follows from Lemma \thechapter .9 . ∎

For each @xmath , @xmath , let us introduce the following notation. Set

  -- -------- --
     @xmath   
  -- -------- --

Denote the total number of these generators by @xmath .

###### Lemma \thechapter.19.

@xmath can be embedded into the algebra of polynomials in variables
@xmath as the subalgebra generated by @xmath and all @xmath , where
@xmath and @xmath .

###### Proof.

We can use Lemma \thechapter .21 in the same way as in the proof of the
previous Lemma. Then the claim follows from Lemma \thechapter .10 . ∎

In other words, @xmath is now embedded into an @xmath -dimensional
vector space with coordinates @xmath and @xmath , and @xmath is the
intersection of @xmath and the hyperplane @xmath .

###### Lemma \thechapter.20.

The preconditions of Section 18 are satisfied for @xmath , namely:

1.   The first coordinate of a point @xmath equals @xmath .

2.   The restriction of @xmath to the hyperplane @xmath is a dominant
    map to @xmath .

3.   The restriction of @xmath to the hyperplane @xmath maps it
    birationally to @xmath .

###### Proof.

The first claim is clear. Since @xmath is stably dominant, the second
claim follows from Lemma \thechapter .20 (applied to the change of base
from @xmath to the point @xmath in @xmath ).

For the last claim, let us suppose that @xmath and express @xmath ,
@xmath , and @xmath as rational functions on @xmath .

First, let us express @xmath . Choose a degree @xmath in the interior of
@xmath . Since @xmath is an integral proper polyhedral divisor, @xmath ,
so @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

and @xmath and @xmath are nonzero functions on @xmath since they are
nonzero polynomials in @xmath . Their ratio is a rational function on
@xmath , and it equals @xmath .

After we have an expression for @xmath , take two degrees @xmath and
@xmath that form a basis of @xmath (such degrees exist by the definition
of the set @xmath ). Write @xmath and @xmath . Then @xmath , and @xmath
is a nonzero function on @xmath since it is a nonzero element of @xmath
. Similarly, @xmath . So we have rational expressions for @xmath and
@xmath , and, since @xmath and @xmath form a basis of @xmath , we can
also get rational expressions for @xmath and @xmath on @xmath . ∎

Now we can apply the results of Subsection 18 .

###### Lemma \thechapter.21.

For each @xmath ( @xmath ) and for each @xmath ( @xmath ), the @xmath th
coordinate of the field of deformation speeds (i. e. the coordinate in
front of @xmath ) equals

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

A direct computation of

  -- -------- --
     @xmath   
  -- -------- --

proves this. The powers of @xmath , @xmath , and @xmath do not depend on
@xmath in @xmath , so multiplication by these powers multiplies the
derivative by the same powers. ∎

Denote this field of deformation speeds by @xmath . Recall that we have
a rational map @xmath , which is defined on an open set of @xmath ,
which we have denoted by @xmath . By Lemma \thechapter .20 , @xmath can
be considered as a rational function on @xmath . Also recall that we
have a coordinate function @xmath on @xmath .

###### Lemma \thechapter.22.

@xmath is defined on @xmath , and, if @xmath , then @xmath . If @xmath ,
then @xmath is defined at @xmath , and @xmath .

###### Proof.

Choose an arbitrary degree @xmath in the interior of @xmath . As we have
already seen in the proof of Lemma \thechapter .20 , @xmath can be
expressed as the ratio of two regular functions of degree @xmath on
@xmath , namely,

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .12 , these generators of the @xmath th graded
component of @xmath are identified with @xmath and @xmath ,
respectively.

Let @xmath be a point. By Proposition \thechapter .3 ,

  -- -------- --
     @xmath   
  -- -------- --

is defined at @xmath if and only if

  -- -------- --
     @xmath   
  -- -------- --

is defined at @xmath , i. e. if @xmath . So, if @xmath , then @xmath is
defined at @xmath , and in this case Proposition \thechapter .3 also
says that @xmath .

If @xmath , then the rational function

  -- -------- --
     @xmath   
  -- -------- --

is defined at @xmath , and @xmath . By Proposition \thechapter .3 ,

  -- -------- --
     @xmath   
  -- -------- --

is defined at @xmath , and @xmath . ∎

###### Lemma \thechapter.23.

If @xmath and @xmath is not an essential special point, then @xmath is
defined at @xmath .

If @xmath , @xmath is an essential special point, @xmath , and @xmath
(i. e. the decomposition of @xmath into a Minkowski sum of polyhedra
@xmath does not contain @xmath ), then @xmath is also defined at @xmath
.

###### Proof.

Denote @xmath . First, suppose that @xmath is defined at @xmath (in
other words, @xmath . Then @xmath is defined at @xmath and @xmath .
Recall that if @xmath is a removable special point, then it must be
trivial (Remark \thechapter .1 ).

We chose the numbers @xmath so that the function

  -- -------- --
     @xmath   
  -- -------- --

only has zeros at special points. More precisely, at a special point
@xmath this function has a zero of order @xmath , where the numbers
@xmath satisfy @xmath But if @xmath is a trivial special point ( @xmath
), then @xmath for all @xmath . So, if @xmath is either a trivial
special point, or an essential special point such that @xmath still
equals zero, then the function

  -- -------- --
     @xmath   
  -- -------- --

has zero of order 0, i. e. does not have a zero at all, at @xmath .

In other words, if @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

But then

  -- -------- --
     @xmath   
  -- -------- --

and the rational function

  -- -------- --
     @xmath   
  -- -------- --

is defined at @xmath .

Now suppose that @xmath is not defined at @xmath , or, informally
speaking, @xmath . We can write

  -- -------- --
     @xmath   
  -- -------- --

By Lemma \thechapter .22 , the rational function @xmath is defined at
@xmath , and @xmath . Since @xmath , the rational function

  -- -------- --
     @xmath   
  -- -------- --

is also defined (and takes value 0) at @xmath . ∎

We need to construct some tangent vector fields on @xmath (i. e.
sections of @xmath ). Let @xmath be a linear function on @xmath with
values in @xmath . In other words, let @xmath be a point of @xmath .
Recall that @xmath is embedded into an @xmath -dimensional vector space
@xmath with coordinates @xmath . Consider the following section of
@xmath and denote it by @xmath :

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma \thechapter.24.

In fact, @xmath consists of vectors tangent to @xmath , i. e. @xmath .

###### Proof.

It is sufficient to verify the condition @xmath on an open subset of
@xmath . For such an open subset we can use the open set where @xmath is
defined.

So, consider the following vector field on @xmath : @xmath . The
differential of @xmath maps it to

  -- -- --
        
  -- -- --

∎

Now recall that we have a sufficient system @xmath of @xmath . We have
@xmath of these sets, and each set @xmath , except @xmath , corresponds
to a pair @xmath , where @xmath is a special point, and @xmath .
Sometimes we have two open sets @xmath corresponding to one such pair,
this happens if and only if @xmath is removable special point and @xmath
and @xmath . We have @xmath for @xmath . The union @xmath was denoted by
@xmath , and @xmath . @xmath is smooth, and @xmath . We also have an
affine covering of @xmath , which consists of the sets @xmath for all
special points @xmath , where @xmath is the set of all ordinary points.

We are going to define tangent vector fields @xmath (one for each set
@xmath ) defined on some open subsets of @xmath so that @xmath for each
@xmath ( @xmath ). Note that @xmath , so, by Lemma \thechapter .23 ,
@xmath is already defined on @xmath , and we can (and we will) set
@xmath .

Now suppose that an open set @xmath ( @xmath ) corresponds to a special
point @xmath and a vertex @xmath . Then @xmath . If @xmath is a
removable special point (including the point with @xmath ), then by
Lemma \thechapter .23 , @xmath is defined on @xmath , and we set @xmath
. We do the same if @xmath is an essential special point, @xmath , but
@xmath .

Finally, let us consider the case when @xmath is an essential special
point, @xmath , and @xmath . This means that the convex piecewise-linear
function @xmath can be decomposed into a sum of several convex
piecewise-linear functions, and one of these summands is @xmath .
Addition of convex piecewise-linear functions can only split maximal
subcones of linearity into a smaller cones, and @xmath is a maximal
subcone of linearity of @xmath . Therefore, @xmath is a subcone of one
of the maximal subcones of linearity of the function @xmath . The
function @xmath has two maximal subcones of linearity, they are the
normal vertex cones of the two vertices of @xmath , @xmath for some
@xmath . Recall that points of @xmath , in particular, vertices of
@xmath , can be considered as functions on @xmath , and set

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma \thechapter.25.

For each @xmath , @xmath we have @xmath .

###### Proof.

The only nontrivial cases we have to consider are the cases when @xmath
satisfies the following conditions:

1.  @xmath , and hence @xmath corresponds to a pair @xmath , where
    @xmath is an essential special point, and @xmath .

2.  If @xmath , then @xmath .

Under these conditions, @xmath is contained in some of the cones @xmath
(for some @xmath ), and

  -- -------- --
     @xmath   
  -- -------- --

Then

  -- -------- --
     @xmath   
  -- -------- --

This section of @xmath is defined on @xmath if and only if each function
in front of @xmath is defined on @xmath . So, let us fix indices @xmath
( @xmath ) and @xmath ( @xmath ) until the end of the proof and check
that the function

  -- -------- --
     @xmath   
  -- -------- --

is defined on @xmath . Denote this (a priori rational) function on
@xmath by @xmath .

First, if @xmath , then @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

Now suppose that @xmath . We are going to use Lemma \thechapter .37 . By
Lemma \thechapter .22 , @xmath as a rational function on @xmath , so, if
we denote

  -- -------- --
     @xmath   
  -- -------- --

then

  -- -------- --
     @xmath   
  -- -------- --

as a rational function on @xmath . Denote by @xmath the following
section of @xmath :

  -- -------- --
     @xmath   
  -- -------- --

Then, by Lemma \thechapter .12 ,

  -- -------- --
     @xmath   
  -- -------- --

and @xmath .

Let us verify the conditions of Lemma \thechapter .37 . By construction,
@xmath is defined at all points of @xmath except @xmath , in particular,
it is defined at all ordinary point. And the denominator of @xmath does
not have zeros at ordinary points, so @xmath is regular at all ordinary
points, i. e. at all points of @xmath except, possibly, @xmath . Recall
that

  -- -------- --
     @xmath   
  -- -------- --

By choice of the coefficients @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

So, @xmath . For @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

It suffices to prove that

  -- -------- --
     @xmath   
  -- -------- --

By construction of the sets @xmath , we have @xmath , so @xmath and
@xmath . So,

  -- -------- --
     @xmath   
  -- -------- --

and it suffices to prove that @xmath .

Since @xmath , for each polyhedron @xmath such that @xmath , the cone
@xmath is contained in a maximal cone of linearity of the function
@xmath , which is the normal vertex cone of a vertex of @xmath . Denote
this vertex by @xmath . In other words, @xmath . (Note that @xmath
according to previously chosen notation.) If @xmath , denote by @xmath
an arbitrary vertex of @xmath . Then the points @xmath and @xmath define
the same function on the two-dimensional cone @xmath . Therefore, @xmath
in @xmath .

Now we can write

  -- -------- --
     @xmath   
  -- -------- --

Recall that @xmath is the minimum among the values that the function
@xmath takes at the vertices of @xmath , so @xmath . Moreover, since
@xmath , @xmath . These numbers are integer, so @xmath . Therefore,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Lemma \thechapter.26.

The image of the deformation @xmath under the Kodaira-Spencer map in
@xmath is represented by the following Cech class: on each intersection
@xmath ( @xmath ) we have vector field @xmath . Here @xmath (resp.
@xmath ) if we use @xmath (resp. @xmath ) as the affine covering of
@xmath .

###### Proof.

This follows directly from Proposition \thechapter .17 and Lemmas
\thechapter .21 , \thechapter .24 , and \thechapter .25 . ∎

###### Corollary \thechapter.27.

The isomorphisms

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

(respectively) from Corollary \thechapter .14 identifies the image of
the deformation @xmath under the Kodaira-Spencer map with the classes of

  -- -- --
        
  -- -- --

and

  -- -------- --
     @xmath   
  -- -------- --

(respectively).

###### Proof.

This follows from Lemma \thechapter .26 and the construction of
isomorphisms in the proof of Proposition \thechapter .11 . ∎

###### Lemma \thechapter.28.

Let @xmath be a homogeneous function of degree @xmath on @xmath , and
let @xmath .

If @xmath corresponds to an essential special point @xmath and a vertex
@xmath , then

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is such that @xmath .

Otherwise, @xmath (recall that @xmath in this case).

###### Proof.

Each function of degree @xmath on @xmath is a polynomial in variables
@xmath . Let us first consider the case when @xmath is a monomial. Then
we prove the lemma by induction on the number of variables in this
monomial.

First, if @xmath , then @xmath , and the statement of Lemma holds by the
definition of @xmath .

Suppose that @xmath , where @xmath is another monomial of degree @xmath
, and the statement follows from Leibniz rule.

Finally, the statement of lemma for arbitrary polynomials follows by
linearity. ∎

###### Lemma \thechapter.29.

Let @xmath .

If @xmath corresponds to an essential special point @xmath and a vertex
@xmath , then the @xmath -description of @xmath equals

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is such that @xmath .

Otherwise, the @xmath -description of @xmath is @xmath (recall that
@xmath in this case).

###### Proof.

Suppose that @xmath corresponds to an essential special point @xmath and
a vertex @xmath .

Let @xmath be an ordinary point, and let @xmath be the canonical point
in @xmath . Then the rational function

  -- -------- --
     @xmath   
  -- -------- --

is defined at @xmath , @xmath is defined at @xmath , and @xmath (Lemma
\thechapter .22 ).

By definition, the values of the first two components of the @xmath
-description of @xmath at @xmath equal @xmath and @xmath , respectively.
By the previous lemma,

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

But by the definition of a canonical point, @xmath . So, the values of
the first two components of the @xmath -description equal

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

respectively.

To compute the third component of the @xmath -description, note that by
Lemma \thechapter .22 , @xmath can be considered as follows. Consider
the affine chart @xmath on @xmath . It is an affine line, and @xmath is
a coordinate on it. Then @xmath is a function on @xmath that computes
the coordinate @xmath of the image of a point @xmath . In these terms,
@xmath .

Let us compute @xmath . Choose a degree @xmath in the interior of @xmath
. As we have seen in the proof of Lemma \thechapter .20 , there exist
global functions @xmath and @xmath of degree @xmath on @xmath such that
@xmath . Using the previous lemma again, we can write

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Corollary \thechapter.30.

Let @xmath .

If @xmath corresponds to an essential special point @xmath and a vertex
@xmath , then the @xmath -description of @xmath equals

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is such that @xmath .

Otherwise, the @xmath -description of @xmath is @xmath .

###### Proof.

This follows directly from Lemma \thechapter .23 . ∎

So, we have computed the Kodaira-Spencer map for a set of basis vectors
of @xmath , and therefore by linearity we can now compute it for an
arbitrary vector from @xmath . Let us prove the surjectivity of this
map.

### 20 Surjectivity of the Kodaira-Spencer map

To prove the surjectivity, we use the results of Chapter Equivariant
deformations of algebraic varieties with an action of an algebraic torus
of complexity 1 . We will prove that the composition @xmath is
surjective and that @xmath contains @xmath .

Denote by @xmath the space of @xmath -tuples of the form

  -- -------- --
     @xmath   
  -- -------- --

where each @xmath is a rational function on @xmath , each @xmath is a
rational vector field on @xmath , and each triple @xmath is the @xmath
-description of a @xmath -invariant vector field defined on @xmath .
This space @xmath can be identified (using the notion of an @xmath
-description) with the zeroth graded component of

  -- -------- --
     @xmath   
  -- -------- --

Hence, we have a map

  -- -------- --
     @xmath   
  -- -------- --

Denote the preimage under this map of

  -- -------- --
     @xmath   
  -- -------- --

by @xmath . By Corollary \thechapter .14 ,

  -- -------- --
     @xmath   
  -- -------- --

Therefore, we have a surjective map from @xmath to the zeroth graded
component of @xmath , and each element of @xmath can be interpreted as
an element of the zeroth graded component of @xmath .

Recall that if @xmath is an essential special point and @xmath , then we
have denoted by @xmath the index such that @xmath is the set among
@xmath that corresponds to @xmath . Now we extend this notation so that
we could use it also for removable special points. First, if @xmath is
an essential special point, denote @xmath . If @xmath is a removable
special point, denote by @xmath the amount of sets @xmath corresponding
to @xmath (there can be one or two such sets). Recall that we enumerate
the sets @xmath in such an order that if we have two sets @xmath
corresponding to the same removable special point @xmath , then they are
consequent, i. e. they are @xmath and @xmath for some @xmath . Then
denote this @xmath by @xmath , and set @xmath . If we have only one set
@xmath corresponding to a removable special point @xmath , denote this
@xmath by @xmath . Now we can say that in general, we enumerate the sets
@xmath so that the sequence

  -- -------- --
     @xmath   
  -- -------- --

is just

  -- -------- --
     @xmath   
  -- -------- --

In Chapter Equivariant deformations of algebraic varieties with an
action of an algebraic torus of complexity 1 , we also needed one
coordinate function on @xmath (i. e. a function with one zero and one
pole) for each special point @xmath . This function was denoted by
@xmath and it had its single zero at @xmath . Now let us set @xmath for
all special points where @xmath is defined, and if @xmath (then @xmath
is a removable special point), then set @xmath .

We will need one more notation. Fix a primitive polyhedron @xmath (
@xmath ). Let @xmath be a special point. If @xmath , set @xmath .
Otherwise, @xmath is an essential special point, and for each vertex
@xmath ( @xmath ) its normal vertex cone @xmath is a subcone of one of
two cones @xmath or @xmath . Moreover, the vertices of @xmath whose
normal vertex cones are subcones of one of these two cones are
consequent, more precisely, the values of @xmath such that @xmath are
all integers between @xmath and some @xmath ( @xmath ), inclusively.
This @xmath is precisely the index such that @xmath is the edge of
@xmath parallel to the finite edge of @xmath . Set @xmath . Then @xmath
if and only if @xmath , and @xmath if and only if @xmath .

###### Lemma \thechapter.31.

If @xmath is a primitive polyhedron, @xmath is an essential special
point, and @xmath , then @xmath .

###### Proof.

This follows from the definition of @xmath and the fact that @xmath . ∎

Now note that in Lemma \thechapter .29 and in Corollary \thechapter .30
, if @xmath , then @xmath , so the @xmath -description and the @xmath
-description are both zero. So, the image of the Kodaira-Spencer map
computed in the previous section can be written as follows.

###### Lemma \thechapter.32.

The image of the Kodaira-Spencer map for the deformation @xmath in
@xmath is represented by the following class in @xmath :

  -- -------- --
     @xmath   
  -- -------- --

where:

1.  @xmath for all @xmath ( @xmath ).

2.  @xmath if @xmath is a special point, @xmath , and @xmath .

3.  -- -------- --
         @xmath   
      -- -------- --

    if @xmath is a special point, @xmath , and @xmath .∎

We keep the notation @xmath for further usage.

Denote the subspace of @xmath spanned by all @xmath for @xmath and
@xmath by @xmath .

Now it suffices to prove that the map @xmath is a surjection, and that
@xmath contains @xmath .

Let us start with @xmath . First, we need to understand the map @xmath .
Recall that we interpret @xmath as

  -- -------- --
     @xmath   
  -- -------- --

In particular, global sections of @xmath that project down to the
appropriate kernel define global sections of @xmath . Now it follows
from the discussion in the end of Section 8 that the map @xmath is
induced by the following map @xmath : Given

  -- -------- --
     @xmath   
  -- -------- --

let

  -- -------- --
     @xmath   
  -- -------- --

be such that each @xmath is the vector field of degree 0 on @xmath with
@xmath -description @xmath .

We will follow the argument from Chapter Equivariant deformations of
algebraic varieties with an action of an algebraic torus of complexity 1
. There we have introduced the notion of an excessive index @xmath ,
which is one of two indices corresponding to a removable special point
@xmath . We checked that we can replace @xmath with

  -- -------- --
     @xmath   
  -- -------- --

(the morphism

  -- -------- --
     @xmath   
  -- -------- --

duplicates the entries with the non-excessive indices @xmath
corresponding to the same removable special points to get the entries
with excessive indices) so that

  -- -------- --
     @xmath   
  -- -------- --

is mapped surjectively onto @xmath . Since in each element of @xmath all
entries with indices (both excessive and non-excessive) corresponding to
essential special points are zeros, we can just forget entries
corresponding to the excessive indices to get the map

  -- -------- --
     @xmath   
  -- -------- --

from the map @xmath described above.

After that, we have split the interpretation of @xmath as

  -- -------- --
     @xmath   
  -- -------- --

into @xmath direct summands, each of them consisted of sections over
@xmath for a special point @xmath (Corollary \thechapter .14 ad
discussion below). The morphism between these two interpretations was
the restriction map for sheaves from @xmath to @xmath . More important,
the kernel @xmath also gets split into @xmath direct summands, in other
words, the kernel equals the sum of its intersections with each direct
summand.

Then some of the summands of the double direct sum turned out to be
zero, and we got the following interpretation of @xmath (Lemma
\thechapter .15 ):

  -- -------- --
     @xmath   
  -- -------- --

The isomorphism between these two interpretations of @xmath works as
follows: given an element @xmath of

  -- -------- --
     @xmath   
  -- -------- --

each entry of its image in

  -- -------- --
     @xmath   
  -- -------- --

with index @xmath in the inner direct sum (in fact, there is only one
such entry for each @xmath , where @xmath , @xmath is not excessive) is
(locally on @xmath ) the @xmath th entry the direct sum for @xmath .

In particular, if @xmath originates from a global section of

  -- -------- --
     @xmath   
  -- -------- --

then the entry of the result with index @xmath in the inner sum is the
restriction of the @xmath th entry of @xmath from @xmath to @xmath . In
fact, this restriction is a trivial operation since @xmath .

Hence, the map

  -- -------- --
     @xmath   
  -- -------- --

works as follows. Given

  -- -------- --
     @xmath   
  -- -------- --

for each @xmath ( @xmath , @xmath is not excessive), the entry of the
result with index @xmath in the inner direct sum is the vector field on
@xmath with the @xmath -description @xmath .

After that, we proved that the summands of the outer direct sum where
@xmath is a removable special point are in fact zero, and removed them,
rewriting @xmath as

  -- -------- --
     @xmath   
  -- -------- --

Again, the kernel @xmath is also split in the direct sum of its
intersections with each of the direct summands. The map from @xmath
again computes the @xmath th entry out of the @xmath th entry of an
element of @xmath treated as an @xmath -description.

Recall that for each essential special point @xmath and for each @xmath
( @xmath ) we have denoted by @xmath the space of triples of two regular
functions and one vector field defined on @xmath . We also have denoted
by @xmath the map (actually, it is an isomorphism) @xmath that computes
a vector field defined on @xmath out if its @xmath -description. Note
also that @xmath since both spaces are the spaces of @xmath -invariant
vector fields defined on @xmath . The direct sum of maps @xmath for a
fixed essential special point @xmath and for all @xmath ( @xmath ) was
denoted by @xmath

Let us also denote

  -- -------- --
     @xmath   
  -- -------- --

Denote the direct sum of all isomorphisms @xmath for all essential
special points @xmath by by

  -- -------- --
     @xmath   
  -- -------- --

Using this isomorphism, we can say that we have a map @xmath , and this
map works as follows: the @xmath th entry of the image of an element
@xmath of @xmath is the @xmath th triple (i. e. the @xmath th, the
@xmath th, and the @xmath th entries) of @xmath .

To proceed, we will need a more convenient basis for @xmath . Recall
that for each primitive polyhedron @xmath ( @xmath ),

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma \thechapter.33.

Fix a primitive polyhedron @xmath ( @xmath ) and denote temporarily
@xmath Consider the rational functions

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath and @xmath such that @xmath and @xmath .

All these functions together span the same subspace in rational
functions on @xmath as @xmath .

###### Proof.

By partial fraction decomposition theorem, the functions

  -- -------- --
     @xmath   
  -- -------- --

for all @xmath and @xmath such that @xmath and @xmath form a basis of
all rational functions of the form

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is a polynomial in @xmath of degree at most @xmath . After
the multiplication by @xmath , we get the claim of the lemma. ∎

For each @xmath ( @xmath ) and for each pair @xmath , where @xmath and
@xmath denote

  -- -------- --
     @xmath   
  -- -------- --

where:

1.  @xmath for all @xmath .

2.  @xmath if @xmath is a special point and @xmath .

3.  -- -------- --
         @xmath   
      -- -------- --

    if @xmath is a special point, @xmath , and @xmath .

###### Lemma \thechapter.34.

@xmath is spanned by all functions @xmath , where @xmath , @xmath , and
@xmath .

###### Proof.

By Lemma \thechapter .33 , we may replace the numerators of functions in
@xmath from @xmath to the functions from the statement of Lemma
\thechapter .33 . After doing this, we get exactly @xmath . ∎

Now let us recall that for each essential special point @xmath we had a
vector space @xmath and a map @xmath (actually, it maps @xmath to a
subspace of @xmath , which was called @xmath ) such that the composition
@xmath maps @xmath surjectively onto the graded component corresponding
to @xmath of the kernel @xmath (see Proposition \thechapter .31 and
Remark \thechapter .18 ).

So, denote @xmath , and denote the direct sum of all maps @xmath by
@xmath . Then the composition @xmath maps @xmath surjectively onto
@xmath . By the definition of the maps @xmath , @xmath actually works as
follows: it computes @xmath -descriptions out of @xmath -descriptions
and adds some zeros.

It would be sufficient to prove that the image of @xmath in @xmath
contains @xmath , but this is not true in general. Instead, we will
construct another vector space @xmath , whose elements will define the
same classes in @xmath (and even in @xmath ) as elements of @xmath , and
whose image in @xmath will contain @xmath .

Namely, @xmath will consist of some of the @xmath -tuples of the form

  -- -------- --
     @xmath   
  -- -------- --

where each @xmath is a regular function on @xmath , each @xmath is a
vector field on @xmath . We will take only some of these @xmath -tuples,
not all of them. More precisely, @xmath will be spanned by the following
elements @xmath , where @xmath , @xmath , and @xmath :

  -- -------- --
     @xmath   
  -- -------- --

where:

1.  @xmath for all @xmath .

2.  1.  If @xmath , where @xmath , then

          -- -------- --
             @xmath   
          -- -------- --

        for @xmath .

    2.  Otherwise (if @xmath is not of this form), @xmath .

###### Lemma \thechapter.35.

For each @xmath , @xmath , and @xmath ( @xmath , @xmath , and @xmath ),
@xmath and @xmath define the same class in @xmath .

###### Proof.

Write

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

Choose an index @xmath such that the @xmath th entries of the images of
@xmath and of @xmath in @xmath differ. First, note that @xmath
corresponds to an essential special point @xmath , otherwise both
entries are zeros since @xmath for removable special points @xmath .

So, @xmath is an essential special point and there exists an index
@xmath ( @xmath ) such that @xmath . such that the @xmath th entries of
the images of

Now the fact that the @xmath th entries of the images of @xmath and of
@xmath in @xmath differ means that @xmath , @xmath , and the different
entries have the following @xmath -descriptions:

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , the functions @xmath and @xmath are defined on @xmath ,
so the vector fields with these descriptions are defined on @xmath , and
@xmath and @xmath define the same class in @xmath . ∎

###### Corollary \thechapter.36.

@xmath is contained in @xmath and therefore defines a subspace of @xmath
. Moreover, images of @xmath and of @xmath in @xmath are the same.∎

The map @xmath is defined in the same way as the map @xmath : Given

  -- -------- --
     @xmath   
  -- -------- --

if @xmath is an essential special point and @xmath , then the @xmath th
entry of the image of @xmath is @xmath .

###### Corollary \thechapter.37.

The images of @xmath and of @xmath in @xmath define the same subspace of
@xmath .∎

We will need a slightly different set of generators for @xmath . If
@xmath is an essential special point, @xmath , and @xmath , denote

  -- -------- --
     @xmath   
  -- -------- --

where:

1.  @xmath for all @xmath .

2.  1.  If @xmath , where @xmath , then

          -- -------- --
             @xmath   
          -- -------- --

        for @xmath .

    2.  Otherwise (if @xmath is not of this form), @xmath .

(we do not claim a priori that @xmath ).

###### Lemma \thechapter.38.

If @xmath is an essential special point, @xmath , and @xmath , then
@xmath .

Moreover, all @xmath (for all essential special points @xmath , @xmath ,
and @xmath ) are elements of @xmath and generate @xmath .

###### Proof.

The first claim follows from the following equality:

  -- -------- --
     @xmath   
  -- -------- --

This is true because @xmath is the edge of @xmath parallel to @xmath ,
@xmath , @xmath (Lemma \thechapter .31 ), and @xmath .

To check the second claim, we need to do the following. For each
essential special point @xmath and for each @xmath ( @xmath ) we have to
check that there exists a primitive polyhedron @xmath ( @xmath ) such
that @xmath . But this follows from the equality @xmath and the fact
that if @xmath , then @xmath is the edge of @xmath parallel to @xmath .

To finish the proof, note that for removable special points @xmath ,
@xmath for all @xmath , so it is not possible to take @xmath so that
@xmath , so there are no generators @xmath , where @xmath is a removable
special point. ∎

###### Remark \thechapter.39.

For each @xmath , @xmath , and @xmath ( @xmath is an essential special
point, @xmath , and @xmath ), the image of @xmath in @xmath actually
belongs to @xmath .

The space @xmath consists of functions, which are interpreted as @xmath
-descriptions of vector fields. The functions on @xmath are interpreted
as @xmath -descriptions for different values of @xmath . To work with
@xmath easier, let us construct another space @xmath , whose elements
will be interpreted as @xmath -descriptions. So, by definition @xmath
consists of some of the @xmath -tuples of the form

  -- -------- --
     @xmath   
  -- -------- --

where each @xmath is a regular function on @xmath , each @xmath is a
vector field on @xmath . More precisely, @xmath is spanned by @xmath
-tuples called @xmath , where @xmath is an essential special point,
@xmath , @xmath . By definition,

  -- -------- --
     @xmath   
  -- -------- --

where:

1.  @xmath for all @xmath .

2.  1.  If @xmath , where @xmath , then

          -- -------- --
             @xmath   
          -- -------- --

        for @xmath .

    2.  Otherwise (if @xmath is not of this form), @xmath .

Clearly, @xmath is isomorphic to @xmath , and the isomorphism computes
the @xmath th, @xmath th, and @xmath th entries of an element of @xmath
as the @xmath -description of the vector field with the @xmath
-description consisting of the @xmath th, @xmath th, and @xmath th
entries of the corresponding element of @xmath .

The resulting morphism @xmath works as follows. Given @xmath , the
@xmath th entry of its image in @xmath is the @xmath -description of the
vector field on @xmath with the @xmath -description formed by the @xmath
th, the @xmath th, and the @xmath th entries of @xmath .

Recall that @xmath works in a similar way: the @xmath th entry of the
image is the @xmath -description computed from the @xmath -description
formed by the @xmath th and the @xmath th entries of an element of
@xmath and 0. So, if we construct a morphism that reorders entries of am
element of @xmath in the appropriate way (and removes some zeros) and
maps @xmath to @xmath , we will factor the map @xmath through @xmath .

###### Lemma \thechapter.40.

Let

  -- -------- --
     @xmath   
  -- -------- --

Fix a special point @xmath and consider the following sequences, which
we will denote by @xmath :

  -- -------- --
     @xmath   
  -- -------- --

Then @xmath .

###### Proof.

Without loss of generality, @xmath for some essential special point
@xmath , @xmath , @xmath . Moreover, if this is true, and @xmath , then
@xmath is the zero sequence by the definition of @xmath . So suppose
that @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

Let us check the conditions in the definition of @xmath one by one.
Condition 1 is satisfied by the choice of functions @xmath in this
section. Condition 2 is satisfied since @xmath . Condition 3 is only
nontrivial for the edge @xmath . For this edge, it suffices to check
that

  -- -------- --
     @xmath   
  -- -------- --

The expression at the left is the way of writing in coordinates of
@xmath . And by a property of the normal cone of an edge of a
polyhedron, if we shift an argument of @xmath along the edge, the value
will not change. So, @xmath , and

  -- -------- --
     @xmath   
  -- -------- --

Finally, Condition 4 is again nontrivial only for the edge @xmath , and
for this edge we have @xmath . ∎

So, we have defined a map @xmath . Now, if @xmath , denote

  -- -------- --
     @xmath   
  -- -------- --

Then we have a map @xmath , and it follows directly from the definitions
of these maps that the map @xmath we have is the composition of @xmath
and @xmath . Now it suffices to check that @xmath is surjective.

If @xmath is an essential special point, @xmath , and @xmath , denote
the following element of @xmath by @xmath :

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

###### Corollary \thechapter.41.

If @xmath is an essential special point, @xmath , and @xmath , then
@xmath , and @xmath if @xmath .∎

###### Lemma \thechapter.42.

Let @xmath be an essential special point. Then all @xmath for all
possible @xmath and @xmath ( @xmath , and @xmath ) span (and even form a
basis of) @xmath .

###### Proof.

Clearly, all these sequences @xmath are nonzero and linearly
independent. The amount of them is @xmath (Remark \thechapter .30 ). ∎

###### Corollary \thechapter.43.

@xmath is surjective.∎

Finally, we get the following proposition:

###### Proposition \thechapter.44.

The map @xmath is surjective.∎

Now we continue with @xmath . We will have to prove that it contains
@xmath . Let us start with the following lemma.

###### Lemma \thechapter.45.

Let @xmath be an essential special point, @xmath , @xmath . Let @xmath
be the vector field on @xmath with @xmath -description @xmath , where
@xmath (recall that @xmath is defined at all essential special points).

Let @xmath be the @xmath -description of @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

are rational functions on @xmath regular at @xmath .

###### Proof.

By Lemma \thechapter .23 ,

  -- -------- --
     @xmath   
  -- -------- --

for @xmath . Denote

  -- -------- --
     @xmath   
  -- -------- --

then

  -- -------- --
     @xmath   
  -- -------- --

Let us find @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , we have @xmath and @xmath . By the definition of @xmath
and of @xmath , @xmath for @xmath and @xmath for @xmath . So, @xmath and
@xmath . Now,

  -- -------- --
     @xmath   
  -- -------- --

Consider also functions

  -- -------- --
     @xmath   
  -- -------- --

Its logarithmic derivative equals

  -- -- --
        
  -- -- --

and

  -- -------- --
     @xmath   
  -- -------- --

Clearly, @xmath , and @xmath , so the logarithmic derivative of @xmath
is regular at @xmath . We have

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Corollary \thechapter.46.

Let @xmath be an essential special point, @xmath , @xmath . Let @xmath
be the vector field on @xmath with @xmath -description @xmath , where
@xmath (recall that @xmath is defined at all essential special points)
and @xmath are regular at @xmath .

Let @xmath be the @xmath -description of @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

are rational functions on @xmath regular at @xmath .

###### Proof.

Set

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -- --
        
  -- -- --

Then @xmath . Since the entries of @xmath are constants, the functions
@xmath and @xmath are regular at @xmath . The claim follows from Lemma
\thechapter .45 . ∎

We need to introduce a notation. Let @xmath be an essential special
point. Let @xmath be a vector field on @xmath . Let @xmath be the @xmath
-description of the vector field on @xmath with the @xmath -description
@xmath . It follows from the form of the matrix @xmath and properties of
logarithmic derivatives that the functions @xmath and @xmath have poles
of order at most one at @xmath . So, functions @xmath ( @xmath ) are
regular at @xmath . Denote their values at @xmath by @xmath and @xmath ,
respectively. Then functions @xmath ( @xmath ) are regular at @xmath .
We keep this notation @xmath and @xmath until the end of the section,
while @xmath , @xmath , @xmath , and @xmath will be used in the sequel
to denote other objects.

###### Lemma \thechapter.47.

Let @xmath be an essential special point, @xmath , and let @xmath be the
vector field on @xmath with @xmath -description @xmath . Let @xmath be
the @xmath -description of @xmath . Then @xmath and @xmath are regular
at @xmath .

###### Proof.

Set

  -- -------- --
     @xmath   
  -- -------- --

Then

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

so

  -- -------- --
     @xmath   
  -- -------- --

Functions @xmath are regular at @xmath , the entries of @xmath are
constants, so @xmath and @xmath are regular at @xmath . ∎

Consider the following elements of @xmath : For each essential special
point @xmath set

  -- -------- --
     @xmath   
  -- -------- --

Denote by @xmath the subspace of @xmath spanned by all @xmath .

We are going to prove that @xmath . As before, we will replace @xmath by
another vector space that will represent the same subspace of @xmath .
Namely, for each essential special point @xmath denote by @xmath the
following element of @xmath .

  -- -------- --
     @xmath   
  -- -------- --

where:

1.  If @xmath , where @xmath , then @xmath is the @xmath -description of
    the vector field on @xmath with the @xmath -description @xmath .

2.  Otherwise (if @xmath is not of this form), @xmath .

###### Lemma \thechapter.48.

For each essential special point @xmath , @xmath and @xmath define the
same class in @xmath .

###### Proof.

Let

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

It is sufficient to prove the following: for each @xmath ( @xmath ),

  -- -------- --
     @xmath   
  -- -------- --

is the @xmath -description of a vector field defined on @xmath . In
other words, we have to check that the functions @xmath and @xmath are
regular at @xmath (for @xmath this is clear).

First, let us find a precise expression for @xmath and @xmath . By the
definition of @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

(Note that for @xmath we get @xmath .)

For @xmath , the functions @xmath and @xmath are regular at @xmath by
Lemma \thechapter .47 . For other values of @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

These functions are regular at @xmath by Corollary \thechapter .46 since
@xmath is the @xmath -description of a vector field on @xmath with
@xmath -description @xmath , and functions @xmath and @xmath are regular
at @xmath . ∎

###### Corollary \thechapter.49.

For each essential special point @xmath , @xmath . Moreover, @xmath and
@xmath define the same classes in @xmath .∎

Denote the subspace of @xmath generated by all @xmath by @xmath . By
Corollary \thechapter .49 , @xmath is a subspace of @xmath . We will
prove that @xmath .

Let us recall the results of Chapter Equivariant deformations of
algebraic varieties with an action of an algebraic torus of complexity 1
related with @xmath . There we have introduced vector spaces

  -- -------- --
     @xmath   
  -- -------- --

and (for each special point @xmath ) @xmath , which was the space of
triples of Laurent polynomials in @xmath of a certain form, where the
first two polynomials were rational functions on @xmath , and the last
one was a rational vector field on @xmath . @xmath was mapped to @xmath
, namely, a sequence of tangent vectors @xmath , where @xmath , was
mapped to a sequence of rational functions and vector fields on @xmath ,
where all functions are zeros, and the vector fields on @xmath defined
by the same formulas (plus zero vector fields for removable special
points). @xmath was further mapped to @xmath . Then we proved (Lemma
\thechapter .10 ) that @xmath is mapped to @xmath surjectively.

The space @xmath has the following obvious basis: for each @xmath such
that @xmath is an essential special point, let @xmath be the sequence
with the @xmath th entry @xmath (recall that @xmath for essential
special points) and all other entries are zeros. The image of @xmath in
@xmath is @xmath , and the image of @xmath in @xmath with @xmath is
@xmath .

We also checked (Lemma \thechapter .8 ) that if we change the first two
entries of an element of @xmath , where @xmath is a special point,
arbitrarily, then the class of this element in @xmath will not change.
So, if @xmath is an essential special point, set @xmath . Denote the
subspace of @xmath spanned by all @xmath by @xmath . By Lemma
\thechapter .8 , @xmath is mapped surjectively onto @xmath .

The sheaf @xmath was constructed as follows. Its sections on an open set
@xmath were sequences of length @xmath , where the first @xmath entries
were rational functions on @xmath and the last entry was a rational
vector field on @xmath . More precisely, for each @xmath ( @xmath ) the
@xmath th, the @xmath th, and the @xmath th entries from the @xmath
-description of the same (i. e. not depending on @xmath ) vector field
on @xmath . For each special point @xmath we had a morphism @xmath ,
which computed all @xmath -descriptions of a vector field by its @xmath
-description. Then these morphisms were summed up to a map

  -- -------- --
     @xmath   
  -- -------- --

where the second arrow is the canonical projection.

We also had a sheaf @xmath , which was the zeroth graded component of
@xmath . And we had an isomorphism @xmath , which computed vector fields
out of their @xmath -descriptions.

Finally, we need to understand the map @xmath . We have affine coverings
@xmath of @xmath and @xmath of @xmath . We interpret @xmath as a
quotient of @xmath and @xmath as a subquotient of @xmath . As it was
explained in Section 8 , to describe the map @xmath , we need to
enumerate the sets @xmath by pairs of indices so that the first index in
such a pair corresponds to one of the open sets from the affine covering
of @xmath . For such an enumeration, we use the notation @xmath .
Namely, recall that for each @xmath ( @xmath ) there exists a (removable
or essential) special point @xmath and an index @xmath ( @xmath ) such
that @xmath . So, denote @xmath for all special points @xmath and for
all @xmath ( @xmath ). Then @xmath , and the conditions of Section 8 are
satisfied. (Note that the set that was denoted in the ”generic”
situation of Section 8 by @xmath is now @xmath , and the set that was
denoted in the the ”generic” situation of Section 8 by @xmath is now
@xmath ). After we have introduced these notations, we can say that the
map @xmath is induced by the following map @xmath . The @xmath th entry
of the result is the @xmath th entry of the preimage restricted to
@xmath (originally it was a vector field on @xmath ).

Summarizing, we see that the map @xmath is induced by the following map
@xmath . The @xmath th entry of the result is the vector field whose
@xmath -description is the @xmath th entry of the preimage. In
particular, each @xmath (for each essential special point @xmath ) is
mapped to the following sequence. If @xmath for some @xmath ( @xmath ),
then the @xmath th entry of the result is the vector field on @xmath
with the @xmath -description @xmath . Otherwise (for other values of
@xmath ), the @xmath th entry of the result is 0. By the definition of
@xmath , the image of @xmath in @xmath is the same. Therefore, @xmath ,
and we get the following proposition.

###### Proposition \thechapter.50.

@xmath contains @xmath .∎

The following proposition follows from Propositions \thechapter .44 and
\thechapter .50 .

###### Proposition \thechapter.51.

The deformation @xmath of @xmath constructed in Section 17 has
surjective Kodaira-Spencer map.∎

Finally, let us recall the definition of a formally versal deformation.
A deformation @xmath of @xmath with the basepoint @xmath is called
formally versal in the class of @xmath -equivariant deformations if the
following holds.

Let @xmath be another @xmath -equivariant deformation of @xmath , and
let @xmath be the basepoint of this deformation.

Denote by @xmath the formal neighborhood of @xmath in @xmath . Denote by
@xmath the restriction of the deformation @xmath to @xmath .

Similarly, let @xmath be the formal neighborhood of @xmath in @xmath ,
and let @xmath be the restriction of the deformation @xmath to @xmath .

Then fromal versality means that there exists a morphism @xmath such
that the deformation @xmath is the pullback of the deformation @xmath
via this map @xmath .

###### Proposition \thechapter.52.

Let @xmath be a @xmath -variety, let @xmath be a vector space, and let
@xmath be an equivariant deformation. Suppose that the marked point of
this deformation is the origin in @xmath . Suppose that the
Kodaira-Spencer map for this deformation is surjective onto @xmath ,
which is finite dimensional.

Then @xmath is an equivariant formally versal deformation of @xmath .

###### Idea of a proof.

First, one can check that a formally versal deformation exists using [
11 , Theorem 2.11] . The conditions ( @xmath ) and ( @xmath ) are
verified exactly in the same way as they are verified for
non-equivariant deformation, see Section 3.7 of [ 11 ] . One has to use
graded algebras and equivariant maps between them, but the arguments
stay the same. Condition ( @xmath ) is our assumption that @xmath is
finite dimensional. The parameter space (denote it by @xmath ) of a
formally versal deformation we can obtain this way is the spectrum of a
complete Noetherian local algebra. By Cohen structure theorem, @xmath is
a quotient of a formal power series ring over @xmath in finitely many
variables. Note that it is not true in general that @xmath is a finitely
generated @xmath -algebra (i. e. a quotient of a polynomial ring). In
the proof of this proposition, choose and denote by @xmath a set of
variables such that @xmath is a quotient of @xmath , and the maximal
ideal of @xmath is the image of @xmath .

@xmath can be identified with the tangent space of @xmath at the
geometric point (see [ 11 , Definition 2.7] ). Denote by @xmath the
vector space with coordinates @xmath . Then the tangent space of @xmath
at the geometric point becomes a subspace of @xmath . After a linear
change of variables we may suppose that this tangent space is defined by
the equations @xmath . Then @xmath are coordinates on @xmath .

In the proof of this proposition, we denote the dimension of @xmath by
@xmath .

Also, in the proof of this proposition we can suppose without loss of
generality that the Kodaira-Spencer map is an isomorphism (otherwise we
can replace @xmath with a complement to the kernel of the
Kodaira-Spencer map).

Let @xmath be a morphism from the formal neighborhood of zero in @xmath
to @xmath such that @xmath is the pullback via @xmath of the formally
versal equivariant deformation over @xmath . Then @xmath is the
Kodaira-Spencer map.

Choose coordinates @xmath in @xmath . Then @xmath can be written using
@xmath power series in the variables @xmath . Denote these power series
by @xmath so that @xmath . These series do not have constant terms. The
first @xmath of them have nontrivial linear terms, the last @xmath power
series do not have terms of degree less than two.

Since the Kodaira-Spencer map is an isomorphism, without loss of
generality (after a suitable linear change of coordinates in @xmath ) we
may suppose that the linear term in @xmath , where @xmath , is exactly
@xmath . In other words, @xmath for @xmath .

Now, using iterated corrections in higher and higher degrees, we can
find power series @xmath in @xmath (the variables @xmath will not appear
there) such that @xmath . In other words, the map @xmath between the
formal neighborhoods of the marked points is invertible, in other words,
it is an isomorphism. Hence, @xmath is also an equivariant formally
versal deformation. ∎

###### Remark \thechapter.53.

In fact, this proposition holds true if @xmath is smooth, but not
necessarily a vector space. The proof is more complicated in this case.

Therefore, we get the following theorem from Theorem \thechapter .32 ,
Proposition \thechapter .51 , and Proposition \thechapter .52 .

###### Theorem \thechapter.54.

The deformation @xmath of @xmath constructed in Section 17 is formally
versal in the class of @xmath -equivariant deformations.∎