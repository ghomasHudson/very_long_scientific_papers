##### Acknowledgements. The work presented in this thesis could not
have been performed without the help and collaboration of my supervisor,
Robert Crittenden. One of the chapters of this thesis is based on and
expanded from a paper written in collaboration with him. The support of
the Institute of Cosmology and Gravitation, and in particular of Prof.
Roy Maartens, has also been invaluable, as have been discussions with
Kishore Ananda, Chris Clarkson, David Wands, David Parkinson, Marco
Bruni, Konstantinos Dimopoulos, Antony Lewis and others too numerable to
mention. I must also thank my family for their support as writing the
thesis wore on, and the patience and tolerance of my friends,
particularly of Mike, Ricki, Laura, Emma, Chris and Vivian. The largest
thanks go to Kishore, Richard, Mat and Dan, who offered much appreciated
hospitality and sat through innumerable ”discussions” about the thesis
and the state of the world, and to Kathryn, who rarely complained about
the weight of emails and helped my sanity enormously. Thanks to them
all, this was a lot less unpleasant than it might otherwise have been.

\startthesis

## Chapter 1 Introduction

Magnetic fields are observed on many scales in the cosmos, from
planetary scales with coherence lengths of a few thousand kilometres and
strengths of a few Gauss, to galactic scales with coherence lengths on
the order of kiloparsecs and a strength of approximately @xmath . There
are also fields with coherence lengths on the order of megaparsecs that
lie between galaxies and have field strengths lying between nano- and
micro-Gauss; fields larger yet within clusters are also likely to exist,
with field strengths of a comparable size. While fields on supercluster
scales are extraordinarily difficult to detect, there are suggestions
that fields up to the order of micro-Gauss may exist even there. (See
for example [ 1 , 2 , 3 , 4 , 5 , 6 ] for reviews.) It is no great leap
to suggest that larger-scale fields yet may be present and, if so, we
require a means of probing them.

The three chief observational probes for astronomical fields are the
Zeeman effect, synchotron radiation, and the Faraday rotation. The
Zeeman effect, in which the uniform component of the magnetic field
separates molecular energy levels, is typically rather small (of the
order of a few hertz for a micro-Gauss field) and thermal effects can
readily induce a greater splitting than this. For the strong fields
found in many astrophysical situations, the Zeeman effect can be a good
probe; however, for fields on galactic scales and above it is unlikely
to be useful. Synchotron radiation is emitted from electrons spiralling
around magnetic field lines; this allows one to estimate the total
magnetic field transverse to the electron motion. Synchotron emission is
very useful for detections of magnetic fields in external galaxies, but
unfortunately the relative scarcity of free electrons in clusters and
greater scales limits its use to galactic scales. Moreover while
synchotron measurements are useful for determining the transverse field
strength they do not give an estimate of the total field strength and
are also rather model dependent. For larger-scale fields and to
determine a total field strength we resort to employing measures from
Faraday rotation, in which a magnetic field rotates the plane of a
light-beam’s polarisation. A Faraday rotation signal is readily detected
from its strong frequency dependence. Even with the Faraday rotation,
fields on cluster and supercluster scales are notoriously difficult to
calculate with any certainty; estimates range from the nano-Gauss to
micro-Gauss levels.

The origin of these fields remains uncertain; many of the mechanisms
suggested to generate the observed fields require a pre-existing seed
field and are more accurately dubbed “amplification” mechanisms than
generation mechanisms. For our purposes we separate creation and
amplification mechanisms into processes occurring before, during and
after recombination.

Popular post-recombination processes include the dynamo mechanism [ 4 ,
7 , 8 ] and the adiabatic compression of a previously-magnetised cloud [
4 , 9 ] . The dynamo mechanism occurs when a rotating galaxy contains a
pre-existing, small, seed field. The vorticity induced by the galactic
rotation then “winds up” the magnetic field lines, boosting the field
strength on an astrophysical timescale, the extra magnetic energy coming
from rotational kinetic energy. The dynamo mechanism can likely boost a
seed field of the order of @xmath Gauss up to the observed level of
around @xmath Gauss, although this efficiency is still a matter of some
debate (see for example [ 8 ] ). The adiabatic compression of a
previously magnetised cloud is also effective in boosting field
strength; again one may visualise this as a compression of magnetic
field lines, this time through an ever tighter packing rather than a
tighter winding, and the extra magnetic energy comes from gravitational
potential energy. Adiabatic compression is less efficient than is the
dynamo mechanism; estimates are that a seed field of around @xmath Gauss
is necessary to produce the observed fields on a realistic timescale. Of
course, there is little reason to believe that both these processes
cannot be operating simultaneously, with the compression of a rotating,
magnetised cloud.

Neither of these mechanisms generate fields from scratch; we still
require some initial genesis mechanism to explain the observed fields.
This could conceivably occur within clusters and galaxies themselves, by
some battery mechanism for example; [ 6 ] provides some coverage of
traditional approaches (the “Biermann battery” for example) to this
matter and [ 10 , 11 ] are a few modern treatments of magnetic fields
produced in supernova batteries; such astrophysical sources do not here
concern us. Instead we choose to consider the possibility that the seed
fields, or at least a significant component of them, were relics of an
earlier era.

Mechanisms certainly exist to generate this field at reionisation [ 12 ,
13 , 14 ] or at recombination itself [ 15 , 16 ] , and they might also
have been created before recombination or even before nucleosynthesis.
During the reionisation era magnetic fields can be created by the
“shadow” an overdensity casts in the flux of an ionising source. While
outside of the shadow an induced electric field is balanced by the
radiation pressure, within the shadowed area the flux is weaker and the
forces no longer balance; the ionised material is then induced into
motion and the resulting current produces a magnetic field. Such fields
can be as large as @xmath or even @xmath Gauss, and obey a power
spectrum @xmath where @xmath is the spectral index of the overdensities
(assumed to be approximately @xmath in the realm of applicability [ 14 ]
). These fields have coherence lengths on the order of around @xmath .

Fields originating at recombination will be relatively small-scale
(though still large compared to galactic scales) and with strengths
around @xmath Gauss. They are generated by current flows induced between
electrons and ionised hydrogen and helium during recombination by
gravitational perturbations and radiation pressure.

There are many suggested mechanisms that can produce fields before
recombination. One possibility arises from certain inflationary
theories. In general, the density perturbations and gravitational waves
produced during inflation are not conformally invariant, while magnetic
fields are. Generating large-scale fields then depends on breaking the
conformal invariance of the magnetic field, with highly model-dependent
results. Possible generation mechanisms arise relatively naturally
during the electroweak symmetry breaking phase, before or during
inflation itself, or in a preheating stage; see for example [ 4 , 6 , 17
, 18 , 19 , 20 , 21 , 22 ] . Such fields have power spectra ranging from
@xmath to @xmath , or even further tilted to the red. These fields are
often dubbed “acausal” since they are produced during or before
inflation. It can be shown (e.g. [ 23 ] ) that a field produced by a
“causal” mechanism must have an index @xmath . There are also recent
studies into generic second-order phase transitions generating
large-scale fields (e.g., [ 24 , 25 , 26 , 27 ] ); such fields generally
have power spectra with an index @xmath , heavily modified by the
complex physics. Cosmic defects, both those models from GUT theories and
more recent string-inspired models, might also be responsible [ 28 , 29
] ; these fields are generated by vorticity induced by the
self-interaction of a string network.

More recently, attention has been given to the possibility that magnetic
fields might be created continuously in the period between lepton
decoupling and recombination, through the vorticity naturally occurring
at higher order in perturbation theory [ 30 , 31 , 32 , 33 ] . Due to
the nature of their production, such fields are necessarily rather weak
and small-scale, though adequate for sourcing cluster fields; they have
a complicated power spectrum that goes as @xmath for low @xmath before
damping away.

Dolgov [ 34 ] provides a brief overview of many creation mechanisms. It
is also worth commenting that, after production, their nature could
evolve in the very early universe, perhaps as a result of hydromagnetic
turbulence [ 35 ] or the inverse cascade [ 36 , 37 ] .

The exact magnetogenesis model is not our present focus; we are
principally interested in studying the impact a primordial magnetic
field might have on cosmological perturbation theory and, more
specifically, the cosmic microwave background. It is to be hoped that
studying this field will allow constraints on the possible strength of a
primordial magnetic field – or, indeed, determine whether such a field
is incompatible with observations. Research in this area is not new;
studies of magnetised universes of one form or another date back at
least to the 1960s (see for example [ 38 , 39 , 40 ] ). However, in
recent years much study has gone into the development of a theory of
cosmological magnetohydrodynamics.

Limits from nucleosynthesis can be particularly powerful, and applicable
to tangled as well as large-scale magnetic fields [ 4 , 5 , 23 ] . The
direct impact of a magnetic field, through the induced splitting in
electron energy levels and through the energy density it contributes to
the universe can be used to constrain the current field strength to the
order of micro-Gauss. There is also an indirect bound arising from the
gravitational waves generated by a magnetic field; Caprini and Durrer [
23 ] demonstrate that the bounds on acausal fields generated in the
extremely early universe are extraordinarily strong, to the level of
@xmath Gauss for @xmath , and lessening only for strongly red spectra
nearing @xmath . These limits are not entirely uncontested, however ( [
41 , 42 ] ).

The cosmic microwave background (hereafter CMB) provides additional
tools for investigating the properties of large-scale magnetic fields.
Regardless of the time at which they were generated, all fields could be
expected to leave a magnetised Sunyaev-Zel’dovich effect (e.g. [ 43 , 44
] ) and Faraday rotations of the primordial CMB [ 45 , 46 , 41 ] .
Fields present before reionisation will impact on the physics of the era
(e.g. [ 47 ] ), and fields predating recombination will have a direct
impact on the cosmological perturbations producing the primordial CMB [
48 , 49 , 50 , 51 , 52 , 53 , 54 , 55 , 56 , 57 , 58 , 59 , 60 , 61 ] .
It is with the final early-time possibility that this thesis is
concerned.

The field strength of early-time fields is already constrained by limits
from the CMB. By assuming the universe to be of Bianchi type VII, Barrow
et. al. [ 62 ] demonstrated that, assuming the total anisotropy allowed
by the 4-year COBE results [ 63 ] to be due to a magnetic field, the
field strength is constrained to a current value of @xmath Gauss. More
recently, Clarkson et. al. [ 64 ] place weak limits on the strength of
the magnetic field by considering the impact on the CMB in a generic
geometry; assuming a Robertson-Walker form tightens these bounds back to
the order of nano-Gauss. It is worth stressing that these limits are for
a large-scale, directional component to the field active on scales
larger than the Hubble length. Limits for a “tangled” configuration
require a closer study.

Primordial magnetic fields can have a significant impact on the CMB.
While early treatments focused on the dynamics of a Bianchi universe [
40 , 65 ] , more modern treatments [ 48 , 49 , 50 , 51 , 52 , 53 , 54 ,
55 , 56 , 57 , 58 , 59 , 60 , 61 , 66 ] consider either small
perturbations around a large-scale homogeneous field or a tangled field
configuration in which fields are taken to possess no net directionality
above a certain scale, often associated with the cluster scale – that
is, the orientation of the net cluster scale fields is random. Both of
these scenarios source CMB perturbations, directly through the scalar,
vector and tensor stresses, and indirectly by the density and velocity
perturbations they induce in the charged proton-electron fluids. Code
for calculating the vector and tensor anisotropies generated by
primordial magnetic fields was recently added to the publicly-available
Boltzmann code CAMB [ 67 , 59 ] , and that for scalars has been modelled
independently [ 51 , 60 , 61 ] .

Considering the dynamics of the magnetised cosmological plasma,
Brandenburg et. al. [ 35 ] , Tsagas and Barrow [ 68 ] , Jedamzik et. al.
[ 69 ] and Subramanian and Barrow [ 70 ] studied various aspects of
magnetised cosmological perturbation theory and in particular the
damping of magnetosonic and Alfvén waves within the magnetised
cosmological fluid. They independently found that while fast
magnetosonic waves undergo Silk damping in much the same way as standard
acoustic waves, the slow magnetosonic and Alfvén waves are heavily
overdamped and on some scales can survive Silk damping. This not only
yields a power boost for small scales of the CMB but could also have a
strong impact on cluster formation.

Subramanian and Barrow [ 49 , 53 ] make semi-analytical estimates of the
impact of a stochastic tangled magnetic field on the small-scale (
@xmath ) temperature perturbations on the CMB, extending this with
Seshadri to the polarisation [ 54 , 57 ] . They found that the Alfvén
waves generated by a tangled field of size @xmath Gauss can contribute a
signal to the temperature angular power spectrum that begins to dominate
at @xmath . The effect is more pronounced for bluer spectra. Durrer,
Kahniashvili and collaborators (e.g. [ 50 , 52 , 55 ] ) investigate the
impact a tangled magnetic field would have on the large-scale ( @xmath )
CMB for both temperature and polarisation angular power spectra. They
find a similar decrease of signal for low @xmath and that a field is
constrained to be of the order of nano-Gauss if it has a spectral index
@xmath , while a causal field with @xmath is even more tightly
constrained. Numerical codes are naturally the most accurate and
previous findings have been confirmed and enhanced for scalar modes by
Koh and Lee [ 51 ] , Giovannini [ 60 ] and Yamazaki et. al. [ 61 ] , and
for vector and tensor modes by Lewis [ 59 ] .

The studies thus far have been limited to particular configurations of
field statistics and power spectra. Even with the numerical models
studied by Lewis, Koh and Lee and Yamazaki et. al. much reliance for the
primordial field’s power spectrum and statistics is placed on the
results of Mack et. al. [ 55 ] . This limits the study to a power-law
power spectrum; while likely sufficient for fields produced by
inflation, this is unlikely to be accurate for more complex scenarios
such as fields generated from phase transitions or plasma processes.
Large-scale causal fields are restricted to power spectra @xmath ; due
to the power that this concentrates on small scales, such spectra are
unphysical without some additional cutoff or turnover. Moreover the
fields considered have been purely Gaussian and there is little reason
to believe this to be a realistic assumption. Magnetogenesis mechanisms
in the early universe tend to be exceptionally complicated and to merely
assume a resulting Gaussian field is not warranted. Indeed, one of the
few mechanisms for which the statistical nature has been derived is the
second-order production of, for example, Matarrese et. al. [ 31 ] which,
due to its nature, produces @xmath fields with a damped causal power
spectrum.

Moreover, the results in Mack et. al. and the work based on them is
limited to the accuracy of the approximations they employ for the
damping scales, Alfvén velocity and normalisation of the spectral index.
These approximations are again restricted to Gaussian power-law fields.
Despite their efforts there is also still not a fully unified treatment
of magnetic fields in cosmology. While full treatments are provided in
principle in Tsagas [ 71 ] or Tsagas and Maartens [ 72 ] , resulting
naturally from their use of the covariant and gauge-invariant approach
to cosmology, Lewis’ application of this approach to CMB analysis [ 59 ]
neglected the scalar modes. In a more traditional metric-perturbation
approach to cosmology, Mack et. al. [ 55 ] work in a gauge-invariant
formalism and also neglect scalar modes. Koh and Lee [ 51 ] work in a
conformal Newtonian gauge and thus consider only scalars. Giovannini [ 6
] , enhancing the study of Koh and Lee and seeking to fill the gaps in
Lewis’ work, also employs conformal Newtonian gauge.

In this thesis we aim to review and extend the current research in this
area, with a specific aim towards developing techniques by which a field
with a significant tangled component could be constrained by CMB
observations, including contributions from the scalar, vector and tensor
components in a fully unified manner. In chapter 2 we review in detail a
linear-order cosmological perturbation theory of the classical type
pioneered by Lifshitz ( [ 73 , 74 , 75 ] ). We generally restrict
ourselves to synchronous gauge for ease of future integration with the
CMBFast code [ 76 ] . In chapter 3 we introduce the modifications to the
standard theory introduced by a magnetic field. Magnetic fields impact
directly on the geometry through the magnetic energy density and
isotropic pressure, but also through the anisotropic shear they
introduce. Perhaps more importantly, however, the magnetic fields modify
the conservation and Euler equations for the baryons, making them into a
cosmological equivalent of the classical MHD equations. The fields then
source slow magnetosonic waves and Alfvén waves, both of which become
heavily overdamped and can to some measure survive Silk damping [ 70 ] .
In the standard picture vector perturbations rapidly damp away (though
Lewis has demonstrated that in principle a detectable signature might
remain from primordial vector modes sourced by the neutrino anisotropic
stress after neutrino decoupling [ 77 ] ); as with a system of cosmic
defects, however, the magnetic field provides an active source.

It appears increasingly likely from cosmological data such as the CMB
that the dominant source of perturbations in the universe was adiabatic
and Gaussian in nature, consistent with the expectations of an
inflationary universe [ 78 , 79 ] . However, this does not exclude the
possibility that non-linear sources – such as, but certainly not limited
to, our magnetic fields – might also have played a role in generating
perturbations. While their impact on the power spectrum might be small,
they could dominate any non-Gaussianities that we observe. In order to
search for these optimally we need clear predictions for the nature of
the non-Gaussian signals that they would source. In chapter 4 we
investigate in detail the intrinsic statistics of an early-universe
tangled magnetic field. The stress-energy tensor of the magnetic field
is quadratic and so at the very least we expect the energy density of
the field to obey a @xmath distribution. To test this suspicion, we
analyse the intrinsic statistics of Gaussian-random magnetic fields,
concentrating on the two- and three-point correlations between the
scalar, vector and tensor components of the magnetic stresses. We do so
by both generating realisations of Gaussian-random magnetic fields and
through numerically integrating pure analytical results, most of which
are presented here for the first time. While the integrations we present
are reliant upon the fields being Gaussian-random, the code we use to
generate our realisations is easily extended to include any type of
non-Gaussian seed field and any form of power spectrum, not just the
power-law typically considered. One motivating example is a field
continuously sourced in the pre-recombination universe by the mechanism
of, for example, Matarrese et. al. [ 31 ] which, being produced by the
combination of two Gaussian fields, is @xmath in nature and which has a
significantly non-trivial power spectrum. As a first step towards
considering this scenario, we model a Gaussian magnetic field with a
causal power spectrum, exponentially damped on smaller scales.
Unfortunately, the limited dynamic range of our realisations prevents us
from directly modelling the end-result of the Matarrese et. al.
mechanism; however, the field we consider will provide us with clues as
to its nature.

The impact of magnetic fields on the CMB temperature and “gradient”
@xmath -mode polarisation angular power spectra is likely to be
relatively minor on the angular scales most easily resolved; they are
expected to begin to dominate at multipoles of about @xmath , which
remains unprobed by WMAP and unlikely to be detected with such accuracy
for a long time yet, although measurements by the CBI, VSA (see e.g. [
80 ] ), ACBAR [ 81 ] , Boomerang [ 82 ] and CAPMAP [ 83 ] probes are
ever-improving, and the South Pole Telescope [ 84 ] is soon to come
online. Moreover, angular scales this small are likely to be heavily
contaminated by foregrounds that will be extremely hard to remove
without washing away the effects of a magnetic field.

The “rotational” @xmath -mode of the CMB polarisation is relatively
unexcited; in the standard model @xmath -modes are generated by
gravitational waves produced by inflationary perturbations and by weak
lensing, both with characteristic spectra. In general only vector and
tensor perturbations excite the @xmath -mode. Since a magnetic field
produces both of these we have, in principle, a clean probe for its
properties. Moreover, a cosmological magnetic field would naturally
induce Faraday rotation in the CMB polarisation [ 85 , 46 , 45 , 41 ] ,
which would convert an amount of the @xmath -modes generated by all
three classes of perturbations into the @xmath -modes, in a
characteristically frequency-dependant manner. In reality,
unfortunately, a strong angular power spectrum for the @xmath -mode is a
long way off.

In chapter 5 we finally consider the observational impact of magnetic
fields, briefly reviewing the known constraints from nucleosynthesis [ 5
, 23 ] before turning in detail to the CMB temperature angular power
spectrum. Exploiting the simple time-evolution of a magnetic field we
can tackle the issue from a slightly different angle to previous
authors, transferring the intrinsic magnetic statistics directly onto
the CMB by integrating them across magnetised transfer functions. This
approach requires pre-computed power- or bi-spectra, which could
naturally be either purely analytic or resulting from the realisations
we generated in chapter 4 . The transfer functions are derived entirely
independently. The advantages of this approach are manifold. At the
two-point level one might argue that the approach of Subramanian and
Barrow [ 53 ] , Mack et. al. [ 55 ] , Lewis [ 59 ] and Yamazaki et. al.
[ 61 , 66 ] is sufficient and a new formalism entirely unnecessary.
However, the techniques employed by these authors are restricted, both
in the nature of the fields that it can model – only purely Gaussian,
power-law fields – and in the heavy reliance on successive approximate
solutions to a range of integrals. With our numerical approach, we are
not at all restricted in this manner and can consider a far wider range
of magnetic fields and their imprint on the CMB angular power spectrum.
We consider the large-scale approximations to the magnetised transfer
functions, which then enables us to demonstrate the validity of this
approach. The extensibility is demonstrated using the damped causal
field we considered in chapter 4 .

Magnetic impacts on the two-point CMB spectra are likely to be
subdominant to other sources until very small scales. An alternative
probe comes from the non-Gaussianity that any magnetic field – including
a Gaussian field – will impart onto the CMB. From a large-scale magnetic
field, this non-Gaussianity would be expected to show at relatively low
multipoles. Given the quality of the current data at low mutipoles
generated by the WMAP satellite and, in the near future, the Planck
satellite, this would seem a sensible approach. Unfortunately, the
analytical and semi-analytical approaches employed by, for example, Mack
et. al. and Subramanian and Barrow are unsuited to predictions for the
CMB non-Gaussianity; the expressions become rapidly unwieldy, albeit
probably not insoluble. We outline briefly how our approach can instead
be employed to realistically predict the CMB angular bispectra arising
from the various three-point correlations we derived in chapter 4 . This
approach shares its advantages – and disadvantages – with the two-point
case. It is severely compromised by the limited dynamic range, more so
even than the two-point correlations, due to the strong mode-selection
involved. Accurate intrinsic bispectra thus take a very long time and a
large amount of memory to produce since we must use the largest possible
dynamic range and average many different realisations. However, using
such bispectra makes this approach highly extensible and the method we
outline is entirely general. We conclude by outlining the procedure by
which we will generate CMB angular bispectra using transfer functions
generated from the CMBFast Boltzmann code [ 86 ] .

## Chapter 2 Standard Linearised FLRW Cosmology

In this chapter we present a review, independently derived but, for the
large part, recreating previously-known results, of the theory of linear
cosmological perturbations of a Friedmann-Lemaître-Robertson-Walker
universe. Sections believed original to this thesis include the
discussions of vector perturbations.

### 2.1 The FLRW Geometry

##### Cosmological Spacetimes and the Robertson-Walker Metric

The Copernican principle states that the Earth is in no special part of
the universe. If one assumes that the universe is isotropic about the
Earth then applying the Copernican principle will immediately lead one
to conclude that the universe is homogeneous and isotropic throughout.
Perhaps the strongest evidence for an isotropic universe is the cosmic
microwave background (CMB), which to a startling accuracy is observed to
possess the same temperature (about @xmath ) in all directions [ 78 , 63
] . Applying the Copernican principle leads us to conclude that the
universe is isotropic around every point – i.e. , homogeneous. We then
expect the metric modelling the present universe to be
maximally-symmetric – that is, possessing the greatest possible numbers
of isometries or, equivalently, possessing the maximum number of Killing
vectors. Clearly this cannot be literally true, or we would not
ourselves exist. However, if we consider the universe on a large enough
scale that the clumping of matter is entirely negligible, then it
becomes a very reasonable assumption. We should note that these are
indeed merely assumptions, and one can work with mildly anisotropic
cosmologies and reproduce the observed microwave background (e.g. [ 87 ]
) to within experimental error. Moreover, critics might point out that
the direct observation of the CMB only makes a statement about the
isotropy of the universe about the Earth; the homogeneous and isotropic
universe follows only by declaring that isotropy complete and enforcing
the Copernican principle. Non-homogeneous cosmologies are in general
rather intractable, though there has been renewed work on the
spherically-symmetric Lemaître-Tolman-Bondi metrics since some authors
suggest such models may exhibit late-time acceleration without the need
for dark energy (see [ 88 , 89 , 90 ] for three recent, conflicting,
viewpoints). We assume the Copernican principle to hold.

In appendix A we derive the Robertson-Walker metric by foliating
spacetime with maximally-symmetric three-spaces, and progress to a
discussion of gauge issues in cosmology. Here we content ourselves with
presenting our metric ansatz, in a flat synchronous gauge. We employ the
line element

  -- -------- -- -------
     @xmath      (2.1)
  -- -------- -- -------

where @xmath and @xmath is implicitly of order a small parameter @xmath
and includes contributions from components transforming under
co-ordinate maps as scalar, vector and tensor parts. The separation will
be performed in Fourier space. Synchronous gauge provides us with an
unambiguous and familiar time co-ordinate @xmath and, as long as we take
care when specifying initial conditions to remove the spurious gauge
modes [ 91 ] , is no worse than any other gauge choice for physical
interpretation of results. Note that an observer measures the proper
time and co-ordinates, @xmath and @xmath . We will generally employ the
conformal time @xmath , where @xmath is the scale factor of the FLRW
geometry, swapping to co-ordinate time @xmath only in certain cases. We
use the notation @xmath and @xmath for differentiation of an object
@xmath with respect to the conformal and co-ordinate times respectively,
and employ an overbar @xmath to denote background quantities and @xmath
to denote perturbed quantities.

##### Basic Definitions

Consider a real-space covariant vector @xmath , the 4-velocity, for
example. Then the contravariant form will be

  -- -------- --
     @xmath   
  -- -------- --

and so one can define the comoving covariant vector @xmath and its
contravariant counterpart

  -- -------- --
     @xmath   
  -- -------- --

In particular, this implies that

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is a comoving co-ordinate.

Similarly, for a tensor @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

leads to the definitions of the comoving tensors @xmath and @xmath as

  -- -------- --
     @xmath   
  -- -------- --

The mixed form @xmath is then simply

  -- -------- --
     @xmath   
  -- -------- --

The inverse metric [ 92 ] is

  -- -------- --
     @xmath   
  -- -------- --

which takes this form to retain the normality of the metric; the metric
perturbation is a comoving tensor

  -- -------- --
     @xmath   
  -- -------- --

and so

  -- -------- --
     @xmath   
  -- -------- --

The scale factor @xmath is normalised today to unity, i.e. @xmath . This
implies that comoving quantities become physical at the current epoch.
The conformal time @xmath is then closely related to the Hubble
distance. ¹ ¹ 1 The equations derived in § 2.2.3 imply that if we assume
the current acceleration to have started only recently, we can
approximate the current conformal time as @xmath where @xmath is the
current Hubble parameter.

##### Affine Connections and the Ricci Tensor

The affine connections in a metric space without torsion are the
Christoffel symbols,

  -- -------- --
     @xmath   
  -- -------- --

For a perturbed Robertson-Walker metric these are

  -- -------- -- -------
     @xmath      (2.2)
  -- -------- -- -------

The Ricci tensor is then

  -- -------- --
     @xmath   
  -- -------- --

Straightforward calculations then show that

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.3)
     @xmath   @xmath   @xmath      
                       @xmath      
  -- -------- -------- -------- -- -------

Here @xmath is the trace of the perturbation and we have raised one of
the indices.

The Ricci scalar for this perturbed universe is then

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (2.4)
  -- -------- -------- -------- -- -------

This is in conformal time; were one to transfer back into co-ordinate
time, one would find that the background term becomes the more familiar
@xmath .

##### The Einstein Equations

If one assumes only that the universe is composed of various fluids –
effective (photons and neutrinos, for example) and actual (baryons, CDM
etc.), as well as other interacting or non-interacting components such
as electromagnetic fields or networks of cosmic defects – then one may
express the matter content of the universe in a total stress-energy
tensor @xmath .

For intuitive purposes, this tensor can be defined in Minkowski space by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the mass/energy density of the matter component, @xmath
is the energy flux vector (which with @xmath is equivalent to the
momentum density), and @xmath is the momentum flux density (see [ 93 ]
). A more rigorous definition of a general stress-energy tensor is
presented later. The momentum flux density can be seperated into its
trace and traceless parts by

  -- -------- -- -------
     @xmath      (2.5)
  -- -------- -- -------

where @xmath is the isotropic pressure and @xmath embodies the
anisotropic stress and contains a traceless scalar degree of freedom
along with two vector and two tensor degrees of freedom. This vanishes
for a perfect fluid, for which we have

  -- -------- -- -------
     @xmath      (2.6)
  -- -------- -- -------

The Einstein equations can be written

  -- -------- -- -------
     @xmath      (2.7)
  -- -------- -- -------

Contracting these equations allows one to eliminate the Ricci scalar and
express the Einstein equations in an alternative “trace-reversed” form,

  -- -------- -- -------
     @xmath      (2.8)
  -- -------- -- -------

which emphasises the vacuum equations @xmath . There is obviously great
redundancy amongst these equations. At zeroth order, the @xmath equation
generates the Friedmann constraint equation and the @xmath equation
generates the Raychaudhuri evolution equation. At first order, the
@xmath , @xmath and @xmath generate constraint equations while the
@xmath , @xmath and @xmath equations produce evolution equations. We
shall select as evolution equations the @xmath for the scalar trace and
the @xmath for the other components, and as constraints we shall select
@xmath for the scalar trace and @xmath for the other components.

Employing the Ricci tensor and scalar ( 2.1 – 2.4 ) found above, one
readily finds that in the background we have

  -- -------- -- -------- -- --------
     @xmath      @xmath      (2.9)
     @xmath      @xmath      (2.10)
  -- -------- -- -------- -- --------

where @xmath is the Hubble factor in conformal time, @xmath being the
observable Hubble parameter. The physical meaning of these equations can
be rapidly illustrated with the perfect fluid form of the stress-energy
tensor, for which we have

  -- -------- -- --------
     @xmath      (2.11)
  -- -------- -- --------

from which we may identify the cosmological constant as an effective
perfect fluid with stress energy

  -- -------- --
     @xmath   
  -- -------- --

or, to phrase it differently, an unperturbed perfect fluid of density
@xmath and pressure @xmath . Using the typical definition of a
cosmological equation of state @xmath we then have @xmath .

The Friedmann equation can also be written as

  -- -------- -- --------
     @xmath      (2.12)
  -- -------- -- --------

where @xmath is the ratio between the universe’s total energy density
and the critical density. For an individual species, then,

  -- -------- -- --------
     @xmath      (2.13)
  -- -------- -- --------

These are normally presented as observed during the current era and the
Friedmann equation can then be written

  -- -------- -- --------
     @xmath      (2.14)
  -- -------- -- --------

with the scale-factor embodying the time-evolution. It is seen later
that for radiation @xmath , while for matter @xmath and for a
cosmological constant @xmath . Had we included a curvature term in our
system then the effective energy density would evolve with @xmath .

The linearised equations are

  -- -------- -- -------- --
     @xmath      @xmath   
     @xmath      @xmath   
                 @xmath   
     @xmath      @xmath   
     @xmath      @xmath   
  -- -------- -- -------- --

These equations are entirely generic; henceforth, however, the matter
sources we shall consider will be baryons, cold dark matter, photons,
(massless) neutrinos, and in chapter 3 an electromagnetic field. We
could also add, for example, scalar fields and networks of cosmic
defects. The explicit forms of the stress-energy tensor for the
differing fluids employed in standard cosmology shall be considered in
turn.

##### Fourier Space and the Scalar-Vector-Tensor Split

The system of equations presented above are most easily analysed by
transferring them to Fourier space and separating the components into
parts transforming as scalars, vectors and tensors under co-ordinate
transformations. We work with the Fourier convention

  -- -------- --
     @xmath   
  -- -------- --

that is,

  -- -------- --
     @xmath   
  -- -------- --

for a scalar, vector or tensor quantity @xmath . When necessary,
co-ordinate axes will be aligned such that @xmath .

A vector quantity in this space can be separated into a scalar and a
solenoidal part as

  -- -------- -- --------
     @xmath      (2.15)
  -- -------- -- --------

with @xmath a comoving wavevector, which implies that

  -- -------- -- --------
     @xmath      (2.16)
  -- -------- -- --------

where @xmath is a projection operator projecting a quantity onto a
hypersurface defined by the Fourier modes. Likewise, a tensor quantity
can be split into

  -- -------- -- --------
     @xmath      (2.17)
  -- -------- -- --------

with the various conditions

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the trace of @xmath , @xmath is the traceless scalar
part of @xmath , @xmath is the (divergenceless) vector part of @xmath
and @xmath is the (traceless, divergenceless) tensor part.

It is straightforward to demonstrate that the different components of
@xmath are then recovered by applying various projection operators ² ² 2
Technically only @xmath is a true projection operator since it obeys
@xmath , @xmath . Any sensible definition of a trace for the other
projection operators vanishes; neither are they idempotent. However, we
shall habitually refer to them all as projections. to the full tensor:

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.18)
     @xmath   @xmath   @xmath      
              @xmath   @xmath      
  -- -------- -------- -------- -- --------

It is occasionally useful to work with fully symmetrised forms of the
vector and tensor projection operators; when this is so we shall employ
@xmath as the vector projector to operate on @xmath and @xmath for the
tensors, where the curved brackets denote symmetrisation on the enclosed
indices @xmath . We shall do this, for example, when we come to consider
the statistics of the magnetic field.

Separating the metric perturbation, one can see that @xmath will carry
information about the gravitational waves while @xmath will carry
information about vorticity.

We can now make identifications between our variables, separated using
the above prescription, and the @xmath employed in appendix A and by
Mukhanov, Feldman and Brandenberger [ 94 ] . Since we are working in
synchronous gauge the lapse and shift functions vanish, implying @xmath
; the spatial perturbation is, in the two notations,

  -- -------- --
     @xmath   
  -- -------- --

which in Fourier space is

  -- -------- --
     @xmath   
  -- -------- --

and so

  -- -------- -- --------
     @xmath      (2.19)
  -- -------- -- --------

or

  -- -------- -- --------
     @xmath      (2.20)
  -- -------- -- --------

In this representation of the gauge, then, the gauge-invariant Bardeen
variables ( A.37 ) are

  -- -------- -- --------
     @xmath      (2.21)
  -- -------- -- --------

This is little more physically lucid than in the alternative
prescription and in this chapter we shall not employ the Bardeen
variables though obviously we could rewrite the scalar and vector
components of the Einstein equations below as equations for them. We
return to the vector Bardeen variable in chapter 5 .

Transferring the Einstein equations into Fourier space and separating
them across their scalar, vector and tensor components (noting that the
@xmath equation contains a redundant scalar trace term, which we remove)
leads us to

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.22)
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

with @xmath , @xmath and @xmath defined as above and @xmath separated as

  -- -------- --
     @xmath   
  -- -------- --

Here all the variables are now in Fourier space and are functions of
conformal time @xmath only.

We can then see that, in the absence of any source, the vector
perturbations will damp away rapidly. The tensor evolution equation is a
damped wave equation and in the absence of tensor sources it will
generate damped plane waves. Although vector perturbations are neglected
in standard models, they must be considered in models containing active
sources – models with networks of cosmic defects or magnetic fields, for
example. Inflation does, however, generate an amount of power in
gravitational waves and so tensor modes are taken into account in the
most accurate pictures. It is, however, a good approximation to consider
only scalar perturbations.

When these equations are studied for the separate components, it becomes
necessary to discuss the bases we are working in for the vectors and the
tensors. These bases are introduced in section § 2.3.2 .

We now turn to the standard components of the matter/energy content:
cold dark matter (§ 2.2.2 ), the photons (§ 2.3.2 ), the massless
neutrinos (§ 2.3.5 ) and the baryons (§ 2.4 ). We also consider, for
brevity as background sources only, scalar field matter (§ 2.5 ) which
can drive both inflationary and late-time accelerating phases. The
electromagnetic field is discussed in chapter 3 .

### 2.2 Fluid Matter

#### 2.2.1 Generic Stress-Energy Tensor

Cold dark matter and baryons are perhaps the simplest matter that can be
placed into the Einstein equations, especially if one neglects all
viscous effects. Here we shall quote both shear and bulk viscosities and
also heat conduction and their impacts on the stress-energy tensor; this
will prove useful, for instance, when modelling photon viscosities.
However when we consider the standard cosmological sources of cold dark
matter (CDM) and baryons we shall neglect the imperfect elements.

To model imperfect fluids, seperate the stress-energy and particle
current tensors into an ideal and a non-ideal part,

  -- -------- -------- -------- -- --------
     @xmath   @xmath               (2.23)
     @xmath   @xmath   @xmath      (2.24)
  -- -------- -------- -------- -- --------

where @xmath is the fluid’s mass-energy density, @xmath its pressure,
@xmath its number density and @xmath its 4-velocity. This decomposition
introduces an ambiguity into the definitions of @xmath , @xmath , @xmath
and @xmath , so define

  -- -------- --
     @xmath   
  -- -------- --

in a comoving frame where @xmath , and @xmath is the total energy
density in this frame. @xmath is defined as the “intrinsic” pressure
when the non-ideal components vanish. The 4-velocity may be taken, as do
Lifshitz and Pitaevskii [ 93 ] , to be the velocity of energy transfer (
@xmath in a comoving frame), or it can be taken, as do Eckart [ 95 ] and
Weinberg [ 96 ] , to be the velocity of particle transport ( @xmath in a
comoving frame). We take Eckart and Weinberg’s definition.

These definitions imply that @xmath , @xmath and @xmath in a comoving
frame. Thus one can see that, in a comoving frame, the dissipative
effects are held entirely within the stress-energy tensor; in a general
frame,

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      (2.25)
     @xmath   @xmath   @xmath      (2.26)
  -- -------- -------- -------- -- --------

An arbitrary stress-energy can then be found by finding the most general
@xmath allowed by both this equation and by the second law of
thermodynamics; for a demonstration see Weinberg [ 96 ] .

The resulting stress-energy tensor of a generic barotropic fluid in an
arbitrary frame is

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
              @xmath   @xmath   
  -- -------- -------- -------- --

with a supplementary thermodynamic equation of state usually taken in
cosmology to be of the barotropic and isentropic form @xmath . Here the
4-velocity is

  -- -------- -- --------
     @xmath      (2.27)
  -- -------- -- --------

the projection tensor onto a hypersurface orthogonal to @xmath is

  -- -------- --
     @xmath   
  -- -------- --

the heat-flow vector is defined as

  -- -------- -- --------
     @xmath      (2.28)
  -- -------- -- --------

the shear tensor is defined as

  -- -------- -- --------
     @xmath      (2.29)
  -- -------- -- --------

and @xmath is the temperature of the fluid. @xmath , @xmath and @xmath
are the (positive) coefficients of heat-flow, shear viscosity and bulk
viscosity respectively ³ ³ 3 Note the change of notation from that usual
in the fluid literature, as we are reserving @xmath for the conformal
time rather than the shear viscosity. . For non-relativistic “dust” –
i.e. non-relativistic, pressureless fluids, one then takes @xmath . Both
the baryons and the cold dark matter are taken to be non-relativistic
since, even in the presence of a primordial magnetic field, the baryons
remain highly non-relativistic; see [ 62 , 70 , 64 , 97 ] .

This decomposition of the fluid stress-energy tensor is useful since it
acts as a direct relativistic generalisation of the familiar components
of the fluid stress-energy (see for example Landau and Lifshitz [ 93 ]
and Weinberg [ 96 ] ). An alternative is to decompose it according to
the four-velocity of an observer; this is, for example, employed in the
gauge-invariant and covariant approach to cosmology [ 98 , 99 , 100 ] ,
developed from covariant fluid mechanics [ 101 , 102 ] , wherein
spacetime is decomposed into a @xmath split with the observer’s
four-velocity acting as a time parameter, and all tensorial objects are
projected parallel to the velocity and onto a hypersurface perpendicular
to it. In this formalism, the stress-energy tensor splits into @xmath
with @xmath the momentum flux and @xmath the anisotropic stress. This
approach has many advantages but for the purposes of this thesis we
shall retain the older, more familiar formalism. It should be noted,
however, that the gauge-invariant and covariant approach has been used
with great success in the field of magnetised cosmologies; see for
example [ 68 , 71 , 72 , 87 , 103 ] . The great benefit of such an
approach is that one formulates first the entirely non-linear equations
and then curtails these to an approximation based around a
Robertson-Walker background, as opposed to the metric-based approach we
are employing wherein we set a (fictional) background metric and perturb
up to a more realistic approximation. This then lets us draw qualitative
conclusions about the non-linear behaviour of a system; we can also find
a clear physical interpretation of each term.

The two main thermodynamic properties of a fluid that we shall be
concerned with are the equation of state and the speed of sound, defined
by

  -- -------- -- --------
     @xmath      (2.30)
  -- -------- -- --------

and its temperature. We assume that the fluid is isentropic and
barotropic, that is that @xmath . The perfect fluid stress-energy tensor
then has the components

  -- -------- -- --------
     @xmath      (2.31)
  -- -------- -- --------

We have not imposed any restrictions on @xmath , which is implicitly a
function of space and time. To retain homogeneity, @xmath and so we
neglect any second-order combinations of @xmath and the metric
perturbations. It is worth emphasising, however, that we have heavily
restricted the physics of the fluid species we can consider; a more
general fluid equation of state could involve terms @xmath with @xmath
the entropy of the fluid, and a truly realistic equation of state would
be of the form @xmath derived from the micro-physics.

Expressing the temperature of the imperfect fluid as a background
homogeneous component and a perturbation, ⁴ ⁴ 4 While in this section we
rigorously employ this notation, we shall in the future omit the
overline on the background temperature where the situation seems
unambiguous.

  -- -------- --
     @xmath   
  -- -------- --

and assuming that the viscosities can be treated as quantities of zeroth
order in @xmath , we can then find that, as one would expect, the energy
flux is modified by both the heat conduction and also a drag from the
bulk viscosity:

  -- -------- -- --------
     @xmath      (2.32)
  -- -------- -- --------

while the stresses acquire contributions from the two viscosities,

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.33)
  -- -------- -------- -------- -- --------

where we have scaled the coefficients of heat conductivity and bulk and
shear viscosity by @xmath and similar. Note that, as one should expect
given our background, the heat conduction and shear viscosity are purely
first-order in @xmath . Were they to impact on the background they would
impose a directionality on the universe by, for example, a net heat flow
or a net momentum. If we assume that a particle species is collisionless
then we can derive the temperature change from the first law of
thermodynamics;

  -- -------- -- --------
     @xmath      (2.34)
  -- -------- -- --------

where @xmath is the change in heat and @xmath the pressure. We can
approximate the pressure as @xmath where @xmath is the particle number
density ( @xmath ), the density as @xmath , @xmath being the particle
mass, and for a collisionless fluid set @xmath . With these
substitutions we quickly see that

  -- -------- -- --------
     @xmath      (2.35)
  -- -------- -- --------

and so

  -- -------- -- --------
     @xmath      (2.36)
  -- -------- -- --------

The background isotropic stress is, in full,

  -- -------- -- --------
     @xmath      (2.37)
  -- -------- -- --------

and so we see that, insofar as the background dynamics are concerned,
the presence of a bulk viscosity serves to reduce the pressure of the
universe.

For simplicity, we now assume that any fluids in the universe are
perfect and derive their dynamics. Non-ideal fluids are considered in
appendix B .

##### Real-Space Dynamics

The stress-energy conservation laws for the ideal part of this fluid are
given by

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the summed stress-energy tensor of any interacting
species (for example, the electromagnetic field will contribute an
interaction term to the baryon fluid) and @xmath is a collisional term
providing a source or sink for stress-energy, a transfer of momentum
between baryons and photons coupled by Thomson scattering, for example.
For clarity we shall always present the contributions to the continuity
equations as @xmath . The interaction and non-ideal contributions add
linearly to the results of this section.

Evaluating the ideal fluid contribution, neglecting terms second order
in @xmath or @xmath but without yet linearising thermodynamic properties
yields

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      (2.38)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

Linearising the pressure will in general give

  -- -------- --
     @xmath   
  -- -------- --

and so for an isentropic fluid

  -- -------- -- --------
     @xmath      (2.39)
  -- -------- -- --------

where we have linearised the density with a dimensionless perturbation
@xmath with a spatial average density @xmath – that is, @xmath .

It is straightforward to now show that

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.40)
  -- -------- -------- -------- -- --------

for the background dynamics, and

  -- -------- -------- -------- -- --------
              @xmath   @xmath      (2.41)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

##### Fourier space

Transferring into Fourier space and separating across the scalar, vector
and tensor components is generally straightforward. Denoting the spatial
trace of a tensor @xmath as @xmath , we quickly see that, for the ideal
sector of the stress-energy in the background,

  -- -------- --
     @xmath   
  -- -------- --

and in the foreground,

  -- -------- --
     @xmath   
  -- -------- --

We separate across the scalar, vector and tensor parts to get

  -- -------- --
     @xmath   
  -- -------- --

in the background and

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

The background matter conservation equation is

  -- -------- -- --------
     @xmath      (2.42)
  -- -------- -- --------

At linear order, the ideal components are

  -- -------- -------- -------- -- --------
              @xmath   @xmath      (2.43)
     @xmath   @xmath   @xmath      (2.44)
     @xmath   @xmath   @xmath      (2.45)
  -- -------- -------- -------- -- --------

#### 2.2.2 Cold Dark Matter

Cold dark matter (CDM) is defined as a fluid that interacts with other
species purely gravitationally, via the Einstein equations. Governing
this fluid, in addition to the Einstein equations, will be the CDM
specialisation of the conservation laws ( 2.2.1 , 2.41 ). “Cold” refers
to the extreme non-relativistic nature of the dark matter; one assumes
that it has a vanishing equation of state and speed of sound. Moreover,
since CDM interacts only gravitationally, it may be used to define the
synchronous frame of reference; hence we set @xmath identically.

CDM then obviously has a background stress-energy tensor

  -- -------- -- --------
     @xmath      (2.46)
  -- -------- -- --------

which contributes only an average density to the dynamics, and

  -- -------- -- --------
     @xmath      (2.47)
  -- -------- -- --------

in the foreground, with the CDM fluctuations providing potential wells
that will seed the formation of large-scale baryonic structure. The
stress-energy conservation equations become

  -- -------- -- --------
     @xmath      (2.48)
  -- -------- -- --------

In the simplest model there are no viscous effects that can be
associated with cold dark matter; if there were, it would by definition
not remain “cold”. While naturally it would not take a particular leap
of intuition to envisage a bulk viscous material acting as CDM it is
standard to instead reduce the fluid to its very barest fundamentals.

#### 2.2.3 Single-Fluid Universes

##### An Ideal Fluid Universe

Consider a universe dominated by some generic perfect fluid with
(constant) equation of state @xmath and speed of sound @xmath ; this
universe then evolves according to the (redundant) set of equations

  -- -------- -- --------
     @xmath      (2.49)
  -- -------- -- --------

We differentiate the Friedmann equation to obtain an expression for
@xmath and substitute this back into the conservation equation, whence

  -- -------- --
     @xmath   
  -- -------- --

This has the trivial solution @xmath , corresponding to an empty
universe, and an ordinary differential equation for @xmath which we
quickly solve for both the Hubble parameter and the scale factor to find

  -- -------- -- --------
     @xmath      (2.50)
  -- -------- -- --------

The background density is best found by direct integration of the
continuity equation, whence

  -- -------- -- --------
     @xmath      (2.51)
  -- -------- -- --------

We can then consider special cases of the equation of state:

-   @xmath : A purely radiative or ultra-relativistic fluid has this
    equation of state, as demonstrated in the next section. With @xmath
    we see that

      -- -------- -- --------
         @xmath      (2.52)
      -- -------- -- --------

    and so a radiative universe does not accelerate with respect to the
    conformal time, and the scale factor grows linearly with @xmath .
    The background density of the radiation fluid decays as @xmath ,
    which can be interpreted as a stretching due to the volume expansion
    of the universe plus a stretching due to red-shifting.

-   @xmath : A fluid with an effectively vanishing pressure is labelled
    “dust”; due to the extreme non-relativistic nature of their bulk
    distribution, baryons are assumed to be dust. Cold dark matter is
    also taken to be dusty. A dust-dominated universe evolves as

      -- -------- -- --------
         @xmath      (2.53)
      -- -------- -- --------

    The background density of dust evolves, as one might expect, with
    @xmath which is merely the volume expansion of the universe.

-   @xmath : A fluid with such an equation of state causes (artificial)
    singularities to appear in the expressions for the Hubble and
    acceleration parameters. We will consider the importance of this
    type of fluid shortly.

-   @xmath : As we saw earlier, a fluid with this equation of state
    behaves as a cosmological constant. The formalism above breaks down
    for a cosmological constant and we will consider it shortly.

In the light of the observations of distant type-Ia supernovae [ 104 ]
implying the recent onset of an accelerating epoch, we might also ask
when the universe appears to undergo an accelerating expansion;
demanding that @xmath implies that the universe will expand for all
fluids with @xmath . Thus all fluids from the critical radiative through
non-relativistic and into negative pressure accelerate the universal
expansion with respect to conformal time. This is not, however, the
physical acceleration observed by the astronomers as this is with
respect to the conformal rather than proper time.

If we convert our system to co-ordinate time @xmath , we can rewrite the
Hubble and Raychaudhuri equations as

  -- -------- -- --------
     @xmath      (2.54)
  -- -------- -- --------

with the matter continuity equation unchanged in form. We can
immediately state from the Raychaudhuri equation that the universe will
undergo accelerated expansion with respect to the observed co-ordinate
time if @xmath . Should there be a significant amount of a fluid with a
lower equation of state than this then the universe will ultimately
enter a period of never-ending accelerated expansion.

If we repeat our analysis for co-ordinate time, with @xmath again
denoting the observed Hubble parameter and @xmath the derivative of the
scale factor with respect to time, we find that

  -- -------- -- --------
     @xmath      (2.55)
  -- -------- -- --------

-   @xmath : For radiation,

      -- -------- -- --------
         @xmath      (2.56)
      -- -------- -- --------

    and so the universe is manifestly undergoing deceleration during a
    radiation-dominated era.

-   @xmath : For dust,

      -- -------- -- --------
         @xmath      (2.57)
      -- -------- -- --------

-   @xmath : Here

      -- -------- -- --------
         @xmath      (2.58)
      -- -------- -- --------

    and any fluid with a more negative equation of state will undergo an
    accelerating expansion. According to this formalism the Hubble
    parameter will go singular for a cosmological constant and negative
    for a fluid with @xmath .

##### de Sitter Spaces

The case @xmath cannot be analysed in the above way due to the vanishing
of @xmath . Instead we turn back to the Hubble equation for a universe
dominated by the constant term; in conformal time this is

  -- -------- -- --------
     @xmath      (2.59)
  -- -------- -- --------

which has the unedifying solution

  -- -------- -- --------
     @xmath      (2.60)
  -- -------- -- --------

where @xmath is the scale factor at some conformal time @xmath . For
@xmath this is called de Sitter space, and for @xmath it is anti-de
Sitter space. This is not a very useful form for physical
interpretation, and so we return again to co-ordinate time, wherein

  -- -------- -- --------
     @xmath      (2.61)
  -- -------- -- --------

with the more lucid solution

  -- -------- -- --------
     @xmath      (2.62)
  -- -------- -- --------

de Sitter spaces are thus exponentially expanding or contracting
spacetimes. Fluids with equations of state nearing @xmath are quasi-de
Sitter spacetimes; inflationary and quintessential models generate
quasi-de Sitter spaces from universes dominated by scalar fields of some
sort. Any inflating model, not necessarily of scalar fields, is
characterised phenomenologically with @xmath , and this can be found in
the recent universe from observations of distant supernovae, as well as
from the microwave background (wherein it is tangled in various
degeneracies). Recently it was determined from large-scale structure
with the observation of the baryon oscillations in the galactic
distribution. The current equation of state of the inflating component
of the universe – whatever that may turn out to be – is entirely
consistent with a cosmological constant, as tested by groups analysing
the WMAP+Supernovae datasets [ 78 , 104 ] and recent detections of the
baryon oscillations in the large-scale galactic structure [ 105 , 106 ,
107 ] .

### 2.3 Boltzmann Fluids

Here we will discuss a generic effective fluid governed by a Boltzmann
equation. We then turn to consider in great detail a collisional photon
fluid which exchanges energy-momentum with the baryon fluid, and finally
briefly consider massless neutrinos.

While the approach in this section is our own, the basic material is
well-known and can be drawn from various sources; see in particular Ma
and Bertschinger [ 108 ] and Landriau and Shellard [ 109 ] , along with
Peebles [ 110 , 111 ] , Padmanabhan [ 112 ] , Crittenden [ 113 ] and
Crittenden et. al. [ 114 , 115 ] .

#### 2.3.1 General Boltzmann Fluids

##### The Boltzmann Equation and Stress-Energy Tensors

Let us work initially in a Minkowski spacetime. Liouville’s theorem
states that if a system is entirely satisfied by a Lagrangian
formulation with co-ordinates @xmath and their conjugate momenta @xmath
, then the distribution function @xmath defined by

  -- -------- -- --------
     @xmath      (2.63)
  -- -------- -- --------

where @xmath is the number of particles in a volume element does not
change in transport – i.e. , @xmath . If one takes the time derivative
and includes a collisional term acting as a source or sink, the result
is Boltzmann’s equation,

  -- -------- -- --------
     @xmath      (2.64)
  -- -------- -- --------

for some external 3-potential @xmath and some collisional term @xmath .
It is important to note that, since this arises in a Lagrangian system,
@xmath are variables canonical to @xmath .

Given that the mass (or number), momentum and energy of particles are
conserved in collisional processes, we may state that

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the mass-energy of the particle concerned.

Now, it is clear that the number density of the distribution function is
given at an event @xmath by

  -- -------- --
     @xmath   
  -- -------- --

and so we immediately see that

  -- -------- -- --------
     @xmath      (2.65)
  -- -------- -- --------

It should also be clear that the average velocity of the system is given
by

  -- -------- -- --------
     @xmath      (2.66)
  -- -------- -- --------

and that the average of two velocities is

  -- -------- -- --------
     @xmath      (2.67)
  -- -------- -- --------

We can then immediately define the components of the stress-energy
tensor (in Minkowski space) as

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.68)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

Using these one may show that the various conservation conditions imply
mass continuity,

  -- -------- -- --------
     @xmath      (2.69)
  -- -------- -- --------

the Euler equation

  -- -------- -- --------
     @xmath      (2.70)
  -- -------- -- --------

and energy flow,

  -- -- -- --------
           (2.71)
  -- -- -- --------

The stress-energy tensor ( 2.68 ) is valid only in Minkowski space;
however, we may define the momentum four-tensor @xmath and convert it to
a tensorial expression valid in all reference frames. In this way one
may express a covariant stress-energy tensor of a Boltzmann fluid,

  -- -------- -- --------
     @xmath      (2.72)
  -- -------- -- --------

where the @xmath is included to ensure normality of the integral.

In a non-trivial metric, one has to take care to differentiate between
the momentum @xmath appearing in the stress-energy tensor, canonical to
the co-ordinate @xmath , and the proper momenta @xmath measured in a
Riemannian (locally-Minkowski) co-ordinate system ( @xmath , @xmath ).
Clearly the canonical momentum @xmath is gauge-dependant, while the
proper momentum, @xmath is gauge-invariant. To link the two let us find
the transform between the FLRW frame and the comoving Riemannian frame.

Using the tensor transformation law to compare the two conjugate
metrics,

  -- -------- -- --------
     @xmath      (2.73)
  -- -------- -- --------

one finds that

  -- -------- -- --------
     @xmath      (2.74)
  -- -------- -- --------

to the first order in @xmath , and comparing the two metrics,

  -- -------- -- --------
     @xmath      (2.75)
  -- -------- -- --------

gives

  -- -------- -- --------
     @xmath      (2.76)
  -- -------- -- --------

Thus we can write the canonical momentum as

  -- -------- -- --------
     @xmath      (2.77)
  -- -------- -- --------

which satisfy @xmath as one should hope. Taking the inner product of the
four-momentum with itself again gives

  -- -------- --
     @xmath   
  -- -------- --

as expected.

We remove the explicit dependence on @xmath by making a (non-canonical)
transformation to @xmath , @xmath where @xmath is the unit vector in the
direction of the fluid’s momentum – that is, @xmath will be the
mass-energy measured by a comoving FLRW observer and we write the
comoving momentum as an amplitude and a direction. Doing this gives us
the canonical momentum

  -- -------- -- --------
     @xmath      (2.78)
  -- -------- -- --------

and the taking the amplitude of this momentum gives

  -- -------- -- --------
     @xmath      (2.79)
  -- -------- -- --------

Working in polar co-ordinates in momentum space, the volume element is
then

  -- -------- --
     @xmath   
  -- -------- --

and we can rapidly calculate the determinant of the FLRW metric,

  -- -------- --
     @xmath   
  -- -------- --

We now perturb the distribution function around a homogeneous (thermal)
background

  -- -------- --
     @xmath   
  -- -------- --

where @xmath – two, for both photons and neutrinos – is the statistical
weight, @xmath is the temperature of the particles today, and where
fermions take the positive sign and bosons take the negative sign. We
write the expansion as

  -- -------- --
     @xmath   
  -- -------- --

Noting that

  -- -------- --
     @xmath   
  -- -------- --

one can show that the linearised stress-energy components are

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            (2.80)
                       @xmath   @xmath   
     @xmath   @xmath   @xmath            (2.81)
                       @xmath   @xmath   
     @xmath   @xmath   @xmath            (2.82)
                       @xmath   @xmath   
  -- -------- -------- -------- -------- --------

For massless particles, such as the photons and neutrinos we consider,
we can set @xmath in the above equations which reduce to

  -- -------- -- --------
     @xmath      (2.83)
  -- -------- -- --------

in the background, and

  -- -------- -- --------
     @xmath      
     @xmath      (2.84)
     @xmath      (2.85)
  -- -------- -- --------

for the perturbations.

A massless Boltzmann fluid – corresponding to a collection of photons or
massless neutrinos, or to an extremely relativistic fluid – then behaves
to zeroth order as a barotropic perfect fluid with equation of state
@xmath , as we previously stated. While this equation of state also
holds in the foreground, the extant anisotropic stresses ensure that the
effective fluid is far from perfect.

Returning to the Boltzmann equation (for a species not necessarily
massless), we may now write it in terms of our new variables as

  -- -------- -- --------
     @xmath      (2.86)
  -- -------- -- --------

In this expression, the only quantities of unknown order are @xmath and
@xmath . If we consider the geodesic equation

  -- -------- --
     @xmath   
  -- -------- --

where @xmath since we are considering particles along their worldlines,
then the time component will yield

  -- -------- --
     @xmath   
  -- -------- --

which, on substituting for the mass-energy relation, gives

  -- -------- --
     @xmath   
  -- -------- --

and so

  -- -------- -- --------
     @xmath      (2.87)
  -- -------- -- --------

Similarly, considering the space component will give

  -- -------- -- --------
     @xmath      (2.88)
  -- -------- -- --------

We may also write @xmath to zeroth order.

The Boltzmann equation then becomes in Fourier space

  -- -------- --
     @xmath   
  -- -------- --

to the first order. Dividing through by the background distribution
function and setting @xmath we finally have, defining the angle cosine
@xmath ,

  -- -------- -- --------
     @xmath      (2.89)
  -- -------- -- --------

##### Brightness Functions

The “brightness” function of a Boltzmann fluid can be loosely seen as an
analogue of the fractional density perturbation and is defined by

  -- -------- -- --------
     @xmath      (2.90)
  -- -------- -- --------

One can then see that the exact analogue of the fractional density
perturbation,

  -- -------- --
     @xmath   
  -- -------- --

since @xmath has no angular dependence. One can then see the brightness
function as the density contrast within some small solid angle.

It proves useful to expand the brightness function over the Legendre
polynomials with

  -- -------- -- --------
     @xmath      (2.91)
  -- -------- -- --------

The usefulness of this expansion is that the moments of the brightness
function are then recovered by

  -- -------- --
     @xmath   
  -- -------- --

and one sees that the zeroth moment is the density and the first moment
is related to the velocity. Ignoring the possibility of vector and
tensor perturbations for the moment, one can write

  -- -------- -- --------
     @xmath      (2.92)
  -- -------- -- --------

Curtailing the Legendre expansion at the first order will then give a
rough approximation to the brightness function which is occasionally
useful,

  -- -------- -- --------
     @xmath      (2.93)
  -- -------- -- --------

To express the Boltzmann equation in terms of the brightness function it
is easiest to relate the perturbation to the distribution function with
the brightness function. Using the relation between a massless
particle’s density and temperature,

  -- -------- --
     @xmath   
  -- -------- --

one may write the distribution function as the background function with
a temperature perturbation,

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath is a fully arbitrary function this retains the full
generality of the distribution function. Expanding the exponentials
using the binomial expansions one may now see that

  -- -------- --
     @xmath   
  -- -------- --

Using the form of @xmath we may now see that this is identical to

  -- -------- -- --------
     @xmath      (2.94)
  -- -------- -- --------

The Boltzmann equation, expressed in terms of the brightness function,
then becomes

  -- -------- -- --------
     @xmath      (2.95)
  -- -------- -- --------

where

  -- -------- --
     @xmath   
  -- -------- --

Written in terms of the brightness function, the stress energy tensor is

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.96)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

with the solid angle @xmath and @xmath and @xmath are defined in a
co-ordinate system with @xmath . We may separate the energy flux and
momentum flux density into scalar, vector and tensor parts as

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.97)
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

While we could expand the brightness function across the Legendre
polynomials and so reduce these to forms dependant on the moments of the
brightness function we shall refrain from doing so until after we have
considered the vector and tensor modes in further detail; the bases we
are lead to employ to simplify the photon Boltzmann equation complicate
the Legendre expansion.

While physically lucid, this approach is not sufficient for photons,
since it does not take into account polarisation states and we now turn
to a more detailed consideration of a collection of photons.It is
customary to notate the photon brightness function by @xmath . We shall
retain @xmath for the neutrinos.

#### 2.3.2 The Photons

There are two main approaches to dealing with photons in cosmology, the
more traditional approach in which the Boltzmann equation is separated
across the Legendre polynomials to generate a hierarchy of coupled
differential equations, and the more recent “line-of-sight” approach in
which one expresses the brightness function as an integration over the
past light-cone of the photons. While one can employ the traditional
approach without the line-of-sight approach, to do so numerically is
ruinously slow. The line-of-sight approach is not entirely independent
since the sources are formulated in terms of the Legendre moments of the
brightness function; however, one would only need to integrate a limited
number of the coupled equations to generate these sources and then
employ the line-of-sight approach for all higher photon moments.

A classical beam of light is fully specified by the four Stokes
parameters, here labelled @xmath , @xmath , @xmath and @xmath (see for
example Jackson [ 116 ] or Chandrasekhar [ 117 ] ). The electric fields
( @xmath ) that make up the beam are separated along two axes, labelled
@xmath and @xmath . @xmath is the total intensity of the beam, and is
the sum of the intensities along each axis. @xmath is a measure of the
linear polarisation and is the difference between the intensities along
the two axes. @xmath and @xmath are measures of the phase differences
along the two directions; @xmath is the cosine of the phase difference,
while @xmath is its sine.

For an electric field instantaneously resolved along @xmath and @xmath
as @xmath ,

  -- -------- -- --------
     @xmath      (2.98)
  -- -------- -- --------

We can obviously also define the Stokes parameters as the set @xmath .
It can then be demonstrated (see, for example, [ 117 ] ) that the
Boltzmann equation of transfer for a classical ray of light within a
classically scattering atmosphere (in a cosmological context, i.e.
employing the brightness function @xmath rather than the intensity
@xmath and including the term @xmath ) is

  -- -------- -- --------
     @xmath      (2.99)
     @xmath      
  -- -------- -- --------

where @xmath and @xmath is the differential scattering cross-section.
The scattering matrix @xmath separates naturally into parts transforming
as scalars, vectors and tensors (identified by their spin-0, spin-1 and
spin-2 dependence on the azimuthal angle @xmath ):

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

  -- -- --
        
  -- -- --

We have defined the Stokes parameters for the photons as

  -- -------- -- ---------
     @xmath      (2.100)
  -- -------- -- ---------

and we have expanded @xmath across the usual polar co-ordinates,

  -- -------- --
     @xmath   
  -- -------- --

with @xmath – that is, we have defined a basis @xmath .

Our approach will be closely related to that of Crittenden in his PhD
thesis and work with Coulson and Turok [ 113 , 115 ] ; another useful
reference (taking a slightly different approach) is that of Landriau and
Shellard [ 109 ] . However, the details presented beneath are, except
where noted, our own and in particular we employ different bases for the
vector and tensor components to either of the above groups. When we
consider the line-of-sight approach the vector components are, to our
knowledge, entirely original to this thesis; while Lewis [ 77 ]
incorporated vector perturbations into the CAMB code he employs a
different formalism and does not express the transfer functions as a
line-of-sight integration.

The dominant scattering source will be Thomson scattering, with the
differential cross-section

  -- -------- -- ---------
     @xmath      (2.101)
  -- -------- -- ---------

where @xmath is the density of free electrons and @xmath the Thompson
cross-section [ 116 , 117 ] . Thompson scattering does not excite the
@xmath Stokes parameter, and we shall henceforth neglect it as it can be
set to zero without loss of generality.

To proceed, we shall also separate @xmath , the metric contribution
@xmath and the velocity term @xmath into their respective components. We
shall also wish to convert @xmath to @xmath by means of the
transformation

  -- -------- -- ---------
     @xmath      (2.102)
  -- -------- -- ---------

which has the inverse transformation

  -- -------- --
     @xmath   
  -- -------- --

##### Scalar Perturbations

The metric contribution from scalar perturbations is readily shown to be

  -- -------- --
     @xmath   
  -- -------- --

while the scalar velocity term is

  -- -------- --
     @xmath   
  -- -------- --

The Boltzmann equation for scalar perturbations to the photons
(suppressing the @xmath on @xmath ) is then

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

A small amount of matrix algebra then demonstrates that the integrand is

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

One then sees that @xmath is unexcited by scalar perturbations, and we
shall thus set @xmath . There being no dependence on @xmath in the
scalar Boltzmann transport equation, we can immediately integrate it
out, leaving us with the equation in an identical form but with a
collisional term

  -- -------- --
              
     @xmath   
  -- -------- --

Relating the powers of @xmath to the Legendre polynomials,

  -- -------- --
     @xmath   
  -- -------- --

and we may expand @xmath across the Legendre polynomials as we did the
basic brightness function ( 2.91 ). The orthogonality of the Legendre
polynomials G.4 gives the relation

  -- -------- --
     @xmath   
  -- -------- --

Obviously, no summation is implied in the above statement.

Using these definitions, one may readily demonstrate that

  -- -------- --
     @xmath   
  -- -------- --

and so we may write the two transport equations (for the photon energy
density and polarisation respectively) as

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
     @xmath               
  -- -------- -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

Expanding these equations across the Legendre polynomials and employing
the recursion relation for Legendre polynomials ( G.3 ) yields the
equation

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

Applying the integral operator @xmath and employing the orthogonality of
the Legendre polynomials ( G.4 ) leads rapidly to the general transfer
equation for the moments of the intensity,

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

If we undertake a similar process for the polarisation, we get

  -- -------- --
     @xmath   
  -- -------- --

Expanding these equations into hierarchies, we finally reach the
equations of motion for scalar perturbations to a photon fluid,

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.103)
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
                                   
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.104)
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- ---------

##### Vector Perturbations

The vector perturbations depend on the azimuthal angle @xmath , and
their analysis is thus rendered more complicated than that for the
scalars. The metric contribution is

  -- -------- --
     @xmath   
  -- -------- --

Employing the basis @xmath and the expansion of a generic vector
quantity as @xmath , one sees that the vector part of the metric
perturbation may be written as

  -- -------- --
     @xmath   
  -- -------- --

The metric contribution is then

  -- -------- -- ---------
     @xmath      (2.105)
  -- -------- -- ---------

and the vector velocity term in the Boltzmann transport equation is

  -- -------- -- ---------
     @xmath      (2.106)
  -- -------- -- ---------

The Boltzmann equation for vector perturbations is thus

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

The scattering matrix is, after some matrix algebra, seen to be

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

If

  -- -------- --
     @xmath   
  -- -------- --

with @xmath corresponding to the analogous integrations over @xmath ,
the collisional term is

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

It proves useful to now transform the variables to

  -- -------- --
     @xmath   
  -- -------- --

An understanding of why this expansion is chosen can be gained by taking
the cue from @xmath and expanding @xmath across the basis @xmath , upon
which one finds it necessary to impose further redefinitions to reduce
the equation to a tractable form. Note that our transformation agrees
with Landriau and Shellard [ 109 ] and differs from that of Crittenden
and Coulson [ 113 , 115 ] by a power of @xmath in the temperature
redefinition; the difference arises because they did not include the
velocity term. The sign convention on @xmath and the presence of @xmath
on @xmath produce a neater form for the interaction term @xmath .

With this transformation, the Boltzmann transfer equation separates to

  -- -- -- -------- --
                    
                    
           @xmath   
  -- -- -- -------- --

where

  -- -------- -- ---------
     @xmath      (2.107)
  -- -------- -- ---------

We now briefly define a variable @xmath , which has the equation of
motion

  -- -------- --
     @xmath   
  -- -------- --

with the simple solution

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the initial conformal time. Thus, for a system initially
unpolarised with @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

holds for all times. This then means that we need only evolve two
parameters for the vector modes, rather than three, giving us the
evolution equation

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
  -- -------- -- -------- --

The interaction term reduces to

  -- -------- --
     @xmath   
  -- -------- --

and the physical Stokes parameters are recovered with

  -- -------- -- ---------
     @xmath      (2.108)
  -- -------- -- ---------

We now expand @xmath and @xmath across the Legendres in the usual way,
and in a process exactly analogous to that for scalars find the
hierarchies

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.109)
     @xmath   @xmath   @xmath      
                                   
     @xmath   @xmath   @xmath      (2.110)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- ---------

with

  -- -------- -- ---------
     @xmath      (2.111)
  -- -------- -- ---------

In the context of CMB polarisation, unfortunately, the @xmath and @xmath
Stokes parameters are not the variables one would prefer to measure due
to their heavy rotational dependence. In appendix D we construct
rotationally independent analogues of @xmath and @xmath . These are the
@xmath (or gradient) and @xmath (or curl) modes of the polarisation
actually employed in studies of CMB polarisation.

##### Tensor Perturbations

Again following Landriau and Shellard, we shall expand the tensor
perturbations along the symmetric and trace-free basis

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

A symmetric, traceless tensor @xmath is then expressed as

  -- -------- --
     @xmath   
  -- -------- --

In particular, one may expand the metric perturbation to @xmath and show
that the metric contribution to the tensor Boltzmann transport equation
is

  -- -------- --
     @xmath   
  -- -------- --

The Boltzmann transport equation then becomes

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

The scattering matrix reduces to

  -- -- --
        
  -- -- --

where now we have for clarity defined

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

This implies that, defining

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

and analogous expressions for integrals over @xmath , the collisional
term is

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

We now change variables to

  -- -------- --
     @xmath   
  -- -------- --

This transformation may be motivated by expanding @xmath across the
basis @xmath and applying a further transformation to render the
Boltzmann transport equation as lucid as possible. See for example
Polnarev [ 118 ] , Crittenden [ 113 ] or Landriau and Shellard [ 109 ]
for further discussion.

Under this transformation, the Boltzmann equation separates to

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- -- ---------
     @xmath      (2.112)
  -- -------- -- ---------

and @xmath .

Consider first the @xmath mode and select a “temperature” vector to act
as a basis vector,

  -- -------- --
     @xmath   
  -- -------- --

when transformed to the transformed variables, this is @xmath . Applying
the integral operator

  -- -------- --
     @xmath   
  -- -------- --

and expressing the result as a linear combination of the basis vectors
necessary for the excited system, we find

  -- -------- --
     @xmath   
  -- -------- --

which (with @xmath ) gives us our “polarisation” vector

  -- -------- --
     @xmath   
  -- -------- --

its transformed analogue is @xmath . We may now expand

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the contribution to the brightness function from the
@xmath mode.

Performing the same process on the @xmath mode yields the basis vectors

  -- -------- --
     @xmath   
  -- -------- --

the physical Stokes parameters are thus

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.113)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- ---------

with the equations of motion

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.114)
  -- -------- -------- -------- -- ---------

Expanding @xmath and @xmath as with the basic brightness function ( 2.91
) reduces @xmath to

  -- -------- -- ---------
     @xmath      (2.115)
  -- -------- -- ---------

Reducing the equations of motion to hierarchies in exactly the same way
as before yields

  -- -------- -------- -------- -- ---------
     @xmath   @xmath               
     @xmath   @xmath   @xmath      
                                   
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.117)
  -- -------- -------- -------- -- ---------

##### Stress-Energy Tensor

We are now finally in a position to expand the photon (and thus the
massless neutrino) stress-energy tensor, ( 2.96 , 2.97 ) across the
modes of the brightness function.

For the scalars, @xmath , @xmath and so @xmath ; thus

  -- -------- -- ---------
     @xmath      (2.118)
  -- -------- -- ---------

which is the density perturbation,

  -- -------- -- ---------
     @xmath      (2.119)
  -- -------- -- ---------

which is to be related to the photon scalar velocity field, and

  -- -------- -- ---------
     @xmath      (2.120)
  -- -------- -- ---------

which represents the scalar anisotropic stress.

For the vectors we work explicitly within our basis. Considering the
first component, we see that @xmath and

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
              @xmath   @xmath   
  -- -------- -------- -------- --

The second component gives identical forms, so

  -- -------- -- ---------
     @xmath      (2.121)
  -- -------- -- ---------

which is related to the vector velocity field. We derive the velocity
fields shortly.

Similarly,

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
              @xmath   @xmath   
  -- -------- -------- -------- --

and so

  -- -------- -- ---------
     @xmath      (2.122)
  -- -------- -- ---------

which is a measure of vorticity induced by the photons.

For the tensors, we must again be explicit in our basis. The tensor
stress-energy tensor ( 2.97 ) contains the term

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
  -- -------- -- -------- --

This enables us to separate out @xmath and @xmath . Consider the @xmath
mode, with @xmath :

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
              @xmath   @xmath   
  -- -------- -------- -------- --

This also holds for the @xmath mode and so

  -- -------- -- ---------
     @xmath      (2.123)
  -- -------- -- ---------

are the sources of gravitational radiation from the photons.

##### Velocity Fields

Relating our energy flux to that for a radiative fluid we can say

  -- -------- --
     @xmath   
  -- -------- --

Then

  -- -------- --
     @xmath   
  -- -------- --

whence we may define the effective velocity fields of the photons to be

  -- -------- -- ---------
     @xmath      (2.124)
  -- -------- -- ---------

We can then rewrite the evolution equations of the photon density
perturbation (scalar @xmath ) and velocity (scalar @xmath and vector
@xmath ) as

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.125)
     @xmath   @xmath   @xmath      (2.126)
  -- -------- -------- -------- -- ---------

which are useful when we wish to approximate the photons as a fluid.

#### 2.3.3 E and B Modes

The polarisation bases we have thus far employed are far from ideal for
study of the sky, due to their heavy rotation dependence. While a
detailed study is somewhat tangential to the direct field of this thesis
we present an introduction to the @xmath - and @xmath - modes in
appendix D . An intuitive way to consider @xmath and @xmath modes is to
think of the @xmath modes as the gradient component of the polarisation
and the @xmath mode as the curl component – that is, the @xmath
component makes patterns radial or normal to the radial around a centre,
while the @xmath component makes curling patterns set at @xmath to the
@xmath patterns, reminiscent of a catherine wheel. In a small-angle
limit the @xmath and @xmath modes reduce to the @xmath and @xmath
polarisation respectively.

#### 2.3.4 The Line-of-Sight Approach

It is very slow to naïvely implement a basic Boltzmann approach by
integrating the system of equations detailed above. The introduction by
Seljak and Zaldarriaga [ 86 ] of fast methods employing the
line-of-sight integration approach make it stubborn to insist on any
alternative. This method, which we review below, reduces the necessary
maximum multipole number @xmath from the region of @xmath to the order
of @xmath s or even less. The saving in computational time is extremely
significant.

We consider the line-of-sight approach to be split into two sections –
first expressing the evolution equations in terms of some convenient and
simply evaluable line-of-sight integral, and second in terms of the
statistics on the CMB. This second part will be discussed in full in §
2.7.4 and we shall merely here present the pertinent results. We define
the optical depth between us at @xmath and an arbitrary time @xmath to
be

  -- -------- -- ---------
     @xmath      (2.127)
  -- -------- -- ---------

and the visibility function

  -- -------- -- ---------
     @xmath      (2.128)
  -- -------- -- ---------

We often use the co-ordinate @xmath rather than @xmath . We consider
here only the temperature perturbations.

##### Scalars

Consider first the scalar perturbations. Here

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

We can formally integrate this between @xmath and @xmath as a standard
first-order differential equation to give

  -- -------- -- -- -------- ---------
     @xmath                  (2.129)
                             
                    @xmath   
  -- -------- -- -- -------- ---------

While this equation is none too edifying, it is simple to integrate it
by parts; we can take any term

  -- -------- -- ---------
     @xmath      (2.130)
  -- -------- -- ---------

where the boundary term is taken to vanish since we assume it disappears
at @xmath and at the current time is a monopole which we are not
interested in. Effectively this means we can replace any term
proportional to @xmath by its time derivative divided by the wavenumber.
Doing so leads us after a bit of manipulation to

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
  -- -------- -- -------- --

We can thus express

  -- -------- -- ---------
     @xmath      (2.131)
  -- -------- -- ---------

with

  -- -------- -------- -------- -------- ---------
     @xmath   @xmath   @xmath            (2.132)
                                @xmath   
  -- -------- -------- -------- -------- ---------

In section § 2.7.4 on CMB anisotropies, we shall first expand the plane
waves across the spherical Bessel functions and then take ensemble
averages; in doing so we can ultimately identify

  -- -------- -- ---------
     @xmath      (2.133)
  -- -------- -- ---------

We have thus separated the brightness function and polarisation modes
into a part @xmath , dependant on the hierarchies with @xmath and
encoding the total fluid dynamics of the system between earliest times
and the present day, and a geometrical part @xmath which doesn’t vary
with differing cosmological models. We then immediately see that we need
only evaluate the Boltzmann hierarchies up to some low @xmath – about
@xmath , say – and, so long as we have precomputed the spherical Bessel
functions we can integrate equation ( 2.133 ) to determine the modes up
to an arbitrarily high- @xmath with relatively little computation.

##### Vector Perturbations

Here we had that the physical Stokes parameter is

  -- -------- --
     @xmath   
  -- -------- --

and that this obeys the evolution equation

  -- -------- --
     @xmath   
  -- -------- --

with

  -- -------- --
     @xmath   
  -- -------- --

Following the same process as we did for the scalars then quickly yields
the source term

  -- -- -- ---------
           (2.134)
  -- -- -- ---------

However, we shall not directly write the line-of-sight integrations
since they are not in an ideal basis for this formalism. Instead we
rotate the basis such that the trigonometric functions become
exponentials; rewriting the trigonometric functions as exponentials
gives us

  -- -------- --
     @xmath   
  -- -------- --

We can thus make the co-ordinate transformation

  -- -------- -- ---------
     @xmath      (2.135)
  -- -------- -- ---------

The statistics of the vector perturbations are characterised by two
variables @xmath and @xmath with the properties

  -- -------- -- ---------
     @xmath      (2.136)
  -- -------- -- ---------

Assuming that our modes are thus uncorrelated but similar, we can employ
the source term generated from, for example, the @xmath mode, and write
our line-of-sight integral as

  -- -------- -- ---------
     @xmath      (2.137)
  -- -------- -- ---------

with

  -- -------- -- ---------
     @xmath      (2.138)
  -- -------- -- ---------

The line-of-sight moments are a bit protracted to calculate; again we
only present the result here. We find that

  -- -------- -- ---------
     @xmath      (2.139)
  -- -------- -- ---------

##### Tensor Perturbations

For the tensors,

  -- -------- --
     @xmath   
  -- -------- --

with the evolution equation

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

From here we rapidly find the source term

  -- -------- -- ---------
     @xmath      (2.140)
  -- -------- -- ---------

As with the vector case, things will run more smoothly if we rotate our
basis to convert the trigonometric functions into exponentials;
following the process we did with the vectors we see that the new
variables

  -- -------- -- ---------
     @xmath      (2.141)
  -- -------- -- ---------

puts our Stokes parameter into the form

  -- -------- -- ---------
     @xmath      (2.142)
  -- -------- -- ---------

Following Zaldarriaga and Seljak we also choose to characterise the
statistics of the gravity waves with variables @xmath and @xmath and
assume that our two modes are similar but uncorrelated, which means that
we can evolve one set ( @xmath , for example) and use that for our
source term, with the solution

  -- -------- -- ---------
     @xmath      (2.143)
  -- -------- -- ---------

with

  -- -------- -- ---------
     @xmath      (2.144)
  -- -------- -- ---------

and

  -- -------- -- ---------
     @xmath      (2.145)
  -- -------- -- ---------

The tensor moments can then be shown to be

  -- -------- -- ---------
     @xmath      (2.146)
  -- -------- -- ---------

which is pleasing in light of the vector and scalar moments; the spin-2
tensors are undefined for the dipole and the quadrupole and the
geometrical Bessel term is divided through by @xmath , while in the
spin-1 vector case the moments are undefined for the dipole and the
geometrical term is merely divided through by @xmath . For the spin-0
scalars, the moments are cleanly defined for all @xmath and the
geometrical term is divided by @xmath . These symmetries between the
separate types are exploited in far greater depth in the total angular
momentum formalism of CMB perturbations developed by Hu and White [ 119
] .

#### 2.3.5 The Neutrinos

Recent neutrino oscillation observations strongly suggest that, in fact,
the neutrino mass is small but non-vanishing (a combined mass of @xmath
is a recent estimate from cosmology; see for example [ 120 ] for a
cosmological presentation) but considering them to be massless will
remain a good approximation. While it is possible to add mass in this
formalism (see for example [ 108 ] ), we shall not do so.

We start our system long after the neutrinos have decoupled and so
assume they do not interact with matter; however, it is worth noting
that the magnetic field introduced in chapter 3 could well have been
sourced before neutrino decoupling; if this was the case then we will
have additional initial conditions generated by the unmodified
anisotropic stresses of the magnetic field. Lewis [ 59 ] demonstrated
that, after neutrino decoupling, the neutrino anisotropic stress
generally acts to cancel that of the magnetic field and so the greatest
impact of such a primordial magnetic field is through the sourcing of
perturbations in the extremely early universe, before neutrino
decoupling.

We model each species of neutrino as a radiative fluid in exactly the
same way as the intensity of the photons – thus to recover the formalism
for neutrinos, we should take the equations for @xmath and set all
interaction terms to zero. Some modification is required for the tensor
modes; here we do not expand across the basis employed for the photons
but rather stop with the change of variables (denoting the brightness
function for the neutrinos as @xmath )

  -- -------- --
     @xmath   
  -- -------- --

The resulting Boltzmann hierarchies are

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.147)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- ---------

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.148)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- ---------

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.149)
  -- -------- -------- -------- -- ---------

The stress-energy tensor is identical in form to that for the photons,
separating out as

  -- -------- -- ---------
     @xmath      
     @xmath      (2.150)
     @xmath      
  -- -------- -- ---------

and it has an equivalent density fluctuation and velocity fields

  -- -------- -- ---------
     @xmath      (2.151)
  -- -------- -- ---------

We would require the neutrino hierarchies only to a level equivalent to
the photon ones; the neutrinos will merely provide sources in the
Einstein equations, requiring moments only as high as the fourth.

#### 2.3.6 Truncation

In the line-of-sight integration approach, we need only integrate up a
limited number of modes of the Boltzmann hierarchies to provide the
sources for the line-of-sight integrals; these can be cut off at, say,
@xmath [ 86 ] . However, a naïve sudden truncation will lead to dreadful
errors propagating through the code from the error induced in the
evolution equation for @xmath cascading down to @xmath in a finite time
(and back up to the cut-off again). The resulting errors, without some
more sensible truncation approach than the harsh cutoff, will be major.
Inspired by the line-of-sight integral approach we derive an improved
approximation for @xmath (equivalent to that in Ma and Bertschinger [
108 ] ; it might be emphasised that although the approach is our own
this is not an original result.)

Consider first the scalars. From the line-of-sight integration we saw
that their oscillatory character is governed for the most part by the
spherical Bessel functions (see Zaldarriaga and Seljak [ 86 ] for a
detailed discussion on the oscillations of the two parts of the
integral). In the absence of scattering and time-varying metrics, the
result is the integral of a spherical Bessel function. Employing now the
recursion relation for the spherical Bessel functions ( G.13 ) we can
write the exact solution

  -- -------- --
     @xmath   
  -- -------- --

which we approximate to

  -- -------- -- ---------
     @xmath      (2.152)
  -- -------- -- ---------

since we are concerned primarily with the oscillatory behaviour over
time, which holds equally well for both temperature and polarisation.
Cutting short the hierarchy at @xmath , we can employ this to write the
evolution equation for @xmath as

  -- -------- -- ---------
     @xmath      (2.153)
  -- -------- -- ---------

While the vector line-of-sight solution does not strictly apply to the
vector hierarchies, since they are formulated in different bases, it is
apparent that the oscillatory behaviour will still be dominated by the
spherical Bessels, here appearing as @xmath . If one works through, it
is clear that the above scheme also then holds for the vectors and the
final equation in the hierarchy has an identical form to ( 2.153 ). The
tensors’ oscillations will be dominated by @xmath and, again, the same
truncation scheme will hold.

The neutrino solutions do not contain the scattering sources but
otherwise the solutions will be identical in behaviour to the photons;
removing the scattering term in ( 2.153 ) will generate a scheme equally
as applicable to the neutrinos as to the photons.

### 2.4 Baryonic Matter

We turn now to the (unmagnetised) baryon fluid; we shall assume that, as
with the cold dark matter, the baryonic matter can be represented by a
perfect, pressureless fluid. However, we must include a coupling term
that transfers momentum between the baryons and the photons – recalling
that there was no impact from the photons onto the baryonic mass
continuity ( 2.103 ).

If @xmath represents the transfer of momentum into the photons, we can
express the equations governing the baryons ( 2.2.1 , 2.41 ) as

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.154)
  -- -------- -------- -------- -- ---------

in the background and

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      (2.155)
     @xmath   @xmath   @xmath      (2.156)
  -- -------- -------- -------- -- ---------

where we have set @xmath except where they multiply a spatial
derivative.

To evaluate the transferral of the momentum, consider the scalar @xmath
( 2.103 ) and vector @xmath ( 2.109 ) moments of the photon brightness
function hierarchy coupling the photons to the baryons. Since the
photons have the velocity fields @xmath and @xmath , we see that (in
addition to the vector @xmath equation) these are effectively the
photonic equivalents of the Euler equation.

For a generic fluid, the contribution to momentum conservation comes
from

  -- -------- --
     @xmath   
  -- -------- --

(c.f. ( 2.41 ).) We can then construct the photon analogue of this for
the scalar modes,

  -- -------- --
     @xmath   
  -- -------- --

and compare it with the corresponding baryon contribution,

  -- -------- --
     @xmath   
  -- -------- --

Thus we see that to account for the loss of momentum from the photons we
need to take

  -- -------- -- ---------
     @xmath      (2.157)
  -- -------- -- ---------

as the term in the baryon Euler equations accounting for the transferral
of momentum and from the photons.

Similarly, in the vector case we combine the vector @xmath and @xmath
equations to form the photon equation equivalent to the Euler equation,

  -- -- --
        
  -- -- --

and compare it with the baryon term

  -- -------- --
     @xmath   
  -- -------- --

to identify

  -- -------- -- ---------
     @xmath      (2.158)
  -- -------- -- ---------

Converting these back into the moments of the brightness function,

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.159)
  -- -------- -------- -------- -- ---------

The sound speed is evaluated [ 108 ] from

  -- -------- -- ---------
     @xmath      (2.160)
  -- -------- -- ---------

where @xmath is the (approximately constant) mean molecular weight and
@xmath is the temperature of the baryon fluid

  -- -------- -- ---------
     @xmath      (2.161)
  -- -------- -- ---------

where we work in units with the Boltzmann constant @xmath . The
temperature evolves by [ 108 ]

  -- -- -- ---------
           (2.162)
  -- -- -- ---------

This is derived from the first law of thermodynamics in the same way as
for a collisionless fluid ( 2.35 ), but with the heating rate [ 108 ,
111 , 121 ]

  -- -------- -- ---------
     @xmath      (2.163)
  -- -------- -- ---------

In Fourier space we then have for the baryons the stress-energy tensor

  -- -------- -- ---------
     @xmath      (2.164)
  -- -------- -- ---------

in the background and

  -- -------- -- ---------
     @xmath      
     @xmath      (2.165)
  -- -------- -- ---------

The equation of mass continuity is

  -- -------- -- ---------
     @xmath      (2.166)
  -- -------- -- ---------

The scalar component of the Euler equation is

  -- -------- -- ---------
     @xmath      (2.167)
  -- -------- -- ---------

where @xmath and @xmath is similarly the scalar component of the
momentum transfer into the photons in Fourier space. The vector
component is

  -- -------- -- ---------
     @xmath      (2.168)
  -- -------- -- ---------

#### 2.4.1 Tight-Coupling

Throughout almost the entire period we are considering, the Thomson
scattering term @xmath will be extremely large due to the high density
of free electrons. It is only for a short period before recombination
that the free electron density and thus the scattering term drops. We
shall shortly demonstrate that recombination occurs well within the
matter-dominated era and so for the entire time that the universe is
dominated by radiative species the photons and baryons are tightly
coupled together. Even within the era of matter domination a
tight-coupling approximation will hold until relatively near
recombination.

To build up our tight-coupling approximation, take the interaction time
@xmath and consider the scalar photon and baryon evolution equations
separated into zeroth and higher orders:

-   @xmath :

      -- -------- --
         @xmath   
         @xmath   
         @xmath   
      -- -------- --

-   @xmath :

      -- -------- --
         @xmath   
         @xmath   
         @xmath   
      -- -------- --

Employing the form of @xmath then lets us see that at zeroth order in
@xmath polarisation is driven to zero in the tight-coupled era. So,
therefore, during tight-coupling the only significant photon moments are
the zeroth and the first, corresponding to the density fluctuation and
the velocity respectively, with the anisotropic stresses and
polarisation of at least first-order in the small @xmath .

##### The First Moment: Tight-Coupled Euler Equations

If we consider the first moment of the photon hierarchies, we can write
a formal solution for @xmath :

  -- -------- --
     @xmath   
  -- -------- --

Applying this recursively to itself we can express this as

  -- -------- -- ---------
     @xmath      (2.169)
  -- -------- -- ---------

Substituting this in the baryon Euler equation then gives us

  -- -------- --
     @xmath   
  -- -------- --

##### The Zeroth Moment: Entropy Perturbations

If we consider now the zeroth moment of the photon hierarchy, we have
that

  -- -------- --
     @xmath   
  -- -------- --

implying with the baryon continuity equation that

  -- -------- --
     @xmath   
  -- -------- --

Integrating gives us the condition that

  -- -------- -- ---------
     @xmath      (2.170)
  -- -------- -- ---------

where we have unidentified this difference as the entropy perturbation
between the photons and the baryons. We may define similar relations
between the baryons and the cold dark matter, or between the photons and
the neutrinos,

  -- -------- --
     @xmath   
  -- -------- --

We may thus state that if a system is set an initial entropy
perturbation then to first order in the tight-coupling parameter it will
retain this perturbation until at the least the epoch of recombination.
Stated differently, we may separate the initial conditions for the
universe into adiabatic modes with @xmath , or into isocurvature modes
which possess entropy perturbations but can be shown to have vanishing
spatial curvature on a given spatial slicing. Adiabatic and isocurvature
perturbations provide a basis for cosmological initial conditions. CMB
analyses are entirely consistent with adiabatic initial conditions with
no isocurvature component ( [ 78 ] ), although a certain level of
isocurvature perturbation is allowed.

With the relation between the density fluctuations, we may then express
the Euler equation for adiabatic perturbations as

  -- -------- -------- -------- -------- ---------
     @xmath   @xmath   @xmath            (2.171)
                       @xmath   @xmath   
                       @xmath   @xmath   
  -- -------- -------- -------- -------- ---------

labelling the effective speeds of sound as @xmath , which identifies the
tightly-coupled fluid as a perfect fluid with density @xmath and
pressure @xmath . An isocurvature perturbation adds an extra effective
pressure term.

### 2.5 Scalar Field Matter

General Relativity can be formulated as a variational theory; the
relevant vacuum Lagrangian density is

  -- -------- -- ---------
     @xmath      (2.172)
  -- -------- -- ---------

Including a matter Lagrangian, the action is then

  -- -------- -- ---------
     @xmath      (2.173)
  -- -------- -- ---------

The Einstein equations can then be found from this action by variation
with respect to the metric and an assumption about the form of
stress-energy tensor for the matter. A Klein-Gordan field of mass @xmath
, for example, has the Lagrangian density

  -- -------- -- ---------
     @xmath      (2.174)
  -- -------- -- ---------

The form of the stress-energy tensor for matter is somewhat arbitrary;
we refer the reader to Weinberg [ 96 ] for details. Here we shall take
the stress-energy tensor to be

  -- -------- -- ---------
     @xmath      (2.175)
  -- -------- -- ---------

If we let the universe contain a dominating massless, spatially uniform
scalar field @xmath which is minimally coupled to gravity and has some
arbitrary associated potential @xmath then the relevant action is

  -- -------- -- ---------
     @xmath      (2.176)
  -- -------- -- ---------

where @xmath obeys the massless Klein-Gordan equation

  -- -------- --
     @xmath   
  -- -------- --

Considering only the background metric and expanding out the
Klein-Gordan equation then gives us

  -- -------- -- ---------
     @xmath      (2.177)
  -- -------- -- ---------

converting this to co-ordinate time will yield the more familiar

  -- -------- --
     @xmath   
  -- -------- --

This is merely an harmonic equation with a friction term due to the
expansion of space.

The stress-energy tensor ( 2.175 ) gives us a vanishing energy flux and
the pressure and density

  -- -------- -- ---------
     @xmath      (2.178)
  -- -------- -- ---------

The Friedmann and Raychaudhuri equations ( 2.9 , 2.10 ), including a
curvature @xmath , are then

  -- -------- -- ---------
     @xmath      (2.179)
  -- -------- -- ---------

For a de Sitter or quasi-de Sitter state, then, when @xmath expands
exponentially, the curvature term @xmath is effectively driven to zero
regardless of its initial value.

In co-ordinate time, inflation occurs when @xmath ; for a scalar field
this condition is

  -- -------- -- ---------
     @xmath      (2.180)
  -- -------- -- ---------

and for extremal inflation, normally dubbed “slow-roll”,

  -- -------- -- ---------
     @xmath      (2.181)
  -- -------- -- ---------

and therefore

  -- -------- -- ---------
     @xmath      (2.182)
  -- -------- -- ---------

that is, a slowly-rolling scalar field will mimic a cosmological
constant and the universe will be in a quasi-de Sitter state. In
slow-roll inflation we have the Friedmann and Klein-Gordan equations

  -- -- -- ---------
           (2.183)
  -- -- -- ---------

from which it may be shown that, given the exponential expansion of
@xmath , @xmath is effectively driven rapidly to zero.

Finally we define the slow-roll parameters, introduced by Liddle and
Lyth; if we define

  -- -- -- ---------
           (2.184)
  -- -- -- ---------

then it can be demonstrated that

  -- -------- -- ---------
     @xmath      (2.185)
  -- -------- -- ---------

are necessary, though not sufficient, conditions for inflation.

All the above applies to a universe dominated by a scalar field
minimally-coupled to gravity, regardless of whether it is in the early
universe or the present universe. Both theories of inflation and
theories of quintessence employ scalar fields of this type, with various
potentials, as well as employing multiple-field models or models with
modified kinetic terms in the action. However, while it is relatively
easy to justify the existence of a scalar field in the exceptionally
early universe – high-energy physics predicting many such fields – it is
relatively hard to justify their existence in the late-time universe
when the energy is so very much lower, if only because we can directly
probe such energies in the laboratory. Moreover, the extremely shallow
gradients on the potential must be seen to argue against the simplest
quintessence models. As a candidate for an early-universe inflaton a
single scalar field model (with a scale-invariant spectral index) is
entirely consistent with CMB observations [ 78 ] although other, more
complicated, are not ruled out (the two-field curvaton model [ 122 ] for
example); these models are in principle distinguishable by the relative
amplitudes of the tensor and scalar modes they produce, or their
primordial non-Gaussianity. For the late-time acceleration we observe,
scalar field candidates are popular but not unrivalled, with a standard
cosmological constant entirely consistent with CMB and large-scale
structure observations.

### 2.6 The Evolution of the Universe

#### 2.6.1 Periods in the Universal Evolution

Because the fluids filling the universe evolve at different rates, there
will be different periods in the universal history at which a different
form of matter dominates; the situation will be similar to the schematic
in figure 2.1 . The most rapidly-decaying species, radiation (photons
and neutrinos), will have dominated the universe at some early time.
Following some brief era of approximate matter-radiation equality, the
radiation density will have become subdominant to the dust species
(baryons and cold dark matter). As we shall shortly show, the CMB
last-scattered some way into matter domination. If the universal
expansion is indeed beginning to accelerate [ 78 , 104 ] , then in the
simplest model we are sitting at the beginning of the period of vacuum
energy domination. This bleak epoch begins when the matter densities
decay below the intrinsic energy of the cosmological constant and the
universe tends asymptotically towards an eternal de Sitter state. More
complex dark energetic models naturally have differing future states. It
may be commented that our exact position at the beginning of vacuum
energy domination is a “coincidence problem”; why should the vacuum
energy density and matter density have grown roughly equivalent in the
very recent past ( @xmath )? There are various suggestions ranging from
arbitrary tracker potentials for dark energy models that tend to similar
universal evolutions independent of initial conditions (e.g. [ 123 ] ),
to equally arbitrary modifications of the gravitational action (see [
124 , 125 ] for recent reviews); other suggestions include modifications
of the averaging procedure employed to derive our background densities [
126 ] or other back-reactions which derive effective dark energies from
non-linear terms in the Friedmann equations [ 127 , 128 ] .

#### 2.6.2 Vacuum Domination – Inflation

The epoch of inflation occurs at some point when the energy of the
universe lies between the Planck scale and the electroweak scale (at
about @xmath ). We do not discuss this era in detail, and merely wish to
note that, without a period of vacuum domination, there are large
fine-tuning problems in cosmology, along with the “horizon problem”. The
main fine-tuning problem is the universe’s flatness – a curvature term
in the Friedmann equation decays as @xmath and, to be as flat as it is
observed to be today, this implies an extremely finely-tuned initial
condition. The “horizon problem” is most readily observed from the
microwave sky; two points in opposing directions are at the same
temperature and yet, obviously, are two horizon distances apart. It
seems incredible to believe that the entire surface of last scattering
formed at the same time without it having been in causal contact at some
point, and yet it cannot have been. Inflation remedies these problems; a
small patch of space can have an arbitrary curvature and be well within
causal contact and in thermal equilibrium, and then inflated until every
perturbation is well outside the Hubble distance. The curvature is
driven to zero and the horizon problem is solved. It can be shown that
in a standard model around 60 e-foldings are necessary to solve the
problems.

Moreover, the perturbations of simple inflationary models predict
initial conditions for standard cosmology that are adiabatic, Gaussianly
distributed with an almost scale-invariant (Harrison-Zel’dovich) power
spectrum. This is entirely consistent with the observations of the CMB.
We refer the reader further to, for example, Liddle and Lyth [ 121 ] for
a relatively recent overview of simple inflation and assume now that
some inflationary, or vacuum dominated, epoch has occurred and left us
with Gaussian and adiabatic initial conditions.

#### 2.6.3 Radiation Domination

Technically the universe is radiation dominated as far back as the
validity of general relativity and the standard model of physics and in
the usual history radiation-dominated back to the end of the
inflationary epoch; however, the phrase is more usually used to describe
the universe after the electroweak phase transition or even after
neutrino decoupling at about @xmath . Cosmological codes such as CAMB
and CMBFast begin deep in radiation domination but typically after
neutrinos have decoupled. We assume the phrase to mean this.

During radiation domination as we have defined it the Friedmann equation
is effectively

  -- -------- -- ---------
     @xmath      (2.186)
  -- -------- -- ---------

As we saw earlier ( 2.52 ) a universe dominated by a radiative fluid
evolves as

  -- -------- --
     @xmath   
  -- -------- --

The universe remains tightly-coupled throughout radiation domination and
adiabatic perturbations thus remain adiabatic. Employing the convenient
unit @xmath , the system of tightly-coupled equations that we developed
in § 2.4.1 , along with the Einstein equation for the evolution of the
scalar trace, are

  -- -------- -- ---------
     @xmath      (2.187)
  -- -------- -- ---------

where we have defined

  -- -------- -- ---------
     @xmath      (2.188)
  -- -------- -- ---------

We can then find the evolution of the baryon and CDM densities by the
adiabatic condition. This equation also reduces the source term in the
Einstein equation to @xmath . Using the Euler equation to eliminate the
velocity and the mass continuity equation to eliminate the metric
perturbation gives the evolution equation for @xmath ,

  -- -------- -- ---------
     @xmath      (2.189)
  -- -------- -- ---------

We study this equation in two limits, the super-horizon limit when
@xmath and the sub-horizon limit where @xmath .

-   Super-horizon: The general evolution equation in the super-horizon
    limit is

      -- -------- --
         @xmath   
      -- -------- --

    which is an Euler-Cauchy equation for @xmath , easily solved by

      -- -------- --
         @xmath   
      -- -------- --

    Press and Vishniac [ 91 ] demonstrated that the decaying mode is a
    symptom of the lack of specification in the synchronous gauge and we
    remove it; we also neglect the slower-growing mode. Then we can see
    that

      -- -------- -- ---------
         @xmath      (2.190)
      -- -------- -- ---------

    and so, always requiring that the initial perturbations are small or
    vanishing,

      -- -------- -- ---------
         @xmath      (2.191)
      -- -------- -- ---------

    The velocity is thus sub-dominant on super-horizon scales. We then
    employ the first Einstein scalar constraint to find

      -- -------- -- ---------
         @xmath      (2.192)
      -- -------- -- ---------

    Outside of the horizon, then, the density and metric perturbations
    variables grow simply as the scale factor, while the velocity grows
    slightly faster.

-   Sub-horizon: The equation for @xmath has the general solution

      -- -------- -------- -- -------- ---------
         @xmath   @xmath               (2.194)
                              @xmath   
      -- -------- -------- -- -------- ---------

    For regularity as @xmath we remove @xmath , and @xmath is a gauge
    mode. Taking the sub-horizon limit @xmath then gives us the solution

      -- -------- -- ---------
         @xmath      (2.195)
      -- -------- -- ---------

    We can then rapidly find that

      -- -------- -- ---------
         @xmath      (2.196)
      -- -------- -- ---------

    and the metric solutions are

      -- -------- -- ---------
         @xmath      (2.197)
      -- -------- -- ---------

    The oscillations in the densities and coupled photon-baryon velocity
    found once modes have entered the horizon produce the characteristic
    patterns on the CMB. They are merely sound waves – hence the
    terminology “acoustic peak” for the peaks of the CMB angular power
    spectrum – in the tightly-coupled fluid, driven by gravitational
    attraction and self-pressure. They are all the more important since,
    as we shall shortly show, oscillations cease once the universe
    enters matter domination.

#### 2.6.4 Matter-Radiation Equality

At matter-radiation equality, we can say

  -- -------- -- ---------
     @xmath      (2.198)
  -- -------- -- ---------

where @xmath denotes photons plus three species of massless neutrino,
@xmath denotes the redshifting of light, and @xmath denotes CDM and
baryons. From the temperature of the CMB it can be shown [ 121 ] that
the density ratio of radiation, assuming three species of massless
neutrinos, is

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the observed correction to an assumed Hubble parameter,
@xmath . With this we see that

  -- -------- -- ---------
     @xmath      (2.199)
  -- -------- -- ---------

and thus, taking the concordance values of

  -- -------- --
     @xmath   
  -- -------- --

we have

  -- -------- -- ---------
     @xmath      (2.200)
  -- -------- -- ---------

#### 2.6.5 Matter Domination

Once the universe has entered a matter-dominated era the situation is
changed. The Friedmann equation is now given by

  -- -------- -- ---------
     @xmath      (2.201)
  -- -------- -- ---------

which has the solutions ( 2.53 )

  -- -------- --
     @xmath   
  -- -------- --

and we work with the system

  -- -------- -- ---------
     @xmath      (2.202)
  -- -------- -- ---------

-   On the super-horizon scale the adiabatic condition holds between the
    CDM and the baryons, as well as between the baryons and the photons,
    because the modes are well outside of the acoustic horizon. We
    choose to employ the CDM density as a tracer of the universe’s
    evolution. Employing again the scalar trace evolution equation and
    working in a manner analogous to that for radiation domination, we
    can quickly find that

      -- -------- -- ---------
         @xmath      (2.203)
      -- -------- -- ---------

    with the solution

      -- -------- -- ---------
         @xmath      (2.204)
      -- -------- -- ---------

    where we have again removed a decaying gauge mode. This implies we
    have the metric trace

      -- -------- -- ---------
         @xmath      (2.205)
      -- -------- -- ---------

    and so the traceless metric perturbation

      -- -------- -- ---------
         @xmath      (2.206)
      -- -------- -- ---------

    We can match these solutions to those from the previous section to
    fix the integration constants if we so desire. The velocity in the
    super-horizon limit couples to nothing and decays as the scale
    factor, that is,

      -- -------- -- ---------
         @xmath      (2.207)
      -- -------- -- ---------

-   The sub-horizon scale is again more complicated. From ( 2.160 ), the
    baryon speed of sound, in a tight-coupling limit, evolves
    approximately as

      -- -------- -- ---------
         @xmath      (2.208)
      -- -------- -- ---------

    The CDM density, naturally, is unaffected by the system entering the
    sound horizon and evolves as before,

      -- -------- -- ---------
         @xmath      (2.209)
      -- -------- -- ---------

    However, the baryons oscillate weakly; one may derive that the
    baryon density evolves as

      -- -------- -- ---------
         @xmath      (2.210)
      -- -------- -- ---------

    which is a forced damped wave equation producing waves with a
    frequency of @xmath .

#### 2.6.6 Recombination – Formation of the CMB

Recombination occurs when the temperature of the universe has dropped
low enough that hydrogen atoms can form. Once this occurs, obviously the
density of free electrons plummets and the tight-coupling approximation
breaks. During this brief period higher moments of the photon hierarchy
are excited, and the presence of a quadrupole in turn excites polarised
modes. Since recombination is relatively brief and photons free-stream
when it is finished (excepting foreground effects such as the
Sunyaev-Zel’dovich effect and the reionisation of the universe)
polarisation will then give us a unique picture of the fluid dynamics at
the formation of the CMB.

It is not our intention here to provide an overview of recombination
physics; for such we recommend Peebles [ 110 , 111 ] or Seager et. al. [
129 , 130 ] ; the latter programmed the widely-used RECFast code
employed by both CMBFast and CAMB. We shall merely calculate the
redshift at which recombination occurs; it is readily seen that this is
well into the matter dominated era and thus that the largest scale sound
waves imprinted upon the CMB were frozen in a long time previously. For
the photons, the temperature is related to the density by

  -- -------- -- ---------
     @xmath      (2.211)
  -- -------- -- ---------

which implies that the bulk temperature evolves by

  -- -------- -- ---------
     @xmath      (2.212)
  -- -------- -- ---------

by the definition of redshift.

Recombination occurred when the average temperature of the universe was
approximately @xmath – that is, when the average energy was of the order
of tenths of electron-volts [ 110 ] . The binding energy of hydrogen is
approximately @xmath ; however, sufficient energy remains in the tail of
the photon distribution to keep the universe ionised until the
temperature has dropped well below this amount. The CMB today is at a
temperature of about @xmath ; this then gives a recombination redshift
of about

  -- -------- -- ---------
     @xmath      (2.213)
  -- -------- -- ---------

With @xmath , it is clear that the CMB was formed well into the epoch of
matter domination.

It is likely that the existence of a magnetic field might alter the
recombination process, most likely to impede it. However, there has been
little study in this area.

#### 2.6.7 Late-Time Acceleration

If the universe should contain a source of effective vacuum energy, such
as a cosmological constant or some lingering remnant of a slowly-rolling
inflaton, then the matter-dominated era will give way to a second period
of vacuum domination. Observations of type Ia supernova, generally
regarded as standard candles ⁵ ⁵ 5 The use of Type Ia supernova as
standard candles is debated; possible alternative explanations include
dust extinction (see e.g. [ 131 ] for a study into this possibility),
and an evolution of Type Ia supernovae, perhaps with metallicity [ 132 ]
. , suggests that the universe did indeed begin to enter such an
accelerating phase at a redshift of approximately @xmath [ 104 ] . The
nature of this “dark energy”, and the coincidence that it has appeared
at the same broad time as humanity, is not yet understood. Suggestions
range from the relatively orthodox, such as “quintessence” models which
are effectively inflatons operating in the current universe [ 133 ] ,
through “k-essence” [ 134 ] , which are scalar fields with modified
kinetic terms, “Chaplygin gases” with inverse equations of state [ 135 ]
, and through to the more extreme, such as modifying our methods of
taking the averages employed in the Friedmann equation [ 136 ] , or
direct modifications to Einstein’s law of gravity [ 124 , 125 ] . Each
approach has a certain logic behind it and each has flaws and it is not
the purpose of this thesis to explore these. It should be noted,
however, that a straight cosmological constant – or, indeed, some field
mimicking a cosmological constant so closely as to be indistinguishable,
at which point Occam’s razor can probably be invoked – is an excellent
fit for the observed CMB and large-scale structure observations, as well
as the supernova observations.

A simple alternative that has reoccurred occasionally in the literature
is the existance of a bulk viscosity acting at zeroth order – see [ 137
, 138 , 139 , 140 , 141 , 142 ] for a few recent studies. If we assume
that the universe is dominated by a fluid with a bulk viscosity and
express the effective pressure ( 2.37 ) using real rather than conformal
time, we have that

  -- -------- -- ---------
     @xmath      (2.214)
  -- -------- -- ---------

Then we have the condition for acceleration

  -- -------- --
     @xmath   
  -- -------- --

Using the Friedmann equation, and working briefly in SI units, we can
then express this condition as

  -- -------- --
     @xmath   
  -- -------- --

for any particular epoch where @xmath is the relative density for the
viscous component. If we substitute the observed values for our current
epoch, assuming @xmath and @xmath , we find a numerical bound of

  -- -------- -- ---------
     @xmath      (2.215)
  -- -------- -- ---------

This is highly viscous and a fluid description for such a material is
perhaps not warranted, although glass does possess a higher bulk
viscosity. However, one may see directly from the expression for the
effective pressure (with @xmath ) that this fluid is unphysical:

  -- -------- -- ---------
     @xmath      (2.216)
  -- -------- -- ---------

shows that @xmath is of the order of @xmath . However, the
thermodynamics is valid [ 137 ] only for

  -- -------- -- ---------
     @xmath      (2.217)
  -- -------- -- ---------

Employing a bulk viscosity to entirely drive the current expansion of
the universe, while neat, is not valid on thermodynamical grounds. This,
of course, does not rule out the existence of a bulk viscosity
contributing to the observed acceleration without being the major cause.

### 2.7 The Cosmic Microwave Background

#### 2.7.1 The Sachs-Wolfe Equation

While a full treatment of photons is complex, insight into the structure
of the last-scattering surface can be found by formally integrating the
Boltzmann equation for a species of collisionless photons between the
surface of last scattering and the present day. The “surface of last
scattering” formed when the collisional term in the Boltzmann equation
became negligible and the photons began to free-stream. From the
collisionless Boltzmann equation we have

  -- -------- -- ---------
     @xmath      (2.218)
  -- -------- -- ---------

Formally integrating this between the surface of last scattering at a
conformal time @xmath and the present day at @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

This equation assumes an infinitesimal thickness of the surface of last
scattering.

Using again @xmath and truncating the Legendre expansion at @xmath , one
recovers the Sachs-Wolfe equation,

  -- -------- -- ---------
     @xmath      (2.219)
  -- -------- -- ---------

The separate contributions to this term are easily interpreted; the
photon density perturbation contributes the “intrinsic” temperature
perturbation on the surface of last scattering, while the @xmath term is
a Doppler-type effect caused by the red- or blue-shifting of photons
scattered from the surface. The integral term is a gravitational
contribution, more readily intuitive in the conformal Newtonian gauge in
a universe filled with perfect fluids, where one sees that it reduces
merely to the time-derivative of the gravitational potential. A photon
passing through a time-dependant potential well will obviously emerge
with a different energy; had the well deepened the light will be
redshifted and had the well shallowed the light would be blueshifted. In
a dust-dominated universe the gravitational potential is constant and
this term can be neglected. However, the same is not true in a universe
dominated by a dark energy and so the integrated term, known as the
integrated Sachs-Wolfe effect, is an important test of dark energy
theories. It is in the Doppler term that we expect the majority of the
impacts of a magnetic field on scalar and vector modes to be felt,
through velocity perturbations induced by the magnetic field. Tensor
modes might be expected to be dominated by the integrated Sachs-Wolfe
term.

Obviously, in reality we do not assume an infinitesimal surface of last
scattering. For practical purposes, CMB codes such as CMBFast, CMBEasy
and CAMB [ 67 , 86 , 143 ] tend to employ the RECFast recombination code
[ 129 , 130 ] . We now consider statistical measures of the CMB in
rather more detail.

#### 2.7.2 Statistical Measures on the Sky

From @xmath , where @xmath is here the ambient photon temperature,

  -- -------- --
     @xmath   
  -- -------- --

Since we observe these projected onto our celestial sphere, it makes
sense to expand the temperature perturbation across the spherical
harmonics as

  -- -------- --
     @xmath   
  -- -------- --

which, with the orthogonality of the spherical harmonics ( G.6 ), gives
the harmonic coefficients @xmath as

  -- -------- --
     @xmath   
  -- -------- --

Assuming the statistical map of the sky to be rotationally invariant
immediately leads to the definition of the expectation of multipole
moments as

  -- -------- -- ---------
     @xmath      (2.220)
  -- -------- -- ---------

@xmath is known as the angular power spectrum of the CMB.

The simplest statistical measure of the sky is the two-point correlation
function in two different photon directions @xmath and @xmath . For the
correlations of a map with itself, this is called the auto-correlation .
For temperature, the auto-correlation is

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      (2.221)
              @xmath               (2.222)
  -- -------- -------- -------- -- ---------

where we have used the relation between the Legendre polynomials and the
spherical harmonics ( G.7 ). Since the auto-correlation is linear, we
may separate @xmath or, equivalently, @xmath into the contributions from
scalar, vector and tensor perturbations of the brightness function.

#### 2.7.3 Temperature Auto-Correlation - Traditional Approach

##### Scalar

For purposes of clarity, and to demonstrate some results that will be
useful in the future, we present the derivations, in the traditional
Boltzmann approach, of the scalar, vector and tensor temperature
auto-correlations. For scalars,

  -- -------- --
     @xmath   
  -- -------- --

and so the temperature auto-correlation function is

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

Since the scalar hierarchy is independent of directions of @xmath , we
can set the expectation value of @xmath to be

  -- -------- -- ---------
     @xmath      (2.223)
  -- -------- -- ---------

where @xmath is the initial power spectrum of the fluctuations.
Substituting this into the auto-correlation function, expanding the
Legendres across the spherical harmonics and integrating over @xmath
gives us

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

which, employing the orthogonality of the spherical harmonics, leads
rapidly back to

  -- -------- --
     @xmath   
  -- -------- --

and hence

  -- -------- -- ---------
     @xmath      (2.224)
  -- -------- -- ---------

where we have rolled the prefactors into one term that can be normalised
to the results of COBE or WMAP.

From this expression we see the meaning of the terminology “transfer
functions” for @xmath ; these functions literally wrap the initial
conditions – here the scalar power spectrum – onto the microwave
background sky. In effect the transfer functions embody the physics of
the problem and, once found, we can determine the effect of any initial
state onto the microwave background sky. While in this traditional
approach the vector and tensor terms will not yield such a neat result,
it is part of the power of the line-of-sight approach that we can, in
fact, express each contribution to the @xmath s in the above form.

##### Vector

The standard contribution to the temperature shift in the CMB from
vector perturbations was

  -- -------- --
     @xmath   
  -- -------- --

Deriving the vector contribution to the temperature auto-correlation is
moderately unwieldy; here we merely summarise the steps and present the
full derivation in appendix C.1 .

Since the photon hierarchies are symmetric with respect to the change of
vector mode, we shall assume that the two are uncorrelated but similar –
that is,

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (2.225)
  -- -------- -------- -------- -- ---------

As in the scalar case, the independence of the evolution equations on
the direction of @xmath then allows us to define

  -- -- -- ---------
           (2.226)
  -- -- -- ---------

Substituting these and using

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

to remove the azimuthal angle @xmath , and then expanding the Legendre
polynomials over the spherical harmonics and integrating out ultimately
gives

  -- -------- -- ---------
     @xmath      (2.227)
  -- -------- -- ---------

Note that this differs dramatically from that presented by Crittenden
and Coulson because of the difference in the temperature vector that we
chose as part of our basis. To our knowledge this expression has not
appeared elsewhere.

##### Tensor

Assuming as with the vectors that the two tensor modes are uncorrelated
but similar, the temperature auto-correlation is

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

From here we may proceed in a manner entirely analogous to the approach
to the vector @xmath ; the derivation is presented in appendix C.2 .
@xmath is removed with the square of @xmath , which leads after
expansions and integrations to

  -- -------- -- ---------
     @xmath      (2.228)
  -- -------- -- ---------

where the scaled variables are

  -- -------- -- ---------
     @xmath      (2.229)
  -- -------- -- ---------

This agrees with the result of Crittenden et. al. [ 114 ] , although our
derivation is substantially different.

While it would in principle be possible to repeat this derivation for
the polarisation as derived from a traditional Boltzmann approach, to do
so is not particularly useful. We could either simply determine the
power spectra of the Stokes parameters @xmath and @xmath , the
interpretation of which necessitates the use of a small-angle
approximation due to the ambiguities induced by the rotational variance
of the parameters, or reconstruct the @xmath mode polarisation induced
by the scalar perturbations from the standard approach, but an attempt
to do the same with the vector and tensor perturbations leads to some
unpleasant and convoluted integrations and, on the whole, it is simpler
by far to rebuild the @xmath and @xmath modes from a line-of-sight
approach. We now finally turn to building the power spectra for this
approach.

#### 2.7.4 Angular Power Spectra from the Line-of-Sight Approach

##### Scalar Modes

Here we found that

  -- -------- -- ---------
     @xmath      (2.230)
  -- -------- -- ---------

Instead of aiming for the real-space auto-correlation function we can
derive the CMB angular power spectra from the (real-space) spherical
moments @xmath and reconstruct the relevant angular power spectra with

  -- -------- --
     @xmath   
  -- -------- --

where in the full generality @xmath (and, of course, here @xmath ).
Polarisation is introduced in appendix D . Setting ourselves at the
centre of the co-ordinate system (that is, @xmath ), we see that for the
temperature auto-correlation we have

  -- -------- -- ---------
     @xmath      (2.231)
  -- -------- -- ---------

With the usual definition of the scalar power spectrum @xmath , we can
then write the auto-correlation function of @xmath as

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

and then expand the exponential across the spherical harmonics and
spherical Bessel functions ( G.15 ) . Integrating over the directions of
@xmath reduces our expression to

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

which we can then convert to

  -- -------- -- ---------
     @xmath      (2.232)
  -- -------- -- ---------

and, by comparison with the earlier expression we can then identify

  -- -------- -- ---------
     @xmath      (2.233)
  -- -------- -- ---------

as the scalar contribution to the temperature transfer function – the
scalar contribution to the temperature moments, as we quoted earlier,
and

  -- -------- -- ---------
     @xmath      (2.234)
  -- -------- -- ---------

##### Vector Modes

We approach the vector modes in an analogous manner to the scalars.
Considering first the temperature case, we had

  -- -------- --
     @xmath   
  -- -------- --

The correlation of two multipole moments is then

  -- -------- --
     @xmath   
  -- -------- --

Integrating over the directions of @xmath and using the definition of
the spherical harmonics ( G.5 ) we can convert this to

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

But the integral over @xmath will yield a Kronecker delta,

  -- -------- --
     @xmath   
  -- -------- --

and so if we sum across the index @xmath , divide by @xmath and employ
the definition of the associated Legendre function ( G.2 ) we can find
that

  -- -- --
        
  -- -- --

We now notice that we can convert @xmath operating on the exponential
and so we can integrate this expression once by parts (neglecting a
boundary term that would affect the monopole) to leave us with

  -- -- --
        
  -- -- --

Expanding the exponential across the Legendre polynomials and spherical
Bessel functions and integrating over @xmath , we end up with

  -- -------- -- ---------
     @xmath      (2.235)
  -- -------- -- ---------

where we have also used

  -- -------- -- ---------
     @xmath      (2.236)
  -- -------- -- ---------

as can be shown by direct computation and substitution of the spherical
Bessel equation ( G.12 ). We can thus identify the temperature transfer
function from vector perturbations,

  -- -------- -- ---------
     @xmath      (2.237)
  -- -------- -- ---------

as was stated earlier, and

  -- -------- -- ---------
     @xmath      (2.238)
  -- -------- -- ---------

The derivation and presentation of the vector transfer function in the
line-of-sight approach is clearly enormously simplified compared to the
standard approach.

##### Tensor Modes

Deriving the tensor temperature transfer function is very analogous to
the vector case; here we had

  -- -------- --
     @xmath   
  -- -------- --

Following much the same process as for the vectors, we expand this
across the spherical harmonics, employ the statistical properties of the
variables @xmath , integrate over the directions of @xmath and express
the spherical harmonic in terms of an associated Legendre polynomial and
an exponential to give us

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
  -- -------- -- -------- --

Integrating over @xmath , summing over @xmath and dividing by @xmath
leads us to

  -- -- --
        
  -- -- --

The definition of the associated Legendre polynomial ( G.2 ) allows us
to write

  -- -- --
        
  -- -- --

We can then integrate twice over @xmath by parts (again neglecting
boundary terms), expand the exponential in terms of the Legendre
polynomials and Bessel functions, and then integrate out the dependence
on @xmath , which finally gives us

  -- -------- -------- -------- -------- ---------
     @xmath   @xmath                     (2.239)
                       @xmath   @xmath   
  -- -------- -------- -------- -------- ---------

using

  -- -------- -- ---------
     @xmath      (2.240)
  -- -------- -- ---------

From here we can immediately identify the tensor contribution to the
temperature transfer function,

  -- -------- -- ---------
     @xmath      (2.241)
  -- -------- -- ---------

and

  -- -------- -- ---------
     @xmath      (2.242)
  -- -------- -- ---------

We thus see (as we commented earlier) that there is a simple symmetry on
the temperature transfer functions for scalars, vectors and tensors; if
scalars have spin @xmath , vectors @xmath and tensors @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

This connection between spins is incorporated rigorously in the
spin-weighted approach to cosmological perturbation theory, explored in
detail in the spin-weighted formalism [ 119 , 144 , 145 ] .

As with the vector case, the simple transfer functions in this model, as
opposed to the traditional approach, are more than apparent. Moreover,
the transfer functions emphasise the split between the geometrical
properties embodied in the spherical Bessel functions, and the input
from the physics which is entirely encoded within the source terms.

#### 2.7.5 The CMB Angular Power Spectrum

It can be useful to derive crude approximations for the CMB
anisotropies, based on an instantaneous epoch of recombination. In this
case we take the visibility function @xmath .Then we have for scalar
perturbations

  -- -------- -------- -------- -------- ---------
     @xmath   @xmath   @xmath            (2.243)
                                @xmath   
  -- -------- -------- -------- -------- ---------

while for vectors we have

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      (2.244)
  -- -------- -------- -------- -- ---------

and for tensors

  -- -------- -------- -------- -- ---------
     @xmath   @xmath   @xmath      (2.245)
  -- -------- -------- -------- -- ---------

These instantaneous-recombination approximations simplify further when
one, for example, assumes a tightly-coupled limit throughout. In the
next section we shall employ only the scalar contributions to @xmath and
return to the vector and tensor contributions in sections § 5.3.4 and §
5.3.5 .

##### The Sachs-Wolfe Plateau

On very large scales in the matter dominated era, considering only
scalar perturbations, we have

  -- -------- --
     @xmath   
  -- -------- --

as the contribution from the @xmath term; the others are subdominant to
this. The integrated Sachs-Wolfe term has vanished. The angular power
spectrum of the CMB is then approximately

  -- -------- -- ---------
     @xmath      (2.246)
  -- -------- -- ---------

Assuming a spectral index

  -- -------- -- ---------
     @xmath      (2.247)
  -- -------- -- ---------

as is produced by many inflationary models, we then have

  -- -------- --
     @xmath   
  -- -------- --

This is a standard integral [ 146 ] and the result gives

  -- -------- -- ---------
     @xmath      (2.248)
  -- -------- -- ---------

This is called the Sachs-Wolfe plateau, and explains why a
Harrison-Zel’dovich spectral index is known as a scale-invariant
spectrum. Different initial conditions and different spectral indices
will obviously not produce a Sachs-Wolfe plateau. While the real
large-scale CMB sky is not entirely flat, this behaviour is observed to
a fair approximation by WMAP.

##### The Acoustic Peaks

The oscillations in the coupled photon-baryon fluid also leave their
imprint. With a phase of @xmath where @xmath , and with the density
perturbations going as the cosine, one may predict that the first
acoustic peak will be at @xmath – that is, large scales. However, modes
on these scales had yet to enter the horizon when the CMB formed and on
these scales we instead see the Sachs-Wolfe plateau. The next extremum,
technically a compression peak, will be at

  -- -------- -- ---------
     @xmath      (2.249)
  -- -------- -- ---------

and the separation between peaks is

  -- -------- -- ---------
     @xmath      (2.250)
  -- -------- -- ---------

This corresponds to a comoving wavelength

  -- -------- --
     @xmath   
  -- -------- --

We can map comoving separations onto angles at our own time and convert
angles approximately into multipole moments by

  -- -------- -- ---------
     @xmath      (2.251)
  -- -------- -- ---------

where

  -- -------- --
     @xmath   
  -- -------- --

is a function transferring the wavelength to an angle. This corresponds
in a flat universe with adiabatic initial conditions [ 145 ] to

  -- -------- -- ---------
     @xmath      (2.252)
  -- -------- -- ---------

and so the first acoustic peak is expected to be at around this
multipole number. Since different initial conditions affect the phase of
the perturbations, this separation remains constant regardless and is
chiefly a test of universal curvature; however, the absolute position of
peaks in multipole-space obviously varies.

Despite their name, these acoustic peaks are not actually Doppler peaks
since their extrema are at points when the velocity vanishes. The
extrema of the velocity perturbations act to level the acoustic peaks
somewhat.

##### The Full CMB Angular Power Spectrum

Figure 2.2 plots the scalar and tensor angular power spectrum predicted
by the “concordance model” of cosmology, with @xmath the total matter
energy density, @xmath the energy density in baryons, a flat universe
and a Hubble rate of @xmath . Initial conditions were generated by a
Harrison-Zel’dovich power spectrum with no running. Figure 2.3 plots the
scalar spectrum against the 1-year WMAP data [ 147 ] . One can clearly
see at the low end the “Sachs-Wolfe” plateau. The full theoretical
Sachs-Wolfe plateau rises slightly as one reaches the largest scales due
to an integrated Sachs-Wolfe effect from the cosmological constant. The
observed quadrupole (and, to a lesser extent, the octopole) [ 78 , 148 ]
is extraordinarily low, outside even the cosmic variance caused by our
limited sample. There are many attempts to justify this low quadrupole –
such as a sharp cut-off in the primordial power spectrum [ 149 , 150 ] ,
topologically finite universes [ 151 , 152 ] , foregrounds such as the
galactic plane [ 148 , 153 ] or a thermal Sunyaev-Zel’dovich effect [
154 ] or considered more generically [ 155 ] , correlated adiabatic and
isocurvature modes [ 156 , 157 ] or inflation powered by two inflatons [
158 ] – and the matter has been much studied, especially in connection
with curious alignments also found in the CMB [ 159 , 160 ] . It could,
however, be no more than a statistical artifact (e.g. [ 153 , 161 ] ).

Beyond the Sachs-Wolfe plateau is the first acoustic peak, at an @xmath
as predicted. Beyond this peak the amplitude of the waves dies away;
this is due to “Silk damping” [ 162 ] which is a small-scale
(non-linear) effect contributing a drag to the oscillation of the waves.
WMAP is cosmic-variance limited throughout the first acoustic peak and
other than a few glitches at the base and peak of the first acoustic
peak the agreement is superb. WMAP does not have good resolution much
beyond the base of the first peak; datasets covering this smaller-
@xmath region include those of CBI [ 80 ] , Boomerang [ 82 ] and ACBAR [
81 ] . Observations are consistent with the concordance model; however,
there seems to be a systematic increase of power on small scales.
Amongst many other possibilities, this could be at least partially due
to the effects of a magnetic field [ 49 , 53 , 61 ] .

## Chapter 3 Magnetised Cosmology

### 3.1 The Electromagnetic Field

In this chapter we consider the additions to the standard linearised
cosmology that a tangled primordial magnetic field will introduce. After
reducing more general expressions to a suitable cosmological
approximation we then consider in some detail the transferral of the
magnetic terms into Fourier space. We conclude with a brief review of
the damping of magnetohydrodynamical modes by photon shear viscosity.

While much of the material presented in this chapter is known, the
approach is entirely individual and the equations formulated more
generally than has previously been seen in the metric based approach.
Tsagas and Maartens [ 71 , 72 ] and Lewis [ 59 ] work within the
gauge-invariant and covariant formalism, and so in principle present a
greater generality and consider first the full non-linear equations
before truncating them to some expansion order. However, Lewis does not
consider the scalar perturbations and the work Tsagas and Maartens is
limited to a homogeneous field. Giovannini [ 6 ] works within a
metric-based approach and presents equations to a similar generality but
considers only scalar perturbations. For future ease we present
equations with the electromagnetic fields held to an arbitrary
perturbation order before linearising their effect; this will aid a
two-parameter perturbation approach.

#### 3.1.1 Field and Stress-Energy Tensors

In an inertial frame, the electromagnetic field tensor, or Faraday
tensor, can be defined by

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

is the 4-potential and @xmath and @xmath the scalar and vector
electromagnetic potentials respectively. The electric field @xmath and
magnetic field @xmath can be found from

  -- -------- -- -------
     @xmath      (3.1)
  -- -------- -- -------

where for the moment we are employing co-ordinate time. Since these are
in Minkowski space we have @xmath and @xmath . This gives the field
tensor in a matrix format as

  -- -------- -- -------
     @xmath      (3.2)
  -- -------- -- -------

Extending Jedamzik, Katalinić and Olinto [ 69 ] , we obtain the FLRW
form of this from the locally-Minkowski tensors above by transforming
from Minkowski space to a perturbed FLRW metric using ( 2.74 , 2.76 ).
This gives a field tensor

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

The electric and magnetic fields observed by a comoving observer with
@xmath can then be recovered [ 68 , 71 , 72 ] by

  -- -------- -- -------
     @xmath      (3.3)
  -- -------- -- -------

with corresponding covariant expressions. Note that we are actually
computing the electric field and magnetic field @xmath ; our use of the
magnetic induction in this case is habitual and the approximations we
shall soon apply make the field and induction vectors equal. @xmath is
the Levi-Civita tensor density for this space and @xmath the totally
anti-symmetric tensor density.

The co- and contra-variant forms of the electric and magnetic fields are

  -- -------- -------- -- -- -------
     @xmath   @xmath         (3.4)
     @xmath   @xmath         (3.5)
  -- -------- -------- -- -- -------

We shall work with the comoving vectors @xmath and @xmath , and it is
tacitly assumed that they contain these internal structures. However, it
is worth commenting that these forms for the electric and magnetic
fields are more general than those presented in [ 69 ] , for example. In
previous work, authors have employed the conformal equivalence of
Minkowski and Robertson-Walker magnetohydrodynamics [ 49 ] to map the
locally-observed Minkowski fields directly onto the Robertson-Walker
fields, that is @xmath , @xmath . This is sufficient for fields present
in the background but not for a perturbed Robertson-Walker metric, which
is no longer conformally Minkowski. The results found by [ 52 , 53 , 55
] are no less valid, since the fields are assumed small and the coupling
terms implicitly to be of order @xmath . The forms presented above,
however, should be employed if one wishes to consider fields of a
different order or, indeed, fields in a Robertson-Walker metric
perturbed to second order.

The stress-energy tensor of the magnetic fields is then given [ 68 , 96
] by

  -- -------- -- -------
     @xmath      (3.6)
  -- -------- -- -------

Noting, then, that

  -- -------- --
     @xmath   
  -- -------- --

one can construct the energy density, momentum flux and momentum flux
density of an electromagnetic field:

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (3.7)
     @xmath   @xmath   @xmath      (3.8)
     @xmath   @xmath   @xmath      (3.9)
  -- -------- -------- -------- -- -------

We have recovered the familiar energy density of an electromagnetic
field, the Poynting vector, and the electromagnetic stresses. The latter
separate into the isotropic pressure

  -- -------- -- --------
     @xmath      (3.10)
  -- -------- -- --------

which gives the expected equation of state @xmath , and the anisotropic
stress

  -- -------- -- --------
     @xmath      (3.11)
  -- -------- -- --------

#### 3.1.2 Maxwell Equations and Stress-Energy Conservation

The Einstein equations are not the only equations governing the
evolution of the electromagnetic field. One also has the Maxwell
equations, Ohm’s law and stress-energy conservation.

The electromagnetic 4-current is taken to be

  -- -------- -- --------
     @xmath      (3.12)
  -- -------- -- --------

where @xmath is the comoving charge density and @xmath the comoving
charge current density. This is a 4-current as observed in a frame
comoving with universal expansion. In a locally-Minkowski frame, one
would expect to observe a current @xmath . ¹ ¹ 1 This takes the opposite
sign to that one might naïvely expect since our velocity is defined with
reference to the comoving expansion rather than with reference to a
Minkowski observer.

The Maxwell equations are then

  -- -------- -- --------
     @xmath      (3.13)
  -- -------- -- --------

The skew-symmetry of the electromagnetic field tensor implies charge
conservation

  -- -------- -- --------
     @xmath      (3.14)
  -- -------- -- --------

The relativistic equivalent to the familiar Ohm’s law arises when one
projects the (invariant) 4-current into the observer’s 3-space and sets
this observed current proportional to the electric field viewed in this
frame [ 68 , 71 , 103 ] – that is

  -- -------- -- --------
     @xmath      (3.15)
  -- -------- -- --------

@xmath is the electrical conductivity.

One may rapidly demonstrate that the Maxwell equations in a synchronous
FLRW metric perturbed to first order, with electromagnetic fields held
to arbitrary order, are

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (3.16)
     @xmath   @xmath               
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

The requirement of charge continuity implies that

  -- -------- -- --------
     @xmath      (3.17)
  -- -------- -- --------

Interpreting this in the absence of metric perturbations, we see that
there is an effective “sink” of charge (as viewed by a comoving
observer) caused by the universal expansion – charge decays as @xmath .

The spatial part of Ohm’s law gives

  -- -------- -- --------
     @xmath      (3.18)
  -- -------- -- --------

which is the familiar Ohm’s law from electrodynamics. The temporal
component yields, to @xmath , @xmath which is merely the scalar product
of the standard Ohm’s law with the observer’s velocity.

Generalising the results of (for example) Jedamzik et. al. [ 69 ] to the
case of finite conductivity and a perturbed universe, the contributions
of electromagnetic fields to stress-energy conservation are

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            
                       @xmath            
              @xmath   @xmath            
                                         
     @xmath   @xmath   @xmath            (3.20)
                                @xmath   
                                @xmath   
                       @xmath   @xmath   
                                @xmath   
  -- -------- -------- -------- -------- --------

The first of these is the contribution an electromagnetic field will
make to the conducting fluid’s mass continuity; the field creates
fluctuations in the fluid’s current which then impacts on the matter
conservation. The second of these is the contribution the field makes to
the Euler equation (momentum conservation). Comparing with the form for
non-relativistic magnetohydrodynamics (e.g. [ 116 ] ) we can pick out
the important contributions to the Euler equation

  -- -------- -- --------
     @xmath      (3.21)
  -- -------- -- --------

which is the standard Lorentz force. All other terms in the Euler
contribution are couplings to the metric perturbations, representing the
scattering of the fields from the underlying geometry. This coupling is
readily apparent in covariant approaches to the problem (see for example
[ 68 , 71 , 72 , 87 ] ) in the full non-linear equations, where the
fields couple directly to the Weyl tensor.

#### 3.1.3 The Electromagnetic Field: Robertson-Walker and Bianchi
Cosmologies

The Robertson-Walker cosmology is a cosmology homogeneous and isotropic
about every event, at least to zeroth order, which forbids the addition
in the background of a directional field. The electromagnetic field
generally produces both an energy flux and a full anisotropic shear,
neither of which are compatible with a Robertson-Walker metric.

To maintain the standard cosmology, it is necessary to ensure that the
energy flux and anisotropic shear vanish at zeroth order in the
perturbation parameter @xmath . To retain the FLRW form we thus set the
electromagnetic fields to be “half-order”; that is, that we should set
@xmath . While this has the benefit of removing electromagnetic shear
from the bulk cosmology, it is restrictive for two main reasons: firstly
that a linearisation of the magnetic field employing the same parameter
will push the perturbed fields to one-and-a-half order and our field
will be correspondingly bland, and secondly that the scattering of the
fields from gravity is also pushed to one-and-a-half order. This
neglects many of the more interesting effects of a magnetic field, such
as the direct sourcing of tensor perturbations, and removes almost the
entire structure of MHD. (See [ 52 ] for some further discussion on this
matter.) It does, however, mean that the comoving fields in the
Robertson-Walker metric can now be identified with the Minkowski fields.

However restrictive in linear perturbation theory our approach may be,
it allows a great freedom in the exact form of the fields that one may
add. The modern approach in CMB physics is to employ a half-order
tangled stochastic magnetic field, (with or without a homogeneous
component) under the assumption that the initial spectrum is Gaussian
and the tangled component has one or more length scales (e.g. [ 49 , 51
, 52 , 53 , 55 , 61 ] ). The fields are usually assumed to be tangled on
cluster scales – implying no directionality on supercluster scales – and
the observed strength on such scales can be used to fix the amplitude of
the magnetic power spectrum.

The net effect of these assumptions, along with taking the limit of
infinite conductivity, is merely to add to the standard Euler equation a
Lorentz force. The magnetic field influences not only the temperature
maps for the CMB but also the polarisation – indeed, it is likely that
the effect on the temperature-temperature power spectrum will be
sub-dominant across most of the realistically observable range, and the
effects of a magnetic field might be observable primarily by its imprint
on the polarisation (e.g. [ 85 , 54 , 57 , 55 ] ) or perhaps its
non-Gaussianity [ 53 , 163 , 164 ] .

An alternative approach, while still remaining within the constraints of
a Robertson-Walker cosmology, would be to employ a two-parameter
linearisation approach, with a magnetic field too small to affect the
bulk cosmology linearised by a free parameter @xmath . One would neglect
terms of order @xmath but retain those of order @xmath A brief study of
two-parameter perturbation theory (in the context of but not restricted
to rotating, relativistic stars) is presented by Bruni et. al. [ 165 ]
and the referenced works therein.

Were one to drop the condition of isotropy and introduce a mildly
isotropic Bianchi cosmology rather than the maximally symmetric FLRW,
then one could instead employ a magnetic field that gives the universe a
preferred direction. It would also be possible to include the shear
viscosity of the baryons (and possibly also of the CDM) at zeroth order
which could potentially model a realistic fluid more than the perfect
fluid approximations. Indeed, the limits that Barrow, Ferreira and Silk
place on the strength of a bulk field [ 62 ] , based on the 4-year COBE
results, are derived by limiting the anisotropy introduced by a Bianchi
(type VII) model and attributing it entirely to a magnetic field. The
idea of imposing a preferred direction on the universe through an
ordered magnetic field, while certainly not original (research in
magnetised anisotropic cosmologies goes back to at least the late 60s;
see [ 38 , 39 , 40 ] and references therein) could correspond to Tegmark
et. al. ’s speculative explanation [ 159 ] for the low power observed in
the quadrupole by WMAP [ 78 , 166 ] resulting from a preferred
direction. It is also interesting to note that Tsagas and Maartens have
demonstrated [ 87 ] that, for a relatively weak field, the
Robertson-Walker approximation is equivalent at first order to a Bianchi
I approach.

### 3.2 Baryonic Matter: Cosmological Magnetohydrodynamics

#### 3.2.1 Real Space

We now consider a magnetised baryon fluid. In the presence of a magnetic
field, the mass continuity and Euler equations, retaining for generality
the pressure terms and including again the collisional term @xmath
transferring momentum between the baryons and the photons, become

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                          
                          
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

These are supplemented by the Maxwell equations ( 3.16 ), charge
continuity ( 3.17 ) and Ohm’s law ( 3.18 ).

Clearly these equations are not in an ideal form either for further
analytical study or for numerical implementation. Instead, we shall
follow the lead of [ 50 , 35 , 69 , 70 ] in rescaling the magnetic
fields to remove the Hubble terms in the Maxwell equations.

One may rapidly demonstrate that the Maxwell equations reduce (in the
absence of metric perturbations) to the form of classical
electrodynamics if one employs the scalings

  -- -------- -- --------
     @xmath      (3.22)
  -- -------- -- --------

with no scaling for the comoving co-ordinates (and hence none for @xmath
and @xmath ), the baryon velocity or the metric perturbation. These are
generally physically motivated; the electric and magnetic fields scale
with @xmath because their energy density must be that of radiation and
decay as @xmath . The charge and current densities, associated with
matter, are scaled by @xmath . The conductivity has dimensions of length
and so scales with @xmath .

With these new variables, the electrodynamical equations reduce to

  -- -- -- --------
           (3.23)
  -- -- -- --------

In the equations of cosmological MHD presented above, we see we should
then apply the scaling

  -- -------- -- --------
     @xmath      (3.24)
  -- -------- -- --------

to the mass density and pressure respectively. This scaling is not
performed to erase Hubble terms but instead to ensure that each term is
scaled by the same factor; our scalings were employed to reduce the
unperturbed cosmological Maxwell equations to the Minkowski form, rather
than remove the time-dependence of each variable. Consistency of scaling
then requires that the matter density and pressure are scaled as the
magnetic density and pressure are – as @xmath rather than as @xmath as
one would naïvely expect. (Subramanian and Barrow [ 70 ] present a more
formal and detailed analysis of the conformal relation between
magnetohydrodynamics in an unperturbed Robertson-Walker metric and in a
Minkowski metric.) Note also that

  -- -------- --
     @xmath   
  -- -------- --

which implies that

  -- -------- -- --------
     @xmath      (3.25)
  -- -------- -- --------

We also have

  -- -------- -- --------
     @xmath      (3.26)
  -- -------- -- --------

Employing these substitutions, the MHD equations quickly become

  -- -------- -- -- -------- --------
     @xmath                  (3.27)
                             
                    @xmath   
     @xmath                  (3.28)
                             
                    @xmath   
                    @xmath   
  -- -------- -- -- -------- --------

##### Linearisation

We expand around the FLRW background by setting

  -- -------- --
     @xmath   
  -- -------- --

The (dimensionless) perturbation to the density @xmath is naturally
unscaled. The comoving electric and magnetic fields can then be
identified with their Minkowski equivalents,

  -- -------- --
     @xmath   
  -- -------- --

and the contra- and co-variant components are equal. Neglecting all
powers of @xmath above unity and separating into background and
perturbation leads to the Maxwell equations

  -- -------- -- --------
     @xmath      (3.29)
  -- -------- -- --------

supplementing the magnetohydrodynamical equations

  -- -------- --
     @xmath   
  -- -------- --

in the background and

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath                     
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

at first order.

For baryonic matter we again set @xmath except where they multiply a
spatial derivative giving

  -- -------- -- --------
     @xmath      (3.30)
  -- -------- -- --------

and

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      (3.31)
     @xmath   @xmath   @xmath      (3.32)
  -- -------- -------- -------- -- --------

One can now clearly see that the only difference in the Euler equation
obeyed by the baryons with a magnetic field of this type, compared with
the standard cosmological picture ( 2.155 ), is the existence of the
Lorentz force @xmath . The greater structure of the interactions between
the magnetic fields, the geometry, and the perturbations is at a
higher-order. This complex structure gives rise to, for example, direct
coupling between the magnetic fields and the Weyl tensor ( [ 71 ] ) and
magnetic fields automatically sourced by second-order vorticity ( [ 31 ,
32 ] ). The vast bulk of cosmological MHD remains unexplored.

##### Early-Universe Approximations

It is usual to assume that the conductivity @xmath is extremely high
until after recombination (see for example [ 4 ] or the appendix of [ 17
] ); this loose statement may be quantified by considering the
dimensionless magnetic Reynolds number

  -- -------- -- --------
     @xmath      (3.33)
  -- -------- -- --------

where @xmath is the typical length-scale of the system. To a good
approximation, the universe possesses a low Reynold’s number for much of
its evolution. Using Ohm’s law, assuming a vanishing conductivity while
retaining a finite current density then removes the electric fields.
This is sometimes dubbed the magnetohydrodynamical limit. It is also
standard in MHD (see [ 116 ] ) to take the displacement current as
negligible for non-relativistic scenarios; the situation here is highly
non-relativistic, and so we shall also employ this approximation.

The equations now become

  -- -------- -- --------
     @xmath      (3.34)
  -- -------- -- --------

and so

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      (3.35)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

The total stress-energy tensor for these two fluids is

  -- -------- -- --------
     @xmath      (3.36)
     @xmath      (3.37)
     @xmath      (3.38)
  -- -------- -- --------

The scaled magnetic field @xmath is independent of time and so, if one
postulates a strength for the magnetic field in the present epoch and
normalises the scale factor so that @xmath , the present value can be
employed throughout. This assumes that the conductivity of the universe
remains negligible after recombination; while the conductivity is likely
to remain extraordinarily high, this is not going to be an entirely
valid assumption. Moreover, this assumption neglects any non-linear
effects on the magnetic field. In effect we have neglected the action of
both gravity and, indeed, magnetohydrodynamics, and any conclusions
based on the above model after recombination should be treated with
caution.

#### 3.2.2 Fourier Space

Even with our simplifying assumptions, the cosmological MHD equations
form a complicated set of equations; however, despite the non-linear
nature of the Lorentz force and the stress-energy tensor of the magnetic
fields, we shall find the system is rendered somewhat more tractable in
Fourier space.

Consider first the scaled Maxwell equations and conservation of charge,
which are linear and so will not be convolved. In Fourier space we see
that these are

  -- -------- -- --------
     @xmath      (3.39)
  -- -------- -- --------

where we have neglected the trivial equations. The magnetic
stress-energy tensor in real space has the isotropic and anisotropic
stresses

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

with a vanishing Poynting vector and the energy density equal to a third
of the isotropic stress. We employ @xmath to denote the scaled
stress-energy tensor. The isotropic pressure is transferred to Fourier
space by

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
              @xmath   @xmath   
              @xmath   @xmath   
  -- -------- -------- -------- --

which is the expected convolution. Note that the reality of the fields
in co-ordinate space requires @xmath . For the anisotropic stresses we
have

  -- -------- -- --------
     @xmath      (3.40)
  -- -------- -- --------

The scalar, vector and tensor parts are derived from this by applying
combinations of @xmath , @xmath , @xmath and @xmath as in equations (
2.1 ). We find

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            (3.41)
                       @xmath   @xmath   
                       @xmath   @xmath   
  -- -------- -------- -------- -------- --------

for the anisotropic pressure. For the magnetic vorticity we employ the
symmetrised vector projection which gives us

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            (3.43)
                       @xmath   @xmath   
                       @xmath   @xmath   
                                @xmath   
  -- -------- -------- -------- -------- --------

and the symmetrised tensor projection likewise gives us

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            (3.44)
                       @xmath   @xmath   
                                @xmath   
                                @xmath   
  -- -------- -------- -------- -------- --------

We shall study this stress-energy tensor in much greater detail in the
next chapter and content ourselves here with commenting that this
highly-nonlinear form will naturally introduce to the system a
significant measure of non-Gaussianity, even for a magnetic field which
is itself Gaussian in nature. It should also be commented that while our
simplified system will retain the Gaussianity of these fields the
preservation of Gaussianity of a magnetic field in general is not
necessarily to be expected.

Turning now to the Lorentz forces, in co-ordinate space we had that

  -- -------- --
     @xmath   
  -- -------- --

for the infinitely conductive universe. Following the same process to
push this into Fourier space, we have

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            (3.45)
                       @xmath   @xmath   
                       @xmath   @xmath   
  -- -------- -------- -------- -------- --------

where we have used @xmath . Employing

  -- -------- -- --------
     @xmath      (3.46)
  -- -------- -- --------

we can write

  -- -------- -- --------
     @xmath      (3.47)
  -- -------- -- --------

where we have also used Maxwell’s third equation, @xmath . If we now use
the freedom we have in our integration wavemode to write @xmath then
@xmath and the Lorentz force becomes the simple

  -- -------- -- --------
     @xmath      (3.48)
  -- -------- -- --------

where again we have used Maxwell’s third equation. We can now split this
into a scalar part,

  -- -------- --
     @xmath   
  -- -------- --

which, comparing with the scalar pressures is

  -- -------- -- --------
     @xmath      (3.49)
  -- -------- -- --------

and an (unsymmetrised) vector part

  -- -- --
        
  -- -- --

which is readily seen to be

  -- -------- -- --------
     @xmath      (3.50)
  -- -------- -- --------

That is, the scalar contribution to the Lorentz force is directly
proportional to the difference of the iso- and aniso-tropic pressures,
while the vortical contribution to the Lorentz force is directly
proportional to the magnetic vorticity itself, when seen in Fourier
space.

Considering the full baryon fluid, then, aligning the co-ordinate axes
along the Fourier mode and employing the vector and tensor bases defined
in § 2.3.2 results in the stress-energy tensor

  -- -------- -- --------
     @xmath      (3.51)
  -- -------- -- --------

in the background and

  -- -------- -------- -------- -- --------
     @xmath            @xmath      
     @xmath            @xmath      (3.52)
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

The equation of mass continuity becomes

  -- -------- -- --------
     @xmath      (3.53)
  -- -------- -- --------

The scalar component of the Euler equation is

  -- -------- -- --------
     @xmath      (3.54)
  -- -------- -- --------

and the vector component is

  -- -------- -- --------
     @xmath      (3.55)
  -- -------- -- --------

This then completes the system of equations that one would need to
include in a Boltzmann integrator – CMBFast [ 76 ] would be ideal due to
its use of synchronous gauge – to include a primordial magnetic field
along with a standard cosmology.

### 3.3 Damping of Cosmological Magnetic Fields

In this section we shall review the pertinent results of [ 35 , 52 , 55
, 69 , 70 ] governing the scales at which magnetohydrodynamical modes in
the universe are damped by viscous processes. This scale, @xmath , it
should be emphasised, is distinct from an inherent magnetic damping
scale arising from some particular magnetogenesis model, being viscous
in origin and arising from the shear drag imposed on the baryons by the
photon fluid. The primordial damping scale is likely to be very small
and constant, while the viscous damping scale will be somewhat larger
and time-dependent. The effective damping scale of the magnetic field
will then be

  -- -------- -- --------
     @xmath      (3.56)
  -- -------- -- --------

At some epoch, therefore, the effective magnetic damping scale will
become time-dependent.

Mode damping is a small-scale effect of the photon (or neutrino) viscous
drag on the coupled photon-baryon fluid; to analyse it we return to real
space and, for ease of mathematics, linearise the magnetic field around
an ordered background with

  -- -------- --
     @xmath   
  -- -------- --

We employ a shear viscosity to model the photon viscosity (see appendix
B ), impose infinite conductivity and, since we are working on scales
much less than the Hubble scale, neglect @xmath . We have the system of
equations

  -- -------- -- --------
     @xmath      (3.57)
     @xmath      (3.58)
     @xmath      (3.59)
  -- -------- -- --------

We may then derive a wave equation for @xmath ,

  -- -------- -- --------
     @xmath      (3.60)
  -- -------- -- --------

We have defined the Alfvén velocity

  -- -------- -- --------
     @xmath      (3.61)
  -- -------- -- --------

In Fourier space this becomes

  -- -------- -- -- -------- --------
     @xmath                  (3.62)
                             
                    @xmath   
  -- -------- -- -- -------- --------

We align the magnetic field with the @xmath -axis and define @xmath and
@xmath . Then we can consider various perturbation modes:

-   Incompressible waves: Alfvén Waves

    If we take @xmath then by the continuity equation we are considering
    perturbations that do not support density perturbations. In the wave
    equation, we then see that

      -- -------- -- --------
         @xmath      (3.63)
      -- -------- -- --------

    These waves will then oscillate when @xmath , and will overdamp when
    @xmath . For photons, we have the shear viscosity [ 70 ]

      -- -------- -- --------
         @xmath      (3.64)
      -- -------- -- --------

    where @xmath is the temperature and @xmath the mean photon diffusion
    length. From here it can be shown that the ratio of the friction
    term to the natural frequency is approximately

      -- -------- -- --------
         @xmath      (3.65)
      -- -------- -- --------

    where @xmath is the background field in units of nano-Gauss. Many
    modes will thus be overdamped. Of the two solutions of a heavily
    damped oscillator we expect one, with a large initial velocity, to
    damp rapidly, and another with a small initial velocity to
    effectively freeze. It is this second mode that will survive Silk
    damping.

-   Magnetosonic Waves

    Consider now the compressible waves; defining @xmath and taking
    inner products of the wave equation with first @xmath and then
    @xmath we can find the two equations

      -- -------- -------- -------- -- --------
         @xmath   @xmath   @xmath      (3.66)
         @xmath                        (3.67)
      -- -------- -------- -------- -- --------

    Taking a mode parallel to the magnetic field ( @xmath ) gives

      -- -------- -- --------
         @xmath      (3.68)
      -- -------- -- --------

    which is a standard, Silk-damped, sound wave. If we consider a
    wavevector perpendicular to the magnetic field, @xmath , we instead
    find

      -- -------- -- --------
         @xmath      (3.69)
      -- -------- -- --------

    which is a damped fast magnetosonic wave. This damps in the same way
    as a standard sound wave.

    Finally if we consider a wavevector tilted with respect to the
    field, @xmath , we have a slow magnetosonic wave. Subramanian and
    Barrow showed that this behaves approximately as the Alfvén waves,
    though the analysis is slightly more involved. A different approach
    with the same conclusions was presented in [ 69 ] .

To briefly summarise, then, we have seen that, during the
tightly-coupled epoch, fast magnetosonic waves sourced by a magnetic
field will damp as sound waves, while one mode apiece of the slow
magnetosonic waves and Alfvén waves will become strongly overdamped and
freeze, thus surviving Silk damping.

Free-streaming occurs when the mean free path of the photon @xmath grows
larger than the wavelength of a given mode. At decoupling this is around
@xmath Mpc, and after recombination all of the modes will freely stream.
Accurate evaluation of modes in the free-streaming régime requires a
full treatment of the photon and baryon fluids; however, Subramanian and
Barrow provide an approximate treatment, considering the Euler equation

  -- -------- -- --------
     @xmath      (3.70)
  -- -------- -- --------

where @xmath is the gravitational potential from Poisson’s equation. We
then have two chief régimes, one in which the magnetic pressure
dominates over the baryon pressure, and the opposite. When the baryon
pressure dominates, one may derive an evolution equation for the
velocity

  -- -------- -- --------
     @xmath      (3.71)
  -- -------- -- --------

The Hubble damping will be much smaller than the viscous damping and so
the ratio between the damping and natural frequency is

  -- -------- -- --------
     @xmath      (3.72)
  -- -------- -- --------

which, given that we are free-streaming and @xmath , and that we are
considering particularly weak fields, is strongly overdamped.

Employing a “terminal-velocity” approximation for the low-amplitude mode
which is effectively frozen – that is, neglecting the acceleration – one
can find rough solutions to the equations. In this régime the solution
is rapidly

  -- -------- -- --------
     @xmath      (3.73)
  -- -------- -- --------

where we have swapped the integral to co-ordinate time for neatness.
This allows us to identify the damping scale

  -- -------- -- --------
     @xmath      (3.74)
  -- -------- -- --------

This is at a minimum at recombination, and evaluated at recombination
and comparing with the Silk scale we have

  -- -------- -- --------
     @xmath      (3.75)
  -- -------- -- --------

The analysis in the case of a stronger field is more complicated and
unlikely to be necessary given the relative weakness of the primordial
cosmological field.

In general we will take the damping scale to be approximately

  -- -------- -- --------
     @xmath      (3.76)
  -- -------- -- --------

where @xmath is the photon diffusion length. The Alfvén modes that
survived Silk damping will be converted into fast and slow magnetosonic
waves. The damping scales are similar to that above for fast waves,
while for slow waves the baryon speed of sound dominates over the Alfvén
velocity. The time-dependence of the viscous damping scale arises from
the photon diffusion length; for the more complicated case of a tangled
field configuration, addressed in chapter 5 , the Alfvén velocity is
also time-dependent.

For further discussion on damping scales see appendix A of [ 23 ] .

### 3.4 Conclusions

We have presented, in a synchronous gauge, the sources and Lorentz
forces arising from a magnetic field of arbitrary size and type. We have
then reduced the resulting system to a realistically tractable
approximation reminiscent of standard MHD and found that the only
difference between a magnetised and a standard cosmology at linear order
is the existence of a Lorentz force. This Lorentz force is proportional
to the stresses when viewed in Fourier space. This system is in an ideal
form to transfer to some Boltzmann code; our motivation is to construct
a formalism suitable for CMBFast, although we could also employ CMBEasy
[ 143 ] . We also briefly considered the damping scales relevent to the
problem, working in an altered formalism with a large-scale homogeneous
field and a small perturbation to address issues that are otherwise only
present in second-order magnetised theories. We derived the form of the
viscous damping scale that will determine both the scale on which Alfvén
and slow magnetosonic perturbations are cut-off, and also the scale on
which the magnetic field will ultimately damp.

## Chapter 4 Statistics of Cosmic Magnetic Sources

### 4.1 Tangled Magnetic Fields

In this chapter we consider in detail the nature and statistics of the
magnetic sources through a combination of simulated realisations and
analytical study. Both have advantages and disadvantages; the simulated
fields can be vastly more general but are limited in dynamic range and
computational power, while the analytic fields are heavily restricted by
mathematical limitations. In line with the modern treatment, we do not
assume that the magnetic field is a large-scale, ordered field with a
small arbitrary perturbation, but instead consider entirely
inhomogeneous fields tangled on some length scale (see for example Mack
et. al. [ 55 ] ). For simplicity (and to compare with the previous
literature), we assume that the magnetic fields are random variables
obeying a Gaussian probability distribution function; however, our
realisations may be formulated more generally than this. It should
however surprise no-one that a non-Gaussian magnetic field generates a
non-Gaussian stress-energy, and so the Gaussian case is likely to be the
most intuitively informative. Analytically we are currently restricted
to Gaussian fields. From equation ( 3.16 ), @xmath ; we will be
modelling the time-independent scaled field @xmath . The only
time-dependence then arises from the damping scale. Since this will be
associated with the grid-size of the realisations this is not here an
issue, though it may need to be addressed when we come to wrap our
statistics onto the CMB – for some configurations this will lead to
time-dependent stresses, thus introducing decoherence into the sourced
perturbations.

Magnetic fields, being a non-linear source with a full anisotropic
stress, naturally provide sources for scalar, vector and tensor
perturbations. For scalar perturbations one does not expect a
significant effect on large scales. However, the contribution to the
temperature auto-correlation on the microwave sky can begin to dominate
at an @xmath of @xmath depending on spectral index (see §§ 5.4.1 , 5.4.2
or [ 53 , 59 , 61 ] ). This effect comes both from the impact of the
magnetic energy and anisotropic pressure directly onto the spacetime
geometry and from the Lorentz forces imparted onto the coupled
proton-electron fluid. One also expects a significant impact on the
vector perturbations as compared to the standard picture since the
magnetic fields will both directly generate vector perturbations in the
spacetime and contribute vortical Lorentz forces. Prior to neutrino
decoupling a primordial magnetic field acts as a source for
gravitational waves; following neutrino decoupling there will also be a
contribution from the neutrinos, which Lewis has shown serves to cancel
much of the magnetic stress [ 59 ] . Since the Lorentz forces and the
stress-energy tensor are both quadratic in the magnetic field, we also
expect a level of non-Gaussianity to be imprinted onto the fluid and
perturbations, even for a magnetic field that is itself Gaussian.

The features of the magnetic field – the Lorentz forces and the direct
sourcing of geometric fluctuations – are all contained within the
stress-energy tensor. We can then consider the statistics of the
stress-energy tensor alone and be hopeful of characterising the majority
of the non-Gaussian effects that might impact on the CMB. The
non-Gaussianity predicted from our analysis and our simulations can be
projected onto the CMB sky by folding them with the transfer functions
generated by the modified CAMB code [ 59 , 67 ] or a modification of
CMBFast [ 51 , 61 , 76 ] . The great benefit of our formalism derived in
the previous chapter is the ease with which we may implement it into
CMBFast. Care would have to be taken, however, with the initial
conditions – see Lewis [ 59 ] and Giovannini [ 60 ] . In principle, the
@xmath -mode polarisation will give the purest magnetic signal, being
sourced purely by vector and tensor perturbations; however, care would
have to be taken to disentangle these from any @xmath -modes caused by
the gravitational lensing of the dominant @xmath -mode and from other
early-universe sources of gravitational wave. ¹ ¹ 1 Magnetic fields will
also cause Faraday rotation from @xmath modes into @xmath modes [ 45 ,
46 , 41 , 85 ] ; support for scalar modes in a uniform magnetic field
was added to CMBFast by [ 46 ] and also to CMBFast for tangled fields by
[ 41 ] , both in the case of small rotations. Nonetheless, even on the
@xmath -mode the contaminants will be myriad. The inherently
non-Gaussian nature of the sources, both gravitational and the Lorentz
forces, offers an alternative route to characterising the nature of a
primordial magnetic field.

We shall concentrate our study of the statistics on the space-space part
of the magnetic stress-energy tensor, the stresses, since the magnetic
energy density is proportional to the isotropic pressure, and in our
cosmological setting the Poynting vector vanishes. The Lorentz forces
are directly proportional to components of the stress-energy; loosely
speaking, their properties can be found by applying prefactors of the
wavemodes to the stress-energy results.

The (scaled) stress-energy tensor can be written

  -- -------- -- -------
     @xmath      (4.1)
  -- -------- -- -------

where

  -- -------- --
     @xmath   
  -- -------- --

This chapter of the thesis is derived from work by myself and Robert
Crittenden [ 163 ] .

#### 4.1.1 Underlying Statistics of the Fields

We begin by specifying the underlying statistics of the tangled magnetic
fields. In Fourier space, Maxwell’s second law implies that

  -- -------- -- -------
     @xmath      (4.2)
  -- -------- -- -------

where @xmath is the magnetic field power spectrum, @xmath is the
operator projecting vectors and tensors onto a plane orthogonal to
@xmath and @xmath ,

  -- -------- -- -------
     @xmath      (4.3)
  -- -------- -- -------

and @xmath is the power spectrum of the anti-symmetric helical term (see
for example [ 56 , 167 , 168 ] .) Here we have assumed the fields are
statistically isotropic and homogeneous. If the magnetic fields are
Gaussianly distributed, then all their statistics are determined by
their power spectrum. In the interests of simplicity we henceforth
assume that the helical component of the field vanishes; however we
should note that helicity may well be a generic feature of magnetic
fields generated in the very early universe (e.g. the non-conservation
of helicity during the lepton stage of the universe [ 169 ] and from the
magnetic-axion coupling [ 170 ] ).

The power spectrum is often taken to be a simple power law,

  -- -------- -- -------
     @xmath      (4.4)
  -- -------- -- -------

To avoid divergences, these power law spectra are generally assumed to
have some small scale cutoff usually associated with the photon
viscosity damping scale; see § 3.3 and [ 49 , 55 , 69 ] . Durrer and
Caprini [ 23 , 171 ] demonstrate that, for a causally-generated magnetic
field, the spectral index must be @xmath ; it must also in any event be
@xmath to avoid over-production of long-range coherent fields. They also
demonstrate that nucleosynthesis limits on the gravitational waves
produced by the magnetic fields place extremely strong bounds on
magnetic fields, to the level of @xmath G for inflation-produced fields
with @xmath , although this has been contested (see § 5.2.2 ). For
spectra that might realistically imprint on the microwave background we
must consider spectra with @xmath , which are much less tightly
constrained. For purposes of comparison we shall usually take either
@xmath for a flat spectrum – where “flat” refers to the spectrum of
primordial magnetic fields themselves – in which each mode contributes
equally, or @xmath for a spectrum nearing the “realistically observable”
@xmath , which we shall refer to as “steep”. Such fields can be produced
by inflation (for example, [ 21 , 172 ] ).

It is worth emphasising that, while we generally restrict ourselves to
power-law spectra, this is not a necessity. For the analytical results
we will numerically integrate the formulae rather than attempt
approximations, while for our realisations the form of the power
spectrum can be entirely arbitrary; in both cases it is as easy to
employ a non-power law spectrum as it is a power-law. It is also a
simple matter to employ a non-sharp damping scale – we could, for
example, employ an exponentially or Gaussian-damped tail for greater
freedom in modelling the effective microphysics. We do not explore such
spectra much, but we do present some few results for an
exponentially-damped causal field, qualitatively similar to the spectrum
derived by Matarrese et. al. [ 31 ] for a field sourced by second-order
vorticity in the electron-baryon plasma (see also [ 30 , 31 , 32 , 33 ]
.) However, the results presented should not be taken to be much more
than indicative of the potential nature of such a field; fields produced
by the product of two Gaussian variables will possess a @xmath
probability distribution function, while our results are for a Gaussian
field. Moreover, the dynamic range presented in the simulations is
significantly shorter for our results than should be for that type of
field. The formalism we are employing will also not apply to such a
field – not least due to its time-dependence – and their amplitude is
very small. Similarly fields sourced at recombination [ 16 ] or
reionisation [ 13 ] , for example, arise at a very small scale. The
question of the statistical nature of both recombination and very early
universe fields has not been well explored in the literature. Here we
present results from a Gaussian field as an illustrative example; any
conclusions about the non-Gaussian signatures of magnetic fields will
depend sensitively on this assumption, and we plan to explore more
general scenarios in future work.

The normalisation of a magnetic power spectrum is typically fixed by
reference to a particular comoving smoothing scale @xmath and the
variance of the field strength at this scale, @xmath . Specifically, we
smooth the field by convolving it with the Gaussian filter

  -- -------- -- -------
     @xmath      (4.5)
  -- -------- -- -------

and define the variance of the field strength at the scale @xmath by

  -- -------- -- -------
     @xmath      (4.6)
  -- -------- -- -------

implying that the power spectrum and @xmath are related by

  -- -------- -- -------
     @xmath      (4.7)
  -- -------- -- -------

This allows us to relate the astronomically observed field strengths at,
say, cluster scales, to the amplitude of the magnetic power spectrum. We
shall sometimes write

  -- -------- -- -------
     @xmath      (4.8)
  -- -------- -- -------

#### 4.1.2 Realisations of Magnetic Fields

To aid our study of the non-Gaussian properties of tangled magnetic
fields, we create static realisations of the fields numerically. The
great advantage of doing so is that we are not bound by analytic
difficulties; for example, while we can derive analytical forms for the
power and bispectra for Gaussian fields it is not clear how we should
approach the integrations for non-Gaussian fields. Realisations do not
have this limitation. We create the fields on a grid in Fourier space of
size @xmath , where @xmath is typically 100-200. Since the fields are
solenoidal we can generate the three magnetic field components for each
@xmath -mode using two complex Gaussian uncorrelated random fields with
unit variance,

  -- -------- --
     @xmath   
  -- -------- --

We then determine the magnetic field Fourier components by applying a
rotation matrix,

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is a @xmath matrix. From the definition of the magnetic
field power spectrum, we see that to get the proper statistical
properties, we require

  -- -------- --
     @xmath   
  -- -------- --

While this does not specify the rotation matrix uniquely, it is
straightforward to show that choosing the rotation matrix as

  -- -------- -- -------
     @xmath      (4.9)
  -- -------- -- -------

will produce fields with the correct statistical properties. This
rotation is well defined except in the case when @xmath Here, @xmath and
the other components are uncorrelated, so we instead choose

  -- -------- -- --------
     @xmath      (4.10)
  -- -------- -- --------

The reality of the fields is ensured by requiring @xmath .

Throughout, we are careful to avoid creating modes with frequencies
higher than the Nyquist frequency of the grid, which could be aliased
into power on other frequencies; this frequency is half the grid
frequency. Since the quantity of greatest interest, the stress-energy,
is a quadratic function of the fields, it will typically have power up
to twice the cutoff frequency of the magnetic fields. To avoid aliasing
these fields, we generally require that the magnetic field cutoff
frequency be less than half the Nyquist frequency. We also have an
infra-red cut-off which is the inevitable result of working on a finite
grid. For steeply-red spectra the natural suppression at small-scales
will allow us to expand our dynamic range up to @xmath .

Figure 4.1 shows a sample Gaussian realisation of one component of the
magnetic field along a slice through the realisation, as well as the
resulting trace and traceless components of the stress-energy (the
isotropic and anisotropic pressures). Both the isotropic and anisotropic
pressures show power on smaller scales than the fields themselves, a
direct result of their non-linearity. In addition, the isotropic
pressure is darker, reflecting a paucity of positive fluctuations and a
significant deviation from Gaussianity. The anisotropic pressure appears
to be more similar to the magnetic field – that is, relatively Gaussian.
These observations will be made concrete in the next section when we
consider the one-point statistics of the pressures.

### 4.2 One-Point Moments

There are many ways to characterise non-Gaussianity, particularly given
such a strongly non-linear stress-energy term. In this section we
briefly consider the skewness and kurtosis of the one-point probability
distributions of the isotropic and anisotropic pressures. In this
section the results we present are the mean of twenty realisations with
a grid-size of @xmath , and the errors quoted are one standard
deviation.

The simplest to consider is the distribution of the trace part, since it
is simply the square of the magnetic field. Despite the divergence-free
condition, the three components of the magnetic field at a single point
in space are uncorrelated and Gaussian. The product of @xmath Gaussian
fields is a @xmath distribution with @xmath degrees of freedom, and so
we expect the trace of the stress-energy to have a @xmath distribution
with three degrees of freedom.

All the moments of a one-point distribution may be given by its moment
generating function as

  -- -------- -- --------
     @xmath      (4.11)
  -- -------- -- --------

where, for a @xmath distribution with @xmath degrees of freedom

  -- -------- -- --------
     @xmath      (4.12)
  -- -------- -- --------

The central moments are then readily calculated and the normalised
skewness and kurtosis are defined to be

  -- -------- -- --------
     @xmath      (4.13)
  -- -------- -- --------

We quickly find that, for the @xmath distribution, the normalised
skewness and kurtosis are

  -- -------- -- --------
     @xmath      (4.14)
  -- -------- -- --------

where the numerical results are for a distribution with @xmath degrees
of freedom. The results from the realisations can be seen to be in
agreement with the predictions; with a flat spectrum we find that, for
the isotropic pressure, @xmath and @xmath . For a more realistically
observable field, with a power spectrum of @xmath , say, we find @xmath
and @xmath . It is apparent that the statistics for the isotropic
pressure are, as expected, relatively insensitive to the spectral index
one employs.

The anisotropic stress is harder to characterise because it is not a
local function of the fields, but contains derivatives of them. However,
it is effectively the sum of the products of two Gaussian fields which
are, for the most part, independent of each other. The distribution of
the product of two independent Gaussians is non-Gaussian but is
symmetric (actually following a modified Bessel distribution, as shown
in the appendix of [ 173 ] .) Thus the effect of adding such terms is to
dilute the skewness. That is, while the isotropic stress is the sum of
three very skewed @xmath variables, the anisotropic stress is the sum of
@xmath terms and symmetric modified Bessels, making the result less
skewed.

The probability distributions of the isotropic and anisotropic stresses
for a flat spectrum are plotted in the left-hand panel of figure 4.2
along with a Gaussian and a @xmath distribution. The damping scale we
employed was @xmath – i.e. just beneath half the Nyquist frequency. For
the steep magnetic spectra, plotted in the right-hand panel, we again
used twenty realisations and a grid-spacing of @xmath but with a damping
scale at the size of the grid to ensure a reasonable mode coverage in
the low- @xmath régime. The anisotropic pressure distribution has quite
different properties when the spectral index is changed, including a
switch in sign of the skewness. For the flat spectrum we find @xmath and
@xmath , while with a steep spectrum with a power spectrum of @xmath ,
we find @xmath and @xmath . The distributions are plotted in the
right-hand side of the figure, again with a sample Gaussian, and the
change in the skewness is readily apparent.

### 4.3 Two-Point Moments

We next calculate the two point power spectra of the various
perturbation types. These give a useful example of how the higher order
calculations will proceed and provide a means of testing our
realisations. Some of these have been previously calculated, such as the
vector [ 55 ] and tensor [ 23 , 52 , 55 ] power spectra, while the trace
and traceless scalar auto-correlations and their cross correlation, to
our knowledge, were first presented in our publication [ 163 ] .

By the nature of the scalar-vector-tensor decomposition, we do not
expect any cross correlations except between the trace and traceless
scalar pieces. Thus, we consider five power spectra: one cross spectrum
and the auto-spectra of the four pieces of the stress-energy. We focus
on constructing rotationally invariant spectra which will contain all
the information in the general correlations.

In general, the power spectra will involve expectations of four magnetic
fields. Since these are assumed to be Gaussian, they can be evaluated
using Wick’s theorem which, for four Gaussian fields, may be expressed
as

  -- -- --
        
  -- -- --

It is most useful to begin with the general two point correlation,

  -- --------------- -- -------- --
     @xmath @xmath               
                                 
                        @xmath   
  -- --------------- -- -------- --

with indices @xmath running from 1 to 3. Note that there are two terms
rather than three since we are interested in the perturbations from the
mean value of the field. The power spectra of the various stresses may
be obtained from this by applying an operator @xmath formed from the
relevant combinations of the projection operators ( 2.1 ) to yield

  -- -------- -- --------
     @xmath      (4.16)
  -- -------- -- --------

with @xmath and @xmath denoting the two stress components and @xmath
denoting the relevant angular integrand. The relevant angles possible
between the wavevectors have been defined as

  -- -------- -- --------
     @xmath      (4.17)
  -- -------- -- --------

where @xmath denotes the unit vector in the direction of @xmath .

The trace-trace correlation is found by applying the operator @xmath
whence we obtain

  -- -------- -- --------
     @xmath      (4.18)
  -- -------- -- --------

Similarly, we obtain the traceless scalar auto-correlation function by
applying
@xmath ; some algebra yields the result

  -- -------- -- --------
     @xmath      (4.19)
  -- -------- -- --------

The cross correlation between the trace and traceless scalar pieces
requires the operator
@xmath . This gives

  -- -------- -- --------
     @xmath      (4.20)
  -- -------- -- --------

For the vector and tensor contributions, it is useful to construct
rotationally invariant combinations that can be relatively easily mapped
onto the CMB. The divergenceless condition on the vectors implies that
their correlation function can be written as

  -- -------- -- --------
     @xmath      (4.21)
  -- -------- -- --------

where our definition differs by a factor of two from [ 55 ] . All the
information is condensed in the rotationally invariant vector isotropic
spectrum @xmath The operator necessary to recover this is

  -- -------- -- --------
     @xmath      (4.22)
  -- -------- -- --------

The resulting angular term can then be shown to be

  -- -------- -- --------
     @xmath      (4.23)
  -- -------- -- --------

Similar arguments apply for the tensor correlations. The full tensor
two-point correlation is

  -- -------- -- --------
     @xmath      (4.24)
  -- -------- -- --------

where @xmath which, as can be readily shown, satisfies the
transverse-traceless condition on the tensors, and @xmath . We focus on
the rotationally invariant tensor isotropic spectrum @xmath . Using the
tensor projection operators and simplifying, the relevant operator is

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
              @xmath   @xmath   
  -- -------- -------- -------- --

This leads to a simple angular term of

  -- -------- -- --------
     @xmath      (4.25)
  -- -------- -- --------

The vector and tensor results differ from those otherwise presented [ 23
, 52 , 55 ] by @xmath . It is straightforward, however, to see that if
one redefines the integration wavemode as @xmath then one maps @xmath .
On integration, then, the product @xmath is invariant while @xmath may
be taken to vanish. Our results are thus in agreement with those
previously presented.

We can compare numerical integrations of these power spectra with the
results arising from the realised magnetic fields. Our results for a
flat power spectrum ( @xmath ) are presented in figure 4.3 where @xmath
denotes the various spectra (all presented on the same scale). The
agreement between the analytic results (lines) and a simulated field
(data points) is striking. We have plotted the power spectra averaged
over twenty realisations with a grid-size of @xmath , a damping scale at
@xmath . We evaluated the 1- @xmath error at each point but have not
plotted it as it is negligible for all but the lowest modes.

We could also consider magnetic fields with @xmath corresponding to
causally-generated fields [ 23 ] ; the features for such fields are
qualitatively similar to those for a flat spectra and there are no
difficulties in evaluating the theoretical predictions in this régime.
We present a few results for a causal field damped to avoid piling power
on an unrealistically small scale in § 4.6 .

Analytic results can be found in certain limits. There are two régimes
of interest for the spectral index, as shown by Durrer et. al. [ 52 ] .
For @xmath the integrations are dominated by the cutoff scale. In this
ultraviolet régime, if @xmath , the angular integrations are straight
forward ( @xmath ). Relative to the trace correlation, the amplitudes of
the other correlations are

  -- -------- -- --------
     @xmath      (4.26)
  -- -------- -- --------

respectively, agreeing with the large-scale results of both the
realisations and the integrations. For @xmath the situation is
considerably more complex and we content ourselves with the results of
our simulations in figure 4.4 . In this infra-red régime the cutoff is
unimportant and the spectra quickly approach the power law @xmath
naïvely expected from the @xmath -integration. Also notable is the
change of behaviour of the scalar cross-correlation; whereas this
vanishes on large scales in the @xmath régime, it remains finite on
large scales for @xmath and so in principle might be observable on the
sky. There are also the effects of the unphysical infra-red cut-off
causing a suppression at low- @xmath .

### 4.4 Three-Point Moments

In this section we focus on the three point moments in Fourier space,
for which it is possible (if laborious) to obtain analytic expressions.
The magnetic field realisations provide a way of exploring other kinds
of non-Gaussianities which may arise.

At the three point level, it is no longer guaranteed that correlations
between the scalar, vector and tensor pieces will vanish, and we present
some of the first calculations of these here. There are many possible
three point moments, but here we consider only the rotationally
invariant combinations @xmath , @xmath , @xmath and @xmath , the two
scalar-vector correlations @xmath and @xmath , the two scalar-tensor
correlations @xmath and @xmath , the vector-tensor cross-correlation
@xmath and the tensor auto-correlation @xmath . We work throughout in
Fourier space, where the three-point moments are known as the bispectra.
One advantage of working in Fourier space is that the transfer
functions, which fold in the fluid dynamics and describe the impact on
the microwave background, are local.

#### 4.4.1 General Considerations

In principle we can calculate all the three point statistics described
above in Fourier space. The bispectra involve three wave modes, and
since we assume the fields are homogeneous and isotropic, the sum of the
three modes must be zero. Thus the bispectra are a function of the
amplitudes of the modes alone (or alternatively, two amplitudes and the
angle between them.) We denote different geometries by selecting a
baseline @xmath and a vector @xmath making an angle @xmath with @xmath
and having an amplitude @xmath (see figure 4.5 ). We may then calculate
@xmath . For simplicity, we here concentrate on the colinear
(degenerate) case in which @xmath implying @xmath – that is, @xmath and
@xmath – though evaluating the contributions the primordial
non-Gaussianities will have on the microwave background would require
the full bispectra.

We calculate the bispectra analogously to the power spectra, although
matters are complicated by the need to deal with expectations of six
fields rather than four. The object of most general interest is @xmath
which is related to the expectation value of six magnetic fields,

  -- -------- -- -- -------- --------
     @xmath                  (4.27)
                             
                    @xmath   
  -- -------- -- -- -------- --------

As in the two-point case, all three-point moments of interest may be
found by applying the relevant projection operator, @xmath , to this.
Expanding this six-point correlation with Wick’s theorem generates
fifteen terms, eight of which contribute to the reduced bispectrum, that
is, the bispectrum neglecting the one-point terms proportional to @xmath
, @xmath or @xmath . This leads eventually to

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
  -- -------- -- -------- --

These eight terms reduce to the same contribution if the projection
tensor @xmath that recovers a set bispectrum is independently symmetric
in @xmath , @xmath and @xmath .

In the power spectra calculations, the geometry was straight forward;
here it is considerably more complicated. The three wavevectors of the
bispectrum are constrained by homogeneity to obey @xmath . Combined with
the dummy integration wavevector, these define a four sided tetrahedron.
This has six edges, @xmath and @xmath . From these, we can generate
fifteen unique angles which could arise in the bispectra calculations.
This is to be compared to just three edges and three angles required for
the power spectra. Clearly these angles are not all independent; they
are, in fact, functions of just five underlying angles.

For our purposes, it is easiest to work with the fifteen which we
separate into four hierarchies; those between the set wavevectors @xmath
, @xmath and @xmath , angle cosines of these vectors with @xmath ,
cosines with @xmath , and cosines with @xmath . The final group are
defined below. We take the angles, with @xmath , to be

  -- -------- -- --------
     @xmath      
     @xmath      (4.29)
  -- -------- -- --------

In terms of the angles @xmath and @xmath in figure 4.5 we obviously have
@xmath and similarly for @xmath . We also have @xmath . @xmath and
@xmath are, of course, entirely unrelated to the metric on our spatial
hypersurface @xmath or its determinant.

In a manner entirely analogous to the two-point case we find the
different bispectra by applying to ( 4.4.1 ) different projection
operators to extract the relevant scalar, vector or tensor parts and,
given that we ensure that @xmath has the required symmetries, we may
express the bispectra as

  -- -- -- --------
           (4.30)
  -- -- -- --------

where @xmath denote denote different parts of the stress-energy tensor
and @xmath is the relevant angular component.

#### 4.4.2 Scalar Bispectra

We begin with the simplest case, the bispectrum of the magnetic
pressure. This is found by defining @xmath which gives us

  -- -------- -- --------
     @xmath      (4.31)
  -- -------- -- --------

The first scalar cross-correlation will be between the square of the
pressure and the anisotropic pressure, found by using @xmath to give

  -- -------- -- -- -------- --------
     @xmath                  (4.32)
                             
                    @xmath   
  -- -------- -- -- -------- --------

Similarly the second scalar cross-correlation, with @xmath , gives

  -- -------- -- --------
     @xmath      (4.33)
  -- -------- -- --------

where

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (4.34)
     @xmath   @xmath   @xmath      
                       @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

Finally, the anisotropic scalar bispectrum is found by applying @xmath
@xmath which results in

  -- -------- -- --------
     @xmath      (4.35)
  -- -------- -- --------

with

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            
     @xmath   @xmath   @xmath            
     @xmath   @xmath   @xmath            
                       @xmath            
     @xmath   @xmath   @xmath            
                       @xmath            
                       @xmath            
                       @xmath            
     @xmath   @xmath   @xmath            (4.36)
                                @xmath   
                                @xmath   
                                @xmath   
  -- -------- -------- -------- -------- --------

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

#### 4.4.3 Vector and Tensor Cross Bispectra

For the vector and tensor correlations we restrict ourselves to the
various rotationally-invariant quantities, which can be identified with
cross-correlations between the scalar pressures and either the vector or
tensor moduli. The first of these, the correlation between the scalar
pressure and the vorticity, we recover with the operator @xmath . The
eventual result is

  -- -------- -- --------
     @xmath      (4.37)
  -- -------- -- --------

with

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

The cross-correlation with the anisotropic pressure is recovered with
the operator @xmath , giving

  -- -------- -- --------
     @xmath      (4.38)
  -- -------- -- --------

with

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

The cross-correlation between the scalar trace and the tensor modulus,
@xmath , is found by the application of @xmath . After a lengthy
calculation one sees that

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

and

  -- -------- -- --------
     @xmath      (4.39)
  -- -------- -- --------

The correlation between the traceless scalar and the tensors is even
more complex; applying @xmath to @xmath leads to an angular integrand
which we express as

  -- -------- -- --------
     @xmath      (4.40)
  -- -------- -- --------

We present the forms of @xmath in appendix E.1.1 .

The final rotationally-invariant cross-correlation is that between the
vectors and the tensors, @xmath , found by applying @xmath . This
ultimately produces

  -- -------- -- --------
     @xmath      (4.41)
  -- -------- -- --------

with @xmath presented in appendix E.1.2 .

#### 4.4.4 Tensor Auto-Correlation

There is no rotationally-invariant vector auto-correlation possible at
the three-point level; one has a residual vector freedom. Thus the last
bispectra we consider is the full tensor auto-correlation, @xmath ,
which can be found by the application of

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

The result is far from pretty; it simplifies considerably for
large-scales and colinear bispectra (for which, indeed, the result is
vanishing). We present the full generality in appendix E.1.3 ; it has
the form

  -- -------- -- --------
     @xmath      (4.42)
  -- -------- -- --------

#### 4.4.5 Results

As was the case for the power spectra, there are two very different
spectral régimes for the bispectra. For ultra-violet spectra with @xmath
, the integrals are dominated by the highest @xmath modes around the
cutoff scale. For these spectral indices, the bispectra become
independent of @xmath when @xmath and the analytic expressions are
straight forward to integrate. Indeed, we can do them exactly in the
limit @xmath ; we present these results in appendix E.2 for a generic
geometry and here only the colinear case. We see that

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (4.43)
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

in excellent agreement with the results, both simulated and numerically
integrated, shown in the figures below.

##### Flat Spectrum Results

The bispectra that are derived from the simulated fields are heavily
compromised by the grid-size; unlike the two-point case the three-point
moments use only a restricted number of the modes, selected by the
geometry chosen for the wavevectors. The result from a single
realisation is in most cases noise-dominated. To overcome this
difficulty we have chosen to simulate a large number of different
realisations, taking the mean signal and using their variance to provide
an estimate for the errors involved. The results, for a flat power
spectrum, a grid-size of @xmath (and a damping scale of @xmath ) and
@xmath combined realisations, are plotted rebinned into @xmath bins in
figures 4.6 with the numerically-integrated predictions overlaid. For
simplicity we have concentrated on the colinear case, wherein @xmath and
so @xmath . We plot @xmath against @xmath where @xmath represents the
colinear bispectra.

##### Steep spectrum results

In the régime @xmath matters are, as with the two-point case,
complicated by the presence of numerous poles; the integrals are
dominated by the volume lying between the poles. Rather than attempt a
solution, we use our realisations to calculate the bispectra. We present
the results for @xmath in figures 4.7 . There is a dependence on the
grid-size for this spectrum due to the paucity of modes of appreciable
power given the strongly red spectrum. We tested this by running three
realisations with differing grid-sizes, keeping the total number of
modes constant in each case constant; specifically we took @xmath
simulations at @xmath , @xmath simulations at @xmath , and @xmath
simulations at @xmath . As might be expected we found a suppression for
the case wherein @xmath – due to scarcity of modes at low @xmath – but
there was good agreement between the other two cases. We have plotted
the results from the @xmath run for greatest dynamic range, again
rebinning into @xmath bins.

With this highly-tilted spectrum we see, as with the two-point case,
that the features of the magnetic spectrum at the cut-off scale apparent
in the flat case are washed out by the spectral tilt. The predominant
shape again is the @xmath -dependence we expect from the radial
component of the integral; in this case @xmath ; these are plotted for
comparison. Again, as with the two-point case there is an infra-red
suppression. The magnitudes of the bispectra fall into three close
bands; the strongest are the correlations between the scalars and the
tensors, while the middle-band is composed of the scalar auto- and
cross-correlations. The weakest bispectra are those involving
correlations with the vectors and, in some cases, the @xmath error bars
are greater than the mean value; such points have been removed from
these plots for aesthetic purposes. The @xmath correlation is
particularly weak.

### 4.5 The Lorentz Forces

For completeness we briefly present the results for the Lorentz forces.
Recall ( 3.49 , 3.50 ) that these were

  -- -------- --
     @xmath   
  -- -------- --

Constructing these from our realised fields and evaluating the one-point
moments of the scalar component, we find a skewness @xmath and a
kurtosis @xmath for a flat magnetic spectrum, and @xmath , @xmath for an
index @xmath . The (unnormalised) probability density functions are
plotted in figures 4.8 , alongside those of the scalar pressures. From
both the figures and the moments it is readily clear that the scalar
Lorentz force is very nearly Gaussianly distributed; the difference
between this and the energy density arises because combining the
non-Gaussian energy density with the almost-Gaussian anisotropic
pressure naturally reduces the level of non-Gaussianity.

The power spectra are plotted in figure 4.9 , alongside the pressures
where helpful. The differences in the power spectra between the Lorentz
forces and the corresponding stresses comes entirely from the
multiplicative @xmath . We have for the scalar case that

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            (4.44)
                       @xmath   @xmath   
  -- -------- -------- -------- -------- --------

(This can, of course, also be found by application of @xmath to @xmath
.) For the vectors,

  -- -------- --
     @xmath   
  -- -------- --

which more simply implies

  -- -------- -- --------
     @xmath      (4.45)
  -- -------- -- --------

@xmath is not now purely angular and the radial integration is modified.
The resulting spectra then naturally display a suppression at low-
@xmath . This suppression also induces a length scale at which the
Lorentz force has a maximum effect. For a flat magnetic spectrum and the
scalar Lorentz force this length-scale is at approximately
three-quarters of the damping scale, while for the vectors it is a
little more, at about @xmath . Forming the power spectra of the Lorentz
forces for a steeply-titled magnetic field ( @xmath ), we see that as
before the features are washed out somewhat. However, due to the @xmath
dependence above we also see that, for most of the dynamic range, the
Lorentz force spectra go as @xmath which in this specific case is
obviously flat. On larger scales this breaks down somewhat and the
correlations increase. It is interesting to note that the length-scales
apparent in the flat case are still evident in the large-scale tail as a
final inflection. The increase in power begins at roughly @xmath for
both the scalar and vector Lorentz forces. This corresponds to the
points on the large-scale side of the flat-spectrum curve at which they
curve inwards.

Finally, the bispectra we can construct from the Lorentz forces are the
scalar auto-correlation @xmath and the cross-correlation @xmath . These
are plotted in figure 4.10 for @xmath and 1500 realisations.

### 4.6 A Damped Causal Field

Here we briefly consider the results of a field with a power spectrum

  -- -------- -- --------
     @xmath      (4.46)
  -- -------- -- --------

At the one-point level, as one might expect, the statistics of the
scalar pressure are similar to those for the flat case; here we find
@xmath and @xmath . For the anisotropic pressure we have @xmath and
@xmath ; we then see that for @xmath the one-point statistics of the
pressures are insensitive to the spectral index.

The power spectra are shown in figure 4.11 . They are very similar to
those produced by an undamped causal field, itself very similar to the
flat field. For this field we content ourselves with the stresses and do
not present the Lorentz forces which will also be very similar to the
flat case. We retain the (1- @xmath ) error bars due to increased
large-scale errors coming from a large-scale suppression seen also in
the analytical integration. Qualitatively, it is obvious that the
features of a damped causal field are identical to a flat case; this is
unsurprising since both are in the region @xmath . The details, however,
do differ, most noticeably in the increased hump on the tensor spectrum.

The bispectra are in figure 4.12 .

In all qualitative respects, the damped causal field closely resembles
the case @xmath .

### 4.7 Discussion and Conclusions

We have studied, analytically and via realisations, some of the higher
point correlations for tangled large-scale magnetic fields. The analysis
is obviously highly model-dependent, and extending the analytic results
to other models could be very difficult. However, it would be a simple
matter to generalise the numerical realisations to perform the same
analysis for a wide variety of time-independent models; all we require
is the statistical distribution of the underlying field, the
power-spectrum and the form of the stress-energy tensor. For example,
while we have assumed the simplest – and perhaps most instructive – case
of a magnetic field with Gaussian statistics, it would be a simple
matter to employ a @xmath probability distribution for a magnetic field,
which is physically motivated by the creation mechanism considered by
Matarrese et. al. [ 31 ] . (Since our code is time-independent the
analysis would be relatively complex.) The realisations will however be
limited by the narrow dynamic range allowed in the computation.

In our particular case of a tangled primordial magnetic field with a
power-law spectrum, we have demonstrated that we can recover the 1-, 2-
and 3-point statistics from simulations and with an excellent agreement
to our analytic predictions. At the one-point level we have not only
verified that the magnetic energy density follows a @xmath probability
distribution function (as expected given that it is directly the square
of the underlying Gaussian magnetic field), but that the anisotropic
pressure is also non-Gaussian with a significantly more complex relation
to the fields. There is also a spectral dependence on its probability
distribution function affecting the skewness, which swaps sign as one
passes through @xmath . The kurtosis, while exhibiting a spectral
dependence, remains positive.

At the two-point level we have calculated the scalar, vector and tensor
auto-correlations, as well as the scalar-cross correlation. For the
scale-invariant spectrum we confirm the power-spectra with the expected
ratios for scales longer than the cutoff; we also see that the scalar
cross-correlation vanishes on large scales but is not in general
entirely zero for modes close to the cutoff scale. For a highly-tilted
spectrum, the cutoff scale is less important and the spectra behave with
power law behaviour and with the relative ratios approximately constant.
The @xmath -dependence is the power-law that would be expected from a
naïve point of view. The surprise is that in this régime the scalar
cross-correlation no longer vanishes on large-scales; rather, the
correlation remains roughly constant at @xmath Thus, while the isotropic
and anisotropic pressures are indeed correlated, they are not perfectly
correlated.

At the three-point level we considered a number of
rotationally-invariant bispectra, concentrating for simplicity on the
colinear case. We find significant non-Gaussianities – in excellent
agreement with the analytic predictions. For the flat spectrum, these
approach fixed ratios on large scales. These can be both positive or
negative, or even zero. As in the two-point case, some qualitative
aspects change when we consider a strongly-tilted magnetic power
spectrum; features arising from the cutoff scale tend to disappear,
leaving instead a simple power-law drop off. The relative ratios of the
bispectra also change, and even their relative signs differ. The
correlation between the isotropic pressure squared and the anisotropic
pressure, which vanishes for flat spectra, becomes non-zero.

It is interesting to note that the changeover between infra-red and
ultraviolet behaviour changes as one considers higher-order moments. For
an @xmath -point function, the changeover will be at

  -- -------- -- --------
     @xmath      (4.47)
  -- -------- -- --------

which implies that if one could take a very high-order moment, the
stresses would exhibit an ultraviolet behaviour for the spectral index
@xmath – that is, the behaviour of sources would tend towards the
behaviour of the field.

It remains for future work [ 174 ] to fold these results in with the
transfer functions for magnetised cosmologies and calculate the
non-Gaussianities expected to be imprinted upon the cosmic microwave
sky. We can then consider how such signals might be used to constrain
the properties of a magnetic field of this type. It would also obviously
be straight-forward to consider different magnetic power spectra and
statistics. While it is too early to speculate what these will discover,
the higher order correlations in the sources will certainly lead to
similar higher order correlations in the CMB observables, including
perhaps cross correlations between the polarisation modes such as @xmath
. The foundations of this process form the basis of the next chapter of
this thesis.

The techniques used in this chapter could be applied to a broad variety
of models. Moreover, we have here to our knowledge presented the first
calculations of cross-correlations between, for example, scalars and
tensors, and demonstrated that they can be of an equal magnitude to
scalar auto-correlations. This has great potential relevance to the
wider field of sources with non-linear stress-energy tensors, or sources
with non-Gaussian initial conditions. For example, it would be
interesting to compare our results to the same moments evaluated for
defect models, particularly given the current resurgence of interest
into networks of cosmic strings. For non-coherent cases – such as defect
models, in which the sources evolve once they have entered the horizon,
or very possibly magnetic models in which the intrinsic statistics are
dependent on the evolving damping scale @xmath – a single static
simulation will obviously not be sufficient. It is, however,
straightforward in principle to construct the necessary time-dependent
matrices.

## Chapter 5 Observable Impacts of a Magnetic Field

### 5.1 Overview

The earliest probe into the nature of a magnetic field that we possess
comes from the era of nucleosynthesis. A magnetic field alters
nucleosynthesis directly and indirectly. The direct impact comes both
from a shift in nuclear energy levels and from the magnetic energy
density, decaying as radiation, altering the universe’s expansion rate.
The indirect impact arises from the gravitational waves that the
magnetic field will generate. Strong nucleosynthesis constraints on the
energy density in gravitational waves are already known and these can
provide equally strong constraints on the field strength and spectral
index of a power-law magnetic field. Likewise, constraints are known on
the expansion rate of the universe during recombination and the possible
energy density in radiation; given the strong bounds on current photon
and neutrino densities, these constraints can then be passed on to the
strength of the magnetic field.

However, the chief diagnostic for early universe magnetic fields – and
other primordial, non-linear sources – is the CMB. For the case of a
magnetic field, it has been shown that the temperature angular spectrum
@xmath from magnetically-induced vector and scalar perturbations
increases slightly across all angles, but that the magnetic signal
remains subdominant to that from standard scalar perturbations until
around @xmath , depending on the field strength and spectral index. The
field also sources tensor modes, but they are relatively low-amplitude;
their signal is similar to the inflationary gravitational wave signature
but likely to be rather weaker [ 59 ] . The direct impact of a magnetic
field onto the CMB @xmath correlation does not, then, appear to be an
ideal probe of a magnetic field. Unfortunately this is the component of
the CMB map that is known to the highest resolution; WMAP is limited
only by cosmic variance up to @xmath [ 78 ] and in the smaller-scale
régime observations from CBI and VSA [ 80 ] , ACBAR [ 81 ] and the
forthcoming SPT [ 84 ] missions will determine the spectrum to
ever-greater accuracies. The Planck satellite [ 175 ] is expected to
extend the region limited only by cosmic variance to @xmath . Even so,
the high- @xmath régime is littered with foreground sources and
contamination from these will be high. The CBI mission observed a weak
increase of power observed on small scales, as compared to the
concordance model [ 80 ] ; should this be real and not a statistical or
systematic artifact, it could possibly be explained in part by employing
a primordial magnetic field (e.g. [ 61 , 66 ] ). However,
nucleosynthesis bounds imply that a primordial field is unlikely to
account for all of the increase.

In addition to the contributions to the CMB temperature fluctuations, a
magnetic field also sources polarisation @xmath -modes; these will
likely be subdominant to those from the standard model until the very
small scales. Due to the presence of both vector and tensor
perturbations, the field also induces @xmath -mode polarisation. In the
standard picture, these are produced only from lensed @xmath -modes and
from inflationary gravitational waves. One could conclude that, in
principle, a @xmath -mode power spectrum would give the clearest
signature for primordial magnetic fields. Unfortunately, the CMB
polarisation maps are poorly known compared to the temperature maps.
While we currently possess a power spectrum @xmath , this is by no means
cosmic-variance limited on any scale. The 2-, 3- or 4-year WMAP results,
when they emerge, are expected to improve this situation somewhat, but
WMAP was not designed to probe the CMB polarisation with this accuracy.
The @xmath correlation has been detected to some accuracy (e.g. DASI [
176 ] , CAPMAP [ 83 ] , CBI [ 177 ] and Boomerang [ 82 ] , the latter
two of which also detected a rough power spectrum). The observations of
the @xmath -modes yield bounds consistent with zero (e.g. [ 176 , 177 ]
). These observations are on relatively small scales, directly observing
the region at which magnetic effects may come to dominate; however, we
are some distance from the required accuracy, particularly for the
@xmath -modes. See [ 178 ] for a recent review of the prospects for
detecting magnetic-induced polarisation with the Planck satellite.

Given the limitations of power spectra, the non-Gaussianity of the
temperature map is a reasonable place to look to further the constraints
on primordial magnetic fields and other non-linear sources. While thus
far the observations are entirely consistent with Gaussian initial
conditions, there are non-Gaussian features in the WMAP maps (e.g. [ 160
] ) and the number of non-Gaussian features could well increase with the
next generation of CMB experiments. There are many ways to characterise
non-Gaussianity, and a search for non-Gaussian signatures from
primordial magnetic fields will be eased by predictions of their form.
The primordial bispectra we derived are generally strongest on very
large scales; while this feature will naturally be smeared out in the
2-D multipole space we should still expect the most significant magnetic
non-Gaussianities to lie on the large scales, at which WMAP is generally
cosmic-variance limited. This chapter is concerned with planning how
such predictions would be made, along with confirming and extending the
range of two-point signals.

In this chapter we approach the magnetised CMB with a slightly different
philosophy to previous studies in the literature, and demonstrate that
our approach is not only valid but also highly extensible. While we
concentrate on the CMB angular power spectrum for Gaussian power-law
fields, these provide a material proof that one may take pre-computed
power- or bi-spectra and predict from these the statistical nature of
the CMB sky for higher-orders and more general fields. This then
immediately implies that mapping the magnetic non-Gaussianities onto the
CMB is realistically possible to a good accuracy, and far more generally
than would be possible attempting to derive their forms analytically in
the approach generally applied to magnetic fields (e.g. [ 55 ] ).

We first briefly review the constraints placed on a magnetic field from
nucleosynthesis before considering the impacts of a magnetic field upon
large-scale cosmology. After justifying the approach we shall take, we
derive approximate large-scale solutions to the vector and tensor photon
transfer functions. We briefly provide an overview of the previous
research into the magnetised CMB angular power spectrum and highlight
the areas in which it is deficient, before deriving the two-point
moments employing our own approach. This is used as a “proof-of-concept”
of our methods and as demonstration that it can be applied with little
extension to characterising CMB non-Gaussianities arising from a
primordial magnetic field. We finish by introducing the CMB angular
bispectrum and demonstrating that our approach is easily adapted to its
study, and by outlining a procedure by which we could add magnetic
support to the CMBFast code of Zaldarriaga and Seljak [ 76 ] .

### 5.2 Nucleosynthesis

#### 5.2.1 Direct Bounds

There are two major ways in which a magnetic field could directly
influence nucleosynthesis. The first, and perhaps most obvious, is that
electrons tend to circulate around a magnetic field, which leads [ 5 ]
to a quantisation of their energy to

  -- -------- -- -------
     @xmath      (5.1)
  -- -------- -- -------

where @xmath is the quantum number characterising the induced Landau
levels. With this altered energy the electron energy density will also
naturally be altered, in turn altering the neutron decay rates. A
stronger magnetic field will tend to increase neutron decay and hence
lower the amount of (for example) He @xmath generated during
nucleosynthesis. The magnetic alteration becomes significant for field
strengths above a critical

  -- -------- -- -------
     @xmath      (5.2)
  -- -------- -- -------

and assuming that our field is at or below this level provides us with a
loose bound on the magnetic energy density during nucleosynthesis, which
is approximately

  -- -------- -- -------
     @xmath      (5.3)
  -- -------- -- -------

The other direct impact a magnetic field has on nucleosynthesis comes
from its energy density altering the expansion of the universe and thus
the evolution of temperature. The presence of another radiative field
will act to increase the universe’s expansion rate and thus decrease the
amount of time during which nucleosynthesis is possible – and during
which neutrons can decay. With fewer neutrons decaying, we thus have an
increase in He @xmath due to the presence of a magnetic field. Since we
know the helium abundance and the energy density in radiation during
nucleosynthesis, we can then derive a bound on the magnetic field, which
turns out to be tighter than that we can place from energy
considerations. A magnetic field of

  -- -------- -- -------
     @xmath      (5.4)
  -- -------- -- -------

present during recombination would provide an energy density equal to
that of the universe and is thus rather too high. Taking a primordial
magnetic field to be smaller than this (and scaling with @xmath to the
current epoch), direct nucleosynthesis bounds can constrain a magnetic
field to be approximately

  -- -------- -- -------
     @xmath      (5.5)
  -- -------- -- -------

For further details, see [ 5 ] and its references.

#### 5.2.2 Indirect Bounds

In this section we summarise the arguments of Caprini and Durrer [ 23 ,
42 ] that impose stringent limits on tangled magnetic fields that arise
from nucleosynthesis bounds. The tensor Einstein evolution equation in
the presence of a magnetic field is

  -- -------- -- -------
     @xmath      (5.6)
  -- -------- -- -------

Caprini and Durrer solve this equation approximately for a stochastic
magnetic field with a power-law spectrum and characterise the resulting
gravitational waves by their amplitude and their power spectra, which is
bluer than the magnetic spectrum if @xmath and redder than the magnetic
spectrum if @xmath . They then use these gravitational waves, and the
existing limits on gravitational waves present during nucleosynthesis,
to constrain the magnetic fields. These limits are heavily dependent on
the time at which the field was produced, the primordial damping scale
at that time – as we showed in § 3.3 , the damping scale is
time-dependent – and the time at which the viscous damping scale
dominated over the primordial damping scale. They are also
extraordinarily strong; for a field generated at a conformal time @xmath
and smoothed on a scale @xmath , they present the approximate limits

  -- -------- -- -------
     @xmath      (5.7)
  -- -------- -- -------

For fields produced during inflation with @xmath , this provides limits
down to @xmath for @xmath and leaves weak constraints only for fields
with @xmath . It should be noted, however, that these limits are derived
with a smoothing scale @xmath . The constraints for a more typical scale
@xmath are correspondingly weaker.

The approach Caprini and Durrer take is not without criticism; Kosowsky
et. al. [ 41 ] comment that the conversion of energy from the magnetic
fields into the gravitational waves has no impact on the energy density
of the universe or its evolution, since both gravitational waves and the
magnetic energy density decay as radiation, implying that the limits are
on the total energy density of the magnetic field. This returns us to a
limit of between nano- and micro-Gauss. Caprini and Durrer present a
defence in [ 42 ] . Caprini and Durrer’s argument is that, since the
damping scale evolves with time, the magnetic energy density does not
decay as radiation but faster. A bound placed on the magnetic energy
density at nucleosynthesis will then yield a tighter bound than would
otherwise be the case. So far as this goes, we will tend to view
Kosowsky et. al. ’s bounds as somewhat conservative and consider the
Caprini/Durrer bounds as perhaps slightly stronger than is warrented.

### 5.3 Large-Scale Magnetised Cosmology

#### 5.3.1 General Approach

The primordial magnetic field in our model is frozen into the plasma on
large-scales and decays ( 3.39 ) as

  -- -------- --
     @xmath   
  -- -------- --

The field is in a tangled configuration and possesses no directionality
on scales larger than some length @xmath , of the order of megaparsecs,
on which length scale the magnetic energy is @xmath . We characterise
the statistics of this field with a power spectrum

  -- -------- --
     @xmath   
  -- -------- --

and in the simplest case of a Gaussian field the power spectrum contains
all the information about the field. This spectrum is generally taken to
be a power law

  -- -------- --
     @xmath   
  -- -------- --

In the later universe, the magnetic field damps on an evolving scale
@xmath ( 3.75 ). This scale is relevant back to neutrino decoupling; at
the earliest times, photon viscosity dominates neutrino viscosity until
@xmath , with neutrino viscosity dominating until decoupling when it
again becomes subdominant to photon viscosity [ 23 ] . The magnetic
field was generated with a primordial damping scale @xmath , and the
effective magnetic damping scale will be

  -- -------- -- -------
     @xmath      (5.8)
  -- -------- -- -------

At early times, then, the magnetic field is effectively static since
damping processes occur on very small scales – that is, at early times,
@xmath . However, since @xmath decays, at later times the situation is
reversed and the damping scale of the magnetic field evolves. We return
to this point in § 5.3.3 .

The magnetic field possesses a stress-energy tensor ( 4.1 )

  -- -------- -- -------
     @xmath      (5.9)
  -- -------- -- -------

which can be separated into its scalar trace, traceless scale, vector
and tensor components. The intrinsic two- and three-point correlations
between these components were considered in detail in the last chapter.
These correlations will form the underlying statistics for the magnetic
sources and will be imparted onto the perturbations they produce. From
the results of chapter 4 we can see that there are two régimes – the
ultraviolet, in which the damping scale dominates the sources, and the
infra-red in which the sources are generally independent of the damping
scale. The boundary between these régimes differs with the statistic
that one is considering: for a 2-point moment it is at @xmath , while
for a 3-point moment it is at @xmath .

We modelled the 2- and 3-point statistics of the magnetic sources by
generating simulated fields on a grid, concentrating on those from
power-law Gaussian fields for which we can also calculate the sources
through a mixture of analysis and numerical integration. For the
simulated fields, our use of a grid imposes an unphysical but
unavoidable infra-red cut-off which we will have to deal with before
employing the results for CMB study. It also results in a limited
dynamic range from memory restrictions on the size of the grid. However,
it also allows a great flexibility in the nature of the fields that we
might choose to model. The results from the simulations, for both 2- and
3-point moments, were entirely consistent with the analysis.

The magnetic stresses source both plasma and gravitational perturbations
over time. In the scalar case we have density and velocity perturbations
in the plasmas and the two scalar metric perturbations. In the vector
case there are the two velocity perturbations and two metric
perturbations, while in the tensor case there are the two tensor
perturbations. At each time, the statistics of the sources are also
generated in the perturbations. However, we should note that coherence
is not guaranteed – perturbations generated relatively late may not be
simply related to those sourced relatively early, due to the evolution
of the magnetic damping scale. If the primordial field is infra-red,
then this is not an issue and the simple outline that we present in this
chapter is entirely valid, since the fields evolve purely as @xmath ,
and this time-dependence is easily factored out. For ultra-violet
fields, however, the source statistics are evolving with the damping
scale – this causes the heavy dependence on cut-off scale noted by Koh
and Lee [ 51 ] , for example. It is unclear at the moment to what extent
this is an issue; we briefly comment in more detail in § 5.3.3 . As we
mentioned before, it is also interesting that the boundary between
infra-red and ultra-violet behaviour occurs at a different spectral
index for 2- and 3-point moments; a bispectrum can possess a bluer index
than a power spectrum while remaining infra-red.

Assuming that the imparted statistics remain coherent, we can then
approach the induced CMB perturbations by evaluating the transfer
functions generated by a magnetised cosmology, for which we can employ
different levels of approximation or the results from a Boltzmann code.
This process can be decoupled entirely from the statistics; with one set
of transfer functions we can consider a wide variety of CMB statistics.
The usual methods for predicting magnetised signatures on the sky (e.g.
[ 53 , 55 , 66 ] ) involve attempting to find closed analytical
approximations for the properties of the magnetic field and then
evaluating the statistics of the perturbations as they stand at
recombination. These approaches are very hard to extend beyond simple
Gaussian, power-law magnetic fields and will be difficult to extend to
higher-order statistics. Our approach – while obviously physically
identical – does not rely on the form of the magnetic field. We can thus
with little effort model the intrinsic statistics of non power-law or
non-Gaussian fields and, using the same transfer functions, generate the
corresponding CMB statistics.

With coherent sources, we can find the CMB statistical imprints from
static realisations; speaking heuristically, the imprint at one point in
the sky will be given in Fourier space by a transfer function, embodying
the evolution, multiplying a factor embodying the phase information,

  -- -------- -- --------
     @xmath      (5.10)
  -- -------- -- --------

with

  -- -------- --
     @xmath   
  -- -------- --

The CMB statistics can then be built up by considering correlations of
this and integrating across wavemodes. Since the transfer functions do
not contain any statistics they can be taken outside the correlation and
we can heuristically consider correlations of the form

  -- -------- -------- -- --
     @xmath   @xmath      
     @xmath   @xmath      
  -- -------- -------- -- --

We can employ any combination of approximations for the transfer
functions and for the source statistics, which means that for each
particular case we consider we can employ a spectrum evaluated
analytically, or employ an approximation to the analytical spectrum, or
interpolate between points on a realised grid. We can then fold these
across transfer functions best suited for our aims, whether approximate
or calculated from a Boltzmann routine.

In the remainder of this section we consider the magnetic damping scales
and the parameters of the primordial magnetic field @xmath , @xmath and
the Alfvén velocity @xmath , before briefly considering the resulting
potential issue of the non-coherence of our sources. We then focus on
approximations for the large-scale vector and tensor transfer functions,
neglecting the induced scalar perturbations as subdominant to signals
from the standard mode. We assume a flat universe evolving today as
@xmath implying that the current conformal time is given by @xmath .
This will be a reasonable approximation since the universe has only
recently begun accelerating. Given @xmath and the current densities of
baryons, matter, photons and neutrinos we then have a full system. We
shall take as a first approximation the 1-year WMAP parameters, that is
that

  -- -------- -- --------
     @xmath      (5.11)
  -- -------- -- --------

#### 5.3.2 Damping Scales

The primordial magnetic field is assumed to have been generated at some
(brief) redshift @xmath corresponding to some generation epoch @xmath .
At generation, the field will have some primordial cut-off scale @xmath
. However, viscous processes operate in the interim period between
magnetogenesis and recombination, both from neutrinos before decoupling
and from photons at very early times and after neutrino decoupling, and
this generates a second damping scale. While the viscous damping scales
remain below the primordial damping scales – that is, while @xmath – the
fields are static. However, the viscous damping scale evolves and
eventually will pass the intrinsic damping scale and at this point the
magnetic field will begin to damp on ever smaller scales. Caprini and
Durrer [ 23 ] present an overview of the history of the magnetic damping
scale.

After neutrino decoupling, the damping scale is tied to the Alfvén
scale, which we assume to be smaller than the intrinsic damping scale,
so

  -- -------- -- --------
     @xmath      (5.12)
  -- -------- -- --------

where @xmath is the photon diffusion length (see § 3.3 ) and @xmath the
Alfvén velocity. This scale will govern the damping of the magnetic
field; the two-point correlations of the sources are then damped at a
scale @xmath .

The scalar and vector modes evolve up to the epoch of recombination; at
recombination the Silk length is given by

  -- -------- -- --------
     @xmath      (5.13)
  -- -------- -- --------

(see [ 179 ] ). For scalar and vector perturbations we then find the
damping scale by substituting this for @xmath in the Alfvén scale ( 5.12
).

In § 5.3.5 we demonstrate that magnetically-sourced tensor perturbations
are effectively negligible following matter-radiation equality; as such
we can take the Alfvén damping scale at equality to determine the
damping scale for tensor perturbations. The photon diffusion length at
equality is given [ 55 ] by

  -- -- -- --------
           (5.14)
  -- -- -- --------

with @xmath the photon temperature at equality, and thus the tensor
damping scale by

  -- -------- -- --------
     @xmath      (5.15)
  -- -------- -- --------

These damping scales were derived in a formalism that assumed a large
homogeneous component to the magnetic field. This is not strictly the
case here and so to evaluate them we employ an effective field strength
from @xmath . The Alfvén velocity is given by

  -- -------- -- --------
     @xmath      (5.16)
  -- -------- -- --------

Equation ( 4.7 ) related the magnetic field strength when smoothed on
some scale @xmath to the power spectrum;

  -- -------- --
     @xmath   
  -- -------- --

with @xmath (see ( 4.8 )). This implies that we can relate a field
smoothed to a scale @xmath to an effective field smoothed on a scale
@xmath . Taking the ratio between the field @xmath smoothed on the scale
@xmath and the effective field @xmath cut-off on the scale @xmath gives

  -- -------- -- --------
     @xmath      (5.17)
  -- -------- -- --------

Using the Alfvén velocity ( 5.16 ) and magnetic damping scale ( 5.12 )
we can also see that

  -- -------- -- --------
     @xmath      (5.18)
  -- -------- -- --------

We then have two equations for our two unknowns @xmath and @xmath ;
@xmath and @xmath are evaluated at recombination. A closed form of this
system is not possible. We can, though, employ a simple iterative
procedure wherein we make a rough approximation for either the smoothed
field or the cut-off wavenumber and use ( 5.18 ) to determine the other.
We then adjust our parameters until the integration of ( 5.17 ) is
consistent. Once @xmath is known we can then employ ( 4.7 ) to determine
the normalisation of the magnetic spectrum. While cumbersome, this
approach allows us to retain generality. In the tensor case we
substitute @xmath evaluated at matter-radiation equality for the Silk
length and employ @xmath .

For a power-law field, an approximate solution to the normalisation of
the magnetic spectrum ( 4.7 ) is [ 55 ]

  -- -------- -- --------
     @xmath      (5.19)
  -- -------- -- --------

We can then determine an approximate effective @xmath , damping on a
scale @xmath , by

  -- -------- -- --------
     @xmath      (5.20)
  -- -------- -- --------

Substituting the effective background field into the Alfvén velocity
gives us

  -- -------- -- --------
     @xmath      (5.21)
  -- -------- -- --------

leading to a magnetic damping scale at recombination of

  -- -------- -- --------
     @xmath      (5.22)
  -- -------- -- --------

The tensor damping scale takes this form with @xmath substituted for
@xmath and @xmath evaluated at matter-radiation equality rather than
recombination.

#### 5.3.3 Non-Equal Time Correlations

In § 2.7.4 we derived the equations by which the intrinsic statistics of
a primordial source are wrapped on to the CMB across the transfer
functions. However, in our derivation we implicitly assumed that the
evolution of each wavemode remains coherent – that is, that each @xmath
-mode evolves independently and the primordial statistics are easily
transferred onto the CMB. To firm this statement up, consider the
multipole moments of the scalar CMB,

  -- -------- -- --------
     @xmath      (5.23)
  -- -------- -- --------

The general two-point correlation of this is

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

The quantity @xmath is known as a non-equal time correlator; such
correlators appear frequently in studies of defect models (e.g. [ 180 ,
181 , 182 , 183 , 184 ] ) and should in general be calculated in their
entirety. In the standard picture the perturbations are coherent – the
statistics are imprinted at the end of inflation and each mode then
evolves independently. In this case, we can then decouple the non-equal
time correlator into

  -- -------- -- --------
     @xmath      (5.25)
  -- -------- -- --------

Substitution in ( 5.3.3 ) then ultimately reproduces the previous
result, ( 2.232 ).

On large scales, the magnetic field is frozen in to the plasma and this
simple evolution would lead one to believe that we can employ such an
approach. For infra-red fields, with statistics that do not depend on
the cutoff scale, this is still the case. However, for ultraviolet
fields the statistics are dominated by the cutoff scale, which evolves
with time. An active, evolving source causes an amount of decoherence;
different wavemodes will evolve in a different manner, and we must
employ the non-equal time correlators. In general, these have to be
computed, which can be very intensive, albeit entirely realistic,
especially when one works with field realisations.

This point does not appear to have been previously addressed in the
literature, and correspondingly the results presented for ultraviolet
fields should be treated with some caution until we better understand
the microphysics around the cutoff scale. While we will work with the
assumption that we can assume a simple, coherent approach for all types
of field, it should be remembered that our approach is strictly
applicable only to the infra-red régime.

We also comment that, since an @xmath -point moment leaves the
ultraviolet régime at a spectral index

  -- -------- -- --------
     @xmath      (5.26)
  -- -------- -- --------

it is possible to consider fields with @xmath as independent of the
cutoff scale so long as one considers a correlation of high enough
order.

#### 5.3.4 Vector Transfer Functions

In this section we produce large-scale approximations for the vector
photon transfer functions, which will enable us to predict the nature of
the low- @xmath CMB power spectra from magnetic vorticity and
anisotropic stresses. We neglect the scalar mode; the scalar CMB
signature is likely to be insensitive to a realistically observable
magnetic field. It is, moreover, rather intractable. In contrast, the
tensor mode might be substantially enhanced as compared to a standard
inflationary model, and in our scenario the only source for vector
perturbations comes from the magnetic field. Finding an approximation
for the vector modes will require us to construct a tight-coupling limit
similar to that we built for the scalars. The tensors are rather
simpler. This section resembles the analysis of Mack et. al. [ 55 ] but
employs our own formalism.

The transfer functions we derive here should be trusted only on
relatively large scales. Mack et. al. derive similar transfer functions
and apply them to multipoles as high as @xmath ; however, we feel this
enormously overstates their validity due to the approximations involved.
Comparison with the numerical results of Lewis [ 59 ] suggests that
these should be trusted for @xmath at the most. For smaller-scale
studies we will require the results of a numerical Boltzmann code.
However, the approximations for the vector and tensor transfer functions
will prove useful in demonstrating a “proof-of-concept” for our approach
to the problem.

The evolution of the baryon vector velocity is given ( 3.55 ) by

  -- -------- -- --------
     @xmath      (5.27)
  -- -------- -- --------

where we are considering only one mode and suppressing the index. We
shall neglect the contribution from the neutrinos; while for a strictly
accurate analysis we must include these, and Lewis has commented that
much of the large-scale power is in fact controlled by a cancelling
neutrino stress rather than regularity of the vorticity [ 59 ] , our
approach should be sufficient for a first order calculation.

This Euler equation is supplemented by the vector Einstein equations (
2.1 )

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      (5.28)
     @xmath   @xmath   @xmath      (5.29)
  -- -------- -------- -------- -- --------

where we are employing the gauge-invariant metric perturbation @xmath (
2.21 ). We also have the vector Boltzmann hierarchies for the photons, (
2.109 - 2.110 ). Adapting the procedure we employed for scalar
perturbations in section § 2.4.1 we write this hierarchy separated to
zeroth and higher orders in @xmath ,

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (5.30)
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

Here

  -- -------- --
     @xmath   
  -- -------- --

Recursively substituting through the hierarchies down from @xmath for
the temperature and @xmath for the polarisation and back up, we can
readily see that to the first order in @xmath ,

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (5.31)
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

Along with the photon velocity ( 2.124 )

  -- -------- --
     @xmath   
  -- -------- --

we then have @xmath and the tightly-coupled Euler equation

  -- -------- -- --------
     @xmath      (5.32)
  -- -------- -- --------

Working with the Einstein equations ( 5.28 ) in radiation domination and
neglecting quantities of first-order in the tight-coupling parameter we
can quickly find the approximate solution

  -- -------- -- --------
     @xmath      (5.33)
  -- -------- -- --------

where we have neglected a complementary function that grows in the past.
This implies the velocity

  -- -------- -- --------
     @xmath      (5.34)
  -- -------- -- --------

with @xmath . (Compare equations (4.10) and (4.13) in [ 55 ] .)

In matter domination we instead find

  -- -------- -- --------
     @xmath      (5.35)
  -- -------- -- --------

where we retained the complementary function and matched the two
solutions at the epoch of matter-radiation equality. This implies the
velocity

  -- -------- -- --------
     @xmath      (5.36)
  -- -------- -- --------

These forms are valid when the wavelength is longer than that of the
Silk wavelength @xmath . To model the wavemodes on a smaller scale we
add a photon shear viscosity @xmath to the system, giving the
tightly-coupled Euler equation

  -- -------- -- --------
     @xmath      (5.37)
  -- -------- -- --------

where we have rescaled the densities to their proper values. Here the
photon viscosity is [ 55 ]

  -- -------- -- --------
     @xmath      (5.38)
  -- -------- -- --------

again with @xmath . Since the modes we are interested in are those which
are severely overdamped we can employ a terminal-velocity approximation
[ 70 ] by assuming the damping is severe enough that the modes no longer
accelerate; doing so we find

  -- -------- -- --------
     @xmath      (5.39)
  -- -------- -- --------

(In radiation domination the @xmath in front of the baryon density
becomes a @xmath , but this term is generally subdominant regardless.)
This applies when @xmath . @xmath remains unchanged; we assume that the
magnetic vector source dominates over the shear viscosity.

The instantaneous approximation for @xmath ( 2.244 ) is

  -- -------- --
     @xmath   
  -- -------- --

recalling that @xmath . @xmath is first-order in the tight-coupling
parameter and so is neglected; moreover, on large scales, the velocity
will dominate over the metric perturbation and so we also neglect the
integrated Sachs-Wolfe term. The vector transfer function sourced by a
primordial magnetic field is then approximately

  -- -- -- --------
           (5.40)
  -- -- -- --------

#### 5.3.5 Tensor Transfer Functions

Neglecting the anisotropic stresses of the neutrinos and photons (or
considering the situation before neutrino decoupling; see [ 59 ] for a
detailed discussion), the tensor mode evolves as

  -- -------- -- --------
     @xmath      (5.41)
  -- -------- -- --------

The complementary functions are simple to find; in radiation domination
we quickly have

  -- -------- -- --------
     @xmath      (5.42)
  -- -------- -- --------

and in matter domination we have

  -- -------- -- --------
     @xmath      (5.43)
  -- -------- -- --------

where @xmath is a spherical Bessel function of the second kind.

We find the full solutions with a Wronskian Green’s function method;
given an equation

  -- -------- -- --------
     @xmath      (5.44)
  -- -------- -- --------

with the homogeneous solutions @xmath and @xmath , a general solution [
185 ] is

  -- -------- -- --------
     @xmath      (5.45)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (5.46)
  -- -------- -- --------

is the Green’s function. This implies that we have a particular solution
to ( 5.41 )

  -- -------- -- --------
     @xmath      (5.47)
  -- -------- -- --------

where we have assumed that the magnetic field was generated relatively
rapidly at some time @xmath and are employing the co-ordinate @xmath .
We are interested merely in @xmath and large-scales. Since the magnetic
source decays as @xmath in matter domination we also neglect the
particular integral beyond matter-radiation equality; this means we may
match the waves sourced by the stresses before equality with the
homogeneous solutions after equality. Taking @xmath , retaining only the
dominant contribution and matching the derivatives, we find

  -- -------- -- --------
     @xmath      (5.48)
  -- -------- -- --------

The tensor transfer function can then be recovered from the
instantaneous-recombination approximation ( 2.245 )

  -- -------- --
     @xmath   
  -- -------- --

We neglect the intrinsic term as it will be rapidly dominated by the
integrated Sachs-Wolfe term, which we integrate from @xmath since we
shall consider large-scale modes that were superhorizon at decoupling.
We then have the approximate tensor transfer function

  -- -------- -- --------
     @xmath      (5.49)
  -- -------- -- --------

As in the vector case we assume this to be valid up to @xmath .

### 5.4 CMB Power Spectra from Tangled Magnetic Fields

In this section we consider the CMB angular power spectrum induced by a
primordial magnetic field, employing the approximations for the vector
and tensor transfer functions ( 5.40 , 5.49 ) derived above. We begin by
summarising the previous literature, both analytical and numerical. In
the past, the effects of a magnetic field on the CMB have been derived
with predominantly analytical or at most semi-analytical methods. Our
approach instead employs the power spectra generated in chapter 4 ,
wrapping these directly across the approximate transfer functions. The
main advantage of our approach is its extensibility – while the
analytical spectra we generated are constrained in the same manner as
previous work to Gaussian, power-law fields, realised spectra can be
produced for any field configuration. We also have a lessened reliance
on approximate analytical results that assume power-law spectra. For the
angular power spectrum we confirm and reproduce the previous results and
it is merely a technical (albeit non-trivial) exercise to adapt our
methods to the CMB bispectra.

#### 5.4.1 Analytical Estimates from the Literature

Scalar modes have been much neglected in the literature, partly due to
their complexity and the number of terms that appear in the estimates,
but also because the scalar modes induced by magnetic fields are
generally subdominant (e.g. [ 55 , 59 ] ); however, numerical models of
the scalar modes indicate that their effect can begin to become
important on small scales. Analytical and semi-analytical efforts have
concentrated primarily on the effects of the vector and tensor modes.
While there have been many studies of these, we shall concentrate on
very briefly reviewing studies in the two main régimes, @xmath [ 55 ]
and @xmath [ 49 , 53 ] which takes a somewhat separate approach. We
shall concentrate on the temperature power spectrum although we shall
mention the polarisation results these authors present.

Subramanian and Barrow [ 49 , 53 ] concentrate on the vector
perturbations induced by a magnetic field. With Seshadri [ 54 , 57 ]
they also consider the impacts of these modes on the small-scale
polarisation. Working in two régimes, that in which photon viscosity is
important and that in which it may be neglected, they derive analytical
approximations for the two-point auto-correlation function, one of which
grows with @xmath and the other of which decays. For a concordance-like
cosmology, the peak extrapolated from these two behaviours lies just
before the magnetic signal begins to dominate over the standard signal,
which happens at @xmath if @xmath and @xmath . This signal is from the
Alfvén (and slow magnetosonic) waves that survive Silk damping through
extreme overdamping, and damp only slowly on small scales. The power
increases with increasing spectral index and, correspondingly, the
signals dominate the concordance signal for a lower @xmath . For an
early-universe field, though, one should ensure that nucleosynthesis
bounds (§ 5.2 ) are not broken; if one trusts the gravitational wave
bounds [ 23 ] , nano-Gauss fields with indices much different from
@xmath are heavily constrained.

Modelling the polarisation signals from the vorticity in much the same
manner, they find a @xmath -mode beginning to dominate at @xmath
depending on the cosmological parameters and magnetic field. The case
@xmath , @xmath dominates over the standard signals at @xmath . Again,
shallower spectral indices give larger results on small scales They also
found that the @xmath -mode is much smaller than the @xmath , not least
because they are neglecting the scalar modes, and that the standard
scalar modes dominate both the temperature and polarisation maps for all
larger scales, making the detection of the magnetic signals difficult.

Mack et. al. [ 55 ] provide a unifying review of the previous estimates
[ 49 , 51 , 52 , 53 , 54 , 55 , 56 , 57 , 59 , 61 , 66 ] of
semi-analytical vector and tensor anisotropies from primordial magnetic
fields for larger scales @xmath . In deriving the statistical properties
for their fields they provide various approximate results that have
become standard in considering primordial magnetic fields, even for
numerical studies. Although widely used, these rely sensitively on the
power-law form of the power spectrum and on the assumed Gaussianity of
the fields. It would be much preferable to remove the reliance on such
approximations, even at the cost of employing numerical integrations to
produce the source statistics. By considering a thin last-scattering
surface and employing approximations similar to ours, Mack et. al. find
the vorticity at recombination in two limits, one in which photon
damping may be neglected and one in which it cannot. They proceed to
approximate the vector power spectra for a range of field strengths and
spectral indices and find forms asymptotically rising to a limit for
@xmath , for all correlations between temperature and polarisation. As
was found in the large- @xmath limit, the strengths of the effect rise
with spectral index. Repeating the approximations for tensor modes they
find similar qualitative results, excepting that the power spectra from
gravitational waves are scale-invariant (and dominate over the vector
modes) for @xmath . ¹ ¹ 1 This explains the use of the phrase
“scale-invariant” when referring to the highly-red magnetic spectrum
@xmath ; this spectral index itself causes irremovable singularities but
indices nearing scale-invariant are permitted and, indeed, are the most
weakly constrained by big-bang nucleosynthesis [ 23 ] .

#### 5.4.2 Numerical Estimates from the Literature

Koh and Lee [ 51 ] performed a limited numerical study of the impact of
magnetic fields onto the CMB, considering only the scalar mode. They
employed CMBFast, modified to incorporate a tangled magnetic field of
the type we considered in chapter 4 . However, the damping scale they
employ is not calculated from the photon viscosity but rather a
phenomenological argument related to the cluster scale; they recognise
this issue and comment that the resulting CMB power spectrum is very
sensitive to @xmath . This strong dependence on the cutoff scale arises
from their potentially unwarrented use of ultraviolet fields. They
consider both the temperature and polarisation auto-correlations, plus
the cross-correlation. In each case they find, as the analytical studies
suggested, that the power is boosted with increasing field strength and
spectral index. The fields they consider ( @xmath and @xmath ) are ruled
out by the Caprini/Durrer nucleosynthesis bounds.

Lewis incorporated a more rigorous model of a primordial magnetic field
into the vector and tensor components of the CAMB code [ 59 ] , although
he neglected the scalar modes. He considered the temperature and both
the polarisation spectra although his concentration was on the @xmath
-mode which gives the cleanest signal for magnetic fields. For the
tensor modes, he found that the gravitational waves sourced by magnetic
fields after neutrino decoupling are negligible, the magnetic
anisotropic stress being countered to a large degree by the presence of
neutrinos. Those waves sourced before neutrino decoupling provide the
dominant contribution; this closely resembles the signal from
inflation-produced gravitational waves with a modified spectral index.
The non-Gaussianity of the signal would discriminate between the two, as
would the corresponding impacts on the high- @xmath temperature spectrum
and the non-Gaussianities on larger scales. Lewis found that the
magnetic signals from vector modes could begin to dominate at a high
@xmath for a field @xmath and @xmath . Lewis concluded that fields with
@xmath can yield observable impacts on the CMB, albeit requiring good
power spectra for the @xmath - and @xmath -modes.

Perhaps the greatest benefit of Lewis’ study is his detailed analysis of
the initial conditions of the problem, albeit in the GIC formalism; this
area had been somewhat neglected previously. Although he did not perform
the calculations, Giovannini [ 6 ] provided the scalar initial
conditions, in both conformal Newtonian and synchronous gauges, that
Lewis neglected. However, while his work presents full temperature and
polarisation power spectra from the magnetised vector and tensor
perturbations, and transfer functions including the impact of a magnetic
field across all scales, Lewis is heavily restricted in the type of
field he can consider by his reliance on approximations based on Mack
et. al. ’s formalism. A particular issue is the approximation for @xmath
which for ultraviolet fields is only a marginal fit and depends on the
field being both Gaussian and power law. He is also reliant on power-law
approximations for the normalisation of the power spectrum @xmath , the
effective magnetic field @xmath and the damping scale @xmath . The
approximations are regularly good only to the @xmath level and this
lessens the accuracy of his study somewhat.

Yamazaki et. al. [ 61 , 66 ] performed a parameter estimation employing
a modified CMBFast including support for scalar and vector modes. In the
earlier study [ 61 ] , they confirmed for high @xmath the previous
results that the CMB begins to deviate from the concordance model at
@xmath from the impact of scalar modes, and that the vector mode easily
dominates the scalar at larger scales. Unlike Koh and Lee, Yamazaki et.
al. employed a viscous damping scale rather than roughly determining it
from the galactic scale, although it is unclear whether this is taken
into account in the evolution equations. They, too, consider only power
law spectra and employ the common approximations summarised in, e.g. [
55 , 59 ] . They find a @xmath constraint of @xmath for @xmath where
@xmath . They also comment that there is a strong degeneracy between
these parameters. If reliable, the Caprini/Durrer nucleosynthesis bounds
rule out the existence of such a field in reality. In the more recent
study [ 66 ] they find a “concordance region” on the magnetic parameters
of @xmath at @xmath , and @xmath . This is at the @xmath level. As with
Lewis, the work of Yamazaki and his collaborators is compromised by
their reliance on the formalism reviewed in Mack et. al. and the
approximations they employ – that is, they are restricted to purely
power-law magnetic fields with Gaussian statistics, and rely upon
approximate solutions for @xmath , @xmath and @xmath that are not
necessarily accurate.

#### 5.4.3 A New Approach to the Magnetised CMB Power Spectrum

Assuming that the time-evolution of the damping scale has a negligible
impact and that we can approximately transfer the statistics employing
an equal-time correlation, the integral producing the CMB angular power
spectrum is

  -- -------- -- --------
     @xmath      (5.50)
  -- -------- -- --------

As a demonstration that we may realistically recover CMB properties by a
direct integration of this equation employing the results of chapter 4
we can employ the approximate vector and tensor transfer functions (
5.40 , 5.49 ), and either use the power spectra from analysis or from
our realisations. The more general method will be to employ the power
spectra derived from our realisations; the realised fields, while of a
limited dynamic range, can be entirely arbitrary in nature. In addition
to the limited range realisations are also hampered by an unphysical
infra-red cutoff; we deal with this issue by excising the unphysical
region from the realisation and extrapolating its behaviour back to low-
@xmath . The theoretical spectra, while lacking the errors that somewhat
hamper the large-scale realisations, are constrained to be Gaussian in
nature and, currently, of a power-law spectrum. While employing
analytical results would remove the need to interpolate a pre-existing
look-up table, the generality allowed by employing the realisations –
and the saving in time to produce the CMB angular power spectra, even
with different approximations for @xmath – can outweigh this advantage.

The form of the vector transfer function ( 5.40 ) implies that the
angular power spectrum will take the form

  -- -------- -- --------
     @xmath      (5.51)
  -- -------- -- --------

where @xmath and @xmath are functions of @xmath and the cosmology. On
numerical evaluation, the integration on the interval @xmath is seen to
be subdominant to that on the interval @xmath , and so, as did Mack et.
al. , we neglect the vector transfer function in the damped régime. This
can be understood by noting that while the first term will contain a
factor @xmath , the second term will contain extremal factors @xmath and
@xmath ; these are much smaller than the Silk wavenumber. We can thus
take the vector transfer function to be

  -- -- -- --------
           (5.52)
  -- -- -- --------

We have tested this assumption by integrating across the entire range of
@xmath ; the dominant contribution indeed arises from the @xmath
wavemodes.

The tensor transfer function

  -- -------- --
     @xmath   
  -- -------- --

contains an ISW integration which it would be preferable to pre-evaluate
to save on computation time. Changing variables to @xmath renders the
integrated Sachs-Wolfe term as

  -- -------- -- --------
     @xmath      (5.53)
  -- -------- -- --------

where we have converted the spherical Bessel functions into Bessel
functions. This can be approximated [ 55 ] by

  -- -------- -- --------
     @xmath      (5.54)
  -- -------- -- --------

which is a standard integral evaluating [ 146 ] to

  -- -------- -- --------
     @xmath      (5.55)
  -- -------- -- --------

This leaves us the transfer function

  -- -------- -- --------
     @xmath      (5.56)
  -- -------- -- --------

It remains to consider the source power spectra. There are three main
ways in which we can employ these; the most extensible is to employ the
realisations, while the easier is to employ the analytical integrations
or the large-scale approximate results. We can also employ analytical
approximations to these, as in Mack et. al. [ 55 ] , which are useful in
certain regions. We consider the Mack et. al. approxiations, the
analytical integrations, and the realisations in order.

##### @xmath from Analytic Approximations

Mack et. al. present the approximation for the source power spectrum

  -- -------- -- --------
     @xmath      (5.57)
  -- -------- -- --------

Factoring out the amplitude, we plot this approximation in figure 5.1
for @xmath and @xmath , compared to the accurate spectra we derived in
chapter 4 . It is readily apparent that this approximation is good only
on the largest scales; for @xmath it reduces to our large-scale
approximations ( 4.26 ), while for @xmath it is little better than
reasonable. The discrepancies for @xmath are unimportant since the
transfer functions vanish at the damping scale. We then do not expect
the CMB signatures from ultraviolet fields to necessarily agree
perfectly with those we generate from our own spectra. However, this
expression is a very good approximation for fields lying in the
infra-red régime and is, indeed, more useful than employing our
realisations due to the infra-red suppression in that régime.

In figure 5.2 we present the results of integrating equation ( 5.50 )
with the above power source spectrum and approximate large-scale
transfer functions. As one can see, these agree with those presented by
Mack et. al. ; the ultraviolet fields – which should, perhaps, not be
entirely trusted – cause CMB tensor perturbations that follow an @xmath
power law. The infra-red field with @xmath creates tensor perturbations
following the power law @xmath , agreeing with the prediction @xmath .
We plot the vector results only on the largest scale due to an
unresolved numerical instability associated with the spherical Bessel
function in the vector transfer function. We also observe that the
powers predicted by Mack et. al. , @xmath for @xmath and @xmath for
@xmath , are not quite those we find with our model. It is likely that
this slight difference is again caused by the numerical instability
observed with the spherical Bessel functions rather than inaccurate
analysis on the parts of Mack et. al. . The relative amplitudes between
signals are real, arising because we are employing @xmath , @xmath and
@xmath as input parameters to fix @xmath . The absolute amplitudes,
however, should be taken as indicative rather than necessarily exact.

##### @xmath from Analytic Spectra

In this case we can use equation ( 4.16 ) to generate a power spectrum
as we perform the integration over @xmath . Such a process is
computationally intensive, and it might be preferable to employ a
pre-computed look-up table where the integration has already been
performed. To do so we require a reliable interpolator and extrapolator;
since the functions are in general very smooth a linear interpolator is
likely to be more than sufficient for our purposes. In figure 5.3 we
present the results for the case @xmath , @xmath and @xmath , @xmath and
the damped causal field considered in § 4.6 . We also confirmed the
accuracy of the interpolation by directly integrating equation ( 4.16 ).

As one can see, we have replicated for @xmath and @xmath the behaviours
demonstrated previously; the angular power spectra rise as power-laws in
the region @xmath , with a stronger signal arising from stronger fields
with higher spectral indices. The signal from the damped causal
spectrum, which has not been considered before, behaves very similarly
to the pure causal field. While not necessarily a surprising result – we
have, after all, merely replaced a hard, sudden cut-off at small scales
for a softer decay – this demonstrates that we can consider a variety of
non-power law spectra without modification of our formalism.

##### @xmath from Realised Spectra

If one wishes to employ realisations, one must take into account the
infra-red cutoff. Both the vector and the tensor cases are compromised
by a low mode-coverage on very large scales; this is naturally more
severe for the vector case as the integration is dominated by the scales
below the Silk scale, which is typically much smaller than the damping
scale. The damping scale at recombination for a flat field is typically
@xmath , and @xmath for an index @xmath . The Silk scale at
recombination, above which the vector transfer function is negligable,
is typically of the order of @xmath . For a flat field, then, the vector
integration is dominated by wavenumbers below @xmath , while for the
steeply-tilted fields it is dominated by wavenumbers below @xmath . With
a simulation of side-length @xmath and a cut-off scale of @xmath , our
smallest mode is at @xmath . For the flat field (taking @xmath to avoid
aliasing of power from small scales to large), we will then only pick up
modes above @xmath and thus a relatively small number of modes below the
Silk scale. For a steeply-tilted field, taking @xmath to maximise the
available large-scale modes, we have @xmath . With an even spacing of
large-scale modes this gives us a maximum of four modes contributing to
the vector integrals. We will thus need to extrapolate the source power
spectrum back towards @xmath , correspondingly increasing the error.

The easiest way of achieving this is to consider each spectrum we wish
to employ individually. If we consider the tensor case for @xmath
(figure 5.4 , left), we can see that the infra-red cut-off is not a
major issue; a smooth interpolation will extend these spectra to the
very large-scales without issue. However, if we consider infra-red
spectra (figure 5.4 , right), the infra-red cut-off becomes highly
significant. In this case, we choose to excise the region @xmath –
which, coincidentally, corresponds approximately to the Silk scale at
recombination – and replace it with a line fitted to the source
spectrum. Doing so in this case effectively takes us back to the
approximation in equation ( 5.57 ), with @xmath . However, for a more
general field this approach is still workable, while the approximation
is not valid. Since a perfect fit of our realisations for the infra-red
region is provided by the approximation ( 5.57 ) we do not repeat this
procedure here.

#### 5.4.4 An Outline for Generating Statistics from CMBFast

A more accurate approach for generating spectra from magnetic fields
will be to employ a Boltzmann code; our formalism has been designed in
the synchronous gauge to ensure it is consistent with the
widely-employed CMBFast [ 86 ] . To construct our power spectra and
bispectra we shall first need to build a vector component to the code;
purely magnetised initial conditions can be readily adapted from
Giovannini [ 6 ] and Lewis [ 59 ] . Employing the viscous damping scales
derived in § 3.3 we can then apply separate cut-offs to the scalar,
vector and tensor evolution equations to account for photon damping. To
model the Alfvén wave oscillations we shall follow Durrer et. al. [ 52 ]
and take @xmath .

The sources in the evolution equations will be presented without their
@xmath -dependence as this will arise when we later fold across the
power spectra or bispectra. The sources are then given purely by @xmath
which can be related to the smoothed field strength @xmath on a scale
@xmath again found from

  -- -------- -- --------
     @xmath      (5.58)
  -- -------- -- --------

with @xmath ; see ( 4.7 ). This will be performed numerically at the
beginning of the run.

CMBFast does not by default generate the transfer functions for a
particular run but rather the @xmath s directly. However it is not
difficult to modify the code such that the usual calls to integrate up
the angular power spectrum instead merely return the transfer functions.
We outline the process we shall follow to generate our two-point spectra
below.

A wrapper routine generates the magnetic sources from an input smoothed
field and damping scale (of the order of @xmath at @xmath ) and then
calls CMBFast with these sources. Once CMBFast has completed its run,
instead of building the angular power spectrum it will return the
scalar, vector and tensor transfer functions to the wrapper. Once we
have the transfer functions, generating the CMB angular power spectra is
a simple matter of performing the integration

  -- -------- -- --------
     @xmath      (5.59)
  -- -------- -- --------

The code to perform this integration is that employed in the previous
section. This integration can again obviously be performed over power
spectra resulting from the analytic integrations or from realisations;
as before the more extensible approach is to employ the realised
spectra. @xmath and @xmath can take any of the values permitted in
chapter 4 – that is, @xmath .

### 5.5 The CMB Bispectrum

The CMB angular power spectrum is a two-point statistic and the
integration over wavemodes used to generate it includes a contribution
from two transfer functions. Perhaps the most instructive case is that
of the temperature/polarisation cross-correlation sourced by scalar
perturbations:

  -- -------- -- --------
     @xmath      (5.60)
  -- -------- -- --------

In this integration we have the relevant power spectrum – here the
initial spectrum of scalar perturbations – and one transfer function
corresponding to the correlated quantities at two points on the sky. A
sensible suggestion for the form of the three-point CMB angular
correlation, the bispectrum , is then that we integrate a primordial
bispectrum across three transfer functions. For the vector-tensor-vector
correlation, for example, we might suggest that the CMB angular
bispectrum is

  -- -------- -- --------
     @xmath      (5.61)
  -- -------- -- --------

where the integral is across three wavenumbers because the three
wavemodes form a closed triangle rather than being degenerate.

This expression is not entirely accurate; we have not, for example,
enforced the triangle conditions on the wavenumbers @xmath , @xmath and
@xmath . We should also be suspicious about whether this expression has
accurately mapped the primordial bispectrum onto a sphere; while in the
two-point case the spherical Bessel functions that one would imagine
should arise are cancelled by the delta function this is not necessarily
the case when the three wavemodes form a closed triangle. If one works
accurately through the calculation then one sees that, indeed, we are
missing important terms. The integrand includes a term

  -- -------- -- --------
     @xmath      (5.62)
  -- -------- -- --------

where @xmath is an arbitrary real-space variable. This term accounts for
an accurate wrapping of the bispectrum onto the 2-dimensional CMB sky
and can be calculated recursively (see § F.2 ) with relative ease. We
also have a Wigner 3- @xmath symbol premultiplying the integration; the
conditions of this symbol enforce the triangle inequality

  -- -------- -- --------
     @xmath      (5.63)
  -- -------- -- --------

on the multipole moments, and ensures that they sum to an even integer.
The CMB angular bispectrum generated by a primordial bispectrum @xmath
can then be written as

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            (5.64)
                                @xmath   
  -- -------- -------- -------- -------- --------

We derive this in the line-of-sight approach in appendix F ; see also
Wang and Kamionkowski [ 186 ] and Ferreira, Magueijo and Górski [ 187 ]
. Here @xmath are the amplitudes of the wavevectors forming a closed
triangle on the sky; these are, of course, entirely equivalent to the
variables employed in chapter 4 and are related by @xmath and @xmath .

It is common to follow [ 187 ] and define a more limited measure of the
bispectrum

  -- -------- -- --------
     @xmath      (5.65)
  -- -------- -- --------

which more intuitively resembles to the angular power spectrum and will
contain much of the information contained within the bispectrum. Whether
or not we employ the angular bispectrum or this limited bispectrum is
immaterial; it is clear from their form that, given pre-computed
primordial bispectra, it is simple to predict the form of the
corresponding CMB angular bispectra. Solving this equation is clearly
very similar to solving the two-point case; given a pre-computed
primordial bispectra – such as those from chapter 4 – we merely require
the relevant transfer functions to calculate the CMB angular bispectrum.

The main problem generating estimates for the CMB bispectra is the sheer
size of the primordial bispectra – even for @xmath we require a full
primordial bispectrum. In principle the integration is similar to that
in the two-point case, merely needing an extra call to the function
@xmath . However, in the three-point case we must integrate over a 3-D
function rather than the effective 1-D function we had for the spectra.
Again, if we wished we could call a primordial bispectrum generation
routine for each @xmath ; this, however, would be ruinously slow.
Instead we shall employ look-up tables, generated either from analysis
or from realisations. Even this has its drawbacks; while the look-up
tables produced for a power spectrum are relatively small, being of
length @xmath , those for a bispectrum are anything but, being of size
@xmath . Moreover, a full three-dimensional primordial bispectrum takes
a long time to compute if one wants to run enough simulations with a
large enough dynamic range to reduce the errors in the final CMB plots.
Nonetheless, for reasons of extensibility it will again be preferable to
employ bispectra and use analytical plots only to verify simple,
Gaussian power-law cases. To overcome the infra-red cut-off we can again
excise the low- @xmath region and fit a three-dimensional curve in a
case-by-case basis to employ in the integration.

The main advantage of the method we are proposing is not that the
physics is in any way different – obviously, that is not the case – but
rather that we have exploited the simple time-evolution of the magnetic
sources to decouple the integration forming the angular (bi-)spectra to
enable us to generate intrinsic bispectra separately from the transfer
functions. We are also relying on numerical methods to produce our
results and this gives us great freedom in the choice of our magnetic
field. While we have chosen to consider primarily Gaussian, power-law
magnetic fields the formalism is general enough to consider any
underlying statistical nature and any power spectrum. As we have shown
in this brief section, extending our method from two-point to
three-point angular spectra can be achieved with relative ease – it is
merely a question of implementation, and the problems are technical and
concern the size and lengthy computation of the intrinsic bispectra
rather than questions of the physics. In the approach employed thus far
in the literature ( [ 52 , 53 , 55 ] for example), on the other hand,
the authors are concerned with finding closed-form, analytic solutions.
This necessitates them making repeated approximations, many with
relatively limited validity, and deriving even the two-point spectra is
relatively complex. Extending the formalism to consider CMB bispectra
would be extremely non-trivial.

One should not overstate the advantages of our methods. The intrinsic
bispectra are heavily compromised by our limited dynamic range.
Requiring a selection of three wavevectors, forming a closed triangle,
severely restricts the number of contributory modes at each point. We
must then repeat the simulations – around 1,500 times for a gridsize of
@xmath – to reduce the errors to workable amounts. This compounds the
previous issue with a limited dynamic range for the realisations causing
inaccuracies in, for example, integrations across the vector transfer
functions. The time required to naïvely produce an intrinsic bispectrum
is large and increases linearly with repeated simulations, and the
resulting files are correspondingly huge. For infra-red fields, we will
also again have significant divergences at low- @xmath , which will need
to be removed by examination. It is likely that this will be most easily
achieved by examining the colinear case to determine a large-scale
cut-off, excising the bispectrum for all larger-scale modes, and then
extrapolating onto the large scales from the more trustworthy points. In
the infra-red régime, bispectra are relatively simple, and a
three-dimensional interpolater should have little trouble fitting a
curve we can extrapolate onto the large scales. However, we feel that
despite these drawbacks this approach will most realistically allow us
to make accurate predictions concerning the various three-point
correlations induced by magnetic fields onto the microwave background.
Moreover, it is again merely a matter of implementation to extend our
results to correlations between temperature and polarisation, or to
four-, five- and @xmath -point correlations – this involves calculating
the intrinsic statistics and folding them in a consistent manner onto
the microwave sky by use of the transfer functions, something that is
relatively simple using the realised fields but rather complicated
analytically.

### 5.6 Conclusion

We have demonstrated in this chapter that our formalism, developed in
chapters 3 and 4 , is sufficient to model a linear cosmology including a
stochastic magnetic field and produce accurate photon transfer
functions. After reviewing the current literature considering the
impacts of a magnetic field – first briefly on nucleosynthesis but then
concentrating on the CMB sky – we then demonstrated that one can
numerically integrate the expression for @xmath employing pre-computed
primordial power spectra and reproduce the correlations induced by a
magnetic field. While the resulting CMB angular power spectra we
presented in this chapter are generally not new, they should serve as a
demonstration that our approach is valid. Rather than restrict ourselves
to very simple field configurations, we have developed an approach that
is highly extensible and based upon flexible models of magnetic fields,
capable of dealing with non-power law spectra and arbitrary statistics.
Our presentation of the statistics of the simply damped causal magnetic
field demonstrates this. The flexibility allowed by the presented
formalism will enable us to consider the impact on the CMB temperature
and polarisation angular power spectra of more realistic primordial
scenarios than has hitherto been possible. This could be significant,
particularly in the light of the CBI excess observed in the temperature
auto-correlation. Ongoing and upcoming missions – such as CBI and VSA [
80 ] , ACBAR [ 81 ] , SPT [ 84 ] , CAPMAP [ 83 ] , Boomerang [ 82 ] and
Planck [ 175 ] , in particular – will extend our knowledge of the
small-scale temperature and polarisation power spectra enormously, and
the two-point measures of these will allow us to constrain the possible
properties of a primordial magnetic field with much more accuracy than
is currently possible. With the formalism presented in this thesis, we
are no longer restricted to considering only simple Gaussian power-law
fields and can instead directly test field configurations arising from
particular magnetogenesis mechanisms. Simulations are, however, limited
in dynamic range – the mechanism of Matarrese et. al. [ 31 ] , for
example, is difficult to model with the range allowed by today’s
computers. We must also add that our approach, and those that preceded
it, may not necessarily be valid for ultraviolet fields, due to their
strong dependence on the time-evolving damping scale. This would
conceivably introduce decoherence in the perturbations, requiring us to
employ full non-equal time correlators to determine the imprint on the
CMB. This will be considered in more detail in the future.

A more realistic probe for primordial magnetic fields that the CMB
provides is likely to be the non-Gaussianity that a magnetic field will
induce. The field strength of the magnetic field is necessarily small to
avoid violation of nucleosynthesis bounds; however, a magnetic field is
also likely to be one of the few primordial sources capable of
imprinting non-Gaussianity on the CMB sky at all scales. In the standard
approach, predictions of CMB non-Gaussianity arising from such a
magnetic field would be extremely complex, even assuming purely
power-law power spectra and Gaussian statistics. In our approach,
generating maps of CMB non-Gaussianity is simply a matter of integrating
equation ( 5.64 ) or ( 5.65 ) employing @xmath and @xmath calculated
previously, which is a more realistic proposition. It will then be a
relatively simple matter to predict the forms of the various possible
bispectra arising from primordial magnetic fields both of the standard
Gaussian power-law type – for which we might employ analytical as well
as purely numerical methods to derive the intrinsic statistics – and of
more general forms. Again, we are limited by the dynamic range, and more
severely than is the case for the two-point moments, due to the
mode-selection necessary in forming closed triangles. There is also a
severe infra-red divergence in the primordial bispectra and we will
necessarily have to excise the large-scale region and replace it with a
surface fitted to the smaller-scale bispectra. We are also limited by
matters of practicality – intrinsic bispectra take a long time to
generate and are relatively large. However, they need only be computed
the once and can be employed many times for different scenarios; a
continuously-sourced field, for example, will generate different
transfer functions than a field that has been in existence since before
neutrino decoupling. Care would need to be taken in such a case that the
sources remained coherent. The non-Gaussianity of the CMB is currently
only weakly constrained by WMAP, even on the large scales; this is
partly due to the method by which we assess it. Knowing the signatures
to test for given a particular scenario will help target future
searches. Forthcoming missions are expected to improve detection
significantly. A usual measure of non-Gaussianity is known as @xmath ;
this characterises the strength of a non-Gaussian component to the
initial curvature perturbation [ 188 ] . While it is not particularly
meaningful at present to relate this parameter to the non-Gaussianities
from magnetic fields, it is indicative that while the first year of WMAP
data can only constrain @xmath to @xmath [ 79 ] , the full eight-year
WMAP data might constrain it to @xmath [ 189 ] . The Planck satellite is
likely to constrain it to the order of unity, @xmath [ 189 ] . It would
then seem plausible that Planck will measure the CMB non-Gaussianity
sensitively enough to allow us to search for the imprint of primordial
magnetic fields, and tighten the constraints derived from the two-point
statistics.

## Chapter 6 Discussion and Conclusions

In this thesis we have considered various aspects of the cosmological
magnetic field and the impact it has on the pre-recombination universe
and on the microwave background. In chapter 2 we constructed a unified
formalism for an unmagnetised, linear cosmology in a synchronous-gauge
FLRW universe, considering the vector perturbations on an equal footing
to the scalar and the tensor perturbations. While this does not involve
much modification for fluid matter, we have presented the formalism for
effective fluids governed by the Boltzmann equation, adapting and
extending the results of Landriau and Shellard [ 109 ] . We derived the
form of the CMB transfer functions for temperature in a traditional and
in a line-of-sight formalism for scalar, vector and tensor modes.
Polarisation is considered in appendix D .

In chapter 3 we then incorporated a magnetic field into this
perturbation theory. Some results were presented for the first time in a
greater detail than has been previously, leaving the perturbation
character of the magnetic fields entirely unspecified and leaving open
the simple adaptation of the equations to a two-parameter system wherein
the geometry is linearised with an explicit parameter @xmath while the
magnetic field is linearised with an independent parameter @xmath , and
combinations of the two are not neglected. We considered the effects of
the magnetic field on the Lorentz forces and the stresses in some detail
and reviewed the results of Subramanian and Barrow [ 70 ] and Jedamzik,
Katalinić and Olinto [ 69 ] , in which they derived the damping of
magnetic fields from photon viscosity. We returned to this matter in
chapter 5 .

Chapter 4 considered in detail the full statistics of the magnetic
sources that would be included in a numerical model of the magnetised
cosmology. Exploiting the large-scale time-independence of a scaled
field @xmath , we presented analytical expressions for the two- and
three-point moments of the static magnetic stresses, separated into a
scalar trace, traceless scalar, two vector and two tensor degrees of
freedom. We then employed these analytical expressions, derived for the
very specific (and perhaps unrealistic) case of a Gaussian-distributed
magnetic field with a power-law spectrum, to confirm the accuracy of
numerically simulated fields generated on a finite grid. These numerical
models can be constructed with arbitrary power spectra and statistical
character and are vastly more flexible than the analytical approach; the
drawback is the limited dynamical range and computational time required.
Excellent agreement was found between the analytical approach and the
simulated fields, leaving open the study of more generic power spectra
and statistical natures.

At the two-point level we constructed the power spectra of the different
components of the stress-energy tensor, confirming and greatly extending
the previous results. By the nature of the separation, the
cross-correlations vanish. Differing behaviours for the ultraviolet
régime @xmath and the infra-red régime @xmath were confirmed, with the
bluer spectra being dominated on large-scales by the intrinsic damping
scale, and the infra-red spectra losing their features and behaving as
@xmath .

Even for the simple power-law and Gaussian case significant
non-Gaussianities were found at both the one-point level for the scalar
pressures, and the three-point level for a wide variety of
cross-correlations. At the one-point level the isotropic pressure (and
thus energy density) of the field behaves, as expected, as a @xmath
-distributed field and this is insensitive to spectral index. The
anisotropic pressure, on the other hand, is relatively Gaussian, due to
its non-local dependence on the magnetic fields diluting the
non-Gaussianity. The statistics of the anisotropic stress are dependent
on the spectral index.

At the three-point level we modelled non-Gaussianity with a bispectrum
method, considering rotationally-invariant combinations such as @xmath .
This is, to our knowledge, the first time that cross-correlations
between different components of the scalar-vector-tensor split have been
studied with a bispectrum method and we presented the full analytical
results. Although severely limited by a sparse mode-selection, averaging
a large number of random simulations generated a superb agreement with
the predictions. The intrinsic bispectra for the infra-red power-law
case with @xmath contain many features and are dependent on the damping
scale. These spectra are tightly constrained to unobservable levels by
the Caprini/Durrer nucleosynthesis bounds. For the more realistically
observable case with an infra-red spectrum @xmath the features observed
are washed out by the extreme tilt; more interestingly the nature of the
@xmath correlation on large scales changes drastically – for ultraviolet
fields this cross-correlation vanishes on large scales while for
infra-red fields, along with the other bispectra, it behaves as @xmath .

We also briefly presented the one-, two- and three-point results for the
Lorentz forces. The Lorentz forces are directly proportional to
components of the stress-energy tensor; the proportionality does,
however, include the wavenumber and this modifies the angular
integrations. At the one point level, the scalar Lorentz force inherits
the nature of the anisotropic pressure and is relatively Gaussian
compared to the isotropic pressure. It is also sensitive to the spectral
index. At the two-point level, the dependence on the wavenumber drives
the auto-correlations to zero on large-scales and a length-scale is
introduced at which the power spectra turn over. The three-point
correlations have a similar nature; only two rotationally-invariant
combinations are possible, the scalar auto-correlation and the
cross-correlation between the scalar and the vector isotropic spectrum.
Both agree to good accuracy between simulated fields and analysis. These
bispectra are again vanishing on large-scales for a flat spectrum. While
they do also vanish on large-scales for a strongly-tilted spectrum (by
construction) the behaviour close to @xmath is very similar to that of
the stresses.

As an illustrative example we then briefly considered a modified power
spectrum, taking a causally generated field with @xmath and introducing
an exponential damping rather than a sudden cutoff. This is a crude
approximation for the type of field that would be generated by a process
other than inflation (or some other acausal early-universe source) such
as plasma processes before and at recombination. These precise
magnetogenesis models are unlikely to generate Gaussian fields – indeed,
fields sourced at second-order by the first-order density perturbation
are @xmath distributed – and are, moreover, likely to be too weak to
have an observable impact upon the CMB. However, it is not inconceivable
that some process existed at some time before or after neutrino
decoupling that generated a causal magnetic field with a greater
strength. The gross features of a damped causal magnetic field are very
similar to the @xmath case considered previously. We again confirmed the
simulated fields with an analytical integration.

The techniques developed and employed in this chapter, and particularly
the simulations of the fields, have a greater validity than just the toy
model of a primordial magnetic field that we have considered. There are
various possible non-linear sources, and each such source will
contribute non-Gaussian signatures. Cosmic strings are a natural example
of such a source. Modification to our codes would naturally be
necessary; however the basic techniques could be highly adaptable if
care was taken to consider the decoherence introduced by an evolving
source.

In chapter 5 we turned to the observational impacts of a simple
primordial magnetic field, first reviewing limits from nucleosynthesis.
A conservative estimate [ 5 ] shows that the current magnetic field
strength is constrained from nucleosynthesis to be of the order of
@xmath , while stringent – albeit controversial – limits can be found by
considering the gravitational waves produced from a magnetic field [ 23
] ; for a field with a flat spectral index, smoothed on a sub-megaparsec
scale, these can be as strict as @xmath .

However, it is with the CMB that we chiefly occupy ourselves. We
described how one can evaluate the damping scales without recourse to
power-law approximations before outlining the basic procedure by which
the intrinsic statistics derived in the previous chapter could be
wrapped onto the CMB. To do so requires the photon brightness functions,
and as a first approximation, and to act as illustrative examples, we
derive the large-scale approximations of these for the vector and tensor
perturbations. These reproduce from our own formalism those in Mack et.
al. [ 55 ] and include the vector tight-coupling approximation. The
vector transfer functions are found to differ dramatically between
different damping régimes for perturbations below and above the Silk
scale, while the tensor transfer functions are found to consist
predominantly of an integrated Sachs-Wolfe term.

We considered the two-point statistics of the CMB, first briefly
reviewing the results of previous analytical studies. The small-scale
studies suggest that for a steeply-tilted spectral index a magnetic
field of approximately nano-Gauss strength would begin to dominate the
standard @xmath CDM at around @xmath , with stronger signals for
shallower spectra. The large-scale studies consider the magnetic field
when its impact is generally subdominant for the temperature
auto-correlation and thus concentrate on the polarisation spectra. We
then reviewed the more accurate numerical results which employed CAMB [
59 ] or CMBFast [ 51 , 61 , 66 ] with magnetic sources. These studies,
each limited in their own way, confirmed and extended the previous
analytical estimates. Magnetic signals on the temperature
auto-correlation spectrum dominate for highly-red nano-Gauss fields at
around @xmath and at much lower levels for shallower indices. A causal
field might be expected to contribute a large amount towards the
possible excess of small-scale power observed by, for example, CBI [ 80
] and ACBAR [ 81 ] , and this suggests a constraint on the amplitude of
such a field. Lewis performed far the most complex study and his
contributions to the initial conditions required, in particular, are
invaluable. Despite being magnetised Boltzmann codes, and generating in
principle fully accurate transfer functions, these studies still rely on
the previous analytical approximations and are thus restricted solely to
Gaussian power law fields, and reliant on approximations for the
normalisation of the power spectrum and the source spectra that are not
necessarily particularly accurate.

Using our own formalism, we demonstrated that our approach is valid,
reproducing the forms of Mack et. al. [ 55 ] for the angular power
spectrum. We also presented the angular power spectrum imprinted by a
Gaussian field with a damped causal spectrum; this is not significantly
different from a causal field with a sharp cut-off, as should be
expected. However, it serves as a demonstration that not only can we
model the CMB imprints of fields that have been considered before, but
also that we can consider more general fields that would be intractable
analytically. By generating their intrinsic power spectra through
realisations and folding them across the usual magnetised transfer
functions, we can then predict the observable impact of an entirely
generic magnetic field. A motivation for this comes from the field
produced by second-order mixing of scalar and vector perturbations [ 31
, 32 , 33 ] . Regardless of the details of these studies, such a
magnetic field will be naturally @xmath -distributed for Gaussian
initial conditions, and will possess a damped causal power spectrum of
some form. Unfortunately our formalism is limited by dynamic range and
it is not possible to use the form of power spectrum from, for example,
[ 31 ] with any great accuracy. Nonetheless with a new generation of
small-scale ( @xmath ) CMB results expected from CBI and VSA [ 80 ] ,
ACBAR [ 81 ] , Boomerang [ 82 ] , CAPMAP [ 83 ] , SPT [ 84 ] and Planck
[ 175 ] , we might expect to constrain the possible properties of a
primordial magnetic field with much more accuracy than is currently
possible, and our approach allows us to consider a wide variety of
fields from a wide variety of magnetogenesis mechanisms.

We finally turned to briefly considering the non-Gaussianity of the CMB.
While magnetic fields contribute fluctuations to the CMB angular power
spectra, their effect is relatively minor compared to that from standard
cosmology, until one considers the very small scales. While the upcoming
CMB observations will greatly improve observations on a small scale and
the potential is there to constrain magnetic fields – Yamazaki et. al.
have derived impressive constraints on a Gaussian power law field in [
66 ] and these might be tightened as observations improve – they will
still be compromised by foregrounds. The non-Gaussianity imprinted by
even a Gaussian magnetic field, however, will be on large-scales as well
as small scales, and a primordial magnetic field is one of relatively
few sources that is expected to imprint a significant primordial
non-Gaussian signature. The eight-year WMAP data and results from the
Planck satellite are expected to constrain non-Gaussianities well – to
the level of @xmath for optimal WMAP results, and to @xmath for Planck.
While there is no direct correspondance between @xmath and the
non-Gaussian signatures of a magnetic field, this does suggest that the
sensitivity might be there to detect magnetic non-Gaussianities. We
choose to characterise the CMB non-Gaussianity with an angular
bispectrum and demonstrate that this can be evaluated straightforwardly
using an extension of our two-point methods. The situation is
complicated by the unwieldy nature of the intrinsic magnetic bispectra,
but this is merely a technical issue rather than a fundamental flaw.
Given the transfer functions for a magnetised cosmology, which would
ideally be generated by a modified Boltzmann code such as CAMB [ 67 ] ,
CMBFast [ 86 ] or CMBEasy [ 143 ] , it is a matter of integrating
equation ( 5.65 ) for a chosen pre-generated intrinsic bispectrum. This
process is, however, lengthy and the bispectra are severely limited by
the dynamic range of the realisations. However, this method will be both
more accurate and more extensible than an analytic approximation would
be. It seems plausible that the next generation of CMB observations will
be capable of strongly constraining the CMB non-Gaussianity; our
formalism will then allow researchers to search for the imprint of a
primordial magnetic field and perhaps constrain magnetogenesis models
more tightly than is possible with the two-point spectra.

Magnetic fields are likely to be present in the universe from the
earliest times and fields strong enough to affect the CMB sky are
entirely likely. In this thesis we have presented a magnetised cosmology
in a formalism easily incorporated into the Boltzmann code CMBFast and
examined in detail the statistical nature of the magnetic sources. We
have then demonstrated that we can numerically produce the CMB
anisotropies in an extensible manner that is not restricted by the
nature of the fields. This approach is easily adapted for considering
the non-Gaussianity such a field would induce onto the microwave sky.
With the improvement in CMB data within the next decade expected to
tightly constrain the CMB non-Gaussianity, we can then have a solid test
of a primordial magnetic field.

## Appendix A Further Issues in Perturbation Theory

In this appendix we shall briefly cover some fundamental issues in
relativistic cosmological perturbation theory that we did not mention in
the main text. We begin with a derivation of the Robertson-Walker metric
and proceed to a discussion of gauge issues in a linearly-perturbed FLRW
universe.

### a.1 Derivation of the Robertson-Walker Metric

We arrive at our assumptions for the metric by extending the Copernican
principle out into the universe. In its bare form, the Copernican
principle states that the Earth is in no special location in either the
solar system or the universe. It seems ridiculous to think that our
solar system – in an unremarkable part of the galaxy – is at a preferred
location in the universe and the Copernican principle is precisely that
it is not. When married to observations of the CMB demonstrating that it
is isotropic to at least one part in ten thousand the Copernican
principle leads us to model the current universe as a
maximally-symmetric space of some sort. It is maybe worth commenting
that merely because the current observations strongly support a universe
isotropic about the Earth there is no good reason to believe that this
always had to be the case and models of cosmology that tend
asymptotically to the isotropic are allowed by the observations so long
as they satisfy nucleosynthesis and CMB bounds. Our derivation of the
Robertson-Walker metric follows that of Carroll [ 190 ] .

#### a.1.1 Maximally-Symmetric Spaces

Consider a four-dimensional spacetime with the greatest possible number
of isometries – transformations on the metric that leave it unchanged,
equivalent to Killing vectors. In this spacetime there are obviously
four translation symmetries, corresponding to the four axes of some
co-ordinate system. If we set up a co-ordinate system about a point
@xmath we can also see that there are six independant rotations after we
have removed those that mirror another. This leaves us with the expected
ten isometries in a four-dimensional space. This argument is strictly
applicable directly only in flat space; however, it only concerned the
nature of the space local to the point @xmath – that is, in a Riemannian
co-ordinate system. The co-ordinate system chosen will not affect the
maximum number of independant isometries, and the point @xmath was
chosen arbitrarily, and so this conclusion can be applied in any
situation regardless of the curvature of the space.

In a maximally-symmetric space, the curvature obviously has to be the
same at each point (by the translation symmetries); this restricts the
number of maximally-symmetric spaces – one merely needs the Ricci scalar
and we can surmise that we can take a prefactor to be negative, zero or
positive. That is, we expect only three maximally-symmetric spaces.

To quantify this statement, let us construct the Riemann-Christoffel
tensor. Consider a Riemannian co-ordinate system about some arbitrary
point in the maximally-symmetric spacetime with metric @xmath . This
metric is invariant under a Lorentz transformation to another Riemannian
co-ordinate system and we would wish for the associated
Riemann-Christoffel tensor to behave in the same way. It must then be
constructed from the metric and from the few other tensors that remain
invariant under Lorentz transformations – the Kronecker delta and the
Levi-Civita tensor density. If we make combinations of these tensors we
can then match them against the required – and stringent – symmetries
for the Riemann-Christoffel tensor. The only combination that matches
the symmetries is

  -- -------- --
     @xmath   
  -- -------- --

This is a tensorial relation and so is applicable in all reference
frames; moreover, our choice of @xmath was arbitrary, and so the
equation holds across the whole spacetime. We then express the curvature
tensor of a maximally-symmetric spacetime as

  -- -------- --
     @xmath   
  -- -------- --

Contracting across the first and fourth indices leaves

  -- -------- --
     @xmath   
  -- -------- --

and contracting this again leaves us with

  -- -------- --
     @xmath   
  -- -------- --

which fixes the proportionality constant, finally yielding

  -- -------- -- -------
     @xmath      (A.1)
  -- -------- -- -------

So if

  -- -------- --
     @xmath   
  -- -------- --

is the measure of curvature of the space – which can be either
positively curved, negatively curved, or zero and is usually normalised
to @xmath – then in four dimensions we have the Ricci tensor and scalar

  -- -------- --
     @xmath   
  -- -------- --

and so the Einstein tensor

  -- -------- --
     @xmath   
  -- -------- --

This then implies (by the Einstein equations) a matter that obeys

  -- -------- --
     @xmath   
  -- -------- --

being directly proportional to the metric tensor, this is a cosmological
constant.

We have thus shown that there are only three spaces of maximal symmetry,
which are called de Sitter space if @xmath , Minkowski if @xmath and
anti-de Sitter if @xmath . The physical interpretation is that the de
Sitter universes contain only a vacuum energy and are in a state of
either eternal expansion or eternal collapse (see equation 2.62 ), while
Minkowski space is non-gravitating. (Quasi-)de Sitter spaces are vital
in inflationary and dark energetic theories (see for example § 2.5 ),
corresponding as they do to a universe filled with a cosmological
constant (a vacuum energy density) or a scalar field mimicking such,
while anti-de Sitter spaces are frequently employed in string and
string-inspired theories, such as braneworld models of cosmology [ 191 ,
192 , 193 ] .

#### a.1.2 The Robertson-Walker Metric

The (Friedmann-LeMaître-)Robertson-Walker metric is the basis of modern
cosmology, being the metric that results when one imposes isotropy and
homogeneity upon a spacelike slicing of the universe. One could attempt
to use a fully maximally-symmetric metric but, as we have shown, there
are only three of these, de-Sitter space, anti de-Sitter space, and
Minkowski space, and these are not acceptable models of the current
universe; even though this would hold only on the largest scales, the
exponential expansion or collapse of the de Sitter models is simply not
observed, even taking into account the recent supernova results implying
an acceleration in the expansion of the universe [ 104 , 78 ] . Instead,
we wish to find a maximally-symmetric 3-space but allow for a generic
time evolution.

We thus impose a milder implementation of homogeneity and isotropy, for
a spacelike slicing with metric @xmath , by taking the spacetime line
element to be

  -- -------- --
     @xmath   
  -- -------- --

where @xmath are some (comoving) co-ordinates that ensure the time-space
cross-terms vanish. This metric models a maximally-symmetric spacelike
surface evolving with a time parameter @xmath .

The Riemann-Christoffel tensor on this 3-dimensional spacelike
hypersurface is

  -- -------- --
     @xmath   
  -- -------- --

which has the Ricci tensor

  -- -------- --
     @xmath   
  -- -------- --

As a convenient choice of co-ordinates, we shall employ spherically
symmetric co-ordinates – a space of maximum symmetry will certainly be
spherically symmetric. Appropriating the spacial part of the
Schwarzchild solution we express

  -- -------- --
     @xmath   
  -- -------- --

which has the Ricci tensor

  -- -------- --
     @xmath   
  -- -------- --

with all other components zero. We can then use the relationship between
the Ricci tensor and the metric to read off the components (defining
@xmath ) and solve for @xmath ; that is use the equations that result
from

  -- -------- --
     @xmath   
  -- -------- --

to determine @xmath and the Robertson-Walker metric. This expression
contains only two independant equations,

  -- -------- -- -------
     @xmath      (A.2)
  -- -------- -- -------

The solution of the first of these is found by setting @xmath and
integrating, whence

  -- -------- --
     @xmath   
  -- -------- --

with @xmath the constant of integration. Substitution into the second
equation quickly gives us

  -- -------- -- -------
     @xmath      (A.3)
  -- -------- -- -------

We then have that the line element on the maximally-symmetric
hypersurfaces is

  -- -------- -- -------
     @xmath      (A.4)
  -- -------- -- -------

A common alternative is to employ co-ordinates

  -- -------- -- -------
     @xmath      (A.5)
  -- -------- -- -------

implying

  -- -------- -- -------
     @xmath      (A.6)
  -- -------- -- -------

and

  -- -------- -- -------
     @xmath      (A.7)
  -- -------- -- -------

We then find Euclidean space for @xmath , a sphere for @xmath and a
hyperboloid for @xmath .

Going to our full spacetime we then have the FLRW metric,

  -- -------- -- -------
     @xmath      (A.8)
  -- -------- -- -------

where @xmath is dimensionless and @xmath is the “scale factor” giving
the physical size of the spacelike slices. In this work we have taken
the more usual approach of setting @xmath as the dimensionless scale
factor and a radial co-ordinate @xmath with the units of distance,

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (A.9)
                       @xmath   @xmath   
  -- -------- -------- -------- -------- -------

where in the second equation we have converted to “conformal time”
@xmath which puts us into a co-ordinate system that is conformally
Minkowski if @xmath . For simplicity, we shall take the metric to be
conformally-Minkowski throughout, which reduces the harmonic functions –
the eigenvectors of

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the covariant derivative with respect to @xmath – to the
Fourier modes @xmath .

### a.2 Perturbation Theory and Gauge Issues

The (Friedmann-LeMaître-)Robertson-Walker metric derived in the last
section forms the large-scale “background” model for our cosmology; to
begin to approach a realistic model of the universe, we must perturb
this metric to some order in an implicit perturbation parameter @xmath .
Doing so immediately raises the issue of gauge variance; general
relativity is a gauge theory and, while the metric has ten degrees of
freedom, there are only six independently contained within the
perturbations – two of scalar form under arbitrary co-ordinate changes,
two of vector (gradient and divergenceless modes) and two of tensor (
@xmath - and @xmath -type polarisations). We thus have four degrees of
freedom in the metric perturbed to first-order in the geometry which
must be removed to ensure the physicality of the results.

There are two main approaches to perturbation theory that have been
employed in cosmology; the first is the metric-based approach pioneered
by Lifshitz as long ago as 1947 [ 73 , 74 , 75 ] ; see [ 194 , 94 , 108
, 145 ] for an inexhaustive list of a few more modern reviews. The basis
of the metric based approach is familiar in style from perturbation
theory in other areas of physics and particularly in fluid mechanics; we
assume a “background” geometry that we know to be fictional, and then
add in perturbations to some order to gain a better approximation of the
physical situation. In effect, we are making a map from a fictional,
smooth manifold onto a perturbed, “physical” manifold. The problems in
this approach arise from the gauge-dependence of general relativity and
the complications from assuming from the outset a purely fictional
background metric. The older approach to metric-based perturbation
theory was to select a gauge to work in throughout, the most common
choices being the conformal Newtonian (or longitudinal) gauge – or the
related Poisson gauge when vector (vortical) perturbations are also
considered – and the synchronous gauge initially used by Lifshitz, in
which the universe is foliated around either the cosmic or conformal
time with comoving hypersurfaces. The synchronous gauge has the benefit
of physical lucidity – the line element of the flat Robertson-Walker
geometry closely resembles that of Minkowski space, as opposed to that
of the conformal Newtonian gauge which, as its name might suggest, more
closely resembles linearised gravity – but has a distinct drawback: as
we show in the next section, synchronous gauge is not a uniquely defined
gauge and possesses spurious “gauge modes” which one has to be careful
to remove. Ma and Bertschinger provide a useful review of linearised
perturbation theory – for scalar perturbations – in both the synchronous
and conformal Newtonian gauges, though one should be aware that their
definitions of perturbed quantities differ significantly from those we
employ in this thesis. Beginning with Bardeen (for example, [ 195 , 196
] ) a “gauge-invariant” approach to metric-based cosmological
perturbation theory has grown in popularity; this involves removing
gauge ambiguities by combining variables (defined in some gauge) in such
a way that they are invariant under some gauge transformation. While
admittedly contrived, this approach has significant advantages over the
older approach of fixing a single gauge and working within it. This
approach is now widely employed and the review of Mukhanov, Feldman and
Brandenberger [ 94 ] is an excellent introduction to this formalism. The
other main approach that has been employed is the gauge-invariant and
covariant (GIC) approach to cosmology, introduced by Ellis and Bruni [
98 , 99 ] ; see also the comprehensive review [ 100 ] and [ 68 , 72 , 71
] for selected examples of its application to magnetised spacetimes. The
GIC approach is a 3+1 split superficially similar to the ADM formalism [
197 ] , in which spacetime is separated around the congruence of
“fundamental” observers’ four-velocities – where “fundamental” observers
would be roughly equivalent to comoving observers in the standard
metric-based approach. Using the four-velocity as the timelike
parameter, spacetime is then foliated with planes instantaneously
orthogonal to the four-velocity. The main benefit of the GIC comes from
the Stewart-Walker lemma [ 198 ] which states that any quantity that
vanishes on a background manifold is automatically gauge-invariant on
the perturbed manifold. ¹ ¹ 1 It is worth pointing out that the
definition of “gauge-invariant” between the standard and the GIC
approaches is thus somewhat different. Applying this to cosmology, we
may define a Robertson-Walker manifold as an implicit “background” and,
by forming quantities that vanish in a Robertson-Walker metric, we may
automatically reduce the full non-linear equations to those for a
zeroth- and first-order perturbed Robertson-Walker metric with the
assurance that gauge issues have been avoided.

#### a.2.1 Metric-Based Perturbation Theory

In this section we shall briefly discuss first-order metric
perturbations of the flat FLRW metric and the gauge issues that arise.
We employ a flat metric partly for the pure simplicity it introduces to
the equations; however, it should be noted that the current observations
strongly support a universe that is, at the most, only mildly differing
from a flat case [ 78 ] . With the simplifying assumption @xmath we can
expand our spatial variables across Fourier modes @xmath , rather than
constructing harmonic eigenvectors in a closed or an open geometry (see
for example [ 145 ] for a generalised discussion).

Mukhanov, Feldman and Brandenberger [ 94 ] present a lucid introduction
to gauge transformations and perturbed geometries; further details may
be found in, for example, Weinberg [ 96 ] , Wald [ 92 ] or Carroll [ 190
] . We present the first-order FLRW metric here as

  -- -------- -- -- -------- --------
     @xmath                  (A.10)
                             
                    @xmath   
  -- -------- -- -- -------- --------

The perturbed section of the metric can be made up of quantities derived
from scalar, vector and tensor quantities.

Consider first the scalars: @xmath is a scalar quantity and so we set
@xmath , while @xmath is a vector and can be constructed as @xmath where
@xmath denotes a covariant derivative with respect to the background
metric – while for a scalar this is obviously identical to a partial
derivative, for other objects this specification will be necessary since
the perturbed metric is as yet undefined. Similarly, @xmath is a
rank-two tensor and can be constructed from scalars in two forms, one
proportional to the background metric and one constructed from the
second derivative of a scalar, that is, @xmath . We cannot add a
multiple of the totally anti-symmetric tensor density since the metric
must be symmetric. The signs on @xmath and @xmath are chosen to resemble
the Newtonian gravitational potential.

We do much the same for the vector perturbations; here, obviously, we do
not have a contribution to @xmath since any scalar formed from the
divergence of a vector can be incorporated into the scalar @xmath ; for
@xmath we can simply take @xmath , and for the tensor we can take @xmath
which has been symmetrised to ensure the symmetry of the metric tensor.
We impose @xmath to ensure an unambiguous split from the scalars.
Raising and lowering of indices is performed with the background metric
@xmath and its inverse @xmath ; see, for example, Wald [ 92 ] for a
justification. Acting on a first-order variable with the full metric
obviously yields the same result as acting with the background metric.

In the tensor case we can only perturb the space-space part of the
metric, and here we denote this by @xmath with @xmath .

Thus we have the perturbed metric

  -- -------- -- -- -------- --------
     @xmath                  (A.11)
                             
                    @xmath   
  -- -------- -- -- -------- --------

where @xmath is the symmetrised part of a tensor @xmath . The time-time
component, @xmath , is known as the “lapse” function, while the
space-time component, @xmath , is known as the “shift” for readily
apparent intuitive reasons; for an event on the spacelike hypersurface
the lapse function gives the change in the time co-ordinate – the time
“elapsed” – while the shift function maps it to a corresponding event on
the next hypersurface.

This line-element is redundant since we have not yet imposed a gauge. We
turn briefly to considering transformations between gauges and comment
on “gauge-invariance” in this formalism.

A gauge transformation swaps the “reference” manifold on which
quantities are defined from one to another; these quantities, however,
must be measured at the same event as viewed from the two manifolds. The
map that uniquely determines the co-ordinates of the event on a manifold
is called the gauge choice, and we can view the choice of a gauge as the
choice of a co-ordinate system – in the language of the 3+1 split of
spacetime, the gauge choice is a choice of the threading and slicing of
spacetime. Applied directly to our situation, the gauge choice is a
choice of the map between an event on the “physical” ( i.e. ,
first-order) universe and an event on the fictional Robertson-Walker
background.

Let a gauge transformation between two gauge specifications be given by

  -- -------- -- --------
     @xmath      (A.12)
  -- -------- -- --------

where @xmath is infinitesimal and for the purposes of this section a bar
denotes a different gauge rather than a “background” quantity. This then
implies that

  -- -------- -- --------
     @xmath      (A.13)
  -- -------- -- --------

With these we can consider how scalar, vector and tensor objects
transform under a gauge shift.

Consider first a scalar @xmath . Then, by definition,

  -- -------- --
     @xmath   
  -- -------- --

But we can expand @xmath to give

  -- -------- --
     @xmath   
  -- -------- --

implying that the gauge shift in a scalar quantity is

  -- -------- -- --------
     @xmath      (A.14)
  -- -------- -- --------

where the last step obviously follows because, for a scalar quantity,
the partial and the covariant derivative are identical.

For a vector @xmath , by the tensor transformation laws,

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
              @xmath   @xmath   
  -- -------- -------- -------- --

But

  -- -------- --
     @xmath   
  -- -------- --

which then implies

  -- -------- --
     @xmath   
  -- -------- --

which, by converting the partial derivatives into covariant derivatives
can be shown to be

  -- -------- -- --------
     @xmath      (A.15)
  -- -------- -- --------

Repeating the calculation for a contravariant vector gives

  -- -------- -- --------
     @xmath      (A.16)
  -- -------- -- --------

A similar calculation for a tensor @xmath rapidly establishes that

  -- -------- -- --------
     @xmath      (A.17)
  -- -------- -- --------

We may generalise these considerations by defining the Lie derivative,
which: for each covariant index @xmath subtracts a contraction of the
tensor with @xmath ; for each contravariant index @xmath adds a
contraction of the tensor with @xmath ; and subtracts off a final term
@xmath where @xmath denotes the covariant derivative. That is, the
difference in some arbitrary tensor under a gauge transformation is

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            (A.18)
                       @xmath   @xmath   
  -- -------- -------- -------- -------- --------

and @xmath denotes the Lie derivative in the direction of @xmath .

These are the general gauge transformations of scalar, vector and tensor
quantities. We can now apply these transformations to the perturbations
of the metric. First, let us specify the gauge transform as

  -- -------- -- --------
     @xmath      (A.19)
  -- -------- -- --------

where @xmath – i.e. @xmath is the transverse component of the spatial
gauge shift. From this we can immediately show

  -- -------- --
     @xmath   
  -- -------- --

and so

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (A.20)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

where we have used the vanishing spatial derivatives and @xmath
components of the background metric. Inserting now the full annsatz for
the background metric we see that

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (A.21)
  -- -------- -------- -------- -- --------

where an overdot denotes differentiation with respect to the conformal
time.

With the definitions of our metric perturbations we can now rapidly
derive a set of gauge transformations,

  -- -------- -- --------
     @xmath      
     @xmath      (A.22)
  -- -------- -- --------

demonstrating that the tensor perturbations – the gravitational waves –
are naturally gauge-invariant.

There are naturally many – indeed, an infinity – of possible gauges one
may select. We shall concentrate on two often encountered within the
literature: synchronous gauge, first examined in the cosmological
context by Lifshitz, where we take a purely spatial slicing of spacetime
foliated along the cosmic time; and Poisson gauge, which is a
generalisation [ 199 ] of the longitudinal, gauge employed by Mukhanov,
Feldman and Brandenberger [ 94 ] and Ma and Bertschinger [ 108 ] . Both
gauges have their advantages and disadvantages. Other common choices of
gauge include the uniform curvature gauge, wherein spacetime is sliced
along surfaces of constant curvature, and uniform density gauge, wherein
the slicing is performed along surfaces of constant matter density.

#### a.2.2 Synchronous Gauge

Throughout this thesis we shall work almost entirely within synchronous
gauge, which is the gauge found by explicitly writing the FLRW metric as
a simple foliation of spacetime. That is, we set the lapse and shift
functions to zero and spacetime is foliated by conformally Euclidean
spacelike hypersurfaces. As we shall shortly see, synchronous gauge is
not well defined and contains spurious gauge modes. However, it is
useful for two respects – the metric manifestly resembles our usual
Minkowski space with purely spatial perturbations, which can provide a
useful aid to intuition, and there is an unambiguous time parameter
which is simply either the cosmic time or the conformal time. Moreover,
the CMBFast code [ 86 ] is written in synchronous gauge, partly to
exploit this simple time parameter, and if we at any point should desire
to incorporate our results into a numerical code this will prove a large
advantage.

Synchronous gauge is found by setting

  -- -------- -- --------
     @xmath      (A.23)
  -- -------- -- --------

and from an arbitrary gauge the transformation into synchronous gauge is
then defined by

  -- -------- -- --------
     @xmath      (A.24)
  -- -------- -- --------

Solving this set of equations for the gauge transformation ultimately
gives us

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (A.25)
     @xmath   @xmath   @xmath      (A.26)
  -- -------- -------- -------- -- --------

where @xmath , @xmath and @xmath are arbitrary functions of the spatial
variables but constant in time. It is these functions that provide the
ambiguity within synchronous gauge and results from within this gauge
need to be analysed carefully to remove any spurious, unphysical modes.
See for example [ 91 , 195 ] for more details on this point.

#### a.2.3 Poisson Gauge

We shall employ Poisson Gauge as employed by Bertschinger [ 199 ] ,
introducing first the conformal Newtonian gauge ( [ 94 , 108 ] ).
Conformal Newtonian gauge contains only scalar perturbations and so, by
definition, @xmath . The gauge condition on the remaining scalar degrees
of freedom is that the lapse vanishes and there are no scalar
derivatives in the spatial perturbation – that is,

  -- -------- -- --------
     @xmath      (A.27)
  -- -------- -- --------

Since the only perturbations that remain are on the time-time and
isotropic space-space terms the resulting metric closely resembles a
perturbed Minkowski (weak-field) metric and the perturbations @xmath ,
@xmath the Newtonian potentials. Following the same process as for the
synchronous gauge, we rapidly find that the gauge-transform from an
arbitrary (scalar) gauge into conformal Newtonian gauge is

  -- -------- -- --------
     @xmath      (A.28)
  -- -------- -- --------

which, unlike the transformation into synchronous gauge, is uniquely
defined.

Poisson gauge is little more complicated than conformal Newtonian gauge;
it is defined by retaining a transverse vector part in the shift, which
then renders the shift merely @xmath , and eliminating the vectorial
space perturbation. The additional transform needed from an arbitrary
gauge into Poisson gauge is then

  -- -------- -- --------
     @xmath      (A.29)
  -- -------- -- --------

The tensor perturbations being gauge-invariant, Poisson gauge is then
well suited for studying cosmological perturbations, even in the
presence of active anisotropic sources, as synchronous gauge.

#### a.2.4 Transferral between Synchronous and Poisson Gauge

Transferral from synchronous into Poisson gauge is simple; using the
above expressions for transferring into the Poisson gauge we rapidly see
that

  -- -------- -- --------
     @xmath      (A.30)
  -- -------- -- --------

Thus the Poisson gauge variables are given in terms of the synchronous
variables as

  -- -------- -- --------
     @xmath      (A.31)
  -- -------- -- --------

Due to the ambiguity in transferring into synchronous gauge, the reverse
is far from pleasant. The gauge transformation turns out to be

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (A.32)
     @xmath   @xmath   @xmath      (A.33)
  -- -------- -------- -------- -- --------

The explicit forms for the metric perturbations are now simple to write
down but not particularly illuminating.

#### a.2.5 Gauge Invariance and the Bardeen Variables

From the form of the generic gauge transformations it is easy to see
that we can construct quantities that are invariant under gauge
transformations. It should be emphasised that, in different gauges,
these variables will retain different physical interpretations even
though they have the same numerical value. Moreover, it is worth
commenting that these combinations are in many ways arbitrary
constructions designed purely to eliminate the difficulties introduced
by gauge variance. A more natural form of gauge-invariance occurs in the
GIC approach with quite a different interpretation.

First it is worth noticing that

  -- -------- --
     @xmath   
  -- -------- --

The time derivative of this, multiplied by the scale factor, is then

  -- -------- --
     @xmath   
  -- -------- --

From here it is immediately obvious that we can define

  -- -------- -- --------
     @xmath      (A.34)
  -- -------- -- --------

as two gauge-invariant variables, known as the Bardeen potentials [ 195
, 196 ] .

For the vectors it is readily apparent that

  -- -------- -- --------
     @xmath      (A.35)
  -- -------- -- --------

is also gauge-invariant. Along with the gravitational waves @xmath we
thus have a complete set of gauge-invariant variables.

In Poisson gauge, these variables reduce to

  -- -------- -- --------
     @xmath      (A.36)
  -- -------- -- --------

which explains the terminology “Bardeen potentials”; the scalar
gauge-invariant combinations reduce to the conformal Newtonian
gravitational potentials. The vector gauge-invariant variable reduces to
the shift function.

In synchronous gauge, on the other hand,

  -- -------- -- --------
     @xmath      (A.37)
  -- -------- -- --------

For the scalar variables these do not possess as transparent a physical
definition; the vector variable reduces to the time derivative of the
spatial geometrical vorticity.

## Appendix B Viscous Fluids

In this appendix we briefly derive the conservation laws omitted from §
2.2 for a fluid containing bulk and shear viscosities and conducting
heat. The full stress-energy tensor we employ [ 96 ] is

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
              @xmath   @xmath   
  -- -------- -------- -------- --

with @xmath , the four-velocity

  -- -------- -- -------
     @xmath      (B.1)
  -- -------- -- -------

the projection tensor onto a hypersurface orthogonal to @xmath

  -- -------- --
     @xmath   
  -- -------- --

the heat-flow vector

  -- -------- -- -------
     @xmath      (B.2)
  -- -------- -- -------

and the shear tensor is defined as

  -- -------- -- -------
     @xmath      (B.3)
  -- -------- -- -------

This reduces, with @xmath , to

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (B.4)
     @xmath   @xmath   @xmath      (B.5)
     @xmath   @xmath               (B.6)
  -- -------- -------- -------- -- -------

If we assume no further collisional processes then we can set the
collision term @xmath in the conservation equations to zero. As saw
earlier, the ideal components reduce to a background contribution

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (B.7)
  -- -------- -------- -------- -- -------

and a foreground contribution

  -- -------- -------- -------- -- -------
              @xmath   @xmath      (B.8)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- -------

For the heat conduction we find that

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (B.9)
                                @xmath   
     @xmath   @xmath                     
                       @xmath            
  -- -------- -------- -------- -------- -------

which are all first-order while, predictably, the shear viscous sector
only contributes to the first-order Euler equation, with

  -- -------- -- -- -------- --------
     @xmath                  (B.12)
                             
                    @xmath   
  -- -------- -- -- -------- --------

The bulk viscous sector contributes to both the conservation and Euler
equations with

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            (B.13)
     @xmath   @xmath   @xmath            (B.14)
                                @xmath   
  -- -------- -------- -------- -------- --------

Assuming we can take @xmath we then have a background contribution from
the bulk viscosity

  -- -------- -- --------
     @xmath      (B.15)
  -- -------- -- --------

with all other effects linear order only. Should the coefficiants of
bulk viscosity be effectively first-order then this forms the only
contribution and enters at linear order.

While we could certainly retain the generality of non-constant
coefficiants of heat conductivity and viscosities, we shall instead
assume that they are constant. That is,

  -- -------- -- --------
     @xmath      (B.16)
  -- -------- -- --------

and similar.

##### Fourier Space

In the background,

  -- -------- --
     @xmath   
  -- -------- --

and in the foreground,

  -- -------- --
     @xmath   
  -- -------- --

which, separating across the scalar, vector and tensor parts, go to

  -- -------- --
     @xmath   
  -- -------- --

in the background and

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

After the scalar/vector/tensor separation, the foreground contributions
from the heat conduction contribute only to the @xmath components of the
stress-energy – that is, the energy flow – and separating this we find

  -- -------- -- --------
     @xmath      (B.17)
  -- -------- -- --------

The shear viscosity impacts purely on the space-space components of the
stress-energy and, by construction, has a vanishing trace. It separates
to

  -- -------- -- --------
     @xmath      (B.18)
  -- -------- -- --------

Finally, the first-order bulk viscosity contributes to an energy flow
and, obviously and by construction, only to an isotropic stress:

  -- -------- -- --------
     @xmath      (B.19)
  -- -------- -- --------

Turning to the fluid dynamical equations, in the presence of non-ideal
terms the background matter conservation equation is modified to

  -- -------- -- --------
     @xmath      (B.20)
  -- -------- -- --------

The perturbed ideal components are

  -- -------- -------- -------- -- --------
              @xmath   @xmath      (B.21)
     @xmath   @xmath   @xmath      (B.22)
     @xmath   @xmath   @xmath      (B.23)
  -- -------- -------- -------- -- --------

while the non-ideal contribution to the perturbed matter conservation
equations comes from

  -- -------- -- --------
     @xmath      (B.24)
  -- -------- -- --------

The contribution to the scalar Euler equation from heat conduction is

  -- -------- -- -- -------- --------
     @xmath                  (B.25)
                             
                    @xmath   
  -- -------- -- -- -------- --------

from shear viscosity is

  -- -------- -- --------
     @xmath      (B.26)
  -- -------- -- --------

and from bulk viscosity is

  -- -------- -- --------
     @xmath      (B.27)
  -- -------- -- --------

Non ideal effects contribute

  -- -- -- --------
           (B.28)
  -- -- -- --------

  -- -------- -- --------
     @xmath      (B.29)
  -- -------- -- --------

and

  -- -------- -- --------
     @xmath      (B.30)
  -- -------- -- --------

to the vector Euler equations, from heat conduction, shear and bulk
viscosities respectively.

It is readily apparent that bulk viscosity is far the simplest viscous
effect to include in a cosmological study; however, as we demonstrated
in § 2.2.1 it is not particularly physical to include a bulk viscosity
in the background. Shear viscosities are widely used for small-scale
models of the photon drag, as in § 3.3 .

Many of the effects of heat conduction cancel if one takes the
simplifying assumption

  -- -------- -- --------
     @xmath      (B.31)
  -- -------- -- --------

which is true for a species of non-interacting particles and may be
derived from the first law of thermodynamics.

## Appendix C Vector and Tensor CMB Statistics

In this appendix we derive in detail the vector and tensor CMB angular
power spectra in the traditional approach.

### c.1 Vector Contributions to the CMB in the Traditional Approach

Here we derive the result stated in section ( 2.7.3 ). The vector
contribution to the CMB temperature shift was

  -- -------- --
     @xmath   
  -- -------- --

and so the vector temperature auto-correlation function is the ugly

  -- -------- --
     @xmath   
     @xmath   
              
  -- -------- --

where @xmath and @xmath and @xmath are associated with @xmath .

However, since the hierarchies are symmetric with respect to change of
vector mode, we shall assume that the two are uncorrelated but similar –
that is, we shall assume that

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (C.1)
  -- -------- -------- -------- -- -------

As in the scalar case, the independence of the evolution equations on
the direction of @xmath allows us to define

  -- -- -- -------
           (C.2)
  -- -- -- -------

With these identifications, the temperature auto-correlation is

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

We can remove the terms dependent on the azimuthal angle by considering
@xmath :

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
              @xmath   @xmath   
  -- -------- -------- -------- --

which gives us

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Considering first the term proportional to @xmath , we can follow much
the same process as for the scalars, expanding the Legendre polynomials
across the spherical harmonics and integrating over @xmath and @xmath to
leave

  -- -------- --
     @xmath   
  -- -------- --

We then employ the recursion relation on @xmath to find

  -- -------- --
     @xmath   
  -- -------- --

Relabelling the summation indices on the two terms then allows us to
write the contribution to the vector @xmath :

  -- -------- --
     @xmath   
  -- -------- --

The second term, proportional to @xmath , yields a slightly more
convoluted analysis. Firstly we employ the recurrence relation for
Legendre polynomials to write

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

Expanding the Legendres across the spherical harmonics and integrating
over both @xmath and @xmath gives us

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

whence we rapidly find

  -- -------- --
     @xmath   
  -- -------- --

Combining this with @xmath , we can reduce the contribution from vector
perturbations to the angular power spectrum of the temperature
auto-correlation function to finally reach

  -- -------- -- -------
     @xmath      (C.3)
  -- -------- -- -------

as stated.

### c.2 Tensor Contributions to the CMB in the Traditional Approach

The tensor contribution to the temperature auto-correlation was

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

We proceed in an analogous manner to our approach to the vectors. First
we define

  -- -------- --
     @xmath   
  -- -------- --

It is then necessary to remove the dependence on @xmath ; we do this by
evaluating the square of @xmath , which leads to

  -- -------- --
     @xmath   
  -- -------- --

and separates the correlation function into six distinct parts which we
shall tackle in turn.

Firstly consider the contribution proportional to @xmath ; the standard
process employed for the scalars and vectors above rapidly leads to

  -- -------- --
     @xmath   
  -- -------- --

We now employ the second recursion relation for @xmath (which may
readily be derived from the usual recursion relation),

  -- -------- --
     @xmath   
  -- -------- --

and reduce this first contribution to

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
  -- -------- -- -------- --

Dealing with the second contribution, proportional to @xmath , is a
lengthy procedure; first employing the recurrence relation for the
Legendres, expanding them into spherical harmonics and integrating over
both @xmath and @xmath gives us

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
  -- -------- -- -------- --

We now again employ the recursion relation for @xmath and, after a
certain amount of algebra, can reduce this to

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

The third contribution is that proportional to @xmath ; employing
immediately the second recursion relation for the Legendres, expanding
over the spherical harmonics and integrating over @xmath and directions
of @xmath leads, after much algebra, to

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

whence

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
  -- -------- -- -------- --

Hereon the contributions get simpler; for the fourth contribution,
proportional to @xmath , we first employ the second recursion relation
for @xmath and then follow the usual procedure, expanding across the
spherical harmonics and integrating twice; the result is

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
  -- -------- -- -------- --

Obviously enough, the fifth contribution, proportional to @xmath , is
the complex conjugate of this,

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
  -- -------- -- -------- --

The sixth and last contribution is identical in form to the negative of
the scalar @xmath , that is

  -- -------- --
     @xmath   
  -- -------- --

Putting these six contributions together and performing much tedious
algebra, we finally arrive at the contribution to the power spectrum of
temperature anisotropies,

  -- -------- -- -------
     @xmath      (C.4)
  -- -------- -- -------

with

  -- -------- -- -------
     @xmath      (C.5)
  -- -------- -- -------

as we previously asserted.

## Appendix D E and B Modes

### d.1 Spin-Weighted Polarisation – E and B Modes

An all-sky analysis of the statistical properties is considerably
confused by the rotational variance of the Stokes parameters
characterising polarisation; this caused earlier authors [ 200 , 201 ,
115 , 202 , 203 , 118 ] to operate in a small-angle approximation in
which the integration across wavevectors does not cause ambiguities to
arise in the definitions of @xmath and @xmath . However, in the mid-late
1990s a new formalism arose that circumvented these problems, due to two
independant teams, of Kamionkowski, Kosowsky and Stebbins [ 204 ] and
Zaldarriaga and Seljak [ 76 ] . Our approach is based heavily on that of
Zaldarriaga and Seljak [ 76 ] .

Consider a rotation of the angular basis vectors with respect to which
the Stokes parameters are defined – that is, a rotation about the radial
vector. Then the set of parameters @xmath varies on rotation about
@xmath by an angle @xmath according to (see Chandrasekhar, [ 117 ] )

  -- -------- --
     @xmath   
  -- -------- --

Converting this to our standard set @xmath we see that

  -- -------- --
     @xmath   
  -- -------- --

The temperature anisotropies are invariant under rotation, rendering the
analysis on the CMB considerably simplified, but the polarisation
parameters most definitely are not. ¹ ¹ 1 This is strictly not true; had
we retained the circular polarisation @xmath – and for a genuinely
complete treatment we would have to, incorporating both Faraday rotation
from @xmath to @xmath and also Faraday “conversion” from @xmath to
@xmath ; see for example Cooray et. al. [ 205 ] and Matsuyima and Ioka [
206 ] – then we would have seen that @xmath is also invariant under
co-ordinate rotations and is analysed as simply as the temperature
perturbations are. Note however that the latter demonstrate that to
produce circular polarisation we would require an ordered component to
our field and while many studies of ordered cosmological fields exist,
we are going to follow the currently conventional route of considering a
field with a tangled component only. Consider, however, some linear
combination of @xmath and @xmath , and convert the trigonometric
expressions to exponentials:

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

Then we see that we can reduce this to a simple form by choosing @xmath
, which gives us

  -- -------- --
     @xmath   
  -- -------- --

similarly, we can show that

  -- -------- --
     @xmath   
  -- -------- --

While this has not given us two objects invariant under rotation, it has
given us objects with useful properties, if we employ the spin-weighted
spherical harmonics introduced by Newman and Penrose [ 207 ] . We shall
leave a detailed consideration of spin-weighted functions and harmonics
to a rainy-day appendix, and content ourselves with referring the reader
to the article by Newman and Penrose, and the follow-up article by
Goldberg et. al. [ 208 ] , and the related article by Thorne [ 209 ] .
Useful information in this precise context may also be found in the
appendices of Zaldarriaga and Seljak [ 76 ] and Koh and Lee [ 51 ] .

A function @xmath is called “spin- @xmath ” if, under a right-handed
rotation @xmath about the radial vector it transforms as

  -- -------- --
     @xmath   
  -- -------- --

Note that, following Zaldarriaga and Seljak, we take the opposite
spin-definition to that of Newman and Penrose or Goldberg et. al. . A
function @xmath with a spin-weighting @xmath is conveniently written
@xmath .

We may define a differential operator @xmath on the surface of the
sphere by

  -- -------- -- -------
     @xmath      (D.1)
  -- -------- -- -------

which is related to the covariant derivative on the surface of the
sphere. (Obviously no summation across the spin index in any of these
formulae.) This has the related operator

  -- -- -- -------
           (D.2)
  -- -- -- -------

These operators (dubbed “thop” by Newman and Penrose) obey a commutator

  -- -------- --
     @xmath   
  -- -------- --

and, vitally, have the property under rotation through @xmath that

  -- -------- --
     @xmath   
  -- -------- --

that is, they act as spin raising and lowering operators of some sort.
This being so, one is immediately tempted to act these upon the familiar
spherical harmonics, and obtain functions that we might dub
“spin-weighted spherical harmonics” @xmath if they possess the correct
properties:

  -- -- -- -------
           (D.3)
  -- -- -- -------

and leaving them undefined for @xmath . Note that if one substitutes
@xmath for @xmath in the second definition, the form becomes identical
to the first, other than a factor of @xmath .

It can then be shown that, as we hoped, these functions form, for each
spin-weighting, a complete and orthonormal set, and so we can expand

  -- -------- --
     @xmath   
  -- -------- --

The orthonormality and completeness relations are, as in the standard
spherical harmonics,

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (D.4)
  -- -------- -------- -------- -- -------

The spin-weighted harmonics also obey the useful relations

  -- -------- -- -------
     @xmath      (D.5)
     @xmath      
     @xmath      
  -- -------- -- -------

by which one may see that the @xmath are the eigenvectors of @xmath ,
and that @xmath and @xmath are raising and lowering operators
respectively.

It may also be shown that

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

To return to the matter of polarisation, from the transformation under
rotation

  -- -------- -- -------
     @xmath      (D.6)
  -- -------- -- -------

we see that we are dealing with two objects of spin-weighting @xmath .
We may expand these across the relevant harmonics as

  -- -------- --
     @xmath   
  -- -------- --

To get rotationally-invariant measures of polarisation, then, we might
act on these with @xmath and @xmath as required. Doing so, and employing
the definitions of the spin-weighted harmonics ( D.3 ) and the effects
of @xmath and @xmath ( D.5 ), leaves our two quantities,

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      (D.7)
     @xmath   @xmath   @xmath      (D.8)
  -- -------- -------- -------- -- -------

We can then find the coefficients from either integrating @xmath over
the spin- @xmath spherical harmonics, or by integrating the transformed
analogues over the standard, spin- @xmath harmonics:

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath            
  -- -------- -------- -------- --

From considerations of parity (see again Newman and Penrose [ 207 ] ),
we can construct two objects with opposite parities,

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      (D.9)
     @xmath   @xmath   @xmath      (D.10)
  -- -------- -------- -------- -- --------

To simplify the expressions, Zaldarriaga and Seljak define

  -- -------- --
     @xmath   
  -- -------- --

which gives us the variables

  -- -------- -- -------- --
     @xmath      @xmath   
     @xmath      @xmath   
  -- -------- -- -------- --

The spin- @xmath harmonics are given explicitly by (see Hu and White, [
119 ] )

  -- -------- -- --------
     @xmath      (D.11)
  -- -------- -- --------

with the spin @xmath harmonics related by relations ( D.5 ). We can also
write the twice-applied spin-lowering operator acting on a spin @xmath
function @xmath with angular dependence @xmath as

  -- -------- -------- -------- -------- --------
     @xmath   @xmath   @xmath            (D.12)
                       @xmath   @xmath   
  -- -------- -------- -------- -------- --------

with an analogous expression for a double-raise on a spin @xmath
function

  -- -------- -- --------
     @xmath      (D.13)
  -- -------- -- --------

While in principle we could expand the Boltzmann hierarchies across
these spin-2 harmonics and construct the evolution equations for the
polarisation parameters, it is easier to follow the method of
Zaldarriaga and Seljak and instead consider a line-of-sight approach.
Working in the naïve manner would yield a coupled system of thousands of
differential equations; the line-of-sight approach renders this problem
rather more tractable than attempting to manipulate the @xmath s and
would be quicker by far to implement in a Boltzmann code. We will still
employ the hierarchies in their earlier Stokes parameter formalism to
evaluate the sources of the perturbations, but shall reconstruct the
microwave background sky – including the @xmath and @xmath modes – from
the line-of-sight approach, to which we now turn.

### d.2 The Line-of-Sight Approach

As with the temperature case considered in the body of the thesis we
shall separate the polarisation Boltzmann equations into sections
dependent purely on the sources and sections dependent purely on the
geometry. As before, @xmath is the optical depth at a time @xmath ,
@xmath is the visibility function and we sometimes use the notation
@xmath .

#### d.2.1 Scalar Evolution

Consider first the scalar perturbations. Here

  -- -------- --
     @xmath   
  -- -------- --

where

  -- -------- --
     @xmath   
  -- -------- --

Formally integrating this between @xmath and @xmath gives

  -- -------- -- --------
     @xmath      (D.14)
  -- -------- -- --------

We can thus say

  -- -------- -- --------
     @xmath      (D.15)
  -- -------- -- --------

with

  -- -------- -- --------
     @xmath      (D.16)
  -- -------- -- --------

Now, here @xmath and so @xmath implying that @xmath which immediately
shows that scalar perturbations do not source @xmath -mode polarisation.
We recover the @xmath and @xmath modes simply by applying @xmath and
@xmath to the line-of-sight results; in this case this means we apply
either of the operators to @xmath . We can then see that

  -- -------- -- --------
     @xmath      (D.17)
  -- -------- -- --------

#### d.2.2 Vector Evolution

Here the physical Stokes parameters for polarisation were

  -- -------- --
     @xmath   
  -- -------- --

and these obeyed the evolution equations

  -- -------- -- --------
     @xmath      (D.18)
  -- -------- -- --------

with

  -- -------- --
     @xmath   
  -- -------- --

We then rotate our basis to

  -- -------- -- --------
     @xmath      (D.19)
  -- -------- -- --------

as with the temperature case. @xmath and @xmath with the properties

  -- -------- -- --------
     @xmath      (D.20)
  -- -------- -- --------

again characterise the vector perturbations. Assuming that our modes are
thus uncorrelated but similar, we can employ the source term generated
from, for example, the @xmath mode, and write our line-of-sight
integrals as

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

with

  -- -------- -- --------
     @xmath      (D.21)
  -- -------- -- --------

#### d.2.3 Tensor Evolution

With the tensors,

  -- -------- --
     @xmath   
  -- -------- --

with the evolution equations

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

and

  -- -------- --
     @xmath   
  -- -------- --

From here we rapidly find the source terms

  -- -------- -- --------
     @xmath      (D.22)
  -- -------- -- --------

The rotation we employed for the temperature puts our Stokes parameters
into the forms

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      (D.23)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

Characterising the statistics of the gravity waves with variables @xmath
and @xmath , uncorrelated but similar, we have the solutions

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      (D.24)
     @xmath   @xmath   @xmath      
  -- -------- -------- -------- -- --------

with

  -- -------- -- --------
     @xmath      (D.25)
  -- -------- -- --------

and

  -- -------- -- --------
     @xmath      (D.26)
  -- -------- -- --------

#### d.2.4 Scalar CMB Angular Power Spectra

Here we found that

  -- -------- -------- -------- -- --------
     @xmath   @xmath   @xmath      (D.27)
     @xmath   @xmath   @xmath      (D.28)
  -- -------- -------- -------- -- --------

##### Polarisation Auto-Correlation

Since there is no @xmath polarisation for the scalar modes we can write

  -- -------- -- --------
     @xmath      (D.29)
  -- -------- -- --------

Rewriting the @xmath in the integrand as a derivative of the exponential
with respect to @xmath we then have

  -- -------- -- --------
     @xmath      (D.30)
  -- -------- -- --------

Taking this into real space and calculating the @xmath s we have

  -- -------- -- --------
     @xmath      (D.31)
  -- -------- -- --------

In a manner entirely analogous to the temperature case we can then find

  -- -------- --
     @xmath   
  -- -------- --

As in the tensor temperature correlation, we expand the derivative out
and simplifying using the spherical Bessel equation ( G.12 ) to find

  -- -------- --
     @xmath   
  -- -------- --

and with this the @xmath -mode transfer function reduces to

  -- -------- -- --------
     @xmath      (D.32)
  -- -------- -- --------

with a source term

  -- -------- -- --------
     @xmath      (D.33)
  -- -------- -- --------

##### Temperature-Polarisation Cross-Correlation

From the form of @xmath and @xmath , and noting that for two scalar
functions @xmath and @xmath ,

  -- -------- -- --------
     @xmath      (D.34)
  -- -------- -- --------

we can write

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

with @xmath . Again integrating over the directions of @xmath ,
expanding the exponentials in @xmath across the Legendre polynomials and
spherical Bessel functions, and expanding the spherical harmonics into
associated Legendre polynomials and exponentials, and using ( 2.240 ),
we get

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

We can now integrate over @xmath and @xmath – which both yield a term
@xmath – and over @xmath and @xmath which give terms @xmath and similar.
Summing over @xmath , then, gives

  -- -------- --
     @xmath   
  -- -------- --

or, converting @xmath to @xmath and substituting in the form of the
transfer functions,

  -- -------- -- --------
     @xmath      (D.35)
  -- -------- -- --------

in agreement with that found in the standard approach.

#### d.2.5 Vector and Tensor CMB Angular Power Spectra

The vector and tensor angular power spectra can be evaluated in broadly
equivalent ways; for details of the tensor case, the reader is referred
to [ 76 ] .

## Appendix E Supplementary Results concerning Source Statistics

In this appendix we present results that were excluded from the main
body of chapter 4 due to their complexity.

### e.1 Magnetic Bispectra

#### e.1.1 Traceless Scalar-Tensor-Tensor Correlation

The correlation between the traceless scalar part and the tensors is
recovered by applying @xmath to @xmath ( 4.4.1 ); the full result for
the angular integrand is

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
  -- -------- -------- -------- --

  -- -------- -------- -------- --
     @xmath   @xmath            
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

#### e.1.2 Vector-Tensor-Vector Correlation

The cross-correlation between the vectors and the tensors, @xmath , is
found by applying @xmath to @xmath . This ultimately produces

  -- -------- -- -------
     @xmath      (E.1)
  -- -------- -- -------

with

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
  -- -------- -------- -------- --

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

#### e.1.3 Tensor Auto-Correlation

The full tensor auto-correlation, @xmath , is found by the application
of

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

to @xmath . This leads ultimately to

  -- -------- -- -------
     @xmath      (E.2)
  -- -------- -- -------

and

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
  -- -------- -------- -------- --

  -- -------- -------- -------- --
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
  -- -------- -------- -------- --

  -- -------- -------- -------- --
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
                       @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

### e.2 Geometry-Independent Large-Scale Results

Here we present the full generality behind equations ( 4.43 ). Taking
@xmath and @xmath , and for convenience defining the generic geometry by
the two angle cosines @xmath and @xmath (see Figure 4.5 ) we have

  -- -------- -- -------- --
     @xmath               
                          
     @xmath               
                          
     @xmath               
                          
                 @xmath   
                 @xmath   
     @xmath               
                          
                 @xmath   
     @xmath               
                          
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

  -- -------- -- -------- --
                          
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
     @xmath               
                          
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
     @xmath               
                          
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
     @xmath               
                          
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

where

  -- -------- -- -------
     @xmath      (E.3)
  -- -------- -- -------

with @xmath the amplitude of the magnetic field power spectrum.

Taking the colinear case ( @xmath ) then recovers the expressions ( 4.43
).

## Appendix F The CMB Bispectrum

In this appendix we derive the CMB bispectra, chiefly following Wang and
Kamionkowski [ 186 ] , itself based on work by Ferreira, Magueijo and
Górski [ 187 ] , although neither employed the line-of-sight approach
and our derivation thus follows a different route. We construct the form
for the bispectrum from the scalar modes, these being far the simplest;
for vector and tensor modes the relevant transfer functions should
naturally be employed.

### f.1 The CMB Angular Bispectrum

Let us first consider a primordial bispectrum analogous to the
primordial power spectrum; letting @xmath denote independently trace or
traceless components and assuming statistical homogeneity, we can define

  -- -------- -- -------
     @xmath      (F.1)
  -- -------- -- -------

Considering for simplicity the scalars and using equation ( 2.231 ) we
can then express the scalar three-point correlation of the @xmath s in
the line-of-sight approach as

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

where we have defined @xmath and @xmath .

Following the method of Wang and Kamionkowski, we now expand the Dirac
delta function as an integral across some real-space variable @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

and then expand the exponentials with equation ( G.15 ) to give

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

Immediately integrating over the directions of @xmath , @xmath and
@xmath we find a series of Kronecker deltas @xmath and similar, and
performing the sum over @xmath we are left with

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

which we can then immediately integrate over the directions of @xmath ,
@xmath and @xmath which gives us Kronecker deltas @xmath and similar.
After summation, then, we have found

  -- -------- -- -------- --
     @xmath               
                          
                 @xmath   
                 @xmath   
                 @xmath   
  -- -------- -- -------- --

The integral of three spherical harmonics is called the Gaunt integral
and it evaluates [ 186 ] to

  -- -------- -- -- -------- -------
     @xmath                  (F.2)
                             
                    @xmath   
  -- -------- -- -- -------- -------

where the objects in brackets are Wigner @xmath symbols, closely related
to the Clebsch-Gordan coefficients.

If we also denote the integral over three spherical Bessel functions by

  -- -------- -- -------
     @xmath      (F.3)
  -- -------- -- -------

and recall the definition of the scalar transfer functions ( 2.233 )
then we can finally see that

  -- -------- -- -- -------- -------
     @xmath                  (F.4)
                             
                    @xmath   
                    @xmath   
                    @xmath   
  -- -------- -- -- -------- -------

where

  -- -------- -------- -------- -------- -------
     @xmath   @xmath   @xmath            (F.5)
                       @xmath   @xmath   
                                @xmath   
                                @xmath   
  -- -------- -------- -------- -------- -------

is called the CMB angular bispectrum in clear analogy with the CMB
angular power spectrum. Other than the inclusion of the Wigner @xmath
symbol and the integration across the Bessel functions this clearly has
a familiar form, with the transfer functions merely wrapping the
primordial bispectrum onto the CMB sky.

Note that @xmath is not summed across due to the restrictions on @xmath
and @xmath placed by the Wigner @xmath symbol,

  -- -------- -- -------
     @xmath      (F.6)
  -- -------- -- -------

i.e. , the sum of @xmath is an integer, @xmath is determined from @xmath
and @xmath , and the triangle inequality must be obeyed. If these
conditions are not satisfied then the symbol is vanishing.

From Abramowitz and Stegun [ 146 ] we see that

  -- -------- -- -------
     @xmath      (F.7)
  -- -------- -- -------

for even @xmath and where @xmath . For odd @xmath the symbol vanishes.

As with the two-point case, this form for the bispectra holds regardless
of the nature of variable one is employing; @xmath can ultimately denote
scalar trace, traceless scalar, vector or tensor pieces.

Rather than work with the full bispectrum ( F.5 ) we follow Ferreira,
Magueijo and Górski [ 187 ] and Wang and Kamionkowski [ 186 ] in
defining a reduced bispectrum

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
              @xmath   @xmath   
  -- -------- -------- -------- --

Note that our definition is a factor of @xmath different to those in [
187 , 186 ] . We have sacrificed a large amount of the information from
the full bispectrum in the interests of a quantity that more closely
resembles the familiar angular power spectrum for the CMB.

### f.2 An Algorithm for Evaluating @xmath

The function @xmath could be calculated recursively, as outlined in the
appendix of Wang and Kamionkowski, or by direct integration. Due to the
number of calls that a direct integration approach would make we choose
to evaluate it recursively and here outline the approach. First we
derive a recursion relation for the full integral @xmath by employing
the standard spherical Bessel relation

  -- -------- -- -------
     @xmath      (F.9)
  -- -------- -- -------

from which we can see that

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
                       @xmath   
              @xmath   @xmath   
                       @xmath   
              @xmath   @xmath   
                       @xmath   
  -- -------- -------- -------- --

whence the two recursion relations

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

Obviously there is a third recurrence relation between @xmath and @xmath
but due to the Dirac delta this is not needed.

To construct @xmath for any combination of @xmath and @xmath , then, we
follow the algorithm below:

-   Rearrange @xmath such that @xmath ; for example, @xmath ;

-   For @xmath generate @xmath , @xmath , @xmath and @xmath ;

-   For @xmath and @xmath generate @xmath from @xmath , producing @xmath
    and @xmath ;

-   For @xmath generate @xmath , ultimately producing @xmath .

We then require the four bases from which we will produce any required
@xmath , @xmath , @xmath , @xmath and @xmath . These can each be
evaluated analytically, as shown in Wang and Kamionkowski, by applying
the stringent conditions on @xmath and @xmath enforced by the
Clebsch-Gordan coefficient and statistical isotropy. That is, the
wavenumbers must obey the triangle relation and @xmath must be even.

Now, employing that

  -- -------- -- --------
     @xmath      (F.10)
  -- -------- -- --------

we can write

  -- -------- --
     @xmath   
  -- -------- --

Imposing that @xmath is even ensures that the integrand is an even
function; we can convert the @xmath and @xmath into exponentials and
integrate over @xmath to leave the integral over @xmath and four delta
functions. Enforcing the triangle relation on the wavemodes then leaves
a tractable integration that evaluates to

  -- -------- --
     @xmath   
  -- -------- --

We can follow much the same procedure for @xmath (which contains an odd
function and requires @xmath to be odd, implying that the overall
function is even) and @xmath and find that

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

This gives us the basis from which all possible @xmath can be evaluated.
This algorithm is easy to implement in Fortran 90; we can build it as a
recursive function and rapidly and accurately generate @xmath on the
fly.

## Appendix G Mathematical Relations

We list here a brief selection of definitions, relations and identities
for some of the functions we have been employing throughout this thesis.
For further detail see, for example, Abramowitz and Stegun [ 146 ] .

### g.1 Legendre Polynomials

The Legendre polynomials satisfy the equation

  -- -------- -- -------
     @xmath      (G.1)
  -- -------- -- -------

where @xmath is an associated Legendre polynomial. The Legendre
polynomials are given by @xmath and the associated Legendre polynomials
are recovered from

  -- -------- -- -------
     @xmath      (G.2)
  -- -------- -- -------

Legendre polynomials obey the recursion relation

  -- -------- -- -------
     @xmath      (G.3)
  -- -------- -- -------

and are orthogonal over @xmath ,

  -- -------- -- -------
     @xmath      (G.4)
  -- -------- -- -------

The first few Legendre polynomials are

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

and so the first few powers of @xmath can be expressed as

  -- -------- -------- -------- --
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
     @xmath   @xmath   @xmath   
  -- -------- -------- -------- --

### g.2 Spherical Harmonics

The spherical harmonics are defined in terms of the associated Legendre
polynomials as

  -- -------- -- -------
     @xmath      (G.5)
  -- -------- -- -------

They are orthogonal over the directions of @xmath :

  -- -------- -- -------
     @xmath      (G.6)
  -- -------- -- -------

The Legendre polynomials can be recovered from

  -- -------- -- -------
     @xmath      (G.7)
  -- -------- -- -------

### g.3 Bessel Functions

The Bessel functions are a solution of the equation

  -- -------- -- -------
     @xmath      (G.8)
  -- -------- -- -------

While there are various solutions to this equation we are interested
solely in the Bessel functions of the first kind. Bessel functions of
the first kind satisfy the derivative relation

  -- -------- -- -------
     @xmath      (G.9)
  -- -------- -- -------

and the recursion relation

  -- -------- -- --------
     @xmath      (G.10)
  -- -------- -- --------

The spherical Bessel function is defined by

  -- -------- -- --------
     @xmath      (G.11)
  -- -------- -- --------

Using this we may transfer the relations for the Bessel functions to the
spherical Bessel functions, again concentrating on those of the first
kind. Firstly we transfer the fundamental equation,

  -- -------- -- --------
     @xmath      (G.12)
  -- -------- -- --------

The recursion relation ( G.10 ) becomes

  -- -------- -- --------
     @xmath      (G.13)
  -- -------- -- --------

### g.4 Exponential Expansions

The complex exponential is related to the Legendre polynomials and
spherical Bessel functions by

  -- -------- -- --------
     @xmath      (G.14)
  -- -------- -- --------

and thus to the spherical harmonics by

  -- -------- -- --------
     @xmath      (G.15)
  -- -------- -- --------

### g.5 Miscellaneous

We sometimes abbreviate

  -- -------- -- --------
     @xmath      (G.16)
  -- -------- -- --------

## Appendix H Conventions and Notation

### h.1 Conventions

#### h.1.1 Fundamental

Perhaps our most fundamental assumption is that we assume General
Relativity to provide an accurate picture of the universe from the
smallest scales to beyond the Hubble distance. For a derivation of
general relativity we refer the reader to, for example, Carroll [ 190 ]
, Weinberg [ 96 ] , Wald [ 92 ] , Rindler [ 210 ] or Misner, Wheeler and
Thorne [ 197 ] . Misner, Wheeler and Thorne [ 197 ] characterise the
sign conventions possible in GR into

  -- -------- -------- -------- -- -------
     @xmath   @xmath   @xmath      
     @xmath   @xmath   @xmath      (H.1)
     @xmath   @xmath   @xmath      (H.2)
  -- -------- -------- -------- -- -------

where @xmath is the Minkowski metric; (see also Peacock [ 179 ] §1.5.)
The third sign @xmath can also be fixed by

  -- -------- -- -------
     @xmath      (H.3)
  -- -------- -- -------

@xmath is commonly known as the “signature” of the spacetime. Under
these traditional definitions, some of the main general relativity and
cosmology textbooks can be classified; Misner, Wheeler and Thorne [ 197
] and Carroll [ 190 ] are @xmath , Weinberg [ 96 ] is @xmath , Peebles [
110 , 111 ] is @xmath , and Rindler [ 210 ] and Peacock [ 179 ] are
@xmath . We assume Misner, Wheeler and Thorne’s conventions @xmath .

Our co-ordinates shall be labelled @xmath where @xmath is a timelike
co-ordinate and @xmath are spacelike co-ordinates. We use Greek indices
@xmath to denote spacetime co-ordinates and lower-case Latin @xmath to
denote spatial co-ordinates. Summation over repeated indices is implied
unless otherwise noted.

#### h.1.2 Perturbation Theory

An overdot represents differentiation with respect to the “conformal
time” while a prime generally denotes differentiation with respect to
the co-ordinate time. Variables lie in Fourier space unless an explicit
dependence on the space variables @xmath is declared or the situation is
unambiguous. The transformation character of a variable will, in cases
of ambiguity, be denoted with a capital Roman superscript ( @xmath ) or
subscript @xmath . Unless otherwise specified, we operate in natural
units – i.e. @xmath . Averaged – background – variables are denoted with
an overline (e.g. @xmath and perturbed variables with a preceding @xmath
(e.g. @xmath ) unless otherwise noted. Unit vectors are denoted with an
overhat, e.g. @xmath . Unless otherwise noted a subscript @xmath refers
to the current (observed) value of a quantity.

#### h.1.3 Magnetised Plasmas

When we come to consider magnetised plasmas, we must take great care
with our conventions. There are many different conventions within
electromagnetism and one has to be careful with the units one is working
with; an appendix in Jackson [ 116 ] summarises these. In cosmology it
is still standard to work within Heaviside-Lorentz units, a
centimetre-gram-second system.

We denote real-space electromagnetic fields and the three-current with
lower case Roman letters @xmath , @xmath , @xmath ; although technically
@xmath is the magnetic induction we habitually refer to it as the
magnetic field. We shall later scale our variables with powers of the
scale factor, and these will be denoted by capital Roman letters @xmath
, @xmath , @xmath . We will not work with unscaled variables while in
Fourier space. Other scaled magnetohydrodynamic variables are denoted
with a subscript @xmath , e.g. @xmath . The electromagnetic charge
density and conductivity are denoted by @xmath and @xmath and the baryon
density by @xmath , and the scaled cases by @xmath , @xmath and @xmath
respectively.

### h.2 Notation

Due to the large number of variables we consider, we present a table
summarising our notation. Some few symbols are used twice (the entropy
and action, for example). These cases are cross-referenced one to
another; in the thesis the context should make it clear which property
is meant.