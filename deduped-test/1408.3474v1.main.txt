##### Contents

-    Permission To Use
-    Abstract
-    1 Introduction and Thesis Outline
    -    1.1 Introduction
    -    1.2 Research Objectives
    -    1.3 Research Methodology
    -    1.4 Organisation of the Thesis
-    2 Background on Point-to-Point Communications
    -    2.1 Single-Antenna Wireless Communication
        -    2.1.1 Transmission
        -    2.1.2 Wireless Channel
        -    2.1.3 Receiver and Detection
    -    2.2 Multiple Antenna and Spatial Diversity
        -    2.2.1 Receive Diversity
        -    2.2.2 Transmit Diversity
    -    2.3 Summary
-    3 Cooperative Communications
    -    3.1 Overview and Topologies of Relay Networks
    -    3.2 Relaying Protocols
    -    3.3 Relay Channel Model
    -    3.4 Cooperative Strategies
        -    3.4.1 Repetition-Based Cooperation
        -    3.4.2 Distributed Space-Time Coding-Based
    -    3.5 Summary
-    4 Performance of Differential Amplify-and-Forward Dual-Hop Relaying
    -    4.1 Introduction
    -    4.2 System Model
    -    4.3 Two-Symbol Differential Detection
        -    4.3.1 Detection Process
        -    4.3.2 Performance Analysis
    -    4.4 Multiple-Symbol Detection
        -    4.4.1 Detection Process
        -    4.4.2 Performance Analysis
    -    4.5 Simulation Results
    -    4.6 Conclusion
    -    4.A Optimum Power Allocation
-    5 Differential Amplify-and-Forward Relaying Using Semi-MRC
    Combining
    -    5.1 Introduction
    -    5.2 System Model
    -    5.3 Channel Models and Differential Detection
        -    5.3.1 Mobile Source, Fixed Relays and Destination
        -    5.3.2 Mobile Source and Destination, Fixed Relays
        -    5.3.3 All Nodes are Mobile
        -    5.3.4 Combining Weights and Differential Detection
    -    5.4 Error Performance Analysis
    -    5.5 Simulation Results
    -    5.6 Conclusion
    -    5.A Proof of ( 5.36 ) and ( 5.37 )
    -    5.B Proof of ( 5.52 )
    -    5.C Proof of ( 5.53 )-( 5.55 )
-    6 Selection Combining for Differential Amplify-and-Forward
    Relaying: Slow-Fading Case
    -    6.1 Introduction
    -    6.2 System Model
    -    6.3 Selection Combining and Differential Detection
    -    6.4 Error Performance Analysis
    -    6.5 Simulation Results
    -    6.6 Conclusion
-    7 Selection Combining for Differential Amplify-and-Forward
    Relaying: General Time-Varying Case
    -    7.1 Introduction
    -    7.2 System Model
    -    7.3 Selection Combining and Non-Coherent Detection
    -    7.4 Error Performance Analysis
    -    7.5 Simulation Results
    -    7.6 Conclusion
    -    7.A Proof of ( 7.56 )
-    8 Performance of Differential Distributed Space-Time Coding
    -    8.1 Introduction
    -    8.2 System Model
    -    8.3 Two-Codeword Differential Detection
        -    8.3.1 Time-Series Model and Differential Detection
        -    8.3.2 Performance Analysis
    -    8.4 Multiple-Codeword Differential Detection
    -    8.5 Numerical Results
    -    8.6 Conclusion
    -    8.A Proof of ( 8.21 )
    -    8.B Proof of ( 8.22 ) and ( 8.23 )
    -    8.C Proof of ( 8.25 ) and ( 8.26 )
    -    8.D Proof of ( 8.46 ) and ( 8.47 )
-    9 Conclusions and Suggestions for Further Studies
    -    9.1 Conclusions
    -    9.2 Future Studies

\printnomenclature

[5em]

###### List of Figures

-    1.1 A simple cooperative network with three nodes.
-    2.1 A point-to-point wireless communication link.
-    2.2 A communication system operating over a wireless fading
    channel.
-    2.3 Signal space plot for @xmath -PSK. Here @xmath .
-    2.4 Evolution of channel coefficients and corresponding
    auto-correlation values of a Rayleigh flat-fading channel under
    different fading rates.
-    2.5 Spatial diversity using multiple receive antennas.
-    2.6 Spatial diversity using multiple transmit antennas and
    repetition-based code.
-    2.7 Block diagram of the Alamouti orthogonal space-time block
    coding scheme.
-    3.1 Single-branch dual-hop relaying without direct link for
    coverage extension.
-    3.2 Multi-branch dual-hop relaying without direct link for coverage
    extension and diversity improvement.
-    3.3 Single-branch dual-hop relaying with direct link.
-    3.4 Multi-branch dual-hop relaying with direct link.
-    3.5 Theoretical pdf of @xmath and obtained distributions of @xmath
    , @xmath and @xmath for various cases.
-    3.6 Transmission process in repetition-based relaying strategy.
-    3.7 Transmission process in DSTC-based strategy.
-    4.1 Illustration of single-branch dual-hop relaying system without
    direct link.
-    4.2 Theoretical and simulation values of error floor vs. fading
    rate, @xmath , @xmath .
-    4.3 BER as a function of power allocation factor for various
    channel variances and @xmath dB from top to bottom, using DQPSK.
-    4.4 Theoretical and simulation BER of a D-DH relaying in different
    fading cases and @xmath using DBPSK and CDD ( @xmath ) and MSD (
    @xmath ).
-    4.5 Theoretical and simulation BER of a D-DH relaying in different
    fading cases and @xmath using DBPSK and CDD ( @xmath ) and MSD (
    @xmath ).
-    4.6 Theoretical and simulation BER of a D-DH network in different
    fading cases and @xmath using DQPSK and CDD ( @xmath ) and MSD (
    @xmath ).
-    4.7 Theoretical and simulation BER of a D-DH relaying in different
    fading cases and @xmath using DQPSK and CDD ( @xmath ) and MSD (
    @xmath ).
-    4.8 BER of MSDD as a function of block length at @xmath dB for
    different fade rates.
-    5.1 The wireless relay model under consideration.
-    5.2 Theoretical pdf of @xmath and obtained distributions of @xmath
    , @xmath and @xmath in Scenario I (upper), Scenario II (middle) and
    Scenario III (lower). These scenarios are listed in Table 5.1 .
-    5.3 Theoretical and simulation results of D-AF relaying with two
    relays in Scenario I (lower plots), Scenario II (middle plots) and
    Scenario III (upper plots) using DBPSK.
-    5.4 Theoretical and simulation results of D-AF relaying with three
    relays in Scenario I (lower plots), Scenario II (middle plots) and
    Scenario III (upper plots) using DQPSK.
-    6.1 Block diagram of the post-detection selection combiner at the
    destination.
-    6.2 BER as a function of power allocation factor @xmath for @xmath
    dB.
-    6.3 Theoretical and simulation BER of the D-AF system with semi-MRC
    and SC methods using DBPSK (lower) and DQPSK (upper).
-    7.1 The wireless relay model under consideration.
-    7.2 Block diagram of the selection combiner at Destination of a
    D-AF relay network.
-    7.3 Error floors as functions of channel fade rates for different
    channel qualities, @xmath .
-    7.4 Snapshot of realizations of the direct and cascaded channels
    and the corresponding autocorrelations in different cases. Here
    @xmath and @xmath are defined as in Eq. ( 7.1 ).
-    7.5 BER as a function of power allocation factor @xmath for @xmath
    dB.
-    7.6 Theoretical and simulation BER of the D-AF system with SC and
    semi-MRC methods using DBPSK in different fading rates and symmetric
    channels: @xmath .
-    7.7 Theoretical and simulation BER of the D-AF system with SC and
    semi-MRC methods using DBPSK in different fading rates and strong SR
    channel: @xmath .
-    7.8 Theoretical and simulation BER of the D-AF system with SC and
    semi-MRC methods using DBPSK in different fading rates and strong RD
    channel: @xmath .
-    8.1 The wireless relay network under consideration.
-    8.2 Error floor vs. normalized channel fade rates using Alamouti
    space-time code and BPSK.
-    8.3 BER results of two-codeword and multiple-codeword differential
    detection of D-DSTC relaying with two relays in different cases
    using Alamouti code and BPSK.
-    8.4 BER results of two-codeword and multiple-codeword differential
    detection of D-DSTC relaying with two relays in different cases
    using Alamouti code and QPSK.

## Chapter 1 Introduction and Thesis Outline

### 1.1 Introduction

Perhaps when Heinrich R. Hertz mentioned “I do not think that the
wireless waves I have discovered will have any practical application”,
from his modesty, he did not really believe in great advances in this
field. Soon, Nicola Tesla increased the distance of electromagnetic
transmission and Guglielmo Marconi made a breakthrough in wireless
communications with the discovery of short waves. Nowadays, wireless
communications are non-detachable parts of our life. From small cordless
gadgets and cellular phones to radars and satellites communications,
they all have one thing in common, an antenna and an RF transceiver
which wirelessly connects them to the world.

In wireless communications, long distances, natural or artificial
barriers and mobility of users introduce a notorious effect, known as
fading, which can be divided into large-scale and small-scale fading.
Large-scale fading is due to path loss of signals as a function of
distance and shadowing by large objects such as buildings and hills [ 1
, 2 , 3 ] . On the other hand, small-scale fading is due to the
constructive and destructive interference of the multiple signal copies
received over multiple paths between the transmitter and receiver. It is
the later case that causes rapid fluctuation in the signal strength
which limits the transmission reliability substantially over wireless
channels.

The increasing demand for better quality and higher data rate in
wireless communication systems motivated the use of diversity techniques
to mitigate the destructive effect of fading. The basic idea of all
diversity techniques is to provide different replicas of the same
information over multiple independently-faded paths in order to decrease
the probability that the received signal is in deep fade (i.e., when the
channel gain is dropped dramatically in magnitude), thus increase the
reliability and the probability of successful transmission. Common
diversity techniques that have been studied intensively in the
literature and applied in practice include time diversity (e.g., channel
coding, interleaving), spatial diversity (e.g., multiple-input
multiple-output (MIMO) systems), combination of multi-path and frequency
diversity (e.g., orthogonal frequency division multiplexing (OFDM)
together with channel coding or pre-coding).

Among different diversity techniques, spatial diversity using multiple
antennas has been shown to be a very effective technique both in the
literature and practice because of its better spectral efficiency.
However, using multiple antennas is not always feasible in many
applications. The obvious example is in personal mobile units in which
there is insufficient space to make wireless channels corresponding to
multiple antennas uncorrelated. This limitation was however addressed by
the technique of cooperative communications [ 4 , 5 ] .

Today, cooperative communications has become a mature research topic in
the literature. Currently, a special type of cooperative communication
(with the help of one relay) has been standardised in the 3 GPP LTE
technology to leverage the coverage problem of cellular networks and it
is envisaged that LTE-advanced version will include cooperative relay
features to overcome other limitations such as capacity and interference
[ 6 ] . There are also applications for cooperative relay networks in
wireless LAN, vehicle-to-vehicle communications [ 7 ] and wireless
sensor networks that have been discussed in [ 8 , 9 , 10 , 6 , 11 ] and
references therein.

An illustration of a simple cooperative network with three nodes is
given in Figure 1.1 . As can be seen, there are two links from Source to
Destination. The first link is the direct channel from Source to
Destination (SD), which is similar to the channel encountered in
conventional point-to-point communication. On the other hand, there is a
channel from Source to Relay (SR) and a channel from Relay to
Destination (RD). Since Relay can also listen to Source from SR channel,
it would be able to re-broadcast the received data to Destination
through RD channel. In this way, the second link is established through
Source-Relay-Destination path. For convenience, the overall channel of
Source-Relay-Destination is called the cascaded or the equivalent
channel. Therefore, the overall diversity and performance of the network
would benefit from the extra antenna which is constructed using the help
of Relay. Similarly, multiple relays can be used to achieve higher
diversity.

Depending on the protocol that relays utilize to process and re-transmit
the received signal to the destination, the relay networks have been
generally classified as decode-and-forward or amplify-and-forward [ 12 ]
. Among these two protocols, amplify-and-forward (AF) has been the focus
of many studies because of its simplicity in the relay’s function.
Specifically, the relay’s function is to multiply the received signal
with an amplification factor and forward the result to the destination.

Moreover, depending on the strategy that relays utilize to cooperate,
relay networks are categorized as repetition-based and distributed
space-time coding (DSTC)-based [ 13 ] . In the repetition-based
strategy, relays forward the received signals to the destination in
time-division duplex (TDD) fashion, whereas in the DSTC-based strategy,
the relays simultaneously transmit the received symbols such that a
space-time code can be constructed at the destination. The later
strategy has a better spectral efficiency than the former but it is more
complicated to design and build [ 13 ] .

At the destination, based on the type of modulation, either coherent or
non-coherent detection would be applied. In coherent detection, it is
required that the instantaneous channel state information (CSI) of all
transmission links are known at the destination. Although this
requirement can be accomplished by sending pilot (training) signals and
using channel estimation techniques in slow-fading environments, it is
not feasible in fast time-varying channels. Moreover, collecting the CSI
of SR channels at the destination is questionable due to noise
amplification at relays. Furthermore, the computational complexity and
overhead of channel estimation increase proportionally with the number
of relays. In addition, in fast time-varying channels a more frequent
channel estimation is needed, which reduces the effective transmission
rate and spectral efficiency. Also, all channel estimation techniques
are subject to impairments that would directly translate to performance
degradation.

To circumvent these limitations, in repetition-based strategy,
differential modulation with two-symbol non-coherent detection has been
considered in [ 14 , 15 , 16 , 17 , 18 , 19 , 20 ] for AF relay
networks. This technique is referred as differential AF (D-AF)
transmission. In D-AF transmission, information bits are differentially
encoded at the source. Only the second-order statistics of the SR
channels (no instantaneous CSI) are needed at the relays to determine
the amplification factor [ 14 , 15 , 16 , 17 ] . Then, the decision
variables, computed from the received signals in different links, are
weighted and summed at the destination. Computing the optimum weights
for Maximum-Ratio-Combining (MRC) require the instantaneous CSI of
Relay-Destination (RD) channels, which are unknown, and the
amplification factors of relays. Thus, the second-order statistics of
the RD channels have been used to define a set of fixed weights in [ 14
, 15 , 16 , 17 ] . For further reference, this method is referred as
semi-MRC.

Distributed space-time coding (DSTC) is another strategy that has been
considered in cooperative networks to provide a better spectral
efficiency than the repetition-based strategy [ 13 ] . In the DSTC-based
strategy [ 21 , 22 , 13 ] , the relays cooperate to process and forward
the received signals to the destination so that a space-time code can be
constructed at the destination and therefore allow the system to enjoy
the higher spectral efficiency of space-time codes [ 23 ] . Moreover,
the constructed virtual antenna array (VAA) enables one to extend
established techniques of traditional MIMO systems to relay networks.
For instance, most of the designed space-time codes for MIMO systems can
be utilized in cooperative networks [ 21 , 22 , 13 ] . Also,
differential space-time codes [ 24 , 25 ] can be adapted for relay
networks as in [ 26 , 27 , 28 , 29 ] so that non-coherent detection can
be done without any requirement of the CSI.

### 1.2 Research Objectives

Motivated from the previous discussion, this thesis is concerned with
differential modulation and non-coherent detection in wireless relay
networks. The main objectives are outlined as follows.

@xmath Most of the existing literature on differential
amplify-and-forward transmission assumes a slow-fading environment and
shows that a 3-4 dB loss is observed between coherent and non-coherent
detection. However, with the increase of vehicles’ speed (e.g., when a
mobile user travels in a high-speed train) [ 30 , 31 ] , the wireless
channels become more time-varying. This faster variation thus leads to a
higher degradation in the performance. Hence, it is important to analyse
the performance and examine the robustness of non-coherent detection in
fast-fading channels. The first objective of our research is therefore
to study differential amplify-and-forward relay networks in time-varying
Rayleigh fading channels. In point-to-point communications, to study the
performance of differential modulation over time-varying channels, a
time-series model is often used for modelling the direct channel. In
relay networks, the cascaded channels have a more complex distribution
than that of the direct channel. To the best of our knowledge, to date,
there is no study on the time-series model of cascaded channels. Hence,
a time-series model is developed to characterize the evolution of the
cascaded channel in time. Based on this model, the performance of
several important topologies are investigated. This investigation would
be a useful tool to design a robust system and prevent the network to
fall into regions that additional power transmission will not improve
the performance (error floor regions).

@xmath In the conventional non-coherent detection, the decision variable
is computed from the latest two received symbols. However, two-symbol
differential detection would not perform well in fast-fading channels.
Hence, it would be useful to improve the performance of non-coherent
detection in time-varying channels using other techniques. One of the
techniques that has been used in point-to-point links to improve the
performance of non-coherent detection in time-varying channels is
multiple-symbol differential (MSD) detection [ 32 ] . In this technique,
a larger window of the received symbols are jointly processed for
detection. Here, we consider the application of MSD decoding and
investigate its effectiveness in the context of relay networks for two
relay topologies.

@xmath The Maximum-Ratio Combining (MRC) technique needs at least the
second-order statistics of all transmission links. However, collecting
the second-order statistics of all channels at the destination might be
a challenge (if not impossible) for some applications. On the other
hand, selection combining does not need any kind of CSI. Although the SC
method has been considered for point-to-point communications with
diversity reception, this technique has not been considered for relay
networks employing differential amplify-and-forward strategy. Hence, our
objective is to develop selection combining for differential
amplify-and-forward relay networks. Performance analysis of the SC
method shall also be considered and compared with that of the MRC method
to determine a trade-off between simplicity and performance.

### 1.3 Research Methodology

The main methodology in our research is summarized below.

-   Communication theory [ 33 ] is the main tool to develop new signal
    processing algorithms and conduct performance analysis of the
    networks under consideration. Probability theory, random variables
    and processes, linear algebra and matrix analysis are also
    extensively used in our research.

-   Channel modelling in time-varying scenarios for relay networks is
    identified as an important and crucial task. This will be done by
    applying and extending the modelling techniques in point-to-point
    channels.

-   As any design starts with the system modelling stage and it is not
    possible to build the complete physical system at the beginning,
    computer simulation using MATLAB is a common and important tool in
    communications research (and perhaps in many other related areas).
    Here, MATLAB is used to simulate various elements of communication
    links such as Source, wireless channels, Relays and Destination. The
    accuracy of channel modelling and any important or major
    approximations made in the theoretical development will be verified
    with computer simulation. In addition, the performance of the
    developed signal processing algorithms will be checked and verified
    with the theoretical analysis and the results will be interpreted.

### 1.4 Organisation of the Thesis

This dissertation is organized in a manuscript-based style. The first
two chapters of the thesis discuss relevant background of point-to-point
and relay wireless communications. The published or submitted
manuscripts are included as the contributions of the thesis.

Chapter 2 contains the background on point-to-point wireless
communications which will be extended to relay networks in Chapter 3 .
In Chapter 2 , first, single-antenna communication systems, the block
diagram of transmitter and receiver, the wireless channel model and
modulation and demodulation techniques are described. Next,
multiple-antenna communication systems, receive and transmit diversity,
combining methods and space-time coding are presented. Chapter 3 covers
the essential background knowledge on cooperative networks. The major
relay topologies, relay protocols and cooperative strategies, that are
relevant to this thesis, are introduced in this chapter.

The manuscript in Chapter 4 studies a dual-hop relaying system without
direct link that employs differential @xmath -PSK together with
two-symbol and multiple-symbol differential detection. The performance
of this system in time-varying channels is analysed. A multiple-symbol
detection is also developed and theoretically analysed for this system.
The manuscript in Chapter 5 considers multi-branch dual-hop relaying
with direct link using semi-MRC at the destination. Differential @xmath
-PSK and two-symbol non-coherent detection are employed in this system
and its performance is evaluated in time-varying channels. The
manuscript in Chapter 6 studies selection combining (SC) at the
destination of relay networks. The performance of this system in
slow-fading channels is analysed and compared with the system using the
semi-MRC method. The manuscript in Chapter 7 examines the SC method in
general time-varying Rayleigh fading channels. While Chapters 4 - 7 are
concerned with the repetition-based strategy, Chapter 8 considers a
multi-branch dual-hop relaying without direct link and with the use of
distributed space-time coding (DSTC) strategy. The performance of this
system using two-symbol differential detection in terms of diversity
over time-varying channels is analysed. Moreover, a multiple-symbol
differential detection is developed for this system to improve its
performance in fast-fading channels. Finally, Chapter 9 concludes this
thesis by summarizing the contributions and suggesting potential
research problems for future studies.

Notation : Bold upper-case and lower-case letters denote matrices and
vectors, respectively. @xmath , @xmath , @xmath denote transpose,
complex conjugate and Hermitian transpose of a complex vector or matrix,
respectively. @xmath denotes the absolute value of a complex number and
@xmath denotes the Euclidean norm of a vector. @xmath stands for complex
Gaussian distribution with zero mean and variance @xmath . @xmath
denotes expectation operation. Both @xmath and @xmath show the
exponential function. @xmath is the diagonal matrix with components of
@xmath on the main diagonal and @xmath is the @xmath identity matrix. A
symmetric @xmath Toeplitz matrix is defined by @xmath . @xmath denotes
determinant of a matrix. @xmath is the set of complex vectors with
length @xmath . @xmath is the set of integer numbers.

## Chapter 2 Background on Point-to-Point Communications

This chapter discusses point-to-point communication systems using single
antenna and multiple antennas in wireless fading channels. First, for a
single antenna system, the block diagram of the transmitter and
receiver, the channel model and modulation and demodulation techniques
are described. Specifically, the focus is on differential encoding and
non-coherent detection techniques which do not require channel
estimation. Next, diversity systems using multiple antennas, different
combining methods and space-time codes are described. The background
given in this chapter will be extended and applied to the context of
relay networks in the next chapters.

### 2.1 Single-Antenna Wireless Communication

Figure 2.1 depicts a point-to-point communication link in which a source
transmits signals to a destination using a single antenna over a
wireless channel. The transmitted signal is an electromagnetic wave in
the radio frequency band (RF). This signal is generated by the
transmitter, whose detailed operation is described next.

#### 2.1.1 Transmission

The structure of the transmitter of a point-to-point communication
system over a wireless channel is illustrated in Figure 2.2 . For
simplicity, all signals and signal processing blocks are shown in the
complex form. In reality, the complex form is divided into real and
imaginary parts, which correspond to the in-phase and quadrature
components of the RF signal. Moreover, due to Digital Signal Processing
(DSP) implementation, the discrete-time equivalent is used for signal
representation before the pulse-shaping block. Information to be
transmitted, either analog signals such as audio or video, or digital
signals such as text or multi-media, are converted to binary (bit)
sequence by previous stages (e.g., source coding). Then, the binary
sequence is given to the modulation block.

##### @xmath-PSK Modulation

Information bits are mapped to symbols using a signalling (or
modulation) scheme. Among different signalling techniques, the @xmath
-ary phase-shift keying ( @xmath -PSK) is widely used in existing
technologies such as WLANs, RFID standards, Bluetooth, satellite
communications etc., owing to its constant envelope property and good
bandwidth efficiency. In @xmath -PSK, a group of @xmath information bits
are encoded into the phase of symbol @xmath where @xmath and @xmath is
the discrete-time index. For a @xmath -PSK there are @xmath signal
points equally spaced on the circle. Signal space plot of @xmath -PSK is
depicted in Figure 2.3 , in which eight signal points are shown.

##### Differential Encoding

The second block can be bypassed for coherent detection such that @xmath
. However, for applications that channel estimation is not feasible,
information symbols can be differentially encoded, so that the receiver
does not need the CSI. Such a scheme is called differential @xmath -PSK
( @xmath -DPSK). Given @xmath and @xmath , @xmath -PSK and @xmath -DPSK
symbols at time indices @xmath and @xmath , respectively, the @xmath
-DPSK symbol at time @xmath is obtained as

  -- -------- -- -------
     @xmath      (2.1)
  -- -------- -- -------

##### Pulse Shaping and Up conversion

The resulting discrete-time symbol is then converted to a continues-time
signal using the pulse shaping block in the baseband. The baseband
signal, @xmath , is then up-converted by a local oscillator to produce
an RF signal @xmath , where @xmath is the symbol time (or symbol
duration) ¹ ¹ 1 To simplify the notation, signal equations in the
passband are avoided and only the baseband representations are used. .
Next, the RF signal is propagated through the wireless channel and would
be affected by large scale fading (pathloss and shadowing) and small
scale fading. Small scale fading or simply fading is the main cause of
rapid fluctuation in the signal strength. Hence, it is important to look
at the mathematical model of a fading channel.

#### 2.1.2 Wireless Channel

In wireless communications, to avoid dealing with the complexity of
electromagnetic equations, wireless channels are modelled with a linear
time-varying system [ 1 ] . Depending on the propagation delay, channels
are divided to frequency selective and flat fading channels. In
frequency selective channels, the propagation delay is larger than the
symbol time whereas in flat-fading channels the delay spread is much
less than the symbol time. The focus of this thesis is on flat-fading
channels, which are applicable for narrowband communication systems. For
flat-fading channels, the channel impulse response is represented by one
filter tap (or coefficient). In addition, since most of the processing
is actually done at the baseband, the baseband representation of the
channel coefficient is used. This coefficient is modelled as a complex
random variable whose distribution depends on the nature of the radio
propagation environment.

##### Statistical Model

Typical distributions for the baseband channel coefficient are Rayleigh,
Rician, Nakagami, etc. In this thesis, the Rayleigh flat-fading model is
adopted since it is a popular model for many applications such as mobile
networks. Let @xmath represent the channel coefficient in a Rayleigh
flat-fading model at time index @xmath . Then, @xmath is modelled as a
complex Gaussian random variable with zero mean and variance @xmath . In
fact, the name “Rayleigh” fading comes from the distribution of the
envelope @xmath , which is a Rayleigh distribution:

  -- -------- -- -------
     @xmath      (2.2)
  -- -------- -- -------

Also, the related random variable @xmath is exponentially distributed
with density

  -- -------- -- -------
     @xmath      (2.3)
  -- -------- -- -------

The exponential random variable is mostly encountered in the performance
analysis.

##### Auto-Correlation

Due to mobility of users, the fading channel also changes over time and
thus the rate of channel variation has a significant impact on many
aspects of a wireless communication system. A statistical quantity that
models this variation in time is known as the channel auto-correlation
function, @xmath , defined as

  -- -------- -- -------
     @xmath      (2.4)
  -- -------- -- -------

where @xmath is the time-distance between two channel coefficients at
time indices @xmath and @xmath , respectively. If the symbol duration is
smaller than the period of time over which the fading process is
correlated, the channel is called slow-fading. Otherwise it is
fast-fading.

A popular model for the auto-correlation function of a flat-fading
channel is Clark’s or Jakes’ model [ 34 ] , given as

  -- -------- -- -------
     @xmath      (2.5)
  -- -------- -- -------

where @xmath is the zeroth-order Bessel function of the first kind:

  -- -------- -- -------
     @xmath      (2.6)
  -- -------- -- -------

and @xmath and @xmath are the Doppler frequency and symbol duration,
respectively. The Doppler frequency is caused by the mobility of users
and determined as @xmath where @xmath is the carrier frequency used by
the communication system, @xmath is the velocity of the user and @xmath
is the speed of light. Usually, the rate of the channel variation is
shown with the product @xmath and it is called the normalized Doppler
frequency.

To get more insights about the relationship between the channel
variation and the normalized Doppler frequency, the evolution of the
amplitude of a Rayleigh flat-fading channel coefficient over time, under
different fade-rates, and also its auto-correlation function is plotted
in Figure. 2.4 . As can be seen from the figure, the variation rate of
the channel is directly related to the normalized Doppler value and the
auto-correlation function value. For @xmath , the channel coefficients
are approximately fixed over time, which is also related to the small
slope of the corresponding auto-correlation plot. Such a channel is
called slow-fading. For @xmath and @xmath the auto-correlation values
change faster and the channel variations are larger. Such channels would
be called fast-fading. The above values of the normalized Doppler
frequency can be translated to different vehicle speeds of communication
nodes in a typical wireless system. For example, in a system with
carrier frequency @xmath GHz and symbol duration @xmath ms, the
corresponding Doppler shifts would be around @xmath Hz, which would
correspond to the speeds of @xmath km/hr, respectively ( @xmath m/s is
the speed of light).

##### Auto-Regressive Models

It is also important to mathematically model the evolution of channel
coefficients in time using a time-series model. Such a model would be
useful for simulation purpose or in performance analysis of a
communication system operating over time-varying channels. The
first-order AR model, AR(1), has been widely used and verified as a
simple yet effective time-series model for Rayleigh flat-fading channels
[ 35 , 36 ] . It is given as

  -- -------- -- -------
     @xmath      (2.7)
  -- -------- -- -------

where @xmath is the auto-correlation value of the channel and @xmath is
distributed as @xmath and independent of @xmath . It is easy to see that
with the above model, the distribution of @xmath is complex Gaussian
with zero mean and variance @xmath .

##### Channel Simulation

There are several methods to generate time-correlated channel
coefficients in computer simulation. In this thesis, the simulation
algorithm of [ 37 ] is used. This simulation algorithm utilizes a
sum-of-sinusoids method to generate time-correlated Rayleigh-faded
channel coefficients. For instance, to generate @xmath :

  -- -------- -- -------
     @xmath      
     @xmath      (2.8)
     @xmath      (2.9)
     @xmath      
  -- -------- -- -------

where @xmath and @xmath are statistically independent and uniformly
distributed on @xmath for all @xmath and @xmath is the number of
multipaths chosen arbitrarily large enough for an accurate model [ 37 ]
. The input to the simulation algorithm is the normalized Doppler
frequency of the channels, which is a function of the velocity of users
and the symbol duration (i.e., the transmission rte). For the same
transmission rate, a higher velocity causes a higher fade-rate and thus
less correlation between channel coefficients. Therefore, by changing
the Doppler values, various fading scenarios from slow-fading to
fast-fading channels can be simulated.

#### 2.1.3 Receiver and Detection

The structure of the receiver is illustrated in Figure 2.2 . The signal
from the receive (Rx) antenna is added by AWGN noise in the passband.
Then, the received RF signal @xmath is down-converted by a local
oscillator ² ² 2 It is assumed that the transmitter and receiver are
synchronized. In practice, propagation over a long distance leads to a
delay in the received signal, which can be estimated and compensated for
by a synchronization algorithm. and passed through the match filter to
obtain the continuous-time baseband signal @xmath . The signal @xmath is
then sampled at the symbol rate @xmath to obtain the discrete-time
baseband signal as

  -- -------- -- --------
     @xmath      (2.10)
  -- -------- -- --------

where @xmath is the transmit power per symbol, @xmath is the channel
coefficient and @xmath is the discrete-time white Gaussian noise
component at the receiver. The signal-to-noise ratio (SNR), defined as
the ratio of the average received signal power per (complex) symbol time
to noise power per (complex) symbol time, is given as

  -- -------- -- --------
     @xmath      (2.11)
  -- -------- -- --------

##### Coherent Detection

In the case of coherent detection, the channel coefficient is obtained
by the channel estimator block. Assuming perfect channel estimate,
coherent detection of @xmath -PSK can be performed on a symbol by symbol
basis by multiplying @xmath and @xmath as

  -- -------- -- --------
     @xmath      (2.12)
  -- -------- -- --------

where @xmath when the differential encoder is bypassed in a coherent
system. Then the maximum likelihood (ML) detection of the transmitted
symbol can be obtained as

  -- -------- -- --------
     @xmath      (2.13)
  -- -------- -- --------

The error probability of such a system at high SNR can be shown to
behave as [ 1 ]

  -- -------- -- --------
     @xmath      (2.14)
  -- -------- -- --------

The above expression shows that the achieved diversity order, which is
defined as [ 1 ] ,

  -- -------- -- --------
     @xmath      (2.15)
  -- -------- -- --------

is equal one for this system.

##### Two-Symbol Non-Coherent Detection

When differential encoding is performed at the transmitter, non-coherent
detection can be applied without requiring the knowledge of @xmath
(i.e., no channel estimation is required). Assuming the channel
coefficients stay approximately constant for two successive symbols
i.e., @xmath , one has

  -- -------- -- --------
     @xmath      (2.16)
  -- -------- -- --------

where @xmath is the equivalent noise at the output of the detector,
which is also a complex Gaussian random variable with zero mean and
variance @xmath .

Hence, based on the observations @xmath and @xmath , differential
non-coherent detection of @xmath -DPSK can be performed by computing the
following decision variable

  -- -------- -- --------
     @xmath      (2.17)
  -- -------- -- --------

From the above expression it can be seen that the ML detection of the
transmitted symbol at time @xmath , can be obtained as [ 38 ] :

  -- -------- -- --------
     @xmath      (2.18)
  -- -------- -- --------

which shows that no channel information is needed for the detection. It
is also well known that, because the noise variance is doubled, about 3
dB performance loss exists between coherent and non-coherent detections
in slow-fading environment [ 38 , 3 ] . However, the two-symbol
non-coherent detection suffers a larger performance loss in time-varying
channels [ 3 ] .

##### Multiple-Symbol Differential Detection

To overcome the performance limitations of two-symbol detection,
multiple-symbol differential (MSD) detection [ 32 , 39 , 40 ] has been
proposed for point-to-point communications. In MSD detection, blocks of
@xmath received symbols are jointly processed to decide on @xmath data
symbols. Let’s collect @xmath received symbols into vector @xmath ,
which can be written as

  -- -------- -- --------
     @xmath      (2.19)
  -- -------- -- --------

where @xmath , @xmath and @xmath . The maximum likelihood MSD detection
decision rule reads [ 40 ]

  -- -------- -- --------
     @xmath      (2.20)
  -- -------- -- --------

where @xmath and @xmath and @xmath is the auto-correlation function of
the channel. Using the Choleskey decomposition @xmath , the decision
rule can be further simplified to

  -- -------- -- --------
     @xmath      (2.21)
  -- -------- -- --------

where @xmath is an upper triangular matrix. The above decision rule can
be solved by the sphere decoding algorithm [ 40 ] with low complexity.

### 2.2 Multiple Antenna and Spatial Diversity

As described in the previous section, the diversity order of a
single-antenna communication system over fading channels is equal to
one. To improve the performance of communication systems over fading
channels, diversity techniques such as time, frequency or spatial
diversity can be used. Here, spatial diversity is considered as it
provides better bandwidth efficiency. Spatial diversity is an effective
method to combat detrimental effects in wireless fading channels by
using multiple antennas at the transmitter and/or the receiver. Spatial
diversity can be classified as receive diversity, transmit diversity and
transmit and receive diversity.

#### 2.2.1 Receive Diversity

Receive diversity is simply achieved by employing multiple antennas at
the receiver as depicted in Figure 2.5 . The distance between the
receiver antennas is such that the transmitted symbol experiences an
independent fading value in each link. Assume that symbol @xmath is
transmitted from the transmit (Tx) antenna at time @xmath . The received
signals at Rx antennas are given as

  -- -------- -- --------
     @xmath      (2.22)
  -- -------- -- --------

where the @xmath -th channel @xmath and the noise @xmath are independent
across the antennas. To achieve a diversity, the received signals need
to be combined using some combining technique. There are two main
combining methods that are considered as follows.

##### Maximum Ratio Combining (MRC)

The MRC method weights the received signal in each branch in proportion
to the signal strength and also aligns the phases of the signals to
maximize the output SNR [ 1 ] . The sufficient statistic is given as

  -- -------- -- --------
     @xmath      (2.23)
  -- -------- -- --------

where @xmath are the combining weights. For coherent detection, @xmath
and the quantities @xmath are

  -- -------- -- --------
     @xmath      (2.24)
  -- -------- -- --------

On the other hand, for non-coherent detection one has

  -- -------- -- --------
     @xmath      (2.25)
  -- -------- -- --------

where @xmath . If all links have the same average signal strength, one
has @xmath The output of the combiner is then used to detect the
transmitted signal as

  -- -------- -- --------
     @xmath      (2.26)
  -- -------- -- --------

It has been shown that the error probability of the MRC scheme behaves
as [ 1 ]

  -- -------- -- --------
     @xmath      (2.27)
  -- -------- -- --------

which reveals that the achieved diversity order is @xmath . Also,
non-coherent detection performs around 3 dB worse than its coherent
version in slow-fading channels [ 3 ] .

##### Selection Combining

Another important combining method is selection combining (SC). In the
SC method, the decision statistics of each link is computed and compared
to choose the link with the highest SNR. For coherent detection, this
requires estimation of the channel coefficients of all links. In
practice, the link with the highest amplitude of the received signal is
chosen instead and then only the channel in the chosen link is estimated
for coherent detection. Similarly, for non-coherent detection, the link
with the highest amplitude of the decision variable is chosen. The
output of the combiner is therefore

  -- -------- -- --------
     @xmath      (2.28)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (2.29)
  -- -------- -- --------

The output of the combiner can be used to detect the transmitted signal
using ( 2.13 ) and ( 2.26 ), for coherent and non-coherent,
respectively. The SC method is simpler than the MRC method and can also
provide a diversity of @xmath . However, its performance is inferior to
that of the MRC method [ 23 ] .

#### 2.2.2 Transmit Diversity

Providing a spatial diversity by using multiple antennas at the
transmitter is depicted in Figure 2.6 . There are @xmath transmit
antennas and one receive antenna. There are two main methods to send
signals from Tx antennas to Rx antenna that achieve a diversity of
@xmath . They are discussed next.

##### Repetition-Based Transmission

First, consider a time division duplex (TDD) transmission where all
antennas send the same symbol in different time slots to the receiver.
In any time, only one antenna is turned on and the rest are silent. This
is similar to repetition code [ 1 ] and hence not efficient in terms of
spectral efficiency. However, this method is similar to one of the main
cooperative strategies that employed in this thesis.

Let, @xmath be the transmitted symbol and @xmath be the received symbol
from the @xmath th transmit antenna. It can be written as

  -- -------- -- --------
     @xmath      (2.30)
  -- -------- -- --------

where @xmath is the channel gain from the @xmath th transmit antenna to
the receiver and @xmath is the noise component in each time slot and
@xmath is the number of transmit antennas. As can be seen, there are
@xmath copies of the transmitted symbol perturbed by independent fading
values and noises. Similar to receive diversity, the received signals in
different time slots can be combined using the MRC or SC method to
achieve diversity.

On the other hand, instead of the repetition-based transmission,
space-time codes can be utilized in multiple-antenna systems to achieve
a better spectral efficiency.

##### Space-Time Coding

A space-time code (STC) is essentially a rule that maps the input bits
to the transmitted symbols for a multiple antennas system. With
space-time coding, symbols can be transmitted simultaneously from
different antennas and hence a higher data rate can be achieved.

As an example, consider a system with two transmit and one receive
antennas. For such a system, there is a very famous STC known as
Alamouti orthogonal space-time block code [ 41 ] . The code is described
in Figure 2.7 . A modulation scheme such as PAM, PSK, etc., with @xmath
symbols is used to map @xmath bits to a symbol. Let @xmath and @xmath be
two symbols to be transmitted. In the first time slot, the transmitter
sends @xmath from antenna 1 and @xmath from antenna 2. Then, in the
second time slot, it transmits @xmath and @xmath from antenna 1 and
antenna 2, respectively [ 23 ] . The transmitted codeword is expressed
as

  -- -------- -- --------
     @xmath      (2.31)
  -- -------- -- --------

Here, it is assumed that the channel gains are quasi-static (i.e., they
are constant during two time slots) and hence for simplicity the time
index is dropped for all symbols. Also, transmission of one codeword
during two time slots is called one block transmission.

Then, the received signal at the receiver over two time slots is

  -- -------- -- --------
     @xmath      (2.32)
  -- -------- -- --------

where @xmath is the channel vector, @xmath is the noise vector and
@xmath is the average received power per symbol.

After some simple manipulations, ( 2.32 ) can be re-written as

  -- -------- -- --------
     @xmath      (2.33)
  -- -------- -- --------

The very important property that follows from the specific structure of
the Alamouti STC is that the columns of the above square channel matrix
are orthogonal, regardless of the actual values of the channel
coefficients. Hence, with known channel information at the receiver, the
transmitted symbols can be separately detected by projecting @xmath onto
each of the two columns to obtain the sufficient statistics as follows:

  -- -------- -- --------
     @xmath      (2.34)
     @xmath      (2.35)
  -- -------- -- --------

where @xmath and @xmath are effective noise components. Based on the
above expressions, the information symbols @xmath and @xmath can be
detected in the same way as for single-antenna point-to-point system,
albeit with more favourable effective channel gain of @xmath . In fact,
such an effective channel gain yields a diversity order of 2.

The above discussion also shows that the Alamouti code can send one
symbol per one time slot, while the TDD scheme sends only one symbol per
two time slots for @xmath transmit antennas. Thus, the Alamouti code
provides twice the data rate over the TDD scheme while a full diversity
of two can be achieved by both schemes.

##### Differential Space-Time Coding

To avoid channel estimation at the receiver, similar to the differential
PSK described for single-antenna system, differential unitary space-time
codes (D-USTC) have been investigated in [ 25 , 24 ] for
multiple-antenna systems. In D-USTC, information symbols at block index
@xmath are encoded as an unitary matrix @xmath where @xmath . Here
@xmath and @xmath are the number of transmit antennas and the total
number of codewords, respectively. Designing these unitary matrices has
been studied in [ 25 , 24 ] . The codeword is then differentially
encoded as

  -- -------- -- --------
     @xmath      (2.36)
  -- -------- -- --------

which is also a unitary matrix. The encoded codeword is then transmitted
from multiple antennas to the receiver. The vector form of the received
signal at the receiver at block index @xmath is given as

  -- -------- -- --------
     @xmath      (2.37)
  -- -------- -- --------

##### Two-Codeword Non-Coherent Detection

Also, similar to DPSK, two-symbol non-coherent detection can be applied
to D-USTC used in the multiple-antenna system. In the case of
slow-fading, it is assumed that the channel vector is approximately
constant for two block transmissions, i.e.,

  -- -------- -- --------
     @xmath      (2.38)
  -- -------- -- --------

Substituting ( 2.36 ) and ( 2.38 ) into ( 2.37 ) gives

  -- -------- -- --------
     @xmath      (2.39)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (2.40)
  -- -------- -- --------

is the equivalent noise vector at the detector output, which is @xmath .
Based on ( 2.39 ), non-coherent detection of the transmitted codeword is
as folows [ 25 , 24 ] :

  -- -------- -- --------
     @xmath      (2.41)
  -- -------- -- --------

Again, around 3 dB performance degradation exists between coherent and
non-coherent detections [ 25 , 24 ] over slow-fading channels. The
performance degradation is, however, larger for time-varying channels [
42 ] .

##### Multiple-Symbol Non-Coherent Detection

Similar to multiple-symbol differential (MSD) decoding [ 32 , 40 , 39 ]
of DPSK signals in single-antenna systems, the MSD detection has been
investigated for D-USTC in MIMO channels in [ 43 ] . Let the @xmath
received symbols be collected in vector @xmath , which can be expressed
as

  -- -------- -- --------
     @xmath      (2.42)
  -- -------- -- --------

where @xmath is a @xmath block-diagonal matrix and @xmath and @xmath .

The maximum likelihood MSD detection processes blocks of @xmath
consecutively received symbols to find estimates for @xmath codewords
@xmath which correspond to @xmath transmit codewords in @xmath . The ML
MSD detection rule can be written as [ 43 ]

  -- -------- -- --------
     @xmath      (2.43)
  -- -------- -- --------

where @xmath and @xmath is given as

  -- -------- -- --------
     @xmath      (2.44)
  -- -------- -- --------

and @xmath is the auto-correlation function. Since the complexity of the
ML MSD detection grows exponentially with @xmath , a tree-search
decoding algorithm (i.e., sphere decoding) has been developed in [ 43 ]
to solve the minimization of ( 2.43 ) with low complexity.

### 2.3 Summary

In this chapter, point-to-point communication systems using single
antenna and multiple antennas were introduced. For single-antenna
systems, the structures of the transmitter, channel fading model and
receiver were described. For multiple-antenna systems, receive diversity
using two important combining techniques (MRC and SC) and also transmit
diversity using repetition coding and space-time coding were presented.
Also, differential modulation and non-coherent detection were discussed
for both cases. It was pointed out that 3 dB performance loss exists
between coherent and non-coherent detections in slow-fading channels and
that the performance degradation would be larger in fast time-varying
channels. Multiple-symbol differential detection is also introduced for
both scenarios to mitigate performance degradation in fast time-varying
channels.

In the next chapter, these fundamental concepts will be extended and
applied to relay networks. Important topologies, relay protocols and
strategies will be introduced. Specifically, amplify-and-forward
relaying together with repetition-based relaying and distributed
space-time coding will be elaborated.

## Chapter 3 Cooperative Communications

In the previous chapter, point-to-point communications was introduced.
It was explained that the effect of multipath fading can be mitigated
using diversity techniques. Specifically, spatial diversity using
multiple antennas at either transmitter or receiver was elaborated.
However, in many wireless applications, such as cellular networks, WLAN,
and ad-hoc sensor networks, deploying multiple antennas is not feasible.
This is mainly due to the size and weight restrictions of these
applications. In addition, due to power limitation of wireless systems,
users at far locations or on the borders of wireless cells, suffer from
coverage limit and interference from other neighbour cells. Fortunately,
providing spatial diversity became feasible in these applications thanks
to the work of Sendonaris et al. on cooperative communications [ 4 , 5 ]
.

In this chapter, cooperative or relay communications are presented as a
mean to overcome the above mentioned limitations of deploying multiple
antennas at one communication terminal. The canonical relay network
topologies, relay protocols and cooperative strategies are introduced.
The background in this chapter is useful for better understanding of the
main contributions in subsequent chapters.

### 3.1 Overview and Topologies of Relay Networks

Due to non-directional propagation of electromagnetic waves, all users
in a network are able to receive signals from other users. In
cooperative communications, users act as relays that receive and process
signals from Source and forward the results to Destination. Depending on
the availability of the direct channel from the source to the
destination or the number of relays in the network, various topologies
can be constructed. Moreover, relay networks can be distinguished by the
protocol that the relays use to process the received signals from Source
or by the strategy of cooperation. In the following, the main
topologies, protocols and strategies, that will be employed in the next
chapters, are introduced.

##### Single-Branch Dual-Hop Relaying Without Direct Link

Depending on the propagation conditions, the direct link between the
source and the destination may not be sufficiently strong to facilitate
data transmission. For instance, a mobile user at the cell edge of a
cellular network would receive a weak signal of interest from the base
station and experience a coverage limit. In this situation, a neighbour
user can act as a relay to bridge the source to the destination,
creating a canonical relaying topology, namely single branch dual-hop
(DH) relaying without direct link. Figure 3.1 depicts a dual-hop
relaying system in a cellular network. As can be seen, a mobile user
(Source) communicates with the base station (Destination) via another
mobile user (Relay). Dual-hop relaying has been studied in the
literature as a solution to overcome coverage limits of many wireless
applications such as cellular networks, WLAN, wireless sensor networks,
etc [ 6 ] . In particular, dual-hop relaying has been developed in WLAN
IEEE 802.11 technology and WiMAX IEEE 802.16j and has been standardized
in 3GPP LTE [ 6 ] . Moreover, in addition to its own importance,
dual-hop relaying is the backbone of other topologies with
multi-branches to be studied in the next chapters. In Chapter 4 , a
dual-hop relay network will be studied in details.

##### Multi-Branch Dual-Hop Relaying Without Direct Link

Single-branch dual-hop relaying can be extended to multi-branch dual-hop
relaying if there are more relays willing to cooperate. This is depicted
in Figure 3.2 . In this topology, the user experiencing coverage limit
can benefit from both coverage extension and diversity improvement with
the help of other users. The maximum achievable diversity in this
topology equals @xmath , the number of relays. In Chapter 8 a
multi-branch dual-hop relaying without direct link is studied.

##### Single-Branch Dual-Hop Relaying with Direct Link

In case that the received signal from the direct link is sufficiently
strong, it can be used to improve the diversity gain of the network.
Figure 3.3 depicts a relay network with a direct link and a single
branch dual-hop relaying link. The maximum achievable spatial diversity
for this network is two. This architecture has been examined in several
studies as one of the important relay topologies. This topology is also
considered in Chapters 5 , 6 , 7 of this thesis.

##### Multi-Branch Dual-Hop Relaying with Direct Link

Single-branch relaying with direct link can be extended to multi-branch
relaying with direct link if there are more relays in the network
willing to help. In this way, additional dual-hop branches can be
constructed to get a higher cooperative diversity, as depicted in Figure
3.4 . The maximum achievable spatial diversity of multi-branch relay
networks with direct link is @xmath , where @xmath is the number of
relays. In Chapter 5 , a multi-branch relay network with direct link
will be studied.

### 3.2 Relaying Protocols

The received signals from Source are processed by the relays before
forwarding to the destination. Depending on the type of processing, the
relay networks are classified as decode-and-forward or
amplify-and-forward.

##### Decode-and-Forward Relaying

In decode-and-forward relaying (DF), the relays decode the received
signal from the source, re-encode it and then re-broadcast the result to
the destination. The process of decoding and re-encoding at the relays
introduces additional computational burden to the relays. Moreover, the
decoding process cannot be free of error and leads to a error
propagation problem.

##### Amplify-and-Forward Relaying

In amplify-and-forward (AF) relaying, the decoding process is avoided
and the received signal is simply multiplied by a multiplication factor
before being re-transmitted to the destination. The main drawback in AF
relaying is that the noise at the relay is also amplified together with
the signal. It should be also mentioned that the term “amplify” does not
necessarily mean that the signal amplitude will be enhanced by the
amplification factor, but it could be either ways. This thesis, only
focuses on amplify-and-forward relaying in the considered systems.

### 3.3 Relay Channel Model

By employing AF relaying, a cascaded channel is constructed between a
source and a destination. This cascaded channel has different properties
than a direct channel. Assume that symbol @xmath is transmitted from
Source to Relay (Figure 3.1 ). The received signal at Relay is

  -- -------- -- -------
     @xmath      (3.1)
  -- -------- -- -------

where @xmath is the average transmitted power per symbol at Source. The
received signal at Relay is multiplied by amplification factor @xmath
and re-transmitted to Destination. The received signal at Destination is

  -- -------- -- -------
     @xmath      (3.2)
  -- -------- -- -------

Substituting ( 3.1 ) into ( 3.2 ), gives

  -- -------- -- -------
     @xmath      (3.3)
  -- -------- -- -------

where @xmath and @xmath are the equivalent channel and noise,
respectively. As can be seen, from Destination’s point of view, the
transmitted symbol @xmath is distorted by @xmath , the product of two
channels. This channel would be interchangeably called the cascaded, the
equivalent or double Rayleigh channel.

With Rayleigh faded assumption for individual channels, i.e., @xmath
@xmath the real and imaginary parts of @xmath are identically
distributed Laplacian random variables with pdfs [ 44 ]

  -- -------- -- -------
     @xmath      (3.4)
     @xmath      (3.5)
  -- -------- -- -------

Also, the pdf of the envelope @xmath is

  -- -------- -- -------
     @xmath      (3.6)
  -- -------- -- -------

where @xmath is the zero-order modified Bessel function of the second
kind [ 44 ] , [ 45 ] . In addition, the time-series model of the
cascaded channel is important for performance study of relay networks in
time-varying channels. To derive this model, depending on the mobility
of the nodes with respect to each other, three cases are considered as
follows. For simplicity, let set @xmath in all three cases.

##### Mobile Source, Fixed Relay and Destination

When Source is moving but Relay and Destination are fixed, the SR
channel becomes time-varying and their statistical properties follow the
fixed-to-mobile 2-D isotropic scattering channels [ 34 ] . However, the
RD channel remains static. The @xmath channel can be described by an
AR(1) model as

  -- -------- -- -------
     @xmath      (3.7)
  -- -------- -- -------

where @xmath is the auto-correlation of the @xmath channel, @xmath is
the normalized Doppler frequency of the SR channel and @xmath is
independent of @xmath . Also, under the scenario of fixed relays and
destination, two consecutive @xmath channel uses are approximately
equal, i.e.,

  -- -------- -- -------
     @xmath      (3.8)
  -- -------- -- -------

Thus, for the cascaded channel, multiplying ( 3.7 ) by ( 3.8 ) gives

  -- -------- -- -------
     @xmath      (3.9)
  -- -------- -- -------

which is an AR(1) model with the parameter @xmath and @xmath as the
input white noise.

##### Mobile Source and Destination, Fixed Relay

When both Source and Destination are moving, but Relay is fixed, the SR
and RD channels become time-varying and again follow the fixed-to-mobile
scattering model [ 34 ] . Therefore, the AR(1) model in ( 3.7 ) is used
for modelling the SR channel.

Similarly, for @xmath channel, the AR(1) model is

  -- -------- -- --------
     @xmath      (3.10)
  -- -------- -- --------

where @xmath is the auto-correlation of the @xmath channel, @xmath is
the normalized Doppler frequency of the RD channel and @xmath is
independent of @xmath .

Then, for the cascaded channel, multiplying ( 3.7 ) by ( 3.10 ) gives

  -- -------- -- --------
     @xmath      (3.11)
  -- -------- -- --------

where @xmath is the equivalent auto-correlation of the cascaded channel
and

  -- -------- -- --------
     @xmath      (3.12)
  -- -------- -- --------

represents the time-varying part of the equivalent channel, which is a
combination of three uncorrelated complex-double Gaussian distributions
[ 45 ] and uncorrelated to @xmath . Since @xmath has a zero mean, its
auto-correlation function is computed as

  -- -------- -- --------
     @xmath      (3.13)
  -- -------- -- --------

Therefore, @xmath is a white noise process with variance @xmath .

However, using @xmath in the way defined in ( 3.12 ) is not feasible for
the performance analysis. Thus, to make the analysis feasible, @xmath
shall be approximated with an adjusted version of one of its terms as

  -- -------- -- --------
     @xmath      (3.14)
  -- -------- -- --------

The above approximation of @xmath is also a white noise process with
first and second order statistical properties identical to that of
@xmath and uncorrelated to @xmath .

By substituting ( 3.14 ) into ( 3.11 ), the time-series model of the
equivalent channel can be described as

  -- -------- -- --------
     @xmath      (3.15)
  -- -------- -- --------

The above approximation of @xmath is again an AR(1) with parameter
@xmath and @xmath as the input white noise.

Comparing the AR(1) models in ( 3.9 ) and ( 3.15 ) shows that, in
essence, they are only different in the model parameter, i.e., @xmath
and @xmath ,: the parameter contains the effect of the @xmath channel in
the former model, while the effects of both the @xmath and @xmath
channels are included in the later model. This means that the model in (
3.15 ) can be used as the time-series model of the cascaded channel for
the analysis in both cases. Specifically, for static @xmath channels
@xmath and hence ( 3.15 ) turns to ( 3.9 ).

To validate the model in ( 3.15 ), its statistical properties are
verified with the theoretical counterparts. Theoretical mean and
variance of @xmath are shown to be equal to zero and one, respectively [
44 , 45 ] . This can be seen by taking expectation and variance
operations over ( 3.15 ) so that @xmath , @xmath . Also, the theoretical
auto-correlation of @xmath is obtained as the product of the
auto-correlation of the @xmath and @xmath channels in [ 44 ] . By
multiplying both sides of ( 3.15 ) with @xmath and taking expectation,
one has

  -- -------- -- --------
     @xmath      (3.16)
  -- -------- -- --------

Since @xmath is uncorrelated to @xmath then @xmath and it can be seen
that

  -- -------- -- --------
     @xmath      (3.17)
  -- -------- -- --------

In addition, the theoretical pdf of the envelope @xmath is

  -- -------- -- --------
     @xmath      (3.18)
  -- -------- -- --------

where @xmath is the zero-order modified Bessel function of the second
kind [ 44 ] , [ 45 ] . To verify this, using Monte-Carlo simulation the
histograms of @xmath , @xmath and @xmath , for different values of
@xmath , are obtained for both models in ( 3.11 ) and ( 3.15 ). The
values of @xmath are computed from a wide range of the normalized
Doppler frequencies. These histograms along with the theoretical pdf of
@xmath are illustrated in Figure 3.5 . Although, theoretically, the
distributions of @xmath and @xmath are not exactly the same, it is seen
that for practical values of @xmath they are very close. Moreover, the
resultant distributions of @xmath , regardless of @xmath or @xmath , are
similar and close to the theoretical distribution. The Rayleigh pdf is
depicted in the figure only to show the difference between the
distributions of an individual and the cascaded channels.

##### All Nodes are Mobile

In this case, all links follow the mobile-to-mobile channel model [ 46 ]
. However, they are all individually Rayleigh faded and the only
difference is that the auto-correlation of the channel should be
replaced according to this model. Thus, the channel model ( 3.15 ) again
can be used as the time-series model of the cascaded channel in this
case, albeit with appropriate auto-correlation value. The reader is
referred to the discussion in [ 44 ] and [ 46 ] for more details on
computing these auto-correlations as well as the tutorial survey on
various fading models for mobile-to-mobile cooperative communication
systems in [ 47 ] . For the analysis in this thesis, it is assumed that
the equivalent maximum Doppler frequency of each link, regardless of
fixed-to-mobile or mobile-to-mobile, is given and then the
auto-correlation of each link is computed based on Jakes’ model [ 34 ] .

### 3.4 Cooperative Strategies

The transmission process in cooperative networks is usually divided into
two phases. In the first phase, relays are silent and listening to the
transmitted signal from the source. In the second phase, the relays
cooperate to deliver the received signals to the destination. There are
two main cooperative strategies: Repetition-based and distributed
space-time coding based.

#### 3.4.1 Repetition-Based Cooperation

Repetition-based strategy is actually a combination of receiver
diversity and transmit diversity using the repetition code as described
in Chapter 2 . All relays receive different copies of the same signal
from Source in Phase I, which is similar to receiver diversity in
point-to-point communications (Chapter 2 ). In Phase II, the relays
amplify and re-broadcast the received symbols to Destination
sequentially in time (TDD manner) as depicted in Figure 3.6 . This is
similar to transmit diversity using repetition coding. Repetition-based
strategy is simple to implement. It does not require a complicated
encoding and decoding at Source or Destination. Moreover, during the
transmission of each relay, other relays remain silent and hence the
relays do not have to be synchronized in the symbol level. However, the
repetition-based strategy has a low spectral efficiency.

In the repetition-based strategy, the received signals from multiple
links at Destination need to be combined using a combining technique to
achieve the cooperative diversity. The maximum-ratio-combining scheme is
considered in Chapter 5 , while the selection combining method will be
used in Chapters 6 - 7 .

#### 3.4.2 Distributed Space-Time Coding-Based

The repetition-based strategy, suffers from a low data rate inherent in
TDD transmission. A logical solution would be to deploy space-time
coding in a distributed way using the help of relays. In distributed
space-time coding (DSTC), different relays receive different copies of
the same information symbols in Phase I. The relays process these
received signals and simultaneously forward them to the destination in
Phase II. The transmission process in DSTC-based strategy is depicted in
Figure 3.7 . The distributed processing at different relay nodes forms a
virtual antenna array (VAA). Therefore, conventional space-time block
coding schemes can be applied to relay networks to achieve the
cooperative diversity and coding gain [ 6 , 21 ] .

### 3.5 Summary

This chapter presented the main relay topologies such as single-branch
and multi-branch dual-hop relaying with and without direct link. Also,
relay protocols and cooperative strategies were described. More
importantly, a time-series model was developed for the cascaded channel.
The background in this chapter will be necessary for better
understanding of the systems and networks considered in the subsequent
chapters. In the next chapter, a dual-hop relay network employing
differential encoding and decoding will be studied first.

## Chapter 4 Performance of Differential Amplify-and-Forward Dual-Hop
Relaying

In wireless communications, service coverage limit happens due to power
limitation of wireless applications and attenuations of transmitted
signals in long distance. In this case, the received signal power at the
destination is weak and hence the direct link between the source and the
destination cannot be practically used. As described in the previous
chapter, an important relay topology to overcome coverage limit is
dual-hop relaying. In dual-hop relaying, depicted in Figure 3.1 , a
neighbour user in the coverage area of the wireless network acts as a
relay to bridge the communications from a far user to its destination.

The manuscript in this chapter studies a single-branch dual-hop relaying
system without direct link that employs differential encoding and
decoding (see Figure 3.1 ). To circumvent channel estimation,
differential @xmath -PSK is utilized at Source to encode the data
symbols. Amplify-and-forward relaying protocol is used at Relay. At the
destination, first, two-symbol differential detection is considered.
Different from the conventional slow-fading assumption, commonly made in
the literature, here, the users can be highly mobile and hence the
channels become fast time-varying. The first goal in this manuscript is
to examine the performance and robustness of two-symbol differential
detection in general time-varying Rayleigh fading channels. For this
purpose, a time-series model has been developed to characterize the
time-varying nature of the cascaded channel. An exact BER probability
expression of two-symbol differential detection is derived and shown to
approach an error floor at high SNR region in fast-fading environments.
This analysis is useful in optimizing the system parameters in order to
design more robust relaying systems.

Next, as a solution to overcome the error floor, a multiple-symbol
differential detection scheme is developed for the dual-hop relaying
system. The main disadvantage of multiple-symbol differential detection
is its complexity, which increases exponentially with the number of
processed symbols. In addition, the decision metric of multiple-symbol
differential detection is more complicated when applied to relay
networks due to the complicated distribution of the received signal at
the destination. Hence, it is important to obtain a decision metric that
can be computed with low complexity and without sacrificing much the
performance. Moreover, to approach the optimal performance promised by
multiple-symbol detection, it is important to determine the system
parameters accurately based on the channel information. These objectives
are accomplished in the rest of the manuscript, in which the
multiple-symbol differential sphere decoding in point-to-point
communications [ 40 ] is adapted for dual-hop relay networks.
Furthermore, theoretical error performance of the multiple-symbol
detection (MSD) scheme is also obtained. This analysis is useful to
investigate a trade-off between the MSD window size and the desired
performance. Simulation results in various fading and channel scenarios
are provided to verify the analysis of two-symbol and multiple-symbol
differential detection algorithms and also performance improvements
gained by multiple-symbol detection.

The results of our study on dual-hop relaying systems are reported in
manuscripts [Ch4-1] and [Ch4-2], listed below. Manuscript [Ch4-1]
considers the general case of dual-hop relaying and is included in this
chapter.

[Ch4-1] M. R. Avendi, Ha H. Nguyen,“ Differential Dual-Hop Relaying
under User Mobility”, submitted to IET Communications .

[Ch4-2] M. R. Avendi, Ha H. Nguyen,“ Differential Dual-Hop Relaying over
Time-Varying Rayleigh-Fading Channels”, IEEE 13th Canadian Workshop on
Information Theory, Toronto, Canada, June 2013. .

Differential Dual-Hop Relaying under User Mobility

M. R. Avendi, Ha H. Nguyen

Abstract

This paper studies dual-hop amplify-and-forward relaying system
employing differential encoding and decoding over time-varying Rayleigh
fading channels. First, the convectional “two-symbol” differential
detection (CDD) is theoretically analysed in terms of the bit-error-rate
(BER). It is seen that the performance of two-symbol differential
detection severely degrades in fast-fading channels and reaches an
irreducible error floor at high transmit power. Next, to overcome the
error floor experienced with fast-fading, a nearly optimal
“multiple-symbol” detection (MSD) is designed and theoretically
analysed. The analysis of CDD and MSD are verified and illustrated with
simulation results under different fading scenarios.

Index terms

Dual-hop relaying, amplify-and-forward, differential M-PSK, non-coherent
detection, time-varying fading channels, multiple-symbol detection.

### 4.1 Introduction

Dual-hop relaying without a direct link has been considered in the
literature as a technique to leverage coverage problems of many wireless
applications such as 3GPP LTE, WiMAX, WLAN, Vehicle-to-Vehicle
communication and wireless sensor networks [ 10 , 7 , 9 , 6 , 8 ] . Such
a technique can be seen as a type of cooperative communication in which
one node in the network helps another node to communicate with (for
example) the base station when the direct link is very poor or the user
is out of the coverage area.

A two-phases transmission process is usually utilized in such a network.
Here, Source transmits data to Relay in the first phase, while in the
second phase Relay performs amplify-and-forward (AF) strategy to send
the received data to Destination [ 12 ] . Error performance of dual-hop
relaying without direct link employing AF strategy has been studied in [
48 , 49 , 50 ] . Also, the statistical properties of the cascaded
channel between Source and Destination in a dual-hop AF relaying have
been examined in [ 44 ] .

In the existing literature, either coherent detection or slow-fading
environment is assumed. In coherent detection, instantaneous channel
state information (CSI) of both Source-Relay and Relay-Destination links
are required at Destination. This requirement, and specifically
Source-Relay channel estimation, would be challenging to meet for some
applications. Also, when Source and/or Relay are mobile, the constructed
channels become time-varying. On one hand, the channel variation makes
coherent detection inefficient or sometimes impossible due to the
requirement of fast channel estimation or tracking. On the other hand,
by employing differential modulation and two-symbol non-coherent
detection, this variation can be somewhat tolerated as long as the
channel does not change significantly over two consecutive symbols. For
the case of conventional differential detection (CDD) using two symbols,
it is well known that over slow-fading channels, around 3 dB loss is
seen between coherent and non-coherent detections. However, in practical
time-varying channels, the effect of channel variation can lead to a
much larger degradation.

Motivated from the above discussion, the first goal in this article is
to analyse the performance of single-branch dual-hop relaying employing
differential @xmath -PSK and two-symbol non-coherent detection in
time-varying Rayleigh fading channels. We refer to this system as
differential dual-hop (D-DH) relaying. In [ 51 ] , we studied a
multi-branch differential AF relaying with direct link in time-varying
channels, however only a lower bound of the bit-error rate (BER) was
derived for the multi-branch system. Although, the dual-hop relaying
considered in this article is a special case of multi-branch relaying,
the analysis here is different than that of [ 51 ] . Specifically, for
the case of two-symbol non-coherent detection, an exact bit error rate
(BER) expression is obtained. It is also shown that the system
performance quickly degrades in fast-fading channels and reaches an
error floor at high transmit power. The theoretical value of the error
floor is also derived and used to investigate the fading rate threshold.
Interestingly, it is seen that the error floor only depends on the
auto-correlation value of the cascaded channel and modulation
parameters.

The second goal in this article is to design a multiple-symbol detection
(MSD) for the D-DH relaying to improve its performance in fast-fading
channels. Multiple-symbol detection has been considered for
point-to-point communications in [ 52 , 32 , 40 , 39 , 43 , 53 ] . The
challenge in developing multiple-symbol detection for AF relay networks
is that, due to the complexity of the distribution of the received
signal at Destination, the optimum decision metric does not yield a
closed form solution. To circumvent this problem, here, the optimum
decision rule is replaced with an alternative decision rule and further
simplified to be solved with low complexity. Furthermore, theoretical
error performance of MSD is obtained. This analysis is useful to
investigate a trade-off between the MSD window size and the desired
performance. The error analysis of both CDD and MSD are thoroughly
verified with simulation results in various fading scenarios.

The outline of the paper is as follows. Section 4.2 describes the system
model. In Section 4.3 , two-symbol differential detection and its
performance over time-varying channels are studied. Section 4.4 develops
the MSD algorithm and analyses its performance. Simulation results are
given in Section 4.5 . Section 4.6 concludes the paper.

Notation : Bold upper-case and lower-case letters denote matrices and
vectors, respectively. @xmath , @xmath , @xmath denote transpose,
complex conjugate and Hermitian transpose of a complex vector or matrix,
respectively. @xmath denotes the absolute value of a complex number and
@xmath denotes the Euclidean norm of a vector. @xmath stands for complex
Gaussian distribution with zero mean and variance @xmath . @xmath
denotes expectation operation. Both @xmath and @xmath show the
exponential function. @xmath is the diagonal matrix with components of
@xmath on the main diagonal and @xmath is the @xmath identity matrix. A
symmetric @xmath Toeplitz matrix is defined by @xmath . @xmath denotes
determinant of a matrix. @xmath is the set of complex vectors with
length @xmath . @xmath and @xmath denote the real and imaginary parts of
a complex number.

### 4.2 System Model

The wireless relay model under consideration, depicted in Figure 4.1 ,
has one Source, one Relay and one Destination. Source is out of the cell
coverage and hence the received signal in the direct link is not
sufficiently strong to facilitate data transmission. Therefore, with the
help of another user (Relay), a dual-hop relaying system without direct
link is constructed to connect Source to Destination. Each node has a
single antenna, and the communication between nodes is half duplex
(i.e., each node is able to only send or receive in any given time). The
channels from Source to Relay (SR) and from Relay to Destination (RD)
are denoted by @xmath and @xmath , respectively, where @xmath is the
symbol time. A Rayleigh flat-fading model is assumed for each channel,
i.e., @xmath and @xmath . The channels are spatially uncorrelated and
changing continuously in time. The time-correlation between two channel
coefficients, @xmath symbols apart, follows the Jakes’ model [ 34 ] :

  -- -------- -- -------
     @xmath      (4.1)
  -- -------- -- -------

where @xmath is the zeroth-order Bessel function of the first kind and
@xmath is the maximum normalized Doppler frequency of the @xmath th
channel.

At time @xmath , a group of @xmath information bits is mapped to a
@xmath -PSK symbol as @xmath where @xmath . Before transmission, the
symbols are encoded differentially as

  -- -------- -- -------
     @xmath      (4.2)
  -- -------- -- -------

The transmission process is divided into two phases. Block-by-block
transmission protocol is utilized to transmit a frame of symbols in each
phase as symbol-by-symbol transmission causes frequent switching between
reception and transmission, which is not practical. However, the
analysis is the same for both cases and only the channel
auto-correlation value is different ( @xmath for block-by-block and
@xmath for symbol-by-symbol).

In phase I, the symbol @xmath is transmitted by Source to Relay, where
@xmath is the average source power per symbol. The received signal at
Relay is

  -- -------- -- -------
     @xmath      (4.3)
  -- -------- -- -------

where @xmath is the noise component at Relay. Also, the average received
SNR per symbol at Relay is defined as

  -- -------- -- -------
     @xmath      (4.4)
  -- -------- -- -------

The received signal at Relay is then multiplied by an amplification
factor @xmath , and re-transmitted to Destination. The amplification
factor, based on the variance of SR channel, is commonly used in the
literature as

  -- -------- -- -------
     @xmath      (4.5)
  -- -------- -- -------

to normalize the average power per symbol at Relay to @xmath .
Typically, the total power @xmath is allocated between Source and Relay
such that the average BER of the system is minimized. The corresponding
received signal at Destination is

  -- -------- -- -------
     @xmath      (4.6)
  -- -------- -- -------

where @xmath is the noise component at Destination. Substituting ( 4.3 )
into ( 4.6 ) yields

  -- -------- -- -------
     @xmath      (4.7)
  -- -------- -- -------

where @xmath is the cascaded channel with zero mean and variance @xmath
[ 44 ] , and

  -- -------- -- -------
     @xmath      (4.8)
  -- -------- -- -------

is the equivalent noise at Destination. It should be noted that for a
given @xmath , @xmath is a complex Gaussian random variable with zero
mean and variance

  -- -------- -- -------
     @xmath      (4.9)
  -- -------- -- -------

Thus @xmath , conditioned on @xmath and @xmath , is a complex Gaussian
random variable as well.

In the following section, the conventional two-symbol differential
detection (CDD) of the received signals at Destination and its
performance are considered.

### 4.3 Two-Symbol Differential Detection

#### 4.3.1 Detection Process

Given two consecutive received symbols at a time, non-coherent detection
of the transmitted symbol is obtained by the following minimization:

  -- -------- -- --------
     @xmath      (4.10)
  -- -------- -- --------

As can be seen, no channel information is needed for detection.
Two-symbol detection is simple to implement and it is mainly based on
the assumption that the channel coefficients are approximately constant
during two adjacent symbols. Although this assumption would be true for
slow-fading channels, it would be violated when users are fast moving.
In the next section, the performance of two-symbol non-coherent
detection in time-varying Rayleigh fading channel is analysed.

#### 4.3.2 Performance Analysis

Using the unified approach in [ 54 , eq.25] , it follows that the
conditional BER for two-symbol differential detection can be written as

  -- -------- -- --------
     @xmath      (4.11)
  -- -------- -- --------

where @xmath , @xmath , and @xmath . The values of @xmath and @xmath
depend on the modulation size [ 54 ] . Also, @xmath is the instantaneous
effective SNR at the output of the differential detector which needs to
be determined for time-varying channels.

To proceed with the performance analysis of two-symbol differential
detection in time-varying channels, it is required to model the
time-varying nature of the channels. For this purpose, individual
Rayleigh-faded channels, i.e., Source-Relay and Relay-Destination
channels, are expressed by a first-order auto-regressive (AR(1)) model
as

  -- -------- -- --------
     @xmath      (4.12)
  -- -------- -- --------

where @xmath is the auto-correlation of the @xmath th channel and @xmath
is independent of @xmath . Based on these expressions, a first-order
time-series model has been derived in [ 51 ] to characterise the
evolution of the cascaded channel in time. The time-series model of the
cascaded channel is given as (the reader is referred to [ 51 ] for the
detailed derivations/verification)

  -- -------- -- --------
     @xmath      (4.13)
  -- -------- -- --------

where @xmath is the equivalent auto-correlation of the cascaded channel,
which is equal to the product of the auto-correlations of individual
channels, and @xmath is independent of @xmath .

By substituting ( 4.13 ) into ( 4.7 ) one has

  -- -------- -- --------
     @xmath      (4.14)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (4.15)
  -- -------- -- --------

From expression ( 4.14 ), with given @xmath and @xmath , the
non-coherent detection process can be interpreted as coherent detection
of data symbol @xmath distorted by a fading channel equivalent to @xmath
and in the presence of the equivalent noise @xmath . Hence, for
time-varying channels, based on ( 4.14 ) and ( 4.15 ), @xmath is
computed as

  -- -------- -- --------
     @xmath      (4.16)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (4.17)
  -- -------- -- --------

In the above, the time index @xmath is omitted to simplify the notation.
Clearly, for slow-fading channels ( @xmath ), the equivalent noise power
is only enhanced by a factor of two and @xmath is half of the received
SNR in coherent detection @xmath [ 48 , 44 ] , as expected. However, for
fast-fading channels, @xmath , the noise power is dominated by the last
term in ( 4.15 ) and then significantly increases with increasing
transmit power. This leads to a larger degradation in the effective SNR
and poor performance of two-symbol non-coherent detection in fast-fading
channels.

Since, @xmath is exponentially distributed, i.e., @xmath , the variable
@xmath , conditioned on @xmath , follows an exponential distribution
with the following pdf and cdf:

  -- -------- -- --------
     @xmath      (4.18)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (4.19)
  -- -------- -- --------

By substituting @xmath into ( 4.11 ) and taking the average over the
distribution of @xmath , one has

  -- -------- -- --------
     @xmath      (4.20)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (4.21)
  -- -------- -- --------

with @xmath , @xmath and @xmath , @xmath defined as

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Now, by taking the final average over the distribution of @xmath ,
@xmath , it follows that

  -- -------- -- --------
     @xmath      (4.22)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (4.23)
  -- -------- -- --------

and @xmath is the exponential integral function. The definite integral
in ( 4.22 ) can be easily computed using numerical methods and it gives
an exact value of the BER of the D-DH system under consideration in
time-varying Rayleigh fading channels.

It is also informative to examine the expression of @xmath at high
transmit power. In this case,

  -- -------- -- --------
     @xmath      (4.24)
  -- -------- -- --------

which is independent of @xmath and @xmath . Therefore, by substituting
the converged value into ( 4.20 ), the error floor appears as

  -- -------- -- --------
     @xmath      (4.25)
  -- -------- -- --------

It is seen that the error floor is determined based on the amount of the
equivalent channel auto-correlation and also the parameters of the
signal constellation. Thus, one way to control this error floor would be
to keep the normalized Doppler frequency as low as possible by reducing
the symbol duration of the system. Moreover, the BER expression can be
used to optimize the power allocation between Source and Relay in the
network. This is explained further in Appendix 4.A .

### 4.4 Multiple-Symbol Detection

As discussed in the previous section, two-symbol non-coherent detection
suffers from a high error floor in fast-fading channels. To overcome
such a limitation, this section designs and analyses a multiple-symbol
detection scheme that takes a window of the received symbols at
Destination for detecting the transmitted signals.

#### 4.4.1 Detection Process

Let the @xmath received symbols be collected in vector @xmath , which
can be written as

  -- -------- -- --------
     @xmath      (4.26)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (4.27)
     @xmath      (4.28)
     @xmath      (4.29)
     @xmath      (4.30)
  -- -------- -- --------

Therefore, conditioned on both @xmath and @xmath , @xmath is a
circularly symmetric complex Gaussian vector with the following pdf:

  -- -------- -- --------
     @xmath      (4.31)
  -- -------- -- --------

In ( 4.31 ), the matrix @xmath is the conditional covariance matrix of
@xmath , defined as

  -- -------- -- --------
     @xmath      (4.32)
  -- -------- -- --------

with

  -- -------- -- --------
     @xmath      (4.33)
     @xmath      (4.34)
  -- -------- -- --------

as the covariance matrices of @xmath and @xmath , respectively.

Based on ( 4.31 ), the maximum likelihood (ML) detection would be given
as

  -- -- -- --------
           (4.35)
  -- -- -- --------

where @xmath . As it can be seen, the ML metric needs the expectation
over the distribution of @xmath , which does not yield a closed-form
expression. As an alternative, it is proposed to use the following
modified decision metric:

  -- -- -- --------
           (4.36)
  -- -- -- --------

where

  -- -------- -- --------
     @xmath      (4.37)
  -- -------- -- --------

with

  -- -------- -- --------
     @xmath      (4.38)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (4.39)
  -- -------- -- --------

Although the simplified decision metric is not optimal in the ML sense,
it will be shown by simulation results that nearly identical performance
to that obtained with the optimal metric can be achieved.

Using the rule @xmath , the determinant in ( 4.36 ) is no longer
dependent to @xmath and the modified decision metric can be further
simplified as

  -- -- -- --------
           (4.40)
  -- -- -- --------

Next using the Cholesky decomposition of @xmath gives

  -- -- -- --------
           (4.41)
  -- -- -- --------

where @xmath .

The minimization in ( 4.41 ) can then be solved using sphere decoding
described in [ 40 ] to find @xmath information symbols. The MSD
algorithm adapted for D-DH relaying is summarized in Algorithm I . The
complexity of the detection process is similar to that of point-to-point
(P2P) communications, considered in [ 40 , 55 ] . Although, here, the
second-order statistics of two channels are required, in contrast to one
channel in P2P communications. It should be mentioned that steps 1 to 3
are performed once, whereas steps 4 to 6 will be repeated for every
@xmath consecutive received symbols. Also, the processed windows overlap
by one symbol, i.e., the observation window of length @xmath moves
forward by @xmath symbols at a time. Since, one symbol is taken as the
reference, the output of the detection process contains @xmath detected
symbols.

In the next section, the error analysis of the developed multiple-symbol
detection is presented.

#### 4.4.2 Performance Analysis

Assume that vector @xmath is transmitted and it is decoded as vector
@xmath . Based on the decision rule ( 4.40 ), an error occurs if

  -- -- -- --------
           (4.42)
  -- -- -- --------

which can be simplified as

  -- -------- -- --------
     @xmath      (4.43)
  -- -------- -- --------

with

  -- -------- -- --------
     @xmath      (4.44)
  -- -------- -- --------

Therefore, the PEP is defined as

  -- -------- -- --------
     @xmath      (4.45)
  -- -------- -- --------

The above probability can be solved using the method of [ 56 ] as

  -- -------- -- --------
     @xmath      (4.46)
  -- -------- -- --------

where @xmath is the characteristic function of the random variable
@xmath and @xmath . Also, the constant @xmath can be set equal to one
half the smallest real part of the poles of @xmath and @xmath gives
enough accuracy for the approximation [ 56 ] .

To proceed with computing ( 4.45 ), the characteristic function of
random variable @xmath should be determined. Based on the modified
decision rule ( 4.36 ), conditioned on @xmath , @xmath is circularly
symmetric complex Gaussian vector with zero mean and covariance matrix
@xmath . Thus the characteristic function of the quadratic form @xmath
can be shown to be [ 57 ]

  -- -------- -- --------
     @xmath      (4.47)
  -- -------- -- --------

By substituting ( 4.47 ) into ( 4.45 ), the PEP of multiple-symbol
detection is obtained. The BER can be obtained by the union bound of the
PEP over the set of dominant errors as [ 52 ]

  -- -------- -- --------
     @xmath      (4.48)
  -- -------- -- --------

where @xmath is the sum of Hamming distances between the bit streams
corresponding to the dominant errors. In the dominant errors, the
detected vector @xmath is different than the transmitted vector @xmath
by only one closest symbol. For @xmath -PSK, without loss of generality
one can set

  -- -------- -- --------
     @xmath      (4.49)
     @xmath      (4.50)
  -- -------- -- --------

to find @xmath . Also, with Gray-mapping [ 52 ]

  -- -------- -- --------
     @xmath      (4.51)
  -- -------- -- --------

### 4.5 Simulation Results

In this section the dual-hop relay network under consideration is
simulated for various channel qualities using both CDD and MSD to verify
the analysis.

Information bits are differentially encoded with either BPSK ( @xmath )
or QPSK ( @xmath ) constellations. Note that, @xmath and @xmath are
obtained for DBPSK and DQPSK, respectively [ 54 ] . The amplification
factor at Relay is fixed to @xmath to normalize the average relay power
to @xmath . Also, @xmath is assumed.

Based on the fading powers of the channels, three scenarios would be
considered as: symmetric channels with @xmath , non-symmetric channels
with strong SR channel @xmath and non-symmetric channels with strong RD
channel @xmath . The fading powers are listed in Table 4.1 .

First, the BER expression of CDD is used to optimize the power
allocation between Source and Relay in the network. The optimization
problem aims to minimize the BER for a given total power @xmath . Let
@xmath , where @xmath is the power allocation factor. Then @xmath and
from ( 4.5 ), @xmath . By substituting @xmath and @xmath into ( 4.22 ),
the optimization problem is to find the value of @xmath for which @xmath
is minimized. Since the best performance is obtained in slow-fading
channels, @xmath would be set in ( 4.22 ). Then, the minimization would
be performed by a numerical exhaustive search. The obtained optimum
power allocations are listed in Table 4.1 for @xmath dB. Note that
@xmath is the total power in the network and is divided between Source
and Relay. It will be seen that, to achieve a low BER around @xmath or
@xmath , such a high value would be needed. In addition, the BER curves
obtained from the exhaustive search are plotted versus @xmath in Figure
4.3 for @xmath dB and when DQPSK is employed. Similar results would be
obtained when DBPSK is employed. The results in Table 4.1 and Figure 4.3
show that for symmetric and strong SR channels, more power should be
allocated to Relay than Source and the BER is minimized at @xmath and
@xmath , for symmetric and strong SR channels, respectively. When the RD
channel becomes stronger than the SR channel, the system would benefit
more from an equal power allocation and the BER is minimized at @xmath .

In all simulations, the channel coefficients, @xmath and @xmath , are
generated based on the simulation method of [ 37 ] . This simulation
method was developed to generate channel coefficients that are
correlated in time. The amount of time-correlation is determined by the
normalized Doppler frequency of the underlying channel, which is a
function of the speed of the vehicle, carrier frequency and symbol
duration. For fixed carrier frequency and symbol duration, a higher
vehicle speed leads to a larger Doppler frequency and less
time-correlation.

To get a better understanding about the fading rate values and also
verifying the analysis, the error floor values of CDD are obtained from
both expression ( 4.25 ) and simulation at a high transmit power for a
wide range of fading rates and plotted in Figure 4.2 . In the figure,
the lower graph corresponds to the case that only @xmath changes and
@xmath . In the upper graph both @xmath and @xmath change. Clearly, the
error floors from both analysis and simulation tight together. For small
values of fading rate around 0.001, the error floor is very low, around
@xmath , but increases toward @xmath with increasing the fading rate to
@xmath . The fading rate around @xmath can be regarded as the margin
beyond which the channels become fast-fading. As also seen, the error
floor values are higher when both Doppler values change.

Based on the previous observation and the normalized Doppler frequencies
of the two channels, different cases can be considered. In Case I, it is
assumed that all nodes are fixed or slowly moving so that both channels
are slow-fading with the normalized Doppler values of @xmath and @xmath
. In Case II, it is assumed that Source is moving so that the SR channel
is fast-fading with @xmath . On the other hand, Relay and Destination
are fixed and the RD channel is slow-fading with @xmath . In Case III,
it is assumed that both Source and Relay are moving so that both the SR
and RD channels are fast-fading with @xmath and @xmath , respectively.
The normalized Doppler values are shown in Table 4.2 .

Based on the obtained optimum power allocation values in Table 4.1 , the
simulated BER values using the CDD are computed for all cases and
different channel variances and are plotted versus @xmath in Figs. 4.4 -
4.7 , for DBPSK and DQPSK modulations. Also, the simulated BER values
using coherent detection are computed for Case I (slow-fading) and
plotted in Figs. 4.4 - 4.7 . Figures 4.4 and 4.5 correspond to symmetric
channels and strong RD channel, respectively, while Figures 4.6 and 4.7
correspond to symmetric channels and strong SR channel, respectively. On
the other hand, the corresponding theoretical BER values (for all cases)
and the error floors (cases II&III) for the CDD are computed from ( 4.22
) and ( 4.25 ) (with the corresponding variances) and plotted in Figs.
4.4 - 4.7 .

As can be seen in Fig. 4.4 , in Case I with symmetric channels, the BER
is monotonically decreasing with @xmath and it is consistent with the
theoretical values in ( 4.22 ). Approximately, 3 dB performance loss is
seen between coherent and non-coherent detection in this case. The error
floor in this case does not practically exist. In Case II, which
involves one fast-fading channel, this phenomenon starts earlier, around
@xmath dB, and leads to an error floor at @xmath , which can also be
predicted from ( 4.25 ). The performance degradation is much more severe
after @xmath dB in Case III since both channels are fast-fading, which
leads to an error floor at @xmath . Similar behaviours can be seen in
Figs. 4.5 - 4.7 under other channel variances or DQPSK modulation. As is
clearly seen from Figs. 4.4 - 4.7 , the simulation results verify our
theoretical evaluations. Specifically, the error floors in Case II and
Case III do not depend on the channel variances.

Given the poor performance of the two-symbol detection in Cases II and
III, MSD-DH algorithm is applied which takes a window of @xmath symbols
for detection. The BER results of the MSD-DH algorithm are also plotted
in Figures 4.4 - 4.7 with points (different legends). Also, theoretical
BER of MSD in Cases II and III are obtained from ( 4.48 ) and plotted in
the figures with dash-dot lines. Since the best performance is achieved
in the slow-fading environment, the performance plot of Case I can be
used as a benchmark to see the effectiveness of MSD-DH. It can be seen
that the MSD-DH is able to bring the performance of the system in Case
II and Case III very close to that of Case I. Moreover, the analytical
results of MSD are consistent with the simulation results and they match
well in high SNR region.

It is pointed out that the performance of MSDD is improved with
increasing @xmath . However, there would be a point beyond which the
performance improvement is not significant. Here, the BER expression of
MSDD can be used to determine the required block length for a desired
BER at a certain fade rate. To see the effect of increasing the block
length on the performance of MSDD at a specific fade rate and power, the
BER expression derived in ( 4.48 ) is evaluated for a range of @xmath at
@xmath dB and for various fade rates. The results are plotted in Figure.
4.8 . As it is seen from the figure, much of the performance improvement
is achieved by increasing the block length from two to four, for all the
fade rates. After this point, the BER is slowly decreasing with
increasing @xmath , and the improvement might not be significant. This
observation suggests to keep @xmath small to reduce the complexity,
albeit with some performance penalty.

### 4.6 Conclusion

Differential AF relaying for a dual-hop transmission has been studied
for time-varying Rayleigh fading channels. The analysis showed that,
while simple, two-symbol differential detection (CDD) suffers from an
error floor in fast-fading channels. This analysis would be useful to
predict the error floor phenomenon and control its value with changing
other system parameters such as the symbol duration. On the other hand,
it was seen that multiple-symbol detection (MSD) can overcome the
limitations of CDD in fast-fading channels, although the improvement is
obtained at the price of higher complexity.

## Appendix 4.A Optimum Power Allocation

The optimization problem aims to minimize the BER for a given total
power @xmath . Let @xmath , where @xmath is the power allocation factor.
Then @xmath and from ( 4.5 ), @xmath . By substituting @xmath and @xmath
into ( 4.22 ), the optimization problem is to find the value of @xmath
for which @xmath is minimized. Since the best performance is obtained in
slow-fading channels, @xmath would be set in ( 4.22 ). Then, the
minimization would be performed either by a numerical exhaustive search
or an analytical approach. For the analytical approach, it is easy to
see that the minimization does not depend on @xmath . Thus minimizing
@xmath is equivalent to minimizing @xmath , for any value of @xmath say
@xmath . Therefore, the optimized power allocation is obtained by
minimizing

  -- -------- -- --------
     @xmath      (4.52)
  -- -------- -- --------

where @xmath , @xmath and @xmath . It can be seen that for large @xmath
or @xmath , @xmath and then @xmath . On the other hand, for small @xmath
one has the following approximation [ 58 , eq.5.1.20]

  -- -------- --
     @xmath   
  -- -------- --

Thus, @xmath can be approximated as

  -- -------- -- --------
     @xmath      (4.53)
  -- -------- -- --------

Then, finding the minimum of ( 4.53 ) over the single variable @xmath
can be easily done by solving the derivative of ( 4.53 ) with respect to
@xmath

## Chapter 5 Differential Amplify-and-Forward Relaying Using Semi-MRC
Combining

The previous chapter considers single-branch dual-hop relaying for
scenarios that the direct link between the source and the destination is
not sufficiently strong to facilitate data transmission. However,
single-branch dual-hop relaying only extends the coverage area and does
not improve the diversity order of a wireless system. If the direct link
between the source and the destination is also available, a
single-branch dual-hop relaying with a direct link, see Figure 3.3 , can
be considered. This topology is useful to improve the diversity order to
two, yet simple to implement. There is only one relay involved in the
communication and no synchronization with the source or other users is
required. Also, less computational burden is imposed to the destination
in the combining and detection process. Moreover, studying this topology
provides a background for studying multi-branch relay networks.

Under the scenario that more users are willing to cooperate, a
multi-branch relay network with a direct link, depicted in Figure 3.4 ,
can be constructed. Thus the achievable diversity would increase to
@xmath , where @xmath is the number of relays. When more than one relay
are employed in the network, it is important to decide on the
cooperative strategy among the relays. Here, repetition-based strategy
is chosen due to its simplicity of implementation. In the
re-broadcasting phase, the relays send their data sequentially in time
and only frame synchronization is needed in the network. Obviously, more
signal processing would be needed at the destination for combining and
detection, which is the price of getting a better diversity with using
multiple relays.

In the multi-branch dual-hop relaying with a direct link considered in
this chapter, differential @xmath -PSK is used at the source,
amplify-and-forward is performed at the relays and two-symbol
non-coherent detection at the destination is employed. No channel
estimation is required at the relays or destination. An important
processing part at the destination of a D-AF relaying system is how to
combine the received signals to achieve the cooperative diversity. Here,
a semi maximum-ratio-combining (semi-MRC) scheme is considered. The
prefix semi is added to the MRC acronym because the conventional optimum
combining weights are not available in the system under consideration.
The research focus is to examine the performance and limitations of the
D-AF relaying system using semi-MRC scheme in practical time-varying
channels. Moreover, new combining weights are obtained to improve the
performance. It will be seen that, similar to the system considered in
the previous chapter, the performance of the system degrades with
channel variation and the existence of an error floor is inevitable.
However, the effect of channel variation can be mitigated by increasing
the number of relays in the network.

The results of our study are reported in manuscripts [Ch5-1] and
[Ch5-2]. Manuscript [Ch5-1] considers a three-node relay network (one
relay). Manuscript [Ch5-2] studies a general case with @xmath relays and
is presented in this chapter.

[Ch5-1] M. R. Avendi, Ha H. Nguyen,“Differential Amplify-and-Forward
Relaying in Time-Varying Rayleigh Fading Channels”, IEEE Wireless
Communications and Networking Conference, Shanghai, China, Apr. 7-10,
2013.

[Ch5-2] M. R. Avendi, Ha H. Nguyen,“Performance of Differential
Amplify-and-Forward Relaying in Multi-Node Wireless Communications”,
IEEE Transactions on Vehicular Technology , vol. 62, no. 8, pp.
3603–3613, Oct. 2013.

Performance of Differential Amplify-and-Forward Relaying in Multi-Node
Wireless Communications

M. R. Avendi, Ha H. Nguyen

^(†) ^(†) Manuscript received November 1, 2012; revised February 21,
2013; accepted March 20, 2013. Date of publication May 10, 2013. This
work was supported in part by the Dean’s Scholarship from the University
of Saskatchewan and a Natural Sciences and Engineering Research Council
of Canada Discovery Grant. The authors are with the Department of
Electrical and Computer Engineering, University of Saskatchewan,
Saskatoon, Canada, S7N5A9. Email: m.avendi@usask.ca, ha.nguyen@usask.ca.

Abstract

This paper is concerned with the performance of differential
amplify-and-forward (D-AF) relaying for multi-node wireless
communications over time-varying Rayleigh fading channels. A first-order
auto-regressive model is utilized to characterize the time-varying
nature of the channels. Based on the second-order statistical properties
of the wireless channels, a new set of combining weights is proposed for
signal detection at the destination. Expression of pair-wise error
probability (PEP) is provided and used to obtain the approximated total
average bit error probability (BER). It is shown that the performance of
the system is related to the auto-correlation of the direct and cascaded
channels and an irreducible error floor exists at high signal-to-noise
ratio (SNR). The new weights lead to a better performance when compared
to the conventional combining scheme. Computer simulation is carried out
in different scenarios to support the analysis.

Index terms

Differential amplify-and-forward relaying, non-coherent detection,
time-varying channels, performance analysis, channel auto-correlation,
auto-regressive models.

### 5.1 Introduction

The increasing demand for better quality and higher data rate in
wireless communication systems motivated the use of multiple
transmit/receive antennas, resulting in the so-called multiple-input
multiple-output (MIMO) systems. However, using multiple antennas is not
practical for mobile units due to insufficient space to make wireless
channels corresponding to multiple antennas uncorrelated. This
limitation was however addressed by the technique of cooperative
communications [ 59 , 4 ] , which has been shown to be applicable in
many wireless systems and applications such as 3GPP LTE-Advances, WiMAX,
WLANs, vehicle-to-vehicle communications and wireless sensor networks [
10 , 7 , 9 , 6 , 8 ] .

Cooperative communication exploits the fact that, since other users in a
network can also listen to a source during the source’s transmission
phase, they would be able to re-broadcast the received data to the
destination in another phase to help the source. Therefore, the overall
diversity and performance of the system would benefit from the virtual
MIMO system that is constructed using the help of other users. Depending
on the strategy that relays utilize to cooperate, the relay networks
have been classified as decode-and-forward or amplify-and-forward [ 12 ]
.

Among these strategies, amplify-and-forward (AF) has been the focus of
many studies because of its simplicity in the relay’s function.
Specifically, the relay’s function is to multiply the received signal
with a fixed or variable gain and forward the result to the receiver.
For convenience, the overall channel of source-relay-destination is
called the cascaded, the equivalent or double-Rayleigh channel.
Depending on the type of modulation, the relays may need full or partial
channel state information (CSI) for determining the amplification
factor. Also, the destination would need the CSI of both the direct and
the cascaded channels in order to combine the received signals for
coherent detection.

To avoid channel estimation at the relays and destination, differential
AF (D-AF) scheme has been considered in [ 14 , 17 , 15 , 16 ] which only
needs the second-order statistics of the channels at the relays. In the
absence of instantaneous CSI, a set of fixed weights, based on the
second-order statistics, has been used to combine the received signals
over the relay-destination and the source-destination links. Then, the
standard differential detection is applied to recover the transmitted
symbol. However, all the previous works assume a slow-fading situation
and show that the performance of D-AF is abound 3-4 dB worse than the
performance of its coherent version. For future reference, we call such
a scheme “conventional differential detection” (CDD). In practice, the
increasing speed of mobile users leads to fast time-varying channels
(also referred to as time-selective channels). Thus, the typical
assumption made in the development of conventional differential
detection, namely the approximate equality of two consecutive channel
uses, is violated. Therefore, it is important to consider performance of
D-AF relaying systems and its robustness under more practical and
general channel variation scenarios. It should also be mentioned that
the effect of time-varying channels on the performance of coherent AF
relay networks has been investigated in [ 60 , 61 ] .

In this paper, the performance of D-AF for a multi-relay network in fast
time-varying Rayleigh fading channels is studied. We call the detection
scheme developed for such fast time-varying channels “time-varying
differential detection” (TVD). The channels from the source to the
relays (SR channels), the source to the destination (SD channel) and
from the relays to the destination (RD channels) are changing
continuously according to the Jakes’ model [ 34 ] . Depending on the
mobility of nodes with respect to each other, different cases are
considered. The direct channel is modelled with a first-order
auto-regressive model, AR(1) [ 36 , 35 ] . Also, based on the AR(1)
model of the individual Rayleigh-faded channels, a time-series model is
proposed to characterize the time-varying nature of the cascaded
channels. The statistical properties of this model are verified using
theory and monte-carlo simulation. Taking into account the statistical
properties of channel variations, new weights for combining the received
signals over multiple channels are proposed. Since analyzing the
performance of the proposed system using fixed combining weights is too
complicated (if not impossible), the performance of the system using the
optimum maximum ratio combining (MRC) weights is analyzed and the result
is used as a lower bound for the system error performance. Specifically,
the pair-wise error probability (PEP) is obtained and used to
approximate the average bit error rate (BER) using nearest neighbour
approximation. It is shown that an error floor exits at high
signal-to-noise ratio (SNR) region. Such an error floor can be
approximately determined and it is related to the auto-correlation
values of both the direct and the cascaded channels. Simulation results
are presented to support the analysis in various scenarios of fading
channels and show that the TVD with the proposed weights always
outperforms the CDD in time-selective channels.

The outline of the paper is as follows. Section 5.2 describes the system
model. In Section III the channel model and the differential detection
of D-AF relaying with MRC technique over fast time-varying channels is
developed. The performance of the system is considered in Section 5.4 .
Simulation results are given in Section 5.5 . Section 5.6 concludes the
paper.

Notations: @xmath , @xmath and @xmath denote conjugate, absolute value
and the real part of a complex number, respectively. @xmath and @xmath
stand for complex Gaussian distribution with mean zero and variance
@xmath and chi-squared distribution with two degrees of freedom,
respectively. @xmath , @xmath denote expectation and variance
operations, respectively. Both @xmath and @xmath show the exponential
function.

### 5.2 System Model

The wireless relay model under consideration is shown in Figure 5.1 . It
has one source, @xmath relays and one destination. The source
communicates with the destination directly and also via the relays. Each
node has a single antenna, and the communication between nodes is half
duplex, i.e., each node can either send or receive in any given time.
The channels from the source to the destination (SD), from the source to
the @xmath th relay ( @xmath ) and from the @xmath th relay, @xmath , to
the destination ( @xmath D) are shown with @xmath , @xmath and @xmath ,
respectively, where @xmath is the symbol time. A Rayleigh flat-fading
model is assumed for each channel. The channels are spatially
uncorrelated and changing continuously in time. The auto-correlation
value between two channel coefficients, which are @xmath symbols apart,
follows the Jakes’ fading model [ 34 ] :

  -- -------- -- -------
     @xmath      (5.1)
  -- -------- -- -------

where @xmath is the zeroth-order Bessel function of the first kind,
@xmath is the maximum normalized Doppler frequency of the channel and
@xmath is either @xmath , @xmath or @xmath . The maximum Doppler
frequency of the SD, @xmath and @xmath D channels are shown with @xmath
, @xmath and @xmath , respectively. Also, it is assumed that the carrier
frequency is the same for all links.

Let @xmath denote the set of @xmath -PSK symbols. At time @xmath , a
group of @xmath information bits is transformed to @xmath . Before
transmission, the symbols are encoded differentially as

  -- -------- -- -------
     @xmath      (5.2)
  -- -------- -- -------

The transmission process is divided into two phases. Technically, either
symbol-by-symbol or block-by-block dual-phase transmission protocol can
be considered. In symbol-by-symbol protocol, first the source sends one
symbol to the relays and then the relays re-broadcast the amplified
versions of the corresponding received signals to the destination, in a
time division manner. Hence, two channel uses are @xmath symbols apart.
However, this protocol is not practical as it causes frequent switching
between reception and transmission. Instead, in block-by-block protocol,
a frame of information data is broadcasted in each phase and then two
channel uses are one symbol apart. Therefore, block-by-block
transmission is considered in this paper. However, the analysis is
basically the same for both cases as only the channel auto-correlation
values are different.

In phase I, the symbol @xmath is transmitted by the source to the relays
and the destination, where @xmath is the average source power. The
received signal at the destination and the @xmath th relay are

  -- -------- -- -------
     @xmath      (5.3)
  -- -------- -- -------

  -- -------- -- -------
     @xmath      (5.4)
  -- -------- -- -------

where @xmath are the noise components at the destination and the @xmath
th relay, respectively.

The received signal at the @xmath th relay is then multiplied by an
amplification factor @xmath , and forwarded to the destination. The
amplification factor can be either fixed or variable. A variable @xmath
needs the instantaneous CSI. For D-AF, in the absence of the
instantaneous CSI, the variance of the SR channels (here equals to one)
is utilized to define the fixed amplification factor as [ 14 , 17 , 15 ,
16 ] :

  -- -------- -- -------
     @xmath      (5.5)
  -- -------- -- -------

where @xmath is the average transmitted power of the @xmath th relay. ¹
¹ 1 Typically, the total power @xmath is divided among the source and
relays to minimize the average BER. This can be done by either
exhaustive search or analytical approaches. The study of power
allocation for multi-node differential amplify-and-forward relay
networks can be found in [ 14 , 17 , 15 , 16 ] .

The corresponding received signal at the destination is

  -- -- -- -------
           (5.6)
  -- -- -- -------

where @xmath is the noise component at the destination. Substituting (
5.4 ) into ( 5.6 ) yields

  -- -------- -- -------
     @xmath      (5.7)
  -- -------- -- -------

where the random variable @xmath represents the gain of the equivalent
double-Rayleigh channel, whose mean and variance equal zero and one,
respectively. Furthermore,

  -- -- --
        
  -- -- --

is the equivalent noise component. It should be noted that for a given
@xmath , @xmath and @xmath are complex Gaussian random variables with
mean zero and variances @xmath and @xmath , respectively, where @xmath
is the average received SNR conditioned on @xmath , defined as

  -- -------- -- -------
     @xmath      (5.8)
  -- -------- -- -------

In the following section, we consider the differential detection of the
combined received signals at the destination and evaluate its
performance.

### 5.3 Channel Models and Differential Detection

The CDD was developed under the assumption that two consecutive channel
uses are approximately equal. However, such an assumption is not valid
for fast time-varying channels. To find the performance of differential
detection in fast time-varying channels, we need to model both the
direct and the cascaded channels with time-series models. Depending on
the mobility of the nodes with respect to each other, three cases are
considered. The first case applies when a mobile user is communicating
with a base station both directly and via other fixed users (or fixed
relays) in the network. The second case can happen when the
communication between two mobile users are conducted directly and also
via other fixed relays. The last case is a situation that a mobile user
communicates with another mobile user in the network both directly and
with the help of other mobile users. The channel models in these three
cases are detailed as follows.

#### 5.3.1 Mobile Source, Fixed Relays and Destination

When the source is moving but the relays and the destination are fixed,
the SD and all SR channels become time-varying and their statistical
properties follow the fixed-to-mobile 2-D isotropic scattering channels
[ 34 ] . However, all RD channels remain static.

First, the direct link is modelled with an AR(1) model [ 36 , 35 ] as
follows

  -- -------- -- -------
     @xmath      (5.9)
  -- -------- -- -------

where @xmath is the auto-correlation of the SD channel and @xmath is
independent of @xmath . Note also that @xmath for block-by-block
transmission and @xmath for symbol-by-symbol transmission. The
auto-correlation value is equal one for static channels and decreases
with higher fade rates. Obviously, this value will be smaller for
symbol-by-symbol transmission than for block-by-block transmission,
which is another drawback of using symbol-by-symbol transmission in
addition to its practical implementation issue.

Similarly, the @xmath channel can be described as

  -- -------- -- --------
     @xmath      (5.10)
  -- -------- -- --------

where @xmath is the auto-correlations of the @xmath channel and @xmath
is independent of @xmath . Also, under the scenario of fixed relays and
destination, two consecutive @xmath channel uses are equal, i.e.,

  -- -------- -- --------
     @xmath      (5.11)
  -- -------- -- --------

Thus, for the @xmath th cascaded channel, multiplying ( 5.10 ) by ( 5.11
) gives

  -- -------- -- --------
     @xmath      (5.12)
  -- -------- -- --------

which is an AR(1) model with the parameter @xmath and @xmath as the
input white noise.

#### 5.3.2 Mobile Source and Destination, Fixed Relays

When both the source and the destination are moving, but the relays are
fixed, all the SR and RD channels become time-varying and again follow
the fixed-to-mobile scattering model [ 34 ] . Also, the SD channel
follows the mobile-to-mobile channel model [ 46 ] which is still
Rayleigh fading but with the auto-correlation value of the corresponding
model. Therefore, the AR(1) models in ( 5.9 ) and ( 5.10 ) are used for
modelling the SD and SR channels, respectively. However, for the SD
channel, the value of @xmath is obtained from the mobile-to-mobile
channel model [ 46 ] .

For @xmath channel, the AR(1) model is

  -- -------- -- --------
     @xmath      (5.13)
  -- -------- -- --------

where @xmath is the auto-correlation of @xmath channel and @xmath is
independent of @xmath .

Then, for the cascaded channel, multiplying ( 5.10 ) by ( 5.13 ) gives

  -- -------- -- --------
     @xmath      (5.14)
  -- -------- -- --------

where @xmath is the equivalent auto-correlation of the cascaded channel
and

  -- -------- -- --------
     @xmath      (5.15)
  -- -------- -- --------

represents the time-varying part of the equivalent channel, which is a
combination of three uncorrelated complex-double Gaussian distributions
[ 45 ] and uncorrelated to @xmath . Since @xmath has a zero mean, its
auto-correlation function is computed as

  -- -------- -- --------
     @xmath      (5.16)
  -- -------- -- --------

Therefore, @xmath is a white noise process with variance @xmath .

However, using @xmath in the way defined in ( 5.15 ) is not feasible for
the performance analysis. Thus, to make the analysis feasible, @xmath
shall be approximated with an adjusted version of one of its terms as

  -- -------- -- --------
     @xmath      (5.17)
  -- -------- -- --------

which is also a white noise process with first and second order
statistical properties identical to that of @xmath and uncorrelated to
@xmath .

By substituting ( 5.17 ) into ( 5.14 ), the time-series model of the
equivalent channel can be described as

  -- -------- -- --------
     @xmath      (5.18)
  -- -------- -- --------

which is again an AR(1) with parameter @xmath and @xmath as the input
white noise.

Comparing the AR(1) models in ( 5.12 ) and ( 5.18 ) shows that, in
essence, they are only different in the model parameters: the parameter
contains the effect of the @xmath channel in the former model, while the
effects of both the @xmath and @xmath channels are included in the later
model. This means that the model in ( 5.18 ) can be used as the
time-series model of the cascaded channel for the analysis in both
cases. Specifically, for static @xmath channels @xmath and hence ( 5.18
) turns to ( 5.12 ).

To validate the model in ( 5.18 ), its statistical properties are
verified with the theoretical counterparts. Theoretical mean and
variance of @xmath are shown to be equal to zero and one, respectively [
44 , 45 ] . This can be seen by taking expectation and variance
operations over ( 5.18 ) so that @xmath , @xmath . Also, the theoretical
auto-correlation of @xmath is obtained as the product of the
auto-correlation of the @xmath and @xmath channels in [ 44 ] . By
multiplying both sides of ( 5.18 ) with @xmath and taking expectation,
one has

  -- -------- -- --------
     @xmath      (5.19)
  -- -------- -- --------

Since @xmath is uncorrelated to @xmath then @xmath and it can be seen
that

  -- -------- -- --------
     @xmath      (5.20)
  -- -------- -- --------

In addition, the theoretical pdf of the envelope @xmath is

  -- -------- -- --------
     @xmath      (5.21)
  -- -------- -- --------

where @xmath is the zero-order modified Bessel function of the second
kind [ 44 ] , [ 45 ] . To verify this, using Monte-Carlo simulation the
histograms of @xmath , @xmath and @xmath , for different values of
@xmath , are obtained for both models in ( 5.14 ) and ( 5.18 ). The
values of @xmath are computed from the normalized Doppler frequencies
given in Table 5.1 , which as discussed in Section 4.5 covers a variety
of practical situations. These histograms along with the theoretical pdf
of @xmath are illustrated in Figure 5.2 . Although, theoretically, the
distributions of @xmath and @xmath are not exactly the same, we see that
for practical values of @xmath they are very close. Moreover, the
resultant distributions of @xmath , regardless of @xmath or @xmath , are
similar and close to the theoretical distribution. The Rayleigh pdf is
depicted in the figure only to show the difference between the
distributions of an individual and the cascaded channels.

#### 5.3.3 All Nodes are Mobile

In this case, all links follow the mobile-to-mobile channel model [ 46 ]
. However, they are all individually Rayleigh faded and the only
difference is that the auto-correlation of the channel should be
replaced according to this model. Thus, the channel model in ( 5.9 ) and
( 5.18 ) again can be used as the time-series model of the direct and
cascaded channels in this case, albeit with appropriate auto-correlation
values. We refer the reader to the discussion in [ 44 ] and [ 62 ] for
more details on computing these auto-correlations as well as the
tutorial survey on various fading models for mobile-to-mobile
cooperative communication systems in [ 47 ] . For our analysis, it is
assumed that the equivalent maximum Doppler frequency of each link,
regardless of fixed-to-mobile or mobile-to-mobile, is given and then the
auto-correlation of each link is computed based on ( 5.1 ).

#### 5.3.4 Combining Weights and Differential Detection

By substituting the time-series models in ( 5.9 ) and ( 5.18 ) for the
direct and the cascaded channels into ( 5.3 ) and ( 5.7 ), respectively,
one has

  -- -------- -- --------
     @xmath      (5.22)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (5.23)
  -- -------- -- --------

and

  -- -------- -- --------
     @xmath      (5.24)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (5.25)
  -- -------- -- --------

Note that, the equivalent noise @xmath and also @xmath for a given
@xmath , are combinations of complex Gaussian random variables, and
hence they are also complex Gaussian with variances

  -- -------- -- --------
     @xmath      (5.26)
     @xmath      (5.27)
  -- -------- -- --------

It can be seen that, compared with the CDD scheme, an additional term
appears in the noise expression of ( 5.23 ) and ( 5.25 ) and their
variances

To achieve the cooperative diversity, the received signals from the two
phases are combined as

  -- -------- -- --------
     @xmath      (5.28)
  -- -------- -- --------

where @xmath and @xmath are the combining weights. Using the MRC
technique [ 63 ] , the optimum combining weights, which takes into
account the noise variance of each link, would be

  -- -------- -- --------
     @xmath      (5.29)
  -- -------- -- --------

However, as can be see from ( 5.27 ), even for slow-fading channels with
@xmath , the noise variance depends on the channel coefficients @xmath ,
which is not known in the system under consideration. To overcome this
problem, for slow-fading channels, the average values of the noise
variances, @xmath and @xmath , were utilized to define the weights for
the CDD scheme as

  -- -------- -- --------
     @xmath      (5.30)
  -- -------- -- --------

It is also shown in [ 14 , 17 , 15 , 16 ] that these weights give a
performance close to the optimum combining in slow-fading channels.

For fast time-varying channels, the average variances of the equivalent
noise terms in the direct and the cascaded links are @xmath and @xmath ,
respectively. Therefore, the new combining weights for fast time-varying
channels are proposed as

  -- -------- -- --------
     @xmath      (5.31)
  -- -------- -- --------

It can be seen that for slow-fading, @xmath and @xmath , which gives
@xmath and @xmath as expected. However, for fast-fading channels, the
weights change with the channel auto-correlation and the source power.
In essence, the new weights provide a dynamic combining of the received
signals based on the fade rate of each link. The faster the channel
changes in a communication link, the smaller portion of the received
signal in that link is taken into account for detection. In terms of
complexity, the proposed combining weights need the auto-correlation
values of the channels which can be computed based on the Jakes’ model
once the corresponding Doppler frequencies are determined.

Finally, the well known minimum Euclidean distance (ED) detection is
expressed as [ 38 ]

  -- -------- -- --------
     @xmath      (5.32)
  -- -------- -- --------

In the next section, we analyse the error performance of this detector.

### 5.4 Error Performance Analysis

This section evaluates performance of the D-AF system over time-varying
fading channels. Although, the practical combining weights given in (
5.31 ) are used in the detection process, finding the performance of the
system with these weights appears infeasible. Instead, performance of
the TVD scheme based on the optimum combining weights is carried out and
used as a benchmark for the performance of the TVD approach with the
proposed weights. It is noted that such an approach in performance
analysis is also adopted for the CDD scheme as in [ 15 , 14 , 17 ] .

Without loss of generality, assume that symbol @xmath is transmitted and
it is decoded erroneously as @xmath , the nearest neighbour symbol, by
the decoder. The corresponding PEP is defined as @xmath An error occurs
when

  -- -------- -- --------
     @xmath      (5.33)
  -- -------- -- --------

which can be simplified to

  -- -------- -- --------
     @xmath      (5.34)
  -- -------- -- --------

By substituting @xmath from ( 5.28 ) into the above inequality and using
@xmath and @xmath , the error event can be further simplified as @xmath
where

  -- -------- -- --------
     @xmath      (5.35)
  -- -------- -- --------

and @xmath . Note that @xmath is Gaussian, while, conditioned on @xmath
, @xmath is also Gaussian. Thus, conditioned on @xmath , @xmath and
@xmath , the variable @xmath is Gaussian as well. Its mean, @xmath , and
variance, @xmath , conditioned on the above variables, are given as (see
proof in Appendix 5.A ):

  -- -------- -- --------
     @xmath      (5.36)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (5.37)
  -- -------- -- --------

Therefore, the conditional PEP can be written as

  -- -------- -- --------
     @xmath      (5.38)
  -- -------- -- --------

where @xmath and

  -- -------- -- --------
     @xmath      (5.39)
     @xmath      (5.40)
  -- -------- -- --------

with @xmath and @xmath defined as

  -- -------- -- --------
     @xmath      (5.41)
     @xmath      (5.42)
  -- -------- -- --------

Now, take the average over the distribution of @xmath and @xmath by
using the moment-generating function (MGF) technique [ 3 ] , the
conditional PEP can be written as

  -- -- -- --------
           (5.43)
  -- -- -- --------

where @xmath and @xmath are the MGFs of @xmath and @xmath ,
respectively. Since @xmath and @xmath , conditioned on @xmath , are
@xmath and @xmath , respectively, it follows that @xmath and @xmath ,
respectively. Hence, the MGFs of @xmath and @xmath can be shown to be [
64 ]

  -- -- -- --------
           (5.44)
  -- -- -- --------

Therefore, by substituting ( 5.44 ) into ( 5.43 ), one obtains

  -- -------- -- --------
     @xmath      (5.45)
  -- -------- -- --------

The above integral can be solved by partial fraction technique and then
averaged over the distributions of @xmath . However, this leads to a
complicated expression without much insight. Instead, we take the
average over the distributions of @xmath , @xmath , and the
unconditioned PEP is given as

  -- -------- -- --------
     @xmath      (5.46)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (5.47)
  -- -------- -- --------

with @xmath , @xmath and @xmath defined as

  -- -------- -- --------
     @xmath      (5.48)
  -- -------- -- --------

and @xmath is the exponential integral function. The integral in ( 5.46
), then can be computed numerically to find the PEP.

It can be verified that, for DBPSK, the expression in ( 5.46 ) gives the
exact bit-error rate (BER). On the other hand, for higher-order @xmath
-PSK constellations, the nearest-neighbour approximation [ 38 ] shall be
applied to obtain the overall symbol-error rate (SER) as @xmath and the
average BER for Gray-mapping as

  -- -------- -- --------
     @xmath      (5.49)
  -- -------- -- --------

Finding an upper bound for the PEP expression can help to get more
insights about the system performance. For @xmath , ( 5.46 ) is bounded
as

  -- -------- -- --------
     @xmath      (5.50)
  -- -------- -- --------

Based on the definition of @xmath and @xmath , in ( 5.41 ) and ( 5.47 ),
it can be seen that, the error probability depends on the fading rates,
@xmath and @xmath , of both the direct and the cascaded channels. If all
channels are very slow-fading, @xmath and @xmath for @xmath , and it can
be verified that @xmath and @xmath . Thus the diversity order of @xmath
is achieved. On the other hand, if the channels are fast time-varying,
the terms @xmath and @xmath in the denominator of @xmath and @xmath
become significant in high SNR. This decreases the effective values of
@xmath and @xmath and consequently the overall performance as well as
the achieved diversity order of the system will be affected.

It is also informative to examine the expression of PEP at high SNR
values. In this case,

  -- -------- -- --------
     @xmath      (5.51)
  -- -------- -- --------

and (see proof in Appendix 5.B )

  -- -------- -- --------
     @xmath      (5.52)
  -- -------- -- --------

which is independent of @xmath . Therefore, by substituting the above
converged values into ( 5.45 ) or ( 5.46 ), it can be seen that the
error floor appears as (see proof in Appendix 5.C ),

  -- -------- -- --------
     @xmath      (5.53)
  -- -------- -- --------

when @xmath

  -- -------- -- --------
     @xmath      (5.54)
  -- -------- -- --------

when @xmath

  -- -------- -- --------
     @xmath      (5.55)
  -- -------- -- --------

when @xmath

It should be noted that the PEP and the error floor expressions are
obtained based on the optimum combining weights and hence, as will be
observed in the simulation results, they give a lower bound for the PEP
and error floor of the system using the proposed weights. The superior
performance of the proposed TVD scheme over the CDD scheme as
illustrated in the next section comes with the price of requiring the
channel auto-correlations for determining the new combining weights. The
accurate determination of these auto-correlations is important since it
would affect both the actual system performance and the performance
analysis.

### 5.5 Simulation Results

In this section a typical multi-node D-AF relay network is simulated in
different channel scenarios and for the case that all nodes are mobile
(the general case). In all simulations, the channels @xmath , @xmath and
@xmath are generated individually according to the simulation method of
[ 37 ] . Based on the normalized Doppler frequencies of the channels,
three different scenarios are considered: (I) all the channels are
fairly slow fading, (II) the SD and SR channels are fairly fast, while
the RD channels are fairly slow, (III) the SD and SR channels are very
fast and the RD channels are fairly-fast fading. The normalized Doppler
frequencies of the three scenarios are shown in Table 5.1 . The values
in the table can be translated to different vehicle speeds of
communication nodes in typical wireless systems. For example, in a
system with carrier frequency @xmath GHz and symbol duration @xmath ms,
the corresponding Doppler shifts for the SD channel would be around
@xmath Hz, which would correspond to the speeds of @xmath km/hr,
respectively, where @xmath m/s is the speed of light. Usually, the value
of 75 km/hr is assumed for a typical vehicle speed in the literature but
much faster speeds are common in vehicles such as hi-speed trains. Thus,
Table 5.1 covers a wide range of practical situations, from very slow to
very fast fading, and these situations can be applicable in present and
future wireless applications. In fact, Scenario I is practically
equivalent to the case of static channels.

In each scenario, binary data is differentially encoded for DBPSK (
@xmath ) or DQPSK ( @xmath ) constellations. Block-by-block transmission
is conducted in all scenarios. The amplification factor at the relay is
fixed to @xmath to normalize the average relay power to @xmath . The
power allocation among the source and relays is such that @xmath and
@xmath , where @xmath is the total power consumed in the network. Note
that, due to the way the variance of all AWGN components and channel
gains is normalized to unity, the total power @xmath also has the
meaning of a signal-to-noise ratio (SNR). At the destination, the
received signals are first combined with the proposed weights so that
the minimum Euclidean-distance detection can then be carried out. The
simulation is run for various values of the total power in the network.
For comparison, the same simulation process but with the combining
weights given in ( 5.30 ) is repeated for the CDD system. The practical
BER values obtained with the CDD and TVD schemes are plotted versus
@xmath in Fig. 5.3 (solid lines but different markers) for DBPSK and a
two-relay network. Fig. 5.4 shows similar BER plots but for DQPSK and a
three-relay network.

On the other hand, for computing the theoretical BER values, first the
values of @xmath and @xmath are computed for each scenario. Also, @xmath
for @xmath -PSK symbols is computed to give @xmath for @xmath , and
@xmath for @xmath . Then, the corresponding theoretical BER values from
( 5.49 ) are plotted in the two figures with dashed lines.

As can be seen from Figs. 5.3 and 5.4 , in Scenario I of very
slow-fading (practically the scenario of static channels), the desired
cooperative diversity is achieved with both the CDD and TVD schemes. The
BER curves for both schemes monotonically decrease with increasing
@xmath and are consistent with the theoretical values. Since in this
scenario, all the channels are fairly slow, the combining weights are
approximately equal in both CDD and TVD systems and the BER results are
very tight to the theoretical values which are determined using the
optimum combining weights. Also, the error floor is very low and does
not practically exist in this slow-fading situation and it is not
plotted.

In Scenario II, which involves two fast-fading channels, the BER plots
gradually deviate from the BER results obtained in Scenario I, at around
15 dB, and reach an error floor for @xmath dB. The error floor is also
calculated theoretically from ( 5.55 ) and plotted in the figures with
dotted lines. The error floor is around @xmath for TVD scheme, while it
is around @xmath for the CDD scheme in both figures. The
significantly-lower error floor of the TVD scheme clearly shows its
performance improvement over the CDD scheme. The “deviating” phenomenon
starts earlier, around 10 dB in Scenario III, and the performance
degradation is much more severe since all the channels are fast fading
in this scenario. Although the existence of the error floor is
inevitable in both detection approaches, the TVD scheme with the
proposed weights always outperforms the CDD scheme and it performs
closer to the theoretical results using the optimum weights. As
expected, for both Scenarios II and III, the theoretical BER plots
corresponding to the optimum combining weights give lower bounds for the
actual performance. Another important observation is that the achieved
diversity is severely affected by the high fade rates of time-varying
fading channels, although the multiple fading channels are still
independent.

### 5.6 Conclusion

Performance of multi-node relay networks has been analyzed when
differential @xmath -PSK modulation along with the amplify-and-forward
strategy are used over fast time-varying channels. The time-varying
nature of the channels was related to their auto-correlation values.
Using the auto-correlation values, the new combining weights at the
destination were provided. The obtained error probability expression
serves as a lower bound of the actual BER. It was shown that the error
performance depends on the fading rates of the direct and the cascaded
channels. For fast fading channels, a large fading rate can lead to a
severe degradation in the error probability. It was also shown that
there exists an error floor at high SNR in time-varying channels and
such an error floor was determined in terms of the channel
auto-correlations. The analysis is supported with simulation in
different scenarios and depicts that the proposed combining gains lead
to a better performance over that achieved with the conventional
combining weights.

## Appendix 5.A Proof of (5.36) and (5.37)

  -- -------- -- --------
     @xmath      (5.56)
  -- -------- -- --------

The conditional means of Gaussian noise components @xmath and @xmath are
obtained as [ 65 ]

  -- -------- -- --------
     @xmath      (5.57)
     @xmath      (5.58)
  -- -------- -- --------

Substituting ( 5.57 ) and ( 5.58 ) into ( 5.56 ) gives ( 5.36 ).

  -- -------- -- --------
     @xmath      (5.59)
  -- -------- -- --------

The conditional variances of @xmath and @xmath are obtained as

  -- -------- -- --------
     @xmath      (5.60)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (5.61)
  -- -------- -- --------

Substituting ( 5.60 ) and ( 5.61 ) into ( 5.59 ) gives ( 5.37 ). It
should be noted that since @xmath is proportional to the real part of
@xmath and @xmath , its variance is proportional to half of the total
variance.

## Appendix 5.B Proof of (5.52)

By substituting ( 5.8 ) into ( 5.42 ) we have

  -- -- -- --------
           (5.62)
  -- -- -- --------

## Appendix 5.C Proof of (5.53)-(5.55)

  -- -------- -- --------
     @xmath      (5.63)
  -- -------- -- --------

Now, for the first case that @xmath , using the partial fraction
technique gives

  -- -- -- --------
           (5.64)
  -- -- -- --------

where @xmath . Then,

  -- -------- -- --------
     @xmath      (5.65)
  -- -------- -- --------

Now, for the second case that @xmath , again using the partial fraction
technique gives

  -- -------- -- --------
     @xmath      (5.66)
  -- -------- -- --------

Hence, using the integral techniques in [ 58 ] , one obtains

  -- -------- -- --------
     @xmath      (5.67)
  -- -------- -- --------

For the last case @xmath , one has

  -- -- -- --------
           (5.68)
  -- -- -- --------

where @xmath and @xmath . Then taking the integration from ( 5.68 )
gives the error floor expression in ( 5.55 ).

## Chapter 6 Selection Combining for Differential Amplify-and-Forward
Relaying: Slow-Fading Case

In the previous chapter, multi-branch relaying systems with a direct
link were considered as a mean to improve the overall diversity. Take
for instance the single-branch dual-hop relaying with direct channel
depicted in Figure 3.3 . After Source and Relay send their signals to
Destination, an important task at Destination is to combine the received
signals from Source and Relay to achieve cooperative diversity. A semi
Maximum-Ratio-Combining (semi-MRC) scheme was studied in the previous
chapter. The semi-MRC method requires the second-order statistics of the
transmission links to determine the combining weights. However, to avoid
this requirement, the use of selection combining is investigated in this
chapter. The goal is to examine the possibility of using selection
combining instead of semi-MRC scheme. It would be very useful to
simplify the detection process at the destination while not sacrificing
much of the performance.

The manuscript in this chapter considers a single-branch dual-hop
relaying system with a direct link employing selection combining at
Destination. The selection combining method computes the decision
variable for each link and then chooses the link with the maximum
magnitude for detection. The advantage of this method is that no
combining weights are necessary. The exact BER and outage probability of
this combiner using differential @xmath -PSK in symmetric slow-fading
channels are obtained and verified with simulation results.
Interestingly, the performance of both SC method and semi-MRC method are
very close to each other. It is pointed out that the study in this
chapter is limited to single-branch dual-hop relaying with a direct
link. Extension to multi-branch relaying systems is worthwhile but the
analysis appears to be very complicated.

The results of our study are reported in the following manuscript.

[Ch6-1] M. R. Avendi, Ha H. Nguyen,“Selection Combining for Differential
Amplify-and-Forward Relaying Over Rayleigh-Fading Channels”, IEEE Signal
Processing Letters , vol. 13, pp. 277-280, Mar. 2013.

Selection Combining for Differential Amplify-and-Forward Relaying Over
Rayleigh-Fading Channels

M. R. Avendi, Ha H. Nguyen

^(†) ^(†) Manuscript received November 12, 2012; revised January 10,
2013; accepted January 26, 2013. Date of publication February 01, 2013;
date of current version February 07, 2013. The associate editor
coordinating the review of this manuscript and approving it for
publication was Prof. Azadeh Vosoughi. The authors are with the
Department of Electrical and Computer Engineering, University of
Saskatchewan, Saskatoon, SK S7N 5A9 Canada (e-mail: m.avendi@usask.ca;
ha.nguyen@usask.ca).

Abstract

This paper proposes and analyses selection combining (SC) at the
destination for differential amplify-and-forward (D-AF) relaying over
slow Rayleigh-fading channels. The selection combiner chooses the link
with the maximum magnitude of the decision variable to be used for
non-coherent detection of the transmitted symbols. Therefore, in
contrast to the maximum ratio combining (MRC), no channel information is
needed at the destination. The exact average bit-error-rate (BER) of the
proposed SC is derived and verified with simulation results. It is also
shown that the performance of the SC method is very close to that of the
MRC method, albeit with lower complexity.

Index terms

Differential amplify-and-forward relaying, differential modulation,
selection combining.

### 6.1 Introduction

The idea of employing other wireless users as relays in a communication
network was proposed more than a decade ago [ 59 ] . Cooperative
communication exploits the fact that, since other users can also listen
to a source, they would be able to receive, process and re-broadcast the
received data to the destination. Depending on the strategy that relays
utilize for cooperation, the relay networks are generally classified as
decode-and-forward (DF) and amplify-and-forward (AF) [ 12 ] .

Among these two strategies, AF is very attractive in terms of having
less computational burden at the relays. Specifically, the relay’s
function is simply to multiply the received signal with a fixed or
variable amplification factor, depending on the availability of the
channels state information (CSI). In the case of having no CSI at the
relays, the second-order statistics of source-relay channels can be used
to determine a fixed amplification factor. Also, using differential
encoding, differential AF (D-AF) scheme has been considered in [ 14 , 15
, 16 ] to avoid channel estimation at the destination. In the absence of
CSI at the destination, a set of fixed weights, based on the
second-order statistics of all channels, have been used to combine the
received signals from the relay-destination and the source-destination
links [ 14 , 15 , 16 ] . For future reference, this combiner is called
semi-maximum ratio combining (semi-MRC). Since the exact performance
analysis of semi-MRC appears to be too complicated (if not impossible),
the performance of a system using instantaneous combining weights (i.e.,
the instantaneous MRC) is usually conducted for benchmarking the
performance of a semi-MRC system [ 14 , 15 , 16 ] . It was shown that
the performance of D-AF using semi-MRC is close to the performance of an
instantaneous MRC and about 3-4 dB worse than its coherent version [ 14
, 15 , 16 ] .

While obtaining the second-order statistics of all channels at the
destination for combining the received signals could be an issue, the
need for a simpler combiner, without sacrificing much of the
performance, that can also be analysed exactly, is the motivation of
this paper.

In particular, this paper studies D-AF relaying over slow
Rayleigh-fading channels using post-detection selection combining (SC)
which can be seen as a counterpart to MDPSK for point-to-point
communications with reception diversity [ 66 ] . At the destination, the
decision variable is computed for each link and the one with the maximum
magnitude is chosen for non-coherent detection. Hence, different from
the semi-MRC, the selection combiner does not need the second-order
statistic of any of the channels, which simplifies the destination’s
detection task. The probability density function (pdf) and commutative
density function (cdf) of the instantaneous signal to noise ratio (SNR)
in each link and the combiner’s output are derived and used to obtain
the exact average bit-error-rate (BER) and the outage probability of the
system. The analysis is verified with simulation. Comparison of SC and
semi-MRC systems shows that the performance of SC is very close to that
of the semi-MRC, of course with a lower complexity.

The outline of the paper is as follows. Section 6.2 describes the system
model. In Section III the non-coherent detection of D-AF relaying using
SC technique is developed. The performance of the system is considered
in Section 6.4 . Simulation results are given in Section 6.5 . Section
6.6 concludes the paper.

Notation : @xmath , @xmath denote conjugate and absolute values of a
complex number, respectively. @xmath stand for complex Gaussian
distribution with mean zero and variance @xmath .

### 6.2 System Model

The wireless relay model under consideration has one source, one relay
and one destination. The source communicates with the destination both
directly and via the relay. Each node has a single antenna, and the
communication between nodes is half duplex (i.e., each node is able to
only send or receive in any given time). The channel coefficients at
time @xmath , from the source to the destination (SD), from the source
to the relay (SR) and from the relay to the destination (RD) are shown
with @xmath , @xmath and @xmath , respectively. All channels are @xmath
(i.e., Rayleigh flat-fading) and follow Jakes’ correlation model [ 34 ]
. Also, the channels are spatially uncorrelated and are approximately
constant for two consecutive channel uses.

Let @xmath be the set of @xmath -PSK symbols. A group of @xmath
information bits at time @xmath are transformed to an @xmath -PSK symbol
@xmath . Before transmission, the symbols are encoded differentially as

  -- -------- -- -------
     @xmath      (6.1)
  -- -------- -- -------

The transmission process is divided into two phases. Block-by-block
transmission protocol is utilized to transmit a frame of symbols in each
phase as symbol-by-symbol transmission causes frequent switching between
reception and transmission, which is not practical.

In phase I, symbol @xmath is transmitted by the source to the relay and
the destination. Let @xmath be the average source power per symbol. The
received signal at the destination and the relay are

  -- -------- -- -------
     @xmath      (6.2)
  -- -------- -- -------

  -- -------- -- -------
     @xmath      (6.3)
  -- -------- -- -------

where @xmath are noise components at the destination and the relay,
respectively.

The received signal at the relay is then multiplied by an amplification
factor, and re-transmitted to the destination. The common amplification
factor, based on the variance of SR channel, is commonly used in the
literature as @xmath , where @xmath is the average power per symbol at
the relay. However, @xmath can be any arbitrarily fixed value. ¹ ¹ 1
Typically, the total power @xmath is divided between the source and rely
to minimize the average BER of the system. The corresponding received
signal at the destination is

  -- -------- -- -------
     @xmath      (6.4)
  -- -------- -- -------

where @xmath is the noise at the destination. Substituting ( 6.3 ) into
( 6.4 ) yields

  -- -------- -- -------
     @xmath      (6.5)
  -- -------- -- -------

where @xmath is the equivalent double-Rayleigh channel with zero mean
and variance one [ 44 ] and @xmath is the equivalent noise. It should be
noted that for a given @xmath , @xmath is complex Gaussian random
variable with zero mean and variance @xmath .

The following section presents the selection combining of the received
signals at the destination and its differential detection.

### 6.3 Selection Combining and Differential Detection

By substituting ( 6.1 ) into ( 6.2 ) and ( 6.5 ), and using the
slow-fading assumption, @xmath and @xmath , one has

  -- -------- -- -------
     @xmath      (6.6)
  -- -------- -- -------

  -- -------- -- -------
     @xmath      (6.7)
  -- -------- -- -------

  -- -------- -- -------
     @xmath      (6.8)
  -- -------- -- -------

  -- -------- -- -------
     @xmath      (6.9)
  -- -------- -- -------

Note that, the equivalent noise components @xmath and @xmath (for a
given @xmath ) are combinations of complex Gaussian random variables,
and hence they are also complex Gaussian with variances equal 2 and
@xmath , respectively.

To achieve the cooperative diversity, the received signals from the two
phases should be combined using some combining technique [ 63 ] . For
the semi-MRC, the variance of @xmath and the expected value of the
variance of @xmath were utilized to combine the signals as [ 14 , 15 ,
16 ]

  -- -------- -- --------
     @xmath      (6.10)
  -- -------- -- --------

However, instead of the semi-MRC which needs the second-order statistics
of all channels, we propose to combine the received signals using a
selection combiner as illustrated in Figure 6.1 . As it is seen, the
decision statistics for the direct link, @xmath , and the cascaded link,
@xmath , are computed and compared to choose the link with a higher
magnitude. The output of the combiner is therefore

  -- -------- -- --------
     @xmath      (6.11)
  -- -------- -- --------

Obviously, no channel information is needed at the destination.

Finally, the well known minimum Euclidean distance (ED) detection is
applied to detect the transmitted signal as [ 38 ]

  -- -------- -- --------
     @xmath      (6.12)
  -- -------- -- --------

where the minimization is taken over all symbols @xmath of the
constellation @xmath .

In the next section, the performance of the above selection combining
detector is analysed.

### 6.4 Error Performance Analysis

In order to evaluate the performance of the system, the distribution of
the instantaneous SNR at the output of the selection combiner is derived
and used in the unified approach [ 54 ] to obtain the BER. To simplify
the notation, the time index of the channels is omitted in this section.

The instantaneous received SNRs of two links are given as [ 14 , 15 , 16
]

  -- -------- -- --------
     @xmath      (6.13)
     @xmath      (6.14)
  -- -------- -- --------

where @xmath . Since, @xmath has an exponential distribution, @xmath is
also exponentially distributed with the following pdf and cdf: @xmath ,
@xmath

Since, the quantity @xmath conditioned on @xmath is a constant, the
conditional pdf and cdf of @xmath are given as @xmath , @xmath

The instantaneous SNR at the output of the combiner is defined as @xmath
Thus, its cdf, conditioned on @xmath , can be expressed as

  -- -------- -- --------
     @xmath      (6.15)
  -- -------- -- --------

By taking the derivative of ( 6.15 ), the conditional pdf of @xmath is

  -- -------- -- --------
     @xmath      (6.16)
  -- -------- -- --------

where @xmath conditioned on @xmath is a constant.

Using the unified approach [ 54 , eq.25] , it follows that the
conditional BER can be written as

  -- -------- -- --------
     @xmath      (6.17)
  -- -------- -- --------

where @xmath , @xmath , and @xmath . The values of @xmath and @xmath
depend on the modulation size [ 54 ] .

Next, the average over the distribution of @xmath is taken to give

  -- -------- -- --------
     @xmath      (6.18)
  -- -------- -- --------

By substituting ( 6.16 ) into ( 6.18 ), one obtains

  -- -------- -- --------
     @xmath      (6.19)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (6.20)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (6.21)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (6.22)
  -- -------- -- --------

Finally, substituting @xmath and @xmath and taking the average over the
distribution of @xmath , @xmath , the unconditioned BER is given as

  -- -------- -- --------
     @xmath      (6.23)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (6.24)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (6.25)
  -- -------- -- --------

with @xmath , @xmath and @xmath .

  -- -------- -- --------
     @xmath      (6.26)
  -- -------- -- --------

with @xmath , @xmath and @xmath . Also, @xmath is the exponential
integral function. The integral in ( 6.23 ) can be computed numerically
to find the exact BER.

To get more insights about the achieved diversity, approximating @xmath
and @xmath with @xmath and @xmath as

  -- -------- -- --------
     @xmath      (6.27)
  -- -------- -- --------

Using the above values in ( 6.23 ), it can be seen that

  -- -------- -- --------
     @xmath      (6.28)
  -- -------- -- --------

which shows that the diversity order of two can be achieved in high SNR
region.

Before closing this section, it is pointed out that the outage
probability can be straightforwardly obtained from ( 6.16 ).
Specifically, the probability that the instantaneous SNR at the output
of the SC combiner drops below a SNR threshold @xmath is

  -- -------- -- --------
     @xmath      (6.29)
  -- -------- -- --------

where @xmath is the first-order modified Bessel function of the second
kind.

### 6.5 Simulation Results

To verify the BER performance analysis, computer simulation was carried
out. ² ² 2 Due to space limitation, simulation results that verify the
outage probability analysis are not included. In the simulation, the
channels @xmath , @xmath and @xmath are generated individually according
to the simulation method of [ 37 ] . The normalized Doppler frequency of
all channels is set to @xmath , so that the channels are slow-fading.
Binary data is differentially encoded for @xmath constellations. At the
destination, the received signals are combined using the SC technique
and the decision variable is used to recover the transmitted signal
using the minimum Euclidean-distance detection. The simulation is run
for various values of the total power in the network, whereas the
amplification factor at the relay is fixed to @xmath to normalized the
average relay power to @xmath .

First, to find the optimum power allocation between the source and the
relay, the expression of BER is examined for different values of power
allocation factor @xmath , where @xmath is the total power in the
system. The BER curves are plotted versus @xmath in Figure 6.2 for
P=15, 20, 25 dB and when DBPSK and DQPSK are employed. Note that, for
computing the theoretical BER in ( 6.23 ), @xmath and @xmath are
obtained for DBPSK and DQPSK, respectively [ 54 ] . The figure shows
that more power should be allocated to the source than the relay and the
BER is minimized at @xmath . This observation is similar to what
reported in [ 14 ] for the semi-MRC technique. Based on Figure 6.2 the
power allocation factor @xmath is used in all the simulations.

Figure 6.3 plots the BER curves versus the total power @xmath that are
obtained with the SC technique (both theoretical and simulation results)
and the semi-MRC technique, and for both DBPSK (lower plots) and DQPSK
(upper plots). As can be seen, the simulation results of SC technique
are very close to the theoretical values. Moreover, the diversity order
of two is achieved for both SC and semi-MRC methods and their results
are also very close to each other. The small difference between the two
methods can be accepted in many practical applications which seek a
trade-off between simplicity and performance.

### 6.6 Conclusion

A selection combining of the received signals at the destination of a
D-AF relay network was studied. Thanks to the differential encoding and
selection combiner, no channel state information is needed at the
destination for detection of the transmitted symbols. The distribution
of the instantaneous SNR at the output of the combiner was derived and
the exact bit error rate and the outage probability of the system have
been obtained. It was shown that the desired diversity order of two can
be achieved by the SC system. Simulation results verified the analysis
and show that the selection combiner performs very close to the
more-complicated semi-MRC technique (which needs the second-order
statistics of all channels).

## Chapter 7 Selection Combining for Differential Amplify-and-Forward
Relaying: General Time-Varying Case

In the previous chapter, the use of selection combining (SC) at the
destination in a differential amplify-and-forward (D-AF) relaying system
was studied. It was shown that, while being simpler, the SC method is
able to deliver performance very close to that of the semi-
maximum-ratio-combining (semi-MRC) method studied in Chapter 5 .
However, the analysis in the previous chapter was limited to slow-fading
channels with symmetric fading powers.

The study in this chapter on selection combining is more comprehensive
and useful than that of Chapter 6 as the nodes in the networks can be in
different locations or with different mobility and therefore they would
experience different fading powers and fading rates. Here, only DBPSK
modulation is considered. Using DBPSK allows one to take only the real
part of the decision variable for the selection and detection process.
The exact average BER of the SC scheme is derived and thoroughly
verified with simulation results in various fading and channel
scenarios. Similar to the semi-MRC scheme considered in Chapter 5 , the
existence of an error floor in fast-fading channels is inevitable in the
SC method as well. It should also be mentioned that due to the
complexity of analysis, the study is limited to single-branch dual-hop
relaying with a direct link and DBPSK modulation.

The results of our study are reported in the following manuscript.

[Ch7-1] M. R. Avendi, Ha H. Nguyen,“Performance of Selection Combining
for Differential Amplify-and-Forward Relaying Over Time-Varying
Channels”, submitted to IEEE Transactions on Wireless Communications .

Performance of Selection Combining for Differential Amplify-and-Forward
Relaying Over Time-Varying Channels

M. R. Avendi, Ha H. Nguyen

Abstract

Selection combining (SC) at the destination for differential
amplify-and-forward (AF) relaying is attractive as it does not require
channel state information as compared to the maximum-ratio-combining
(MRC) while delivering close performance. Performance analysis of the SC
scheme was recently reported but only for the case of slow-fading
channels. This paper provides an exact average bit-error-rate (BER) of
the SC scheme over a general case of time-varying Rayleigh fading
channels and when the DBPSK modulation is used together with the
non-coherent detection at the destination. The presented analysis is
thoroughly verified with simulation results in various fading scenarios.
It is shown that the performance of the system is related to the
auto-correlation values of the channels. It is also shown that the
performance of the SC method is very close to that of the MRC method and
the existence of an error floor at high signal-to-noise ratio region is
inevitable in both methods. The obtained BER analysis for the SC method
can also be used to approximate the BER performance of the MRC method,
whose exact analytical evaluation in time-varying channels appears to be
difficult.

### 7.1 Introduction

Cooperative communications has now become a mature research topic.
Currently, a special type of cooperative communications (with the help
of one relay) has been standardized in the 3 GPP LTE technology to
leverage the coverage problem of cellular networks and it is envisaged
that LTE-advanced version will include cooperative relay features to
overcome other limitations such as capacity and interference [ 6 ] .
There are also applications for cooperative relay networks in wireless
LAN, vehicle-to-vehicle communications and wireless sensor networks that
have been discussed in [ 8 , 9 , 10 , 11 ] and references therein.

In cooperative communications, a user in the network act as a relay to
receive signals from a source, processes and re-broadcasts to a
destination. In this way, additional links, other than the direct link
from a source to a destination, can be constructed via relays and hence
the overall spatial diversity of the system would be increased.
Depending on the signal processing strategy that a relay utilizes, relay
networks are generally classified as decode-and-forward (DF) and
amplify-and-forward (AF) [ 12 ] .

Among these two strategies, AF or its non-coherent version, differential
AF (D-AF) is very attractive as it requires less computational burden at
the relays and destination. In D-AF, data symbols are differentially
encoded at the source. The relay’s function is simply to multiply the
received signal with a fixed amplification factor. At the destination,
the received signals from multi-links are combined to achieve the
diversity, and used for non-coherent detection of the transmitted
signals without the need of instantaneous channel state information
(CSI). In [ 14 , 15 , 16 ] , a maximum-ratio combiner using a set of
fixed weights, based on the second-order statistics of all channels, has
been used to combine the received signals from the relay-destination and
source-destination links. For future reference, this combiner is called
semi-maximum ratio combiner (semi-MRC).

With the motivation of reducing the detection complexity at the
destination, selection combining for differential AF relay networks was
recently investigated and analyzed in [ 67 ] . This combiner can be seen
as a counterpart of selection combining of DPSK in point-to-point
communications with receive diversity studied in [ 68 , 69 , 70 , 66 ] .
However, the analysis reported in our previous work [ 67 ] only apply
for symmetric slow-fading channels. The slow-fading assumption requires
approximate equality of two consecutive channel uses, which would be
violated in practice under high mobility of users.

This paper studies D-AF relaying over general time-varying
Rayleigh-fading channels using post-detection selection combining (SC).
The DBPSK modulation is used and the AF strategy with fixed gain at the
relay is employed. Two links are involved in the communication: the
direct link from the source to the destination (SD) and the cascaded
link from the source to the destination via the relay. The decision
variable is computed for each link and the one with the maximum
magnitude is chosen for non-coherent detection. Hence, different from
the semi-MRC, the selection combiner does not need the second-order
statistic of any of the channels, which simplifies the detection at the
destination. To characterize the time-varying nature of the channels,
first-order auto-regressive models [ 36 , 51 ] are employed for the
direct and cascaded channels. The probability density function (pdf) and
cumulative density function (cdf) of the decision variable in each link
are derived and used to obtain the exact average bit-error-rate (BER).
The analysis is verified with simulation results in different fading and
channel scenarios. Comparison of the SC and semi-MRC systems shows that
the performance of the SC method is very close to that of the semi-MRC.
For fast-fading channels, it is seen that the performance of both SC and
semi-MRC systems degrades and reaches an error floor. The expression of
the error floor is also derived for the SC method. On the other hand,
the close performance of both the SC and semi-MRC schemes implies that
one can use the exact BER analysis of the SC method to closely
approximate the performance of the semi-MRC method in time-varying
channels. This is useful since the exact BER of the semi-MRC method in
time-varying channels appears to be difficult [ 51 ] and only a loose
lower bound was derived for this system in [ 51 ] .

The outline of the paper is as follows. Section 7.2 describes the system
model. In Section 7.3 the non-coherent detection of D-AF relaying using
SC technique is developed. The performance of the system is considered
in Section 7.4 . Simulation results are given in Section 7.5 . Section
7.6 concludes the paper.

Notation : @xmath , @xmath denote conjugate and absolute values of a
complex number, respectively. @xmath stands for a complex Gaussian
distribution with mean zero and variance @xmath , while @xmath stands
for chi-squared distribution with two degrees of freedom. @xmath and
@xmath are expectation and variance operations, respectively. Both
@xmath and @xmath indicate exponential function and @xmath is the
exponential integral function.

### 7.2 System Model

The system model in this article is very similar to that of [ 71 , 67 ,
51 ] . As such, the formulation and description of the system model are
similar to those in [ 71 , 67 , 51 ] . Figure 7.1 depicts the wireless
relay model under consideration, which has three nodes: one Source, one
Relay and one Destination. There are a direct link and a cascaded link,
via Relay, from Source to Destination. The inherent diversity order of
the system is therefore two. A common half-duplex communication between
the nodes is assumed, i.e., each node employs a single antenna and able
to only send or receive in any given time.

The channel coefficients at time @xmath , from Source to Destination
(SD), from Source to Relay (SR) and from Relay to Destination (RD) are
shown with @xmath , @xmath and @xmath , respectively. A Rayleigh
flat-fading model is assumed for each channel, i.e., @xmath . The
channels are spatially uncorrelated and changing continuously in time.
The time correlation between two channel coefficients, @xmath symbols
apart, follows the Jakes’ model [ 34 ] :

  -- -------- -- -------
     @xmath      (7.1)
  -- -------- -- -------

where @xmath is the zeroth-order Bessel function of the first kind and
@xmath is the maximum normalized Doppler frequency of the @xmath th
channel. The normalized Doppler frequency is a function of the velocity
of the nodes. A higher velocity leads to a higher Doppler value and
hence a lower time-correlation between the channel coefficients.

Let @xmath be the set of @xmath -PSK symbols. A group of @xmath
information bits at time @xmath is transformed to an @xmath -PSK symbol
@xmath . Before transmission, the symbols are encoded differentially as

  -- -------- -- -------
     @xmath      (7.2)
  -- -------- -- -------

Here it is assumed that @xmath , i.e., DBPSK modulation is employed.

The transmission process is divided into two phases. A symbol or a frame
of symbols could be transmitted in each phase. Symbol-by-symbol
transmission is not practical as it causes frequent switching between
reception and transmission. Hence, frame-by-frame transmission protocol
is utilized here. However, the analysis is the same for both cases and
only the channels auto-correlation values are different. In
symbol-by-symbol transmission, two channel uses are two symbols apart
@xmath while in frame-by-frame transmission two channel uses are one
symbol apart @xmath .

In the first phase, symbol @xmath is transmitted by Source to Relay and
Destination. Let @xmath be the average Source’s power per symbol. The
received signals at Destination and Relay are

  -- -------- -- -------
     @xmath      (7.3)
  -- -------- -- -------

  -- -------- -- -------
     @xmath      (7.4)
  -- -------- -- -------

where @xmath are noise components at Destination and Relay,
respectively. It is easy to see that, for given @xmath , @xmath , where
@xmath is the average received SNR per symbol from the direct link,
defined as

  -- -------- -- -------
     @xmath      (7.5)
  -- -------- -- -------

Also, the average received SNR per symbol at Relay is defined as

  -- -------- -- -------
     @xmath      (7.6)
  -- -------- -- -------

The received signal at Relay is then multiplied by an amplification
factor, and re-transmitted to Destination. Based on the variance of SR
channel, the amplification factor commonly used in the literature is

  -- -------- -- -------
     @xmath      (7.7)
  -- -------- -- -------

where @xmath is the average transmitted power per symbol at Relay. In
general, @xmath can be any arbitrarily fixed value. If the total power
in the network, @xmath , is divided between Source and Relay such that
@xmath , where @xmath is the power amplification factor, then @xmath .

The corresponding received signal at Destination is

  -- -------- -- -------
     @xmath      (7.8)
  -- -------- -- -------

where @xmath is the noise component at Destination in the second phase.
Substituting ( 7.4 ) into ( 7.8 ) yields

  -- -------- -- -------
     @xmath      (7.9)
  -- -------- -- -------

where @xmath is the equivalent double-Rayleigh channel with zero mean
and variance @xmath [ 44 ] and @xmath is the equivalent noise component.
It should be noted that for a given @xmath , @xmath is a complex
Gaussian random variable with zero mean and variance

  -- -------- -- --------
     @xmath      (7.10)
  -- -------- -- --------

and hence @xmath , conditioned on @xmath and @xmath , is a complex
Gaussian random variable with zero mean and variance @xmath . Here,
@xmath is the average received SNR per symbol from the cascaded link at
Destination, conditioned on @xmath . It is given as

  -- -------- -- --------
     @xmath      (7.11)
  -- -------- -- --------

The next section presents the selection combining of the received
signals at Destination and its non-coherent detection.

### 7.3 Selection Combining and Non-Coherent Detection

Based on two consecutive received symbols, non-coherent detection of the
transmitted symbols can be obtained. For DBPSK, the decision variables
for the direct and cascaded links are computed from the two latest
symbols as

  -- -------- -- --------
     @xmath      (7.12)
     @xmath      (7.13)
  -- -------- -- --------

To achieve the cooperative diversity, the decision variables from the
two transmission phases should be combined using some combining
technique [ 63 ] . For the semi-MRC method, over slow-fading channels,
the decision variables were combined as [ 14 , 15 , 16 ]

  -- -------- -- --------
     @xmath      (7.14)
  -- -------- -- --------

However, instead of the semi-MRC which needs the second-order statistics
of all channels, it is proposed to combine the received signals using a
selection combiner as illustrated in Fig. 7.2 [ 67 ] . As it is seen,
the decision statistics for the direct link, @xmath , and the cascaded
link, @xmath , are computed and compared to choose the link with a
higher magnitude. The output of the combiner is therefore

  -- -------- -- --------
     @xmath      (7.15)
  -- -------- -- --------

Obviously, using this scheme, no channel information is needed at
Destination.

Finally, the output of the combiner is used to decode the transmitted
signal as

  -- -------- -- --------
     @xmath      (7.16)
  -- -------- -- --------

The next section analyzes the performance of the above selection
combining detector.

### 7.4 Error Performance Analysis

As usual, the transmitted symbols are assumed to be equally likely.
Without loss of generality, assume that symbol @xmath is transmitted and
let @xmath denote the decoded symbol. The BER can be expressed as

  -- -------- -- --------
     @xmath      (7.17)
  -- -------- -- --------

Since @xmath and @xmath have different distributions, the two terms in (
7.17 ) should be computed separately. The first term can be written as

  -- -------- -- --------
     @xmath      (7.18)
  -- -------- -- --------

Likewise, the second term of ( 7.17 ) can be expressed as

  -- -------- -- --------
     @xmath      (7.19)
  -- -------- -- --------

In ( 7.18 ) and ( 7.19 ), @xmath and @xmath are the pdfs of @xmath and
@xmath , respectively. Also, @xmath and @xmath are the cdfs of @xmath
and @xmath , respectively. They can be written as

  -- -------- -- --------
     @xmath      (7.20)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (7.21)
  -- -------- -- --------

where @xmath and @xmath are the cdfs of @xmath and @xmath ,
respectively.

To proceed with the computation of ( 7.18 ) and ( 7.19 ), the pdfs and
cdfs of @xmath and @xmath are required. To obtain these functions, the
relationship between two consecutive channel uses is required. The
conventional assumption is that two consecutive channel uses are
approximately equal, i.e., @xmath and @xmath . However, such an
assumption is not valid for fast-fading channels.

For time-varying channels, individual channels are expressed by an AR(1)
model as

  -- -------- -- --------
     @xmath      (7.22)
  -- -------- -- --------

where @xmath is the auto-correlation of the @xmath th channel and @xmath
is independent of @xmath . Based on these expressions, a first-order
time-series model was derived in [ 51 ] to characterize the evolution of
the cascaded channel in time. The time-series model of the cascaded
channel is given as (see [ 51 ] for the detailed derivation and
verification):

  -- -------- -- --------
     @xmath      (7.23)
  -- -------- -- --------

where @xmath is the equivalent auto-correlation of the cascaded channel,
which is equal to the product of the auto-correlations of individual
channels, and @xmath is independent of @xmath .

By substituting ( 7.2 ), ( 7.22 ) and ( 7.23 ) into ( 7.3 ) and ( 7.8 ),
one has

  -- -------- -- --------
     @xmath      (7.24)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (7.25)
  -- -------- -- --------

and

  -- -------- -- --------
     @xmath      (7.26)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (7.27)
  -- -------- -- --------

It should be pointed out that, compared with slow-fading channels (see [
67 , Eqs. (7) and 9] ), additional terms appear in the noise
expressions, which are functions of the channel auto-correlations and
transmit power.

Then by substituting ( 7.24 ) and ( 7.26 ) into ( 7.12 ) and ( 7.13 ),
one has

  -- -------- -- --------
     @xmath      (7.28)
     @xmath      (7.29)
  -- -------- -- --------

It is seen that, for given @xmath , @xmath is a combination of complex
Gaussian random variables, whose conditional mean and variance are
computed as

  -- -------- -- --------
     @xmath      (7.30)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (7.31)
  -- -------- -- --------

Furthermore, for given @xmath and @xmath , @xmath is a combination of
complex Gaussian random variables and hence it is Gaussian as well. Its
conditional mean and variance are computed as

  -- -------- -- --------
     @xmath      (7.32)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (7.33)
  -- -------- -- --------

In the remaining of the paper, the time index @xmath is omitted for
notational simplicity. From ( 7.30 ) and ( 7.31 ), the conditional pdf
of @xmath is given as

  -- -------- -- --------
     @xmath      (7.34)
  -- -------- -- --------

Since @xmath , @xmath , i.e.,

  -- -------- -- --------
     @xmath      (7.35)
  -- -------- -- --------

By taking the expectation of ( 7.34 ) over the distribution of @xmath ,
the pdf of @xmath is obtained as [ 58 , Eq. 3.471.15]

  -- -------- -- --------
     @xmath      (7.36)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      
     @xmath      (7.37)
     @xmath      
  -- -------- -- --------

Thus, the cdf of @xmath is expressed as

  -- -------- -- --------
     @xmath      (7.38)
  -- -------- -- --------

By substituting ( 7.38 ) into ( 7.21 ), the cdf of @xmath is obtained as

  -- -------- -- --------
     @xmath      (7.39)
  -- -------- -- --------

On the other hand, it follows from ( 7.32 ) and ( 7.33 ) that the
conditional pdf of @xmath is

  -- -------- -- --------
     @xmath      (7.40)
  -- -------- -- --------

Since, conditioned on @xmath , @xmath . Therefore, @xmath , i.e.,

  -- -------- -- --------
     @xmath      (7.41)
  -- -------- -- --------

And by taking the expectation of ( 7.40 ) over the distribution of
@xmath , one has [ 58 , Eq. 3.471.15]

  -- -------- -- --------
     @xmath      (7.42)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      
     @xmath      (7.43)
     @xmath      
  -- -------- -- --------

are functions of random variable @xmath , whose pdf is @xmath .

Thus, the cdf of @xmath conditioned on @xmath is given as

  -- -------- -- --------
     @xmath      (7.44)
  -- -------- -- --------

By substituting ( 7.44 ) into ( 7.20 ), the cdf of @xmath , conditioned
on @xmath , is

  -- -------- -- --------
     @xmath      (7.45)
  -- -------- -- --------

Using ( 7.36 ) and ( 7.45 ), ( 7.18 ) can be evaluated as follows:

  -- -------- -- --------
     @xmath      (7.46)
  -- -------- -- --------

Also, using ( 7.39 ) and ( 7.42 ), ( 7.19 ) is computed as

  -- -- -- --------
           (7.47)
  -- -- -- --------

Therefore, from ( 7.46 ) and ( 7.47 ), the conditional BER can be
expressed as

  -- -------- -- --------
     @xmath      (7.48)
  -- -------- -- --------

Finally, by substituting @xmath from ( 7.43 ) and taking the average
over the distribution of @xmath , one has

  -- -------- -- --------
     @xmath      (7.49)
  -- -------- -- --------

where the terms @xmath , @xmath and @xmath are determined in the
following.

First, @xmath is computed as

  -- -------- -- --------
     @xmath      (7.50)
  -- -------- -- --------

where @xmath are defined as

  -- -------- -- --------
     @xmath      (7.51)
  -- -------- -- --------

Second, @xmath is obtained as

  -- -------- -- --------
     @xmath      (7.52)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (7.53)
     @xmath      
  -- -------- -- --------

Third, @xmath is determined as

  -- -------- -- --------
     @xmath      (7.54)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      
     @xmath      (7.55)
     @xmath      
  -- -------- -- --------

In summary, the obtained BER expression in ( 7.49 ) gives the exact BER
of the D-AF relaying system using DBPSK and selection combining in
general time-varying Rayleigh fading channels. For the special case of
@xmath this expression yields the BER of the system considered in [ 67 ]
for symmetric slow-fading channels. It should be mentioned that,
although, the BER expression of [ 67 , Eq.23] looks different than (
7.49 ) in the special case, both expressions give the same results for
slow-fading symmetric channels. However, the expression in ( 7.49 ) only
involves computing the exponential integral function, whereas the
expression of [ 67 , Eq.23] was derived in the integral form which also
involves the exponential integral function.

It is also seen that the obtained BER expression depends on the channel
auto-correlations. This dependence is the reason for performance
degradation in fast-fading channels and the fact that the BER reaches an
error floor at high signal-to-noise ratio. The error floor can be
obtained as (see Appendix for the proof):

  -- -------- -- --------
     @xmath      (7.56)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (7.57)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (7.58)
  -- -------- -- --------

with

  -- -------- -- --------
     @xmath      (7.59)
     @xmath      (7.60)
  -- -------- -- --------

and

  -- -------- -- --------
     @xmath      (7.61)
  -- -------- -- --------

with

  -- -------- -- --------
     @xmath      (7.62)
     @xmath      (7.63)
  -- -------- -- --------

The above expressions show that the error floor is a function of the
second-order statistics of the channels (auto-correlation and variance)
and the power amplification factor and it is independent of the (high)
transmitted power.

### 7.5 Simulation Results

In this section the D-AF relay network under consideration is simulated
for various channel qualities using both the SC and semi-MRC methods.
The obtained theoretical BER and error floor of the SC method are
verified by simulation results.

The channel coefficients are assumed to be Rayleigh flat-fading, i.e.,
@xmath Based on the location of the nodes with respect to each other and
channel qualities, variances of the channels would be different. Here,
three scenarios are considered: (i) symmetric channels with @xmath ,
(ii) non-symmetric channels with strong SR channel @xmath , and (iii)
non-symmetric channels with strong RD channel @xmath . The channel
scenarios are summarized in Table 7.1 .

The simulation method of [ 37 ] is utilized to generate the
time-correlated channel coefficients @xmath The amount of
time-correlation is determined by the normalized Doppler frequency of
the underlying channel, which is a function of the mobility, carrier
frequency and symbol duration. Obviously, for fixed carrier frequency
and symbol duration, a higher mobility leads to a larger Doppler
frequency and less time-correlation.

Based on the normalized Doppler frequency of the three channels,
different cases are considered. To get an understanding about choosing
the normalized Doppler frequency values, the obtained error floor
expression is examined for a large range of Doppler values. Fig. 7.3
plots of error floors versus channel fade rates for the three scenarios
of Table 7.1 . It is assumed that the SD and SR channels have similar
normalized Doppler frequencies, i.e., @xmath , which changes from 0.001
to 0.1 and @xmath . The plots in Fig. 7.3 can be divided into three
regions. For fade rates less than 0.01, the error floor is very small
and this region would be regarded as the slow-fading region. The fade
rate of 0.01 is an approximate threshold beyond which the channels
become relatively fast-fading. For fade rates between 0.01 to 0.05, the
error floor increases asymptotically in a linear manner with a
relatively sharp slope from @xmath to @xmath . When the fade rate is
larger than 0.05, the error floors continue to increase from @xmath to
@xmath . A BER value of around @xmath is obtained in this region. This
is very high for reliable communication and therefore the fade rate of
0.05 would be regarded as the threshold beyond which the channels become
very fast-fading.

From the discussion concerning Fig. 7.3 , three fading cases are
considered. In Case I, it is assumed that all nodes are fixed or slowly
moving so that all channels are slow-fading with the normalized Doppler
values of @xmath . In Case II, it is assumed that Source is moving so
that the SD and SR channels are fast-fading with @xmath but Relay and
Destination are fixed and the RD channel is slow-fading with @xmath . In
Case III, it is assumed that both Source and Destination are moving so
that all the channels are fast-fading with @xmath and @xmath ,
respectively. The normalized Doppler values are listed in Table 7.2 .
Also, a snapshot of realizations of the direct and cascaded channels and
their auto-correlation values in the three cases are plotted in Fig. 7.4
. The plots show that when the normalized Doppler frequency values get
larger, the channel coefficients fluctuate wider and the corresponding
auto-correlation values decline faster over time. The auto-correlation
of the cascaded channel declines faster than that of the direct channel
as it involves the effects of two channels.

First, the optimum power allocation between Source and Relay to minimize
the BER is investigated in the three scenarios of Table 7.1 and fading
rates of Case I (slow-fading). For each scenario listed in Table 7.1 ,
the BER expression is examined for different values of power allocation
factor @xmath , where @xmath is the total power. The BER curves are
plotted versus @xmath in Fig. 7.5 for @xmath =20, 25, 30 dB. Also, the
optimum values obtained for the SC method are listed in Table 7.1 when
@xmath dB. The optimum values in Table 7.1 and Fig. 7.5 show that in
general more power should be allocated to Source than Relay. The BER is
minimized at @xmath and @xmath for symmetric and strong SR channels,
respectively. When the RD channel becomes stronger than the SR channel,
even more power should be allocated to Source and the BER is minimized
at @xmath . This observation is similar to what reported in [ 17 , Table
I] for the semi-MC technique.

The obtained power allocation factors are used in the simulation and the
simulated BER using the SC and semi-MRC methods are computed for the
three fading cases and channel variances. The BER results are plotted
versus @xmath in Figs. 7.6 – 7.8 with solid lines (different legends).
In each figure, three fading cases are shown. It should be mentioned
that the results of Case I in Figure 7.6 correspond to the results of [
67 ] considered for symmetric slow-fading channels. On the other hand,
the corresponding theoretical BER values of the SC method (for all
cases) are computed from ( 7.49 ) and plotted in Figs. 7.6 – 7.8 with
dashed lines. The horizontal plotted lines show the theoretical values
of the error floor for Case II and III, computed from ( 7.56 ).

As it seen in all the figures, the simulation results of the SC method
are tight to the analytical results for all fading cases and channel
variances. This observation verifies our analysis. Specifically, in Case
I (slow-fading) of all the figures, the BER of the SC method (and
semi-MRC) is consistently decreasing with @xmath and a diversity of two
is achieved. The error floor in this case is very small ( @xmath ) and
practically does not exist.

However, in Case II of all the figures, the situation is different from
Case I. Since this case involves two fast-fading channels, the effect of
channels variation is clearly observed in the obtained BER of both
methods for @xmath dB. The BER gradually deviates from the results in
Case I and eventually reaches to an error floor between @xmath to @xmath
. The exact amount of the error floors can be read from the horizontal
lines in the figures.

Similarly, in Case III of all the figures, the obtained BER is degraded
for @xmath dB. A severe degradation is seen in this case as all channels
are fast-fading, specially two channels are around the threshold of very
fast-fading region. There is no benefit in increasing the transmit power
since an error floor around @xmath appears for @xmath dB.

Moreover, the results of both SC and semi-MRC methods are very close to
each other in all the figures. In Cases II and III of Figs. 7.6 and 7.8
, the results of the SC method are slightly better than that of the
semi-MRC method at high @xmath . This is due to the fact that the fixed
combining weights (used in ( 7.14 )) of the semi-MRC method are not
optimum and determined based on the second-order statistics of the
channels and not their instantaneous CSI. Note that, in MRC method, the
optimum combing weights should be computed based on the noise variance
of each link. The noise variance of the cascaded link is a function of
the instantaneous CSI of the RD channel, which is not available in the
considered system.

On the other hand, the close performance of both methods allows one to
use the BER analysis of the SC method to tightly approximate the
performance of the semi-MRC method in time-varying channels. It should
be mentioned that the exact performance evaluation of the semi-MRC in
time-varying channels appears difficult and only a loose lower bound was
reported in [ 51 ] .

### 7.6 Conclusion

Selection combining of the received signals at Destination in a D-AF
relay network employing DBPSK was studied in general time-varying
Rayleigh fading channels. Thanks to the differential encoding and
selection combiner, no channel state information is needed at
Destination for information detection. The exact bit-error-rate of the
system was derived. Simulation results in various fading rates and
channel variances verified the analysis and show that the selection
combiner performs very close to the more-complicated semi-MRC method
(which needs the second-order statistics of all channels at
Destination). The analytical results show that the error performance
depends on the fading rates of the equivalent channel and direct channel
and an error floor exists at high signal-to-noise ratio region.

## Appendix 7.A Proof of (7.56)

  -- -------- -- --------
     @xmath      (7.64)
  -- -------- -- --------

From ( 7.37 ), one has

  -- -------- -- --------
     @xmath      (7.65)
  -- -------- -- --------

Likewise, taking the limit in ( 7.51 ) gives

  -- -------- -- --------
     @xmath      (7.66)
  -- -------- -- --------

Again from ( 7.51 ), one has

  -- -------- -- --------
     @xmath      (7.67)
  -- -------- -- --------

where the approximation has been made for large @xmath . Hence,

  -- -------- -- --------
     @xmath      (7.68)
  -- -------- -- --------

On the other hand, for large @xmath , @xmath and using the following
approximation [ 72 , Eq. 5.1.20] , one has

  -- -------- -- --------
     @xmath      (7.69)
  -- -------- -- --------

and

  -- -------- -- --------
     @xmath      (7.70)
  -- -------- -- --------

Therefore, by substituting ( 7.65 ), ( 7.66 ) and ( 7.70 ) into ( 7.64
), ( 7.57 ) is obtained.

Finding @xmath and @xmath by taking the limit of @xmath and @xmath is
straightforward. Note that, in deriving @xmath and @xmath , by
substituting @xmath into ( 7.7 ), one has

  -- -------- -- --------
     @xmath      (7.71)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (7.72)
  -- -------- -- --------

## Chapter 8 Performance of Differential Distributed Space-Time Coding

As discussed in Chapter 3 , in cooperative relay networks, relays can
utilize either repetition-based strategy or distributed space-time
coding (DSTC) strategy to cooperate and deliver their signals to the
destination. In the repetition-based strategy, each relay re-broadcasts
its signals sequentially in time, while the other relays are silent (see
Figure 3.6 ). Repetition based strategy is simple to implement but has a
low spectral efficiency. The repetition-based strategy has been
considered in Chapters 5 - 7 . Another way to take advantage of relay
resources in cooperative networks is to use the DSTC strategy. In the
DSTC strategy, relays transmit their signals simultaneously in time to
the destination (see Figure 3.7 ). The simultaneous transmission using
space-time coding structure improves the spectral efficiency of the
system at the price of higher complexity in both encoding and decoding.

In this chapter, a multi-branch dual-hop relaying without a direct link
employing DSTC strategy is considered. This topology, depicted in Figure
3.2 , can be used for both coverage extension and diversity improvement.
To avoid channel estimation at the destination, differential encoding is
applied at the source. Similar to the repetition-based strategy, the
first goal in this manuscript is to study the performance of
two-codeword differential detection and its robustness in time-varying
channels. When using the DSTC strategy, the required coherence time for
two-codeword detection is larger than that of the repetition-based
strategy. This makes differential DSTC (D-DSTC) more vulnerable against
the mobility of users in the network. Thus, it is important to analyse
the performance of D-DSTC and its achievable diversity in time-varying
channels. It will be seen through the analysis and simulation that the
pair-wise error probability of two-codeword differential detection in
fast-fading channels hits an error floor and the achieved diversity goes
to zero.

In the second part of this chapter, a multiple-codeword differential
detection is designed to improve the performance of D-DSTC in
fast-fading channels. Since the multiple-codeword detection is
complicated, the decision metric is simplified such that the available
sphere-decoding techniques used in point-to-point MIMO systems can be
easily adapted for D-DSTC system. It is very important to carefully
determine the parameters of the detection process based on the system
and channels information to achieve the optimal performance expected by
multiple-codeword detection. The performance of the developed
multiple-codeword differential detection algorithm is also shown by
simulation results in various fading scenarios.

The results of our study is reported in the following manuscript.

[Ch8-1] M. R. Avendi, Ha H. Nguyen,“Effect of Mobility on the
Performance of Differential Distributed Space-Time Coding”, submitted to
ComManTel 2014 .

Effect of Mobility on the Performance of Differential Distributed
Space-Time Coding

M. R. Avendi, Ha H. Nguyen

Abstract

This article studies the behaviour of Differential distributed
space-time coding (D-DSTC) using two-codeword and multiple-codeword
differential detection over time-varying Rayleigh fading channels.
Instead of the conventional slow-fading assumption, a time-series model
is utilized and the performance of two-codeword differential detection
is analysed by deriving an upper bound for the pair-wise error
probability. The derivation reveals that the two-codeword differential
detection performs poorly in fast-fading channels and the obtained
diversity approaches to zero regardless of the number of relays. On the
other hand, to overcome the error floor experienced with fast-fading
channels, a nearly optimal “multiple-codeword” differential detection is
developed. The multiple-codeword detection algorithm jointly processes a
larger window of received signals for differential detection and
significantly improves the performance of D-DSTC in fast-fading
channels. Computer simulation is carried out in different fading
scenarios to support the analysis and the effectiveness of the
multiple-codeword detection algorithm.

Index terms

Distributed relaying,differential modulation, time-varying fading
channels, channel auto-correlation, two-codeword detection,
multiple-codeword differential detection.

### 8.1 Introduction

It has been well-known that using antenna arrays can offer a substantial
diversity gain, which helps to overcome the effect of channel fading and
achieve a better quality and/or higher data rate in wireless networks.
However, using multiple antennas is impractical for mobile applications
since there is insufficient space to mount multiple antennas on a mobile
unit in order to create uncorrelated wireless fading channels. This
limitation can be addressed by using the technique of cooperative
communications, which has been shown to be applicable in many wireless
systems and applications such as 3GPP LTE-Advances, WiMAX, WLANs,
vehicle-to-vehicle communications and wireless sensor networks [ 8 , 7 ,
9 , 10 , 6 ] .

The technique of cooperative communications makes use of the fact that,
since users in a network can listen to a source during its transmission
phase, they would be able to re-broadcast the received data to the
destination in another phase. Therefore, the overall diversity and
performance of the network would benefit from the virtual antenna array
that is constructed cooperatively by multiple users.

Depending on the protocol that relays utilize to process and re-transmit
the received signal to the destination, the relay networks have been
generally classified as decode-and-forward or amplify-and-forward [ 12 ]
. Among these two protocols, amplify-and-forward (AF) has been the focus
of many studies because of its simplicity in the relay’s operation.
Moreover, depending on the strategy that relays utilize to cooperate,
relay networks are categorized as repetition-based and distributed
space-time coding (DSTC)-based [ 13 ] . The later strategy yields a
higher spectral efficiency than the former but it is more complicated to
design and build [ 13 ] .

In DSTC networks [ 13 , 21 , 22 ] , the relays cooperate to combine the
received symbols by multiplying them with a fixed or variable factor and
forward the resulted signals to the destination. The cooperation is such
that a space-time code is effectively constructed at the destination.
Coherent detection of transmitted symbols can be achieved by providing
the instantaneous channels state information (CSI) of all transmission
links at the destination. Although this requirement can be accomplished
by sending pilot (training) signals and using channel estimation
techniques in slow-fading environments, it is not feasible in
fast-fading channels. Moreover, collecting the CSI of SR channels at the
destination is questionable due to noise amplification at relays.
Furthermore, the computational complexity and overhead of channel
estimation increase proportionally with the number of relays. In
addition, in fast-fading channels a more frequent channel estimation is
needed, which reduces the effective transmission rate and spectral
efficiency. Also, all channel estimation techniques are subject to
impairments that would directly translate to performance degradation.

When no CSI is available at the relays and destination, differential
DSTC (D-DSTC) scheme has been studied in [ 28 , 73 , 26 , 27 ] which
only needs the second-order statistics of the channels at the relays.
Also, the constructed unitary space-time code at the destination
provides the opportunity to apply two-codeword non-coherent detection
without any CSI. Although the simplicity of two-codeword differential
detection makes it very appealing, there has not been any study on its
capability in practical time-varying channels. Most of research works on
D-DSTC schemes assume a slow-fading situation and show, via simulation,
that the performance of the D-DSTC scheme is about 3-4 dB worse than the
performance of its coherent version. In reality, due to the mobility of
users, channels become time-varying. Thus, the common assumption used in
two-codeword differential detection, namely approximate equality of two
consecutive channel uses, is violated. Based on this motivation, the
first goal of this article is to examine the performance of D-DSTC using
two-codeword differential detection and its robustness under practical
channel variation scenarios.

Considered is the case that a source communicates with a destination via
multiple relays and all the channels change over time depending on the
mobility of users. Instead of the slow-fading assumption, a time-series
model originally developed in [ 51 ] is utilized to characterize the
time-varying nature of the channels. Based on this model, an upper bound
for the pair-wise error probability (PEP) is derived and used to analyse
the obtained diversity under general time-varying Rayleigh fading
channels. It is seen that the full diversity is achieved in slow-fading
channels. However, the diversity diminishes quickly and approaches to
zero in fast-fading channels. In other words, the performance of the
system hits an error floor. Simulation results are provided to support
the analysis in various scenarios of fading channels.

To overcome the limitations of two-codeword detection in fast-fading
channels, the second goal of this article is to design a robust
differential detection for the D-DSTC system. It is noted that a similar
problem was addressed in point-to-point communications using
multiple-symbol detection. Multiple-symbol differential detection, first
proposed for point-to-point communications in [ 32 ] , jointly processes
a larger window of the received symbols for detection. As the complexity
increases exponentially with the window size, Lampe et. al [ 40 ]
developed a multiple-symbol differential sphere detection algorithm to
reduce the complexity of multiple-symbol detection. Later, Pauli et al.
[ 43 ] developed a multiple-codeword detection algorithm for unitary
space-time codes in MIMO systems. In the context of relay networks, due
to the complexity of the distribution of the received signals at the
destination, the optimal decision rule of multiple-codeword detection
does not have a closed-form solution. For simple implementation, an
alternative decision rule is proposed and further simplified so that the
multiple-codeword sphere detection algorithm of [ 43 ] can be applied.
It is also important to accurately determine the parameters of the
detection process based on the channel and system information to achieve
the optimal results. Finally, the near optimal performance of the
proposed detection algorithm is illustrated with simulation results in
different fading scenarios. It is seen that the proposed
multiple-codeword detection technique, using a window of @xmath
codewords, is able to significantly improve the performance of the
D-DSTC system in fast-fading channels.

The outline of the paper is as follows. Section 8.2 describes the system
model. In Section 8.3 , the two-codeword differential detection of
D-DSTC and its performance over time-varying Rayleigh-fading channels
are studied. In Section 8.4 , multiple-codeword differential detection
is developed. Simulation results are given in Section 8.5 . Section 8.6
concludes the paper.

Notations: @xmath , @xmath , @xmath , @xmath , @xmath and @xmath denote
transpose, complex conjugate, transpose conjugate, absolute value, real
part and imaginary part of a complex vector or matrix, respectively.
@xmath and @xmath are @xmath identity matrix and zero matrix,
respectively. @xmath and @xmath stand for circular symmetric Gaussian
random vector with zero mean and covariance @xmath and chi-squared
distribution with @xmath degrees of freedom, respectively. @xmath ,
@xmath denote expectation and variance operations, respectively. Both
@xmath and @xmath show the exponential function. @xmath denotes the
Euclidean norm of a vector. @xmath is the diagonal matrix with @xmath as
its diagonal entries and @xmath is @xmath block diagonal matrix with the
@xmath matrices @xmath on its main diagonal. @xmath is Kronecker
product. A symmetric @xmath Toeplitz matrix is defined by @xmath .
@xmath denotes determinant of a matrix.

### 8.2 System Model

The wireless relay network under consideration, shown in Fig. 8.1 , is
similar to what considered in [ 21 , 28 ] . It has one source, @xmath
relays and one destination. Source communicates with Destination via the
relays. Each node has a single antenna, and the communication between
nodes is half duplex (i.e., each node is able to only send or receive in
any given time). Individual channels from Source to the @xmath th relay
( @xmath ) and from the @xmath th relay to Destination ( @xmath D) are
Rayleigh flat-fading and spatially uncorrelated. Moreover, due to the
mobility of nodes, the channels would change over time. The amount of
channel variation is quantified by the channel auto-correlation
function, which is a function of fading rate. The fading rate is related
to the Doppler shift which is also a function of the velocity of the
user. Hence, there is a direct relation between the mobility, channel
variation and Doppler frequency.

Information bits are converted to symbols using a modulation technique
such as PSK, QAM at Source. Depending on the number of relays and the
type of constellation, appropriate @xmath unitary matrices @xmath are
used, where @xmath is the total number of codewords. We refer the reader
to [ 21 , 28 , 73 ] for more details on selecting these matrices. The
transmission process is divided into two phases and sending a codeword
(or matrix) from Source to Destination in two phases is referred to as
one transmission block, indexed by @xmath . Either codeword-by-codeword
or frame-by-frame transmission protocol can be used. However,
codeword-by-codeword is not practical, due to frequent switching of
transmitter and receiver, and instead a frame of codewords is to be sent
in each phase. The analysis is the same for both cases and only the
channel auto-correlation value is different. In codeword-by-codeword
transmission, the distance between two channel uses is @xmath symbols
apart, whereas in frame-by-frame transmission it is @xmath symbols
apart.

Information symbols are encoded into codeword @xmath . Before
transmission, the codeword is differentially encoded as

  -- -------- -- -------
     @xmath      (8.1)
  -- -------- -- -------

Obviously, the length of vector @xmath is @xmath .

In phase I, vector @xmath is transmitted by Source to all the relays,
where @xmath is the average source power per transmission. The fading
channels between Source and relays are assumed to be quasi-static during
each block but change continuously from block to block. Also, for
simplicity of notations and feasibility of analysis, it is assumed that
all SR links have the same variance, fade-rate and carrier frequency.
Let the coefficient of the @xmath channel, @xmath , during the @xmath th
block be represented by @xmath . The auto-correlation between two
channel coefficients, which are @xmath blocks apart, follows the Jakes’
fading model [ 34 ] :

  -- -- -- -------
           (8.2)
  -- -- -- -------

where @xmath is the zeroth-order Bessel function of the first kind and
@xmath is the maximum Doppler frequency of @xmath channel. Note, the
auto-correlation value equals one for static channels and decreases with
higher fade-rates.

The received vector at the @xmath th relay is

  -- -------- -- -------
     @xmath      (8.3)
  -- -------- -- -------

where @xmath is the noise vector at the @xmath th relay.

The received vector at the @xmath th relay is linearly combined with its
conjugate as

  -- -------- -- -------
     @xmath      (8.4)
  -- -------- -- -------

where @xmath and @xmath are the combining matrices and determined based
on the space-time code that is used for the network. Usually, one matrix
is chosen as an unitary matrix and the other is set to zero. Again, we
refer the reader to [ 21 , 28 ] for more details on determining the
combining matrices. Also, @xmath is the amplification factor at the
relay that can be either fixed or varying. A variable @xmath needs the
instantaneous CSI. For D-DSTC, in the absence of the instantaneous CSI,
the variance of @xmath channels is utilized to define a fixed
amplification factor as

  -- -------- -- -------
     @xmath      (8.5)
  -- -------- -- -------

where @xmath is the average power per symbol of the @xmath th relay. It
was shown in [ 28 , 74 ] that for a given total power in the network,
@xmath , for symmetric Source-Relay (SR) and Relay-Destination (RD)
channels, @xmath and @xmath form the optimum power allocation between
Source and relays to minimize the PEP. Hence, the amplification factor
@xmath , is chosen for all the relays.

Then, in phase II, the relays send their data simultaneously to
Destination. Again, under the quasi-static fading assumption, the
coefficients of @xmath channels during the @xmath th block are
represented by @xmath . The auto-correlation between the channel
coefficients, @xmath blocks apart, follows the Jakes’ model [ 34 ]

  -- -- -- -------
           (8.6)
  -- -- -- -------

where @xmath is the maximum normalized Doppler frequency of @xmath
channel.

The corresponding received vector at Destination is

  -- -------- -- -------
     @xmath      (8.7)
  -- -------- -- -------

where @xmath is the noise vector at Destination. Substituting ( 8.4 )
into ( 8.7 ) yields [ 28 ] :

  -- -------- -- -------
     @xmath      (8.8)
  -- -------- -- -------

where

  -- -------- -- -------
     @xmath      (8.9)
  -- -------- -- -------

and

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

are the distributed space-time code, the equivalent cascaded channel
vector and the equivalent noise vector, respectively.

It should be noted that for given @xmath , @xmath is @xmath where

  -- -------- -- --------
     @xmath      (8.10)
  -- -------- -- --------

It follows that condition on @xmath and @xmath , @xmath is @xmath ,
where @xmath is the average received SNR per symbol, conditioned on
@xmath , defined as

  -- -------- -- --------
     @xmath      (8.11)
  -- -------- -- --------

In the following sections, the two-codeword and multiple-codeword
differential detections of the received signals at Destination are
considered.

### 8.3 Two-Codeword Differential Detection

#### 8.3.1 Time-Series Model and Differential Detection

Coherent detection of transmitted codeword is possible only with the
knowledge of both SR and RD channels based on the model in ( 8.8 ). In
the absence of channel information, in conventional D-DSTC that was
considered in references [ 28 , 26 , 27 ] , it is assumed that the
channels are fixed for two consecutive block uses, i.e.,

  -- -------- -- --------
     @xmath      (8.12)
  -- -------- -- --------

By substituting ( 8.1 ) and ( 8.12 ) into ( 8.8 ), one has

  -- -------- -- --------
     @xmath      (8.13)
  -- -------- -- --------

Given @xmath and @xmath , differential non-coherent detection is applied
to detect the transmitted codeword as [ 28 ]

  -- -------- -- --------
     @xmath      (8.14)
  -- -------- -- --------

Comparing ( 8.8 ) and ( 8.13 ) reveals that the equivalent noise power
is enhanced by a factor of two, which explains why the differential
non-coherent detection performs approximately @xmath dB worse than the
coherent detection in slow-fading channels.

However, slow-fading assumption requires a coherence interval of @xmath
for both SR and RD channels [ 28 ] , which would be easily violated for
fast-fading channels. To determine the performance of D-DSTC detection
in time-varying channels, we need to model the cascaded channels with a
time-series model.

Based on the first-order auto-regressive AR(1) model of individual
Rayleigh channels [ 35 ] , reference [ 51 ] developed a time-series
model to characterize the evolution of the cascaded channels in time. In
particular, the first-order time-series model of the @xmath th cascaded
channel is given as (the reader is referred to [ 51 ] for the details in
deriving this model):

  -- -------- -- --------
     @xmath      (8.15)
  -- -------- -- --------

where @xmath is the equivalent auto-correlation of the cascaded channel
and @xmath is independent of @xmath . Please note that the time-series
model given in ( 8.15 ) is used only for the performance analysis and
not for generating channel coefficients in the simulation.

The vector form of the cascaded channels is expressed as

  -- -------- -- --------
     @xmath      (8.16)
  -- -------- -- --------

where @xmath and @xmath .

By substituting the time-series model ( 8.16 ) into ( 8.8 ), one has

  -- -------- -- --------
     @xmath      (8.17)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (8.18)
  -- -------- -- --------

Note that, for given @xmath , the equivalent noise @xmath is a
combination of complex Gaussian random vectors, and hence it is also a
complex Gaussian random vector.

As it can be seen, the equivalent noise power is enhanced by an
additional factor which is related to the equivalent channel’s
auto-correlation, the transmitted power and RD channel coefficients. Due
to this term, compared to the case of differential detection under
slow-fading assumption as in [ 28 , 26 , 27 ] , a larger performance
loss can be seen between coherent and non-coherent detections in
fast-fading channels.

In the next section, the error performance of the system under
consideration is analysed.

#### 8.3.2 Performance Analysis

Assume that codeword @xmath is transmitted and it is decoded erroneously
to other codeword @xmath , by the decoder. The corresponding PEP is
defined as @xmath An error occurs when

  -- -------- -- --------
     @xmath      (8.19)
  -- -------- -- --------

which can be simplified to

  -- -------- -- --------
     @xmath      (8.20)
  -- -------- -- --------

By substituting @xmath from ( 8.17 ) into the above inequality, the
error event can be further simplified as @xmath , where (see proof in
Appendix 8.A )

  -- -------- -- --------
     @xmath      (8.21)
  -- -------- -- --------

and @xmath , @xmath . Since @xmath , conditioned on @xmath , is a
Gaussian random vector, the variable @xmath conditioned on @xmath and
@xmath is a Gaussian random variable. From now on, for simplicity of
notation, time index @xmath is omitted. The conditional mean and
variance of @xmath are obtained as (see proof in Appendix 8.B )

  -- -------- -- --------
     @xmath      (8.22)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (8.23)
  -- -------- -- --------

where

  -- -------- --
     @xmath   
  -- -------- --

Therefore, the conditional PEP can be upper bound as

  -- -------- -- --------
     @xmath      (8.24)
  -- -------- -- --------

where @xmath . Since the diagonal elements of matrix @xmath depend on RD
channel coefficients and are not equal, using the exact expressions of (
8.22 ) and ( 8.23 ) into ( 8.24 ) leads to a complicated fractional
expression that cannot be further simplified. Hence, to facilitate the
analysis an approximation has to be made. Here, we replace matrix @xmath
with @xmath , which is a diagonal matrix whose entries are the average
of diagonal entries of @xmath . With this replacement, @xmath and @xmath
can be approximated as (see proof in Appendix 8.C )

  -- -------- -- --------
     @xmath      (8.25)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (8.26)
  -- -------- -- --------

It then follows that

  -- -------- -- --------
     @xmath      (8.27)
  -- -------- -- --------

with @xmath , defined as

  -- -------- -- --------
     @xmath      (8.28)
  -- -------- -- --------

The parameter @xmath can be interpreted as the effective SNR at the
output of two-codeword differential decoder of the D-DSTC system in
time-varying channels. For slow-fading channels, @xmath and @xmath which
shows that the effective SNR is reduced by half, giving the well-known 3
dB performance loss between coherent and non-coherent detection. For
fast-fading channels, @xmath and @xmath , which leads to a higher
degradation in the system performance.

To proceed with computing ( 8.24 ), the distribution of @xmath or
equivalently @xmath is required. Since, conditioned on @xmath , @xmath
is @xmath , one has

  -- -------- -- --------
     @xmath      (8.29)
  -- -------- -- --------

Also, it is known that if @xmath then @xmath where @xmath is the gamma
distribution. Hence, @xmath i.e.,

  -- -------- -- --------
     @xmath      (8.30)
  -- -------- -- --------

Now by taking the average over the distribution of @xmath , the
conditional upper bound can be written as

  -- -------- -- --------
     @xmath      (8.31)
  -- -------- -- --------

As it seen, the main parameter to achieve the full diversity is the
value of @xmath which is a function of @xmath and @xmath . For
slow-fading channels, @xmath and then in high SNR region, the upper
bound decays with @xmath and the full diversity can be achieved.
Nevertheless, due to the inherent randomness of @xmath caused by RD
channels, the performance of D-DSTC is always inferior to that of MIMO
systems with the same number of antennas. For fast-fading channels,
@xmath and the average value of @xmath in the denominator of @xmath
becomes significant and leads to a degradation in the overall
performance and the achievable diversity. For large SNR, one has

  -- -------- -- --------
     @xmath      (8.32)
  -- -------- -- --------

where @xmath . It shows that an SNR ceiling beyond which no performance
benefit can be achieved by increasing the transmitted power exists. As
can be seen, the value of the SNR ceiling is independent of @xmath and
only depends on the equivalent auto-correlation. By substituting ( 8.32
) into ( 8.31 ), it can be seen that the upper bound on the error floor
appears as

  -- -------- -- --------
     @xmath      (8.33)
  -- -------- -- --------

In other words, the obtained diversity, regardless of the number of
relays, approaches to zero for fast-fading channels. It is also pointed
out that for slow-fading channels ( @xmath ), the error floor
practically does not exist (close to zero). On the other hand, for
completely random channels with no correlation between the coefficients
@xmath , the error floor is equal to @xmath (as expected).

Now, by substituting @xmath from ( 8.28 ) into ( 8.31 ) one has

  -- -------- -- --------
     @xmath      (8.34)
  -- -------- -- --------

where the later expression is obtained using power expansion @xmath [ 58
, page 25] . Also,

  -- -------- -- --------
     @xmath      (8.35)
  -- -------- -- --------

The final step is to take the average over the distribution of @xmath ,
which is @xmath [ 21 ] . The (unconditioned) upper bound for the PEP is
given as

  -- -------- -- --------
     @xmath      (8.36)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (8.37)
  -- -------- -- --------

and [ 58 , page 339]

  -- -------- -- --------
     @xmath      (8.38)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (8.39)
  -- -------- -- --------

and @xmath is the exponential integral function.

The expression in ( 8.36 ) provides an upper bound for the PEP of the
two-codeword differential detection of D-DSTC system in time-varying
Rayleigh fading channels. The total block-error-rate (BLER) can be
obtained using the union bound.

### 8.4 Multiple-Codeword Differential Detection

As discussed in the previous section, two-codeword differential
detection suffers from a large performance degradation in fast-fading
channels. To overcome such a limitation, this section develops a
multiple-codeword differential detection scheme that takes a window of
the received symbols at the destination for detecting the transmitted
signals.

Rewrite ( 8.8 ) as

  -- -------- -- --------
     @xmath      (8.40)
  -- -------- -- --------

with

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Let the @xmath received symbols be collected in vector

  -- -------- -- --------
     @xmath      (8.41)
  -- -------- -- --------

which can be written as

  -- -- -- --------
           (8.42)
  -- -- -- --------

where

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

  -- -------- --
     @xmath   
  -- -------- --

It should be mentioned that @xmath is a unitary block diagonal matrix (
@xmath ) and it contains @xmath transmitted codewords corresponding to
@xmath data codewords collected in @xmath such that

  -- -------- -- --------
     @xmath      (8.43)
  -- -------- -- --------

and @xmath is set as the reference symbol.

Therefore, conditioned on both @xmath (or @xmath ) and @xmath , @xmath
is a circularly symmetric complex Gaussian vector with the following
pdf:

  -- -------- -- --------
     @xmath      (8.44)
  -- -------- -- --------

In ( 8.44 ), matrix @xmath is the conditional covariance matrix of
@xmath , defined as

  -- -- -- --------
           (8.45)
  -- -- -- --------

with @xmath and @xmath as the covariance matrices of @xmath and @xmath ,
respectively. They are given as follows (see proof in Appendix D):

  -- -------- -- --------
     @xmath      (8.46)
  -- -------- -- --------

  -- -------- --
     @xmath   
  -- -------- --

and

  -- -------- -- --------
     @xmath      (8.47)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (8.48)
  -- -------- -- --------

Based on ( 8.44 ), the maximum likelihood (ML) detection of @xmath
transmitted codewords collected in @xmath or the corresponding @xmath
data codewords collected in @xmath would be given as

  -- -------- -- --------
     @xmath      (8.49)
  -- -------- -- --------

where @xmath . As it can be seen, the ML metric needs the expectation
over the distribution of @xmath , which does not yield a closed-form
expression. As an alternative, it is proposed to use the following
modified decision metric:

  -- -------- -- --------
     @xmath      (8.50)
  -- -------- -- --------

where

  -- -------- -- --------
     @xmath      (8.51)
  -- -------- -- --------

with

  -- -------- -- --------
     @xmath      (8.52)
  -- -------- -- --------

  -- -------- -- --------
     @xmath      (8.53)
  -- -------- -- --------

Although the alternative decision metric is not optimal in the ML sense,
it will be shown by simulation results that nearly identical performance
to that obtained with the optimal metric can be achieved.

Using the rule @xmath , the determinant in ( 8.50 ) is no longer
dependent to @xmath and the modified decision metric can be further
simplified as

  -- -------- -- --------
     @xmath      (8.54)
  -- -------- -- --------

where @xmath is an upper triangular matrix obtained by the Cholesky
decomposition of @xmath and

  -- -------- -- --------
     @xmath      (8.55)
  -- -------- -- --------

and @xmath is the element of @xmath in row @xmath and column @xmath .

Since @xmath , the last term of vector @xmath does not have any effect
on the minimization and it can be ignored. Then by substituting @xmath
(obtained from ( 8.43 )) into ( 8.55 ), it follows that

  -- -- -- --------
           (8.56)
  -- -- -- --------

The simplified alternative minimization in ( 8.54 ) is a sum of @xmath
non-negative scalar terms and similar to the decision metric of
multiple-codeword detection of unitary space-time coding for MIMO
systems given in [ 43 , eq.5] . Therefore, this minimization can be
solved using the sphere decoding algorithm described in [ 43 ] to obtain
@xmath data codewords with low complexity. The multiple-codeword
differential sphere-decoding (MCDSD) algorithm adapted to the D-DSTC
system under consideration is summarized in Algorithm I . It should be
mentioned that Steps 1 to 3 are performed once, whereas Step 4 will be
repeated for every @xmath consecutive received symbols. Also, the
processed blocks overlap by one vector symbol, i.e., the observation
window of length @xmath moves forward by @xmath symbols at a time.

### 8.5 Numerical Results

To support our analysis and development, in this section a relay network
with one source, @xmath relays and one destination is simulated in
different fading scenarios while both two-codeword and multiple-codeword
detection schemes are applied. For the case of two-codeword detection,
the simulation results are verified with the obtained upper bound.
Effectiveness of multiple-codeword differential detection is shown when
a window of length @xmath is processed at a time.

The Alamouti space-time code is chosen for the network. The combining
matrices at the relays are designed as [ 28 ]

  -- -------- --
     @xmath   
  -- -------- --

Also, the set of unitary codewords are designed as [ 28 ]

  -- -------- -- --------
     @xmath      (8.57)
  -- -------- -- --------

The power allocation between Source and the relays is such that @xmath
and @xmath , where @xmath is the total power in the network. Also,
@xmath

Please note that the time-series model given in ( 8.15 ) has been
utilized only for performance analysis and not for generating the
channel coefficients in simulations. In all simulations, channel
coefficients @xmath and @xmath are generated independently according to
the simulation algorithm of [ 37 ] . This simulation algorithm utilizes
a sum-of-sinusoids method to generate time-correlated Rayleigh-faded
channel coefficients. For instance, to generate @xmath :

  -- -------- -- --------
     @xmath      
     @xmath      (8.58)
     @xmath      (8.59)
     @xmath      
  -- -------- -- --------

where @xmath and @xmath are statistically independent and uniformly
distributed on @xmath for all @xmath and @xmath is the number of
multipaths chosen arbitrarily large enough for an accurate model [ 37 ]
. Similarly @xmath channel coefficients are generated for @xmath ,
except that @xmath is replaced with @xmath . The input to the simulation
algorithm is the normalized Doppler frequency of the channels, which is
a function of the velocity of users. A higher velocity causes a higher
fade-rate and thus less correlation between channel coefficients.
Therefore, by changing the Doppler values, various fading scenarios from
slow-fading to fast-fading channels can be simulated.

To get a better understanding about the Doppler values, the error floor
expression given in ( 8.33 ) is examined for a wide range of fading
values from @xmath to @xmath and the computed results are plotted in
Figure 8.2 . In the figure, the lower plot corresponds to the case that
either @xmath or @xmath varies in a wide range and the other one fixed
to @xmath . In the upper plot both @xmath and @xmath vary in a wide
range. Clearly, the error floor is higher when both SR and RD channels
are changing. For small fade rates less than 0.005, the amount of error
floor is small and channels would be regarded as slow-fading. For
moderate fade rates around 0.01 the error floor increases quickly toward
@xmath and channels would be fairly fast-fading. Fade rates around 0.02
and higher lead to fast-fading channels with error floor of @xmath or
higher.

Based on the previous observations, next, three scenarios are
considered. In Scenario I, it is assumed that all the channels are
slow-fading with @xmath . In Case II, both SR and RD channels are
moderately fast-fading such that @xmath . In Case III, both SR and RD
channels are very fast-fading with @xmath . The normalized Doppler
frequencies of SR and RD channels are summarized in Table 8.1 for
different scenarios.

To evaluate the BER of the system, in each case, binary data is
converted to BPSK/QPSK constellation and then to unitary codewords based
on ( 8.57 ). Next, the codewords are encoded differentially according to
( 8.1 ). At Destination, first the two-codeword differential detection (
8.14 ) is applied. The simulation is run for various values of the total
power in the network. The practical values of the BER are computed for
all cases and plotted versus @xmath in Figs. 8.3 - 8.4 . For comparison
purpose, performance of coherent detection of the received symbols for
slow-fading channels is also evaluated and plotted in the figures.

On the other hand, the obtained upper bound on the PEP can be used to
determine an upper bound on the BER for a network with two relays using
Alamouti space-time code [ 41 ] . As it was shown in [ 75 ] , for such a
system using BPSK constellation, the PEP of the two nearest codewords

  -- -------- --
     @xmath   
  -- -------- --

can be used to find the BER of the system as [ 75 , eq.40]

  -- -------- -- --------
     @xmath      (8.60)
  -- -------- -- --------

The eigenvalue of matrix @xmath in this case is @xmath . In addition, as
it was shown in [ 76 , eq. (13) and eq. (16)] , the BER of the
differential Alamouti space-time code using BPSK and QPSK is obtained
from the same expression but with a different parameter ( @xmath for
BPSK and @xmath for QPSK). Hence, the corresponding upper bound for the
BER are computed based on ( 8.60 ) and ( 8.36 ) and plotted in Figs. 8.3
- 8.4 with dashed lines. The horizontal lines show the error floors in
Cases II and III.

It can be seen from Figs. 8.3 - 8.4 that, as expected, coherent
detection gives the best performance, which is obtained at the price of
providing the instantaneous CSI of all transmission links at the
destination. For two-codeword differential detection, in Case I
(slow-fading channels), the error probability is monotonically
decreasing with @xmath and the desired cooperative diversity is achieved
for the D-DSTC system. Approximately 3-4 dB performance degradation can
be seen between coherent and non-coherent detections in this case.
However, in Case II, with fairly fast-fading channels, the plot
gradually deviates from the results in Case I, at @xmath dB, and reaches
the error floor at @xmath dB. This phenomena starts earlier after @xmath
dB in Case III (fast-fading channels). The performance degradation is
much more severe and error floors of @xmath (BPSK) and @xmath (QPSK) can
be seen at @xmath dB. It can also be seen that, in all cases, the upper
bound values are consistent with the simulation results.

Given the poor performance of the two-codeword differential detection in
cases II and III, the multiple-codeword algorithm with @xmath is applied
to Case II and Case III. The BER results of multiple-codeword detection
algorithm are also plotted in Figures 8.3 and 8.4 . Since the best
performance is achieved in the slow-fading environment, the BER plot of
Case I using two-codeword detection can be used as a benchmark to see
the effectiveness of multiple-codeword detection algorithm. As can be
seen, the MCDSD-DSTC algorithm is able to bring the performance of the
system in Case II and Case III very close to that of Case I.

### 8.6 Conclusion

This article aimed to provide an insight into the effect of mobility of
users on the performance of differential distributed space-time coding
in cooperative relay networks. Following this goal, the conventional
two-codeword differential detection, its achievable diversity and
approximate performance are evaluated against channels variations. The
observations revealed that two-codeword differential detection suffers
from a huge performance loss in time-varying channels. Next, a near
optimal multiple-codeword differential detection was developed and its
effectiveness was shown through simulation results. Obviously, the
improvement gained by the multiple-codeword detection is at the price of
a higher complexity in the detection process. However, with the
available sphere decoding algorithms, this complexity would be
significantly reduced. The theoretical analysis and supporting
simulations of this article would bring valuable design criteria for
system engineers to design more robust systems against channel variation
and users mobility. Future work can focus on theoretical performance
evaluation of multiple-codeword detection and providing a trade-off
between the number of required symbols and the desired performance.

## Appendix 8.A Proof of (8.21)

Substituting ( 8.17 ) into ( 8.20 ) gives

  -- -------- -- --------
     @xmath      (8.61)
  -- -------- -- --------

The second part of the left hand side of the above inequality is the
definition of @xmath . Using @xmath , the first part of the inequality
can be re-written as

  -- -------- -- --------
     @xmath      (8.62)
  -- -------- -- --------

Using the fact that the eigenvalues of unitary matrices are equal, one
has @xmath . Thus ( 8.62 ) is the same as the definition of @xmath .

## Appendix 8.B Proof of (8.22) and (8.23)

For notational simplicity, time index @xmath is omitted.

  -- -------- -- --------
     @xmath      (8.63)
  -- -------- -- --------

To find the conditional mean of @xmath , first re-write ( 8.7 ) as

  -- -- -- --------
           (8.64)
  -- -- -- --------

where @xmath . Hence, using the conditional mean technique [ 65 ]

  -- -------- -- --------
     @xmath      (8.65)
  -- -------- -- --------

By substituting ( 8.65 ) into ( 8.63 ), the expression in ( 8.22 ) is
obtained.

  -- -- -- --------
           (8.66)
  -- -- -- --------

Using the conditional variance technique [ 65 ] , one has

  -- -------- -- --------
     @xmath      (8.67)
  -- -------- -- --------

Substituting ( 8.67 ) into ( 8.66 ) gives the expression in ( 8.23 ).

## Appendix 8.C Proof of (8.25) and (8.26)

Re-write ( 8.22 ) as

  -- -------- -- --------
     @xmath      (8.68)
  -- -------- -- --------

By replacing @xmath with @xmath , one has

  -- -------- -- --------
     @xmath      (8.69)
  -- -------- -- --------

Substituting ( 8.69 ) into ( 8.68 ) gives

  -- -------- -- --------
     @xmath      (8.70)
  -- -------- -- --------

Re-write ( 8.23 ) as

  -- -------- -- --------
     @xmath      (8.71)
  -- -------- -- --------

Again if we replace @xmath with the approximated scalar matrix, it is
seen that

  -- -------- -- --------
     @xmath      (8.72)
  -- -------- -- --------

and similarly,

  -- -------- -- --------
     @xmath      (8.73)
  -- -------- -- --------

Substituting ( 8.72 ) and ( 8.73 ) into ( 8.71 ) gives the expression in
( 8.26 ).

## Appendix 8.D Proof of (8.46) and (8.47)

  -- -- -- --------
           (8.74)
  -- -- -- --------

where

  -- -- --
        
  -- -- --

Therefore,

  -- -------- -- --------
     @xmath      (8.75)
  -- -------- -- --------

  -- -- -- --------
           (8.76)
  -- -- -- --------

From ( 8.10 ) one has @xmath where @xmath is Kronecker delta function.
Then,

  -- -------- -- --------
     @xmath      (8.77)
  -- -------- -- --------

## Chapter 9 Conclusions and Suggestions for Further Studies

### 9.1 Conclusions

This thesis focused mainly on developing and analyzing differential
modulation and non-coherent detection techniques for wireless
amplify-and-forward (AF) relay networks. Such techniques do not waste
overhead information required for channel estimation and hence are very
useful, especially as the number of channels grows linearly with the
number of relays employed in a network. Moreover, new and emerging
wireless communication technologies, such as LTE, are expected to
support high mobility with high performance. As channel estimation
becomes highly inaccurate in highly-mobile environments, employing
differential modulation and non-coherent detection techniques would be
necessary for these technologies. In general, the studies in this thesis
provide various options for using differential modulation and
non-coherent detection and demonstrate that they are effective and
promising solutions for information transmission over wireless relay
networks.

In particular, the main findings and contributions of this thesis are as
follows:

-   In Chapter 4 , a single-branch dual-hop relaying system without a
    direct link employing differential @xmath -PSK and non-coherent
    detection was studied. First, two-symbol non-coherent detection was
    examined in time-varying channels and an exact BER expression was
    derived for the system performance. It was seen that the coverage
    service can be extended beyond the cell edge by employing a relay in
    the network and good performance with diversity order of one can be
    achieved. Although, dependency of the BER to the channels
    auto-correlations causes a severe degradation and an error floor in
    the performance over rapid time-varying channels. Next, a near
    optimal multiple-symbol differential detection was designed and
    theoretically analysed. Simulation and theoretical results showed
    that the multiple-symbol differential detection is able to
    significantly improve the system performance in fast-fading
    channels.

-   In Chapter 5 , a multi-branch dual-hop relaying with a direct link
    employing differential @xmath -PSK and two-symbol non-coherent
    detection was considered. A linear combiner with fixed combining
    weights was chosen to achieve the spatial diversity. The fixed
    combining weights were determined based on the second-order
    statistics of the channels. The performance of the system in
    practical time-varying channels was studied and a lower bound of the
    BER was derived. The theoretical and simulation results showed that
    diversity can be improved by employing more relays in the network.
    Also, the performance of the system degrades with channel variation
    and the existence of an error floor is inevitable. However, this
    degradation can be mitigated by increasing the number of relays in
    the network. In other words, by increasing the diversity, the
    desired performance can be obtained in lower values of SNR before
    falling into the error floor region.

-   In Chapter 6 and Chapter 7 , a single-branch dual-hop relaying
    system with a direct link employing selection combining at the
    destination was studied. Compared to the linear combiner, the
    selection combiner does not need any channel or system information.
    For the case of slow-fading channels, the exact BER and outage
    probability of this combiner using differential @xmath -PSK were
    obtained. For the case of general time-varying channels (including
    both scenarios of slow-fading and fast-fading channels), an exact
    expression of the BER using DBPSK was derived. The simulation and
    theoretical results showed that the selection combiner achieves
    diversity order of two and its performance is very close to that of
    the semi-MRC method, while it is simpler. Therefore, when the
    second-order statistics of the channels are not available, the SC
    method can be used instead of the semi-MRC method, without loosening
    the performance.

-   In Chapter 8 , a multi-branch dual-hop relaying without a direct
    link employing differential distributed space-time coding (D-DSTC)
    strategy was considered. The performance of the system using
    two-symbol detection over time-varying channels was evaluated in
    terms of diversity. It was shown that using this topology, the
    coverage area, diversity and data rate of the network can be
    improved. Two-symbol differential detection was effective in
    slow-fading channels. However, it fails to perform well in
    fast-fading channels and an error will be seen and diversity goes to
    zero. In contrast to its better spectral efficiency, D-DSTC is more
    vulnerable to channel variation than repetition based strategy. This
    is due to its requirement to a longer channel coherence time for
    two-symbol differential detection. In addition, a near optimal
    multiple-symbol differential detection (MSDS) was developed. The
    simulation results showed the effectiveness of the multiple-symbol
    detection to improve the system performance in fast-fading channels.

### 9.2 Future Studies

The main objective of this thesis was to examine several important
issues in cooperative communications using differential encoding and
decoding. On the path toward achieving this objective, other issues came
up and worthwhile to be investigated further. These issues are
elaborated next.

-   Selection combining was considered and analysed for a single-branch
    dual-hop relaying with a direct link. This combiner is attractive as
    it reduces the requirement of channels information while delivering
    similar performance to that of the linear combiner. For a
    multi-branch relaying system, more channel information would be
    needed for a linear combining. Although it appears difficult, it
    would be interesting to consider and analyse the performance of the
    selection combiner for multi-branch dual-hop relaying with/without a
    direct link as well.

-   The performance analysis of multiple-symbol differential detection
    is important to reach a trade-off between the desired performance
    and the complexity of the decoding process. In this thesis, the
    performance of multiple-symbol differential detection for a
    single-branch dual-hop relaying without a direct link was derived.
    It would be then interesting to analytically evaluate the
    performance of multiple-symbol differential detection for
    multi-branch dual-hop relaying system with/without a direct link.

-   The developed multiple-symbol differential detection scheme requires
    the second-order statistics of all transmission links and also
    several other system parameters such as the noise variance and the
    amplification factor of the relays. In case that such information is
    not available nor accurate, multiple-symbol detection is not
    effective or near optimal. An alternative solution, yet challenging,
    is to develop a blind multiple-symbol differential detection that
    can deliver near optimal results.

-   In this thesis, it is assumed that no interference exists in the
    relay networks. In practice, due to frequency re-use and
    simultaneous transmission of multi users in the same frequency band,
    co-channel interference (CCI) would arise [ 77 , 78 , 79 ] . In
    addition, the lack of perfect synchronization between multi relays
    would cause inter-symbol interference (ISI) [ 80 , 81 , 82 ] . The
    existing studies on CCI and ISI problems in relay networks are
    either limited to static channels or consider under some special
    scenarios. Therefore it is worthwhile to consider both CCI and ISI
    for general scenarios in time-varying channels and develop robust
    detection techniques against the effects of CCI and ISI.

-   Channel capacity is defined as the upper bound of data rate
    transmission over a channel with arbitrary low error probability.
    There are several studies on the capacity of wireless relay networks
    in [ 83 , 84 , 4 , 85 ] . Also, there are studies on the capacity of
    time-varying channels for point-to-point communications [ 86 , 87 ]
    . It would be interesting to extend these studies to determine the
    capacity of wireless relay networks in time-varying environments.