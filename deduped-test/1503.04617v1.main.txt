# Chapter 1 Introduction

Towards the end of the twentieth century, a lot has been said about
tilings of two-dimensional regions by a number of different pieces: in
particular, the so-called domino and lozenge tilings have received a lot
of attention.

Kasteleyn [ Kasteleyn19611209 ] showed that the number of domino tilings
of a plane region can be calculated via the determinant of a matrix.
Conway [ conway1990tiling ] discovered a technique using groups, that in
a number of interesting cases can be used to decide whether a given
region can be tesselated by a set of given tiles. Thurston [
thurston1990 ] introduced height functions, and proposed a linear time
algorithm for solving the problem of tileability of simply connected
plane regions by dominoes. In a more probabilistic direction, Jockusch,
Propp and Shor [ jockusch1998random , cohn1996local ] studied random
tilings of the so-called Aztec Diamond (introduced in [
elkies1992alternating ] ), and showed the Arctic Circle Theorem. Richard
Kenyon and Andrei Okounkov also studied random tilings and, in
particular, their relation to Harnack curves [ kenyonokounkov2006dimers
, kenyonokounkov2006planar ] . The concept of a flip is important in the
context of dominoes as well as in that of lozenges. In both cases, two
tilings of a simply connected region can always be joined by a sequence
of flips (see [ saldanhatomei1998overview ] for an overview). Also, see
[ saldanhatomei1995spaces ] for considerations on flip connectivity in
more general two-dimensional regions.

However, in comparison, much less is known about tilings of
three-dimensional regions. Hammersley [ hammersley1966limit ] proved
results concerning the asymptotic behavior of the number of brick
tilings of a @xmath -dimensional box when all dimensions go to infinity.
In particular, his results imply that the limit @xmath , where @xmath is
the number of tilings of an @xmath box, exists and is finite; as far as
we know, its exact value is not yet known, but several upper and lower
bounds have been established for @xmath (see [ ciucu1998improved ] and [
friedland2005theory ] for more information on this topic). Randall and
Yngve [ randall2000random ] considered tilings of “Aztec” octahedral and
tetrahedral regions with triangular prisms, which generalize domino
tilings to three dimensions; they were able to carry over to this
setting many of the interesting properties from two dimensions, e.g.,
height functions and connectivity by local moves. Linde, Moore and
Nordahl [ linde2001rhombus ] considered families of tilings that
generalize rhombus (or lozenge) tilings to @xmath dimensions, for any
@xmath . Bodini [ bodini2007tiling ] considered tileability problems of
pyramidal polycubes. Pak and Yang [ pak2013complexity ] studied the
complexity of the problems of tileability and counting for domino
tilings in three and higher dimensions, and proved some hardness results
in this respect.

Others have considered difficulties with connectivity by local moves in
dimension higher than two (see, e.g., [ randall2000random ] ). We
propose a few related algebraic invariants that could help understand
the structure of connected components by flips in dimension three.

This thesis contains material from the preprints [ primeiroartigo ] and
[ segundoartigo ] . In this thesis, we investigate tilings of
contractible cubiculated regions (that is, a finite union of unit cubes
with vertices in @xmath ) by domino brick pieces, or dominoes , which
are @xmath rectangular cuboids, in one of the three possible rotations.
An example of such a tiling is shown in Figure 1.1 . While this 3D
representation of tilings may be attractive, it is also somewhat
difficult to work with. Hence, we prefer to work with a 2D
representation of tilings, which is shown in Figure 1.4 .

A key element in our study is the concept of a flip , which is a
straightforward generalization of the two-dimensional one. We perform a
flip on a tiling by removing two (adjacent and parallel) domino bricks
and placing them back in the only possible different position. The
removed pieces form a @xmath slab, in one of three possible directions
(see Figure 1.4 ).

We also study the trit , which is a move that happens within a @xmath
cube with two opposite “holes”, and which has an orientation (positive
or negative: see Chapter 2 ). More precisely, we remove three dominoes,
no two of them parallel, and place them back in the only other possible
configuration (see Figure 1.4 ).

A (cubiculated) cylinder or multiplex is a region of the form @xmath
(possibly rotated), where @xmath is a simply connected planar region
with connected interior. When @xmath , the region is called a duplex
region . A cubiculated region @xmath is a two-story region if it is
contained in a set of the form @xmath , possibly rotated, and such that
the sets @xmath and @xmath are both connected and simply connected.

In view of the situation with plane tilings, one might expect that the
space of domino brick tilings of a simple three-dimensional region, say,
an @xmath box, would be connected by flips. This turns out not to be the
case, as the spaces of domino brick tilings of even relatively small
boxes are already not flip-connected. In Chapter 3 , we introduce an
algebraic invariant for tilings of two-story regions. This invariant is
a polynomial @xmath associated with each tiling @xmath such that if two
tilings @xmath are in the same flip connected component, then @xmath .
The converse is not necessarily true; however, it is almost true, in a
sense that we shall discuss later. We shall prove the following theorems
in Chapter 3 :

###### Theorem 1.

The polynomial @xmath , defined in Sections 3.1 and 3.2 , has the
following properties:

1.   [label=(),topsep=0pc]

2.   If @xmath and @xmath are tilings of a two-story region that lie in
    the same flip connected component, then @xmath .

3.   If @xmath is a duplex region and @xmath and @xmath are two tilings
    of @xmath , then @xmath if and only if there exists a box with two
    floors @xmath such that the embeddings of @xmath and @xmath in
    @xmath lie in the same flip connected component.

4.   If @xmath are as above and @xmath , then there exists a box with
    four floors @xmath such that the embeddings of @xmath and @xmath in
    @xmath lie in the same flip connected component.

###### Theorem 2.

The trit has the following properties in two-story regions:

1.   [label=()]

2.   If @xmath and @xmath are two tilings of a two-story region and
    @xmath can be reached from @xmath after a single positive trit, then
    @xmath for some @xmath ; as a consequence, @xmath .

3.   The space of domino brick tilings of a duplex region is connected
    by flips and trits. In other words, if @xmath is any tiling of such
    a region and @xmath is any other tiling of the same region, then
    there exists a sequence of flips and trits that take @xmath to
    @xmath .

However, the construction for @xmath no longer makes sense for more
general regions. Chapter 4 discusses an invariant, the twist, defined
for cylinders. The definitions of twist are somewhat technical and
involve a relatively lengthy discussion. We shall give two different but
equivalent definitions: the first one, given in Section 4.1 , is a sum
over pairs of dominoes. At first sight, this formula gives a number in
@xmath and depends on a choice of axis. However, it turns out that, for
cylinders, this number is an integer, and different choices of axis
yield the same result. The proof of this claim will be completed in
Section 4.4 , and it relies on the second definition, which uses the
concepts of writhe and linking number from knot theory (see, e.g., [
knotbook ] ). In particular, we prove the following:

###### Theorem 3.

Let @xmath be a cylinder, and @xmath a tiling of @xmath . The twist
@xmath is an integer with the following properties:

1.   [label= ()]

2.  If a tiling @xmath is reached from @xmath after a flip, then @xmath
    .

3.  If a tiling @xmath is reached from @xmath after a single positive
    trit, then @xmath .

4.  If @xmath is a duplex region, then @xmath for any tiling @xmath of
    @xmath .

5.  Suppose a cylinder @xmath , where each @xmath is a cylinder (they
    need not have the same axis) and such that @xmath . Then there
    exists a constant @xmath such that, for any family @xmath , @xmath a
    tiling of @xmath ,

      -- -------- --
         @xmath   
      -- -------- --

Finally, Chapter 5 discusses the possible range values for the twist of
tilings of a given region. The main result of the chapter is the
following theorem:

###### Theorem 4.

For a box @xmath , set @xmath , and let @xmath . If @xmath , with at
least two of the three dimensions strictly larger than @xmath (and at
least one of them even), then

  -- -------- --
     @xmath   
  -- -------- --

where @xmath and @xmath . Moreover,

  -- -------- --
     @xmath   
  -- -------- --

## Chapter 2 Definitions and Notation

This short chapter contains general notations and conventions that are
used throughout the thesis, although we might postpone definitions that
involve a lengthy discussion or are intrinsic of a given chapter or
section.

If @xmath is an integer, @xmath will denote @xmath (in music theory,
@xmath is a half tone higher than @xmath in pitch). We also define
@xmath to be the set @xmath .

Given @xmath , @xmath denotes the determinant of the @xmath matrix whose
@xmath -th line is @xmath , @xmath . If @xmath is a basis, write @xmath
.

We denote the three canonical basis vectors as @xmath , @xmath and
@xmath We denote by @xmath the set of canonical basis vectors, and
@xmath . Let @xmath be the set of positively oriented bases with vectors
in @xmath .

A basic cube is a closed unit cube in @xmath whose vertices lie in
@xmath . For @xmath , the notation @xmath denotes the basic cube @xmath
, i.e., the closed unit cube whose center is @xmath ; it is white (resp.
black ) if @xmath is even (resp. odd). If @xmath , define @xmath , or,
in other words, @xmath if @xmath is black and @xmath if @xmath is white.
A region is a finite union of basic cubes. A domino brick or domino is
the union of two basic cubes that share a face. A tiling of a region is
a covering of this region by dominoes with pairwise disjoint interiors.

We sometimes need to refer to planar objects. Let @xmath denote either
@xmath or a basic plane contained in @xmath , i.e., a plane with
equation @xmath , @xmath or @xmath for some @xmath . A basic square in
@xmath is a unit square @xmath with vertices in @xmath (if @xmath ) or
@xmath . A planar region @xmath is a finite union of basic squares.

A region @xmath is a cubiculated cylinder or multiplex region if there
exist a basic plane @xmath with normal vector @xmath , a simply
connected planar region @xmath with connected interior and a positive
integer @xmath such that

  -- -------- --
     @xmath   
  -- -------- --

we usually call @xmath a cylinder or multiplex for brevity. The cylinder
@xmath above has base @xmath , axis @xmath and depth @xmath . For
instance, a cylinder with axis @xmath and depth @xmath can be written as
@xmath , where @xmath . A @xmath -cylinder means a cylinder with axis
@xmath . A duplex region or duplex is a cylinder with depth @xmath (and
hence the alternative name of multiplex for cylinders).

We sometimes want to point out that the hypothesis of simple
connectivity (of a cylinder) is not being used: therefore, a
pseudocylinder (or pseudomultiplex ) with base @xmath , axis @xmath and
depth @xmath has the same definition as above, except that the planar
region @xmath is only assumed to have connected interior (and is not
necessarily simply connected).

A box is a region of the form @xmath , where @xmath . Boxes are special
cylinders, in the sense that we can take any vector @xmath as the axis.
In fact, boxes are the only regions that satisfy the definition of
cylinder for more than one axis.

Regarding notation, Figures 1.4 , 1.4 and 1.4 were drawn with @xmath in
mind. However, any @xmath allows for such representations, as follows:
we draw @xmath as perpendicular to the paper (pointing towards the
paper). If @xmath , we then draw each floor @xmath as if it were a plane
region. Floors are drawn from left to right, in increasing order of
@xmath .

The flip connected component of a tiling @xmath of a region @xmath is
the set of all tilings of @xmath that can be reached from @xmath after a
sequence of flips.

Suppose @xmath is a tiling of a region @xmath , and let @xmath , with
@xmath . Suppose @xmath contains exactly three dominoes of @xmath , no
two of them parallel: notice that this intersection can contain six,
seven or eight basic cubes of @xmath . Also, a rotation (it can even be
a rotation, say, in the @xmath plane), can take us either to the left
drawing or to the right drawing in Figure 2.1 .

If we remove the three dominoes of @xmath contained in @xmath , there is
only one other possible way we can place them back. This defines a move
that takes @xmath to a different tiling @xmath by only changing dominoes
in @xmath : this move is called a trit . If the dominoes of @xmath
contained in @xmath form a plane rotation of the left drawing in Figure
2.1 , then the trit is positive ; otherwise, it’s negative . Notice that
the sign of the trit is unaffected by translations (colors of cubes
don’t matter) and rotations in @xmath (provided that these
transformations take @xmath to @xmath ). A reflection, on the other
hand, switches the sign (the drawing on the right can be obtained from
the one on the left by a suitable reflection).

## Chapter 3 The two-floored case

A two-story region is a connected and simply connected region @xmath ,
where @xmath is a basic plane with normal @xmath , such that both sets
@xmath and @xmath are simply connected. We often think of these two sets
as the two “floors” of @xmath . In this chapter (unlike the next),
rotations will not play an important role, so we shall assume that
@xmath and @xmath . Likewise, duplex regions will be assumed to have
axis @xmath , and will often be denoted @xmath where @xmath has
connected interior and is simply connected.

Most of the material in this chapter is also covered in [ primeiroartigo
] .

### 3.1 Duplex regions

Let @xmath be a quadriculated simply connected plane region, and let
@xmath be a duplex region. Our goal throughout this section is to
associate to each tiling @xmath of @xmath a polynomial @xmath which
always coincides for tilings in the same flip connected component.

Consider the two floors of a tiling @xmath of @xmath , each dimer of
@xmath being oriented from the white cube that it contains to the black
one, as illustrated in the left of Figure 3.1 . If we project the dimers
of @xmath to the plane @xmath , we will see two plane tilings of @xmath
with jewels (which occupy exactly one square), which are the projections
of dimers parallel to @xmath , as shown in Figure 3.1 . A white (resp.
black) jewel is a jewel that happens in a white (resp. black) square; we
write @xmath if @xmath is black, and @xmath if it is white.

Thus, the resulting drawing can be seen as a set of disjoint plane
cycles (projections of dimers that are not parallel to @xmath maintain
their orientations) together with jewels. A cycle is called trivial if
it has length @xmath . In order to construct @xmath , consider a jewel
@xmath , and let @xmath , where the sum is taken over all the cycles
@xmath in the associated drawing, and @xmath denotes the winding number
of @xmath around @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

For instance, for the tiling @xmath in Figure 3.1 , @xmath . For now,
define the twist of a tiling to be @xmath (see Chapter 4 for a general
definition).

We now show that @xmath is, in fact, flip invariant.

###### Proposition 3.1.

Let @xmath be a duplex region, and let @xmath be a tiling of @xmath . If
@xmath is obtained from @xmath by performing a single flip on @xmath ,
then @xmath .

###### Proof.

Let us consider the tiling @xmath and its associated drawing as a plane
tiling with jewels; we want to see how this drawing is altered by a
single flip. We will split the proof into cases, and the reader may find
it easier to follow by looking at Figure 3.2 .

###### Case 1.

A flip that takes two non- @xmath dominoes which are in the same
position in both floors to two adjacent @xmath dominoes (or the reverse
of this flip)

The non- @xmath dominoes have no contribution to @xmath . On the other
hand, the two @xmath dominoes that appear after the flip have opposite
colors (since they are adjacent), and are enclosed by exactly the same
cycles. Hence, their contributions to @xmath cancel out, and thus @xmath
in this case.

###### Case 2.

A flip that is completely contained in one of the floors.

If we look at the effect of such a flip in the associated drawing, two
things can happen:

1.  [label=2.0., ref=2.0]

2.  It connects two cycles that are not enclosed in one another and have
    the same orientation, and creates one larger cycle with the same
    orientation as the original ones, or it is the reverse of such a
    move;

3.  It connects two cycles of opposite orientation such that one cycle
    is enclosed by the other (or it is the reverse of such a flip). The
    new cycle has the same orientation as the outer cycle.

In case 1 , a jewel is enclosed by the new larger cycle if and only if
it is enclosed by exactly one of the two original cycles. Hence, its
contribution is the same in both @xmath and @xmath .

In case 2 , a jewel is enclosed by the new cycle if and only if it is
enclosed by the outer cycle and not enclosed by the inner one. If it is
enclosed by the new cycle, its contribution is the same in @xmath and
@xmath , because the new cycle has the same orientation as the outer
one. On the other hand, if a jewel @xmath is enclosed by both cycles,
their contributions to @xmath cancel out, hence the jewel’s contribution
is also the same in @xmath and @xmath .

Hence, @xmath whenever @xmath and @xmath differ by a single flip. ∎

Notice that in cases 1 and 2 in the proof, one or both of the cycles
involved may be trivial cycles. However, this does not change the
analysis.

### 3.2 General two-story regions

Let @xmath be a two-story region, and let @xmath be the smallest duplex
region containing @xmath . The cubes in @xmath are called holes . If we
project the dominoes of a tiling @xmath into the plane @xmath , we end
up with a set of disjoint (simple) paths, some of which may be cycles,
while others have loose ends: an example is showed in the left of Figure
3.3 (in that case, all nontrivial paths have loose ends).

Notice also that every white (resp. black) hole (regardless of which
floor it is in) creates a loose end in the associated drawing where a
domino is oriented in such a way that it is entering (resp. leaving) the
square, which we call a source (resp sink ): the names source and sink
do not refer to the dominoes, but instead refer to the ghost curves,
which are defined below. Also, sources and sinks do not depend on the
specific tiling and, since the number of black holes must equal the
number of white holes, the number of sources always equals the number of
sinks in a tileable region.

A ghost curve in the associated drawing of @xmath is a curve that
connects a source to a sink and which never touches the closure of a
square that is common to both floors. Since the floors are simply
connected, we can always connect any source to any sink via a ghost
curve: an associated drawing of a tiling @xmath is then the “usual”
associated drawing (from Section 3.1 ) together with a set of ghost
curves such that each source and each sink is in exactly one ghost
curve: this is shown in Figure 3.4 .

For a two-story region @xmath , fix a set of ghost curves such that
every source and every sink intersects exactly one ghost curve.
Therefore, the associated drawing of each tiling @xmath is a set of
cycles and jewels, so that we may define @xmath in the same way as we
did for duplex regions. Namely, for a jewel @xmath , let @xmath denote
the sum of the winding numbers of the newly formed cycles with respect
to that jewel, and set @xmath . One important difference with respect to
Section 3.1 is that the winding number of a cycle with respect to a
jewel is no longer necessarily @xmath or @xmath , but can be any integer
(see Figure 3.5 ).

Strictly speaking, we should have made an explicit reference to the
choice of ghost curves instead of simply writing @xmath . However, it
turns out that the following holds: if @xmath is the invariant
associated with one choice of connection and @xmath is associated with
another, then there exists @xmath such that for every tiling @xmath ,
@xmath .

To see this, fix a tiling @xmath . We want to look at the contributions
of a jewel to @xmath for two given choices of source-sink connections.
Since the exponent of the contribution of a jewel is the sum of the
winding numbers of all the cycles with respect to it, it follows that
the difference of exponents between two choices of connections is the
sum of winding numbers of the cycles formed by putting the ghost curves
from both source-sink connections together in the same picture, as
illustrated in Figure 3.5 . Now this sum of winding numbers is the same
for every jewel: since the set of ghost curves never touches the closure
of a square common to both floors (and the intersection of the two
floors is connected and simply connected), each of the newly formed
cycles must enclose every jewel in the same way. Hence, the effect of
changing the connection is multiplying the contribution of each jewel by
the same integer power of @xmath , and we shall simply write @xmath ,
assuming that the choice of ghost curves is given (and fixed).

###### Proposition 3.2.

Let @xmath be a two-story region, and suppose @xmath is obtained from a
tiling @xmath of @xmath after a single flip. Then @xmath .

###### Proof.

The proof is basically the same as that of Proposition 3.1 . In fact,
for Case 2 (flips contained in one floor) in that proof, literally
nothing changes, whereas Case 1 (flips involving jewels) can only happen
in a pair of squares that are common to both floors. Since the ghost
curves must never touch such squares, it follows that the pair of
adjacent jewels that form a flip position have the same @xmath , hence
their contributions cancel out. ∎

### 3.3 The effect of trits on @xmath

We now turn our attention to the effect of a trit on @xmath . By looking
at Figure 3.6 , we readily observe that a trit affects only the
contribution of the jewel @xmath that takes part in the trit (a trit
always changes the position of precisely one jewel, since it always
involves exactly one domino parallel to @xmath ). Furthermore, it either
pulls a jewel out of a cycle, or pushes it into a cycle, but the jewel
maintains its color. Hence, if @xmath is the contribution of @xmath to
@xmath , then after a trit involving @xmath its contribution becomes
@xmath or @xmath .

A more careful analysis, however, as portrayed in Figure 3.6 , shows
that a positive trit involving a black jewel always changes its
contribution from @xmath to @xmath , and a positive trit involving a
white jewel changes @xmath to @xmath . Hence, we have proven the
following:

###### Proposition 3.3.

Let @xmath and @xmath be two tilings of a region @xmath which has two
simply connected floors, and suppose @xmath is reached from @xmath after
a single positive trit. Then, for some @xmath ,

  -- -------- -- -------
     @xmath      (3.1)
  -- -------- -- -------

A closer look at Equation ( 3.1 ) shows that @xmath whenever @xmath is
reached from @xmath after a single positive trit. This gives the
following easy corollary:

###### Corollary 3.4.

Let @xmath and @xmath be two tilings of a region @xmath with two simply
connected floors, and suppose we can reach @xmath from @xmath after a
sequence @xmath of flips and trits. Then

  -- -------- --
     @xmath   
  -- -------- --

### 3.4 Examples

For the examples below, we wrote programs in the C @xmath language.

###### Example 3.5 (The @xmath box).

The @xmath box is the smallest box whose space of domino tilings is not
connected by flips (this can proved using techniques from Chapter 4 ),
and it has @xmath tilings: the tiling @xmath shown in Figure 1.4 has
twist @xmath and is alone in its flip connected component; the tiling
obtained by reflecting @xmath on the plane @xmath has twist @xmath (and
is also alone in its flip connected component). The third component
contains the remaining @xmath tilings, with twist @xmath . This
information is summarized in Table 3.1 . Finally, the space of tilings
is connected by flips and trits (via the trit shown in 1.4 and its
reflection).

###### Example 3.6 (The @xmath box).

The @xmath box has a total of @xmath tilings, and thirteen flip
connected components. Table 3.2 contains information about the
invariants of these connected components.

We readily notice that the invariant does a good job of separating flip
connected components, albeit not a perfect one: the pairs of connected
components 7 and 8, 9 and 11, and 10 and 12 have the same @xmath .

Figure 3.7 shows a diagram of the flip connected components, arranged by
their twists. We also notice that we can always reach a tiling from any
other via a sequence of flips and trits.

###### Example 3.7 (A region with two unequal floors).

Figure 3.8 shows a region with two unequal floors, together with a
choice of how to join sources and sinks. It has @xmath tilings, and
@xmath connected components.

Table 3.3 shows some information about these components and Figure 3.9
shows a diagram of the flip connected components, arranged by their
twists. This graph is not as symmetric as the one in the previous
example; nevertheless, the space of tilings is also connected by flips
and trits in this case.

### 3.5 The invariant in more space

We already know that tilings that are not in the same flip connected
component may have the same polynomial invariant, even in the case with
two equal simply connected floors (see, for instance, Example 3.6 ).
However, as we will see in this section, this is rather a symptom of
lack of space than anything else.

More precisely, suppose @xmath is a duplex region and @xmath is a tiling
of @xmath . If @xmath is an @xmath box (or a two-floored box) containing
@xmath , then @xmath can be tiled in an obvious way (using only dominoes
parallel to @xmath ). Thus @xmath induces a tiling @xmath of @xmath that
contains @xmath ; we call this tiling @xmath the embedding of @xmath in
@xmath .

Another way to look at the embedding @xmath of a tiling @xmath is the
following: start with the associated drawing of @xmath (which is a plane
region), add empty squares until you get an @xmath rectangle, and place
a jewel in every empty square. Since the newly added jewels are outside
of any cycle in @xmath , it follows that @xmath , where @xmath is the
number of new black jewels minus the number of new white jewels (which
depends only on the choice of box @xmath and not on the tiling @xmath ).
Our goal for the section is to prove the following:

###### Proposition 3.8.

Let @xmath be a duplex region, and let @xmath be two tilings that have
the same invariant, i.e., @xmath . Then there exists a two-floored box
containing @xmath such that the embeddings @xmath and @xmath of @xmath
and @xmath lie in the same flip connected component.

If @xmath and @xmath already lie in the same flip connected component in
@xmath , then their embeddings @xmath and @xmath in any two-floored box
will also lie in the same connected component, because you can reach
@xmath from @xmath using only flips already available in @xmath .

Also, notice that @xmath if and only if @xmath , because @xmath .
Therefore, Proposition 3.8 states that two tilings have the same
invariant if and only if there exists a two-floored box where their
embeddings lie in the same flip connected component.

The reader might be wondering why we’re restricting ourselves to duplex
regions. One reason is that for general regions with two simply
connected floors, it is not always clear that you can embed them in a
large box in a way that their complement is tileable, let alone tileable
in a natural way.

Although it is technically possible to prove Proposition 3.8 only by
looking at associated drawings, it will be useful to introduce an
alternative formulation for the problem.

Let @xmath be the undirected plane graph whose vertices are the centers
of the squares in the associated drawing of @xmath , and where two
vertices are joined by an edge if their Euclidean distance is exactly
@xmath . A system of cycles , or sock , in @xmath is a (finite) directed
subgraph of @xmath consisting only of disjoint oriented (simple) cycles.
An edge of a sock is an (oriented) edge of one of the cycles, whereas a
jewel is a vertex of @xmath that is not contained in the system of
cycles.

There is an “almost” one-to-one correspondence between the systems of
cycles of @xmath and the tilings of @xmath , which is illustrated in
Figure 3.11 . In fact, tilings with trivial cycles have no direct
interpretation as a system of cycles; but since all trivial cycles can
be flipped into a pair of adjacent jewels, we can think that every sock
represents a set of tilings, all in the same flip connected component.

We would now like to capture the notion of a flip from the world of
tilings to the world of socks. This turns out to be rather simple: a
flip move on a sock is one of three types of moves that take one sock
into another, shown in Figure 3.12 . Notice that performing a flip move
on a sock corresponds to performing one or more flips on its
corresponding tiling.

A flip homotopy in @xmath between two socks @xmath and @xmath is a
finite sequence of flip moves taking @xmath into @xmath . If there
exists a flip homotopy between two socks, they are said to be flip
homotopic in @xmath . Notice that two tilings are in the same flip
connected component of @xmath if and only if their corresponding socks
are flip homotopic in @xmath , because every flip can be represented as
one of the flip moves (and the flip that takes a trivial cycle into two
jewels does not alter the corresponding sock). Figure 3.13 shows
examples of flips and their corresponding flip moves.

One advantage of this new interpretation is that we can easily add as
much space as we need without an explicit reference to a box. In fact,
notice that @xmath is a subgraph of the infinite graph @xmath , so that
a sock in @xmath is also a finite subgraph of @xmath , so that we may
see it as a system of cycles in @xmath .

###### Lemma 3.9.

For two tilings @xmath and @xmath of a region @xmath , the following
assertions are equivalent:

1.   [label=()]

2.   There exists a two-floored box @xmath containing @xmath such that
    the embeddings of @xmath and @xmath in @xmath lie in the same flip
    connected component.

3.   The corresponding systems of cycles of @xmath and @xmath are flip
    homotopic in @xmath .

###### Proof.

To see that 2 implies 1 , notice the following: if @xmath are the socks
involved in the flip homotopy between the socks of @xmath and @xmath in
@xmath , let @xmath be a sufficiently large two-floored box such that
@xmath contains only vertices of @xmath that are jewels in all the
@xmath socks @xmath . Then the socks of @xmath and @xmath are flip
homotopic in @xmath , so the embeddings of @xmath and @xmath lie in the
same flip connected component.

The converse is obvious, since if the socks of @xmath and @xmath are
flip homotopic in @xmath for some two-floored box @xmath , then they are
flip homotopic in @xmath . ∎

A vertex @xmath is said to be white (resp. black) if the sum of its
coordinates is even (resp. odd), and we write @xmath (resp. @xmath ). If
@xmath is a system of cycles in @xmath , we define the graph invariant
of @xmath as

  -- -------- --
     @xmath   
  -- -------- --

where @xmath is the sum of the winding numbers of all the cycles in
@xmath (as curves) with respect to @xmath ; this is a finite sum because
the number of jewels enclosed by cycles of @xmath is finite. Notice that
if @xmath is a tiling of @xmath and @xmath is its corresponding sock in
@xmath , @xmath , so that @xmath is completely determined by @xmath .
Conversely, @xmath : since @xmath equals the number of black squares
minus the number of white squares in @xmath (thus does not depend on
@xmath ), it follows that @xmath is also completely determined by @xmath
and @xmath .

A corollary of Proposition 3.1 is that if two systems of cycles @xmath
and @xmath are flip homotopic in @xmath , then @xmath . We now set out
to prove that the converse also holds, which will establish Proposition
3.8 .

A boxed jewel is a subgraph of @xmath formed by a single jewel enclosed
by a number of square cycles (cycles that are squares when thought of as
plane curves), all with the same orientation. Figure 3.14 shows examples
of boxed jewels. Working with boxed jewels is easier, for if they have
“free space” in one direction (for instance, if there are no cycles to
the right of it), they can move an arbitrary even distance in that
direction; the simplest case is illustrated in Figure 3.15 . More
complicated boxed jewels move just as easily: we first turn the outer
squares into rectangles, then we move the inner boxed jewel, and finally
we close the outer squares again.

An untangled sock is a sock that contains only boxed jewels, and such
that the center of each boxed jewel is of the form @xmath for some
@xmath (that is, all the enclosed jewels lie in the @xmath axis), as
illustrated in Figure 3.16 . Therefore, each boxed jewel in an untangled
sock moves very easily: it has free space both downwards and upwards.

###### Lemma 3.10.

Two untangled socks that have the same invariant are flip homotopic in
@xmath .

In this and in other proofs, we omit easy (but potentially tedious)
details when we think the picture is sufficiently clear.

###### Proof.

If the two socks consist of precisely the same boxed jewels but in a
different order, then they are clearly flip homotopic, since we can
easily move the jewels around and switch their positions as needed. We
only need to check that boxed jewels that cancel out (that is, they
refer to terms with the same exponent but opposite signs) can be
“dissolved” by flip moves.

In order to see this, start by moving the boxed jewels that cancel out
downwards, then toward each other until they are next to each other, as
illustrated in Figure 3.17 . Once they are next to each other, they can
be elliminated by a sequence of flip moves. Figure 3.18 shows some of
the steps involved in the flip homotopy that eliminates this pair of
cancelling jewels.

∎

If @xmath is a sock, we define the area of @xmath to be the sum of the
areas enclosed by each cycle of @xmath , thought of as a plane curve.
The areas count as positive regardless of the orientation of the cycles.
As an example, the boxed jewels shown in Figure 3.14 have areas @xmath
and @xmath respectively, and the untangled sock in Figure 3.16 has area
@xmath . Naturally, the only sock with zero area is the empty sock (the
sock with no cycles).

The following Lemma is the key step in the proof of Proposition 3.8 :

###### Lemma 3.11.

Every sock is flip homotopic to an untangled sock in @xmath .

###### Proof.

Suppose, by contradiction, that there exists a sock which is not flip
homotopic to an untangled sock. Of all the examples of such socks, pick
one, @xmath , that has minimal area (which is greater than zero, because
the empty sock is already untangled).

Among all the cycles in @xmath , consider the ones who have vertices
that are furthest bottom. Among all these vertices, pick the rightmost
one, which we will call @xmath . In other words, assuming the axis are
as in Figure 1.4 : if @xmath and @xmath , then @xmath .

Clearly @xmath is the right end of a horizontal edge, and the bottom end
of a vertical edge, as portrayed in Figure 3.19 . We may assume without
loss of generality that these edges are oriented as in the
aforementioned Figure.

Consider the diagonal of the form @xmath , starting from @xmath and
pointing northwest, and let @xmath be the first point (that is, the one
with the smallest @xmath ) in this diagonal that is not the right end of
a horizontal edge pointing to the right and the bottom end of a vertical
edge pointing up (see Figure 3.20 ).

We will now see that if @xmath is not a jewel, then we can immediately
reduce the area of @xmath with a single flip move. This leads to a
contradiction, because the sock obtained after this flip move cannot be
flip homotopic to an untangled sock, but has smaller area than @xmath .

Suppose @xmath is not a jewel. With Figure 3.20 in mind, consider the
vertex directly below @xmath . It is either the bottom end of a vertical
edge pointing downward (case 1), or the right end of a horizontal edge
pointing to the right. In case 1, a single flip move of type (a) will
immediately reduce the area, as shown in the first drawing in Figure
3.21 . The other three drawings handle all the possibilities for the
other case (again, we omit the easy details): notice that in each case
there is a flip move that reduces the area.

The most interesting case is when @xmath is a jewel. The key observation
here is that the jewel may be then “extracted” from all the cycles as a
boxed jewel, and what remains has smaller area. Figure 3.22 illustrates
the steps involved in extracting a jewel.

Suppose @xmath is a jewel. As in Figure 3.22 , the jewel @xmath can be
extracted via flip moves. We first pull the cycles downward with flip
moves of type @xmath and then “cut” each cycle (innermost cycles first)
with flip moves of type @xmath , so that the jewel leaves the cycles as
a boxed jewel (easy details are left to the reader). Let @xmath be the
sock obtained at the end of this flip homotopy, and let @xmath be the
sock consisting of all the cycles of @xmath except the extracted boxed
jewel. Clearly the area of @xmath is less than the area of @xmath , and
since @xmath is a sock that has minimal area among those that are not
flip homotopic to an untangled sock, it follows that there exists a flip
homotopy, say @xmath such that @xmath is an untangled sock.

Let @xmath . Recall that boxed jewels can move an arbitrary even
distance if they have free space in some direction; by the definition of
@xmath , there can be no cycles or cycle parts below @xmath in @xmath ,
so we can define @xmath (homotopic to @xmath ) by pulling the extracted
jewel in @xmath down as much as we need, namely so that all vertices of
the boxed jewel have @xmath coordinate strictly larger than @xmath .
Notice that @xmath is obtained from @xmath by removing this boxed jewel.
Clearly we can perform on @xmath all the flip moves that took @xmath to
@xmath , so that we obtain a flip homotopy @xmath , where @xmath
consists of all the cycles in @xmath plus a single boxed jewel down
below. The other cycles in @xmath are also boxed jewels whose centers
have @xmath coordinate equal to zero, because @xmath is untangled;
therefore, the boxed jewel down below can be brought up and sideways as
needed, thus obtaining a flip homotopy from @xmath to an untangled sock
@xmath . This contradicts the initial hypothesis, and thus the proof is
complete. ∎

This proof also yields an algorithm for finding the flip homotopy from
an arbitrary sock to an untangled sock, although probably not a very
efficient one. Start with the initial sock, and find @xmath and @xmath
as in the proof. If @xmath is not a jewel, perform the flip move that
reduces the area, and recursively untangle this new sock. If @xmath is a
jewel, extract the boxed jewel, recursively untangle the sock without
the boxed jewel (which has smaller area), and calculate how much space
you needed to solve it: this will tell how far down the boxed jewel
needs to be pulled. The algorithm stops recursing when we reach a sock
with zero area: all that’s left to do then is to “organize” the boxed
jewels.

###### Proof of Proposition 3.8.

Let @xmath and @xmath be two tilings of a duplex region, and suppose
@xmath . Let @xmath and @xmath denote their corresponding socks in
@xmath . Since @xmath , it follows by Lemma 3.11 that @xmath and @xmath
are flip homotopic to untangled socks @xmath and @xmath . By 3.10 ,
@xmath and @xmath are flip homotopic in @xmath , and therefore so are
@xmath and @xmath . Finally, by Lemma 3.9 , there exists a two-floored
box such that the embeddings @xmath and @xmath of @xmath and @xmath lie
in the same flip connected component. ∎

As a conclusion, the polynomial invariant here presented is, in a sense,
complete: if two tilings have the same invariant and sufficient space is
added to the region, then there is a sequence of flips taking one to the
other.

### 3.6 Connectivity by flips and trits

In Section 3.4 , we pointed out that the graph of flip connected
components for Examples 3.6 and 3.7 , shown in Figures 3.7 and 3.9 , is
connected in both cases. There, two components are joined if there
exists a trit taking a tiling in one component to a tiling in the other.
Hence, this graph is connected if and only if for any two tilings of the
given region, we can reach one from the other using flips and trits.

A natural question is, therefore: for two-story regions, is it true that
one can always reach a tiling from any other via flips and trits? The
answer is, in general, no, as Figure 3.23 shows.

Nevertheless, this is true for duplex regions:

###### Proposition 3.12.

If @xmath is a duplex region and @xmath are two tilings of @xmath ,
there exists a sequence of flips and trits taking @xmath to @xmath .

In order to prove this result, we’ll once again make use of the concept
of systems of cycles, or socks, that were introduced in Section 3.5 .

Understanding the effect of a trit on a sock turns out to be quite easy:
in fact, the effect of a trit can be captured to the world of socks via
the insertion of a new move, which we will call the trit move (in
addition to the three flip moves shown in Figure 3.12 ). The trit move
is shown in Figure 3.24 .

Another way to look at trit moves is that it either pulls a jewel out of
a cycle or pushes one into a cycle. Two socks @xmath and @xmath are flip
and trit homotopic in a graph @xmath (which contains both @xmath and
@xmath ) if there is a finite sequence of flip and/or trit moves taking
@xmath to @xmath . Notice that, unlike in Section 3.5 , where we were
mainly interested in flip homotopies in @xmath , we are now interested
in flip and trit homotopies in the finite graphs @xmath . Recall from
Section 3.5 that if @xmath is a duplex region, @xmath is the planar
graph whose vertices are the centers of the squares in the associated
drawing of @xmath , and where two vertices are joined by an edge if
their Euclidean distance is exactly @xmath .

Again, for two tilings @xmath , there exists a sequence of flips and
trits taking @xmath to @xmath if and only if their corresponding socks
are flip and trit homotopic in @xmath .

###### Lemma 3.13.

If @xmath is duplex region, and @xmath is a sock in @xmath , then @xmath
is flip and trit homotopic to the empty sock (the sock with no cycles)
in @xmath .

###### Proof.

Suppose, by contradiction, that there exists a sock contained in @xmath
that is not flip and trit homotopic to the empty sock in @xmath . Of all
the examples of such socks, let @xmath be one with minimal area (the
concept of area of a sock was defined in Section 3.5 ). We will show
that there exists either a flip move or a trit move that reduces the
area of @xmath , which is a contradiction.

Let @xmath be a cycle of @xmath such that there is no other cycle inside
@xmath : hence, if there is any vertex enclosed by @xmath , it must be a
jewel. Similar to the proof of Lemma 3.11 , let @xmath be the rightmost
among the bottommost vertices of @xmath (notice that we are only
considering the vertices of @xmath , and not all the vertices in @xmath
), or, in other words: if @xmath and @xmath , let @xmath . Notice that
@xmath is the right end of a horizontal edge and the bottom end of a
vertical edge: we may assume without loss of generality that this
horizontal edge points to the right.

Notice that the vertex @xmath is necessarily in the graph @xmath ,
because otherwise @xmath would have a hole inside, which contradicts the
hypothesis that the (identical) floors of @xmath are simply connected.
Suppose first that @xmath is not a jewel. Since there are no cycles
inside @xmath , it follows that @xmath must be a vertex of @xmath . If
@xmath is the topmost end of a vertical edge poiting downward, we have
the first case in Figure 3.25 , where we clearly have a flip move that
reduces the area. If this is not the case, it follows, in particular,
that @xmath must be in the graph @xmath : Cases (2) and (3) of Figure
3.25 show the two possibilities for the edges that are incident to
@xmath , and it is clear that there exists a flip move which reduces the
area of @xmath .

Finally, the case where @xmath is a jewel is shown in case (4) of Figure
3.25 : the available trit move clearly reduces the area. Hence, there is
always a flip or trit move that reduces the area of the sock, which
contradicts the minimality of the area of @xmath . ∎

Therefore, we have established Proposition 3.12 . Another observation is
that the above proof also yields an algorithm for finding the flip and
trit homotopy from a sock to the empty sock: while there is still some
cycle in the sock, find one cycle that contains no other cycle. Then
find @xmath , as in the proof, and do the corresponding flip or trit
move, depending on the case. Since each move reduces the area, it
follows that we’ll eventually reach the only sock with zero area, which
is the empty sock.

### 3.7 The invariant when more floors are added

In this section, we’ll discuss the fact that the invariant @xmath is not
preserved when the tilings are embedded in “big” regions with more than
two floors.

As in Section 3.5 , we’ll consider duplex regions. Recall from that
section that we defined the embedding of such a tiling in a two-floored
box @xmath . Here, we’ll extend this notion to embeddings in boxes with
four floors in a rather straightforward manner.

If @xmath is a tiling of a duplex region @xmath , and @xmath is a box
with four floors such that @xmath is contained in the top two floors of
@xmath , then the embedding @xmath of @xmath in @xmath is the tiling
obtained by first embedding @xmath in the top two floors of @xmath (as
in Section 3.5 ), and then filling the bottom two floors with dominoes
parallel to @xmath . This is illustrated in Figure 3.26 .

###### Proposition 3.14.

If @xmath and @xmath are two tilings of a duplex region and @xmath ,
then there exists a box with four floors @xmath such that the embeddings
of @xmath and @xmath in @xmath lie in the same flip connected component.

Proposition 3.14 is essentially stating that the invariant @xmath no
longer survives when more floors are added, although the twist @xmath
still does, as we will see in Chapter 4 . The converse of Proposition
3.14 , i.e., the fact that the twist is invariant by flips, follows from
item 1 of Proposition 4.6 .

Recall from Section 3.5 the definitions of boxed jewel and sock. The key
fact in the proof of Proposition 3.14 is that a boxed jewel associated
to a @xmath term in @xmath can be transformed into a number of smaller
boxed jewels, their terms adding up to @xmath . In what follows, the
sign of a boxed jewel is the sign of its contribution to @xmath (i.e.,
@xmath if the jewel is black, and @xmath if it is white) and its degree
is the number of cycles it contains, if all the cycles spin
counterclockwise; it is minus this number if all the cycles are
clockwise. In other words, if @xmath is a tiling of a two-floored region
whose sock is untangled and @xmath is the set of boxed jewels in this
sock, then

  -- -------- --
     @xmath   
  -- -------- --

where @xmath , @xmath is the sign of @xmath and @xmath , its degree.

###### Lemma 3.15.

If @xmath and @xmath are tilings of a two-floored region such that their
associated socks are both untangled (consist only of boxed jewels) and:

1.   [label=()]

2.   The associated sock of @xmath consists of a single boxed jewel of
    degree @xmath .

3.   The associated sock of @xmath consists of @xmath boxed jewels of
    degree @xmath and same sign as the boxed jewel in @xmath .

Then there exists a box with four floors @xmath where their embeddings
lie in the same connected components.

###### Proof.

We omit some easy details, but Figure 3.27 illustrates the key step in
the proof: that the innermost boxed jewel can be transported to the
bottom two floors via flips. If the box @xmath is big enough, the
innermost boxed jewel can freely move in the bottom two floors, and can
eventually be brought back up outside of any other cycles. Since after
this maneuver the bottom two floors are back as they originally were,
the result of this maneuver is the embedding of a tiling whose sock is
flip homotopic to an untangled sock with two boxed jewels, one with
degree @xmath and another with degree @xmath (but both have the same
sign as the original boxed jewel). Proceeding by induction and using
Proposition 3.8 , we obtain the result. ∎

Therefore, boxed jewels with degree @xmath (resp. degree @xmath ) can be
flipped into @xmath boxed jewels with degree @xmath (resp. @xmath ). It
only remains to see that boxed jewels with degrees @xmath and @xmath and
same sign cancel out.

###### Lemma 3.16.

If @xmath is a tiling of a duplex region whose sock is untangled and
consists of two boxed jewels with degrees @xmath and @xmath but same
sign, then there exists a box with four floors where the embedding of
@xmath is in the same flip connected component as the tiling consisting
only of “jewels”, that is, the tiling containing only dominoes parallel
to @xmath .

###### Proof.

The basic procedure is illustrated in Figure 3.28 . First, one jewel can
be transported to the bottom floor using the procedure in Figure 3.27 .
There it can be moved so that it is right under the other boxed jewel,
when they can easily be flipped into a tiling with all dominoes parallel
to @xmath . ∎

In short, what Lemmas 3.15 and 3.16 imply is that a tiling @xmath whose
sock is untangled and whose invariant is @xmath can be embedded in a box
with four floors in such a way that this embedding is in the same flip
connected component as the embedding of another tiling @xmath (of a
duplex region) whose sock is untangled and whose invariant is @xmath .

###### Proof of Proposition 3.14.

Let @xmath and @xmath be two tilings of a duplex region such that @xmath
. By Lemmas 3.11 and 3.9 , there exists a two-floored box @xmath where
the embeddings of @xmath and @xmath are in the same connected component,
respectively, as @xmath and @xmath , two tilings whose sock is
untangled. By Lemmas 3.15 and 3.16 and the previous paragraph, there
exists a box with four floors @xmath where the embeddings of @xmath and
@xmath lie in the same connected component, respectively, as the
embeddings of @xmath and @xmath (of the same duplex region), with
invariants @xmath and @xmath . Since @xmath , it follows that @xmath and
so @xmath . By Proposition 3.8 , the box @xmath can be chosen such that
the embeddings of @xmath and @xmath lie in the same flip connected
component; this concludes the proof. ∎

## Chapter 4 The general case

Most of the material in this chapter is also covered in [ segundoartigo
] .

### 4.1 The twist for cylinders

For a domino @xmath , define @xmath to be the center of the black cube
contained in @xmath minus the center of the white one. We sometimes draw
@xmath as an arrow pointing from the center of the white cube to the
center of the black one.

For a set @xmath and @xmath , we define the ( open ) @xmath - shade of
@xmath as

  -- -------- --
     @xmath   
  -- -------- --

where @xmath denotes the interior of @xmath . The closed @xmath - shade
@xmath is the closure of @xmath . We shall only refer to @xmath -shades
of unions of basic cubes or basic squares, such as dominoes.

Given two dominoes @xmath and @xmath of @xmath , we define the effect of
@xmath on @xmath along @xmath , as:

  -- -------- --
     @xmath   
  -- -------- --

In other words, @xmath is zero unless the following three things happen:
@xmath intersects the @xmath -shade of @xmath ; neither @xmath nor
@xmath are parallel to @xmath ; and @xmath is not parallel to @xmath .
When @xmath is not zero, it’s either @xmath or @xmath depending on the
orientations of @xmath and @xmath .

For example, in Figure 4.1 , for @xmath , the yellow domino @xmath has
no effect on any other domino: @xmath for every domino @xmath in the
tiling. The green domino @xmath , however, affects the two dominoes in
the rightmost floor which intersect its @xmath -shade, and @xmath for
both these dominoes.

If @xmath is a tiling, we define the @xmath - pretwist as

  -- -------- --
     @xmath   
  -- -------- --

For example, the tiling on the left of Figure 1.4 has @xmath -pretwist
equal to @xmath . To see this, notice that each of the four dominoes of
the leftmost floor that are not parallel to @xmath has nonzero effect
along @xmath on exactly one domino of the rightmost floor, and this
effect is @xmath in each case. The reader may also check that the @xmath
-pretwist of the tiling in Figure 4.1 is @xmath .

###### Lemma 4.1.

For any pair of dominoes @xmath and @xmath and any @xmath , @xmath . In
particular, for a tiling @xmath of a region we have @xmath .

###### Proof.

Just notice that @xmath if and only if @xmath and @xmath . ∎

Translating both dominoes by a vector with integer coordinates clearly
does not affect @xmath , as @xmath . Therefore, if @xmath is a tiling
and @xmath , where @xmath , then @xmath .

###### Lemma 4.2.

Let @xmath be a region, and let @xmath . Consider the reflection @xmath
; notice that @xmath is a region. If @xmath is a tiling of @xmath and
@xmath , then the tiling @xmath of @xmath satisfies @xmath .

###### Proof.

Given a domino @xmath of @xmath , notice that @xmath and that @xmath .
Therefore, @xmath and

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Therefore, @xmath and thus @xmath . Since @xmath , Lemma 4.1 implies
that @xmath , completing the proof. ∎

A natural question at this point concerns how the choice of @xmath
affects @xmath . It turns out that it will take us some preparation
before we can tackle this question.

###### Proposition 4.3.

If @xmath is a cylinder and @xmath is a tiling of @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Follows directly from Propositions 4.24 and 4.31 below. ∎

This result doesn’t hold in pseudocylinders or in more general simply
connected regions; see Section 4.8 for counterexamples.

###### Definition 4.4.

For a tiling @xmath of a cylinder @xmath , we define the twist @xmath as

  -- -------- --
     @xmath   
  -- -------- --

Until Section 4.4 , we will not use Proposition 4.3 , and will only
refer to pretwists.

Let @xmath , and let @xmath be such that @xmath . A region @xmath is
said to be fully balanced with respect to @xmath if for each square
@xmath , where @xmath and @xmath , each of the two sets @xmath and
@xmath contains as many black cubes as white ones. In other words,

  -- -------- --
     @xmath   
  -- -------- --

@xmath is fully balanced if it is fully balanced with respect to each
@xmath .

###### Lemma 4.5.

Every pseudocylinder (in particular, every cylinder) is fully balanced.

###### Proof.

Let @xmath be a pseudocylinder with base @xmath and depth @xmath , let
@xmath and let @xmath , where @xmath is such that @xmath and @xmath .
Consider @xmath .

If @xmath is the axis of the pseudocylinder, then @xmath , for some
square @xmath and some @xmath . Now @xmath , which clearly contains
@xmath black cubes and @xmath white ones; similarly, @xmath contains
@xmath black cubes and @xmath white ones.

If @xmath is perpendicular to the axis of the pseudocylinder, assume
without loss of generality that @xmath is the axis. Let @xmath denote
the orthogonal projection on @xmath , and let @xmath , which are planar
regions, since they are unions of squares of @xmath . If @xmath , we
have @xmath , which clearly has the same number of black squares as
white ones. ∎

###### Proposition 4.6.

Let @xmath be a region that is fully balanced with respect to @xmath .

1.   [label= (),topsep = 0.1px]

2.  If a tiling @xmath of @xmath is reached from @xmath after a flip,
    then @xmath

3.  If a tiling @xmath of @xmath is reached from @xmath after a single
    positive trit, then @xmath .

###### Proof.

In this proof, @xmath points towards the paper in all the drawings. We
begin by proving 1 . Suppose a flip takes the dominoes @xmath and @xmath
in @xmath to @xmath and @xmath in @xmath . Notice that @xmath and @xmath
. For each domino @xmath , define

  -- -------- --
     @xmath   
  -- -------- --

Notice that

  -- -------- --
     @xmath   
  -- -------- --

###### Case 1.

Either @xmath or @xmath is parallel to @xmath .

Assume, without loss of generality, that @xmath (and thus also @xmath )
is parallel to @xmath . By definition, @xmath for each domino @xmath .
Now notice that @xmath and @xmath are parallel and in adjacent floors
(see Figure 4.2 ) : since @xmath , it follows that @xmath for each
domino @xmath , so that @xmath and thus @xmath .

###### Case 2.

Neither @xmath nor @xmath is parallel to @xmath .

In this case, @xmath for some square @xmath of side @xmath and normal
vector @xmath .

Notice that @xmath ; let @xmath .

Let @xmath be a domino that is completely contained in @xmath : we claim
that @xmath . This is obvious if @xmath is parallel to @xmath ; if not,
we can switch the roles of @xmath and @xmath if necessary and assume
that @xmath is parallel to @xmath , which implies that @xmath . Now
notice that @xmath is in the @xmath -shades of both @xmath and @xmath ,
so that @xmath . Hence, if @xmath (or if @xmath ), @xmath .

For dominoes @xmath that intersect @xmath but are not contained in it,
first observe that by switching the roles of @xmath and @xmath and
switching the colors of the cubes (i.e., translating) if necessary, we
may assume that the vectors are as shown in Figure (a)a . By looking at
Figure (b)b and working out the possible cases, we see that

  -- -------- --
     @xmath   
  -- -------- --

Now for such dominoes, @xmath points away from the region if and only if
@xmath intersects a white cube of @xmath , and points into the region if
and only if @xmath intersects a black cube in @xmath : hence,

  -- -------- --
     @xmath   
  -- -------- --

because @xmath is fully balanced with respect to @xmath . A completely
symmetrical argument shows that @xmath , so we are done.

We now prove 2 . Suppose @xmath is reached from @xmath after a single
positive trit. By rotating @xmath and @xmath in the plane @xmath (notice
that this does not change @xmath ), we may assume without loss of
generality that the dominoes involved in the positive trit are as shown
in Figure (a)a . Moreover, by translating if necessary, we may assume
that the vectors @xmath are as shown in Figure 4.4 .

A trit involves three dominoes, no two of them parallel. Since dominoes
parallel to @xmath have no effect along @xmath , we consider only the
four dominoes involved in the trit that are not parallel to @xmath :
@xmath , and @xmath . Define @xmath with the same formulas as before.

By looking at Figure 2.1 , the reader will see that @xmath and @xmath .

Let @xmath : @xmath is shown in Figure 4.4 . @xmath contains a single
square @xmath of side @xmath and normal vector @xmath . Define @xmath ,
and notice that (see Figure 4.4 ) @xmath , where @xmath are three basic
cubes: if we look at the arrows in Figure 4.4 , we see that two of them
are white and one is black. Since @xmath is fully balanced with respect
to @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

By looking at Figure 4.4 , we see that we have a situation that is very
similar to Figure (b)b ; for each @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

(when we say that @xmath points into or away from @xmath , we are
assuming that @xmath intersects one cube of @xmath ). Hence,

  -- -------- --
     @xmath   
  -- -------- --

A completely symmetrical argument shows that @xmath , and hence

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

which completes the proof. ∎

### 4.2 Topological groundwork for the twist

In this section, we develop a topological interpretation of tilings and
twists. Dominoes are (temporarily) replaced by dimers, which, although
formally different objects, are really just a different way of looking
at dominoes. Although we will tend to work with dimers in this and the
following section, we may in later sections switch back and forth
between these two viewpoints.

We will now give some useful (but somewhat technical) definitions. The
reader that is familiar with perfect matchings in graphs may find it
easier to follow by recalling that domino tilings of a region can be
seen as perfect matchings of a dual bipartite graph, and that the
symmetric difference of two perfect matchings of the same graph is a
disjoint set of cycles: we want to look at these cycles as oriented
curves in @xmath .

Let @xmath be a region. A segment @xmath of @xmath is a straight line of
unit length connecting the centers of two cubes of @xmath ; in other
words, @xmath with @xmath , where @xmath and @xmath are the centers of
two cubes that share a face: this segment is a dimer if @xmath is the
center of a white cube. We define @xmath (compare this with the
definition of @xmath for a domino @xmath ). If @xmath is a segment,
@xmath denotes the segment @xmath : notice that either @xmath or @xmath
is a dimer.

Two segments @xmath and @xmath are adjacent if @xmath (here we make the
usual abuse of notation of identifying a curve with its image in @xmath
); nonadjacent segments are disjoint . In particular, a segment is
always adjacent to itself.

A tiling of @xmath by dimers is a set of pairwise disjoint dimers such
that the center of each cube of @xmath belongs to exactly one dimer of
@xmath . If @xmath is a tiling, @xmath denotes the set of segments
@xmath .

Given a map @xmath , a segment @xmath and an integer @xmath , we abuse
notation by making the identification @xmath if @xmath for each @xmath .
A curve of @xmath is a map @xmath such that @xmath is (identified with)
a segment of @xmath for @xmath . We make yet another abuse of notation
by also thinking of @xmath as a sequence or set of segments of @xmath ,
and we shall write @xmath to denote that @xmath for some @xmath .

A curve @xmath of @xmath is closed if @xmath ; it is simple if @xmath is
injective in @xmath . A closed curve @xmath of @xmath is called trivial
: notice that, in this case, @xmath (when identified with their
respective segments of @xmath ). A discrete rotation on @xmath is a
function @xmath with @xmath , for a fixed @xmath . If @xmath and @xmath
are two closed curves, we say @xmath if @xmath and @xmath for some
discrete rotation @xmath on @xmath .

Given two tilings @xmath and @xmath , there exists a unique (up to
discrete rotations) finite set of disjoint closed curves @xmath such
that @xmath and such that every nontrivial @xmath is simple. Figure 4.7
shows an example. We define @xmath .

Translating effects from the world of dominoes to the world of dimers is
relatively straightforward. For @xmath , @xmath will denote the
orthogonal projection on the plane @xmath . Given two segments @xmath
and @xmath , we set:

  -- -------- --
     @xmath   
  -- -------- --

Notice that this definition is analogous to the one given in Section 4.1
for dominoes.

The definition of @xmath is given in terms of the orthogonal projection
@xmath . From a topological viewpoint, however, this projection is not
ideal, because it gives rise to nontransversal intersections between
projections of segments. In order to solve this problem, we consider
small perturbations of these projections.

Recall that @xmath is the set of positively oriented basis @xmath with
vectors in @xmath . If @xmath and @xmath , @xmath will be used to denote
the projection on the plane @xmath whose kernel is the subspace (line)
generated by the vector @xmath . For instance, if @xmath is the
canonical basis, @xmath . Notice that @xmath is the orthogonal
projection on the plane @xmath , and, for small @xmath , @xmath is a
nonorthogonal projection on @xmath which is a slight perturbation of
@xmath .

Given @xmath , @xmath and small nonzero @xmath , set the slanted effect

  -- -------- --
     @xmath   
  -- -------- --

Recall from knot theory the concept of crossing (see, e.g., [ knotbook ,
p.18] ). Namely, if @xmath , @xmath are two continuous curves, @xmath
and @xmath is a projection from @xmath to a plane, then @xmath is a
crossing if @xmath but @xmath . If, furthermore, @xmath is of class
@xmath in @xmath and the vectors @xmath , @xmath and @xmath are linearly
independent, then the crossing is transversal ; its sign is the sign of
@xmath . We are particularly interested in the case where the curves are
segments of a region @xmath .

For a region @xmath and @xmath , we define the @xmath - length of @xmath
as

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma 4.7.

Let @xmath be a region, and fix @xmath . Let @xmath be the @xmath
-length of @xmath , and let @xmath with @xmath . Then @xmath if and only
if there exist @xmath such that @xmath but @xmath .

Moreover, if the latter condition holds for @xmath , then @xmath is a
transversal crossing whose sign is given by @xmath .

###### Proof.

Suppose @xmath . We may without loss of generality assume @xmath . By
definition, we have @xmath for some @xmath and @xmath . Since @xmath ,
we have

  -- -------- --
     @xmath   
  -- -------- --

and thus @xmath .

Conversely, suppose @xmath but @xmath : this can be rephrased as

  -- -------- -- -------
     @xmath      (4.1)
  -- -------- -- -------

for some @xmath . Notice that @xmath , so that @xmath .

We now observe that @xmath . Suppose, by contradiction, that @xmath .
Then, at least one of the following statements must be true: @xmath ; or
@xmath . Assume that the first statement holds (i.e., @xmath ). By
definition of segment, @xmath . By taking the inner product with @xmath
on both sides of ( 4.1 ), @xmath . Now @xmath , so that @xmath . Since
@xmath , @xmath and thus @xmath , which is a contradiction.

Finally, since @xmath , we have @xmath . From the definition of @xmath ,
we see that @xmath .

To see the last claim, we first note that @xmath : since @xmath , we may
take the inner product with @xmath on both sides of ( 4.1 ) to get that
@xmath equals either @xmath or @xmath , and hence @xmath . Since @xmath
, this proves that @xmath is a transversal crossing. If @xmath , the
sign of this crossing is given by the sign of @xmath . By switching the
roles of @xmath and @xmath if necessary, we may assume that @xmath , so
that this sign equals @xmath , completing the proof. ∎

###### Lemma 4.8.

Let @xmath be a region, and let @xmath . Let @xmath denote the @xmath
-length of @xmath , and suppose @xmath . Given two segments @xmath and
@xmath ,

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We may assume that @xmath and that @xmath (otherwise both sides would be
zero). Since rotations in the @xmath plane leave both sides unchanged,
we may assume that @xmath , @xmath (see Figure 4.5 ).

Our strategy is to show these two facts:

1.  [label=()]

2.  If @xmath for some @xmath , then @xmath .

3.  If @xmath , then there exists a unique @xmath such that @xmath .

Once we prove 1 and 2 , we get the result.

Let @xmath , and consider the closed sets

  -- -------- --
     @xmath   
  -- -------- --

Notice that @xmath if and only if @xmath , and @xmath if and only if
@xmath .

Suppose @xmath for some @xmath , and let @xmath . If @xmath , @xmath
implies, by Lemma 4.7 , that @xmath . Hence, there must exist @xmath
such that @xmath , a contradiction. Therefore, we must have @xmath , so
that @xmath . We have proved 1 .

Now suppose @xmath , that is, @xmath for some @xmath . Clearly @xmath ;
for simplicity, assume that @xmath (the other cases are analogous). Now
for any @xmath , @xmath . Thus, given @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

which occurs if and only if @xmath and @xmath : this determines a unique
@xmath , so we have proved 2 . ∎

If @xmath and @xmath are two sets of segments (curves are also seen as
sets of segments), @xmath , define

  -- -------- --
     @xmath   
  -- -------- --

For shortness, @xmath and @xmath .

Consider two disjoint simple closed curves @xmath and a projection
@xmath from @xmath to some plane. Assume there exists finitely many
crossings @xmath , all transversal. Recall from knot theory (see, e.g.,
[ knotbook , pp. 18–19] ) that the linking number @xmath equals half the
sum of the signs of all these crossings.

###### Lemma 4.9.

Let @xmath and @xmath be two disjoint simple closed curves of a region
@xmath . Fix @xmath , and let @xmath denote the @xmath -length of @xmath
. Then

1.   [label= (),topsep=0.1em]

2.  If @xmath , @xmath .

3.  @xmath

###### Proof.

By Lemma 4.7 , the sum of signs of the crossings is given by @xmath ,
which establishes 1 . Also, 2 follows from 1 and Lemma 4.8 . ∎

###### Lemma 4.10.

Let @xmath and @xmath be two segments of @xmath , and let @xmath be a
vector such that @xmath . Then these two statements are equivalent:

1.   [label= ()]

2.  There exist @xmath such that @xmath .

3.  There exist @xmath and @xmath such that @xmath and @xmath with
    @xmath and @xmath .

###### Proof.

First, suppose 1 holds. If @xmath and @xmath are not adjacent, then
@xmath , which is a contradiction. Thus, @xmath and @xmath are adjacent,
and thus @xmath for some @xmath : then

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

that is, @xmath with @xmath , which implies that @xmath and @xmath .
Also, since @xmath , we can take @xmath .

For the other direction, suppose 2 holds, so that @xmath for some @xmath
. Then setting @xmath and @xmath , we have @xmath and @xmath ∎

For a map @xmath and a vector @xmath , let @xmath denote the translation
of @xmath by @xmath .

###### Lemma 4.11.

Let @xmath be a curve of @xmath , let @xmath , and let @xmath . If
@xmath and @xmath , then the curves @xmath and @xmath are disjoint.

Notice that @xmath is not a curve of @xmath .

###### Proof.

Suppose, by contradiction, that there exist @xmath (the domain of @xmath
) such that @xmath Let @xmath be such that @xmath , and set @xmath .
Since @xmath is a curve of @xmath , @xmath are segments of @xmath such
that @xmath . By Lemma 4.10 , @xmath , which means that at least one of
the three coordinates of @xmath is zero: this contradicts the fact that
@xmath . ∎

Consider a simple closed curve @xmath and a vector @xmath , @xmath .
Assume that there exists @xmath such that for each @xmath , the curves
@xmath and @xmath are disjoint. Then define the directional writhing
number in the direction @xmath by @xmath (see [ writhingNumber , §3] ).
Since @xmath is symmetric and invariant by translations, @xmath .

###### Lemma 4.12.

Fix @xmath , and let @xmath be a simple closed curve of @xmath . If
@xmath , where @xmath is the @xmath -length of @xmath , then @xmath

###### Proof.

We would like to use the fact that the sums of the signs of the
crossings of the orthogonal projection of a smooth curve in the
direction of a vector @xmath equals its directional writhing number (in
the direction of @xmath ): this is essentially what we’re trying to
prove for our curve, except that @xmath is not the orthogonal projection
and that @xmath is not a smooth curve. However, these difficulties can
be avoided, as the following paragraphs show.

The orthogonality of the projection makes no real difference, because
the orthogonal projection in the direction of @xmath has the same kernel
as @xmath , so the crossings occur in the same positions (and clearly
have the same signs). Therefore, by Lemma 4.7 , @xmath equals the sums
of the signs of the crossings of the aforementioned orthogonal
projection.

For the smoothness of the curve, there is a finite number of points
where @xmath is not smooth: precisely, the set of @xmath such that the
two segments of @xmath that intersect at @xmath are not parallel. To
simplify notation, let @xmath be the domain of @xmath , and for @xmath
let @xmath be the segment of @xmath such that @xmath (notice that @xmath
). It is also convenient to set @xmath , so that @xmath .

Recall from Lemma 4.7 that every crossing in the projections occur in
the interiors of the segments: since the number of segments is finite,
we can pick @xmath sufficiently small so that @xmath contains no
crossings, where @xmath

Let @xmath be a nondecreasing @xmath function such that @xmath whenever
@xmath and @xmath whenever @xmath . Let @xmath . Consider the smooth
simple closed curve of @xmath , @xmath , given by

  -- -------- --
     @xmath   
  -- -------- --

To simplify notation, write @xmath and fix @xmath , so that @xmath . By
Lemma 4.11 , @xmath and @xmath are disjoint whenever @xmath .

Clearly, the sums of the signs of the crossings in the orthogonal
projection of @xmath equals that of @xmath ; moreover, @xmath for
sufficiently small @xmath . Since @xmath is smooth, @xmath . ∎

The following rather technical Lemma will be used in the proof of Lemma
4.14 :

###### Lemma 4.13.

Let @xmath , and let @xmath and @xmath be two segments of a region
@xmath whose @xmath -length is @xmath . Let @xmath with @xmath and
@xmath . Let @xmath .

If, for some @xmath , @xmath , then @xmath and @xmath are not parallel,
and @xmath .

###### Proof.

Suppose @xmath . Let @xmath , so that @xmath .

Suppose, by contradiction, that at least one of these things occurs:

1.  [label=(), topsep = 0.1px, itemsep = 0.1px]

2.  @xmath and @xmath are parallel;

3.  @xmath or @xmath .

We claim that at least two of the three @xmath ’s are integers. To see
this, suppose first 1 , so that @xmath , so that for @xmath , @xmath .
On the other hand, if 2 holds, say @xmath , then @xmath and @xmath , so
that, again, for @xmath , @xmath .

We claim that @xmath . In fact, if @xmath then we would have @xmath , so
that @xmath and @xmath , which is a contradiction.

Therefore, we must have @xmath Then @xmath , so @xmath . Thus @xmath but
@xmath , which is a contradiction. ∎

The following definition is specific for Lemmas 4.14 and 4.18 . Let
@xmath be a simple closed curve of a region @xmath and @xmath . For
@xmath , set @xmath , and set also @xmath . Finally, we define

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma 4.14.

Let @xmath be a simple closed curve of a region @xmath . For @xmath ,
set @xmath , and set also @xmath ; for shortness, write @xmath . Then if
@xmath and @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

We may assume that @xmath . Let @xmath and set @xmath . By Lemma 4.11 ,
@xmath depends only on the signs of @xmath , @xmath and @xmath .
Therefore, we may, without loss of generality, assume that @xmath is
sufficiently small such that for every @xmath and every @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

(this is possible by Lemma 4.13 ). Therefore, clearly @xmath equals the
number of pairs of segments @xmath such that @xmath for every @xmath and
such that the crossing changes its sign as @xmath goes from @xmath to
@xmath . Now a crossing may only change its sign if @xmath for some
@xmath : by Lemma 4.11 , this can only happen if @xmath .

By Lemma 4.10 , @xmath if and only if for some @xmath , @xmath and
@xmath , with @xmath . Since @xmath and @xmath are segments of the
simple curve @xmath , they can only be adjacent if, for some @xmath ,
@xmath . Now, @xmath , so that @xmath with either @xmath or @xmath
(depending on which is @xmath and which is @xmath ). Since @xmath , this
implies that @xmath and, therefore, @xmath .

We now analyze each of the four possible cases for @xmath (as an ordered
pair). When @xmath , so that @xmath we see a situation as illustrated in
Figure (a)a (perhaps with both orientations reversed): when @xmath , we
have a positive crossing; when @xmath , we have a negative crossing.
Figure (b)b illustrates (up to orientation) the case @xmath ( @xmath :
negative crossing for @xmath , and positive crossing for @xmath . These
observations yield the result. ∎

### 4.3 Writhe formula for the twist

Now that the groundwork is done, we set out to obtain a new formula for
the twist of pseudocylinders of even depth (we work with pseudocylinders
because the hypothesis of simple connectivity will not play any role).
Pseudocylinders of even depth have the advantage of always admitting a
tiling such that all dimers are parallel to its axis: for a @xmath
-pseudocylinder @xmath ( @xmath ) with even depth, let @xmath denote the
tiling such that every dimer is parallel to @xmath (see Figure 4.7 ).
Not only does this tiling trivially satisfy @xmath , but also for any
segment @xmath of @xmath and any dimer @xmath we have @xmath . This
allows for a direct interpretation of the twist via a set of curves,
which, in particular, allows us to show that it is an integer.

###### Lemma 4.15.

Given @xmath , let @xmath be a tiling of a @xmath -pseudocylinder of
even depth @xmath , and let @xmath . If @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Clearly,

  -- -------- --
     @xmath   
  -- -------- --

the last equality holding by Lemma 4.9 . ∎

For Lemmas 4.16 and 4.17 , assume @xmath , @xmath is a tiling of a
@xmath -pseudocylinder with even depth @xmath , and @xmath .

###### Lemma 4.16.

Fix @xmath such that @xmath . If @xmath is a curve of @xmath and @xmath
and @xmath , then @xmath .

Notice that the case @xmath follows from Lemma 4.11 .

###### Proof.

Let @xmath Suppose, by contradiction, that @xmath and @xmath are not
disjoint, and let @xmath and @xmath be two segments of @xmath such that
@xmath for some @xmath . By Lemma 4.10 , @xmath and @xmath must be
adjacent, so that at least one of these two segments is in @xmath ,
hence parallel to @xmath . Lemma 4.10 also implies that @xmath . Since
at least one of @xmath is parallel to @xmath , it follows that @xmath or
@xmath , which contradicts the hypothesis. ∎

By Lemma 4.16 , if @xmath , @xmath is defined whenever @xmath . Set

  -- -------- --
     @xmath   
  -- -------- --

Clearly,

  -- -------- -- -------
     @xmath      (4.2)
  -- -------- -- -------

###### Lemma 4.17.

If @xmath is a curve of @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Fix @xmath with @xmath , and let @xmath denote the @xmath -length of the
pseudocylinder (which is equal to its depth). By Lemmas 4.8 and 4.12 ,
given @xmath

  -- -------- --
     @xmath   
  -- -------- --

Equation ( 4.2 ) completes the proof. ∎

###### Lemma 4.18.

Let @xmath , and let @xmath be a tiling of a @xmath -pseudocylinder with
even depth. If @xmath is a curve of @xmath , then @xmath .

###### Proof.

Pick @xmath with @xmath . Assume without loss of generality that @xmath
, @xmath . If @xmath , set @xmath for @xmath , and set @xmath .

By definition and using Lemma 4.14 , @xmath We need to look at @xmath
such that @xmath , i.e., @xmath . Since every segment of @xmath is
parallel to @xmath , we need to look at every segment of @xmath that is
parallel to @xmath .

For each segment @xmath of @xmath with @xmath , let @xmath , so that
@xmath . If @xmath is odd, then, by definition of @xmath , @xmath , so
that either @xmath or @xmath . Making a similar analysis for @xmath
even, we see that @xmath . Working with congruence modulo @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

which completes the proof. ∎

###### Proposition 4.19.

If @xmath , @xmath is a @xmath -pseudocylinder with even depth, @xmath
is a tiling of @xmath , @xmath and @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Follows directly from Lemmas 4.15 , 4.17 and 4.18 . ∎

### 4.4 Different directions of projection

Our goal for this section is to prove Proposition 4.3 , that is, that
all pretwists coincide for a cylinder.

###### Lemma 4.20.

Let @xmath , and let @xmath be a @xmath -pseudocylinder with even depth.
Let @xmath be a tiling of @xmath , and let @xmath be the tiling such
that every dimer is parallel to @xmath . If @xmath , then @xmath

###### Proof.

Suppose @xmath . Clearly,

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be the @xmath -length of @xmath and @xmath . Let @xmath such
that @xmath . Then, by Lemmas 4.8 and 4.12 ,

  -- -------- --
     @xmath   
  -- -------- --

By Equation ( 4.2 ) and Proposition 4.19 ,

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Lemma 4.21.

Let @xmath be a box that has at least one even dimension, and let @xmath
be a tiling of @xmath . Then @xmath .

###### Proof.

By rotating, we may assume that @xmath is even, so that @xmath is a
@xmath -cylinder with even depth; let @xmath . We want to show that
@xmath .

By Lemma 4.20 , @xmath . Now,

  -- -------- --
     @xmath   
  -- -------- --

@xmath because all segments of @xmath are parallel. It remains to show
that @xmath , which yields the result.

Let @xmath . Given @xmath , we now want to show that @xmath . This is
obvious if @xmath is not parallel to @xmath . Otherwise, effects cancel
out, as illustrated in Figure 4.8 .

∎

If @xmath is a basic square and @xmath is a normal vector for @xmath ,
define the color of @xmath to be the same as the color of the basic cube
@xmath ; and

  -- -------- --
     @xmath   
  -- -------- --

Recall the definition of @xmath -shade from Section 4.1 . If @xmath is a
set of segments or a set of dominoes, @xmath and @xmath is a basic
square with normal @xmath , we set

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma 4.22.

Let @xmath be a @xmath -cylinder ( @xmath ) with base @xmath and even
depth @xmath . Let @xmath be a basic square, @xmath , let @xmath be a
tiling of @xmath and let @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

The reader may want to follow by looking at Figure 4.9 . Let @xmath ,
@xmath , and for each @xmath , let @xmath denote @xmath . Clearly,

  -- -------- --
     @xmath   
  -- -------- --

Let @xmath be the center of the square @xmath , and let @xmath denote
the orthogonal projection on @xmath . For each @xmath , @xmath is a
polygonal curve, so that the winding number of @xmath around @xmath
equals (see, e.g., [ polygonalWindingNumber ] for an algorithmic
discussion of winding numbers)

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

But @xmath ( @xmath and @xmath is simply connected), so we get the
result. ∎

###### Remark 4.23.

The fact that

  -- -------- --
     @xmath   
  -- -------- --

(using the notation in the proof of Lemma 4.22 ) also holds in
pseudocylinders, as the hypothesis of simply connected is only needed in
the last step of the proof. In fact, if we define the flux @xmath (
@xmath runs through all the basic squares not contained in @xmath ,
@xmath runs through all the curves in @xmath ), then a modification in
the proof of Proposition 4.24 yields that @xmath (in particular, since
@xmath , the three pretwists are integers).

###### Proposition 4.24.

Let @xmath be even, and suppose @xmath is a cylinder with depth @xmath .
If @xmath is a tiling of @xmath , then @xmath .

###### Proof.

Suppose @xmath , where @xmath is simply connected and @xmath is the axis
of the cylinder. Let @xmath be a rectangle with vertices in @xmath such
that @xmath : this implies that the box @xmath . Let @xmath . We want to
show that @xmath .

Let @xmath be a tiling of @xmath , and let @xmath be the tiling of
@xmath such that every dimer is parallel to @xmath . Applying Lemma 4.21
to the box @xmath , we see that @xmath : it remains to show that @xmath
.

Let @xmath be the tiling of @xmath such that every domino is parallel to
@xmath , and let @xmath be a basic square such that @xmath . Let @xmath
be the set of @xmath dominoes of @xmath contained in @xmath : we have

  -- -------- --
     @xmath   
  -- -------- --

Notice that, for every domino @xmath , @xmath . Moreover, the dominoes
in @xmath are precisely the ones that intersect the @xmath -shade of at
least one domino of @xmath , so that

  -- -------- --
     @xmath   
  -- -------- --

which equals @xmath by Lemma 4.22 . Analogously (the first equality
below uses Lemma 4.1 ),

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath (by Proposition 4.19 ), we have completed the proof. ∎

###### Lemma 4.25.

Let @xmath be odd, and let @xmath be a cylinder with depth @xmath that
admits a tiling @xmath . Then @xmath .

In fact, we prove in Proposition 4.31 that @xmath , but for our proof
this first step is needed. Also, it is not clear when a cylinder with
odd depth @xmath is tileable: see Lemma 4.28 for a related result.

###### Proof.

Suppose @xmath has base @xmath and axis @xmath , so that @xmath , and
let @xmath , @xmath . Let @xmath be a tiling of @xmath . We want to show
that @xmath .

Consider @xmath , and the tiling @xmath of @xmath which consists of two
copies @xmath and @xmath of @xmath , where @xmath tiles the subregion
@xmath and @xmath tiles the subregion @xmath .

By Proposition 4.24 , @xmath . Now clearly @xmath , because the @xmath
-shades of dimers of @xmath do not intersect dimers of @xmath (and
vice-versa). We need to prove that @xmath .

Notice that @xmath . Let @xmath , @xmath be dominoes, and let @xmath and
@xmath be the dominoes of @xmath that they “refer to”. If @xmath , then
clearly

  -- -------- --
     @xmath   
  -- -------- --

and @xmath Therefore, @xmath . Consequently, @xmath and thus @xmath .

Moreover, since @xmath and @xmath , it follows that @xmath , which
completes the proof. ∎

###### Remark 4.26.

The statement of Lemma 4.25 (and also of Proposition 4.3 ) also holds
for pseudocylinders with odd depth. The key observation is that if
@xmath is the tiling obtained by stacking two copies of @xmath , one
above the other, then @xmath (see Remark 4.23 for the definition of the
flux @xmath ).

###### Lemma 4.27.

Let @xmath be a planar region, and let @xmath be the normal vector for
@xmath . For each @xmath , write @xmath . If @xmath , then for each
@xmath and every pair of tilings @xmath of @xmath , @xmath of @xmath ,
@xmath .

Should @xmath or @xmath not be tileable, the statement is vacuously
true.

###### Proof.

By Lemma 4.25 , it suffices to show the result for @xmath . Let @xmath
and @xmath be tilings of @xmath and @xmath , respectively. Consider the
cylinder with even depth @xmath , and let @xmath denote the tiling of
@xmath which is a copy of @xmath . If @xmath , then @xmath , by
Proposition 4.24 . Also, since @xmath , @xmath , so that

  -- -------- --
     @xmath   
  -- -------- --

Since, by Lemma 4.25 , @xmath , we’re done. ∎

###### Lemma 4.28.

Let @xmath be a basic plane with normal @xmath , and let @xmath be a
planar region with connected interior such that

  -- -------- --
     @xmath   
  -- -------- --

Then there exists a tiling @xmath of @xmath such that @xmath .

Notice that, with Lemma 4.28 , the proof of Proposition 4.3 is complete.
However, we need some preparation before we can prove Lemma 4.28 .

It is a well-known fact that domino tilings of a region can be seen as
perfect matchings of a related graph: in fact, if we consider the graph
whose vertices are centers of the cubes (squares in the planar case) of
the region, and where two vertices are joined if their Euclidean
distance is @xmath , then a domino tiling can be directly translated as
a perfect matching in this graph. This graph is called the associated
graph of a region @xmath (planar or spatial), and denoted @xmath . Since
the proof of Lemma 4.28 will come more naturally in the setting of
matchings in associated graphs, we shall revert to this viewpoint for
what follows.

A bicoloring of a graph @xmath is a coloring of each vertex of @xmath as
black or white, in such a way that no two adjacent vertices have the
same color. Associated graphs for a region @xmath are always bicolored:
each vertex inherits the color of the cube (or square) it refers to. For
what follows, we shall assume that all graphs are already bicolored.
Moreover, any subgraph of a bicolored graph @xmath (for instance, the
one obtained after deleting a vertex) shall inherit the bicoloring of
@xmath .

###### Lemma 4.29.

Let @xmath be a bicolored tree. If all leaves are white, then the number
of white vertices in @xmath is strictly larger than the number of black
vertices in @xmath .

By definition, a tree is connected and, therefore, nonempty.

###### Proof.

We proceed by induction on the number of vertices. The result is clearly
true if @xmath has three or fewer vertices. Suppose, by induction, that
the result holds for balanced trees with @xmath vertices for any @xmath
. Let @xmath be a tree with @xmath vertices such that all leaves are
white.

Let @xmath be a (white) leaf, and let @xmath be the only neighbor of
@xmath . Let @xmath be the forest obtained by deleting @xmath and @xmath
: @xmath is nonempty, otherwise @xmath would have to be a black leaf,
which contradicts the hypothesis. Now for each connected component
@xmath of @xmath , @xmath is a tree with less than @xmath vertices such
that all leaves are white: therefore, by induction, @xmath has more
white vertices than black vertices. However, the vertices of @xmath are
those of @xmath plus one black vertex ( @xmath ) and one white vertex (
@xmath ), so that the number of white vertices in @xmath is greater than
that of black ones. By induction, we get the result. ∎

A connected bicolored graph @xmath is balanced if the number of white
vertices equals the number of black ones. By Lemma 4.29 , a balanced
tree must have at least one white leaf and one black leaf.

A perfect matching of a bipartite graph @xmath is a set of pairwise
disjoint edges of @xmath , such that every vertex is adjacent to
(exactly) one of the edges in the matching. Clearly, a necessary
condition for the existence of a perfect matching is that @xmath is
balanced.

Let @xmath be a bicolored graph (in this notation, @xmath is the vertex
set of @xmath , and @xmath is its edge set), and let @xmath . Let @xmath
, where @xmath consists of all edges connecting @xmath and @xmath , for
each @xmath and @xmath , plus the edges connecting @xmath and @xmath for
each @xmath whenever the edge @xmath . The color of a vertex @xmath
equals the color of @xmath if and only if @xmath is even. Naturally, if
@xmath is a planar region with normal @xmath , then @xmath .

Let @xmath be a (nonempty) balanced connected bicolored graph with
@xmath vertices. Algorithm 1 finds a perfect matching @xmath of @xmath .

Pick a spanning tree @xmath for @xmath . @xmath @xmath is a balanced
tree

@xmath

@xmath

@xmath

while @xmath do

Pick a white leaf @xmath and a black leaf @xmath of @xmath
@xmath Lemma 4.29 ensures that a balanced tree has at least one white
leaf and one black leaf

Pick a path @xmath in @xmath from @xmath to @xmath
@xmath i.e., @xmath ; notice that @xmath is necessarily even

@xmath

@xmath
@xmath Here @xmath means the edge @xmath , i.e., the edge between the
vertices @xmath and @xmath

@xmath

@xmath
@xmath Notice that @xmath is still a balanced tree (except in the last
iteration, when it is empty)

@xmath

end while

@xmath

Algorithm 1 Algorithm for finding a perfect matching @xmath of @xmath .

###### Lemma 4.30.

If @xmath is a connected bicolored balanced graph with @xmath vertices,
then the set of edges @xmath generated by running Algorithm 1 on @xmath
is a perfect matching of @xmath .

###### Proof.

To see that @xmath , notice that any spanning tree has @xmath vertices,
and exactly two vertices are deleted in each iteration, so that the last
iteration where @xmath occurs when @xmath . In all other iterations
(i.e., @xmath ), clearly any edge created is contained in @xmath . When
@xmath , @xmath is a balanced tree with two vertices, so @xmath and only
the edges @xmath plus the edge @xmath are created. Now these edges are
contained in @xmath , so we’re done.

This proves that @xmath is a subset of the edgeset of @xmath . The
reader will easily convince himself that it is a perfect matching (i.e.,
that every vertex @xmath of @xmath is adjacent to exactly one edge of
@xmath ). ∎

Next we shall prove Lemma 4.28 . In order to make the explanation
clearer, we shall first introduce a few concepts. Let @xmath be a
bicolored connected balanced graph, and consider the perfect matching
@xmath of @xmath obtained by running Algorithm 1 on @xmath , as well as
the intermediate objects that were created, such as @xmath and @xmath .

Given an edge @xmath of @xmath , we say @xmath is adjacent to @xmath and
to @xmath (even though it is not an edge of @xmath ). For @xmath and
@xmath , we write @xmath .

Consider the paths @xmath chosen in each step of the algorithm (we shall
also use this notation in the proof). If @xmath , we say that a path
@xmath meets @xmath at @xmath if @xmath for some @xmath , but @xmath .
Analogously, @xmath leaves @xmath at @xmath if @xmath for some @xmath ,
but @xmath . Notice that a path @xmath can meet and leave @xmath at the
same vertex @xmath . Also, notice that @xmath can only meet (resp.
leave) @xmath at most once (i.e., at no more than one vertex).

###### Proof of Lemma 4.28.

Consider the graph @xmath associated with the planar region @xmath .
Clearly @xmath is balanced; since @xmath has connected interior, it
follows that @xmath is also connected. Let @xmath be the perfect
matching obtained after running Algorithm 1 on @xmath , and let @xmath
be the tiling of @xmath associated with @xmath .

If @xmath , we will abuse notation and write @xmath , where @xmath is
the domino associated with @xmath : we also say that two edges are
parallel if their associated dominoes are parallel.

Notice that the only dominoes that are not parallel to @xmath are those
associated with the edges of @xmath for each @xmath : therefore,

  -- -------- --
     @xmath   
  -- -------- --

Fix @xmath . We want to show that @xmath . First, write

  -- -------- --
     @xmath   
  -- -------- --

we may ignore @xmath and @xmath because they are deleted from the tree
in step @xmath , so that @xmath for each @xmath (for @xmath , it
contains only one edge, so there is also no effect).

For @xmath , @xmath , we claim that, modulo @xmath , @xmath equals

  -- -------- --
     @xmath   
  -- -------- --

(in other words, their difference is an integer).

If the two edges in @xmath are parallel (i.e., @xmath goes straight at
@xmath ), then @xmath . By checking a number of cases (see Figure (a)a )
we see that the following holds for each @xmath :

  -- -------- -- -------
     @xmath      (4.3)
  -- -------- -- -------

If the two edges in @xmath are not parallel (i.e., @xmath makes a turn
at @xmath ), we proceed as follows: assume that the path @xmath makes a
left turn and that @xmath is a black vertex (the other cases are
analogous). Let @xmath be the step where @xmath is chosen as the black
leaf to be deleted (so that @xmath ): again, inspection of a few
possible cases (some of which are shown in Figure (b)b ) shows that (
4.3 ) holds for @xmath (and for @xmath , obviously @xmath ). Also,
@xmath (because it is a left turn and @xmath is black), and (see the
last two examples in Figure (b)b )

  -- -------- --
     @xmath   
  -- -------- --

so that @xmath if and only if @xmath meets @xmath at @xmath (and @xmath
otherwise), so that we get the result.

Now let @xmath To finish the proof, we need to show that

  -- -------- --
     @xmath   
  -- -------- --

is even. Because all @xmath ’s are paths in a tree @xmath , it follows
that each path meets (or leaves) @xmath at most once. Therefore, each
@xmath may contribute @xmath (if it never meets nor leaves @xmath ),
@xmath (if it either meets or leaves @xmath , but not both) or @xmath
(if it meets and leaves @xmath ) to the above sum. This contribution is
@xmath if @xmath ; it is @xmath or @xmath if @xmath . If exactly one of
the two is in @xmath , the contribution is @xmath ; however, since
@xmath it follows that @xmath is even, so that @xmath is an integer. ∎

We sum up our main results in the following proposition:

###### Proposition 4.31.

Let @xmath be a planar region with normal vector @xmath and connected
interior such that

  -- -------- --
     @xmath   
  -- -------- --

Then @xmath is tileable. Moreover, for each @xmath such that @xmath is
tileable (in particular, for each @xmath ), every tiling @xmath of
@xmath satisfies @xmath .

###### Proof.

Follows directly from Lemmas 4.25 , 4.27 and 4.28 . ∎

Now that we have seen that the twist, as in Definition 4.4 , is
well-defined for cylinders, we may adopt the notation @xmath when @xmath
is a tiling of a cylinder.

### 4.5 Additive properties and proof of Theorem 3

The goal for this section is to discuss some additive properties of the
twist and to complete the proof of Theorem 3 .

###### Lemma 4.32.

Let @xmath and @xmath be two regions whose interiors are disjoint. Let
@xmath and @xmath be two tilings of @xmath and @xmath and @xmath be two
tilings of @xmath . For each @xmath , set @xmath , which is a tiling of
@xmath . Let @xmath , @xmath . Then, for each @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

In particular, if @xmath or @xmath is simply connected, then @xmath .

###### Proof.

For shortness, given two sets of segments @xmath and @xmath , we shall
in this proof write @xmath .

For each @xmath we have

  -- -------- --
     @xmath   
  -- -------- --

Notice that the last term is the only one that depends on both @xmath
and @xmath , so that it is the only one that does not cancel out in the
sum @xmath . Therefore, we have

  -- -------- --
     @xmath   
     @xmath   
  -- -------- --

Since for each pair @xmath in the sum we have @xmath , it follows that
@xmath . Hence, by Lemma 4.9 , @xmath , which yields the result. ∎

###### Corollary 4.33.

Let @xmath be a simply connected region, and suppose that there exists a
box @xmath such that @xmath is tileable. If @xmath are two tilings of
@xmath and @xmath are two tilings of @xmath , then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Use Lemma 4.32 with @xmath , @xmath . ∎

###### Lemma 4.34.

Suppose @xmath are even positive integers, and let @xmath . If @xmath is
a cylinder with even depth, then there exists a tiling @xmath of @xmath
such that @xmath for each tiling @xmath of @xmath .

Corollary 4.33 and Lemma 4.34 imply that for any tiling @xmath of @xmath
, there exists a constant @xmath such that, for any tiling @xmath of
@xmath , @xmath .

###### Proof.

We may without loss of generality assume that the axis of @xmath is
@xmath , so that @xmath , where @xmath and @xmath is even.

Let @xmath . Clearly there exists a tiling @xmath of @xmath such that
every domino is parallel to @xmath : hence, @xmath for each tiling
@xmath of @xmath . On the other hand, since @xmath is even, there exists
a tiling @xmath of @xmath such that every dimer is parallel to @xmath ,
so that @xmath for each tiling @xmath of @xmath . Setting @xmath we get
the result. ∎

###### Lemma 4.35.

Let @xmath be a tileable cylinder with base @xmath , axis @xmath and
depth @xmath . Let @xmath be a cylinder with even depth formed by two
copies of @xmath ; let @xmath be a box with all dimensions even. Then
there exist a tiling @xmath of @xmath and a constant @xmath such that,
for each tiling @xmath of @xmath , @xmath

###### Proof.

By Lemma 4.34 , there exists a tiling @xmath of @xmath such that @xmath
for each tiling @xmath of @xmath . Fix a tiling @xmath of @xmath (which
is tileable because @xmath is tileable). If we set @xmath and @xmath ,
then for every tiling @xmath of @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

the last equality holding by fixing @xmath , @xmath and writing @xmath .
∎

###### Proof of Theorem 3.

The twist is constructed in Definition 4.4 and its integrality follows
from Proposition 4.3 . Lemma 4.5 and Proposition 4.6 yield items 1 and 2
. To see item 3 , let @xmath be a duplex region with axis @xmath , and
consider the tiling @xmath such that all dominoes are parallel to @xmath
: clearly @xmath (we assume that the reader is familiar with the
notation from Chapter 3 ). Since the space of domino tilings of @xmath
is connected by flips and trits (by Theorem 1 ), Proposition 4.6 ,
together with Theorems 1 and 2 , implies that for each tiling @xmath of
@xmath , @xmath (for a more direct proof of item 3 , see Section 4.7 ).

We’re left with proving item 4 . Let @xmath be a cylinder, and suppose
@xmath , where each @xmath is a cylinder (they need not have the same
axis) and @xmath if @xmath . Suppose the bases, axes and depths are
respectively, @xmath and @xmath .

Let @xmath and @xmath be two tilings of @xmath . It suffices to show
that

  -- -------- --
     @xmath   
  -- -------- --

For @xmath , let @xmath . We want to show that @xmath .

Let @xmath be a box with all dimensions even such that @xmath and @xmath
for @xmath . By Lemma 4.35 , there exist: a tiling @xmath of @xmath and
a constant @xmath ; and for each @xmath , a tiling @xmath of @xmath and
a constant @xmath such that @xmath for each tiling @xmath of @xmath ,
and @xmath for each tiling @xmath of @xmath .

Write @xmath for each @xmath , so that @xmath is a tiling of @xmath .
Notice that, for @xmath , @xmath and @xmath Therefore, we have

  -- -------- --
     @xmath   
     @xmath   
     @xmath   
     @xmath   
  -- -------- --

Equality @xmath holds by Corollary 4.33 , because @xmath and @xmath are
two tilings of @xmath . ∎

### 4.6 Embeddable regions

We shall now describe a simple generalization of the twist to a wider
class of simply connected regions. An embedding of a region @xmath is a
triple @xmath , where @xmath is a box and @xmath is a tiling of @xmath .
A region @xmath is said to be embeddable if it admits an embedding.

###### Lemma 4.36.

Let @xmath be a simply connected region and suppose @xmath and @xmath
are two embeddings of @xmath . If @xmath are two tilings of @xmath ,
then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Let @xmath be a box containing @xmath and @xmath such that all its
dimensions are even. Since @xmath and @xmath are tileable boxes, at
least one of their dimensions is even: by Lemma 4.34 , there exist
tilings @xmath of @xmath and @xmath of @xmath such that @xmath and
@xmath for every tiling @xmath of @xmath and @xmath of @xmath .
Therefore,

  -- -------- --
     @xmath   
  -- -------- --

Notice that @xmath and @xmath are two tilings of @xmath . By Corollary
4.33 ,

  -- -------- --
     @xmath   
  -- -------- --

and hence @xmath ∎

Given a simply connected embeddable region @xmath and two tilings @xmath
, define the relative twist @xmath , where @xmath is any embedding of
@xmath . Moreover, if we fix a base tiling @xmath , then the function
@xmath is an invariant with the same properties as the twist in
cylinders (for instance, items 1 , 2 and 4 in Theorem 3 ); and different
choices of base tiling alter this function by an additive constant.

###### Example 4.37 (Cylinders).

If @xmath is a cylinder, then @xmath for any two tilings of @xmath (this
follows directly from Lemma 4.35 ).

A natural question at this point is: “how large” is the class of
tileable embeddable simply connected regions? Since the box @xmath can
be chosen to be as large as needed, it is clear that embeddable regions
are, in fact, very common: for instance, if the complement of @xmath
does not contain any narrow areas (where space is limited), @xmath will
almost certainly be embeddable. However, there exist simply connected
(and even contractible) regions that are not embeddable: Figure 4.11
shows an example. Notice that the complement of @xmath contains a narrow
area where cubes of one color happen in much larger number.

### 4.7 The twist for duplex regions

In this section, we provide an alternative proof for the following fact:

###### Proposition 4.38.

If @xmath is a duplex region, then, for any tiling @xmath of @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

The equality @xmath above is a special case of Proposition 4.3 . We
shall now give an independent proof of this equality in the particular
case of duplex regions.

Let @xmath be a duplex region. Let @xmath be a tiling of @xmath , and
let @xmath be its corresponding sock in @xmath . For @xmath and a cycle
@xmath of @xmath , let @xmath be the winding number of @xmath , thought
of as a curve in @xmath , around @xmath . Clearly we can write our
invariant @xmath as

  -- -------- -- -------
     @xmath      (4.4)
  -- -------- -- -------

where the sum in the exponent of @xmath is taken over all the cycles in
@xmath that do not contain @xmath . Notice that

  -- -------- --
     @xmath   
  -- -------- --

###### Lemma 4.39.

If @xmath is a @xmath -duplex region with associated graph @xmath ,
@xmath and @xmath is a tiling of @xmath with corresponding sock @xmath ,
then @xmath .

###### Proof.

Two dominoes that are not parallel to @xmath have no effect along @xmath
on one another. Therefore, we only consider pairs of dominoes where one
is parallel to @xmath , that is, refers to a jewel of @xmath .

If @xmath is a cycle of @xmath and @xmath is a jewel, one way of
computing @xmath is to count (with signs) the intersections of @xmath
with the half-line @xmath . Thus, if @xmath denotes the domino
containing @xmath and @xmath means that @xmath refers to an edge of
@xmath , then @xmath Thus,

  -- -------- --
     @xmath   
  -- -------- --

completing the proof. ∎

We now consider @xmath . Again, let @xmath be a tiling of a duplex
region with corresponding sock @xmath . Let the charge enclosed by a
cycle @xmath of @xmath be

  -- -------- --
     @xmath   
  -- -------- --

so that @xmath Charges can be looked at from a point of view that is
more interesting for our purposes. Given @xmath , consider the set of
four points @xmath i.e., the set of points of the form @xmath . The
metric weight of a vertex @xmath with respect to a cycle @xmath of
@xmath is given by

  -- -------- --
     @xmath   
  -- -------- --

while the topological weight @xmath of @xmath is the (arithmetic)
average of the set @xmath (see Figure 4.12 ).

###### Lemma 4.40.

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Notice that

  -- -------- --
     @xmath   
  -- -------- --

In particular, @xmath Hence,

  -- -------- --
     @xmath   
  -- -------- --

∎

If @xmath is the corresponding sock of a tiling @xmath and @xmath is a
cycle of @xmath , then the angle @xmath of a vertex @xmath is the
difference between the angle of the edge of @xmath leaving @xmath and
the angle of the edge of @xmath entering @xmath , counted in
counterclockwise laps. In other words, a vertex @xmath where the curve
goes straight has angle @xmath , whereas a vertex where a left (resp.
right) turn occurs has angle @xmath (resp. @xmath ), as shown in Figure
4.13 .

The boundary charge of a curve @xmath is @xmath . Notice that

  -- -------- -- -------
     @xmath      (4.5)
  -- -------- -- -------

We now set out to prove that, for each @xmath , @xmath , which will
complete the proof of Proposition 4.38 .

###### Lemma 4.41.

For each cycle @xmath of @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

  -- -------- --
     @xmath   
  -- -------- --

∎

###### Lemma 4.42.

If @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Figure 4.12 illustrates most of the elements needed in this proof. If
@xmath , then @xmath for each @xmath , so @xmath

If @xmath and the curve goes straight at @xmath , then, for some @xmath
, two points in @xmath have winding number @xmath and the other two have
winding number @xmath , so @xmath

If @xmath and the curves turns left at @xmath , then the winding numbers
are @xmath , so @xmath . Analogously, @xmath if @xmath turns right at
@xmath . ∎

###### Lemma 4.43.

For each cycle @xmath of @xmath , @xmath .

###### Proof.

By Lemma 4.42 , the boundary charge of @xmath can also be written as

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
              @xmath   
              @xmath   
  -- -------- -------- --

the fourth equality holding because of Lemma 4.41 ; the last equality is
Lemma 4.40 . ∎

###### Proof of Proposition 4.38.

Lemma 4.43 and Equation ( 4.5 ) imply that @xmath . Together with Lemma
4.39 , this proves the result. ∎

### 4.8 Examples and counterexamples

In this short section, we give a few examples and counterexamples that
help motivate the theory and some of the results obtained.

For instance, when looking at Proposition 4.3 , one might wonder whether
the pretwists are always integers or if they always coincide, at least
for, say, simply connected or contractible regions. This turns out not
to be the case, as Figure (a)a shows: for the tiling @xmath portrayed
there, @xmath but @xmath .

One might ask whether the pretwists coincide in a pseudocylinder (i.e.,
if the base is not necessarily simply connected): the tiling @xmath
portrayed in Figure (b)b satisfies @xmath and @xmath (see Remarks 4.23
and 4.26 for an idea of what can be shown for pseudocylinders in this
respect).

###### Example 4.44 (The @xmath box).

A particularly interesting example is the @xmath box, which has
5051532105 tilings, divided into 93 flip connected components. The
number associated to each component is completely arbitrary, it has to
do with the order in which our computer program found each one. Table
4.1 shows the components in decreasing order of size, whereas Figure
4.15 contains a graph whose vertices are the connected components: it
shows which components are connected via trits.

The reader will find more information in [ webpageNicolau ] . There, he
will find details about each connected component (e.g., pictures of a
sample tiling in each of the components), as well as other examples and
the source code for the C @xmath program used to generate them.

## Chapter 5 Possible values of the twist

Now that we have established (in Proposition 4.19 ) that the twist of a
cylinder is always an integer, we wish to take a closer look at the set
of values that can be the twist of some tiling of a given box. If @xmath
is a box, define @xmath . An easy observation, that follows directly
from Lemma 4.2 , is that @xmath is symmetric with respect to zero, i.e.,
@xmath . In this chapter, our main concern is to provide bounds for the
value @xmath .

###### Lemma 5.1.

Let @xmath be integers, at least one of them even, with @xmath . Then

  -- -- --
        
  -- -- --

###### Proof.

Suppose, without loss of generality, that @xmath , and let @xmath be a
tiling of @xmath . For each @xmath , @xmath , @xmath , let, for @xmath ,
@xmath , and let @xmath be the number of elements of @xmath Notice that
there is a one-to-one correspondence between pairs @xmath such that
@xmath , @xmath , and pairs @xmath such that @xmath ; also, the latter
condition implies that @xmath . For fixed @xmath , the number of such
pairs is @xmath . Therefore,

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , it follows that @xmath , so that

  -- -- --
        
  -- -- --

∎

In Lemma 5.6 below, we use a similar (but more refined) analysis to find
a slightly better upper bound.

### 5.1 Asymptotic lower bounds

We will now describe some constructions that yield asymptotic lower
bounds for @xmath . We begin with an exact description for the
asymptotic behavior in boxes with two floors (Lemma 5.3 ). First,
however, we need an auxiliary construction.

Recall from Section 3.5 the definition of a sock. The eel of thickness
@xmath and length @xmath is a sock in @xmath that consists of @xmath
cycles, with the same orientation, such that each cycle surrounds a set
of @xmath consecutive jewels in a diagonal (and those are the only
jewels each cycle surrounds): Figures 5.1 and 5.2 show examples of eels
of different thicknesses and lengths. Notice that an eel of length
@xmath is a boxed jewel. If @xmath is an eel of thickness @xmath and
length @xmath such that the @xmath jewels are black and the cycles spin
counterclockwise, then @xmath , so that @xmath .

###### Lemma 5.2.

For @xmath , let @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Let @xmath . By Lemma 5.1 , we only need to show that @xmath . Also, let
@xmath , where @xmath consists of all the basic squares completely
contained in the set @xmath (see Figure 5.2 ). Let, for @xmath , @xmath
We claim that @xmath and @xmath satisfy the following inequalities:

  -- -------- -- -------
     @xmath      (5.1)
     @xmath      (5.2)
  -- -------- -- -------

with @xmath .

Figure 5.1 illustrates that we can fit an eel @xmath of thickness @xmath
and length @xmath in @xmath whenever @xmath . Notice that the jewels not
in the eel form two copies of @xmath . Since @xmath for tilings of
duplex regions, it follows that @xmath , which implies ( 5.1 ).

For Equation ( 5.2 ), notice that, whenever @xmath , we can fit an eel
of thickness @xmath and length @xmath in @xmath , as illustrated in
Figure 5.2 . The remaining jewels form three regions: two copies of
@xmath and one copy of @xmath , thus @xmath .

Now let @xmath . We claim that, for all @xmath , @xmath . By ( 5.2 ),

  -- -------- -- -------
     @xmath      (5.3)
  -- -------- -- -------

Now for @xmath , we check (with a computer) that @xmath by recursively
calculating upper bounds for @xmath via ( 5.3 ).

Let @xmath , and assume, by induction, that @xmath whenever @xmath . Let
@xmath . Using the induction hypothesis on @xmath and on @xmath , we get

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath is convex and @xmath , we have

  -- -------- --
     @xmath   
  -- -------- --

Since @xmath , we have @xmath . Thus,

  -- -------- --
     @xmath   
  -- -------- --

Consider the function @xmath , defined on @xmath . It is a simple
exercise to prove that @xmath for @xmath . Also, @xmath and hence @xmath
, establishing the claim.

By ( 5.1 ), @xmath for each @xmath , and thus @xmath . Multiplying by
@xmath and taking the limit, we complete the proof.∎

###### Lemma 5.3.

The following holds:

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Let @xmath , and let @xmath . Fix @xmath . Notice that we can place
@xmath copies of @xmath inside @xmath , so that @xmath . Therefore,

  -- -------- --
     @xmath   
  -- -------- --

Since this inequality holds for any fixed @xmath , we may take the limit
as @xmath to get, by Lemma 5.2 , that

  -- -------- --
     @xmath   
  -- -------- --

yielding the result. ∎

###### Lemma 5.4.

The following holds:

1.   [label= ()]

2.  If @xmath is fixed, then

      -- -- --
            
      -- -- --

3.  -- -------- --
         @xmath   
      -- -------- --

    where the limit is taken over values @xmath and @xmath such that at
    least one of @xmath is even.

###### Proof.

Given @xmath take any even positive integer @xmath such that @xmath . We
shall describe a tiling @xmath of the box @xmath , which is hinted at in
Figure 5.3 . Let @xmath , @xmath , @xmath ,

  -- -------- --
     @xmath   
  -- -------- --

Divide the box @xmath into the following parts (see Figure 5.3 ):

-   The exterior padding area , which is the area in the complement of
    @xmath where the curves make turns.

-   The crossing zones , formed by the subregions @xmath , @xmath ,
    @xmath , where red and blue arrows cross.

-   The transition zones , formed by the areas where purple arrows
    occur: each of these areas form a @xmath or @xmath subregion.

-   The filler , which is the remainder of the box.

The idea for the tiling is as follows: each subregion @xmath , where
@xmath for some @xmath , is tiled in a similar fashion as Figure 5.4 :
the part that “flows horizontally” is formed by @xmath simple paths that
move up and down together such that all horizontal dominoes @xmath have
@xmath parallel to the corresponding arrow in Figure 5.3 (which are also
horizontal in that figure). Similarly, subregions of the form @xmath ,
where @xmath for some @xmath , are tiled similarly to Figure 5.5 : one
clearly sees @xmath paths flowing horizontally, which correspond to
vertical arrows in Figure 5.3 .

Figures 5.4 and 5.5 also make it clear that the paths need a length of
@xmath (for the first kind) and @xmath (second kind) to transition from
top to bottom and vice-versa. Since @xmath , the paths have enough space
to transition: any remaining space is filled with dominoes that are
orthogonal to the paths, as shown in Figure 5.5 (this is possible
because @xmath is even).

Finally, notice that the external padding area has enough space for the
curves to make turns, as indicated in Figure 5.3 . It is also easy to
see that the remainder of the box can be filled in a way that doesn’t
create any @xmath -effects (for instance, since @xmath is even, the
@xmath filler subregions can be tiled in a trivial way).

Let @xmath denote the tiling obtained from this construction: we claim
that, in essence, only @xmath -effects in the contact zones count
towards the twist. To see this, notice that the only areas outside
contact zones where there is nonzero @xmath -effects between dominoes
are the external padding area and (possibly) the transition zones (for
instance, if @xmath and @xmath is odd, there might be nonzero effects
between the dominoes in the path and the dominoes that are used to fill
the remaining space). For the transitions zones, each cycle has an even
number of transitions: since @xmath and @xmath are even, it is easy to
see that the effects from two consecutive transitions cancel out. As for
the external padding zones, the effects in the four corners of the
cycles cancel out if @xmath is even; if @xmath is odd, however, and,
say, @xmath is even (exactly one of @xmath is even), then some effects
that do not cancel, adding up to @xmath .

By construction, the effects in a single @xmath contact zone equal
@xmath . Thus, letting @xmath , we may write

  -- -------- -- -------
     @xmath      
                 (5.4)
  -- -------- -- -------

To see 1 , let @xmath be fixed. If, given @xmath , we let let @xmath , (
5.4 ) yields that

  -- -------- --
     @xmath   
  -- -------- --

which, together with Lemma 5.1 , implies 1 .

For 2 , let @xmath , @xmath and @xmath . Then, as @xmath we have @xmath
and @xmath . ∎

### 5.2 General bounds for boxes

###### Lemma 5.5.

Let @xmath be integers, at least one of them even. Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Let @xmath be a tiling of an @xmath box, and let @xmath denote the
number of dominoes parallel to @xmath , respectively: notice that @xmath
.

For each pair of integers @xmath , let @xmath (resp. @xmath ) denote the
number of dominoes parallel to @xmath (resp. @xmath ) which contain a
cube of the form @xmath ) for some @xmath . Then @xmath and @xmath ,
@xmath .

Notice that @xmath . We claim that @xmath . To see this, we will
consider the following relaxed optimization problem: we want to find the
maximum value of @xmath , subject to the conditions that @xmath and
@xmath are nonnegative real numbers, @xmath , @xmath , @xmath .

Let @xmath be such that @xmath is maximum. We claim that there is at
most one pair @xmath such that @xmath . To see this, suppose that @xmath
and @xmath are two such pairs, and suppose @xmath . Then for any @xmath
we have @xmath , which contradicts the maximality of @xmath .

The latter claim implies that there are exactly @xmath pairs @xmath such
that @xmath , and exactly @xmath pairs @xmath where @xmath ; if we
consider two of these @xmath positions @xmath and @xmath , we see that
we must have @xmath and @xmath (if that’s not the case, it’s easy to see
that it cannot be a maximum), so that, in each of these @xmath pairs,
@xmath and @xmath . If the fractional part @xmath of @xmath is not zero,
then there is exactly one position where @xmath and @xmath .
Consequently,

  -- -------- --
     @xmath   
  -- -------- --

establishing the first claim.

Finally, by symmetry (by looking at effects along other directions), we
see that @xmath , and

  -- -------- -------- --
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

completing the proof. ∎

###### Lemma 5.6.

Suppose @xmath , and suppose @xmath realize the maximum for the problem

  -- -------- -- -------
     @xmath      (5.5)
  -- -------- -- -------

Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

First, observe that @xmath . Suppose, by contradiction, that @xmath .
Then @xmath , and we can pick a sufficiently small @xmath such that the
triple @xmath satisfies @xmath and @xmath which is a contradiction. A
similar analysis shows that we cannot have @xmath , so that we
necessarily have @xmath .

Finally, if @xmath , then clearly the triple @xmath would have a
strictly larger objective function for sufficiently small @xmath , and
thus we must have @xmath . ∎

###### Corollary 5.7.

Suppose @xmath , at least one of them even. Then

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

By Lemma 5.6 , the maximum value of ( 5.5 ) can be bounded above by the
problem

  -- -------- -- -------
     @xmath      (5.6)
  -- -------- -- -------

Let @xmath , so that @xmath , and denote by @xmath the maximum value of
@xmath subject to the condition that @xmath : we claim that @xmath . To
see this, suppose @xmath for some @xmath : a straightforward calculation
shows that @xmath , so that @xmath and so

  -- -------- --
     @xmath   
  -- -------- --

hence the triple @xmath cannot satisfy the condition @xmath Therefore,
we have that the maximum of ( 5.6 ) is less than @xmath . By Lemma 5.5 ,

  -- -------- --
     @xmath   
  -- -------- --

completing the proof. ∎

###### Corollary 5.8 (Case @xmath).

Suppose @xmath , at least one of them even, and let @xmath . Then

  -- -------- --
     @xmath   
  -- -------- --

In particular, @xmath .

###### Proof.

Suppose @xmath realize the maximum of ( 5.5 ) for @xmath . A very
similar analysis to the one done in the proof of Lemma 5.6 shows that
@xmath so that @xmath and @xmath . Writing @xmath , we see that @xmath
and so @xmath . By Lemma 5.5 , we’re done. ∎

###### Corollary 5.9 (Case @xmath).

Suppose @xmath , at least one of them even, and let @xmath . Then @xmath
where

  -- -------- --
     @xmath   
  -- -------- --

###### Proof.

Let @xmath realize the maximum of ( 5.5 ) for @xmath . By Lemma 5.6 ,
@xmath so that @xmath . Therefore, the value @xmath , multiplied by
@xmath , equals the maximum in ( 5.5 ). Let @xmath and @xmath .

Notice that @xmath is strictly concave in @xmath . Since @xmath , it
follows that this is the only maximum point of @xmath . Let @xmath be
the largest value for which @xmath ( @xmath ). Since for @xmath we have
@xmath , it follows that @xmath and @xmath whenever @xmath . Therefore,
if @xmath , then @xmath , thus the maximum value is given by @xmath .
Otherwise, since @xmath is always increasing and @xmath is decreasing
for @xmath (because it is concave), it follows that the maximum is given
by @xmath .

Solving the equation @xmath yields @xmath , and @xmath for @xmath .
Hence, the maximum is

  -- -------- --
     @xmath   
  -- -------- --

By Lemma 5.5 , we have

  -- -------- --
     @xmath   
  -- -------- --

completing the proof. ∎

We shall now finish the discussion with a construction that yields a
lower bound for the maximum twist of boxes. Let @xmath . The solenoid
with parameters @xmath is a tiling of the box @xmath whose twist is
@xmath .

A wire loop is a region which, after translation by vectors of integer
coordinates and permutations of the axes, equals @xmath as illustrated
by Figure 5.6 . Notice that a wire loop has exactly two tilings.

Figure 5.7 shows the basic idea of the solenoid construction. We
consider the cable loops

  -- -------- -------- --
     @xmath   @xmath   
     @xmath   @xmath   
              @xmath   
  -- -------- -------- --

illustrated in Figure 5.7 .

Notice that @xmath is the disjoint union of @xmath wire loops, whereas
@xmath is the disjoint union of @xmath wire loops. Each of these wire
loops can be tiled in such a way that if @xmath is a wire loop in @xmath
with tiling @xmath and @xmath is a wire loop in @xmath with tiling
@xmath , then @xmath . If we consider the tilings @xmath of @xmath and
@xmath of @xmath formed by individual tilings of each wire loop, then
@xmath . Figure 5.8 shows an example of this construction.

A reasonably straightforward case-by-case analysis shows that, if at
least one of the parameters @xmath is even, the remainder of the box can
be tiled in such a way that the twist of the solenoid is exactly @xmath
(most dominoes will be parallel to @xmath , and we need to check that
the effects between others cancel out). If all dimensions are odd (as in
Figure 5.8 ), then everything cancels out with the exception of two
pairs of dominoes with positive sign in the twist, hence yielding @xmath
.

We shall now use this construction to find a lower bound for all boxes.
First, an auxiliary Lemma:

###### Lemma 5.10.

Let @xmath be a box, with @xmath even. Then @xmath .

###### Proof.

Consider the boxes @xmath for @xmath , @xmath , @xmath . Since the
complement @xmath is tileable with every domino parallel to @xmath , we
can clearly construct a tiling @xmath whose twist is @xmath (see Example
3.5 ).∎

###### Remark 5.11.

Lemma 5.10 also implies that the only tileable flip connected boxes are
those of dimension @xmath and @xmath (and rotations of those boxes). It
is easy to show that these boxes are flip connected: @xmath boxes are
essentially plane regions, and one can show by induction that @xmath
boxes are flip connected. For any other tileable @xmath box, we can
after a rotation assume that @xmath , @xmath and that @xmath is even, so
that @xmath . Since all the elements in the sequence differ by positive
trits, it follows that the box has at least @xmath flip connected
components.

###### Lemma 5.12.

If @xmath , at least two of them greater than or equal to @xmath (and at
least one of them even), then @xmath .

###### Proof.

Assume that @xmath . If @xmath , then Lemma 5.10 suffices: if @xmath ,
@xmath ; if @xmath , and, say, @xmath is even, then @xmath . Therefore,
we may assume that @xmath .

In order to construct the most efficient solenoid, we rotate the box and
consider @xmath . Let @xmath , @xmath , @xmath and @xmath . Let @xmath
be the tiling of @xmath obtained from the solenoid construction with
parameters @xmath (and @xmath is tiled with all dominoes parallel to
each other).

Now

  -- -- --
        
  -- -- --

Let @xmath denote the last expression: we see that @xmath , which are
all greater than or equal to @xmath . We now want to see that @xmath .
Clearly @xmath for any @xmath . For the other cases, we see that for
@xmath , we have @xmath where @xmath , @xmath , @xmath . Since clearly
@xmath for @xmath , we see that @xmath and thus @xmath . ∎

###### Proof of Theorem 4.

The general lower and upper bounds follow directly from Lemmas 5.1 and
5.12 . Lemmas 5.4 and Corollary 5.8 (using @xmath ) imply that, if
@xmath , then

  -- -------- --
     @xmath   
  -- -------- --

completing the proof. ∎

## Glossary

 @xmath 

    The set of all positively oriented bases formed by vectors of @xmath
    .

 @xmath 

    The color of some object (a cube, a square, a vertex, etc): @xmath
    if it is black, and @xmath if it is white.

  cylinder  

    Region of the form @xmath (possibly rotated), where @xmath is a
    connected and simply connected planar region. Same as multiplex.

 @xmath 

    The set @xmath .

 @xmath 

    The union of two disjoint sets @xmath and @xmath .

  duplex region  

    Region of the form @xmath , where @xmath is a connected and simply
    connected planar region.

  embedding  

    In general, an embedding of a tiling @xmath of @xmath in a larger
    region @xmath is a tiling of @xmath which coincides with @xmath in
    @xmath . For specific uses, see Sections 3.5 , 3.7 and 4.6 .

  ghost curve  

    Curve connecting a source to a sink in a two-story region. See page
    3.2 .

  jewel  

    Projection of a domino that is parallel to the axis of a duplex
    region. See page 3.1 .

 @xmath 

    The linking number between two curves @xmath and @xmath .

  multiplex  

    Region of the form @xmath (possibly rotated), where @xmath is a
    connected and simply connected planar region. Same as cylinder.

 @xmath 

    The set @xmath .

  ( @xmath -)pretwist  

    See @xmath .

 @xmath 

    Polynomial invariant for regions with two floors. See pages 3.1 and
    3.2 .

 @xmath 

    Equals @xmath .

  sock  

    System of cycles. See page 3.11 .

 @xmath 

    The slanted effect of the segment @xmath on the segment @xmath with
    parameters @xmath and @xmath . See page 4.2 .

 @xmath 

    The effect of the domino (or segment) @xmath on the domino (or
    segment) @xmath along @xmath : see pages 4.1 and 4.2 .

 @xmath 

    Sums of slanted effects @xmath for all segments @xmath . See page
    4.2 .

 @xmath 

    Equals @xmath : see page 4.2 .

 @xmath 

    The @xmath -pretwist of a tiling @xmath (see page 4.1 ); also, if
    @xmath is an arbitrary set of segments, this equals @xmath : see
    page 4.2 .

 @xmath 

    The sum of effects of segments of @xmath on segments of @xmath along
    @xmath . See page 4.2 .

 @xmath 

    The maximum value of the twist on the set of tilings of an @xmath
    box.

 @xmath 

    Integer that is invariant by flips in cylinders. See Definition 4.4
    on page 4.4 .

 @xmath 

    The winding number of a planar curve @xmath around a point @xmath .

 @xmath 

    A particular directional writhing number. See page 4.2 .

 @xmath 

    The directional writhing number of a curve @xmath in the direction
    of a vector @xmath . See page 4.2 .